{"version":3,"sources":["stockinfo/VTags.tsx","stockinfo/CStockInfo.tsx","UqApp/uqs/BruceYuMi/Account.ui.tsx","UqApp/uqs/BruceYuMi/Holding.ui.tsx","UqApp/uqs/BruceYuMi/Transaction.ui.tsx","UqApp/uqs/BruceYuMi/Stock.ui.tsx","UqApp/uqs/BruceYuMi/Market.ui.tsx","UqApp/uqs/BruceYuMi/Portfolio.ui.tsx","UqApp/uqs/BruceYuMi/StockValue.ui.tsx","UqApp/uqs/BruceYuMi/AccountValue.ui.tsx","UqApp/uqs/BruceYuMi/UserAccount.ui.tsx","consts.ts","regression/SlrForEarning.ts","regression/ErForEarning.ts","App.tsx","reportWebVitals.ts","index.tsx","appConfig.ts","UqApp/CBase.ts","images/logo.svg","home/VSiteHeader.tsx","home/VSearchHeader.tsx","tool/render.tsx","tool/func.ts","home/VHome.tsx","home/VSelectTag.tsx","home/VMarketPE.tsx","home/CMarketPE.tsx","home/CHome.tsx","me/VEditMe.tsx","me/VFaq.tsx","me/VAbout.tsx","me/VMe.tsx","me/CMe.ts","net/httpChannel.ts","net/httpChannelUI.ts","net/apiBase.ts","net/miApi.ts","explorer/VSiteHeader.tsx","explorer/VExplorer.tsx","explorer/VExplorerCfg.tsx","explorer/CExplorer.tsx","warning/VWarningConfig.tsx","warning/CWarning.tsx","predicthistory/VPredictHistory.tsx","predicthistory/CPredictHistory.tsx","UqApp/res/index.ts","UqApp/res/zh.ts","UqApp/res/en.ts","holding/VHolding.tsx","holding/VAccount.tsx","holding/CHolding.ts","UqApp/VMain.tsx","UqApp/CApp.ts","stockinfo/VStockInfo.tsx","UqApp/uqs/BruceYuMi/index.ts","stock/VSelectStock.tsx","stock/CStock.tsx","stockinfo/index.ts","tool/GFunc.tsx"],"names":["VTags","onSelect","item","isSelected","anySelected","controller","onClickSelectTag","onEditTag","tag","e","preventDefault","renderTag","left","className","name","right","defaultBlackListTagName","defaultTagName","onClick","page","observer","selectedTags","tags","cApp","divNewTag","length","onNewTag","header","headerClassName","items","render","selectedItems","param","a","this","openPage","VPage","schema","type","required","maxLength","uiSchema","widget","label","placeholder","id","visible","submit","VNewTag","onFormButtonClick","context","onSaveNewTag","data","closePage","formData","undefined","onButtonClick","VEditTag","onSaveTag","fData","CStockInfo","exrightForEarning","exrightInfo","historyDataOrg","_capitalearning","observable","array","deep","_bonus","_divideInfo","loadData","loading","baseItem","day","Promise","all","miApi","query","user","rets","stockTags","ret","Array","isArray","arr1","price","clear","arr2","push","arr3","arr4","loadTTMEarning","LoadHistoryData","loaded","openMetaView","onSelectTag","filter","v","findIndex","st","openVPage","call","retId","alert","i","nav","stock","newTag","AddTagStockID","splice","RemoveTagStockID","onClickDefaultTag","tagid","defaultListTagID","showSelectStock","cStock","CStock","b","changeDay","code","symbol","ni","makeObservable","list","seasonData","seasonlist","len","minNo","seasonno","lastItem","maxNo","GFunc","SeasonnoToBeginEnd","end","no","sItem","season","c","capital","es","esum","earning","corg","eorg","esumorg","ExrightEarning","si","pastitem","noBegin","predictData","predictSeasonData","predictSeasonDataFull","ypredict","x","er","ErForEarning","lr","SlrForEarning","B","r2","epre","predict","l","slopeR","lr2","lpre","endDay","exitem","factor","showAll","historyData","endIndex","lastdayno","dayno","lastDay","not","historyList","RestorePrice","ttm","CalculateHistoryPE","dayFrom","dayIndex","bsum","pricere","bonus","factore","SeasonnoFromDay","VStockInfo","CUqBase","computed","fields","fieldArr","ui","res","zh","en","JSON","stringify","account","holding","tick","quantity","amount","market","currency","miRate","divident","roe","inc1","inc2","inc3","inc4","preInc","marketValue","mi","count","id2","consts","uqBasedata","appIcon","miApiHost","miApiHostDebug","isDevelopment","process","y","slope","intercept","endY","regress","score","n","xSum","ySum","xSquared","xY","numerator","ym","y2","chi2","rmsd","ySquared","yi2","yi","yiyi2","r","Math","sqrt","A","yx","log","exp","App","onLogined","start","CApp","appConfig","React","Component","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","StrictMode","document","getElementById","version","app","uqs","dev","alias","noUnit","tvs","oem","htmlTitle","CBase","CUqApp","CSub","init","CAppBase","VSiteHeader","src","logo","alt","style","height","width","renderSearchHeader","View","VSearchHeader","onSearch","key","size","renderSortCol","radioName","sortMethod","caption","sort","checked","defaultChecked","renderSortHeaders","role","aria-label","renderValue","value","valueType","vStr","_cn","cn","isNaN","toFixed","percent1","number","round","toString","numberToMarketValue","renderStockInfoRow","row","onClickName","inputSelect","inputSelectSpan","pe","divyield","order","total","ep","e3","zzl","funcz","p","calculateZZ3","dataArr","rows","map","renderStockUrl","href","target","rel","stopPropagation","w","VHome","setSortType","renderRow","index","rowContent","rowKey","openStockInfo","onSelected","clickRow","callOnSelected","openMarketPE","scroller","onPage","title","config","tagName","onAddStock","inverse","before","none","VSelectTag","onClickTag","VMarketPE","input","checkLimitShow","f","onLongShortFlag","head","pageContent","historyChart","chartHistory","labelList","peList","eList","numberToPrecision","chartdata1","labels","datasets","borderColor","backgroundColor","borderWidth","fill","yAxisID","options","scales","yAxes","display","position","gridLines","drawOnChartArea","onChange","CMarketPE","longshortFlag","dt","Date","getFullYear","getMonth","getDate","reverse","CHome","lastLoadTick","userTag","oldSortType","loadItems","selectTag","onWarningConfg","cWarning","load","tagID","now","setUserSortType","arr","slice","sortStocks","replace","renderSiteHeader","renderView","renderHome","tab","newC","stockID","pageStart","pageSize","yearlen","result","dataArray","parse","sl","calculateVN","exprice","predictpe","o","runInAction","VEditMe","props","nick","icon","onItemChanged","itemSchema","newValue","preValue","userApi","userSetProp","saveLocalUser","onExit","showLogout","changePassword","gridRows","component","iconClass","text","t","bk","values","VFaq","VAbout","top","VMe","meInfo","showEditMe","userSpan","String","substr","faq","about","aboutRows","logout","CMe","unitOwner","rootUnits","HttpChannel","hostUrl","apiToken","timeout","startWait","endWait","url","reject","showError","error","post","params","keys","Object","k","buildOptions","method","innerFetch","body","resolve","buildError","err","channel","that","path","console","timeOutHandler","setTimeout","fetch","encodeURI","ok","clearTimeout","statusText","ct","headers","get","indexOf","json","retJson","catch","message","toLowerCase","startsWith","u","language","culture","Headers","append","lang","HttpChannelNavUI","onError","channelUIs","channelNoUIs","MiApiChannel","basePath","apiName","uqToken","showWaiting","token","channels","channelUI","getHttpChannel","callFetch","put","delete","MiApi","pbody","_","clone","proc","VExplorer","onClickPredictAVG","avgs","priceDay","lastTradeDay","avg20","avg50","avg100","avg","openPredictAVG","blackList","labelId","fInDef","defaultList","middle","onSelectItem","onClickItem","onConfig","avgHead","reload","avgStr","numberToFixString","irate","bmin","bmax","lmin","lmax","lr4","mcount","r210","VExplorerCfg","sortChage","newType","setStockSortType","selectChange","setStockSelectType","cfg","setRegressionConfig","findStockConfg","regression","CExplorer","oldSelectType","disposeAutorun","autorun","newSelectType","stockFind","selectType","queryName","blackID","blackListTagID","bMin","bMax","lMin","lMax","lastDayRet","CalculateValueAvg","VWarningConfig","warnings","onNewWarning","renderWarning","witem","warningTypeString","VNewWarning","newuiSchema","pickId","Templet","onSaveNewWarning","CWarning","loadWarnings","onSaveWarning","_cApp","VPredictHistory","avg20List","avg50List","avg100List","CPredictHistory","li","$zh","home","relation","discover","me","aboutTheApp","pleaseLogin","notes","task","assign","noteSpace","noteText","noteList","noteCheckable","noteTask","noteFolder","noteCreateSpace","content","$en","VHolding","renderAccount","onClickAccount","showAccount","accounts","VAccount","CHolding","BruceYuMi","Account","UserAccount","ID","IX","IDinIX","IDNO","accountNO","IDActs","paramValue","IDX","AccountValue","forEach","find","color","selected","VMain","cHome","cHolding","cExporer","cMe","tabs","notify","onShown","TabCaptionComponent","tabsProps","getsortFunc","sortType","userStock","saveConfig","selectAccount","accountName","setRes","isLogined","miHost","loadConfig","loadTags","loadAccounts","cStr","loadBlackList","loadDefaultList","checkDefaultTags","r1","br","blackid","AddBlackID","AddDefaultID","stockIDs","RemoveBlackID","RemoveDefaultID","vp","open","check","ttmLimit","checkShowLater","checkDefaultTag","headStr","dateHead","baseInfo","predictInfo","predictSeasonEarning","seasonEarning","capitalEarning","evt","Number","isInteger","trim","onSubmit","dayString","ref","defaultValue","fInList","percentToFixString","window","opener","priceList","ttmList","chart1","showLine","pointStyle","pointRadius","per","plr","chart2","predictChartFullInfo","chart3","predictChartROE","numberToString","SeasonnoToYearMonth","chartdataFull","parseFloat","toPrecision","capitalearning","year","setUI","uq","Holding","Transaction","Stock","Market","Portfolio","StockValue","VStockSelect","onClickStock","model","returnStock","customer","pageItems","onScrollBottom","allowEmptySearch","searchByKey","renderStock","PageStockItems","cs","firstSize","PageItems","first","returnCall","more","precision","iRate","e1","e2","r3","z","pow","floor","month","s","begin","calcuOne","sum"],"mappings":"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","file":"static/js/main.1683e500.chunk.js","sourcesContent":["import * as React from 'react';\r\nimport { observer } from 'mobx-react-lite';\r\nimport { VPage, Page, FA, List, Form, ItemSchema, StringSchema, UiInputItem, UiSchema, Context, IdSchema, UiIdItem, LMR } from 'tonva-react';\r\nimport { CStockInfo } from './CStockInfo';\r\nimport { defaultBlackListTagName, defaultTagName } from '../consts';\r\n\r\nexport class VTags extends VPage<CStockInfo> {\r\n  async open(param?: any) {\r\n    this.openPage(this.page);\r\n  }\r\n\r\n  private onSelect = (item: any, isSelected: boolean, anySelected: boolean) => {\r\n    this.controller.onClickSelectTag(item, isSelected);\r\n  }\r\n\r\n  private onEditTag = (tag:any, e:React.MouseEvent) => {\r\n    e.preventDefault();\r\n    this.controller.onEditTag(tag);\r\n  }\r\n\r\n  private renderTag = (tag: any) => {\r\n    let left = <div className=\"px-3 py-2 cursor-pointer\">{tag.name}</div>;\r\n    let fdTag = tag.name === defaultBlackListTagName || tag.name === defaultTagName;\r\n    let right = fdTag ? '' : <div className=\"px-3 py-2 cursor-pointer\" onClick={(e)=>this.onEditTag(tag, e)}>编辑</div>;\r\n    return <LMR className=\"mx-3 my-2\" left={left} right={right}>\r\n    </LMR>;\r\n  }\r\n\r\n  private page = observer(() => {\r\n    let { selectedTags } = this.controller;\r\n    let { tags } = this.controller.cApp;\r\n    let divNewTag = tags.length >= 10 ? '' :\r\n      <div className=\"px-3 py-2 cursor-pointer\" onClick={this.controller.onNewTag}><FA name=\"plus\" className=\"text-primary\" /> &nbsp; 新建分组</div>;\r\n    return <Page header=\"选择分组\" headerClassName=\"bg-primary\">\r\n      {divNewTag}\r\n      <List items={tags} item={{ onSelect: this.onSelect, render: this.renderTag }} selectedItems={selectedTags} />\r\n    </Page>;\r\n  })\r\n}\r\n\r\nconst schema: ItemSchema[] = [\r\n  { name: 'name', type: 'string', required: true, maxLength: 10 } as StringSchema,\r\n  { name: 'id', type: 'id' } as IdSchema,\r\n  { name: 'submit', type: 'submit', },\r\n];\r\nconst uiSchema: UiSchema = {\r\n  items: {\r\n    name: { widget: 'text', label: null, placeholder: '分组名称' } as UiInputItem,\r\n    id: { widget: 'id', visible: false } as UiIdItem,\r\n    submit: { widget: 'button', label: '保存', className: 'btn btn-primary' },\r\n  }\r\n};\r\n\r\nexport class VNewTag extends VPage<CStockInfo> {\r\n  async open(param?: any) {\r\n    this.openPage(this.page);\r\n  }\r\n\r\n  private onFormButtonClick = async (name: string, context: Context) => {\r\n    if (await this.controller.onSaveNewTag(context.data)) {\r\n      this.controller.closePage();\r\n    }\r\n  }\r\n\r\n  private page = () => {\r\n    return <Page header=\"新建分组\" headerClassName=\"bg-primary\">\r\n      <div className=\"px-3 py-3\">\r\n        <Form schema={schema}\r\n          uiSchema={uiSchema}\r\n          formData={undefined}\r\n          onButtonClick={this.onFormButtonClick}\r\n        />\r\n      </div>\r\n    </Page>;\r\n  }\r\n}\r\n\r\nexport class VEditTag extends VPage<CStockInfo> {\r\n  async open(param?: any) {\r\n    this.openPage(this.page, param);\r\n  }\r\n\r\n  private onFormButtonClick = async (name: string, context: Context) => {\r\n    if (await this.controller.onSaveTag(context.data)) {\r\n      this.controller.closePage();\r\n    }\r\n  }\r\n\r\n  private page = (param?: any) => {\r\n    let {id, name} = param;\r\n    let fData = {id:id, name:name};\r\n    return <Page header=\"编辑分组\" headerClassName=\"bg-primary\">\r\n      <div className=\"px-3 py-3\">\r\n        <Form schema={schema}\r\n          uiSchema={uiSchema}\r\n          formData={fData}\r\n          onButtonClick={this.onFormButtonClick}\r\n        />\r\n      </div>\r\n    </Page>;\r\n  }\r\n}\r\n","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport { observable, IObservableArray, computed, makeObservable } from 'mobx';\r\nimport { nav } from 'tonva-react';\r\nimport { CUqBase } from '../UqApp';\r\nimport { GFunc } from '../tool/GFunc';\r\nimport { VStockInfo } from './VStockInfo'\r\nimport { NStockInfo, StockPrice, StockEarning, StockRoe, StockCapitalearning, StockBonus, StockDivideInfo } from './StockInfoType';\r\nimport { VTags, VNewTag, VEditTag } from './VTags';\r\nimport { ErForEarning, SlrForEarning } from 'regression';\r\nimport { CStock } from 'stock/CStock';\r\n\r\nexport class CStockInfo extends CUqBase {\r\n\r\n  constructor(cApp: any) {\r\n    super(cApp);\r\n    makeObservable(this);\r\n  }\r\n  @observable baseItem: NStockInfo;\r\n  @observable protected loaded: boolean = false;\r\n\r\n  @observable price: StockPrice;\r\n  //@observable roe: StockRoe;\r\n  //@observable tags: any[] = undefined;\r\n  @observable stockTags: any[];\r\n  selectedTags: any[];\r\n\r\n  protected exrightForEarning: {day:number, factor:number}[] = [];\r\n  protected exrightInfo: {day:number, bonus:number, factor:number, factore:number}[] = [];\r\n  @observable seasonData:{season:number, c:number, e:number, esum:number, corg:number, eorg:number, esumorg:number}[] = [];\r\n  @observable predictSeasonData:{season:number, c:number, e:number, esum:number, corg:number, eorg:number, esumorg:number}[] = [];\r\n  @observable predictSeasonDataFull:{season:number, c:number, e:number, esum:number, corg:number, eorg:number, esumorg:number}[] = [];\r\n  @observable predictData: { e:number, b: number, r2: number, epre:number, l:number, lr2:number, lpre:number};\r\n  @observable ypredict: number[] = [];\r\n  @observable historyData:{day:number, price:number, ttm:number}[] =  [];\r\n  protected historyDataOrg:{day:number, price:number, dayno:number}[] = [];\r\n\r\n  //protected _earning: IObservableArray<StockEarning> = observable.array<StockEarning>([], { deep: true });\r\n  protected _capitalearning: IObservableArray<StockCapitalearning> = observable.array<StockCapitalearning>([], { deep: true });\r\n  protected _bonus: IObservableArray<StockBonus> = observable.array<StockBonus>([], { deep: true });\r\n  protected _divideInfo: IObservableArray<StockDivideInfo> = observable.array<StockDivideInfo>([], { deep: true });\r\n\r\n  // @computed get earning(): IObservableArray<StockEarning> {\r\n  //   if (this.loaded === false) return undefined;\r\n  //   return this._earning;\r\n  // }\r\n\r\n  @computed get capitalearning(): IObservableArray<StockCapitalearning> {\r\n    if (this.loaded === false) return undefined;\r\n    return this._capitalearning;\r\n  }\r\n\r\n  @computed get bonus(): IObservableArray<StockBonus> {\r\n    if (this.loaded === false) return undefined;\r\n    return this._bonus;\r\n  }\r\n\r\n  @computed get divideInfo(): IObservableArray<StockDivideInfo> {\r\n    if (this.loaded === false) return undefined;\r\n    return this._divideInfo;\r\n  }\r\n\r\n  loadData = () => {\r\n    this.loading();\r\n  }\r\n\r\n  loading = async () => {\r\n    if (!this.baseItem)\r\n      return;\r\n    let { id, day } = this.baseItem;\r\n    let rets = await Promise.all([\r\n      this.cApp.miApi.query('q_stockallinfo', [id, day]),\r\n      this.cApp.miApi.query('t_tagstock$query', [this.user.id, undefined, id]) //this.uqs.mi.TagStock.query({ user: nav.user.id, stock: id })\r\n    ]);\r\n    this.stockTags = rets[1];\r\n    let ret = rets[0];\r\n    if (Array.isArray(ret[0])) {\r\n      let arr1 = ret[1];\r\n      if (Array.isArray(arr1)) {\r\n        this.price = arr1[0];\r\n      }\r\n\r\n      if (this._capitalearning.length > 0) {\r\n        this._capitalearning.clear();\r\n      }\r\n      let arr2 = ret[2];\r\n      if (Array.isArray(arr2)) {\r\n        this._capitalearning.push(...arr2);\r\n      }\r\n\r\n      this._bonus.clear();\r\n      let arr3 = ret[3];\r\n      if (Array.isArray(arr3)) {\r\n        this._bonus.push(...arr3);\r\n      }\r\n\r\n      this._divideInfo.clear();\r\n      let arr4 = ret[4];\r\n      if (Array.isArray(arr4)) {\r\n        this._divideInfo.push(...arr4);\r\n      }\r\n\r\n      this.exrightForEarning = ret[5];\r\n      await this.loadTTMEarning(ret[6]);\r\n      this.exrightInfo = ret[7];\r\n\r\n      this.historyDataOrg = ret[8];\r\n      this.LoadHistoryData(false);\r\n    }\r\n\r\n    this.loaded = true;\r\n  }\r\n\r\n  protected async loadTTMEarning(list: {seasonno:number, capital:number, earning:number, es:number}[]) {\r\n    this.seasonData.splice(0);\r\n    let seasonlist: {[index:number]:{season:number, c:number, e:number, esum:number, corg:number, eorg:number, esumorg:number}} = {};\r\n    let len = list.length;\r\n    if (len <= 0)\r\n      return;\r\n    let minNo = list[len - 1].seasonno;\r\n    let lastItem = list[0];\r\n    let maxNo = lastItem.seasonno;\r\n\r\n    let {end} = GFunc.SeasonnoToBeginEnd(maxNo);\r\n    for (let item of list) {\r\n      let no = item.seasonno;\r\n      let sItem = {season:no, c: item.capital, e: item.es, esum: item.earning, corg: item.capital, eorg: item.es, esumorg: item.earning}\r\n      this.ExrightEarning(end, no, sItem);\r\n      seasonlist[no] = sItem;\r\n    }\r\n\r\n    let i = 0;\r\n    let esum = 0;\r\n    for (let seasonno = minNo; seasonno <= maxNo; ++seasonno, ++i) {\r\n      let si = seasonlist[seasonno];\r\n      if (si === undefined) {\r\n        continue;\r\n      }\r\n      esum += si.e;\r\n      if (i < 3) {\r\n        si.esum = undefined;\r\n      }\r\n      else {\r\n        si.esum = esum;\r\n        let pastitem = seasonlist[seasonno-3];\r\n        if (pastitem !== undefined) {\r\n          esum -= pastitem.e;\r\n        }\r\n      }\r\n      this.seasonData.splice(0,0, si);\r\n    }\r\n\r\n    let noBegin = maxNo - 19;\r\n    this.predictData = undefined;\r\n    this.predictSeasonData.splice(0);\r\n    this.predictSeasonDataFull.splice(0);\r\n    if (noBegin < minNo)\r\n      return;\r\n    noBegin += 3;\r\n    this.ypredict = [];\r\n    for (let x = noBegin; x <= maxNo; x += 4) {\r\n      let item = seasonlist[x];\r\n      if (item === undefined)\r\n        break;\r\n      this.predictSeasonData.splice(0, 0, item);\r\n      this.ypredict.push(item.esum);\r\n    }\r\n\r\n    for (let x = maxNo; x >= minNo; x -= 4) {\r\n      let item = seasonlist[x];\r\n      if (item === undefined)\r\n        break;\r\n      this.predictSeasonDataFull.push(item);\r\n    }\r\n    if (this.ypredict.length === 5) {\r\n      let er = new ErForEarning(this.ypredict);\r\n      let lr = new SlrForEarning(this.ypredict);\r\n      this.predictData = {e:this.ypredict[4], b: er.B, r2: er.r2, epre: er.predict(4), l: lr.slopeR, lr2: lr.r2, lpre: lr.predict(4)};\r\n    }\r\n    else {\r\n      this.predictSeasonData.splice(0);\r\n    }\r\n  }\r\n\r\n  protected ExrightEarning(endDay:number, season:number, item:{c:number, e:number, esum:number}) {\r\n    let {end} = GFunc.SeasonnoToBeginEnd(season);\r\n    for (let i = 0; i < this.exrightForEarning.length; ++i) {\r\n      let exitem = this.exrightForEarning[i];\r\n      let day = exitem.day;\r\n      if (day > endDay)\r\n        break;\r\n      else if (day < end)\r\n        continue;\r\n      else {\r\n        let factor = exitem.factor;\r\n        item.c = item.c * factor;\r\n        item.e = item.e * factor;\r\n        item.esum = item.esum * factor;\r\n      }\r\n    }\r\n  }\r\n\r\n  LoadHistoryData(showAll:boolean) {\r\n    let list = this.historyDataOrg;\r\n    let length = list.length;\r\n    if (length <= 10) {\r\n      this.historyData = [];\r\n      return;\r\n    }\r\n    if (!showAll) {\r\n      let day = this.baseItem.day;\r\n      if (day !== undefined) {\r\n        let i = length - 1;\r\n        for (; i >= 0; --i) {\r\n          let item = list[i];\r\n          if (item.day <= day) {\r\n            break;\r\n          }\r\n        }\r\n        length = i + 1;\r\n      }\r\n    }\r\n    let endIndex = length - 1;\r\n    let lastItem = list[endIndex];\r\n    let lastdayno = lastItem.dayno;\r\n    if (lastdayno === undefined) {\r\n      while (endIndex > 0) {\r\n        --endIndex;\r\n        lastItem = list[endIndex];\r\n        lastdayno = lastItem.dayno;\r\n        if (lastdayno !== undefined)\r\n          break;\r\n      }\r\n    }\r\n    let lastDay = lastItem.day;\r\n    let not = lastdayno % 5;\r\n    let historyList: any[] = [];\r\n    for (let i = 0; i <= endIndex; ++i) {\r\n      let {day, price, dayno} = list[i];\r\n      if ( dayno % 5 === not) {\r\n        historyList.push({day:day, price:this.RestorePrice(price, day, lastDay), ttm:this.CalculateHistoryPE(price, day)});\r\n      }\r\n    }\r\n    this.historyData = historyList;\r\n  }\r\n\r\n  RestorePrice(price:number, dayFrom:number, dayIndex:number) {\r\n    let bsum = 0;\r\n    let pricere = price;\r\n    if (dayFrom < dayIndex) {\r\n      for (let i = 0; i < this.exrightInfo.length; ++i) {\r\n        let {day, bonus, factor, factore} = this.exrightInfo[i];\r\n        if (day <= dayFrom)\r\n          continue;\r\n        if (day > dayIndex)\r\n          break;\r\n        pricere = pricere * factor;\r\n        bsum = (bsum + bonus) * factore;\r\n      }\r\n      pricere = pricere - bsum;\r\n    }\r\n    else {\r\n      for (let i = 0; i < this.exrightInfo.length; ++i) {\r\n        let {day, bonus, factor, factore} = this.exrightInfo[i];\r\n        if (day <= dayIndex)\r\n          continue;\r\n        if (day > dayFrom)\r\n          break;\r\n        pricere = pricere / factor;\r\n        bsum = bsum / factore + bonus;\r\n      }\r\n      pricere = pricere + bsum;\r\n    }\r\n    return pricere;\r\n  }\r\n\r\n  CalculateHistoryPE(price:number, day:number) {\r\n    let season = GFunc.SeasonnoFromDay(day);\r\n    let len = this.seasonData.length;\r\n    for (let i = 0; i < len; ++i) {\r\n      let item = this.seasonData[i];\r\n      if (item.season >= season) {\r\n        continue;\r\n      }\r\n\r\n      if (item.esumorg === undefined)\r\n        return undefined;\r\n\r\n      let {end} = GFunc.SeasonnoToBeginEnd(item.season);\r\n      let pricere = this.RestorePrice(price, day, end);\r\n      return pricere / item.esumorg;\r\n    }\r\n\r\n    return undefined;\r\n  }\r\n\r\n  async internalStart(param: any) {\r\n    this.baseItem = param as NStockInfo;\r\n    this.loadData();\r\n    this.openVPage(VStockInfo);\r\n  }\r\n\r\n  openMetaView = () => {\r\n  }\r\n\r\n  onSelectTag = async () => {\r\n    //await this.loadTags();\r\n    this.selectedTags = this.cApp.tags.filter(v => {\r\n      let i = this.stockTags.findIndex(st => st.tag === v.id);\r\n      return i >= 0;\r\n    });\r\n    //await this.loadTags();\r\n    this.openVPage(VTags);\r\n  }\r\n\r\n  onNewTag = () => {\r\n    this.openVPage(VNewTag);\r\n  }\r\n\r\n  onEditTag = (param: any) => {\r\n    this.openVPage(VEditTag, param);\r\n  }\r\n\r\n  onSaveNewTag = async (data: any) => {\r\n    let { name } = data;\r\n    //let param = { id: undefined, name: name };\r\n    let ret = await this.cApp.miApi.call('t_tag$save', [this.user.id, undefined, name]);\r\n    let { retId } = ret;\r\n    if (retId < 0) {\r\n      alert(name + ' 已经被使用了');\r\n      return false;\r\n    }\r\n    this.cApp.tags.push({ id: retId, name: name });\r\n    return true;\r\n  }\r\n\r\n  onSaveTag = async (data: any) => {\r\n    let { id, name } = data;\r\n    let param = { id: id, name: name };\r\n    let i = this.cApp.tags.findIndex(v => v.id !== id && v.name === name);\r\n    if (i >= 0) {\r\n      alert(name + ' 已经被使用了');\r\n      return false;\r\n    }\r\n    let ret = await this.cApp.miApi.call('t_tag$save', [this.user.id, undefined, name]);\r\n    let { retId } = ret;\r\n    if (retId === undefined || retId < 0) {\r\n      alert(name + ' 已经被使用了');\r\n      return false;\r\n    }\r\n    i = this.cApp.tags.findIndex(v => v.id === id);\r\n    if (i >= 0) {\r\n      this.cApp.tags[i].name = name;\r\n    }\r\n    return true;\r\n  }\r\n\r\n  onClickSelectTag = async (tag: any, isSelected: boolean) => {\r\n    let param = {\r\n      user: nav.user.id,\r\n      tag: tag.id,\r\n      arr1: [\r\n        { stock: this.baseItem.id }\r\n      ]\r\n    };\r\n    if (isSelected === true) {\r\n      let ret = await this.cApp.miApi.call('t_tagstock$add', [this.user.id, tag.id, this.baseItem.id]); //.uqs.mi.TagStock.add(param);\r\n      let newTag = {\r\n        tag: {\r\n          id: tag.id,\r\n        }\r\n      }\r\n      this.stockTags.push(newTag);\r\n      await this.cApp.AddTagStockID(tag.id, this.baseItem.id);\r\n    }\r\n    else {\r\n      let ret = await this.cApp.miApi.call('t_tagstock$del', [this.user.id, tag.id, this.baseItem.id]); // //await this.uqs.mi.TagStock.del(param);\r\n      let i = this.stockTags.findIndex(v => v.tag.id === tag.id);\r\n      this.stockTags.splice(i, 1);\r\n      await this.cApp.RemoveTagStockID(tag.id, this.baseItem.id);\r\n    }\r\n  }\r\n\r\n  onClickDefaultTag = async (isSelected: boolean) => {\r\n    let tagid = this.cApp.defaultListTagID;\r\n    if (isSelected === true) {\r\n      let ret = await this.cApp.miApi.call('t_tagstock$add', [this.user.id, tagid, this.baseItem.id]); //.uqs.mi.TagStock.add(param);\r\n      let newTag = {\r\n        tag: {\r\n          id: tagid,\r\n        }\r\n      }\r\n      this.stockTags.push(newTag);\r\n      await this.cApp.AddTagStockID(tagid, this.baseItem.id);\r\n    }\r\n    else {\r\n      let ret = await this.cApp.miApi.call('t_tagstock$del', [this.user.id, tagid, this.baseItem.id]); // //await this.uqs.mi.TagStock.del(param);\r\n      let i = this.stockTags.findIndex(v => v.tag.id === tagid);\r\n      this.stockTags.splice(i, 1);\r\n      await this.cApp.RemoveTagStockID(tagid, this.baseItem.id);\r\n    }\r\n  }\r\n\r\n  showSelectStock = async (day:number): Promise<any> => {\r\n    let cStock = new CStock(this.cApp);\r\n    let item = await cStock.call() as any;\r\n    let b = {...item}\r\n    b.day = day;\r\n    this.baseItem = b;\r\n    this.loaded = false;\r\n    await this.loading();\r\n  }\r\n\r\n  changeDay = async (day:number) => {\r\n    if (this.baseItem.day === day)\r\n      return;\r\n    let {id, name, code, symbol} = this.baseItem;\r\n    let ni = {id:id, name:name, code:code, symbol:symbol, day:day ===0 ? undefined : day};\r\n    this.baseItem = ni;\r\n    this.loaded = false;\r\n    await this.loading();\r\n  }\r\n}\r\n","import { Res, UI } from \"tonva-react\";\r\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\nimport { FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-react\";\r\nimport { Account } from \"./BruceYuMi\";\r\n\r\n/*--fields--*/\r\nconst fields = {\r\n\tid: {\r\n\t\t\"name\": \"id\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": false,\r\n\t\t\"label\": \"Id\"\r\n\t} as FieldItemId,\r\n\tno: {\r\n\t\t\"name\": \"no\",\r\n\t\t\"type\": \"string\",\r\n\t\t\"isKey\": true,\r\n\t\t\"widget\": \"string\",\r\n\t\t\"label\": \"No\"\r\n\t} as FieldItemString,\r\n\tname: {\r\n\t\t\"name\": \"name\",\r\n\t\t\"type\": \"string\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"string\",\r\n\t\t\"label\": \"Name\"\r\n\t} as FieldItemString,\r\n};\r\n/*==fields==*/\r\n\r\nexport const fieldArr: FieldItem[] = [\r\n\tfields.no, fields.name, \r\n];\r\n\r\nexport const ui: UI = {\r\n\tlabel: \"Account\",\r\n\tfieldArr,\r\n\tfields,\r\n};\r\n\r\nexport const res: Res<any> = {\r\n\tzh: {\r\n\t},\r\n\ten: {\r\n\t}\r\n};\r\n\r\nexport function render(item: Account):JSX.Element {\r\n\treturn <>{JSON.stringify(item)}</>;\r\n};\r\n","import { Res, UI } from \"tonva-react\";\r\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\nimport { FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-react\";\r\nimport { Holding } from \"./BruceYuMi\";\r\n\r\n/*--fields--*/\r\nconst fields = {\r\n\tid: {\r\n\t\t\"name\": \"id\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": false,\r\n\t\t\"label\": \"Id\"\r\n\t} as FieldItemId,\r\n\taccount: {\r\n\t\t\"name\": \"account\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": true,\r\n\t\t\"label\": \"Account\"\r\n\t} as FieldItemId,\r\n\tstock: {\r\n\t\t\"name\": \"stock\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": true,\r\n\t\t\"label\": \"Stock\"\r\n\t} as FieldItemId,\r\n};\r\n/*==fields==*/\r\n\r\nexport const fieldArr: FieldItem[] = [\r\n\tfields.account, fields.stock, \r\n];\r\n\r\nexport const ui: UI = {\r\n\tlabel: \"Holding\",\r\n\tfieldArr,\r\n\tfields,\r\n};\r\n\r\nexport const res: Res<any> = {\r\n\tzh: {\r\n\t},\r\n\ten: {\r\n\t}\r\n};\r\n\r\nexport function render(item: Holding):JSX.Element {\r\n\treturn <>{JSON.stringify(item)}</>;\r\n};\r\n","import { Res, UI } from \"tonva-react\";\r\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\nimport { FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-react\";\r\nimport { Transaction } from \"./BruceYuMi\";\r\n\r\n/*--fields--*/\r\nconst fields = {\r\n\tid: {\r\n\t\t\"name\": \"id\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": false,\r\n\t\t\"label\": \"Id\"\r\n\t} as FieldItemId,\r\n\tholding: {\r\n\t\t\"name\": \"holding\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": true,\r\n\t\t\"label\": \"Holding\"\r\n\t} as FieldItemId,\r\n\ttick: {\r\n\t\t\"name\": \"tick\",\r\n\t\t\"isKey\": true,\r\n\t\t\"label\": \"Tick\"\r\n\t} as undefined,\r\n\tprice: {\r\n\t\t\"name\": \"price\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Price\"\r\n\t} as FieldItemInt,\r\n\tquantity: {\r\n\t\t\"name\": \"quantity\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Quantity\"\r\n\t} as FieldItemInt,\r\n\tamount: {\r\n\t\t\"name\": \"amount\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Amount\"\r\n\t} as FieldItemInt,\r\n};\r\n/*==fields==*/\r\n\r\nexport const fieldArr: FieldItem[] = [\r\n\tfields.holding, fields.tick, fields.price, fields.quantity, fields.amount, \r\n];\r\n\r\nexport const ui: UI = {\r\n\tlabel: \"Transaction\",\r\n\tfieldArr,\r\n\tfields,\r\n};\r\n\r\nexport const res: Res<any> = {\r\n\tzh: {\r\n\t},\r\n\ten: {\r\n\t}\r\n};\r\n\r\nexport function render(item: Transaction):JSX.Element {\r\n\treturn <>{JSON.stringify(item)}</>;\r\n};\r\n","import { Res, UI } from \"tonva-react\";\r\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\nimport { FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-react\";\r\nimport { Stock } from \"./BruceYuMi\";\r\n\r\n/*--fields--*/\r\nconst fields = {\r\n\tid: {\r\n\t\t\"name\": \"id\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": false,\r\n\t\t\"label\": \"Id\"\r\n\t} as FieldItemId,\r\n\tmarket: {\r\n\t\t\"name\": \"market\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": true,\r\n\t\t\"label\": \"Market\"\r\n\t} as FieldItemId,\r\n\tcode: {\r\n\t\t\"name\": \"code\",\r\n\t\t\"type\": \"string\",\r\n\t\t\"isKey\": true,\r\n\t\t\"widget\": \"string\",\r\n\t\t\"label\": \"Code\"\r\n\t} as FieldItemString,\r\n\tname: {\r\n\t\t\"name\": \"name\",\r\n\t\t\"type\": \"string\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"string\",\r\n\t\t\"label\": \"Name\"\r\n\t} as FieldItemString,\r\n};\r\n/*==fields==*/\r\n\r\nexport const fieldArr: FieldItem[] = [\r\n\tfields.market, fields.code, fields.name, \r\n];\r\n\r\nexport const ui: UI = {\r\n\tlabel: \"Stock\",\r\n\tfieldArr,\r\n\tfields,\r\n};\r\n\r\nexport const res: Res<any> = {\r\n\tzh: {\r\n\t},\r\n\ten: {\r\n\t}\r\n};\r\n\r\nexport function render(item: Stock):JSX.Element {\r\n\treturn <>{JSON.stringify(item)}</>;\r\n};\r\n","import { Res, UI } from \"tonva-react\";\r\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\nimport { FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-react\";\r\nimport { Market } from \"./BruceYuMi\";\r\n\r\n/*--fields--*/\r\nconst fields = {\r\n\tid: {\r\n\t\t\"name\": \"id\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": false,\r\n\t\t\"label\": \"Id\"\r\n\t} as FieldItemId,\r\n\tname: {\r\n\t\t\"name\": \"name\",\r\n\t\t\"type\": \"string\",\r\n\t\t\"isKey\": true,\r\n\t\t\"widget\": \"string\",\r\n\t\t\"label\": \"Name\"\r\n\t} as FieldItemString,\r\n\tcurrency: {\r\n\t\t\"name\": \"currency\",\r\n\t\t\"type\": \"string\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"string\",\r\n\t\t\"label\": \"Currency\"\r\n\t} as FieldItemString,\r\n};\r\n/*==fields==*/\r\n\r\nexport const fieldArr: FieldItem[] = [\r\n\tfields.name, fields.currency, \r\n];\r\n\r\nexport const ui: UI = {\r\n\tlabel: \"Market\",\r\n\tfieldArr,\r\n\tfields,\r\n};\r\n\r\nexport const res: Res<any> = {\r\n\tzh: {\r\n\t},\r\n\ten: {\r\n\t}\r\n};\r\n\r\nexport function render(item: Market):JSX.Element {\r\n\treturn <>{JSON.stringify(item)}</>;\r\n};\r\n","import { Res, UI } from \"tonva-react\";\r\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\nimport { FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-react\";\r\nimport { Portfolio } from \"./BruceYuMi\";\r\n\r\n/*--fields--*/\r\nconst fields = {\r\n\tid: {\r\n\t\t\"name\": \"id\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": false,\r\n\t\t\"label\": \"Id\"\r\n\t} as FieldItemId,\r\n\tquantity: {\r\n\t\t\"name\": \"quantity\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Quantity\"\r\n\t} as FieldItemInt,\r\n};\r\n/*==fields==*/\r\n\r\nexport const fieldArr: FieldItem[] = [\r\n\tfields.quantity, \r\n];\r\n\r\nexport const ui: UI = {\r\n\tlabel: \"Portfolio\",\r\n\tfieldArr,\r\n\tfields,\r\n};\r\n\r\nexport const res: Res<any> = {\r\n\tzh: {\r\n\t},\r\n\ten: {\r\n\t}\r\n};\r\n\r\nexport function render(item: Portfolio):JSX.Element {\r\n\treturn <>{JSON.stringify(item)}</>;\r\n};\r\n","import { Res, UI } from \"tonva-react\";\r\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\nimport { FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-react\";\r\nimport { StockValue } from \"./BruceYuMi\";\r\n\r\n/*--fields--*/\r\nconst fields = {\r\n\tid: {\r\n\t\t\"name\": \"id\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": false,\r\n\t\t\"label\": \"Id\"\r\n\t} as FieldItemId,\r\n\tmiRate: {\r\n\t\t\"name\": \"miRate\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"MiRate\"\r\n\t} as FieldItemInt,\r\n\tttm: {\r\n\t\t\"name\": \"ttm\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Ttm\"\r\n\t} as FieldItemInt,\r\n\tdivident: {\r\n\t\t\"name\": \"divident\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Divident\"\r\n\t} as FieldItemInt,\r\n\tprice: {\r\n\t\t\"name\": \"price\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Price\"\r\n\t} as FieldItemInt,\r\n\troe: {\r\n\t\t\"name\": \"roe\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Roe\"\r\n\t} as FieldItemInt,\r\n\tinc1: {\r\n\t\t\"name\": \"inc1\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Inc1\"\r\n\t} as FieldItemInt,\r\n\tinc2: {\r\n\t\t\"name\": \"inc2\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Inc2\"\r\n\t} as FieldItemInt,\r\n\tinc3: {\r\n\t\t\"name\": \"inc3\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Inc3\"\r\n\t} as FieldItemInt,\r\n\tinc4: {\r\n\t\t\"name\": \"inc4\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Inc4\"\r\n\t} as FieldItemInt,\r\n\tpreInc: {\r\n\t\t\"name\": \"preInc\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"PreInc\"\r\n\t} as FieldItemInt,\r\n\tmarketValue: {\r\n\t\t\"name\": \"marketValue\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"MarketValue\"\r\n\t} as FieldItemInt,\r\n};\r\n/*==fields==*/\r\n\r\nexport const fieldArr: FieldItem[] = [\r\n\tfields.miRate, fields.ttm, fields.divident, fields.price, fields.roe, fields.inc1, fields.inc2, fields.inc3, fields.inc4, fields.preInc, fields.marketValue, \r\n];\r\n\r\nexport const ui: UI = {\r\n\tlabel: \"StockValue\",\r\n\tfieldArr,\r\n\tfields,\r\n};\r\n\r\nexport const res: Res<any> = {\r\n\tzh: {\r\n\t},\r\n\ten: {\r\n\t}\r\n};\r\n\r\nexport function render(item: StockValue):JSX.Element {\r\n\treturn <>{JSON.stringify(item)}</>;\r\n};\r\n","import { Res, UI } from \"tonva-react\";\r\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\nimport { FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-react\";\r\nimport { AccountValue } from \"./BruceYuMi\";\r\n\r\n/*--fields--*/\r\nconst fields = {\r\n\tid: {\r\n\t\t\"name\": \"id\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": false,\r\n\t\t\"label\": \"Id\"\r\n\t} as FieldItemId,\r\n\tmi: {\r\n\t\t\"name\": \"mi\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Mi\"\r\n\t} as FieldItemInt,\r\n\tmarket: {\r\n\t\t\"name\": \"market\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Market\"\r\n\t} as FieldItemInt,\r\n\tcount: {\r\n\t\t\"name\": \"count\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Count\"\r\n\t} as FieldItemInt,\r\n};\r\n/*==fields==*/\r\n\r\nexport const fieldArr: FieldItem[] = [\r\n\tfields.mi, fields.market, fields.count, \r\n];\r\n\r\nexport const ui: UI = {\r\n\tlabel: \"AccountValue\",\r\n\tfieldArr,\r\n\tfields,\r\n};\r\n\r\nexport const res: Res<any> = {\r\n\tzh: {\r\n\t},\r\n\ten: {\r\n\t}\r\n};\r\n\r\nexport function render(item: AccountValue):JSX.Element {\r\n\treturn <>{JSON.stringify(item)}</>;\r\n};\r\n","import { Res, UI } from \"tonva-react\";\r\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\nimport { FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-react\";\r\nimport { UserAccount } from \"./BruceYuMi\";\r\n\r\n/*--fields--*/\r\nconst fields = {\r\n\tid: {\r\n\t\t\"name\": \"id\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": false,\r\n\t\t\"label\": \"Id\"\r\n\t} as FieldItemId,\r\n\tid2: {\r\n\t\t\"name\": \"id2\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": false,\r\n\t\t\"label\": \"Id2\"\r\n\t} as FieldItemId,\r\n};\r\n/*==fields==*/\r\n\r\nexport const fieldArr: FieldItem[] = [\r\n\t\r\n];\r\n\r\nexport const ui: UI = {\r\n\tlabel: \"UserAccount\",\r\n\tfieldArr,\r\n\tfields,\r\n};\r\n\r\nexport const res: Res<any> = {\r\n\tzh: {\r\n\t},\r\n\ten: {\r\n\t}\r\n};\r\n\r\nexport function render(item: UserAccount):JSX.Element {\r\n\treturn <>{JSON.stringify(item)}</>;\r\n};\r\n","export const consts = {\r\n    uqBasedata: \"bruce/mi\",\r\n    appIcon: 'https://tv.jkchemical.com/imgs/Bear-icon.png',\r\n    miApiHost: 'https://mi.jjol.cn/',\r\n    miApiHostDebug: 'http://localhost:6010/',\r\n    isDevelopment: process.env.NODE_ENV === 'development',\r\n}\r\n\r\nexport const defaultTagName = '自选股';\r\nexport const defaultBlackListTagName = '黑名单';\r\n\r\n","export class SlrForEarning {\r\n  slope: number;\r\n  intercept: number;\r\n  y: number[];\r\n  slopeR: number;\r\n  endY: number;\r\n  r2: number;\r\n\r\n  constructor(y:number[]) {\r\n    this.y = y;\r\n    this.regress();\r\n    let score = this.score();\r\n    this.r2 = score.r2;\r\n  }\r\n\r\n  regress() {\r\n    const n = this.y.length;\r\n    let xSum = 0;\r\n    let ySum = 0;\r\n  \r\n    let xSquared = 0;\r\n    let xY = 0;\r\n  \r\n    for (let x = 0; x < n; ++x) {\r\n      xSum += x;\r\n      ySum += this.y[x];\r\n      xSquared += x * x;\r\n      xY += x * this.y[x];\r\n    }\r\n  \r\n    const numerator = n * xY - xSum * ySum;\r\n    this.slope = numerator / (n * xSquared - xSum * xSum);\r\n    this.intercept = (1 / n) * ySum - this.slope * (1 / n) * xSum;\r\n\r\n    let ym = this.slope > 0 ? this.predict(n-2) : this.predict(1);\r\n    this.slopeR = ym < 0.01 ? undefined : this.slope / ym;\r\n  }\r\n\r\n  score() {\r\n    const n = this.y.length;\r\n    const y2 = new Array(n);\r\n    for (let i = 0; i < n; i++) {\r\n      y2[i] = this.predict(i);\r\n    }\r\n\r\n    let xSum = 0;\r\n    let ySum = 0;\r\n    let chi2 = 0;\r\n    let rmsd = 0;\r\n    let xSquared = 0;\r\n    let ySquared = 0;\r\n    let xY = 0;\r\n    for (let i = 0; i < n; i++) {\r\n      let yi2 = y2[i];\r\n      xSum += yi2;\r\n      let yi = this.y[i];\r\n      ySum += yi;\r\n      xSquared += yi2 * yi2;\r\n      ySquared += yi * yi;\r\n      xY += yi2 * yi;\r\n      let yiyi2 = yi - yi2;\r\n      if (yi !== 0) {\r\n        chi2 += (yiyi2 * yiyi2) / yi;\r\n      }\r\n      rmsd += yiyi2 * yiyi2;\r\n    }\r\n\r\n    const r =\r\n      (n * xY - xSum * ySum) /\r\n      Math.sqrt((n * xSquared - xSum * xSum) * (n * ySquared - ySum * ySum));\r\n\r\n    return {\r\n      r: r,\r\n      r2: r * r,\r\n      chi2: chi2,\r\n      rmsd: Math.sqrt(rmsd / n)\r\n    };\r\n  }\r\n\r\n\r\n  predict(x:number) {\r\n    return this.slope * x + this.intercept;\r\n  }\r\n\r\n  computeX(y:number) {\r\n    return (y - this.intercept) / this.slope;\r\n  }\r\n}\r\n","export class ErForEarning {\r\n  A:number;\r\n  B:number;\r\n  y: number[];\r\n  r2: number;\r\n\r\n  constructor(y:number[]) {\r\n    this.y = y;\r\n    this.regress();\r\n    let score = this.score();\r\n    this.r2 = score.r2;\r\n  }\r\n\r\n  regress() {\r\n    const n = this.y.length;\r\n    let xSum = 0;\r\n    let ySum = 0;\r\n  \r\n    let xSquared = 0;\r\n    let xY = 0;\r\n  \r\n    for (let x = 0; x < n; ++x) {\r\n      xSum += x;\r\n      let yx = Math.log(this.y[x]);\r\n      ySum += yx;\r\n      xSquared += x * x;\r\n      xY += x * yx;\r\n    }\r\n  \r\n    const numerator = n * xY - xSum * ySum;\r\n    let slope = numerator / (n * xSquared - xSum * xSum);\r\n    let intercept = (1 / n) * ySum - slope * (1 / n) * xSum;\r\n    this.A = Math.exp(intercept);\r\n    this.B = slope;\r\n  }\r\n\r\n  score() {\r\n    const n = this.y.length;\r\n    const y2 = new Array(n);\r\n    for (let i = 0; i < n; i++) {\r\n      y2[i] = this.predict(i);\r\n    }\r\n\r\n    let xSum = 0;\r\n    let ySum = 0;\r\n    let chi2 = 0;\r\n    let rmsd = 0;\r\n    let xSquared = 0;\r\n    let ySquared = 0;\r\n    let xY = 0;\r\n    for (let i = 0; i < n; i++) {\r\n      let yi2 = y2[i];\r\n      xSum += yi2;\r\n      let yi = this.y[i];\r\n      ySum += yi;\r\n      xSquared += yi2 * yi2;\r\n      ySquared += yi * yi;\r\n      xY += yi2 * yi;\r\n      let yiyi2 = yi - yi2;\r\n      if (yi !== 0) {\r\n        chi2 += (yiyi2 * yiyi2) / yi;\r\n      }\r\n      rmsd += yiyi2 * yiyi2;\r\n    }\r\n\r\n    const r =\r\n      (n * xY - xSum * ySum) /\r\n      Math.sqrt((n * xSquared - xSum * xSum) * (n * ySquared - ySum * ySum));\r\n\r\n    return {\r\n      r: r,\r\n      r2: r * r,\r\n      chi2: chi2,\r\n      rmsd: Math.sqrt(rmsd / n)\r\n    };\r\n  }\r\n\r\n  predict(x:number) {\r\n    return this.A * Math.exp(x * this.B);\r\n  }\r\n}\r\n","import React from 'react';\r\nimport { NavView, start } from 'tonva-react';\r\n//import logo from './logo.svg';\r\nimport './App.css';\r\nimport { CApp } from './UqApp';\r\nimport { appConfig } from './appConfig';\r\n/*\r\nfunction App() {\r\n  return (\r\n    <div className=\"App\">\r\n      <header className=\"App-header\">\r\n        <img src={logo} className=\"App-logo\" alt=\"logo\" />\r\n        <p>\r\n          Edit <code>src/App.tsx</code> and save to reload.\r\n        </p>\r\n        <a\r\n          className=\"App-link\"\r\n          href=\"https://reactjs.org\"\r\n          target=\"_blank\"\r\n          rel=\"noopener noreferrer\"\r\n        >\r\n          Learn React\r\n        </a>\r\n      </header>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;\r\n*/\r\nclass App extends React.Component {\r\n  \r\n\tprivate onLogined = async () => {\r\n\t  await start(CApp, appConfig);\r\n\t}\r\n\tpublic render() {\r\n\t  return <NavView onLogined={this.onLogined} />\r\n\t}\r\n}\r\n\r\nexport default App;\r\n  ","import { ReportHandler } from 'web-vitals';\r\n\r\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\r\n  if (onPerfEntry && onPerfEntry instanceof Function) {\r\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\r\n      getCLS(onPerfEntry);\r\n      getFID(onPerfEntry);\r\n      getFCP(onPerfEntry);\r\n      getLCP(onPerfEntry);\r\n      getTTFB(onPerfEntry);\r\n    });\r\n  }\r\n};\r\n\r\nexport default reportWebVitals;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport 'bootstrap/dist/css/bootstrap.css';\r\nimport './index.css';\r\nimport App from './App';\r\nimport reportWebVitals from './reportWebVitals';\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n","//=== UqApp builder created on Tue Jan 12 2021 23:14:51 GMT-0500 (GMT-05:00) ===//\r\nimport { AppConfig, DevConfig } from \"tonva-react\";\r\n\r\nconst bruce: DevConfig = {\r\n\tname: 'bruce',\r\n\talias: undefined,\r\n}\r\n\r\nexport const appConfig: AppConfig = {\r\n\tversion: '0.1.0',\t\t// 界面端app的版本\r\n\tapp: undefined,\r\n\tuqs: [\r\n\t\t{\r\n\t\t\tdev: bruce,\r\n\t\t\tname: 'yumi',\r\n\t\t\talias: 'YuMi',\r\n\t\t\tversion: '0.1.0',\r\n\t\t},\r\n\t],\r\n\tnoUnit: true,\r\n    tvs: {},\r\n\toem: undefined,\r\n\thtmlTitle: '鱼米乡 - 私享投资圈',\r\n};\r\n","//=== UqApp builder created on Mon Mar 01 2021 23:10:09 GMT-0500 (GMT-05:00) ===//\r\nimport { CSub, CBase, CAppBase, IConstructor } from 'tonva-react';\r\nimport { UQs } from './uqs';\r\nimport { CApp } from './CApp';\r\n\r\nexport abstract class CUqBase extends CBase<CApp, UQs> {\r\n}\r\n\r\nexport abstract class CUqSub<A extends CAppBase<U>, U, T extends CBase<A,U>> extends CSub<A, U, T> {\r\n}\r\n\r\nexport abstract class CUqApp extends CAppBase<UQs> {\r\n\tprotected newC<T extends CUqBase>(type: IConstructor<T>): T {\r\n\t\tlet c = new type(this);\r\n\t\tc.init();\r\n\t\treturn c;\r\n\t}\r\n}\r\n","export default __webpack_public_path__ + \"static/media/logo.2d27ead7.svg\";","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport * as React from 'react';\r\nimport { View, nav } from 'tonva-react';\r\nimport { LMR, FA, SearchBox } from 'tonva-react';\r\nimport logo from '../images/logo.svg';\r\nimport { CHome } from './CHome';\r\n\r\nexport class VSiteHeader extends View<CHome> {\r\n    render() {\r\n        let currentSalesRegion = <FA name=\"globe\" />\r\n        let login = <div>\r\n            登录\r\n        </div>\r\n        let left = <img className=\"m-1\" src={logo} alt=\"logo\" style={{height: \"3rem\", width: \"3rem\"}} />;\r\n        //let cart = this.controller.cApp.cCart.renderCartLabel();\r\n        let right = undefined;\r\n        /*\r\n        <div className=\"d-flex flex-row mr-1 align-items-center\">\r\n            {currentSalesRegion} &nbsp;\r\n            <button onClick={()=>nav.start()}>Try</button>\r\n        </div>;*/\r\n        return <LMR\r\n            className=\"mb-3 align-items-center bg-white\"\r\n            left={left} right={right}>\r\n            <div className=\"\">\r\n                {this.controller.renderSearchHeader('md')}\r\n            </div>\r\n        </LMR>\r\n    }\r\n}","import * as React from 'react';\r\nimport { View } from 'tonva-react';\r\nimport { CHome } from './CHome';\r\nimport { SearchBox } from 'tonva-react';\r\n\r\nexport class VSearchHeader extends View<CHome> {\r\n\r\n    private onSearch = async (key: string) => {\r\n        // let { cProduct } = this.controller.cApp;\r\n        // cProduct.start(key);\r\n    }\r\n\r\n    render(param: any) {\r\n        return <SearchBox className=\"px-1 w-100\" \r\n            size={param}\r\n            onSearch={this.onSearch} \r\n            placeholder=\"功能...\" />\r\n    }\r\n}","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport * as React from 'react';\r\nimport { FA, LMR } from 'tonva-react';\r\nimport { NStockInfo } from '../stockinfo';\r\nimport {percent0, percent1, number, numberToMarketValue, calculateZZ3} from '../tool';\r\n\r\nfunction renderSortCol(radioName:string, sortMethod:string, caption:string, sort: (sortMethod:string) => void, checked:boolean = false) {\r\n\treturn <label className=\"btn btn-outline-info mb-0\">\r\n\t\t<input type=\"radio\" className=\"btn-sm btn-check mr-1\"\r\n\t\t\tname={radioName} defaultChecked={checked}\r\n\t\t\tonClick={() => sort(sortMethod)} />\r\n\t\t{caption}\r\n\t</label>\r\n}\r\n\r\nexport function renderSortHeaders(radioName:string, sort: (sortMethod:string) => void) {\r\n\treturn <div className=\"my-1 justify-content-end mr-2\">\r\n\t\t<div className=\"btn-group\" role=\"group\" aria-label=\"Basic radio toggle button group\">\r\n\t\t\t{renderSortCol(radioName, 'tagv', '米息率', sort, true)}\r\n\t\t\t{renderSortCol(radioName, 'tagpe', 'TTM', sort)}\r\n\t\t\t{renderSortCol(radioName, 'tagdp', '股息率', sort)}\r\n\t\t</div>\r\n\t</div>;\r\n}\r\n\r\nfunction renderValue(caption:string, value:number, valueType:'p0'|'p1'|'n1'|'n2'|'yi'):JSX.Element {\r\n\tconst _cn = 'px-2 mb-2 text-right '; \r\n\tlet cn = _cn + 'c5';\r\n\tlet cnYI = _cn + 'c5'\r\n\tlet vStr:string;\r\n\tswitch (valueType) {\r\n\t\tcase 'p0': vStr = percent0(value); break;\r\n\t\tcase 'p1': vStr = percent1(value); break;\r\n\t\tcase 'n1': vStr = number(value, 1); break;\r\n\t\tcase 'n2': vStr = number(value, 2); break;\r\n\t\tcase 'yi': \r\n\t\t\tvStr = numberToMarketValue(value);\r\n\t\t\tcn = cnYI;\r\n\t\t\tbreak;\r\n\t}\r\n\treturn <div key={caption} className={cn}>\r\n\t\t<span className=\"text-muted small\">{caption}</span><br />\r\n\t\t{vStr}\r\n\t</div>;\r\n}\r\n\r\nexport function renderStockInfoRow(row: NStockInfo, onClickName: (row:NStockInfo) => void, inputSelect:JSX.Element, right:JSX.Element):JSX.Element {\r\n  \tlet { id, name, code, pe, roe, price, divyield, v, order, symbol, l, e, ep, e3, total } = row;\r\n  \tlet zzl = calculateZZ3((row as any).dataArr);\r\n  \tlet left = <div className=\"cursor-pointer\" onClick={()=>onClickName(row)}>\r\n\t\t<span className=\"text-primary\">{name}</span>\r\n\t\t&nbsp; \r\n\t\t<span className=\"text-info\">{code}</span>\r\n\t  \t&nbsp;\r\n\t\t<small className=\"small ml-1\"><span className=\"text-danger\">{order}</span></small>\r\n  \t</div>;\r\n\tlet rows:[string,number,'p0'|'p1'|'n1'|'n2'|'yi'][] = [\r\n\t\t['米息率', v, 'n1'],\r\n\t\t['TTM', pe, 'n1'],\r\n\t\t['股息率', divyield*100, 'n1'],\r\n\t\t['价格', price, 'n2'],\r\n\t\t['ROE', roe*100, 'n1'],\r\n\t\t['预增', l, 'p0'],\r\n\t\t['现增', zzl[3], 'p0'],\r\n\t\t['增 1', zzl[2], 'p0'],\r\n\t\t['增 2', zzl[1], 'p0'],\r\n\t\t['增 3', zzl[0], 'p0'],\r\n\t\t['市值', total*price, 'yi'],\r\n  \t];\r\n\tlet inputSelectSpan:any;\r\n\tif (inputSelect) {\r\n\t\tinputSelectSpan = <span className=\"ml-4\">{inputSelect}</span>\r\n\t}\r\n  \treturn <div className=\"d-block border-top\">\r\n\t\t<LMR className=\"px-2 py-1 bg-light\" left={left} right = {right}>{inputSelectSpan}</LMR>\r\n\t\t<div className=\"d-flex flex-wrap\" >\r\n\t\t\t{rows.map(v => renderValue(v[0], v[1], v[2]))}\r\n\t  \t</div>\r\n  \t</div>;\r\n}\r\n\r\nexport function renderStockUrl(row: NStockInfo) {\r\n    let { symbol } = row;\r\n\treturn <a className=\"text-info\" href={`https://finance.sina.com.cn/realstock/company/${symbol}/nc.shtml`} target=\"_blank\" rel=\"noopener noreferrer\" onClick={(e)=>{e.stopPropagation();}}>\r\n\t\t<FA name=\"angle-double-right\" />\r\n\t</a>;\r\n}\r\n","export function numberToFixString(n: number, w = 2) {\r\n    return n === undefined ? '' : n.toFixed(w);\r\n}\r\n\r\nexport function number(n: number, w=2) {\r\n\treturn n === undefined ? '' : n.toFixed(w);\r\n}\r\n\r\nexport function numberToMarketValue(n: number) {\r\n\treturn n === undefined || isNaN(n) ? '' : Math.round(n/10000).toString(); // + '亿';\r\n}\r\n\r\nexport function numberToString(n: number, precision = 2) {\r\n\treturn n === undefined ? '' : n.toPrecision(precision);\r\n}\r\n\r\nexport function numberToPrecision(n: number, precision = 4) {\r\n\treturn n === undefined ? undefined : Number.parseFloat(n.toPrecision(precision));\r\n}\r\n\r\nexport function percentToFixString(n: number) {\r\n\treturn n === undefined || isNaN(n) ? '' : (n * 100).toFixed(2) + '%';\r\n}\r\n\r\nexport function percent0(n: number) {\r\n\treturn n === undefined || isNaN(n) ? '' : (n * 100).toFixed(0) + '%';\r\n}\r\nexport function percent1(n: number) {\r\n\treturn n === undefined || isNaN(n) ? '' : (n * 100).toFixed(1) + '%';\r\n}\r\n\r\nexport function warningTypeString(t: string) {\r\n\tswitch (t) {\r\n\t\tcase 'gt': return '大于';\r\n\t\tcase 'lt': return '小于';\r\n\t\tdefault: return t;\r\n\t}\r\n}\r\n\r\nexport function predictCutRatio(r2:number) {\r\n\treturn r2 * 2 - r2 * r2;\r\n}\r\n\r\nexport function evaluatePricePrice(iRate:number, e1:number, e2:number, e3:number) {\r\n\tlet r = 1 + iRate;\r\n\tlet r2 = r * r;\r\n\tlet r3 = r2 * r;\r\n\treturn (e1/r + e2 /r2 + e3 / r3 + e3 / iRate / r3) / 2;\r\n}\r\n\r\nexport function calculateV(z:number, divyield:number, pe:number) {\r\n\tif (pe === undefined || isNaN(pe)) {\r\n\t\treturn undefined;\r\n\t}\r\n\r\n\tlet r = 0;\r\n\tif (z !== undefined) {\r\n\t\tif (z > 0.25) {\r\n\t\tz = 0.25;\r\n\t\t}\r\n\t\tr += z * 100;\r\n\t}\r\n\tif (divyield !== undefined) {\r\n\t\tr += divyield * 100;\r\n\t}\r\n\treturn r / pe;\r\n}\r\n\r\nexport function calculateVN(z:number, e:number, bonus:number, price:number) {\r\n\tif (price === undefined || isNaN(price) || e === undefined || isNaN(e)) {\r\n\t\treturn undefined;\r\n\t}\r\n\r\n\tlet r = 0;\r\n\tif (z !== undefined && e > 0) {\r\n\t\tif (z > 0.25) {\r\n\t\tz = 0.24 + Math.pow((z-0.24)*100, 0.6667) / 100;\r\n\t\t}\r\n\t\tz = 1 + z;\r\n\t\tz = z * z * z - 1;\r\n\t\tr += z * e * 100;\r\n\t}\r\n\tif (bonus !== undefined && !isNaN(bonus)) {\r\n\t\tr += bonus * 100;\r\n\t}\r\n\treturn r / price;\r\n}\r\n\r\nexport function calculateZZ3(data:number[]) {\r\n\tlet ret:number[] = [undefined, undefined, undefined, undefined] ;\r\n\tif (data === undefined)\r\n\t\treturn ret;\r\n\tlet len = data.length;\r\n\tif (len < 5)\r\n\t\treturn ret;\r\n\r\n\tlet funcz = (n:number, p:number) => {\r\n\t\tif (p <= 0 || n <= 0)\r\n\t\treturn undefined;\r\n\t\treturn ((n / p) - 1);\r\n\t}\r\n\tfor (let i = 0; i < 4; ++i) {\r\n\t\tret[i] = funcz(data[i+1], data[i]);\r\n\t}\r\n\treturn ret;\r\n}\r\n\r\n//export function caption = (value:string) => <span className=\"text-muted small\">{value}</span>;\r\n\r\nexport function MonthnoFromDay(day:number) {\r\n\tlet year = Math.floor(day/10000);\r\n\tlet month = Math.floor((day%10000)/100) - 1;\r\n\treturn (year-1995)*12+month;\r\n}\r\n\r\nexport function SeasonnoFromDay(day:number) {\r\n\tlet year = Math.floor(day/10000);\r\n\tlet month = Math.floor((day%10000)/100) - 1;\r\n\tlet season = Math.floor(month / 3);\r\n\treturn (year-1995)*4 + season;\r\n}\r\n\r\nexport function SeasonnoFromYearMonth(year:number, month:number) {\r\n\tlet season = Math.floor((month-1) / 3);\r\n\treturn (year-1995)*4 + season;\r\n}\r\n\r\nexport function SeasonnoToYearMonth(no: number) {\r\n\tlet year = Math.floor(no / 4) + 1995;\r\n\tlet month = (Math.floor(no % 4) + 1) * 3;\r\n\treturn year * 100 + month;\r\n}\r\n\r\nexport function SeasonnoToBeginEnd(season:number) {\r\n\tlet year = (1995 + Math.floor(season / 4)) * 10000;\r\n\tlet s = season % 4;\r\n\tif (s === 0) {\r\n\t\treturn {begin: year + 101, end: year + 331};\r\n\t} \r\n\tif (s === 1) {\r\n\t\treturn {begin: year + 401, end: year + 630};\r\n\t}\r\n\tif (s === 2) {\r\n\t\treturn {begin: year + 701, end: year + 930};\r\n\t}\r\n\treturn {begin: year + 1001, end: year + 1231};\r\n}\r\n\r\nexport function CalculatePredictAvg(arr: {predictpe:number}[]) {\r\n\tlet ret : {avg20:number, avg50:number, avg100:number} = {avg20:undefined, avg50:undefined, avg100:undefined};\r\n\r\n\tlet length = arr.length;\r\n\tlet calcuOne = (count:number) : number => {\r\n\t\tlet endIndex = count;\r\n\t\tif (endIndex > length)\r\n\t\tendIndex = length;\r\n\t\tif (endIndex >= 10) {\r\n\t\tlet sum = 0;\r\n\t\tfor (let i = 3; i < endIndex; ++i) {\r\n\t\t\tsum += arr[i].predictpe\r\n\t\t}\r\n\t\treturn sum / (endIndex - 3);\r\n\t\t}\r\n\t\telse {\r\n\t\treturn undefined;\r\n\t\t}\r\n\t}\r\n\r\n\tret.avg20 = calcuOne(20);\r\n\tret.avg50 = calcuOne(50);\r\n\tret.avg100 = calcuOne(100);\r\n\treturn ret;\r\n}\r\n\r\nexport function CalculateValueAvg(arr: {v:number}[]) {\r\n\tlet ret : {avg20:number, avg50:number, avg100:number, avg:number} = {avg20:undefined, avg50:undefined, avg100:undefined, avg:undefined};\r\n\r\n\tlet length = arr.length;\r\n\tlet calcuOne = (count:number) : number => {\r\n\t\tlet endIndex = count;\r\n\t\tif (count === 0 || endIndex > length)\r\n\t\tendIndex = length;\r\n\t\tif (endIndex >= 10) {\r\n\t\tlet sum = 0;\r\n\t\tfor (let i = 3; i < endIndex; ++i) {\r\n\t\t\tsum += arr[i].v;\r\n\t\t}\r\n\t\treturn sum / (endIndex - 3);\r\n\t\t}\r\n\t\telse {\r\n\t\treturn undefined;\r\n\t\t}\r\n\t}\r\n\r\n\tret.avg20 = calcuOne(20);\r\n\tret.avg50 = calcuOne(50);\r\n\tret.avg100 = calcuOne(100);\r\n\tret.avg = calcuOne(0);\r\n\treturn ret;\r\n}\r\n","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport * as React from 'react';\r\nimport { observer } from 'mobx-react';\r\nimport { VPage, List, LMR, FA, Scroller } from 'tonva-react';\r\nimport { NStockInfo } from '../stockinfo';\r\nimport { CHome } from './CHome';\r\nimport { renderSortHeaders, renderStockInfoRow, renderStockUrl } from '../tool';\r\n\r\nexport class VHome extends VPage<CHome> {\r\n  header() {\r\n    return '首页'\r\n  }\r\n  right() {\r\n  \treturn <button className=\"btn btn-sm btn-info mr-2\"\r\n\t  \tonClick={()=>{this.controller.openMarketPE()}}>\r\n\t\t  市场平均PE\r\n\t  </button>;\r\n  }\r\n\r\n  protected onPageScrollBottom(scroller: Scroller): Promise<void> {\r\n\tthis.controller.onPage();\r\n\treturn;\r\n  }\r\n\r\n  private setSortType = (type:string) => {\r\n    this.controller.setSortType(type);\r\n  }\r\n\r\n  content() {\r\n\t  return React.createElement(observer(() => {\r\n      let title = this.controller.cApp.config.tagName;\r\n      let { items } = this.controller;\r\n      let { onSelectTag, onAddStock } = this.controller;\r\n      let right = <div className=\"d-flex\">\r\n        <div className=\"btn cursor-pointer\" onClick={onAddStock}><FA name=\"plus\" inverse={false} /></div>\r\n        <div className=\"btn cursor-pointer ml-2\" onClick={onSelectTag}><FA name=\"bars\" inverse={false} /></div>\r\n      </div>;\r\n      let left = <div className=\"align-self-center\">{title}</div>\r\n      return <div>\r\n      <LMR className=\"px-2 py-1\" left={left} right={right}></LMR>\r\n      <List header={renderSortHeaders('radioHome', this.setSortType)}\r\n        items={items}\r\n        item={{ render: this.renderRow, key: this.rowKey }}\r\n        before={'搜索'}\r\n        none={<small className=\"px-2 py-3 text-info\">无自选股, 请选股</small>}\r\n      />\r\n      </div>;\r\n    }));\r\n  }\r\n\r\n  renderRow = (item: any, index: number): JSX.Element => { //<this.rowContent {...item} />;\r\n    return this.rowContent(item);\r\n  } \r\n  protected rowContent = (row: any): JSX.Element => {\r\n    let right = renderStockUrl(row);\r\n\treturn renderStockInfoRow(row, this.onClickName, null, right);\r\n  }\r\n\r\n  private rowKey = (item: any) => {\r\n    let { id } = item;\r\n    return id;\r\n  }\r\n\r\n  protected onClickName = (item: NStockInfo) => {\r\n    this.controller.openStockInfo(item);\r\n  }\r\n\r\n  protected onSelected = async (item: any): Promise<void> => {\r\n    let a = 0;\r\n  }\r\n\r\n  private callOnSelected(item: any) {\r\n    if (this.onSelected === undefined) {\r\n      alert('onSelect is undefined');\r\n      return;\r\n    }\r\n    this.onSelected(item);\r\n  }\r\n  clickRow = (item: any) => {\r\n    this.callOnSelected(item);\r\n  }\r\n}","import * as React from 'react';\r\nimport { observer } from 'mobx-react-lite';\r\nimport { VPage, Page, List } from 'tonva-react';\r\nimport { CHome } from './CHome';\r\n\r\nexport class VSelectTag extends VPage<CHome> {\r\n    async open(param?: any) {\r\n        this.openPage(this.page);\r\n    }\r\n\r\n    private renderTag = (tag:any) => {\r\n        return <div className=\"px-3 py-2 cursor-pointer\">{tag.name}</div>;\r\n    }\r\n\r\n    private page = observer(() => {\r\n        let {tags} = this.controller.cApp;\r\n        let { onClickTag } = this.controller;\r\n        return <Page header=\"选择分组\" headerClassName=\"bg-primary\">\r\n            <List items={tags} item={{onClick:onClickTag, render:this.renderTag}} />\r\n        </Page>;\r\n    })\r\n}\r\n","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport * as React from 'react';\r\nimport classNames from 'classnames';\r\nimport { VPage, Page, View, List, LMR, left0, FA } from 'tonva-react';\r\nimport { observable } from 'mobx';\r\nimport { observer } from 'mobx-react';\r\nimport RC2 from 'react-chartjs2'\r\nimport { GFunc } from '../tool/GFunc';\r\nimport {CMarketPE } from './CMarketPE'\r\n\r\nexport class VMarketPE extends VPage<CMarketPE> {\r\n  private input: HTMLInputElement;\r\n  private key: string = undefined;\r\n\r\n  async open(param?: any) {\r\n    this.openPage(this.page);\r\n  }\r\n\r\n  render(param: any): JSX.Element {\r\n    return <this.page />\r\n  }\r\n\r\n  checkLimitShow = (e)=> {\r\n    let check = e.target.checked as boolean;\r\n    let f = check ? 1:0;\r\n    this.controller.onLongShortFlag(f);\r\n  }\r\n\r\n  private page = observer(() => {\r\n  let head = <div >{''}</div>\r\n    return <Page header={head}\r\n      headerClassName='bg-primary'>\r\n      <this.pageContent />\r\n    </Page>;\r\n  })\r\n\r\n  private pageContent = observer(() => {\r\n    return <>\r\n      <this.historyChart />\r\n    </>\r\n  });\r\n\r\n  protected historyChart = observer(() => {\r\n    let {historyData} = this.controller;\r\n    if (historyData === undefined) \r\n      return <></>;\r\n    let chartHistory = <></>;\r\n    let labelList:any[] = [];\r\n    let peList:number[] = [];\r\n    let eList:number[] = [];\r\n    for (let item of historyData) {\r\n      let {day, pe, e} = item;\r\n      labelList.push(day);\r\n      peList.push(GFunc.numberToPrecision(pe, 4));\r\n      eList.push(e);\r\n    }\r\n    let chartdata1 = {\r\n      labels: labelList,\r\n      datasets: [\r\n        {\r\n          label: 'PE',\r\n          data: peList,\r\n          borderColor:'blue',\r\n          backgroundColor:'skyBlue',\r\n          borderWidth: 1,\r\n          fill: false,\r\n          yAxisID: 'y-axis-1',\r\n        },\r\n        {\r\n          label: 'e',\r\n          data: eList,\r\n          borderColor:'red',\r\n          backgroundColor:'pink',\r\n          borderWidth: 1,\r\n          fill: false,\r\n          yAxisID: 'y-axis-2',\r\n        }\r\n      ]\r\n    };\r\n    let options = {\r\n      scales:{\r\n        yAxes: [{\r\n          type: 'linear',\r\n          display: true,\r\n          position: 'right',\r\n          id: 'y-axis-1',\r\n        }, {\r\n          type: 'linear',\r\n          display: true,\r\n          position: 'left',\r\n          id: 'y-axis-2',\r\n          gridLines: {\r\n              drawOnChartArea: false\r\n          }\r\n        }],    \r\n      }\r\n    }\r\n    chartHistory = <RC2 data={chartdata1} type='line' options={options} />;\r\n    let right = <></>;\r\n    right = <label className=\"px-3\"> <input type=\"checkbox\" name=\"selectType\" defaultChecked={false}\r\n    onChange={this.checkLimitShow} />长期</label>;\r\n    return <><LMR className=\"px-3 py-2 bg-white\" left={'市场PE历史走势'} right={right}></LMR>\r\n      <div className=\"px-3\" style={{width:'95%'}}>{chartHistory}</div>\r\n    </>;\r\n  });\r\n\r\n\r\n}","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport { observable } from 'mobx';\r\nimport { CUqBase } from '../UqApp';\r\nimport { VMarketPE } from './VMarketPE';\r\n\r\nexport class CMarketPE extends CUqBase {\r\n    @observable historyData:{day:number, pe:number, e:number}[] =  [];\r\n    private longshortFlag:number = 0;\r\n\r\n    async internalStart(param: any) {\r\n        this.loadData();\r\n        this.openVPage(VMarketPE as any);\r\n    }\r\n\r\n    loadData = async () => {\r\n        let dt = new Date();\r\n        let param = [dt.getFullYear()*10000+(dt.getMonth()+1)*100+dt.getDate(), 750, this.longshortFlag];\r\n        let rets = await this.cApp.miApi.query('q_marketpe', param) as {day:number, pe:number, e:number}[];\r\n        this.historyData = rets.reverse();\r\n    }\r\n\r\n    onLongShortFlag(f:number) {\r\n        if (f === this.longshortFlag)\r\n            return;\r\n        this.longshortFlag = f;\r\n        this.loadData();\r\n    }\r\n}","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport * as React from 'react';\r\nimport { observable, IObservableArray, autorun, runInAction } from 'mobx';\r\nimport { ErForEarning, SlrForEarning } from 'regression';\r\nimport { UserTag } from '../types';\r\nimport { CUqBase } from '../UqApp';\r\nimport { CStockInfo, NStockInfo } from '../stockinfo';\r\nimport { VSiteHeader } from './VSiteHeader';\r\nimport { VSearchHeader } from './VSearchHeader';\r\nimport { VHome } from './VHome';\r\nimport { VSelectTag } from './VSelectTag';\r\nimport { GFunc } from 'tool/GFunc';\r\nimport { CMarketPE } from './CMarketPE';\r\nimport { CStock } from 'stock';\r\n\r\nexport class CHome extends CUqBase {\r\n\tprivate lastLoadTick: number;\r\n\titems: IObservableArray<any> = observable.array<any>([], { deep: true });\r\n\tuserTag: UserTag;\r\n\tprotected oldSortType: string;\r\n\t//@observable warnings: any[] = [];\r\n\r\n  /*\r\n  disposeAutorun = autorun(async () => {\r\n    let needLoad = false;\r\n    let oldID = this.userTag && this.userTag.tagID;\r\n    this.userTag = { tagName: this.cApp.config.tagName, tagID: this.cApp.tagID };\r\n    if (oldID !== this.userTag.tagID) {\r\n      needLoad = true;\r\n    }\r\n\r\n    let newSortType = this.cApp.config.userStock.sortType;\r\n    if (this.oldSortType === undefined) {\r\n      this.oldSortType = newSortType;\r\n    }\r\n    else if (this.oldSortType !== newSortType) {\r\n      this.oldSortType = newSortType;\r\n      needLoad = true;\r\n    }\r\n\r\n    if (needLoad) {\r\n      await this.load();\r\n    }\r\n  });\r\n  */\r\n\r\n  public AddTagStockID(tagid: number, stockID: number) {\r\n    if (this.userTag && this.userTag.tagID === tagid) {\r\n      this.loadItems();\r\n    }\r\n  }\r\n\r\n  public RemoveTagStockID(tagid: number, stockID: number) {\r\n    if (this.userTag && this.userTag.tagID === tagid) {\r\n      //this.PageItems.RemoveStock(stockID);\r\n      let i = this.items.findIndex(v=>{return v.id === stockID})\r\n     if (i >= 0) {\r\n       this.items.splice(i, 1);\r\n     }\r\n    }\r\n  }\r\n\r\n\r\n  onSelectTag = async () => {\r\n    this.openVPage(VSelectTag);\r\n  }\r\n\r\n  onAddStock = async () => {\r\n    let cStock = new CStock(this.cApp);\r\n    let r = await cStock.call() as {id:number};\r\n\r\n    if (r !== undefined) {\r\n      let id = r.id;\r\n      if (id > 0) {\r\n        let tagid = this.cApp.defaultListTagID;\r\n        await this.cApp.miApi.call('t_tagstock$add', [this.user.id, tagid, id]);\r\n        await this.cApp.AddTagStockID(tagid, id);\r\n        await this.loadItems();\r\n      }\r\n    }\r\n  }\r\n\r\n  onClickTag = async (item:any) => {\r\n    await this.cApp.selectTag(item);\r\n    this.closePage();\r\n  }\r\n\r\n  onPage = async () => {\r\n    //this.PageItems.more();\r\n  }\r\n\r\n  onWarningConfg = () => {\r\n    this.cApp.cWarning.onWarningConfg();\r\n  }\r\n\r\n\r\n  // async searchMain(key: any) {\r\n  //   if (key !== undefined) await this.PageItems.first(key);\r\n  // }\r\n\r\n\t//作为tabs中的首页，internalStart不会被调用\r\n\tasync internalStart(param: any) {\r\n\t}\r\n\r\n  \tload = async () => {\r\n    \tlet tagID = this.cApp.tagID;\r\n    \tif (tagID > 0) {\r\n\t\t\tif (this.lastLoadTick && Date.now() - this.lastLoadTick < 300*1000) return;\r\n      \t\tawait this.loadItems();\r\n    \t}\r\n  \t}\r\n\r\n\tasync loadItems() {\r\n\t\t// 距离上次\r\n\t\tlet queryName = 'taguser';\r\n\r\n\t\tlet query = {\r\n\t\tname: queryName,\r\n\t\tpageStart: 0,\r\n\t\tpageSize: 1000,\r\n\t\tuser: this.user.id,\r\n\t\ttag: this.cApp.tagID,\r\n\t\tyearlen: 1,\r\n\t\t};\r\n\t\tlet result = await this.cApp.miApi.process(query, []);\r\n\t\tif (Array.isArray(result) === false) {\r\n\t\treturn;\r\n\t\t};\r\n\t\tlet arr = result as {id:number, order:number, data?:string, v?:number, e:number, e3:number, ep:number, price:number, exprice:number, divyield:number, r2:number, lr2:number, predictpe?:number, dataArr?:number[]}[];\r\n\t\tfor (let item of arr) {\r\n\t\tlet dataArray = JSON.parse(item.data) as number[];\r\n\t\titem.dataArr = dataArray;\r\n\t\tlet sl = new SlrForEarning(dataArray);\r\n\t\titem.ep = (sl.predict(4) + item.e) / 2;\r\n\t\titem.e3 = sl.predict(7);\r\n\t\titem.v = GFunc.calculateVN(sl.slopeR, item.ep, item.divyield * item.price, item.exprice);\r\n\t\titem.predictpe = item.price / item.e3;\r\n\t\t}\r\n\t\tthis.cApp.sortStocks(arr);\r\n\t\tlet o = 1;\r\n\t\tfor (let item of arr) {\r\n\t\titem.order = o;\r\n\t\t++o;\r\n\t\t}\r\n\t\trunInAction(() => {\r\n\t\t\tthis.items.clear();\r\n\t\t\tthis.items.push(...arr);\t\r\n\t\t\tthis.lastLoadTick = Date.now();\r\n\t\t});\r\n\t}\r\n\r\n  setSortType = (type:string) => {\r\n    this.cApp.setUserSortType(type);\r\n    let arr = this.items.slice();\r\n    this.cApp.sortStocks(arr);\r\n\r\n    this.items.replace(arr);\r\n  }\r\n\r\n  // async loadWarning() {\r\n  //   let r = await this.cApp.miApi.query('q_warnings', [this.cApp.user.id]);\r\n  //   if (r !== undefined && Array.isArray(r)) {\r\n  //     this.warnings = r;\r\n  //   }\r\n  //   else {\r\n  //     if (this.warnings.length > 0) {\r\n  //       this.warnings = [];\r\n  //     }\r\n  //   }\r\n  // }\r\n\r\n  renderSiteHeader = () => {\r\n    return this.renderView(VSiteHeader);\r\n  }\r\n\r\n  renderSearchHeader = (size?: string) => {\r\n    return this.renderView(VSearchHeader, size);\r\n  }\r\n\r\n\r\n  renderHome = () => {\r\n    return this.renderView(VHome);\r\n  }\r\n\r\n  openMetaView = () => {\r\n  }\r\n\r\n  tab = () => {\r\n    return this.renderHome();\r\n  }\r\n\r\n  openStockInfo = (item: NStockInfo) => {\r\n    let cStockInfo = this.newC(CStockInfo);\r\n    cStockInfo.start(item);\r\n  }\r\n\r\n  openMarketPE = () => {\r\n    let cm = this.newC(CMarketPE);\r\n    cm.start();\r\n  }\r\n}","import * as React from 'react';\r\nimport { observable } from 'mobx';\r\nimport {\r\n    userApi, ItemSchema, StringSchema, ImageSchema, UiTextItem, UiImageItem, nav, Page,\r\n    Edit, UiSchema, VPage, Prop, FA, IconText, PropGrid\r\n} from 'tonva-react';\r\nimport { CMe } from './CMe';\r\n\r\nexport class VEditMe extends VPage<CMe>{\r\n\r\n    async open(param: any) {\r\n        this.openPage(this.page);\r\n    }\r\n\r\n    private schema: ItemSchema[] = [\r\n        { name: 'nick', type: 'string' } as StringSchema,\r\n        { name: 'icon', type: 'image' } as ImageSchema,\r\n    ];\r\n    private uiSchema: UiSchema = {\r\n        items: {\r\n            nick: { widget: 'text', label: '别名', placeholder: '好的别名更方便记忆' } as UiTextItem,\r\n            icon: { widget: 'image', label: '头像' } as UiImageItem,\r\n        }\r\n    }\r\n    @observable private data: any;\r\n\r\n    constructor(props: any) {\r\n        super(props);\r\n        let { nick, icon } = nav.user;\r\n        this.data = {\r\n            nick: nick,\r\n            icon: icon,\r\n        };\r\n    }\r\n\r\n    private onItemChanged = async (itemSchema: ItemSchema, newValue: any, preValue: any) => {\r\n        let { name } = itemSchema;\r\n        await userApi.userSetProp(name, newValue);\r\n        this.data[name] = newValue;\r\n        nav.user.name = newValue;\r\n        nav.saveLocalUser();\r\n    }\r\n\r\n\tprivate onExit = () => {\r\n        nav.showLogout();\r\n    }\r\n\r\n\tprivate changePassword = async () => {\r\n        await nav.changePassword();\r\n    }\r\n\r\n    private page = () => {\r\n\t\tlet { schema, uiSchema, data, onItemChanged } = this;\r\n\t\tlet gridRows: Prop[] = [\r\n\t\t\t'',\r\n\t\t\t{\r\n\t\t\t\ttype: 'component',\r\n\t\t\t\tcomponent: <IconText iconClass=\"text-info mr-2\" icon=\"key\" text={this.t('changePassword')} />,\r\n\t\t\t\tonClick: this.changePassword\r\n\t\t\t},\r\n\t\t\t'',\r\n\t\t\t'',\r\n\t\t\t{\r\n\t\t\t\ttype: 'component',\r\n\t\t\t\tbk: '',\r\n\t\t\t\tcomponent: <div className=\"w-100 text-center\">\r\n\t\t\t\t\t<button className=\"btn btn-danger w-100 w-max-20c\" onClick={this.onExit}>\r\n\t\t\t\t\t\t<FA name=\"sign-out\" size=\"lg\" /> {this.t('logout')}\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</div>\r\n\t\t\t},\r\n\t\t];\r\n\r\n\r\n\t\t/*\r\n\t\tlet vAdmin: any;\r\n\t\t\r\n\t\tlet { role } = this.controller;\r\n\t\tif ((role & 2) === 2) {\r\n\t\t\tvAdmin = <div className=\"px-3 py-2 cursor-pointer bg-white border-bottom\" onClick={this.controller.showAdmin}>管理员</div>;\r\n\t\t}\r\n\t\t{vAdmin}\r\n\t\t*/\r\n        return <Page header=\"个人信息\">\r\n            <Edit schema={schema} uiSchema={uiSchema}\r\n                data={data}\r\n                onItemChanged={onItemChanged} />\r\n\t\t\t<PropGrid rows={gridRows} values={{}} />\r\n        </Page>;\r\n    }\r\n}\r\n\r\nexport const webUserSchema: ItemSchema[] = [\r\n    { name: 'firstName', type: 'string', required: true } as StringSchema,\r\n    { name: 'gender', type: 'string' } as StringSchema,\r\n    { name: 'salutation', type: 'string' } as StringSchema,\r\n    { name: 'organizationName', type: 'string', required: true } as StringSchema,\r\n    { name: 'departmentName', type: 'string' } as StringSchema,\r\n];\r\n\r\n","import { VPage } from \"tonva-react\";\r\nimport { CMe } from \"./CMe\";\r\n\r\nexport class VFaq extends VPage<CMe> {\r\n\theader() {return '基本概念'}\r\n\tcontent() {\r\n\t\treturn <ul>\r\n\t\t\t<li className=\"my-3\">\r\n\t\t\t\t<div className=\"my-2\">基本公理</div>\r\n\t\t\t\t<ul className=\"px-3 text-info\">\r\n\t\t\t\t\t<li><span className=\"mr-3\">公理1: </span>进步是社会的必然</li>\r\n\t\t\t\t\t<li><span className=\"mr-3\">公理2: </span>信任是经济的基石</li>\r\n\t\t\t\t\t<li><span className=\"mr-3\">公理3: </span>价值是价格的准心</li>\r\n\t\t\t\t\t<li><span className=\"mr-3\">公理4: </span>发展是企业的基因</li>\r\n\t\t\t\t</ul>\r\n\t\t\t</li>\r\n\t\t\t<li className=\"my-3\">\r\n\t\t\t\t<div className=\"my-2\">米投定律</div>\r\n\t\t\t\t<ul className=\"px-3 text-info\">\r\n\t\t\t\t\t<li><span className=\"mr-3\">定律1: </span>投资无风险</li>\r\n\t\t\t\t</ul>\r\n\t\t\t</li>\r\n\t\t\t<li className=\"my-3\">\r\n\t\t\t\t<div className=\"my-2\">米投原则</div>\r\n\t\t\t\t<ul className=\"px-3 text-info\">\r\n\t\t\t\t\t<li><span className=\"mr-3\">原则1: </span>低估</li>\r\n\t\t\t\t\t<li><span className=\"mr-3\">原则2: </span>分散</li>\r\n\t\t\t\t\t<li><span className=\"mr-3\">原则3: </span>不深研</li>\r\n\t\t\t\t</ul>\r\n\t\t\t</li>\r\n\t\t\t<li className=\"my-3\">\r\n\t\t\t\t<div className=\"my-2\">米息定义</div>\r\n\t\t\t\t<ul className=\"px-3 text-info\">\r\n\t\t\t\t\t<li><span className=\"mr-3\">定义1: </span>米息 = 增息 + 股息</li>\r\n\t\t\t\t\t<li><span className=\"mr-3\">定义2: </span>增息 = 企业未来三年利润增长值</li>\r\n\t\t\t\t\t<li><span className=\"mr-3\">定义3: </span>米息率 = 米息 / 股价</li>\r\n\t\t\t\t\t<li><span className=\"mr-3\">定义4: </span>PE = 股价 / 利润</li>\r\n\t\t\t\t</ul>\r\n\t\t\t</li>\r\n\t\t</ul>\r\n\t}\r\n}","import { FA, VPage } from \"tonva-react\";\r\nimport { appConfig } from \"../appConfig\";\r\nimport { CMe } from \"./CMe\";\r\n\r\nexport class VAbout extends VPage<CMe> {\r\n\theader() {return '关于APP';}\r\n\tcontent() {\r\n\t\treturn <div className=\"py-5 px-3 my-3 w-max-30c mx-auto bg-white\">\r\n\t\t\t<div className=\"text-center mb-5 position-relative\">\r\n\t\t\t\t<small className=\"text-muted position-absolute\"\r\n\t\t\t\t\tstyle={{right:'0', top:'-2.8rem'}}>\r\n\t\t\t\t\t版本: {appConfig.version}\r\n\t\t\t\t</small>\r\n\t\t\t\t<i className=\"text-danger position-absolute top-0 start-0 fa fa-fire fa-2x\" \r\n\t\t\t\t\tstyle={{left:'2rem', top:'0.5rem'}} />\r\n\t\t\t\t<b className=\"text-danger h5 mb-0\">\r\n\t\t\t\t\t<span className=\"text-primary\">鱼</span>\r\n\t\t\t\t\t<b className=\"mx-1\">米</b>\r\n\t\t\t\t\t<span className=\"text-success\">乡</span>\r\n\t\t\t\t</b>\r\n\t\t\t\t<br/>\r\n\t\t\t\t<small className=\"text-info\">私享投资圈</small>\r\n\t\t\t</div>\r\n\t\t\t<ul>\r\n\t\t\t\t<li>跟家人和好友一起分享投资思考。</li>\r\n\t\t\t\t<li>世界级投资大师年化收益率11%。</li>\r\n\t\t\t\t<li>全球最大的成长经济体GDP增长率高于5%。</li>\r\n\t\t\t\t<li>以10%为基础，期待<b className=\"text-danger mx-1\">15%以上</b>的高水平。</li>\r\n\t\t\t</ul>\r\n\t\t\t<div className=\"mt-5 text-center\">\r\n\t\t\t\t<small className=\"text-muted mr-2\">by</small>\r\n\t\t\t\t同花投顾\r\n\t\t\t</div>\r\n\t\t</div>;\r\n\t}\r\n}\r\n","import React from 'react';\r\nimport { observer } from 'mobx-react';\r\nimport { Image, VPage, nav, IconText, PropGrid, LMR, FA, Prop, Page } from 'tonva-react';\r\nimport { CMe } from './CMe';\r\nimport { appConfig } from '../appConfig';\r\nimport { VFaq } from './VFaq';\r\nimport { VAbout } from './VAbout';\r\n\r\nexport class VMe extends VPage<CMe> {\r\n\theader() {return this.t('me')}\r\n\r\n\tcontent() {\r\n        const { user } = nav;\r\n        let aboutRows: Prop[] = [\r\n            '',\r\n            {\r\n                type: 'component',\r\n                component: <LMR className=\"w-100\" onClick={this.faq}\r\n\t\t\t\t\tright={<FA className=\"align-self-center\" name=\"angle-right\" />}>\r\n                    <IconText iconClass=\"text-info mr-2\" icon=\"comments-o\" text={this.t('基本概念')} />                    \r\n                </LMR>,\r\n            },\r\n            {\r\n                type: 'component',\r\n                component: <LMR className=\"w-100\" onClick={this.about}\r\n\t\t\t\t\tright={<FA className=\"align-self-center\" name=\"angle-right\" />}>\r\n                    <IconText iconClass=\"text-info mr-2\" \r\n\t\t\t\t\t\ticon=\"smile-o\" \r\n\t\t\t\t\t\ttext={<>{this.t('aboutTheApp')} <small>版本 {appConfig.version}</small></>} />                    \r\n                </LMR>,\r\n            },\r\n        ];\r\n\r\n        let rows: Prop[];\r\n        if (user === undefined) {\r\n            rows = aboutRows;\r\n            rows.push(\r\n                {\r\n                    type: 'component',\r\n                    component: <button className=\"btn btn-success w-100 my-2\" onClick={() => nav.logout()}>\r\n                        <FA name=\"sign-out\" size=\"lg\" /> {this.t('pleaseLogin')}\r\n                    </button>\r\n                },\r\n            );\r\n        }\r\n        else {\r\n            let logOutRows: Prop[] = [\r\n            ];\r\n\r\n            rows = [\r\n                '',\r\n                {\r\n                    type: 'component',\r\n                    component: <this.meInfo />\r\n                },\r\n            ]\r\n            rows.push(...aboutRows, ...logOutRows);\r\n        }\r\n        return <PropGrid rows={[...rows]} values={{}} />;\r\n\t}\r\n\r\n\tprivate meInfo = observer(() => {\r\n        let { user } = nav;\r\n        if (user === undefined) return null;\r\n        let { id, name, nick, icon } = user;\r\n        return <LMR className=\"py-2 cursor-pointer w-100\"\r\n            left={<Image className=\"w-3c h-3c mr-3\" src={icon || '.user-o'} />}\r\n            right={<FA className=\"align-self-end\" name=\"angle-right\" />}\r\n            onClick={this.controller.showEditMe}>\r\n            <div>\r\n                <div>{userSpan(name, nick)}</div>\r\n                <div className=\"small\"><span className=\"text-muted\">ID:</span> {id > 10000 ? id : String(id + 10000).substr(1)}</div>\r\n            </div>\r\n        </LMR>;\r\n    });\r\n\r\n\tprivate faq = () => {\r\n\t\tthis.openVPage(VFaq);\r\n\t}\r\n\r\n\tprivate about = () => {\r\n\t\tthis.openVPage(VAbout);\r\n\t}\r\n}\r\n\r\nfunction userSpan(name: string, nick: string): JSX.Element {\r\n    return nick ?\r\n        <><b>{nick} &nbsp; <small className=\"muted\">{name}</small></b></>\r\n        : <b>{name}</b>\r\n}\r\n","import { QueryPager, User } from \"tonva-react\";\r\nimport { CUqBase } from \"../UqApp\";\r\n//import { VAdmin } from \"./VAdmin\";\r\nimport { VEditMe } from \"./VEditMe\";\r\nimport { VMe } from \"./VMe\";\r\n\r\nexport interface RootUnitItem {\r\n\tid: number;\t\t\t\t\t// root unit id\r\n\towner: any;\r\n\tname: string;\t\t\t\t// 唯一\r\n\tcontent: string;\r\n\ttonvaUnit: number;\t\t\t// 跟tonva机构对应的值\r\n\tx: number;\r\n}\r\n\r\nexport class CMe extends CUqBase {\r\n\trole: number;\r\n\tunitOwner: User;\r\n\trootUnits: QueryPager<any>;\r\n\r\n    protected async internalStart() {\r\n\t}\r\n\r\n\ttab = () => this.renderView(VMe);\r\n\r\n\tshowEditMe = async () => {\r\n\t\t//let result = await this.uqs.Notes.GetSystemRole.query({});\r\n\t\tthis.role = undefined; // result.ret[0]?.role;\r\n\t\tthis.openVPage(VEditMe);\r\n\t}\r\n\t/*\r\n\tshowAdmin = async () => {\r\n\t\tthis.rootUnits = new QueryPager<any>(this.uqs.Notes.GetRootUnits, undefined, undefined, true);\r\n\t\tthis.rootUnits.first({});\r\n\t\tthis.openVPage(VAdmin);\r\n\t}\r\n\r\n\tasync createRootUnit(param: {name:string; content:string; owner:number}): Promise<number> {\r\n\t\tlet result = await this.uqs.Notes.CreateRootUnit.submit(param);\r\n\t\treturn result.id;\r\n\t}\r\n\r\n\tasync changeRootUnitName(item:RootUnitItem, name:string) {\r\n\t\tawait this.uqs.Notes.ChangeRootUnitProp.submit({unit:item.id, prop:'name', value: name})\r\n\t\titem.name = name;\r\n\t}\r\n\r\n\tasync changeRootUnitTonva(item:RootUnitItem, tonvaUnit:any) {\r\n\t\tawait this.uqs.Notes.ChangeRootUnitProp.submit({unit:item.id, prop:'tonvaUnit', value: tonvaUnit})\r\n\t\titem.tonvaUnit = tonvaUnit;\r\n\t}\r\n\r\n\tasync changeRootUnitX(item:RootUnitItem, x:number) {\r\n\t\tawait this.uqs.Notes.ChangeRootUnitProp.submit({unit:item.id, prop:'x', value: x as any})\r\n\t\titem.x = x;\r\n\t}\r\n\t*/\r\n}\r\n","import {FetchError} from './fetchError';\r\nimport {HttpChannelUI} from './httpChannelUI';\r\nimport {nav} from 'tonva-react';\r\nimport { consts } from '../consts';\r\n\r\nexport async function httpGet(url:string, params?:any):Promise<any> {\r\n    let channel = new HttpChannel(url, undefined, undefined);\r\n    let ret = await channel.get('', params);\r\n    return ret;\r\n}\r\n\r\nexport async function httpPost(url:string, params?:any):Promise<any> {\r\n    let channel = new HttpChannel(url, undefined, undefined);\r\n    let ret = await channel.post('', params);\r\n    return ret;\r\n}\r\n\r\nexport class HttpChannel {\r\n    private hostUrl: string;\r\n    private apiToken: string;\r\n    private ui?: HttpChannelUI;\r\n    private timeout: number;\r\n\r\n    constructor(hostUrl: string, apiToken:string, ui?: HttpChannelUI) {\r\n        this.hostUrl = hostUrl;\r\n        this.apiToken = apiToken;\r\n        this.ui = ui;\r\n        this.timeout = consts.isDevelopment === true? 500000:20000;\r\n    }\r\n\r\n    private startWait = () => {\r\n        if (this.ui !== undefined) this.ui.startWait();\r\n    }\r\n\r\n    private endWait = (url?:string, reject?:(reason?:any)=>void) => {\r\n        if (this.ui !== undefined) this.ui.endWait();\r\n        if (reject !== undefined) reject('访问webapi超时 ' + url);\r\n    }\r\n\r\n    private showError = async (error:FetchError) => {\r\n        if (this.ui !== undefined) await this.ui.showError(error);\r\n    }\r\n\r\n    used() {\r\n        this.post('', {});\r\n    }\r\n\r\n    async get(url: string, params: any = undefined): Promise<any> {\r\n        if (params) {\r\n            let keys = Object.keys(params);\r\n            if (keys.length > 0) {\r\n                let c = '?';\r\n                for (let k of keys) {\r\n                    let v = params[k];\r\n                    if (v === undefined) continue;\r\n                    url += c + k + '=' + params[k];\r\n                    c = '&';\r\n                }\r\n            }\r\n        }\r\n        let options = this.buildOptions();\r\n        options.method = 'GET';\r\n        return await this.innerFetch(url, options);\r\n    }\r\n\r\n    async post(url: string, params: any): Promise<any> {\r\n        let options = this.buildOptions();\r\n        options.method = 'POST';\r\n        options.body = JSON.stringify(params);\r\n        return await this.innerFetch(url, options);\r\n    }\r\n\r\n    async put(url: string, params: any): Promise<any> {\r\n        let options = this.buildOptions();\r\n        options.method = 'PUT';\r\n        options.body = JSON.stringify(params);\r\n        return await this.innerFetch(url, options);\r\n    }\r\n\r\n    async delete(url: string, params: any): Promise<any> {\r\n        let options = this.buildOptions();\r\n        options.method = 'DELETE';\r\n        options.body = JSON.stringify(params);\r\n        return await this.innerFetch(url, options);\r\n    }\r\n    async fetch(url: string, options: any, resolve:(value?:any)=>any, reject:(reason?:any)=>void):Promise<void> {\r\n        let that = this;\r\n        this.startWait();\r\n        let path = url;\r\n        function buildError(err: string) {\r\n            return {\r\n                channel: that,\r\n                url: path,\r\n                options: options,\r\n                resolve: resolve,\r\n                reject: reject,\r\n                error: err,\r\n            }\r\n        }\r\n        try {\r\n            console.log('%s %s', options.method, path);\r\n            let timeOutHandler = setTimeout(() => that.endWait(url, reject), this.timeout);\r\n            let res = await fetch(encodeURI(path), options);\r\n            if (res.ok === false) {\r\n                clearTimeout(timeOutHandler);\r\n                that.endWait();\r\n                console.log('call error %s', res.statusText);\r\n                throw res.statusText;\r\n            }\r\n            let ct = res.headers.get('content-type');\r\n            if (ct && ct.indexOf('json')>=0) {\r\n                return res.json().then(async retJson => {\r\n                    clearTimeout(timeOutHandler);\r\n                    that.endWait();\r\n                    if (retJson.ok === true) {\r\n                        return resolve(retJson.res);\r\n                    }\r\n                    if (retJson.error === undefined) {\r\n                        await that.showError(buildError('not valid tonva json'));\r\n                    }\r\n                    else {\r\n                        await that.showError(buildError(retJson.error));\r\n                        reject(retJson.error);\r\n                    }\r\n                    //throw retJson.error;\r\n                }).catch(async error => {\r\n                    await that.showError(buildError(error.message));\r\n                });\r\n            }\r\n            else {\r\n                let text = await res.text();\r\n                clearTimeout(timeOutHandler);\r\n                that.endWait();\r\n                resolve(text);\r\n            }\r\n        }\r\n        catch(error) {\r\n            if (typeof error === 'string') {\r\n                if (error.toLowerCase().startsWith('unauthorized') === true) {\r\n                    nav.logout();\r\n                    return;\r\n                }\r\n            }\r\n            await this.showError(buildError(error.message));\r\n        };\r\n    }\r\n\r\n    private async innerFetch(url: string, options: any): Promise<any> {\r\n        let u = this.hostUrl + url;\r\n        return await new Promise<any>(async (resolve, reject) => {\r\n            await this.fetch(u, options, resolve, reject);\r\n        });\r\n    }\r\n\r\n    async callFetch(url:string, method:string, body:any):Promise<any> {\r\n        let options = this.buildOptions();\r\n        options.method = method;\r\n        options.body = body;\r\n        return await new Promise<any>(async (resolve, reject) => {\r\n            await this.fetch(url, options, resolve, reject);\r\n        });\r\n    }\r\n\r\n    private buildOptions(): any {\r\n        let {language, culture} = nav;\r\n        let headers = new Headers();\r\n        //headers.append('Access-Control-Allow-Origin', '*');\r\n        headers.append('Content-Type', 'application/json;charset=UTF-8');\r\n        let lang = language;\r\n        if (culture) lang += '-' + culture;\r\n        headers.append('Accept-Language', lang);\r\n        if (this.apiToken) { \r\n            headers.append('Authorization', this.apiToken); \r\n        }\r\n        let options = {\r\n            headers: headers,\r\n            // cache: 'no-cache',\r\n        };\r\n        return options;\r\n    }\r\n}\r\n","import {nav} from 'tonva-react';\r\n\r\nexport interface HttpChannelUI {\r\n    startWait():void;\r\n    endWait():void;\r\n    showError(error:any):Promise<void>;\r\n}\r\n\r\nexport class HttpChannelNavUI implements HttpChannelUI {\r\n    startWait() {\r\n        nav.startWait();\r\n    }\r\n    endWait() {\r\n        nav.endWait();\r\n    }\r\n    async showError(error:any):Promise<void> {\r\n        nav.endWait();\r\n        /*\r\n        if (error.name === 'SyntaxError') {\r\n            error = {\r\n                name: error.name,\r\n                message: error.message,\r\n            }\r\n        }*/\r\n        await nav.onError(error);\r\n    }\r\n}\r\n\r\n","//import {isDevelopment} from '../local';\r\nimport {HttpChannel} from './httpChannel';\r\n\r\nexport async function refetchApi(channel:HttpChannel, url, options, resolve, reject) {\r\n    await channel.fetch(url, options, resolve, reject);\r\n}\r\n\r\nexport abstract class ApiBase {\r\n    protected token: string;\r\n    protected path: string;\r\n    protected showWaiting: boolean;\r\n\r\n    constructor(path: string, showWaiting: boolean) {\r\n        this.path = path || '';\r\n        this.showWaiting = showWaiting;\r\n    }\r\n\r\n    protected abstract getHttpChannel(): Promise<HttpChannel>;\r\n\r\n    public async call(url:string, method:string, body:any):Promise<any> {\r\n        let channel = await this.getHttpChannel();\r\n        return await channel.callFetch(url, method, body);\r\n    }\r\n\r\n    public async get(path:string, params:any=undefined): Promise<any> {\r\n        let channel = await this.getHttpChannel();\r\n        return await channel.get(this.path + path, params);\r\n    }\r\n\r\n    public async post(path:string, params:any): Promise<any> {\r\n        let channel = await this.getHttpChannel();\r\n        return await channel.post(this.path + path, params);\r\n    }\r\n\r\n    public async put(path:string, params:any): Promise<any> {\r\n        let channel = await this.getHttpChannel();\r\n        return await channel.put(this.path + path, params);\r\n    }\r\n\r\n    public async delete(path:string, params:any): Promise<any> {\r\n        let channel = await this.getHttpChannel();\r\n        return await channel.delete(this.path + path, params);\r\n    }\r\n}\r\n","import _ from 'lodash';\r\nimport { HttpChannel } from './httpChannel';\r\nimport { HttpChannelNavUI } from './httpChannelUI';\r\nimport { ApiBase } from './apiBase';\r\n\r\nlet channelUIs: { [name: string]: HttpChannel } = {};\r\nlet channelNoUIs: { [name: string]: HttpChannel } = {};\r\n\r\nclass MiApiChannel extends ApiBase {\r\n  private apiName: string;\r\n  url: string;\r\n\r\n  constructor(url: string, basePath: string, apiName: string, uqToken: string, showWaiting?: boolean) {\r\n    super(basePath, showWaiting);\r\n    this.showWaiting = showWaiting;\r\n    this.apiName = apiName;\r\n    this.token = uqToken;\r\n    this.url = url;\r\n  }\r\n\r\n  protected async getHttpChannel(): Promise<HttpChannel> {\r\n    let channels: { [name: string]: HttpChannel };\r\n    let channelUI: HttpChannelNavUI;\r\n    if (this.showWaiting === true || this.showWaiting === undefined) {\r\n      channels = channelUIs;\r\n      channelUI = new HttpChannelNavUI();\r\n    }\r\n    else {\r\n      channels = channelNoUIs;\r\n    }\r\n    let channel = channels[this.apiName];\r\n    if (channel !== undefined) return channel;\r\n    channel = new HttpChannel(this.url, this.token, channelUI);\r\n    return channels[this.apiName] = channel;\r\n  }\r\n}\r\n\r\nexport class MiApi {\r\n  private channel: MiApiChannel;\r\n\r\n  constructor(url: string, basePath: string, apiName: string, uqToken: string, showWaiting?: boolean) {\r\n    this.channel = new MiApiChannel(url, basePath, apiName, uqToken, showWaiting);\r\n  }\r\n\r\n  async call(name: string, params: any[]): Promise<any> {\r\n    let pbody = { call: name, params: params };\r\n    return await this.channel.post('sql/call', pbody);\r\n  }\r\n\r\n  async query(name: string, params: any[]): Promise<any> {\r\n    let pbody = { call: name, params: params };\r\n    return await this.channel.post('sql/call', pbody);\r\n  }\r\n\r\n  async page(name: string, params: any[], pageStart: number, pageSize: number): Promise<any> {\r\n    let p: any[];\r\n    switch (typeof params) {\r\n      case 'undefined': p = []; break;\r\n      default: p = _.clone(params); break;\r\n    }\r\n    p.push(pageStart);\r\n    p.push(pageSize);\r\n    let pbody = { call: name, params: p };\r\n    return await this.channel.post('sql/call', pbody);\r\n  }\r\n\r\n  async process(proc: any, params: any[]): Promise<any> {\r\n    let pbody = { proc: proc, params: params };\r\n    return await this.channel.post('sql/query', pbody);\r\n  }\r\n}\r\n","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport * as React from 'react';\r\nimport { View, nav } from 'tonva-react';\r\nimport { LMR, FA, SearchBox } from 'tonva-react';\r\nimport logo from '../images/logo.svg';\r\nimport { CExplorer } from './CExplorer';\r\n\r\nexport class VSiteHeader extends View<CExplorer> {\r\n    render() {\r\n        let currentSalesRegion = <FA name=\"globe\" />\r\n        let login = <div>\r\n            登录\r\n        </div>\r\n        let left = <img className=\"m-1\" src={logo} alt=\"logo\" style={{height: \"3rem\", width: \"3rem\"}} />;\r\n        //let cart = this.controller.cApp.cCart.renderCartLabel();\r\n        let right = undefined;\r\n        /*\r\n        <div className=\"d-flex flex-row mr-1 align-items-center\">\r\n            {currentSalesRegion} &nbsp;\r\n            <button onClick={()=>nav.start()}>Try</button>\r\n        </div>;*/\r\n        return <LMR\r\n            className=\"mb-3 align-items-center bg-white\"\r\n            left={left} right={right}>\r\n            <div className=\"\">\r\n                {this.controller.renderSiteHeader()}\r\n            </div>\r\n        </LMR>\r\n    }\r\n}","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport * as React from 'react';\r\nimport { observer } from 'mobx-react';\r\nimport { VPage, List, LMR, FA, Scroller } from 'tonva-react';\r\nimport { NStockInfo } from '../stockinfo';\r\nimport { GFunc } from '../tool/GFunc';\r\nimport { CExplorer } from './CExplorer';\r\nimport { PredictHistoryParam } from 'predicthistory/CPredictHistory';\r\nimport { renderSortHeaders, renderStockInfoRow, renderStockUrl } from '../tool';\r\n\r\nexport class VExplorer extends VPage<CExplorer> {\r\n  header() {return '股票发现'}\r\n  protected onPageScrollBottom(scroller: Scroller): Promise<void> {\r\n\tthis.controller.onPage();\r\n\treturn;\r\n  }\r\n\r\n  right() {\r\n    let { onConfig } = this.controller;\r\n  \treturn <div className=\"btn align-self-center cursor-pointer \" onClick={onConfig}><FA name=\"cog\" size=\"lg\" inverse={true} /></div>\r\n  }\r\n\r\n  private onClickPredictAVG = () => {\r\n    let {avgs, lastTradeDay} = this.controller;\r\n    let param: PredictHistoryParam = {\r\n      day:undefined,\r\n      priceDay:lastTradeDay,\r\n      avg20:avgs.avg20,\r\n      avg50:avgs.avg50,\r\n      avg100:avgs.avg100,\r\n      avg:avgs.avg,\r\n    }\r\n    this.controller.cApp.openPredictAVG(param);\r\n  }\r\n\r\n  content() {\r\n\t  return React.createElement(observer(() => {\r\n      let {items, avgs, reload} = this.controller;\r\n      let avgHead: JSX.Element;\r\n      let right = <div>\r\n      <div className=\"btn cursor-pointer py-3\" onClick={reload}>刷新</div>\r\n      </div>\r\n      if (avgs.avg20 !== undefined || avgs.avg50 !== undefined || avgs.avg100 !== undefined) {\r\n      let avgStr = ' top20 : ' + GFunc.numberToFixString(avgs.avg20) \r\n        + '  -  top50 : ' + GFunc.numberToFixString(avgs.avg50)\r\n        + '  -  top100 : ' + GFunc.numberToFixString(avgs.avg100)\r\n        + '  -  all : ' + GFunc.numberToFixString(avgs.avg)\r\n        + '  ...查看历史走势';\r\n      avgHead = <LMR right={right}><div className=\"px-3 cursor-pointer\" onClick={this.onClickPredictAVG}>{GFunc.caption('价值指数均值')}{avgStr}</div></LMR>\r\n      }\r\n      else {\r\n      avgHead = <LMR right={right}></LMR>\r\n      }\r\n      \r\n      return <>\r\n      {avgHead}\r\n      <List header={renderSortHeaders('radioExplorer', this.setSortType)}\r\n        items={items}\r\n        item={{ render: this.renderRow, key: this.rowKey }}\r\n        before={'选股'}\r\n      />\r\n      </>\r\n    }));\r\n  }\r\n\r\n  renderRow = (item: any, index: number): JSX.Element => { //<this.rowContent {...item} />;\r\n    return this.rowContent(item);\r\n  } \r\n  protected rowContent = (row: any): JSX.Element => {\r\n    let blackList = this.controller.cApp.blackList;\r\n    let fInBlack = blackList.findIndex(v=>v===id);\r\n    if (fInBlack >= 0) return null;\r\n\r\n    let { id, symbol } = row as NStockInfo;\r\n    let labelId = 'vexl_' + id;\r\n\tlet defList = this.controller.cApp.defaultList;\r\n\tlet fInDef = defList.findIndex(v=>v===id);\r\n\tlet middle = <label className=\"mb-0 cursor-pointer\">\r\n\t\t<input className=\"mr-1\" type=\"checkbox\" value=\"\" id={labelId}\r\n\t\tdefaultChecked={fInDef >= 0}\r\n\t\tonChange={e => this.onSelect(row, e.target.checked)}/>\r\n\t\t<small className=\"text-muted\">自选</small>\r\n\t</label>;\r\n\r\n\tlet right = <div className=\"d-flex\">\r\n\t\t{renderStockUrl(row)}\r\n\t</div>;\r\n\treturn renderStockInfoRow(row, this.onClickName, middle, right);\r\n  };\r\n\r\n  private rowKey = (item: any) => {\r\n    if (item.item !== undefined) {\r\n      return item.item.id;\r\n    }\r\n    let { id } = item;\r\n    return id;\r\n  }\r\n\r\n  private setSortType = (type:string) => {\r\n    this.controller.setSortType(type);\r\n  }\r\n\r\n  protected onClickName = (item: NStockInfo) => {\r\n    this.controller.openStockInfo(item);\r\n  }\r\n\r\n  protected onSelect = async (item: any, isSelected:boolean): Promise<void> => {\r\n    this.controller.onSelectItem(item, isSelected);\r\n  }\r\n\r\n  protected onClickItem = async (item: any): Promise<void> => {\r\n    this.controller.openStockInfo(item);\r\n  }\r\n}","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport * as React from 'react';\r\nimport { observer } from 'mobx-react';\r\nimport { VPage, Page, FA, List, Form, ItemSchema, StringSchema, UiInputItem, UiSchema, Context, IdSchema, UiIdItem, LMR, UiSelect, UiTextItem } from 'tonva-react';\r\nimport { CExplorer } from './CExplorer';\r\n\r\nconst schema: ItemSchema[] = [\r\n  { name: 'irate', type: 'number', required: true},\r\n  { name: 'bmin', type: 'number', required: true},\r\n  { name: 'bmax', type: 'number', required: true},\r\n  { name: 'r2', type: 'number', required: true},\r\n  { name: 'lmin', type: 'number', required: true},\r\n  { name: 'lmax', type: 'number', required: true},\r\n  { name: 'lr2', type: 'number', required: true},\r\n  { name: 'mcount', type: 'integer', required: true},\r\n  { name: 'lr4', type: 'number', required: true},\r\n  { name: 'r210', type: 'number', required: true},\r\n  { name: 'submit', type: 'submit', },\r\n];\r\n\r\nconst uiSchema: UiSchema = {\r\n  items: {\r\n    irate: { widget: 'number', label: '无风险收益率', placeholder: '0.04'} as UiInputItem,\r\n    bmin: { widget: 'number', label: '指数回归最小值', placeholder: '0.00'} as UiInputItem,\r\n    bmax: { widget: 'number', label: '指数回归最大值', placeholder: '0.00'} as UiInputItem,\r\n    r2: { widget: 'number', label: '指数回归R2', placeholder: '0.00'} as UiInputItem,\r\n    lmin: { widget: 'number', label: '线性回归最小值', placeholder: '0.00'} as UiInputItem,\r\n    lmax: { widget: 'number', label: '线性回归最大值', placeholder: '0.00'} as UiInputItem,\r\n    lr2: { widget: 'number', label: '线性回归R2', placeholder: '0.00'} as UiInputItem,\r\n    lr4: { widget: 'number', label: '末年与前4年均值最大比值', placeholder: '0.00'} as UiInputItem,\r\n    mcount: { widget: 'number', label: '5年内单季亏损最多允许出现次数', placeholder: '0.00'} as UiInputItem,\r\n    r210: { widget: 'number', label: '十年回归R2', placeholder: '0.00'} as UiInputItem,\r\n    submit: { widget: 'button', label: '保存', className: 'btn btn-primary' },\r\n  }\r\n};\r\n\r\n\r\nexport class VExplorerCfg extends VPage<CExplorer> {\r\n  async open(param?: any) {\r\n    this.openPage(this.page);\r\n  }\r\n\r\n  sortChage = (e)=> {\r\n    let newType = e.target.value;\r\n\r\n    this.controller.cApp.setStockSortType(newType);\r\n  }\r\n\r\n  selectChange = (e)=> {\r\n    let newType = e.target.value;\r\n\r\n    this.controller.cApp.setStockSelectType(newType);\r\n  }\r\n\r\n  onChange = (e) => {\r\n    let {name, value} = e.target;\r\n  }\r\n\r\n  private onFormButtonClick = async (name: string, context: Context) => {\r\n    //await this.controller.onSaveNewWarning(context.data);\r\n    let {bmin, bmax, r2, lmin, lmax, lr2, mcount, lr4, r210, irate} = context.data;\r\n    let cfg = {bmin:bmin, bmax:bmax, r2:r2, lmin:lmin, lmax:lmax, lr2:lr2, mcount:mcount, lr4:lr4, r210:r210, irate:irate};\r\n    await this.controller.cApp.setRegressionConfig(cfg);\r\n    this.controller.closePage();\r\n  }\r\n\r\n\r\n  private page = observer(() => {\r\n    let scfg = this.controller.cApp.findStockConfg;\r\n    //let findType = scfg.sortType;\r\n    // let selectType = scfg.selectType;\r\n    // if (selectType === undefined) {\r\n    //   selectType = 'all';\r\n    // }\r\n    let fData = this.controller.cApp.config.regression;\r\n    if (fData.irate === undefined)\r\n      fData.irate = 0.04;\r\n\r\n    return <Page header=\"选股设置\" headerClassName=\"bg-primary\">\r\n      {/* <div className=\"px-3 py-2\">方法</div>\r\n      <div className=\"px-3 py-2 d-flex flex-wrap\">\r\n        <label className=\"px-3 c8\"> <input type=\"radio\" name=\"selectType\" value=\"all\" checked={selectType===\"all\"}\r\n          onChange={this.selectChange} />预期PE</label><br />\r\n        <label className=\"px-3 c8\"> <input type=\"radio\" name=\"selectType\" value=\"value\" checked={selectType===\"value\"}\r\n          onChange={this.selectChange} />价值指数</label><br />\r\n      </div> */}\r\n      <div className=\"px-3 py-2\">回归参数</div>\r\n      <Form schema={schema}\r\n          uiSchema={uiSchema}\r\n          formData={fData}\r\n          onButtonClick={this.onFormButtonClick}\r\n        />\r\n    </Page>;\r\n  })\r\n}\r\n","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport { observable, IObservableArray, computed } from 'mobx';\r\nimport * as React from 'react';\r\nimport { autorun } from 'mobx';\r\nimport { ErForEarning, SlrForEarning } from 'regression';\r\nimport { CUqBase } from '../UqApp';\r\nimport { CStockInfo, NStockInfo } from '../stockinfo';\r\nimport { VSiteHeader } from './VSiteHeader';\r\nimport { VExplorer } from './VExplorer';\r\nimport { VExplorerCfg } from './VExplorerCfg';\r\nimport { GFunc } from 'tool/GFunc';\r\n\r\nexport class CExplorer extends CUqBase {\r\n  items: IObservableArray<any> = observable.array<any>([], { deep: true });\r\n  @observable avgs : {avg20?:number, avg50?:number, avg100?:number, avg?:number} = {};\r\n  lastTradeDay: number;\r\n  protected oldSelectType: string;\r\n  selectedItems: any[] = [];\r\n\r\n  disposeAutorun = autorun(async () => {\r\n    let newSelectType = this.cApp.config.stockFind.selectType;\r\n    if (newSelectType === this.oldSelectType)\r\n      return;\r\n    if (this.oldSelectType === undefined) {\r\n      this.oldSelectType = newSelectType;\r\n      return;\r\n    }\r\n    this.oldSelectType = newSelectType;\r\n    await this.load();\r\n  });\r\n\r\n  onPage = async () => {\r\n    //this.PageItems.more();\r\n  }\r\n\r\n  onConfig = async () => {\r\n    this.openVPage(VExplorerCfg);\r\n  }\r\n\r\n  async internalStart(param: any) {\r\n  }\r\n\r\n  reload = async () => {\r\n    await this.load();\r\n  }\r\n\r\n  load = async () => {\r\n    this.selectedItems = [];\r\n    await this.loadItems();\r\n  }\r\n\r\n  async loadItems() {\r\n    let queryName = 'all';\r\n    //let sName = this.cApp.config.stockFind.selectType;\r\n    let {bmin, bmax, r2, lmin, lmax, lr2, mcount, lr4, r210, irate} = this.cApp.config.regression;\r\n    //if (sName !== undefined)\r\n    //  queryName = sName;\r\n    let query = {\r\n      name: queryName,\r\n      pageStart: 0,\r\n      pageSize: 3000,\r\n      user: this.user.id,\r\n      blackID:this.cApp.blackListTagID,\r\n      bMin: bmin,\r\n      bMax: bmax,\r\n      r2: r2,\r\n      lMin: lmin,\r\n      lMax: lmax,\r\n      lr2: lr2,\r\n      mcount: mcount,\r\n      lr4: lr4,\r\n      r210: r210,\r\n    };\r\n    let rets = await Promise.all([\r\n\t\tthis.cApp.miApi.process(query, []),\r\n        this.cApp.miApi.call('q_getlasttradeday', [])\r\n    ]);\r\n    let lastDayRet = rets[1] as {day:number}[];\r\n    if (Array.isArray(lastDayRet) && lastDayRet.length > 0) {\r\n      this.lastTradeDay = lastDayRet[0].day;\r\n    }\r\n    else {\r\n      this.lastTradeDay = undefined;\r\n    }\r\n    let result = rets[0];\r\n    if (Array.isArray(result) === false) {\r\n      return;\r\n    };\r\n    let arr = result as {id:number, data?:string, v:number, pe:number, e:number, ep:number, price:number, exprice:number, divyield:number, r2:number, lr2:number, e3:number, predictpe:number, order:number, ma:number, dataArr?:number[]}[];\r\n    for (let item of arr) {\r\n      let dataArray = JSON.parse(item.data) as number[];\r\n      item.dataArr = dataArray;\r\n      let sl = new SlrForEarning(dataArray);\r\n      //let ep = GFunc.evaluatePricePrice(irate, sl.predict(5), sl.predict(6), sl.predict(7));\r\n      item.ep = (sl.predict(4) + item.e) / 2;\r\n      item.v = GFunc.calculateVN(sl.slopeR, item.ep, item.divyield * item.price, item.exprice);\r\n      item.e3 = sl.predict(7);\r\n    }\r\n    if (queryName === 'all') {\r\n      this.cApp.sortStocks(arr);\r\n      this.avgs = GFunc.CalculateValueAvg(arr);\r\n    }\r\n    else {\r\n      this.avgs = {};\r\n    }\r\n    this.items.clear();\r\n    this.items.push(...arr);\r\n  }\r\n\r\n  onSelectItem = async (item:any, isSelected:boolean) => {\r\n    let tagid = this.cApp.defaultListTagID;\r\n    if (isSelected === true) {\r\n      await this.cApp.miApi.call('t_tagstock$add', [this.user.id, tagid, item.id]);\r\n      await this.cApp.AddTagStockID(tagid, item.id);\r\n    }\r\n    else {\r\n      await this.cApp.miApi.call('t_tagstock$del', [this.user.id, tagid, item.id]);\r\n      await this.cApp.RemoveTagStockID(tagid, item.id);\r\n    }\r\n  }\r\n\r\n  setSortType = (type:string) => {\r\n    this.cApp.setUserSortType(type);\r\n    let arr = this.items.slice();\r\n    this.cApp.sortStocks(arr);\r\n\r\n    this.items.replace(arr);\r\n  }\r\n\r\n  renderSiteHeader = () => {\r\n    return this.renderView(VSiteHeader);\r\n  }\r\n\r\n  renderHome = () => {\r\n    return this.renderView(VExplorer);\r\n  }\r\n\r\n\r\n  openMetaView = () => {\r\n  }\r\n\r\n  tab = () => {\r\n    return this.renderHome()\r\n  }\r\n\r\n  openStockInfo = (item: NStockInfo) => {\r\n    let cStockInfo = this.newC(CStockInfo);\r\n    cStockInfo.start(item);\r\n  }\r\n}","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport * as React from 'react';\r\nimport { observer } from 'mobx-react-lite';\r\nimport { VPage, Page, FA, List, Form, ItemSchema, StringSchema, UiInputItem, UiSchema, Context, IdSchema, UiIdItem, LMR, UiSelect, UiTextItem } from 'tonva-react';\r\nimport { CWarning } from './CWarning';\r\nimport { GFunc } from 'tool/GFunc';\r\n\r\nexport class VWarningConfig extends VPage<CWarning> {\r\n  async open(param?: any) {\r\n    this.openPage(this.page);\r\n  }\r\n\r\n  private onSelect = (item: any, isSelected: boolean, anySelected: boolean) => {\r\n    //this.controller.onTaged(item, isSelected);\r\n  }\r\n\r\n  private page = observer(() => {\r\n    let { warnings } = this.controller;\r\n    let divNewTag = warnings.length >= 100 ? '' :\r\n      <div className=\"px-3 py-2 cursor-pointer\" onClick={this.controller.onNewWarning}><FA name=\"plus\" className=\"text-primary\" /> &nbsp; 新建预警</div>;\r\n    return <Page header=\"预警\" headerClassName=\"bg-primary\">\r\n      {divNewTag}\r\n      <List items={warnings} \r\n        item={{ render: this.renderWarning }} \r\n        none={'--'} />\r\n    </Page>;\r\n  })\r\n\r\n  private renderWarning = (witem: any) => {\r\n    let {name, code, type, price} = witem;\r\n    let left = <div className=\"px-3 cursor-pointer\">\r\n      {name}\r\n      <small className=\" mx-3\" >{code}</small></div>;\r\n    return <LMR className=\"mx-3 my-2\" left={left} >\r\n      <div className=\"d-flex flex-wrap\">\r\n        <div className=\"px-3 c6\">{GFunc.warningTypeString(type)}</div>\r\n        <div className=\"px-3 c6\">{GFunc.numberToFixString(price)}</div>\r\n      </div>\r\n    </LMR>;\r\n  }\r\n}\r\n\r\nconst schema: ItemSchema[] = [\r\n  { name: 'id', type: 'id' } as IdSchema,\r\n  { name: 'type', type: 'string', required: true, maxLength: 2 } as StringSchema,\r\n  { name: 'price', type: 'number', required: true},\r\n  { name: 'submit', type: 'submit', },\r\n];\r\n\r\nconst uiSchema: UiSchema = {\r\n  items: {\r\n    id: { widget: 'id',\r\n      label: '股票',\r\n      visible: true} as UiIdItem,\r\n    type: { widget: 'select', label: '类型', \r\n    list: [{value:'gt', title:'大于'}, {value:'lt', title:'小于'}] } as UiSelect,\r\n    price: { widget: 'text', label: '价格', placeholder: '0.00'} as UiTextItem,\r\n    submit: { widget: 'button', label: '保存', className: 'btn btn-primary' },\r\n  }\r\n};\r\n\r\nexport class VNewWarning extends VPage<CWarning> {\r\n  async open(param?: any) {\r\n    this.openPage(this.page);\r\n  }\r\n\r\n  private newuiSchema: UiSchema = {\r\n    items: {\r\n      id: { widget: 'id',\r\n        label: '股票',\r\n        visible: true,\r\n        placeholder: <small className=\"text-muted\">请选择股票</small>,\r\n        pickId: async (context: Context, name: string, value: number) => {\r\n          return await this.controller.showSelectStock(context, name, value)\r\n        },\r\n        Templet: (item: any) => {\r\n          let { name, code } = item;\r\n          if (!item) return <small className=\"text-muted\">请选择股票</small>;\r\n          return <div>\r\n              {name}\r\n              <small className=\" mx-3\" >{code}</small>\r\n          </div>;\r\n        }\r\n      } as UiIdItem,\r\n      type: { widget: 'select', label: '类型', \r\n      list: [{value:'gt', title:'大于'}, {value:'lt', title:'小于'}] } as UiSelect,\r\n      price: { widget: 'text', label: '价格', placeholder: '0.00'} as UiTextItem,\r\n      submit: { widget: 'button', label: '保存', className: 'btn btn-primary' },\r\n    }\r\n  };\r\n  \r\n  private onFormButtonClick = async (name: string, context: Context) => {\r\n    await this.controller.onSaveNewWarning(context.data);\r\n  }\r\n\r\n  private page = () => {\r\n    let fData = {type:'lt'};\r\n    return <Page header=\"新建预警\" headerClassName=\"bg-primary\">\r\n      <div className=\"px-3 py-3\">\r\n        <Form schema={schema}\r\n          uiSchema={this.newuiSchema}\r\n          formData={fData}\r\n          onButtonClick={this.onFormButtonClick}\r\n        />\r\n      </div>\r\n    </Page>;\r\n  }\r\n}\r\n\r\nexport class VEditWarning extends VPage<CWarning> {\r\n  async open(param?: any) {\r\n    this.openPage(this.page, param);\r\n  }\r\n\r\n  private onFormButtonClick = async (name: string, context: Context) => {\r\n    await this.controller.onSaveWarning(context.data);\r\n  }\r\n\r\n  private page = (param?: any) => {\r\n    let {id, type, price} = param;\r\n    let fData = {id:id, type:type, price:price};\r\n    return <Page header=\"编辑预警\" headerClassName=\"bg-primary\">\r\n      <div className=\"px-3 py-3\">\r\n        <Form schema={schema}\r\n          uiSchema={uiSchema}\r\n          formData={fData}\r\n          onButtonClick={this.onFormButtonClick}\r\n        />\r\n      </div>\r\n    </Page>;\r\n  }\r\n}\r\n","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport { Context } from 'tonva-react';\r\nimport { observable } from 'mobx';\r\nimport { CApp, CUqBase } from '../UqApp';\r\nimport { CStock } from '../stock';\r\nimport { VWarningConfig, VNewWarning } from './VWarningConfig';\r\n\r\nexport class CWarning extends CUqBase {\r\n  get cApp(): CApp { return this._cApp as CApp };\r\n  @observable warnings:any[] = [];\r\n\r\n  async internalStart(param: any) {\r\n    let a = 1;\r\n  }\r\n\r\n  async loadWarnings() {\r\n    let r = await this.cApp.miApi.call('t_stockwarning$all', [this.user.id]);//await this.uqs.mi.StockWarningAll.query(undefined);\r\n    let ret = r as any[];\r\n    this.warnings = ret;\r\n  }\r\n\r\n  onNewWarning = () => {\r\n    this.openVPage(VNewWarning);\r\n  }\r\n\r\n  onWarningConfg = async () => {\r\n    await this.loadWarnings();\r\n    this.openVPage(VWarningConfig);\r\n  }\r\n\r\n  onSaveNewWarning = async (data: any) => {\r\n    let { id, type, price } = data;\r\n    // let param = {\r\n    //   user: this.cApp.user.id,\r\n    //   stock: id,\r\n    //   arr1: [\r\n    //     { type: type, price: price }\r\n    //   ]};\r\n    //let ret = await this.uqs.mi.StockWarning.add(param);\r\n    await this.cApp.miApi.call('t_stockwarning$add', [this.cApp.user.id, id.id, type, price]);\r\n    this.closePage();\r\n  }\r\n\r\n  onSaveWarning = async (data: any) => {\r\n\r\n  }\r\n\r\n  showSelectStock = async (context: Context, name: string, value: number): Promise<any> => {\r\n    let cStock = new CStock(this.cApp);\r\n    return await cStock.call();\r\n  }\r\n}","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport * as React from 'react';\r\nimport { observer } from 'mobx-react';\r\nimport RC2 from 'react-chartjs2'\r\nimport { VPage, Page, View, List, LMR, FA } from 'tonva-react';\r\nimport { CPredictHistory } from './CPredictHistory';\r\n\r\nexport class VPredictHistory extends VPage<CPredictHistory> {\r\n  async open(param?: any) {\r\n    this.openPage(this.page);\r\n  }\r\n\r\n  render(param: any): JSX.Element {\r\n    return <this.page />\r\n  }\r\n\r\n  private page = observer(() => {\r\n    return <Page header=\"预期收益比均值历史\">\r\n      <this.pageContent />\r\n    </Page>;\r\n  })\r\n\r\n  private pageContent = observer(() => {\r\n    return <>\r\n    <this.historyChart />\r\n    </>\r\n  });\r\n\r\n  protected historyChart = observer(() => {\r\n    let {items} = this.controller;\r\n    if (items === undefined) \r\n      return <></>;\r\n    let chartHistory = <></>;\r\n    let labelList:any[] = [];\r\n    let avg20List:number[] = [];\r\n    let avg50List:number[] = [];\r\n    let avg100List:number[] = [];\r\n    for (let item of items) {\r\n      let {day, avg20, avg50, avg100} = item;\r\n      labelList.push(day);\r\n      avg20List.push(avg20);\r\n      avg50List.push(avg50);\r\n      avg100List.push(avg100);\r\n    }\r\n    let chartdata1 = {\r\n      labels: labelList,\r\n      datasets: [\r\n        {\r\n          label: 'avg20',\r\n          data: avg20List,\r\n          borderColor:'blue',\r\n          backgroundColor:'skyBlue',\r\n          borderWidth: 1,\r\n          fill: false,\r\n          yAxisID: 'y-axis-1',\r\n        },\r\n        {\r\n          label: 'avg50',\r\n          data: avg50List,\r\n          borderColor:'red',\r\n          backgroundColor:'pink',\r\n          borderWidth: 1,\r\n          fill: false,\r\n          yAxisID: 'y-axis-1',\r\n        },\r\n        {\r\n          label: 'avg100',\r\n          data: avg100List,\r\n          borderColor:'DarkGreen',\r\n          backgroundColor:'green',\r\n          borderWidth: 1,\r\n          fill: false,\r\n          yAxisID: 'y-axis-1',\r\n        },\r\n      ]\r\n    };\r\n    let options = {\r\n      scales:{\r\n        yAxes: [{\r\n            type: 'linear',\r\n            display: true,\r\n            position: 'right',\r\n            id: 'y-axis-1',\r\n        }],       \r\n      }\r\n    }\r\n\r\n    chartHistory = <RC2 data={chartdata1} type='line' options={options}/>;\r\n    return <><LMR className=\"px-3 py-2 bg-white\" left={'历史走势'}></LMR>\r\n      <div className=\"px-3\" style={{width:'95%'}}>{chartHistory}</div>\r\n    </>;\r\n  });\r\n\r\n}","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport { observable, IObservableArray } from 'mobx';\r\nimport { CUqBase } from '../UqApp';\r\nimport { VPredictHistory } from './VPredictHistory'\r\n\r\nexport interface PredictHistoryParam {\r\n  day?:number,\r\n  priceDay?:number,\r\n  avg20?:number,\r\n  avg50?:number,\r\n  avg100?:number,\r\n  avg?:number,\r\n}\r\n\r\ninterface PredictItem {\r\n  day:number, \r\n  avg20:number, \r\n  avg50:number,\r\n  avg100:number,\r\n  avg?:number\r\n}\r\n\r\nexport class CPredictHistory extends CUqBase {\r\n  items: IObservableArray<PredictItem> = observable.array<PredictItem>([], { deep: true });\r\n  day: number;\r\n  protected lastItem: PredictItem;\r\n\r\n  async internalStart(param: any) {\r\n    let p = param as PredictHistoryParam;\r\n    if (p !== undefined) {\r\n      this.day = p.day;\r\n      if (p.priceDay !== undefined) {\r\n        this.lastItem = {day:p.priceDay, avg20:p.avg20, avg50:p.avg50, avg100:p.avg100};\r\n      }\r\n      else {\r\n        this.lastItem = undefined;\r\n      }\r\n    }\r\n    else {\r\n      this.day = undefined;\r\n      this.lastItem = undefined;\r\n    }\r\n    await this.load();\r\n    this.openVPage(VPredictHistory as any);\r\n  }\r\n\r\n  async load() {\r\n    let ret = await this.cApp.miApi.call('t_toppredictavg$query', [this.day]) as PredictItem[];\r\n    this.items.clear();\r\n    if (!Array.isArray(ret))\r\n      return;\r\n    this.items.push(...ret);\r\n    if (this.lastItem !== undefined) {\r\n      let li = {...this.lastItem};\r\n      this.items.push(li);\r\n    }\r\n  }\r\n\r\n}","import { zh } from \"./zh\";\r\nimport { en } from \"./en\";\r\n\r\nexport const res = {\r\n\t$zh: zh,\r\n\t$en: en,\r\n}\r\n","export const zh = {\r\n\thome: '首页',\r\n\trelation: '关系',\r\n\tdiscover: '发现',\r\n\tme: '我的',\r\n\r\n\tchangePassword: '修改密码',\r\n\taboutTheApp: '关于APP',\r\n\tlogout: '退出登录',\r\n\tpleaseLogin: '登录',\r\n\r\n\tnotes: '小单',\r\n\ttask: '任务',\r\n\tassign: '作业单',\r\n\r\n\tnoteSpace: '群',\r\n\r\n\tnoteText: '文字单',\r\n\tnoteList: '列表单',\r\n\tnoteCheckable: '勾选单',\r\n\tnoteTask: '布置任务',\r\n\tnoteFolder: '小单夹',\r\n\tnoteCreateSpace: '新建群',\r\n\r\n\tcontent: '内容',\r\n}\r\n","export const en = {\r\n\thome: 'Home',\r\n\trelation: 'Relation',\r\n\tdiscover: 'Discover',\r\n\tme: 'Me',\r\n\r\n\tchangePassword: 'Change password',\r\n\taboutTheApp: 'About the APP',\r\n\tlogout: 'Logout',\r\n\tpleaseLogin: 'Login',\r\n\r\n\tnotes: 'Notes',\r\n\ttask: 'Task',\r\n\tassign: 'Assign',\r\n\r\n\tnoteSpace: 'Group',\r\n\r\n\tnoteText: 'Text',\r\n\tnoteList: 'List',\r\n\tnoteCheckable: 'Checkable',\r\n\tnoteTask: 'Task',\r\n\tnoteFolder: 'Folder',\r\n\tnoteCreateSpace: 'Create Group',\r\n\r\n\tcontent: 'Content',\r\n}\r\n","import { FA, List, LMR, VPage } from \"tonva-react\";\r\nimport { CHolding } from \"./CHolding\";\r\nimport { Account, AccountValue } from \"UqApp/uqs/BruceYuMi\";\r\n\r\nexport class VHolding extends VPage<CHolding> {\r\n\theader() {return <span className=\"ml-3\">持仓组合 <small className=\"text-muted\">正在设计实现中...</small></span>}\r\n\tcontent() {\r\n\t\treturn <div>\r\n\t\t\t<List items={this.controller.accounts} item={{render: this.renderAccount, onClick: this.onClickAccount}} />\r\n\t\t</div>;\r\n\t}\r\n\r\n\tprivate renderAccount = (item:Account&AccountValue, index:number):JSX.Element => {\r\n\t\tfunction renderValue(caption:string, value:number) {\r\n\t\t\treturn <span className=\"mr-3\"><small className=\"text-muted\">{caption}: </small>{value??0}</span>;\r\n\t\t}\r\n\t\tlet {id, no, name, mi, market, count} = item;\r\n\t\tlet right = <div className=\"px-2 d-flex align-items-center\">\r\n\t\t\t<FA className=\"align-\" name=\"angle-right\" />\r\n\t\t</div>;\r\n\t\treturn <LMR right={right}>\r\n\t\t\t<div className=\"px-3 py-2 bg-white d-block\">\r\n\t\t\t\t<div>{name}</div>\r\n\t\t\t\t<div className=\"mt-2\">\r\n\t\t\t\t\t<span className=\"mr-3 small\">共{count??0}只</span>\r\n\t\t\t\t\t{renderValue('总米值', mi as number)}\r\n\t\t\t\t\t{renderValue('总市值', market as number)}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</LMR>;\r\n\t}\r\n\r\n\tprivate onClickAccount = (item:Account&AccountValue) => {\r\n\t\tthis.controller.showAccount(item);\r\n\t}\r\n}","import { FA, LMR, VPage } from \"tonva-react\";\r\nimport { CHolding } from \"./CHolding\";\r\n\r\nexport class VAccount extends VPage<CHolding> {\r\n\theader() {return this.controller.account.name}\r\n\tcontent() {\r\n\t\tfunction renderValue(caption:string, value:number) {\r\n\t\t\treturn <span className=\"mr-3\"><small className=\"text-muted\">{caption}: </small>{value??0}</span>;\r\n\t\t}\r\n\t\tlet {id, no, name, mi, market, count} = this.controller.account;\r\n\t\treturn <div className=\"mt-3 px-3 py-2 bg-white d-block\">\r\n\t\t\t<LMR right={<small className=\"text-muted\">组合编号: {no}</small>}>\r\n\t\t\t\t{name}\r\n\t\t\t</LMR>\r\n\t\t\t<div className=\"mt-2\">\r\n\t\t\t\t<span className=\"mr-3 small\">共{count??0}只</span>\r\n\t\t\t\t{renderValue('总米值', mi as number)}\r\n\t\t\t\t{renderValue('总市值', market as number)}\r\n\t\t\t</div>\r\n\t\t</div>;\r\n\t}\r\n}\r\n","import { makeObservable, observable } from \"mobx\";\r\nimport { ParamID, ParamIDinIX, ParamIX } from \"tonva-react\";\r\nimport { CApp, CUqBase } from \"UqApp\";\r\nimport { Account, AccountValue } from \"UqApp/uqs/BruceYuMi\";\r\nimport { VHolding } from \"./VHolding\";\r\nimport { VAccount } from \"./VAccount\";\r\n\r\nexport class CHolding extends CUqBase {\r\n\taccounts: (Account&AccountValue)[];\r\n\taccount: Account&AccountValue;\r\n\r\n\tconstructor(cApp: CApp) {\r\n\t\tsuper(cApp);\r\n\t\tmakeObservable(this, {\r\n\t\t\taccounts: observable,\r\n\t\t});\r\n\t}\r\n\r\n\tprotected async internalStart() {\r\n\t}\r\n\t\r\n\ttab = () => {\r\n\t\treturn this.renderView(VHolding);\r\n\t}\r\n\r\n\tload = async () => {\r\n\t\tlet {BruceYuMi} = this.uqs;\r\n\t\tlet {Account, UserAccount} = BruceYuMi;\r\n\t\tlet param:ParamIDinIX = {\r\n\t\t\tID: Account,\r\n\t\t\tIX: UserAccount,\r\n\t\t\tid: this.user.id,\r\n\t\t};\r\n\t\tlet ret = await BruceYuMi.IDinIX<Account>(param);\r\n\t\tif (ret.length === 0) {\r\n\t\t\t// 没有持仓账号，则创建默认账号\r\n\t\t\tlet accountNO = await BruceYuMi.IDNO({ID: Account});\r\n\t\t\tlet retActs = await BruceYuMi.IDActs({\r\n\t\t\t\taccount: [{\r\n\t\t\t\t\tid: undefined, \r\n\t\t\t\t\tno: accountNO, \r\n\t\t\t\t\tname: '我的持仓组合', \r\n\t\t\t\t}]\r\n\t\t\t});\r\n\t\t\tret = await BruceYuMi.IDinIX(param);\r\n\t\t}\r\n\t\tlet paramValue:ParamID = {\r\n\t\t\tIDX: BruceYuMi.AccountValue,\r\n\t\t\tid: ret.map(v => (v as unknown as Account).id),\r\n\t\t}\r\n\t\tlet values = await BruceYuMi.ID<AccountValue>(paramValue);\r\n\t\tthis.accounts = ret as unknown as (Account&AccountValue)[];\r\n\t\tthis.accounts.forEach(account => {\r\n\t\t\tlet {id} = account;\r\n\t\t\tlet value = values.find(v => v.id === id);\r\n\t\t\tif (value) {\r\n\t\t\t\tObject.assign(account, value);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tshowAccount = async (item:Account&AccountValue) => {\r\n\t\tthis.account = item;\r\n\t\tthis.openVPage(VAccount);\r\n\t};\r\n}\r\n","//=== UqApp builder created on Mon Mar 01 2021 15:27:12 GMT-0500 (GMT-05:00) ===//\r\nimport { VPage, TabCaptionComponent, Page, TabProp } from 'tonva-react';\r\nimport { CApp } from './CApp';\r\n\r\nconst color = (selected: boolean) => selected === true ? 'text-primary' : 'text-muted';\r\n\r\nexport class VMain extends VPage<CApp> {\r\n\tasync open(param?: any) {\r\n\t\tthis.openPage(this.render);\r\n\t}\r\n\trender = (param?: any): JSX.Element => {\r\n\t\tlet { cHome, cHolding, cExporer, cMe } = this.controller;\r\n\t\tlet tabs: TabProp[] = [\r\n\t\t\t{ \r\n\t\t\t\tname: 'home', label: '首页', icon: 'home', content: cHome.tab, \r\n\t\t\t\tnotify: undefined, \r\n\t\t\t\t//load: cHome.load, \r\n\t\t\t\tonShown: cHome.load,\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tname: 'explorer', label: '持仓', icon: 'money', content: cHolding.tab, load: cHolding.load \r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tname: 'explorer', label: '选股', icon: 'search', content: cExporer.tab, load: cExporer.load \r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tname: 'me', label: '我的', icon: 'user', content: cMe.tab, onShown: undefined\r\n\t\t\t}\r\n\t\t].map(v => {\r\n\t\t\tlet { name, label, icon, content, notify, load, onShown } = v;\r\n\t\t\treturn {\r\n\t\t\t\tname,\r\n\t\t\t\tcaption: (selected: boolean) => TabCaptionComponent(label, icon, color(selected)),\r\n\t\t\t\tcontent,\r\n\t\t\t\tnotify,\r\n\t\t\t\tload,\r\n\t\t\t\tonShown,\r\n\t\t\t};\r\n\t\t});\r\n\t\treturn <Page header={false} tabsProps={{tabs}} />\r\n\t}\r\n}\r\n","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport { observable, computed } from 'mobx';\r\nimport { Controller, VPage } from 'tonva-react';\r\nimport { CHome } from '../home';\r\nimport { CMe } from '../me';\r\nimport { consts, defaultBlackListTagName, defaultTagName } from '../consts';\r\nimport { MiApi } from '../net';\r\nimport { CExplorer } from '../explorer';\r\nimport { MiConfigs, StockFindConfig, IdName, RegressionConfig } from '../types';\r\nimport { CWarning } from '../warning';\r\nimport { CPredictHistory } from '../predicthistory';\r\nimport { CUqApp } from './CBase';\r\nimport { res } from './res';\r\nimport { CHolding } from 'holding';\r\nimport { VMain } from './VMain';\r\n\r\nexport class CApp extends CUqApp {\r\n  cHome: CHome;\r\n  cHolding: CHolding;\r\n  cExporer: CExplorer;\r\n  cWarning: CWarning;\r\n  cMe: CMe;\r\n  miApi: MiApi;\r\n  @observable config: MiConfigs = { \r\n    tagName: defaultTagName, \r\n    stockFind: { sortType:'pe' },\r\n    userStock: { sortType:'tagpe'},\r\n    regression: {bmin:0, bmax:0.5, r2:0.7, lmin:0.01, lmax:0.5, lr2:0.7, mcount:2, lr4: 3, r210:0.6, irate:0.04}\r\n  };\r\n  @observable tags: IdName[] = undefined;\r\n  @observable blackList: any[] = [];\r\n  @observable defaultList: any[] = [];\r\n  @observable accounts: IdName[] = undefined;\r\n\r\n  @computed get tagID(): number {\r\n    if (this.tags !== undefined) {\r\n      let name = this.config.tagName;\r\n      let i = this.tags.findIndex(v => v.name === name);\r\n      if (i >= 0) {\r\n        return this.tags[i].id as number;\r\n      }\r\n    }\r\n    return -1;\r\n  }\r\n\r\n  @computed get accountID(): number {\r\n    let name = this.config.accountName;\r\n    if (name !== undefined && this.accounts !== undefined) {\r\n      let i = this.accounts.findIndex(v => v.name === name);\r\n      if (i >= 0) {\r\n        return this.accounts[i].id as number;\r\n      }\r\n    }\r\n    return -1;\r\n  }\r\n\r\n  get findStockConfg(): StockFindConfig {\r\n    return this.config.stockFind;\r\n  }\r\n\r\n  @computed get blackListTagID(): number {\r\n    if (this.tags !== undefined) {\r\n      let name = this.config.tagName;\r\n      let i = this.tags.findIndex(v => v.name === defaultBlackListTagName);\r\n      if (i >= 0) {\r\n        return this.tags[i].id as number;\r\n      }\r\n    }\r\n    return -1;\r\n  }\r\n\r\n  @computed get defaultListTagID(): number {\r\n    if (this.tags !== undefined) {\r\n      let name = this.config.tagName;\r\n      let i = this.tags.findIndex(v => v.name === defaultTagName);\r\n      if (i >= 0) {\r\n        return this.tags[i].id as number;\r\n      }\r\n    }\r\n    return -1;\r\n  }\r\n\r\n  protected async internalStart() {\r\n\tthis.setRes(res);\r\n    if (this.isLogined) {\r\n    }\r\n\r\n    let token = this.user.token;\r\n\r\n    //let miHost = consts.isDevelopment ? consts.miApiHostDebug : consts.miApiHost;\r\n\tlet miHost = consts.miApiHost;\r\n    this.miApi = new MiApi(miHost, 'fsjs/', 'miapi', token, false);\r\n    this.cHome = this.newC(CHome);\r\n    this.cExporer = this.newC(CExplorer);\r\n    this.cHolding = this.newC(CHolding);\r\n\tthis.cMe = this.newC(CMe);\r\n    this.cWarning = this.newC(CWarning);\r\n\r\n    //some test code\r\n    //let params = [];\r\n    //let ret = await this.miApi.page('q_stocksquery', params, 0, 100);\r\n    let env = process.env;\r\n    //\r\n    await this.loadConfig();\r\n    //await this.cHome.loadWarning();\r\n\tawait this.cHome.load();\r\n    this.openVPage(VMain);\r\n  }\r\n\r\n  async saveConfig() {\r\n    let v = JSON.stringify(this.config);\r\n    await this.miApi.call('t_usersettings$save', [this.user.id, 'config', v]);\r\n  }\r\n\r\n  protected async loadConfig() {\r\n    let rets = await Promise.all([this.miApi.query('t_usersettings$query', [this.user.id, 'config']),\r\n        this.loadTags(),\r\n        this.loadAccounts()]);\r\n    let r = rets[0];\r\n    if (r !== undefined) {\r\n      let ret = r;\r\n      if (ret !== undefined && ret.length > 0) {\r\n        let cStr = ret[0].value;\r\n        let c = JSON.parse(cStr);\r\n        if (this.tags !== undefined) {\r\n          let name = c.tagName;\r\n          let i = this.tags.findIndex(v => v.name === name);\r\n          if (i < 0 && this.tags.length > 0) {\r\n            i = this.tags.findIndex(v => v.name === defaultTagName);\r\n            if (i >= 0) {\r\n              c.tagName = defaultTagName;\r\n            }\r\n            else {\r\n              c.tagName = this.tags[0].name;\r\n            }\r\n          }\r\n        }\r\n        this.config = c;\r\n      }\r\n    }\r\n    if (this.config.stockFind === undefined) {\r\n      this.config.stockFind = { sortType: 'pe' };\r\n    }\r\n    else {\r\n      switch (this.config.stockFind.selectType) {\r\n        case 'all': break;\r\n        case 'peroe': break;\r\n        case 'pe': break;\r\n        case 'dp': break;\r\n        default:\r\n          this.config.stockFind.selectType = 'all';\r\n          break;\r\n      }\r\n    }\r\n    if (this.config.userStock === undefined) {\r\n      this.config.userStock = { sortType: 'tagpe' };\r\n    }\r\n    if (this.config.regression === undefined) {\r\n      this.config.regression = {bmin:0, bmax:0.5, r2:0.7, lmin:0.01, lmax:0.5, lr2:0.7, mcount:2, lr4: 3, r210:0.6, irate:0.04};\r\n    }\r\n    else {\r\n      if (this.config.regression.r210 === undefined) {\r\n        this.config.regression.r210 = 0.6;\r\n      }\r\n      if (this.config.regression.irate === undefined) {\r\n        this.config.regression.irate = 0.04;\r\n      }\r\n    }\r\n    await this.loadBlackList();\r\n    await this.loadDefaultList();\r\n  }\r\n\r\n  getsortFunc = () => {\r\n    let sortType = this.config.userStock.sortType;\r\n    if (sortType === 'tagpe') {\r\n      return (a, b) => {\r\n        return a.pe - b.pe;\r\n      }\r\n    }\r\n    else if (sortType === 'tagdp') {\r\n      return (a, b) => {\r\n        return b.divyield - a.divyield;\r\n      }\r\n    }\r\n    else {\r\n      return (a, b) => {\r\n        return b.v - a.v;\r\n      }\r\n    }\r\n  }\r\n\r\n  sortStocks = (arr:any[]) => {\r\n    arr.sort(this.getsortFunc());\r\n    let o = 1;\r\n    for (let item of arr) {\r\n      item.order = o;\r\n      ++o;\r\n    }\r\n  }\r\n\r\n\r\n  setStockSortType = async (type:string)=> {\r\n    if (this.config.stockFind.sortType === type)\r\n      return;\r\n    this.config.stockFind.sortType = type;\r\n    await this.saveConfig();\r\n  }\r\n\r\n  setStockSelectType = async (type:string) => {\r\n    if (this.config.stockFind.selectType === type)\r\n      return;\r\n    this.config.stockFind.selectType = type;\r\n    await this.saveConfig();\r\n  }\r\n\r\n  setUserSortType = async (type:string)=> {\r\n    if (this.config.userStock.sortType === type)\r\n      return;\r\n    this.config.userStock.sortType = type;\r\n    await this.saveConfig();\r\n  }\r\n\r\n  selectTag = async (item:any) => {\r\n    let {name, id} = item as {name:string, id:number};\r\n    let i = this.tags.findIndex(v => v.name === name);\r\n    if (i >= 0) {\r\n      this.config.tagName = name;\r\n      this.saveConfig();\r\n    }\r\n  }\r\n\r\n  selectAccount = async (item:any) => {\r\n    let {name, id} = item as {name:string, id:number};\r\n    let i = this.accounts.findIndex(v => v.name === name);\r\n    if (i >= 0) {\r\n      this.config.accountName = name;\r\n      this.saveConfig();\r\n    }\r\n  }\r\n\r\n  setRegressionConfig = async (cfg: RegressionConfig) => {\r\n    this.config.regression = cfg;\r\n    await this.saveConfig();\r\n  }\r\n\r\n  protected async loadTags(): Promise<void> {\r\n    if (this.tags === undefined) {\r\n      let r = await this.miApi.query('t_tag$all', [this.user.id]);\r\n      let ret = r as any[];\r\n      let bc = await this.checkDefaultTags(ret);\r\n      if (bc) {\r\n        r = await this.miApi.query('t_tag$all', [this.user.id]);\r\n        ret = r as any[];\r\n      }\r\n      let r1 = [];\r\n      let i = ret.findIndex(v=>v.name === defaultTagName);\r\n      if (i >= 0) {\r\n        r1.push(ret[i]);\r\n        ret.splice(i, 1);\r\n      }\r\n      i = ret.findIndex(v=> v.name === defaultBlackListTagName);\r\n      if (i >= 0) {\r\n        r1.push(ret[i]);\r\n        ret.splice(i, 1);\r\n      }\r\n      r1.push(...ret);\r\n      this.tags = r1;\r\n    }\r\n  }\r\n\r\n  protected async checkDefaultTags(list:any[]): Promise<boolean> {\r\n    let br = false;\r\n    if (list === undefined) {\r\n      await this.miApi.call('t_tag$save', [this.user.id, undefined, defaultTagName]);\r\n      await this.miApi.call('t_tag$save', [this.user.id, undefined, defaultBlackListTagName]);\r\n      br = true;\r\n    }\r\n    else {\r\n      let param;\r\n      let i = list.findIndex(v => v.name === defaultTagName);\r\n      if (i < 0) {\r\n        await this.miApi.call('t_tag$save', [this.user.id, undefined, defaultTagName]);\r\n        br = true;\r\n      }\r\n      i = list.findIndex(v => v.name === defaultBlackListTagName);\r\n      if (i < 0) {\r\n        await this.miApi.call('t_tag$save', [this.user.id, undefined, defaultBlackListTagName]);\r\n        br = true;\r\n      }\r\n    }\r\n\r\n    return br;\r\n  }\r\n\r\n  protected async loadAccounts(): Promise<void> {\r\n    let r = await this.miApi.query('t_allaccounts', [this.user.id]);\r\n    if (Array.isArray(r)) {\r\n      this.accounts = r;\r\n    }\r\n  }\r\n\r\n  protected async loadBlackList(): Promise<void> {\r\n    let blackid = this.blackListTagID;\r\n    if (blackid <= 0) {\r\n      this.blackList = [];\r\n      return;\r\n    }\r\n\r\n    let param = { user:this.user.id, tag:blackid};\r\n    try {\r\n      let ret = await this.miApi.call('t_tagstock$query', [this.user.id, blackid, undefined]);//await this.uqs.mi.TagStock.query(param);\r\n      let r = ret.map(item=> {\r\n        return item.stock;\r\n      });\r\n      this.blackList = r;\r\n    }\r\n    catch (error) {\r\n      let e = error;\r\n    }\r\n  }\r\n\r\n  protected async loadDefaultList(): Promise<void> {\r\n    let id = this.defaultListTagID;\r\n    if (id <= 0) {\r\n      this.defaultList = [];\r\n      return;\r\n    }\r\n\r\n    let param = { user:this.user.id, tag:id};\r\n    try {\r\n      let ret = await this.miApi.call('t_tagstock$query', [this.user.id, id, undefined]);//await this.uqs.mi.TagStock.query(param);\r\n      let r = ret.map(item=> {\r\n        return item.stock;\r\n      });\r\n      this.defaultList = r;\r\n    }\r\n    catch (error) {\r\n      let e = error;\r\n    }\r\n  }\r\n\r\n  async AddTagStockID(tagid: number, stockID: number) {\r\n    if (tagid === this.blackListTagID) {\r\n      this.AddBlackID(stockID);\r\n    }\r\n    else if (tagid === this.defaultListTagID) {\r\n      this.AddDefaultID(stockID);\r\n    }\r\n  }\r\n\r\n  async AddTagStockIDs(tagid: number, stockIDs: number[]) {\r\n    if (tagid === this.blackListTagID) {\r\n      stockIDs.map(v=>this.AddBlackID(v));\r\n    }\r\n    else if (tagid === this.defaultListTagID) {\r\n      stockIDs.map(v=>this.AddDefaultID(v));\r\n    }\r\n  }\r\n\r\n  async RemoveTagStockID(tagid: number, stockID: number) {\r\n    if (tagid === this.blackListTagID) {\r\n      this.RemoveBlackID(stockID);\r\n    }\r\n    else if (tagid === this.defaultListTagID) {\r\n      this.RemoveDefaultID(stockID);\r\n    }\r\n    this.cHome.RemoveTagStockID(tagid, stockID);\r\n  }\r\n\r\n  protected AddBlackID(id:number) {\r\n    let i = this.blackList.findIndex(v=> v===id);\r\n    if (i < 0) {\r\n      this.blackList.push(id);\r\n    }\r\n  }\r\n\r\n  protected RemoveBlackID(id:number) {\r\n    let i = this.blackList.findIndex(v=> v===id);\r\n    if (i >= 0) {\r\n      this.blackList.splice(i, 1);\r\n    }\r\n  }\r\n\r\n  protected AddDefaultID(id:number) {\r\n    let i = this.defaultList.findIndex(v=> v===id);\r\n    if (i < 0) {\r\n      this.defaultList.push(id);\r\n    }\r\n  }\r\n\r\n  protected RemoveDefaultID(id:number) {\r\n    let i = this.defaultList.findIndex(v=> v===id);\r\n    if (i >= 0) {\r\n      this.defaultList.splice(i, 1);\r\n    }\r\n  }\r\n/*\r\n  newC<T extends CUqBase>(type: IConstructor<T>): T {\r\n    return new type(this);\r\n  }\r\n*/\r\n  public async showOneVPage(vp: new (coordinator: Controller) => VPage<Controller>, param?: any): Promise<void> {\r\n    await (new vp(this)).open(param);\r\n  }\r\n\r\n  protected onDispose() {\r\n  }\r\n\r\n  openPredictAVG(param:any) {\r\n    let pc = this.newC(CPredictHistory);\r\n    pc.start(param);\r\n  }\r\n}\r\n","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport * as React from 'react';\r\nimport classNames from 'classnames';\r\nimport { VPage, Page, View, List, LMR, left0, FA } from 'tonva-react';\r\nimport { observable } from 'mobx';\r\nimport { observer } from 'mobx-react';\r\nimport RC2 from 'react-chartjs2'\r\nimport { GFunc } from '../tool/GFunc';\r\nimport { CStockInfo } from './CStockInfo'\r\nimport { NStockInfo, StockCapitalearning, StockBonus } from './StockInfoType';\r\nimport { ErForEarning, SlrForEarning } from 'regression';\r\n\r\nexport class VStockInfo extends VPage<CStockInfo> {\r\n  private input: HTMLInputElement;\r\n  private key: string = undefined;\r\n\r\n  async open(param?: any) {\r\n    this.openPage(this.page);\r\n  }\r\n\r\n  @observable protected ttmLimit:boolean = false;\r\n\r\n  render(param: any): JSX.Element {\r\n    return this.page();\r\n  }\r\n\r\n  checkLimitShow = (e)=> {\r\n    let check = e.target.checked as boolean;\r\n    this.ttmLimit = check;\r\n  }\r\n\r\n  checkShowLater = (e)=> {\r\n    let check = e.target.checked as boolean;\r\n    this.controller.LoadHistoryData(check);\r\n  }\r\n\r\n  checkDefaultTag = (e)=> {\r\n    let check = e.target.checked as boolean;\r\n    this.controller.onClickDefaultTag(check);\r\n  }\r\n\r\n  private page = observer(() => {\r\n    let { openMetaView, baseItem, onSelectTag, stockTags, isLogined } = this.controller;\r\n    let { name, code, day } = baseItem;\r\n    let viewMetaButton = <></>;\r\n    if (isLogined) {\r\n      viewMetaButton = <button type=\"button\" className=\"btn w-100\" onClick={openMetaView}>view</button>\r\n    }\r\n    let right = stockTags && <button \r\n\t\tclassName=\"btn btn-sm mr-2 btn-outline-success bg-light align-self-center\"\r\n\t\tonClick={onSelectTag}>\r\n      {stockTags.length === 0? '加自选' : '设分组'}\r\n      </button>;\r\n    let headStr = name + ' ' + code;\r\n    if (day !== undefined) {\r\n      headStr += ' - ' + day;\r\n    }\r\n  let head = <div onClick={()=>this.controller.showSelectStock(day)}>{headStr}</div>\r\n    return <Page header={head} right={right}\r\n      headerClassName='bg-primary'>\r\n      {React.createElement(this.pageContent)}\r\n    </Page>;\r\n  })\r\n\r\n  private pageContent = observer(() => {\r\n    return <>\r\n      {this.dateHead()}\r\n      {React.createElement(this.baseInfo)}\r\n      {React.createElement(this.historyChart)}\r\n      {React.createElement(this.predictInfo)}\r\n      {React.createElement(this.predictSeasonEarning)}\r\n      {React.createElement(this.seasonEarning)}\r\n      {React.createElement(this.capitalEarning)}\r\n      {React.createElement(this.bonus)}\r\n    </>\r\n  });\r\n\r\n  private onChange = (evt: React.ChangeEvent<any>) => {\r\n    let v = evt.target.value;\r\n    let n = Number(v);\r\n    if (isNaN(n) === true || !Number.isInteger(n)) {\r\n      if (this.input) {\r\n        this.input.value = this.key;\r\n      }\r\n      return;\r\n    }\r\n    this.key = evt.target.value;\r\n    if (this.key !== undefined) {\r\n        this.key = this.key.trim();\r\n        if (this.key === '') this.key = undefined;\r\n    }\r\n  }\r\n\r\n  private onSubmit = async (evt: React.FormEvent<any>) => {\r\n    evt.preventDefault();\r\n    if (this.key === undefined) this.key = '';\r\n    let n = Number(this.key);\r\n    if (!isNaN(n) && Number.isInteger((n))) {\r\n      if (n ===0 || (n >= 20000101 && n < 30000101)) {\r\n        await this.controller.changeDay(n);\r\n      }\r\n    }\r\n  }\r\n\r\n\r\n  private dateHead = () => {\r\n    let {day} = this.controller.baseItem;\r\n    let dayString = day === undefined || isNaN(day) ? '' : day.toString();\r\n    return <div className=\"px-3 py-2\">\r\n\t\t<form className=\"w-100\" onSubmit={this.onSubmit} >\r\n\t\t\t<div className=\"input-group input-group-sm\">\r\n\t\t\t\t<label className=\"input-group-addon mr-2 mb-0 align-self-center\">{'日期'}</label>\r\n\t\t\t\t<input ref={v=>this.input=v} onChange={this.onChange}\r\n\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\tname=\"key\"\r\n\t\t\t\t\t\tdefaultValue={dayString}\r\n\t\t\t\t\t\tclassName=\"form-control border-primary px-2\"\r\n\t\t\t\t\t\tplaceholder={'yyyymmdd'}\r\n\t\t\t\t\t\tmaxLength={8} />\r\n\t\t\t\t<div className=\"input-group-append\">\r\n\t\t\t\t\t\t<button className=\"btn btn-primary px-2\"\r\n\t\t\t\t\t\t\ttype=\"submit\">\r\n\t\t\t\t\t\t\t<i className='fa fa-search' />\r\n\t\t\t\t\t\t\t<i className=\"fa\"/>\r\n\t\t\t\t\t\t\t{'跳转'}\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</form>\r\n\t</div>;\r\n  }\r\n\r\n\r\n  private baseInfo = observer(() => {\r\n    let {baseItem} = this.controller;\r\n    let { id, name, code, symbol, pe, roe, price, order, divyield, e, capital, bonus } = baseItem;\r\n\r\n    let list = this.controller.cApp.defaultList;\r\n    let fInList = list.findIndex(v=>v===id) >= 0;\r\n    let right = <label className=\"align-self-center px-3\"> <input type=\"checkbox\" name=\"checkDefaultList\" defaultChecked={fInList}\r\n      onChange={this.checkDefaultTag} />自选股</label>;\r\n    return <LMR className=\"bg-white\" right={right}> <div className=\"px-3 py-2\" >\r\n      <div className=\"d-flex flex-wrap\">\r\n        <div className=\"px-3 c8\">{GFunc.caption('TTM')}{GFunc.numberToFixString(pe)}</div>\r\n        <div className=\"px-3 c8\">{GFunc.caption('股息率')}{GFunc.percentToFixString(divyield)}</div>\r\n        <div className=\"px-3 c8\">{GFunc.caption('ROE')}{GFunc.percentToFixString(roe)}</div>\r\n        <div className=\"px-3 c8\">{GFunc.caption('价格')}{GFunc.numberToFixString(price)}</div>\r\n        <a className=\"px-3 text-info\" href={`https://finance.sina.com.cn/realstock/company/${symbol}/nc.shtml`} target=\"_blank\" rel=\"noopener noreferrer\" onClick={(e) =>{e.stopPropagation() }}>新浪财经</a>\r\n      </div>    \r\n    </div>\r\n    </LMR>;\r\n  });\r\n\r\n  protected onClickName = async (item: NStockInfo) => {\r\n    let { symbol } = item;\r\n    let url = `http://finance.sina.com.cn/realstock/company/${symbol}/nc.shtml`;\r\n    let w = window.open(url, '');\r\n    w.opener = undefined;\r\n  }\r\n\r\n  protected historyChart = observer(() => {\r\n    let {historyData, baseItem} = this.controller;\r\n    if (historyData === undefined) \r\n      return <></>;\r\n    let chartHistory = <></>;\r\n    let labelList:any[] = [];\r\n    let priceList:number[] = [];\r\n    let ttmList:number[] = [];\r\n    for (let item of historyData) {\r\n      let {day, price, ttm} = item;\r\n      labelList.push(day);\r\n      priceList.push(GFunc.numberToPrecision(price, 4));\r\n      if (ttm <= 0) \r\n        ttmList.push(undefined);\r\n      else {\r\n        if (this.ttmLimit && ttm >= 35) {\r\n          ttmList.push(35);\r\n        }\r\n        else {\r\n          ttmList.push(GFunc.numberToPrecision(ttm, 4));\r\n        }\r\n      }\r\n    }\r\n    let chartdata1 = {\r\n      labels: labelList,\r\n      datasets: [\r\n        {\r\n          label: '价格',\r\n          data: priceList,\r\n          borderColor:'blue',\r\n          backgroundColor:'skyBlue',\r\n          borderWidth: 1,\r\n          fill: false,\r\n          yAxisID: 'y-axis-1',\r\n        },\r\n        {\r\n          label: 'TTM',\r\n          data: ttmList,\r\n          borderColor:'red',\r\n          backgroundColor:'pink',\r\n          borderWidth: 1,\r\n          fill: false,\r\n          yAxisID: 'y-axis-2',\r\n        }\r\n      ]\r\n    };\r\n    let options = {\r\n      scales:{\r\n        yAxes: [{\r\n            type: 'linear',\r\n            display: true,\r\n            position: 'left',\r\n            id: 'y-axis-1',\r\n        }, {\r\n            type: 'linear',\r\n            display: true,\r\n            position: 'right',\r\n            id: 'y-axis-2',\r\n            gridLines: {\r\n                drawOnChartArea: false\r\n            }\r\n        }],       \r\n      }\r\n    }\r\n    chartHistory = <RC2 data={chartdata1} type='line' options={options} />;\r\n    let right = <></>;\r\n    if (baseItem.day !== undefined) {\r\n      right = <><label className=\"px-3\"> <input type=\"checkbox\" name=\"showLater\" defaultChecked={false}\r\n            onChange={this.checkShowLater} />显示后面数据</label>\r\n          <label className=\"px-3\"> <input type=\"checkbox\" name=\"selectType\" defaultChecked={this.ttmLimit}\r\n          onChange={this.checkLimitShow} />限制TTM显示范围</label>\r\n        </>;\r\n\r\n    }\r\n    else {\r\n      right = <label className=\"px-3\"> <input type=\"checkbox\" name=\"selectType\" defaultChecked={this.ttmLimit}\r\n        onChange={this.checkLimitShow} />限制TTM显示范围</label>;\r\n    }\r\n    return <><LMR className=\"px-3 py-2 bg-white\" left={'历史走势'} right={right}></LMR>\r\n      <div className=\"px-3\" style={{width:'95%'}}>{chartHistory}</div>\r\n    </>;\r\n  });\r\n\r\n  protected predictInfo = observer(() => {\r\n    let {predictData, ypredict} = this.controller;\r\n    if (predictData === undefined) \r\n      return <></>;\r\n    let { e, b, r2, epre, l, lr2, lpre } = predictData;\r\n    let chart1 = <></>;\r\n    if (ypredict.length === 5) {\r\n      let er = new ErForEarning(ypredict);\r\n      let chartdata1 = {\r\n        labels: ['0', '1', '2', '3', '4'],\r\n        datasets: [\r\n          {\r\n            label: '原值',\r\n            data: ypredict.map(v=>GFunc.numberToPrecision(v)),\r\n            borderColor:'black',\r\n            backgroundColor:'skyBlue',\r\n            showLine: false,\r\n            pointStyle: \"crossRot\",\r\n            borderWidth: 1,\r\n            pointRadius: 5,\r\n            fill: false,\r\n          } as any\r\n        ]\r\n      };\r\n      if (!(isNaN(er.B) || isNaN(er.A))) {\r\n        let per:number[] = [];\r\n        for (let i = 0; i < 5; ++i) {\r\n          per.push(GFunc.numberToPrecision(er.predict(i), 4));\r\n        }\r\n        chartdata1.datasets.push(\r\n          {\r\n            label: '指数回归',\r\n            data: per,\r\n            borderColor:'red',\r\n            backgroundColor:'pink',\r\n            borderWidth: 1,\r\n            fill: false,\r\n        });\r\n      }\r\n      let lr = new SlrForEarning(ypredict);\r\n      if (!(isNaN(lr.slope) || isNaN(lr.intercept))) {\r\n        let plr:number[] = [];\r\n        for (let i = 0; i < 5; ++i) {\r\n          plr.push(GFunc.numberToPrecision(lr.predict(i), 4));\r\n        }\r\n        chartdata1.datasets.push(\r\n          {\r\n            label: '线性回归',\r\n            data: plr,\r\n            borderColor:'blue',\r\n            backgroundColor:'pink',\r\n            borderWidth: 1,\r\n            fill: false,\r\n        });\r\n      }\r\n      chart1 = <RC2 data={chartdata1} type='line' />;\r\n    }\r\n    let chart2 = this.predictChartFullInfo();\r\n    let chart3 = this.predictChartROE();\r\n    return <><div className=\"px-3 py-2 bg-white\">指数回归预测</div>\r\n      <div className=\"d-flex flex-wrap\">\r\n        <div className=\"px-3 c12\">{GFunc.caption('e')}{GFunc.numberToString(e, 4)}</div>\r\n        <div className=\"px-3 c12\">{GFunc.caption('指数b')}{GFunc.numberToString(b, 4)}</div>\r\n        <div className=\"px-3 c12\">{GFunc.caption('r2')}{GFunc.numberToString(r2, 4)}</div>\r\n        <div className=\"px-3 c12\">{GFunc.caption('e预测')}{GFunc.numberToString(epre)}</div>\r\n      </div>\r\n      <div className=\"px-3 py-2 bg-white\">线性回归预测</div>\r\n      <div className=\"d-flex flex-wrap\">\r\n      <div className=\"px-3 c12\">{GFunc.caption('e')}{GFunc.numberToString(e, 4)}</div>\r\n        <div className=\"px-3 c12\">{GFunc.caption('增长率')}{GFunc.numberToString(l, 4)}</div>\r\n        <div className=\"px-3 c12\">{GFunc.caption('r2')}{GFunc.numberToString(lr2, 4)}</div>\r\n        <div className=\"px-3 c12\">{GFunc.caption('e预测')}{GFunc.numberToString(lpre)}</div>\r\n      </div>\r\n      <div className=\"d-flex\">\r\n        <div className=\"px-2\" style={{width:'50%'}}>{chart1}</div>\r\n        <div className=\"px-2\" style={{width:'50%'}}>{chart2}</div>\r\n      </div>\r\n      <div className=\"d-flex\">\r\n        <div className=\"px-2\" style={{width:'50%'}}>{chart3}</div>\r\n      </div>\r\n    </>;\r\n  });\r\n\r\n  protected predictChartFullInfo = () => {\r\n    let { predictSeasonDataFull } = this.controller;\r\n    let len = predictSeasonDataFull.length;\r\n    if (len <= 0)\r\n      return <></>;\r\n    let label = [];\r\n    let y:number[] = [];\r\n    for (let i = len - 1; i >= 0; --i) {\r\n      let item = predictSeasonDataFull[i];\r\n      if (item.esum === undefined)\r\n        continue;\r\n      label.push(GFunc.SeasonnoToYearMonth(item.season));\r\n      y.push(item.esum);\r\n    }\r\n\r\n    let er = new ErForEarning(y);\r\n    let chartdataFull = {\r\n      labels: label,\r\n      datasets: [\r\n        {\r\n          label: '原值',\r\n          data: y.map(v=>GFunc.numberToPrecision(v)),\r\n          borderColor:'black',\r\n          backgroundColor:'skyBlue',\r\n          showLine: false,\r\n          pointStyle: \"crossRot\",\r\n          borderWidth: 1,\r\n          pointRadius: 5,\r\n          fill: false,\r\n        } as any\r\n      ]\r\n    };\r\n    if (!(isNaN(er.B) || isNaN(er.A))) {\r\n      let per:number[] = [];\r\n      for (let i = 0; i < len; ++i) {\r\n        per.push(GFunc.numberToPrecision(er.predict(i), 4));\r\n      }\r\n      chartdataFull.datasets.push(\r\n        {\r\n          label: '指数 R2:' + GFunc.numberToString(er.r2, 4),\r\n          data: per,\r\n          borderColor:'red',\r\n          backgroundColor:'pink',\r\n          borderWidth: 1,\r\n          fill: false,\r\n      });\r\n    }\r\n    let lr = new SlrForEarning(y);\r\n    if (!(isNaN(lr.slope) || isNaN(lr.intercept))) {\r\n      let plr:number[] = [];\r\n      for (let i = 0; i < len; ++i) {\r\n        plr.push(GFunc.numberToPrecision(lr.predict(i), 4));\r\n      }\r\n      chartdataFull.datasets.push(\r\n        {\r\n          label: '线性 R2:' + GFunc.numberToString(lr.r2, 4),\r\n          data: plr,\r\n          borderColor:'blue',\r\n          backgroundColor:'pink',\r\n          borderWidth: 1,\r\n          fill: false,\r\n      });\r\n    }\r\n    return <RC2 data={chartdataFull} type='line' />;\r\n  };\r\n\r\n  protected predictChartROE = () => {\r\n    let { predictSeasonDataFull } = this.controller;\r\n    let len = predictSeasonDataFull.length;\r\n    if (len <= 0)\r\n      return <></>;\r\n    let label = [];\r\n    let y:number[] = [];\r\n    for (let i = len - 1; i >= 0; --i) {\r\n      let item = predictSeasonDataFull[i];\r\n      if (item.esum === undefined)\r\n        continue;\r\n      label.push(GFunc.SeasonnoToYearMonth(item.season));\r\n      y.push(item.esumorg / item.corg);\r\n    }\r\n\r\n    let chartdataFull = {\r\n      labels: label,\r\n      datasets: [\r\n        {\r\n          label: 'ROE原值',\r\n          data: y.map(v=>GFunc.numberToPrecision(v)),\r\n          borderColor:'black',\r\n          backgroundColor:'skyBlue',\r\n          showLine: false,\r\n          pointStyle: \"crossRot\",\r\n          borderWidth: 1,\r\n          pointRadius: 5,\r\n          fill: false,\r\n        } as any\r\n      ]\r\n    };\r\n    let lr = new SlrForEarning(y);\r\n    if (!(isNaN(lr.slope) || isNaN(lr.intercept))) {\r\n      let plr:number[] = [];\r\n      for (let i = 0; i < len; ++i) {\r\n        plr.push(Number.parseFloat(lr.predict(i).toPrecision(4)));\r\n      }\r\n      chartdataFull.datasets.push(\r\n        {\r\n          label: '线性 R2:' + GFunc.numberToString(lr.r2, 4),\r\n          data: plr,\r\n          borderColor:'blue',\r\n          backgroundColor:'pink',\r\n          borderWidth: 1,\r\n          fill: false,\r\n      });\r\n    }\r\n    return <RC2 data={chartdataFull} type='line' />;\r\n  };\r\n\r\n  private predictSeasonEarning = observer(() => {\r\n    let items = this.controller.predictSeasonData;\r\n    let header = <div className=\"px-3\">\r\n      <div className=\"px-3 c6\">年月</div>\r\n      <div className=\"px-3 c6 text-right\">股本</div>\r\n      <div className=\"px-3 c6 text-right\">季收益</div>\r\n      <div className=\"px-3 c6 text-right\">年收益</div>\r\n      <div className=\"px-3 c6 text-right\">ROE</div>\r\n      <div className=\"px-3 c6 text-right\">股本o</div>\r\n      <div className=\"px-3 c6 text-right\">季收益o</div>\r\n      <div className=\"px-3 c6 text-right\">年收益o</div>\r\n    </div>;\r\n    return <>\r\n      <div className=\"px-3 py-1\">历年股本收益-用于回归计算</div>\r\n      <List header={header} loading=\"...\"\r\n        items={items}\r\n        item={{\r\n          render: (row: {season:number, c:number, e:number, esum:number, corg:number, eorg:number, esumorg:number}) => {\r\n            let {season, c, e, esum, corg, eorg, esumorg} = row;\r\n            let ym = GFunc.SeasonnoToYearMonth(season);\r\n            let a = 0;\r\n            return <div className=\"px-3 py-2 d-flex flex-wrap\">\r\n              <div className=\"px-3 c6\">{ym.toString()}</div>\r\n              <div className=\"px-3 c6 text-right\">{GFunc.numberToFixString(c)}</div>\r\n              <div className=\"px-3 c6 text-right\">{GFunc.numberToFixString(e)}</div>\r\n              <div className=\"px-3 c6 text-right\">{GFunc.numberToFixString(esum)}</div>\r\n              <div className=\"px-3 c6 text-right\">{GFunc.percentToFixString(esum/c)}</div>\r\n              <div className=\"px-3 c6 text-right\">{GFunc.numberToFixString(corg)}</div>\r\n              <div className=\"px-3 c6 text-right\">{GFunc.numberToFixString(eorg)}</div>\r\n              <div className=\"px-3 c6 text-right\">{GFunc.numberToFixString(esumorg)}</div>\r\n            </div>\r\n          }\r\n        }}\r\n      />\r\n    </>\r\n  });\r\n\r\n\r\n  private seasonEarning = observer(() => {\r\n    let items = this.controller.seasonData;\r\n    let header = <div className=\"px-3\">\r\n      <div className=\"px-3 c6\">年月</div>\r\n      <div className=\"px-3 c6 text-right\">股本</div>\r\n      <div className=\"px-3 c6 text-right\">季收益</div>\r\n      <div className=\"px-3 c6 text-right\">年收益</div>\r\n      <div className=\"px-3 c6 text-right\">ROE</div>\r\n      <div className=\"px-3 c6 text-right\">股本o</div>\r\n      <div className=\"px-3 c6 text-right\">季收益o</div>\r\n      <div className=\"px-3 c6 text-right\">年收益o</div>\r\n    </div>;\r\n    return <>\r\n      <div className=\"px-3 py-1\">历年股本收益</div>\r\n      <List header={header} loading=\"...\"\r\n        items={items}\r\n        item={{\r\n          render: (row: {season:number, c:number, e:number, esum:number, corg:number, eorg:number, esumorg:number}) => {\r\n            let {season, c, e, esum, corg, eorg, esumorg} = row;\r\n            let ym = GFunc.SeasonnoToYearMonth(season);\r\n            let a = 0;\r\n            return <div className=\"px-3 py-2 d-flex flex-wrap\">\r\n              <div className=\"px-3 c6\">{ym.toString()}</div>\r\n              <div className=\"px-3 c6 text-right\">{GFunc.numberToFixString(c)}</div>\r\n              <div className=\"px-3 c6 text-right\">{GFunc.numberToFixString(e)}</div>\r\n              <div className=\"px-3 c6 text-right\">{GFunc.numberToFixString(esum)}</div>\r\n              <div className=\"px-3 c6 text-right\">{GFunc.percentToFixString(esum/c)}</div>\r\n              <div className=\"px-3 c6 text-right\">{GFunc.numberToFixString(corg)}</div>\r\n              <div className=\"px-3 c6 text-right\">{GFunc.numberToFixString(eorg)}</div>\r\n              <div className=\"px-3 c6 text-right\">{GFunc.numberToFixString(esumorg)}</div>\r\n            </div>\r\n          }\r\n        }}\r\n      />\r\n    </>\r\n  });\r\n\r\n\r\n  private capitalEarning = observer(() => {\r\n    let items = this.controller.capitalearning;\r\n    let header = <div className=\"px-3\">\r\n      <div className=\"px-3 c6\">年</div>\r\n      <div className=\"px-3 c6 text-right\">股本</div>\r\n      <div className=\"px-3 c6 text-right\">收益</div>\r\n      <div className=\"px-3 c6 text-right\">ROE</div>\r\n    </div>;\r\n    return <>\r\n      <div className=\"px-3 py-1\">历年股本收益</div>\r\n      <List header={header} loading=\"...\"\r\n        items={items}\r\n        item={{\r\n          render: (row: StockCapitalearning) => {\r\n            let {capital, earning} = row;\r\n            return <div className=\"px-3 py-2 d-flex flex-wrap\">\r\n              <div className=\"px-3 c6\">{row.year}</div>\r\n              <div className=\"px-3 c6 text-right\"> {capital.toFixed(2)}</div>\r\n              <div className=\"px-3 c6 text-right\"> {earning.toFixed(2)}</div>\r\n              <div className=\"px-3 c6 text-right\"> {(earning/capital*100).toFixed(1)}%</div>\r\n            </div>\r\n          }\r\n        }}\r\n      />\r\n    </>\r\n  });\r\n\r\n  private bonus = observer(() => {\r\n    let items = this.controller.bonus;\r\n    let header = <div className=\"px-3\">\r\n      <div className=\"px-3 c8\">日期</div>\r\n      <div className=\"px-3 c6 text-right\">分红</div>\r\n    </div>;\r\n    return <>\r\n      <div className=\"px-3 py-1\">历年分红</div>\r\n      <List header={header} loading=\"...\"\r\n        items={items}\r\n        item={{\r\n          render: (row: StockBonus) => {\r\n            return <div className=\"px-3 py-2 d-flex flex-wrap\">\r\n              <div className=\"px-3 c8\">{row.day}</div>\r\n              <div className=\"px-3 c6 text-right\"> {row.bonus.toFixed(2)}</div>\r\n            </div>\r\n          }\r\n        }}\r\n      />\r\n    </>\r\n  });\r\n}","import { UqExt as Uq } from './BruceYuMi';\r\nimport * as Account from './Account.ui';\r\nimport * as Holding from './Holding.ui';\r\nimport * as Transaction from './Transaction.ui';\r\nimport * as Stock from './Stock.ui';\r\nimport * as Market from './Market.ui';\r\nimport * as Portfolio from './Portfolio.ui';\r\nimport * as StockValue from './StockValue.ui';\r\nimport * as AccountValue from './AccountValue.ui';\r\nimport * as UserAccount from './UserAccount.ui';\r\n\r\nexport function setUI(uq: Uq) {\r\n\tObject.assign(uq.Account, Account);\r\n\tObject.assign(uq.Holding, Holding);\r\n\tObject.assign(uq.Transaction, Transaction);\r\n\tObject.assign(uq.Stock, Stock);\r\n\tObject.assign(uq.Market, Market);\r\n\tObject.assign(uq.Portfolio, Portfolio);\r\n\tObject.assign(uq.StockValue, StockValue);\r\n\tObject.assign(uq.AccountValue, AccountValue);\r\n\tObject.assign(uq.UserAccount, UserAccount);\r\n}\r\nexport * from './BruceYuMi';\r\n","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport * as React from 'react';\r\nimport { observer } from 'mobx-react-lite';\r\nimport { VPage, Page, List, LMR, SearchBox } from 'tonva-react';\r\nimport { CStock } from './CStock'\r\n\r\nexport class VStockSelect extends VPage<CStock> {\r\n  async open(item: any) {\r\n      this.openPage(this.page, item);\r\n  }\r\n\r\n  private renderStock(stock: any, index: number) {\r\n      let { name, code } = stock;\r\n      return <LMR className=\"px-3 py-2 \" >\r\n          <div className=\"font-weight-bold\"></div>\r\n          <div>{name + ' ' + code}</div>\r\n      </LMR >\r\n  }\r\n\r\n  private onClickStock = async (model: any) => {\r\n      await this.controller.returnStock(model);\r\n      this.closePage();\r\n  }\r\n\r\n  private page = observer((customer: any) => {\r\n      let { pageItems, onPage } = this.controller;\r\n      let none = <div className=\"my-3 mx-2 text-warning\">请搜索股票！</div>;\r\n      return <Page header=\"选择股票\" headerClassName='bg-primary' onScrollBottom={onPage}>\r\n          <SearchBox className=\"px-1 w-100  mt-2 mr-2\"\r\n              size='md'\r\n              allowEmptySearch={true}\r\n              onSearch={(key: string) => this.controller.searchByKey(key)}\r\n              placeholder=\"搜索股票\" />\r\n          <List before={''} none={none} items={pageItems} item={{ render: this.renderStock, onClick: this.onClickStock }} />\r\n      </Page>\r\n  })\r\n}","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport { observable } from 'mobx';\r\nimport { PageItems } from 'tonva-react';\r\nimport { CUqBase } from '../UqApp';\r\nimport { VStockSelect } from './VSelectStock';\r\n\r\nclass PageStockItems<T> extends PageItems<T> {\r\n  cStock: CStock;\r\n\r\n  constructor(cs: CStock) {\r\n      super(true);\r\n      this.cStock = cs;\r\n      this.firstSize = this.pageSize = 30;\r\n  }\r\n\r\n  protected async loadResults(param: any, pageStart: any, pageSize: number): Promise<{\r\n\t[name: string]: any[];\r\n\t}> {\r\n      if (pageStart === undefined) pageStart = 0;\r\n      let p = ['%' + param.key + '%'];\r\n      try {\r\n        let ret = await this.cStock.cApp.miApi.page('q_stocks$page', p, pageStart, pageSize);\r\n        return ret;\r\n      }\r\n      catch (error) {\r\n        let e = error;\r\n        return undefined;\r\n      }\r\n  }\r\n\r\n  protected setPageStart(item: any): any {\r\n      this.pageStart = item === undefined ? 0 : item.id;\r\n  }\r\n}\r\n\r\nexport class CStock extends CUqBase {\r\n  @observable pageItems: PageStockItems<any> = new PageStockItems<any>(this);\r\n\r\n  //get cApp(): CMiApp { return this._cApp as CMiApp };\r\n\r\n  async internalStart(param: any) {\r\n    this.openVPage(VStockSelect);\r\n}\r\n\r\n  searchByKey = async (key: string) => {\r\n    this.pageItems = new PageStockItems<any>(this);\r\n    this.pageItems.first({ key: key });\r\n  }\r\n\r\n  //给调用页面返回id\r\n  returnStock = async (item: any): Promise<any> => {\r\n    this.returnCall(item);\r\n  }\r\n\r\n  onPage = async () => {\r\n    await this.pageItems.more();\r\n  }\r\n}","export * from './StockInfoType';\r\nexport { CStockInfo } from './CStockInfo';\r\nexport { VStockInfo } from './VStockInfo';","import * as React from 'react';\r\n\r\nexport class GFunc {\r\n  public static numberToFixString(n: number, w = 2) {\r\n    return n === undefined ? '' : n.toFixed(w);\r\n  }\r\n  public static number(n: number, w=2) {\r\n    return n === undefined ? '' : n.toFixed(w);\r\n  }\r\n\r\n  public static numberToMarketValue(n: number) {\r\n    return n === undefined || isNaN(n) ? '' : Math.round(n/10000).toString(); // + '亿';\r\n  }\r\n\r\n  public static numberToString(n: number, precision = 2) {\r\n    return n === undefined ? '' : n.toPrecision(precision);\r\n  }\r\n\r\n  public static numberToPrecision(n: number, precision = 4) {\r\n    return n === undefined ? undefined : Number.parseFloat(n.toPrecision(precision));\r\n  }\r\n\r\n  public static percentToFixString(n: number) {\r\n    return n === undefined || isNaN(n) ? '' : (n * 100).toFixed(2) + '%';\r\n  }\r\n\r\n  public static percent0(n: number) {\r\n    return n === undefined || isNaN(n) ? '' : (n * 100).toFixed(0) + '%';\r\n  }\r\n  public static percent1(n: number) {\r\n    return n === undefined || isNaN(n) ? '' : (n * 100).toFixed(1) + '%';\r\n  }\r\n\r\n  public static warningTypeString(t: string) {\r\n    switch (t) {\r\n      case 'gt': return '大于';\r\n      case 'lt': return '小于';\r\n      default: return t;\r\n    }\r\n  }\r\n\r\n  public static predictCutRatio(r2:number) {\r\n    return r2 * 2 - r2 * r2;\r\n  }\r\n\r\n  public static evaluatePricePrice(iRate:number, e1:number, e2:number, e3:number) {\r\n    let r = 1 + iRate;\r\n    let r2 = r * r;\r\n    let r3 = r2 * r;\r\n    return (e1/r + e2 /r2 + e3 / r3 + e3 / iRate / r3) / 2;\r\n  }\r\n\r\n  public static calculateV(z:number, divyield:number, pe:number) {\r\n    if (pe === undefined || isNaN(pe)) {\r\n      return undefined;\r\n    }\r\n\r\n    let r = 0;\r\n    if (z !== undefined) {\r\n      if (z > 0.25) {\r\n        z = 0.25;\r\n      }\r\n      r += z * 100;\r\n    }\r\n    if (divyield !== undefined) {\r\n      r += divyield * 100;\r\n    }\r\n    return r / pe;\r\n  }\r\n\r\n  public static calculateVN(z:number, e:number, bonus:number, price:number) {\r\n    if (price === undefined || isNaN(price) || e === undefined || isNaN(e)) {\r\n      return undefined;\r\n    }\r\n\r\n    let r = 0;\r\n    if (z !== undefined && e > 0) {\r\n      if (z > 0.25) {\r\n        z = 0.24 + Math.pow((z-0.24)*100, 0.6667) / 100;\r\n      }\r\n      z = 1 + z;\r\n      z = z * z * z - 1;\r\n      r += z * e * 100;\r\n    }\r\n    if (bonus !== undefined && !isNaN(bonus)) {\r\n      r += bonus * 100;\r\n    }\r\n    return r / price;\r\n  }\r\n\r\n  public static calculateZZ3(data:number[]) {\r\n    let ret:number[] = [undefined, undefined, undefined, undefined] ;\r\n    if (data === undefined)\r\n      return ret;\r\n    let len = data.length;\r\n    if (len < 5)\r\n      return ret;\r\n    \r\n    let funcz = (n:number, p:number) => {\r\n      if (p <= 0 || n <= 0)\r\n        return undefined;\r\n      return ((n / p) - 1);\r\n    }\r\n    for (let i = 0; i < 4; ++i) {\r\n      ret[i] = funcz(data[i+1], data[i]);\r\n    }\r\n    return ret;\r\n  }\r\n\r\n  public static caption = (value:string) => <span className=\"text-muted small\">{value}</span>;\r\n\r\n  public static MonthnoFromDay(day:number) {\r\n    let year = Math.floor(day/10000);\r\n    let month = Math.floor((day%10000)/100) - 1;\r\n    return (year-1995)*12+month;\r\n  }\r\n  \r\n  public static SeasonnoFromDay(day:number) {\r\n    let year = Math.floor(day/10000);\r\n    let month = Math.floor((day%10000)/100) - 1;\r\n    let season = Math.floor(month / 3);\r\n    return (year-1995)*4 + season;\r\n  }\r\n  \r\n  public static SeasonnoFromYearMonth(year:number, month:number) {\r\n    let season = Math.floor((month-1) / 3);\r\n    return (year-1995)*4 + season;\r\n  }\r\n\r\n  public static SeasonnoToYearMonth(no: number) {\r\n    let year = Math.floor(no / 4) + 1995;\r\n    let month = (Math.floor(no % 4) + 1) * 3;\r\n    return year * 100 + month;\r\n  }\r\n  \r\n  public static SeasonnoToBeginEnd(season:number) {\r\n    let year = (1995 + Math.floor(season / 4)) * 10000;\r\n    let s = season % 4;\r\n    if (s === 0) {\r\n      return {begin: year + 101, end: year + 331};\r\n    } \r\n    else if (s === 1) {\r\n      return {begin: year + 401, end: year + 630};\r\n    }\r\n    else if (s === 2) {\r\n      return {begin: year + 701, end: year + 930};\r\n    }\r\n    return {begin: year + 1001, end: year + 1231};\r\n  }\r\n\r\n  public static CalculatePredictAvg(arr: {predictpe:number}[]) {\r\n    let ret : {avg20:number, avg50:number, avg100:number} = {avg20:undefined, avg50:undefined, avg100:undefined};\r\n\r\n    let length = arr.length;\r\n    let calcuOne = (count:number) : number => {\r\n      let endIndex = count;\r\n      if (endIndex > length)\r\n        endIndex = length;\r\n      if (endIndex >= 10) {\r\n        let sum = 0;\r\n        for (let i = 3; i < endIndex; ++i) {\r\n          sum += arr[i].predictpe\r\n        }\r\n        return sum / (endIndex - 3);\r\n      }\r\n      else {\r\n        return undefined;\r\n      }\r\n    }\r\n\r\n    ret.avg20 = calcuOne(20);\r\n    ret.avg50 = calcuOne(50);\r\n    ret.avg100 = calcuOne(100);\r\n    return ret;\r\n  }\r\n\r\n  public static CalculateValueAvg(arr: {v:number}[]) {\r\n    let ret : {avg20:number, avg50:number, avg100:number, avg:number} = {avg20:undefined, avg50:undefined, avg100:undefined, avg:undefined};\r\n\r\n    let length = arr.length;\r\n    let calcuOne = (count:number) : number => {\r\n      let endIndex = count;\r\n      if (count === 0 || endIndex > length)\r\n        endIndex = length;\r\n      if (endIndex >= 10) {\r\n        let sum = 0;\r\n        for (let i = 3; i < endIndex; ++i) {\r\n          sum += arr[i].v;\r\n        }\r\n        return sum / (endIndex - 3);\r\n      }\r\n      else {\r\n        return undefined;\r\n      }\r\n    }\r\n\r\n    ret.avg20 = calcuOne(20);\r\n    ret.avg50 = calcuOne(50);\r\n    ret.avg100 = calcuOne(100);\r\n    ret.avg = calcuOne(0);\r\n    return ret;\r\n  }\r\n}\r\n"],"sourceRoot":""}