(window.webpackJsonpmifen=window.webpackJsonpmifen||[]).push([[3],{141:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n.n(r),c=n(2),i=n(3),s=n(4),u=n(6),o=n(5),l=n(7),p=n(0),m=n(8),b=n(57),f=(n(113),{_:{a:"d"}}),h={_:{a:"d"}},d=n(142);function v(){return m.nav.loginTop(p.createElement("div",{className:"d-flex align-items-center"},p.createElement("img",{className:"App-logo h-3c position-absolute",src:d,alt:"img"}),p.createElement("div",{className:"h3 flex-fill text-center"},p.createElement("span",{className:"text-primary mr-3"},"\u540c"),p.createElement("span",{className:"text-danger"},"\u82b1"))))}var g=[{type:"mobile",caption:"\u624b\u673a\u53f7",regex:m.mobileRegex},{type:"email",caption:"\u90ae\u7bb1",regex:m.emailRegex}];function y(e){return g.find((function(t){return!0===t.regex.test(e)}))}var w=function(e){function t(){var e,n;Object(i.a)(this,t);for(var r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];return(n=Object(u.a)(this,(e=Object(o.a)(t)).call.apply(e,[this].concat(s)))).account=void 0,n.type=void 0,n.password=void 0,n.verify=void 0,n.accountPageCaption="\u6ce8\u518c\u8d26\u53f7",n.accountLabel="\u6ce8\u518c\u8d26\u53f7",n.accountSubmitCaption="\u6ce8\u518c\u65b0\u8d26\u53f7",n.passwordPageCaption="\u8d26\u53f7\u5bc6\u7801",n.passwordSubmitCaption="\u6ce8\u518c\u65b0\u8d26\u53f7",n.successText="\u6ce8\u518c\u6210\u529f",n.login=Object(c.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.login({user:n.account,pwd:n.password,guest:m.nav.guest});case 2:if(void 0!==(t=e.sent)){e.next=6;break}return alert("something wrong!"),e.abrupt("return");case 6:return e.next=8,m.nav.logined(t);case 8:case"end":return e.stop()}}),e)}))),n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"internalStart",value:function(){var e=Object(c.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.openVPage(k);case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"toVerify",value:function(e){this.account=e,this.openVPage(E)}},{key:"toPassword",value:function(){this.openVPage(j)}},{key:"toSuccess",value:function(){this.openVPage(O)}},{key:"regReturn",value:function(e){var t;switch(e){default:return"\u670d\u52a1\u5668\u53d1\u751f\u9519\u8bef";case 4:return"\u9a8c\u8bc1\u7801\u9519\u8bef";case 0:return;case 1:t="\u7528\u6237\u540d "+this.account;break;case 2:t="\u624b\u673a\u53f7 +"+this.account;break;case 3:t="\u90ae\u7bb1 "+this.account}return t+" \u5df2\u7ecf\u88ab\u6ce8\u518c\u8fc7\u4e86"}},{key:"checkAccount",value:function(){var e=Object(c.a)(a.a.mark((function e(){var t,n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.isExists(this.account);case 2:if(t=e.sent,void 0===(n=this.accountError(t))){e.next=6;break}return e.abrupt("return",n);case 6:return e.next=8,b.a.setVerify(this.account,this.type);case 8:return t=e.sent,this.toVerify(this.account),e.abrupt("return");case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"accountError",value:function(e){if(e>0)return"\u5df2\u7ecf\u88ab\u6ce8\u518c\u4f7f\u7528\u4e86"}},{key:"execute",value:function(){var e=Object(c.a)(a.a.mark((function e(){var t,n,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t={nick:void 0,user:this.account,pwd:this.password,country:void 0,mobile:void 0,mobileCountry:void 0,email:void 0,verify:this.verify},e.t0=this.type,e.next="mobile"===e.t0?4:"email"===e.t0?7:9;break;case 4:return t.mobile=Number(this.account),t.mobileCountry=86,e.abrupt("break",9);case 7:return t.email=this.account,e.abrupt("break",9);case 9:return e.next=11,b.a.register(t);case 11:if(0!==(n=e.sent)){e.next=16;break}return m.nav.clear(),this.toSuccess(),e.abrupt("return");case 16:return r=this.regReturn(n),e.abrupt("return",r);case 18:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),t}(m.Controller),x=function(e){function t(){var e,n;Object(i.a)(this,t);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(n=Object(u.a)(this,(e=Object(o.a)(t)).call.apply(e,[this].concat(a)))).accountPageCaption="\u5bc6\u7801\u627e\u56de",n.accountLabel="\u8d26\u53f7",n.accountSubmitCaption="\u6ce8\u518c\u65b0\u8d26\u53f7",n.passwordPageCaption="\u91cd\u7f6e\u5bc6\u7801",n.passwordSubmitCaption="\u63d0\u4ea4",n.successText="\u6210\u529f\u4fee\u6539\u5bc6\u7801",n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"execute",value:function(){var e=Object(c.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.resetPassword(this.account,this.password,this.verify,this.type);case 2:return m.nav.clear(),this.toSuccess(),e.abrupt("return",void 0);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"accountError",value:function(e){if(0===e)return"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u8d26\u53f7"}}]),t}(w),k=function(e){function t(){var e,n;Object(i.a)(this,t);for(var r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];return(n=Object(u.a)(this,(e=Object(o.a)(t)).call.apply(e,[this].concat(s)))).schema=[{name:"user",type:"string",required:!0,maxLength:100},{name:"verify",type:"submit"}],n.uiSchema=void 0,n.res=Object(m.resLang)(h),n.page=function(){return p.createElement(m.Page,{header:n.controller.accountPageCaption},p.createElement("div",{className:"w-max-20c my-5 py-5",style:{marginLeft:"auto",marginRight:"auto"}},v(),p.createElement("div",{className:"h-3c"}),p.createElement(m.Form,{schema:n.schema,uiSchema:n.uiSchema,onButtonClick:n.onSubmit,onEnter:n.onEnter,requiredFlag:!1})))},n.onSubmit=function(){var e=Object(c.a)(a.a.mark((function e(t,r){var c,i,s,u,o;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.clearContextErrors(),c="user",i=r.getValue(c),void 0!==(s=y(i))){e.next=7;break}return r.setError(c,"\u5fc5\u987b\u662f\u624b\u673a\u53f7\u6216\u90ae\u7bb1"),e.abrupt("return");case 7:if("mobile"!==(u=s.type)){e.next=12;break}if(11===i.length&&"1"===i[0]){e.next=12;break}return r.setError(c,"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u624b\u673a\u53f7"),e.abrupt("return");case 12:return n.controller.account=i,n.controller.type=u,e.next=16,n.controller.checkAccount();case 16:void 0!==(o=e.sent)&&r.setError(c,o);case 18:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),n.onEnter=function(){var e=Object(c.a)(a.a.mark((function e(t,r){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("user"!==t){e.next=4;break}return e.next=3,n.onSubmit("verify",r);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"open",value:function(){var e=Object(c.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.uiSchema={items:{user:{widget:"text",label:this.controller.accountLabel,placeholder:"\u624b\u673a\u53f7\u6216\u90ae\u7bb1"},verify:{widget:"button",className:"btn btn-primary btn-block mt-3",label:"\u53d1\u9001\u9a8c\u8bc1\u7801"}}},this.openPage(this.page);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),t}(m.VPage),E=function(e){function t(){var e,n;Object(i.a)(this,t);for(var r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];return(n=Object(u.a)(this,(e=Object(o.a)(t)).call.apply(e,[this].concat(s)))).schema=[{name:"verify",type:"number",required:!0,maxLength:6},{name:"submit",type:"submit"}],n.onVerifyChanged=function(e,t,n){e.setDisabled("submit",!t||6!==t.length)},n.uiSchema={items:{verify:{widget:"text",label:"\u9a8c\u8bc1\u7801",placeholder:"\u8bf7\u8f93\u5165\u9a8c\u8bc1\u7801",onChanged:n.onVerifyChanged},submit:{widget:"button",className:"btn btn-primary btn-block mt-3",label:"\u4e0b\u4e00\u6b65 >",disabled:!0}}},n.onSubmit=function(){var e=Object(c.a)(a.a.mark((function e(t,r){var c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=n.controller.verify=r.getValue("verify"),e.next=3,b.a.checkVerify(n.controller.account,c);case 3:if(0!==e.sent){e.next=7;break}return r.setError("verify","\u9a8c\u8bc1\u7801\u9519\u8bef"),e.abrupt("return");case 7:n.controller.toPassword();case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),n.onEnter=function(){var e=Object(c.a)(a.a.mark((function e(t,r){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("verify"!==t){e.next=4;break}return e.next=3,n.onSubmit("submit",r);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),n.page=function(){var e,t;switch(n.controller.type){case"mobile":e="\u624b\u673a\u53f7";break;case"email":e="\u90ae\u7bb1",t=p.createElement(p.Fragment,null,p.createElement("span",{className:"text-danger"},"\u6ce8\u610f"),": \u6709\u53ef\u80fd\u8bef\u4e3a\u5783\u573e\u90ae\u4ef6\uff0c\u8bf7\u68c0\u67e5",p.createElement("br",null))}return p.createElement(m.Page,{header:"\u9a8c\u8bc1\u7801"},p.createElement("div",{className:"w-max-20c my-5 py-5",style:{marginLeft:"auto",marginRight:"auto"}},"\u9a8c\u8bc1\u7801\u5df2\u7ecf\u53d1\u9001\u5230",e,p.createElement("br",null),p.createElement("div",{className:"py-2 px-3 my-2 text-primary bg-light"},p.createElement("b",null,n.controller.account)),t,p.createElement("div",{className:"h-1c"}),p.createElement(m.Form,{schema:n.schema,uiSchema:n.uiSchema,onButtonClick:n.onSubmit,onEnter:n.onEnter,requiredFlag:!1})))},n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"open",value:function(){var e=Object(c.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.openPage(this.page);case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),t}(m.VPage),j=function(e){function t(){var e,n;Object(i.a)(this,t);for(var r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];return(n=Object(u.a)(this,(e=Object(o.a)(t)).call.apply(e,[this].concat(s)))).schema=[{name:"pwd",type:"string",required:!0,maxLength:100},{name:"rePwd",type:"string",required:!0,maxLength:100},{name:"submit",type:"submit"}],n.uiSchema=void 0,n.onSubmit=function(){var e=Object(c.a)(a.a.mark((function e(t,r){var c,i,s,u;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=r.form.data,i=c.pwd,s=c.rePwd,i&&i===s){e.next=9;break}r.setValue("pwd",""),r.setValue("rePwd",""),u="\u5bc6\u7801\u9519\u8bef\uff0c\u8bf7\u91cd\u65b0\u8f93\u5165\u5bc6\u7801\uff01",r.setError("pwd",u),e.next=14;break;case 9:return n.controller.password=i,e.next=12,n.controller.execute();case 12:void 0!==(u=e.sent)&&m.nav.push(p.createElement(m.Page,{header:"\u6ce8\u518c\u4e0d\u6210\u529f"},p.createElement("div",{className:"p-5 text-danger"},u)));case 14:return e.abrupt("return",u);case 15:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),n.onEnter=function(){var e=Object(c.a)(a.a.mark((function e(t,r){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("rePwd"!==t){e.next=4;break}return e.next=3,n.onSubmit("submit",r);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),n.page=function(){return p.createElement(m.Page,{header:n.controller.passwordPageCaption},p.createElement("div",{className:"w-max-20c my-5 py-5",style:{marginLeft:"auto",marginRight:"auto"}},"\u6ce8\u518c\u8d26\u53f7",p.createElement("br",null),p.createElement("div",{className:"py-2 px-3 my-2 text-primary bg-light"},p.createElement("b",null,n.controller.account)),p.createElement("div",{className:"h-1c"}),p.createElement(m.Form,{schema:n.schema,uiSchema:n.uiSchema,onButtonClick:n.onSubmit,onEnter:n.onEnter,requiredFlag:!1})))},n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"open",value:function(){var e=Object(c.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.uiSchema={items:{pwd:{widget:"password",placeholder:"\u5bc6\u7801",label:"\u5bc6\u7801"},rePwd:{widget:"password",placeholder:"\u91cd\u590d\u5bc6\u7801",label:"\u91cd\u590d\u5bc6\u7801"},submit:{widget:"button",className:"btn btn-primary btn-block mt-3",label:this.controller.passwordSubmitCaption}}},this.openPage(this.page);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),t}(m.VPage),O=function(e){function t(){var e,n;Object(i.a)(this,t);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(n=Object(u.a)(this,(e=Object(o.a)(t)).call.apply(e,[this].concat(a)))).page=function(){var e=n.controller,t=e.account,r=e.successText,a=e.login;return p.createElement(m.Page,{header:!1},p.createElement("div",{className:"container w-max-30c"},p.createElement("form",{className:"my-5"},p.createElement("div",{className:"py-5"},"\u8d26\u53f7 ",p.createElement("strong",{className:"text-primary"},t," ")," ",r,"\uff01"),p.createElement("button",{className:"btn btn-success btn-block",type:"button",onClick:a},"\u76f4\u63a5\u767b\u5f55"))))},n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"open",value:function(){var e=Object(c.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.openPage(this.page);case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),t}(m.VPage);n.d(t,"default",(function(){return N}));var S=[{name:"username",type:"string",required:!0,maxLength:100},{name:"password",type:"string",required:!0,maxLength:100},{name:"login",type:"submit"}],N=function(e){function t(){var e,n;Object(i.a)(this,t);for(var r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];return(n=Object(u.a)(this,(e=Object(o.a)(t)).call.apply(e,[this].concat(s)))).res=Object(m.resLang)(f),n.uiSchema={items:{username:{placeholder:"\u624b\u673a/\u90ae\u7bb1/\u7528\u6237\u540d",label:"\u767b\u5f55\u8d26\u53f7"},password:{widget:"password",placeholder:"\u5bc6\u7801",label:"\u5bc6\u7801"},login:{widget:"button",className:"btn btn-primary btn-block mt-3",label:"\u767b\u5f55"}}},n.onSubmit=function(){var e=Object(c.a)(a.a.mark((function e(t,r){var c,i,s,u,o,l;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=r.form.data,i=c.username,void 0!==(s=c.password)){e.next=5;break}return e.abrupt("return","something wrong, pwd is undefined");case 5:return e.next=7,b.a.login({user:i,pwd:s,guest:m.nav.guest});case 7:if(void 0!==(u=e.sent)){e.next=12;break}return o=y(i),l=void 0!==o?o.caption:"\u7528\u6237\u540d",e.abrupt("return",l+"\u6216\u5bc6\u7801\u9519\uff01");case 12:return console.log("onLoginSubmit: user=%s pwd:%s",u.name,u.token),e.next=15,m.nav.logined(u,n.props.callback);case 15:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),n.onEnter=function(){var e=Object(c.a)(a.a.mark((function e(t,r){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("password"!==t){e.next=4;break}return e.next=3,n.onSubmit("login",r);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),n.clickReg=function(){new w(void 0).start()},n.clickForget=function(){new x(void 0).start()},n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this,t=p.createElement("div",{className:"text-center"},p.createElement("button",{className:"btn btn-link",color:"link",style:{margin:"0px auto"},onClick:this.clickReg},"\u6ce8\u518c\u8d26\u53f7")),n=!1;return!0===this.props.withBack&&(n="\u767b\u5f55"),p.createElement(m.Page,{header:n,footer:t},p.createElement("div",{className:"d-flex h-100 flex-column justify-content-center align-items-center"},p.createElement("div",{className:"flex-fill"}),p.createElement("div",{className:"w-20c"},v(),p.createElement("div",{className:"h-2c"}),p.createElement(m.Form,{schema:S,uiSchema:this.uiSchema,onButtonClick:this.onSubmit,onEnter:this.onEnter,requiredFlag:!1}),p.createElement("button",{className:"btn btn-link btn-block",onClick:function(){return e.clickForget()}},"\u5fd8\u8bb0\u5bc6\u7801")),p.createElement("div",{className:"flex-fill"}),p.createElement("div",{className:"flex-fill"})))}}]),t}(p.Component)},142:function(e,t,n){e.exports=n.p+"static/media/logo.5d5d9eef.svg"}}]);
//# sourceMappingURL=3.c98eaf70.chunk.js.map