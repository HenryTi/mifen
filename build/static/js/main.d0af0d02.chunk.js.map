{"version":3,"sources":["tool/GFunc.tsx","store/accounts.ts","store/store.ts","stockinfo/VTags.tsx","stockinfo/CStockInfo.tsx","UqApp/uqs/BruceYuMi/Account.ui.tsx","UqApp/uqs/BruceYuMi/Holding.ui.tsx","UqApp/uqs/BruceYuMi/Transaction.ui.tsx","UqApp/uqs/BruceYuMi/Stock.ui.tsx","UqApp/uqs/BruceYuMi/Market.ui.tsx","UqApp/uqs/BruceYuMi/Portfolio.ui.tsx","UqApp/uqs/BruceYuMi/StockValue.ui.tsx","UqApp/uqs/BruceYuMi/AccountValue.ui.tsx","UqApp/uqs/BruceYuMi/UserAccount.ui.tsx","consts.ts","regression/SlrForEarning.ts","regression/ErForEarning.ts","App.tsx","reportWebVitals.ts","index.tsx","tool/render.tsx","tool/func.ts","store/index.ts","store/sortStocks.ts","appConfig.ts","UqApp/CBase.ts","images/logo.svg","home/VSiteHeader.tsx","home/VSearchHeader.tsx","home/VHome.tsx","home/VSelectTag.tsx","home/VMarketPE.tsx","home/CMarketPE.tsx","home/CHome.tsx","me/VEditMe.tsx","me/VFaq.tsx","me/VAbout.tsx","me/VMe.tsx","me/CMe.ts","explorer/VSiteHeader.tsx","explorer/VExplorer.tsx","explorer/VExplorerCfg.tsx","explorer/explore.ts","explorer/CExplorer.tsx","warning/VWarningConfig.tsx","warning/CWarning.tsx","predicthistory/VPredictHistory.tsx","predicthistory/CPredictHistory.tsx","UqApp/res/index.ts","UqApp/res/zh.ts","UqApp/res/en.ts","holding/VHolding.tsx","holding/VAccount.tsx","holding/CHolding.ts","UqApp/VMain.tsx","net/httpChannel.ts","net/httpChannelUI.ts","net/apiBase.ts","net/miApi.ts","net/miNet.ts","group/VGroup.tsx","group/CGroup.ts","UqApp/CApp.ts","selectStock/VSelectStock.tsx","selectStock/CSelectStock.tsx","stockinfo/VStockInfo.tsx","store/stockGroups.ts","store/stockGroup.ts","UqApp/uqs/BruceYuMi/index.ts","stockinfo/index.ts"],"names":["GFunc","n","w","undefined","toFixed","isNaN","Math","round","toString","precision","toPrecision","Number","parseFloat","t","r2","iRate","e1","e2","e3","r","r3","z","divyield","pe","e","bonus","price","pow","data","ret","length","funcz","p","i","day","floor","year","month","no","season","s","begin","end","arr","avg20","avg50","avg100","calcuOne","count","endIndex","sum","predictpe","avg","v","caption","value","className","Accounts","miNet","accounts","account","makeObservable","this","observable","a","t_allaccounts","Array","isArray","name","find","Store","stockGroups","setStockSortType","type","config","stockFind","sortType","saveConfig","setStockSelectType","selectType","setUserSortType","userStock","selectTag","item","groupFromName","groupName","selectAccount","setCurrentAccount","accountName","setRegressionConfig","cfg","regression","StockGroups","loadConfig","JSON","stringify","t_usersettings$save","Promise","all","t_usersettings$query","load","rets","init","cStr","c","parse","tagName","group","defaultGroupName","group0","bmin","bmax","lmin","lmax","lr2","mcount","lr4","r210","irate","stock","defaultGroup","addStock","removeStock","queryName","query","pageStart","pageSize","user","userId","blackID","blackGroup","id","bMin","bMax","lMin","lMax","process","q_getlasttradeday","isMySelect","isMyBlack","VTags","onSelect","isSelected","anySelected","controller","onClickSelectTag","onEditTag","tag","preventDefault","renderTag","left","right","defaultBlackListGroupName","onClick","page","observer","selectedTags","groups","cApp","store","divNewTag","onNewTag","header","headerClassName","items","render","selectedItems","param","openPage","VPage","schema","required","maxLength","uiSchema","widget","label","placeholder","visible","submit","VNewTag","onFormButtonClick","context","onSaveNewTag","closePage","formData","onButtonClick","VEditTag","onSaveTag","fData","CStockInfo","exrightForEarning","exrightInfo","historyDataOrg","_capitalearning","array","deep","_bonus","_divideInfo","initLoad","baseItem","q_stockallinfo","t_tagstock$query","stockTags","arr1","clear","arr2","push","arr3","arr4","loadTTMEarning","loadHistoryData","loaded","openMetaView","onSelectTag","getSelected","openVPage","t_tag$save","retId","alert","add","StockGroup","exists","groupFromId","nav","addTagStock","newTag","removeTagStock","findIndex","splice","onClickDefaultTag","groupId","showSelectStock","cStock","CSelectStock","call","b","changeDay","code","symbol","ni","list","seasonData","seasonlist","len","minNo","seasonno","lastItem","lastShares","shares","maxNo","SeasonnoToBeginEnd","sItem","capital","pseason","esum","profit","corg","eorg","es","esumorg","earning","si","noBegin","predictData","predictSeasonData","predictSeasonDataFull","ypredict","x","er","ErForEarning","lr","SlrForEarning","B","epre","predict","l","slopeR","lpre","endDay","exitem","factor","showAll","historyData","lastdayno","dayno","lastDay","not","historyList","RestorePrice","ttm","CalculateHistoryPE","dayFrom","dayIndex","bsum","pricere","factore","SeasonnoFromDay","VStockInfo","CUqBase","computed","fields","fieldArr","ui","res","zh","en","holding","tick","quantity","amount","market","currency","miRate","divident","roe","inc1","inc2","inc3","inc4","preInc","marketValue","mi","id2","consts","uqBasedata","appIcon","miApiHost","miApiHostDebug","isDevelopment","y","slope","intercept","endY","regress","score","xSum","ySum","xSquared","xY","numerator","ym","y2","chi2","rmsd","ySquared","yi2","yi","yiyi2","sqrt","A","yx","log","exp","App","onLogined","start","CApp","appConfig","React","Component","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","StrictMode","document","getElementById","renderSortCol","radioName","sortMethod","sort","defaultSort","defaultChecked","renderSortHeaders","role","aria-label","renderStockInfoRow","row","onClickName","inputSelect","inputSelectSpan","order","total","ep","zzl","calculateZZ3","dataArr","rows","log2","map","valueType","vStr","cn","_cn","percent0","percent1","number","numberToMarketValue","renderValue","renderStockUrl","href","target","rel","stopPropagation","sortStocks","getsortFunc","o","version","app","uqs","dev","alias","noUnit","tvs","oem","htmlTitle","CBase","CUqApp","CSub","CAppBase","VSiteHeader","src","logo","alt","style","height","width","renderSearchHeader","View","VSearchHeader","onSearch","key","size","VHome","renderRow","index","rowContent","rowKey","openStockInfo","onSelected","clickRow","callOnSelected","stockGroup","action","changeGroup","actions","openMarketPE","onAddStock","manageGroups","icon","scroller","onPage","setSortType","stocks","before","none","VSelectTag","onClickTag","VMarketPE","input","checkLimitShow","f","checked","onLongShortFlag","head","pageContent","historyChart","chartHistory","labelList","peList","eList","numberToPrecision","chartdata1","labels","datasets","borderColor","backgroundColor","borderWidth","fill","yAxisID","options","scales","yAxes","display","position","gridLines","drawOnChartArea","onChange","CMarketPE","longshortFlag","loadData","dt","Date","getFullYear","getMonth","getDate","q_marketpe","reverse","CHome","getHomeStockGroup","loadItems","showGroupsManage","onWarningConfg","cWarning","renderSiteHeader","renderView","tab","newC","VEditMe","props","nick","onItemChanged","itemSchema","newValue","preValue","userApi","userSetProp","saveLocalUser","onExit","showLogout","changePassword","gridRows","component","iconClass","text","bk","values","VFaq","VAbout","top","VMe","meInfo","showEditMe","userSpan","String","substr","faq","about","aboutRows","logout","CMe","unitOwner","rootUnits","VExplorer","labelId","middle","onSelectItem","onClickItem","onConfig","inverse","explore","avgs","avgStr","numberToFixString","VExplorerCfg","sortChage","newType","selectChange","findStockConfg","Explore","lastTradeDay","runInAction","loadExportItems","lastDayRet","result","dataArray","sl","calculateVN","exprice","CalculateValueAvg","CExplorer","onItemSelected","onItemUnselected","renderHome","onClickPredictAVG","priceDay","openPredictAVG","VWarningConfig","warnings","onNewWarning","renderWarning","witem","warningTypeString","title","VNewWarning","newuiSchema","pickId","Templet","onSaveNewWarning","CWarning","loadWarnings","t_stockwarning$add","onSaveWarning","t_stockwarning$all","VPredictHistory","avg20List","avg50List","avg100List","CPredictHistory","t_toppredictavg$query","li","$zh","home","relation","discover","me","aboutTheApp","pleaseLogin","notes","task","assign","noteSpace","noteText","noteList","noteCheckable","noteTask","noteFolder","noteCreateSpace","content","$en","VHolding","renderAccount","onClickAccount","showAccount","VAccount","CHolding","BruceYuMi","Account","UserAccount","ID","IX","IDinIX","IDNO","accountNO","IDActs","paramValue","IDX","AccountValue","forEach","Object","VMain","cHome","cHolding","cExporer","cMe","tabs","notify","onShown","selected","TabCaptionComponent","color","HttpChannel","hostUrl","apiToken","timeout","startWait","endWait","url","reject","showError","error","post","params","keys","k","buildOptions","method","innerFetch","body","resolve","buildError","err","channel","that","path","console","timeOutHandler","setTimeout","fetch","encodeURI","ok","clearTimeout","statusText","ct","headers","get","indexOf","json","retJson","catch","message","toLowerCase","startsWith","u","language","culture","Headers","append","lang","HttpChannelNavUI","onError","channelUIs","channelNoUIs","MiApiChannel","basePath","apiName","uqToken","showWaiting","token","channels","channelUI","getHttpChannel","callFetch","put","delete","MiApi","pbody","_","clone","proc","MiNet","miApi","miHost","baseURI","tagId","baseId","VGroup","CGroup","setRes","vp","open","VStockSelect","onClickStock","model","returnStock","renderStock","pageItems","more","searchByKey","allowEmptySearch","PageStockItems","firstSize","q_stocks$page","$page","PageItems","first","returnCall","check","ttmLimit","checkShowLater","checkDefaultTag","isLogined","headStr","dateHead","baseInfo","predictInfo","predictSeasonEarning","seasonEarning","capitalEarning","evt","isInteger","trim","onSubmit","dayString","ref","defaultValue","percentToFixString","window","opener","priceList","ttmList","chart1","showLine","pointStyle","pointRadius","per","plr","chart2","predictChartFullInfo","chart3","predictChartROE","numberToString","SeasonnoToYearMonth","chartdataFull","loading","capitalearning","tags","filter","st","t_tag$all","checkDefaultTags","r1","replace","br","yearlen","t_tagstock$add","unshift","t_tagstock$del","stockId","setUI","uq","Holding","Transaction","Stock","Market","Portfolio","StockValue"],"mappings":"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","file":"static/js/main.d0af0d02.chunk.js","sourcesContent":["import * as React from 'react';\r\n\r\nexport class GFunc {\r\n  public static numberToFixString(n: number, w = 2) {\r\n    return n === undefined ? '' : n.toFixed(w);\r\n  }\r\n  public static number(n: number, w=2) {\r\n    return n === undefined ? '' : n.toFixed(w);\r\n  }\r\n\r\n  public static numberToMarketValue(n: number) {\r\n    return n === undefined || isNaN(n) ? '' : Math.round(n/10000).toString(); // + '亿';\r\n  }\r\n\r\n  public static numberToString(n: number, precision = 2) {\r\n    return n === undefined ? '' : n.toPrecision(precision);\r\n  }\r\n\r\n  public static numberToPrecision(n: number, precision = 4) {\r\n    return n === undefined ? undefined : Number.parseFloat(n.toPrecision(precision));\r\n  }\r\n\r\n  public static percentToFixString(n: number) {\r\n    return n === undefined || isNaN(n) ? '' : (n * 100).toFixed(2) + '%';\r\n  }\r\n\r\n  public static percent0(n: number) {\r\n    return n === undefined || isNaN(n) ? '' : (n * 100).toFixed(0) + '%';\r\n  }\r\n  public static percent1(n: number) {\r\n    return n === undefined || isNaN(n) ? '' : (n * 100).toFixed(1) + '%';\r\n  }\r\n\r\n  public static warningTypeString(t: string) {\r\n    switch (t) {\r\n      case 'gt': return '大于';\r\n      case 'lt': return '小于';\r\n      default: return t;\r\n    }\r\n  }\r\n\r\n  public static predictCutRatio(r2:number) {\r\n    return r2 * 2 - r2 * r2;\r\n  }\r\n\r\n  public static evaluatePricePrice(iRate:number, e1:number, e2:number, e3:number) {\r\n    let r = 1 + iRate;\r\n    let r2 = r * r;\r\n    let r3 = r2 * r;\r\n    return (e1/r + e2 /r2 + e3 / r3 + e3 / iRate / r3) / 2;\r\n  }\r\n\r\n  public static calculateV(z:number, divyield:number, pe:number) {\r\n    if (pe === undefined || isNaN(pe)) {\r\n      return undefined;\r\n    }\r\n\r\n    let r = 0;\r\n    if (z !== undefined) {\r\n      if (z > 0.25) {\r\n        z = 0.25;\r\n      }\r\n      r += z * 100;\r\n    }\r\n    if (divyield !== undefined) {\r\n      r += divyield * 100;\r\n    }\r\n    return r / pe;\r\n  }\r\n\r\n  public static calculateVN(z:number, e:number, bonus:number, price:number) {\r\n    if (price === undefined || isNaN(price) || e === undefined || isNaN(e)) {\r\n      return undefined;\r\n    }\r\n\r\n    let r = 0;\r\n    if (z !== undefined && e > 0) {\r\n      if (z > 0.25) {\r\n        z = 0.24 + Math.pow((z-0.24)*100, 0.6667) / 100;\r\n      }\r\n      z = 1 + z;\r\n      z = z * z * z - 1;\r\n      r += z * e * 100;\r\n    }\r\n    if (bonus !== undefined && !isNaN(bonus)) {\r\n      r += bonus * 100;\r\n    }\r\n    return r / price;\r\n  }\r\n\r\n  public static calculateZZ3(data:number[]) {\r\n    let ret:number[] = [undefined, undefined, undefined, undefined] ;\r\n    if (data === undefined)\r\n      return ret;\r\n    let len = data.length;\r\n    if (len < 5)\r\n      return ret;\r\n    \r\n    let funcz = (n:number, p:number) => {\r\n      if (p <= 0 || n <= 0)\r\n        return undefined;\r\n      return ((n / p) - 1);\r\n    }\r\n    for (let i = 0; i < 4; ++i) {\r\n      ret[i] = funcz(data[i+1], data[i]);\r\n    }\r\n    return ret;\r\n  }\r\n\r\n  public static caption = (value:string) => <span className=\"text-muted small\">{value}</span>;\r\n\r\n  public static MonthnoFromDay(day:number) {\r\n    let year = Math.floor(day/10000);\r\n    let month = Math.floor((day%10000)/100) - 1;\r\n    return (year-1995)*12+month;\r\n  }\r\n  \r\n  public static SeasonnoFromDay(day:number) {\r\n    let year = Math.floor(day/10000);\r\n    let month = Math.floor((day%10000)/100) - 1;\r\n    let season = Math.floor(month / 3);\r\n    return (year-1995)*4 + season;\r\n  }\r\n  \r\n  public static SeasonnoFromYearMonth(year:number, month:number) {\r\n    let season = Math.floor((month-1) / 3);\r\n    return (year-1995)*4 + season;\r\n  }\r\n\r\n  public static SeasonnoToYearMonth(no: number) {\r\n    let year = Math.floor(no / 4) + 1995;\r\n    let month = (Math.floor(no % 4) + 1) * 3;\r\n    return year * 100 + month;\r\n  }\r\n  \r\n  public static SeasonnoToBeginEnd(season:number) {\r\n    let year = (1995 + Math.floor(season / 4)) * 10000;\r\n    let s = season % 4;\r\n    if (s === 0) {\r\n      return {begin: year + 101, end: year + 331};\r\n    } \r\n    else if (s === 1) {\r\n      return {begin: year + 401, end: year + 630};\r\n    }\r\n    else if (s === 2) {\r\n      return {begin: year + 701, end: year + 930};\r\n    }\r\n    return {begin: year + 1001, end: year + 1231};\r\n  }\r\n\r\n  public static CalculatePredictAvg(arr: {predictpe:number}[]) {\r\n    let ret : {avg20:number, avg50:number, avg100:number} = {avg20:undefined, avg50:undefined, avg100:undefined};\r\n\r\n    let length = arr.length;\r\n    let calcuOne = (count:number) : number => {\r\n      let endIndex = count;\r\n      if (endIndex > length)\r\n        endIndex = length;\r\n      if (endIndex >= 10) {\r\n        let sum = 0;\r\n        for (let i = 3; i < endIndex; ++i) {\r\n          sum += arr[i].predictpe\r\n        }\r\n        return sum / (endIndex - 3);\r\n      }\r\n      else {\r\n        return undefined;\r\n      }\r\n    }\r\n\r\n    ret.avg20 = calcuOne(20);\r\n    ret.avg50 = calcuOne(50);\r\n    ret.avg100 = calcuOne(100);\r\n    return ret;\r\n  }\r\n\r\n  public static CalculateValueAvg(arr: {v:number}[]) {\r\n    let ret : {avg20:number, avg50:number, avg100:number, avg:number} = {avg20:undefined, avg50:undefined, avg100:undefined, avg:undefined};\r\n\r\n    let length = arr.length;\r\n    let calcuOne = (count:number) : number => {\r\n      let endIndex = count;\r\n      if (count === 0 || endIndex > length)\r\n        endIndex = length;\r\n      if (endIndex >= 10) {\r\n        let sum = 0;\r\n        for (let i = 3; i < endIndex; ++i) {\r\n          sum += arr[i].v;\r\n        }\r\n        return sum / (endIndex - 3);\r\n      }\r\n      else {\r\n        return undefined;\r\n      }\r\n    }\r\n\r\n    ret.avg20 = calcuOne(20);\r\n    ret.avg50 = calcuOne(50);\r\n    ret.avg100 = calcuOne(100);\r\n    ret.avg = calcuOne(0);\r\n    return ret;\r\n  }\r\n}\r\n","import { makeObservable, observable } from \"mobx\";\r\nimport { MiNet } from \"../net\";\r\nimport { Account } from \"./types\";\r\n\r\nexport class Accounts {\r\n\tprivate miNet: MiNet;\r\n\taccounts: Account[] = null;\r\n\taccount: Account = null;\r\n\r\n\tconstructor(miNet: MiNet) {\r\n\t\tmakeObservable(this, {\r\n\t\t\taccounts: observable,\r\n\t\t\taccount: observable,\r\n\t\t});\r\n\t\tthis.miNet = miNet;\r\n\t}\r\n\r\n\tasync load() {\r\n\t\tlet r = await this.miNet.t_allaccounts();\r\n\t\tif (Array.isArray(r)) {\r\n\t\t\tthis.accounts = r;\r\n\t\t}\r\n\t}\r\n\r\n\tsetCurrentAccount(name:string):Account {\r\n\t\tthis.account = this.accounts.find(v => v.name === name);\r\n\t\treturn this.account;\r\n\t}\r\n}\r\n","import { IObservableArray, makeObservable, observable } from \"mobx\";\r\nimport { MiNet } from \"../net\";\r\nimport { defaultGroupName } from \"../consts\";\r\nimport { MiConfigs, RegressionConfig, Stock, StockFindConfig } from \"./types\";\r\nimport { sortStocks } from \"./sortStocks\";\r\nimport { StockGroups } from \"./stockGroups\";\r\nimport { Accounts } from \"./accounts\";\r\n\r\nexport class Store {\r\n\tprivate miNet: MiNet;\r\n\t//user: User;\r\n\t//userTag: UserTag;\r\n\t//homeItems: IObservableArray<any> = observable.array<any>([], { deep: true });\r\n\tstockGroups: StockGroups;\r\n\taccounts: Accounts;\r\n\t\r\n\tconstructor(miNet:MiNet) {\r\n\t\tmakeObservable(this, {\r\n\t\t\tconfig: observable,\r\n\t\t});\r\n\t\t//this.user = user;\r\n\t\t//let miHost = consts.miApiHost;\r\n\t\t//let token = this.user.token;\r\n\t\t//this.miApi = new MiApi(miHost, 'fsjs/', 'miapi', token, false);\r\n\t\tthis.miNet = miNet;\r\n\t\tthis.stockGroups = new StockGroups(miNet);\r\n\t\tthis.accounts = new Accounts(miNet);\r\n\t}\r\n\r\n\t@observable config: MiConfigs = { \r\n\t\tgroupName: defaultGroupName, \r\n\t\tstockFind: { sortType:'pe' },\r\n\t\tuserStock: { sortType:'tagpe'},\r\n\t\tregression: {bmin:0, bmax:0.5, r2:0.7, lmin:0.01, lmax:0.5, lr2:0.7, mcount:2, lr4: 3, r210:0.6, irate:0.04}\r\n\t};\r\n\t//@observable blackList: any[] = [];\r\n\t//@observable defaultList: any[] = [];\r\n\r\n\r\n\tgetHomeStockGroup() {\r\n\t\tlet name = this.config.groupName;\r\n\t\treturn this.stockGroups.groupFromName(name);\r\n\t}\r\n\t/*\r\n\t@computed get tagID(): number {\r\n\t\tif (this.stockGroups) {\r\n\t\t\tlet name = this.config.tagName;\r\n\t\t\tlet i = this.stockGroups.findIndex(v => v.groupName === name);\r\n\t\t\tif (i >= 0) {\r\n\t\t\t\treturn this.stockGroups[i].groupId as number;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn -1;\r\n\t}\r\n\t*/\r\n\r\n\tget findStockConfg(): StockFindConfig {\r\n\t\treturn this.config.stockFind;\r\n\t}\r\n\t/*\r\n\tget blackListTagID(): number {\r\n\t\tlet group = this.stockGroups.groupFromName(defaultBlackListGroupName);\r\n\t\treturn group?.groupId;\r\n\t}\r\n\r\n\tget defaultListTagID(): number {\r\n\t\tlet group = this.stockGroups.groupFromName(defaultGroupName);\r\n\t\treturn group?.groupId;\r\n\t}\r\n\t*/\r\n\r\n\tasync load() {\r\n\t\tawait this.loadConfig();\r\n\t\t//await this.loadHomeItems();\r\n\t}\r\n\r\n\tasync saveConfig() {\r\n\t\tlet v = JSON.stringify(this.config);\r\n\t\t//await this.miApi.call('t_usersettings$save', [this.user.id, 'config', v]);\r\n\t\tawait this.miNet.t_usersettings$save(v);\r\n\t}\r\n\r\n\tprotected async loadConfig() {\r\n\t\tlet rets = await Promise.all([\r\n\t\t\tthis.miNet.t_usersettings$query(),\r\n\t\t\tthis.stockGroups.load(),\r\n\t\t\tthis.accounts.load(),\r\n\t\t]);\r\n\t\tawait this.stockGroups.init();\r\n\t\tlet r = rets[0];\r\n\t\tif (r !== undefined) {\r\n\t\t\tlet ret = r;\r\n\t\t\tif (ret !== undefined && ret.length > 0) {\r\n\t\t\t\tlet cStr = ret[0].value;\r\n\t\t\t\tlet c = JSON.parse(cStr);\r\n\t\t\t\tif (this.stockGroups) {\r\n\t\t\t\t\tlet name = c.tagName;\r\n\t\t\t\t\tlet group = this.stockGroups.groupFromName(name);\r\n\t\t\t\t\tif (!group) {\r\n\t\t\t\t\t\tgroup = this.stockGroups.groupFromName(defaultGroupName);\r\n\t\t\t\t\t\tif (group) {\r\n\t\t\t\t\t\t\tc.tagName = defaultGroupName;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\tc.tagName = this.stockGroups.group0;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tc.groupName = c.tagName;\r\n\t\t\t\t}\r\n\t\t\t\tthis.config = c;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (this.config.stockFind === undefined) {\r\n\t\t\tthis.config.stockFind = { sortType: 'pe' };\r\n\t\t}\r\n\t\telse {\r\n\t\t\tswitch (this.config.stockFind.selectType) {\r\n\t\t\tcase 'all': break;\r\n\t\t\tcase 'peroe': break;\r\n\t\t\tcase 'pe': break;\r\n\t\t\tcase 'dp': break;\r\n\t\t\tdefault:\r\n\t\t\t\tthis.config.stockFind.selectType = 'all';\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (this.config.userStock === undefined) {\r\n\t\t\tthis.config.userStock = { sortType: 'tagpe' };\r\n\t\t}\r\n\t\tif (this.config.regression === undefined) {\r\n\t\t\tthis.config.regression = {bmin:0, bmax:0.5, r2:0.7, lmin:0.01, lmax:0.5, lr2:0.7, mcount:2, lr4: 3, r210:0.6, irate:0.04};\r\n\t\t}\r\n\t\telse {\r\n\t\t\tif (this.config.regression.r210 === undefined) {\r\n\t\t\t\tthis.config.regression.r210 = 0.6;\r\n\t\t\t}\r\n\t\t\tif (this.config.regression.irate === undefined) {\r\n\t\t\t\tthis.config.regression.irate = 0.04;\r\n\t\t\t}\r\n\t\t}\r\n\t\t/*\r\n\t\tawait Promise.all([\r\n\t\t\tthis.loadBlackList(), \r\n\t\t\tthis.loadDefaultList(),\r\n\t\t]);\r\n\t\t*/\r\n\t}\r\n\r\n\tsetStockSortType = async (type:string)=> {\r\n\t\tif (this.config.stockFind.sortType === type)\r\n\t\t\treturn;\r\n\t\tthis.config.stockFind.sortType = type;\r\n\t\tawait this.saveConfig();\r\n\t}\r\n\r\n\tsetStockSelectType = async (type:string) => {\r\n\t\tif (this.config.stockFind.selectType === type)\r\n\t\t\treturn;\r\n\t\tthis.config.stockFind.selectType = type;\r\n\t\tawait this.saveConfig();\r\n\t}\r\n\r\n\tsetUserSortType = async (type:string)=> {\r\n\t\tif (this.config.userStock.sortType === type) return;\r\n\t\tthis.config.userStock.sortType = type;\r\n\t\tawait this.saveConfig();\r\n\t}\r\n\r\n\tselectTag = async (item:any) => {\r\n\t\tlet {name} = item as {name:string, id:number};\r\n\t\tlet group = this.stockGroups.groupFromName(name);\r\n\t\tif (group) {\r\n\t\t\tthis.config.groupName = name;\r\n\t\t\tthis.saveConfig();\r\n\t\t}\r\n\t}\r\n\r\n\tselectAccount = async (item:any) => {\r\n\t\tlet {name} = item as {name:string, id:number};\r\n\t\tlet account = this.accounts.setCurrentAccount(name);\r\n\t\tif (account) {\r\n\t\t\tthis.config.accountName = name;\r\n\t\t\tthis.saveConfig();\r\n\t\t}\r\n\t}\r\n\r\n\tsetRegressionConfig = async (cfg: RegressionConfig) => {\r\n\t\tthis.config.regression = cfg;\r\n\t\tawait this.saveConfig();\r\n\t}\r\n\t/*\r\n\tprotected async loadBlackList(): Promise<void> {\r\n\t\tlet blackid = this.blackListTagID;\r\n\t\tif (blackid <= 0) {\r\n\t\t\tthis.blackList = [];\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tlet param = { user:this.user.id, tag:blackid};\r\n\t\ttry {\r\n\t\t\tlet ret = await this.miNet.t_tagstock$query(blackid, undefined);//await this.uqs.mi.TagStock.query(param);\r\n\t\t\tlet r = ret.map(item=> {\r\n\t\t\treturn item.stock;\r\n\t\t\t});\r\n\t\t\tthis.blackList = r;\r\n\t\t}\r\n\t\tcatch (error) {\r\n\t\t\tlet e = error;\r\n\t\t}\r\n\t}\r\n\r\n\tprotected async loadDefaultList(): Promise<void> {\r\n\t\tlet id = this.defaultListTagID;\r\n\t\tif (id <= 0) {\r\n\t\t\tthis.defaultList = [];\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tlet param = { user:this.user.id, tag:id};\r\n\t\ttry {\r\n\t\t\tlet ret = await this.miNet.t_tagstock$query(id, undefined);//await this.uqs.mi.TagStock.query(param);\r\n\t\t\tlet r = ret.map(item => item.stock);\r\n\t\t\tthis.defaultList = r;\r\n\t\t}\r\n\t\tcatch (error) {\r\n\t\t\tlet e = error;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate addBlackID(id:number) {\r\n\t\tlet i = this.blackList.findIndex(v=> v===id);\r\n\t\tif (i < 0) {\r\n\t\t\tthis.blackList.push(id);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate removeBlackID(id:number) {\r\n\t\tlet i = this.blackList.findIndex(v=> v===id);\r\n\t\tif (i >= 0) {\r\n\t\t\tthis.blackList.splice(i, 1);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate addDefaultID(id:number) {\r\n\t\tlet i = this.defaultList.findIndex(v=> v===id);\r\n\t\tif (i < 0) {\r\n\t\t\tthis.defaultList.push(id);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate removeDefaultID(id:number) {\r\n\t\tlet i = this.defaultList.findIndex(v=> v===id);\r\n\t\tif (i >= 0) {\r\n\t\t\tthis.defaultList.splice(i, 1);\r\n\t\t}\r\n\t}\r\n\r\n\tasync addStock(stockId:number) {\r\n\t\tif (stockId <= 0) return;\r\n\t\tlet tagid = this.defaultListTagID;\r\n\t\tawait this.miNet.t_tagstock$add(tagid, stockId);\r\n\t\tawait this.addTagStockID(tagid, stockId);\r\n\t\tlet group = this.stockGroups.groupFromId(tagid);\r\n\t\t//await this.loadHomeItems();\r\n\t\tgroup.addStock(stockId);\r\n\t}\r\n\t*/\r\n\r\n\tasync addTagStock(stock: Stock) {\r\n\t\t/*\r\n\t\tif (this.userTag && this.userTag.tagID === tagid) {\r\n\t\t\tif (tagid === this.blackListTagID) {\r\n\t\t\t\tthis.addBlackID(stockID);\r\n\t\t\t}\r\n\t\t\telse if (tagid === this.defaultListTagID) {\r\n\t\t\t\tthis.addDefaultID(stockID);\r\n\t\t\t}\r\n\t\t}\r\n\t\t*/\r\n\t\tawait this.stockGroups.defaultGroup.addStock(stock);\r\n\t}\r\n\r\n\t/*\r\n\tasync addTagStockIDs(tagid: number, stockIDs: number[]) {\r\n\t\tif (tagid === this.blackListTagID) {\r\n\t\t\tstockIDs.map(v=>this.addBlackID(v));\r\n\t\t}\r\n\t\telse if (tagid === this.defaultListTagID) {\r\n\t\t\tstockIDs.map(v=>this.addDefaultID(v));\r\n\t\t}\r\n\t}\r\n\t*/\r\n\r\n\tasync removeTagStock(stock: Stock) {\r\n\t\tawait this.stockGroups.defaultGroup.removeStock(stock);\r\n\t\t/*\r\n\t\tif (tagid === this.blackListTagID) {\r\n\t\t\tthis.removeBlackID(stockID);\r\n\t\t}\r\n\t\telse if (tagid === this.defaultListTagID) {\r\n\t\t\tthis.removeDefaultID(stockID);\r\n\t\t}\r\n\t\tif (this.userTag && this.userTag.tagID === tagid) {\r\n\t\t\tthis.removeStock(stockID);\r\n\t\t}\r\n\t\t*/\r\n\t}\r\n\r\n\t/*\r\n\tasync loadHomeItems() {\r\n\t\t// 距离上次\r\n\t\tlet queryName = 'taguser';\r\n\r\n\t\tlet query = {\r\n\t\t\tname: queryName,\r\n\t\t\tpageStart: 0,\r\n\t\t\tpageSize: 1000,\r\n\t\t\tuser: this.user.id,\r\n\t\t\ttag: this.tagID,\r\n\t\t\tyearlen: 1,\r\n\t\t};\r\n\t\tlet result = await this.miNet.process(query, []);\r\n\t\tif (Array.isArray(result) === false) return;\r\n\r\n\t\tlet arr = result as {id:number, order:number, data?:string, v?:number, e:number, e3:number, ep:number, price:number, exprice:number, divyield:number, r2:number, lr2:number, predictpe?:number, dataArr?:number[]}[];\r\n\t\tfor (let item of arr) {\r\n\t\t\tlet dataArray = JSON.parse(item.data) as number[];\r\n\t\t\titem.dataArr = dataArray;\r\n\t\t\tlet sl = new SlrForEarning(dataArray);\r\n\t\t\titem.ep = (sl.predict(4) + item.e) / 2;\r\n\t\t\titem.e3 = sl.predict(7);\r\n\t\t\titem.v = GFunc.calculateVN(sl.slopeR, item.ep, item.divyield * item.price, item.exprice);\r\n\t\t\titem.predictpe = item.price / item.e3;\r\n\t\t}\r\n\t\tthis.sortStocks(arr);\r\n\r\n\t\trunInAction(() => {\r\n\t\t\tthis.homeItems.clear();\r\n\t\t\tthis.homeItems.push(...arr);\t\r\n\t\t});\r\n\t}\r\n\t*/\r\n\r\n\tasync loadExportItems(queryName: string):Promise<any[]> {\r\n\t\t//let sName = this.store.config.stockFind.selectType;\r\n\t\tlet {bmin, bmax, r2, lmin, lmax, lr2, mcount, lr4, r210} = this.config.regression;\r\n\t\t//if (sName !== undefined)\r\n\t\t//  queryName = sName;\r\n\t\tlet query = {\r\n\t\t\tname: queryName,\r\n\t\t\tpageStart: 0,\r\n\t\t\tpageSize: 3000,\r\n\t\t\tuser: this.miNet.userId,\r\n\t\t\tblackID: this.stockGroups.blackGroup.id,\r\n\t\t\tbMin: bmin,\r\n\t\t\tbMax: bmax,\r\n\t\t\tr2: r2,\r\n\t\t\tlMin: lmin,\r\n\t\t\tlMax: lmax,\r\n\t\t\tlr2: lr2,\r\n\t\t\tmcount: mcount,\r\n\t\t\tlr4: lr4,\r\n\t\t\tr210: r210,\r\n\t\t};\r\n\t\tlet rets = await Promise.all([\r\n\t\t\tthis.miNet.process(query, []),\r\n\t\t\t//this.store.miApi.call('q_getlasttradeday', [])\r\n\t\t\tthis.miNet.q_getlasttradeday(),\r\n\t\t]);\r\n\t\treturn rets;\r\n\t}\r\n\r\n\tisMySelect(id:number): boolean {\r\n\t\treturn this.stockGroups.isMySelect(id);\r\n\t}\r\n\r\n\tisMyBlack(id:number): boolean {\r\n\t\treturn this.stockGroups.isMyBlack(id);\r\n\t}\r\n}\r\n","import * as React from 'react';\r\nimport { observer } from 'mobx-react-lite';\r\nimport { VPage, Page, FA, List, Form, ItemSchema, StringSchema, UiInputItem, UiSchema, Context, IdSchema, UiIdItem, LMR } from 'tonva-react';\r\nimport { CStockInfo } from './CStockInfo';\r\nimport { defaultBlackListGroupName, defaultGroupName } from '../consts';\r\n\r\nexport class VTags extends VPage<CStockInfo> {\r\n\tasync open(param?: any) {\r\n\t\tthis.openPage(this.page);\r\n\t}\r\n\r\n\tprivate onSelect = (item: any, isSelected: boolean, anySelected: boolean) => {\r\n\t\tthis.controller.onClickSelectTag(item, isSelected);\r\n\t}\r\n\r\n\tprivate onEditTag = (tag:any, e:React.MouseEvent) => {\r\n\t\te.preventDefault();\r\n\t\tthis.controller.onEditTag(tag);\r\n\t}\r\n\r\n\tprivate renderTag = (tag: any) => {\r\n\t\tlet left = <div className=\"px-3 py-2 cursor-pointer\">{tag.name}</div>;\r\n\t\tlet fdTag = tag.name === defaultBlackListGroupName || tag.name === defaultGroupName;\r\n\t\tlet right = fdTag ? '' : <div className=\"px-3 py-2 cursor-pointer\" onClick={(e)=>this.onEditTag(tag, e)}>编辑</div>;\r\n\t\treturn <LMR className=\"mx-3 my-2\" left={left} right={right}>\r\n\t\t</LMR>;\r\n\t}\r\n\r\n\tprivate page = observer(() => {\r\n\t\tlet { selectedTags } = this.controller;\r\n\t\tlet { stockGroups } = this.controller.cApp.store;\r\n\t\tlet { groups } = stockGroups;\r\n\t\tlet divNewTag = groups.length >= 10 ?\r\n\t\t\t''\r\n\t\t\t:\r\n\t\t\t<div className=\"px-3 py-2 cursor-pointer\" onClick={this.controller.onNewTag}>\r\n\t\t\t\t<FA name=\"plus\" className=\"text-primary\" />\r\n\t\t\t\t&nbsp; 新建分组\r\n\t\t\t</div>;\r\n\r\n\t\treturn <Page header=\"选择分组\" headerClassName=\"bg-primary\">\r\n\t\t\t{divNewTag}\r\n\t\t\t<List items={groups} \r\n\t\t\t\titem={{ onSelect: this.onSelect, render: this.renderTag }} \r\n\t\t\t\tselectedItems={selectedTags} />\r\n\t\t</Page>;\r\n\t});\r\n}\r\n\r\nconst schema: ItemSchema[] = [\r\n\t{ name: 'name', type: 'string', required: true, maxLength: 10 } as StringSchema,\r\n\t{ name: 'id', type: 'id' } as IdSchema,\r\n\t{ name: 'submit', type: 'submit', },\r\n];\r\nconst uiSchema: UiSchema = {\r\n\titems: {\r\n\t\tname: { widget: 'text', label: null, placeholder: '分组名称' } as UiInputItem,\r\n\t\tid: { widget: 'id', visible: false } as UiIdItem,\r\n\t\tsubmit: { widget: 'button', label: '保存', className: 'btn btn-primary' },\r\n\t}\r\n};\r\n\r\nexport class VNewTag extends VPage<CStockInfo> {\r\n\tasync open(param?: any) {\r\n\t\tthis.openPage(this.page);\r\n\t}\r\n\r\n\tprivate onFormButtonClick = async (name: string, context: Context) => {\r\n\t\tif (await this.controller.onSaveNewTag(context.data)) {\r\n\t\t\tthis.controller.closePage();\r\n\t\t}\r\n\t}\r\n\r\n\tprivate page = () => {\r\n\t\treturn <Page header=\"新建分组\" headerClassName=\"bg-primary\">\r\n\t\t\t<div className=\"px-3 py-3\">\r\n\t\t\t\t<Form schema={schema}\r\n\t\t\t\tuiSchema={uiSchema}\r\n\t\t\t\tformData={undefined}\r\n\t\t\t\tonButtonClick={this.onFormButtonClick}\r\n\t\t\t\t/>\r\n\t\t\t</div>\r\n\t\t\t</Page>;\r\n\t\t}\r\n\t}\r\n\r\nexport class VEditTag extends VPage<CStockInfo> {\r\n\tasync open(param?: any) {\r\n\t\tthis.openPage(this.page, param);\r\n\t}\r\n\r\n\tprivate onFormButtonClick = async (name: string, context: Context) => {\r\n\t\tif (await this.controller.onSaveTag(context.data)) {\r\n\t\t\tthis.controller.closePage();\r\n\t\t}\r\n\t}\r\n\r\n\tprivate page = (param?: any) => {\r\n\t\tlet {id, name} = param;\r\n\t\tlet fData = {id:id, name:name};\r\n\t\treturn <Page header=\"编辑分组\" headerClassName=\"bg-primary\">\r\n\t\t\t<div className=\"px-3 py-3\">\r\n\t\t\t\t<Form schema={schema}\r\n\t\t\t\tuiSchema={uiSchema}\r\n\t\t\t\tformData={fData}\r\n\t\t\t\tonButtonClick={this.onFormButtonClick}\r\n\t\t\t\t/>\r\n\t\t\t</div>\r\n\t\t</Page>;\r\n\t}\r\n}\r\n","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport { observable, IObservableArray, computed, makeObservable } from 'mobx';\r\nimport { nav } from 'tonva-react';\r\nimport { CUqBase } from '../UqApp';\r\nimport { GFunc } from '../tool/GFunc';\r\nimport { VStockInfo } from './VStockInfo'\r\nimport { NStockInfo, StockPrice, StockCapitalearning, StockBonus, StockDivideInfo } from './StockInfoType';\r\nimport { VTags, VNewTag, VEditTag } from './VTags';\r\nimport { ErForEarning, SlrForEarning } from 'regression';\r\nimport { StockGroup } from '../store';\r\nimport { CSelectStock } from '../selectStock';\r\n\r\nexport class CStockInfo extends CUqBase {\r\n\t@observable baseItem: NStockInfo;\r\n\t@observable protected loaded: boolean = false;\r\n\r\n\t@observable price: StockPrice;\r\n\t//@observable roe: StockRoe;\r\n\t//@observable tags: any[] = undefined;\r\n\t@observable stockTags: any[];\r\n\tselectedTags: any[];\r\n\r\n\tprotected exrightForEarning: {day:number, factor:number}[] = [];\r\n\tprotected exrightInfo: {day:number, bonus:number, factor:number, factore:number}[] = [];\r\n\t@observable seasonData:{season:number, c:number, e:number, esum:number, corg:number, eorg:number, esumorg:number}[] = [];\r\n\t@observable predictSeasonData:{season:number, c:number, e:number, esum:number, corg:number, eorg:number, esumorg:number}[] = [];\r\n\t@observable predictSeasonDataFull:{season:number, c:number, e:number, esum:number, corg:number, eorg:number, esumorg:number}[] = [];\r\n\t@observable predictData: { e:number, b: number, r2: number, epre:number, l:number, lr2:number, lpre:number};\r\n\t@observable ypredict: number[] = [];\r\n\t@observable historyData:{day:number, price:number, ttm:number}[] =  [];\r\n\tprotected historyDataOrg:{day:number, price:number, dayno:number}[] = [];\r\n\r\n\t//protected _earning: IObservableArray<StockEarning> = observable.array<StockEarning>([], { deep: true });\r\n\tprotected _capitalearning: IObservableArray<StockCapitalearning> = observable.array<StockCapitalearning>([], { deep: true });\r\n\tprotected _bonus: IObservableArray<StockBonus> = observable.array<StockBonus>([], { deep: true });\r\n\tprotected _divideInfo: IObservableArray<StockDivideInfo> = observable.array<StockDivideInfo>([], { deep: true });\r\n\r\n\t// @computed get earning(): IObservableArray<StockEarning> {\r\n\t//   if (this.loaded === false) return undefined;\r\n\t//   return this._earning;\r\n\t// }\r\n\r\n\t@computed get capitalearning(): IObservableArray<StockCapitalearning> {\r\n\t\tif (this.loaded === false) return undefined;\r\n\t\treturn this._capitalearning;\r\n\t}\r\n\r\n\t@computed get bonus(): IObservableArray<StockBonus> {\r\n\t\tif (this.loaded === false) return undefined;\r\n\t\treturn this._bonus;\r\n\t}\r\n\r\n\t@computed get divideInfo(): IObservableArray<StockDivideInfo> {\r\n\t\tif (this.loaded === false) return undefined;\r\n\t\treturn this._divideInfo;\r\n\t}\r\n\r\n\t@observable isMySelect: boolean = false;\r\n\r\n\tconstructor(cApp: any) {\r\n\t\tsuper(cApp);\r\n\t\tmakeObservable(this);\r\n\t}\r\n\tinitLoad = () => {\r\n\t\tthis.load();\r\n\t}\r\n\r\n\tprivate load = async () => {\r\n\t\tif (!this.baseItem) return;\r\n\r\n\t\tlet { id, day } = this.baseItem;\r\n\t\tlet rets = await Promise.all([\r\n\t\t\t//this.cApp.store.miApi.query('q_stockallinfo', [id, day]),\r\n\t\t\t//this.cApp.store.miApi.query('t_tagstock$query', [this.user.id, undefined, id]) //this.uqs.mi.TagStock.query({ user: nav.user.id, stock: id })\r\n\t\t\tthis.cApp.miNet.q_stockallinfo(id, day),\r\n\t\t\tthis.cApp.miNet.t_tagstock$query(undefined, id),\r\n\t\t]);\r\n\t\tthis.stockTags = rets[1];\r\n\t\tlet ret = rets[0];\r\n\t\tif (Array.isArray(ret[0])) {\r\n\t\t\tlet arr1 = ret[1];\r\n\t\t\tif (Array.isArray(arr1)) {\r\n\t\t\t\tthis.price = arr1[0];\r\n\t\t\t}\r\n\r\n\t\t\tif (this._capitalearning.length > 0) {\r\n\t\t\t\tthis._capitalearning.clear();\r\n\t\t\t}\r\n\r\n\t\t\tlet arr2 = ret[2];\r\n\t\t\tif (Array.isArray(arr2)) {\r\n\t\t\t\tthis._capitalearning.push(...arr2);\r\n\t\t\t}\r\n\r\n\t\tthis._bonus.clear();\r\n\t\tlet arr3 = ret[3];\r\n\t\tif (Array.isArray(arr3)) {\r\n\t\t\tthis._bonus.push(...arr3);\r\n\t\t}\r\n\r\n\t\tthis._divideInfo.clear();\r\n\t\tlet arr4 = ret[4];\r\n\t\tif (Array.isArray(arr4)) {\r\n\t\t\tthis._divideInfo.push(...arr4);\r\n\t\t}\r\n\r\n\t\tthis.exrightForEarning = ret[5];\r\n\t\tawait this.loadTTMEarning(ret[6]);\r\n\t\tthis.exrightInfo = ret[7];\r\n\r\n\t\tthis.historyDataOrg = ret[8];\r\n\t\tthis.loadHistoryData(false);\r\n\t\t}\r\n\r\n\t\tthis.isMySelect = this.cApp.store.isMySelect(id);\r\n\t\tthis.loaded = true;\r\n\t}\r\n\r\n\tprotected async loadTTMEarning(list: {seasonno:number, capital:number, earning:number, es:number, profit:number, pseason:number, shares:number}[]) {\r\n\t\tthis.seasonData.splice(0);\r\n\t\tlet seasonlist: {[index:number]:{season:number, c:number, e:number, esum:number, corg:number, eorg:number, esumorg:number}} = {};\r\n\t\tlet len = list.length;\r\n\t\tif (len <= 0) return;\r\n\t\tlet minNo = list[len - 1].seasonno;\r\n\t\tlet lastItem = list[0];\r\n\t\tlet lastShares = lastItem.shares;\r\n\t\tlet maxNo = lastItem.seasonno;\r\n\r\n\t\tlet {end} = GFunc.SeasonnoToBeginEnd(maxNo);\r\n\t\tfor (let item of list) {\r\n\t\t\tlet no = item.seasonno;\r\n\t\t\tlet sItem = {season:no, c: item.capital * item.shares / lastShares, e: item.pseason / lastShares, esum: item.profit / lastShares, \r\n\t\t\t\tcorg: item.capital, eorg: item.es, esumorg: item.earning}\r\n\t\t\t//this.ExrightEarning(end, no, sItem);\r\n\t\t\tseasonlist[no] = sItem;\r\n\t\t}\r\n\r\n\t\tlet i = 0;\r\n//\t\tlet esum = 0;\r\n\t\tfor (let seasonno = minNo; seasonno <= maxNo; ++seasonno, ++i) {\r\n\t\t\tlet si = seasonlist[seasonno];\r\n\t\t\tif (si === undefined) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\t// esum += si.e;\r\n\t\t\t// if (i < 3) {\r\n\t\t\t// \tsi.esum = undefined;\r\n\t\t\t// }\r\n\t\t\t// else {\r\n\t\t\t// \tsi.esum = esum;\r\n\t\t\t// \tlet pastitem = seasonlist[seasonno-3];\r\n\t\t\t// \tif (pastitem !== undefined) {\r\n\t\t\t// \t\tesum -= pastitem.e;\r\n\t\t\t// \t}\r\n\t\t\t// }\r\n\t\t\tthis.seasonData.splice(0,0, si);\r\n\t\t}\r\n\r\n\t\tlet noBegin = maxNo - 19;\r\n\t\tthis.predictData = undefined;\r\n\t\tthis.predictSeasonData.splice(0);\r\n\t\tthis.predictSeasonDataFull.splice(0);\r\n\t\tif (noBegin < minNo) return;\r\n\t\tnoBegin += 3;\r\n\t\tthis.ypredict = [];\r\n\t\tfor (let x = noBegin; x <= maxNo; x += 4) {\r\n\t\t\tlet item = seasonlist[x];\r\n\t\t\tif (item === undefined) break;\r\n\t\t\tthis.predictSeasonData.splice(0, 0, item);\r\n\t\t\tthis.ypredict.push(item.esum);\r\n\t\t}\r\n\r\n\t\tfor (let x = maxNo; x >= minNo; x -= 4) {\r\n\t\t\tlet item = seasonlist[x];\r\n\t\t\tif (item === undefined) break;\r\n\t\t\tthis.predictSeasonDataFull.push(item);\r\n\t\t}\r\n\r\n\t\tif (this.ypredict.length === 5) {\r\n\t\t\tlet er = new ErForEarning(this.ypredict);\r\n\t\t\tlet lr = new SlrForEarning(this.ypredict);\r\n\t\t\tthis.predictData = {e:this.ypredict[4], b: er.B, r2: er.r2, epre: er.predict(4), l: lr.slopeR, lr2: lr.r2, lpre: lr.predict(4)};\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.predictSeasonData.splice(0);\r\n\t\t}\r\n\t}\r\n\r\n\tprotected ExrightEarning(endDay:number, season:number, item:{c:number, e:number, esum:number}) {\r\n\t\tlet {end} = GFunc.SeasonnoToBeginEnd(season);\r\n\t\tfor (let i = 0; i < this.exrightForEarning.length; ++i) {\r\n\t\t\tlet exitem = this.exrightForEarning[i];\r\n\t\t\tlet day = exitem.day;\r\n\t\t\tif (day > endDay) break;\r\n\t\t\tif (day < end) continue;\r\n\t\t\tlet factor = exitem.factor;\r\n\t\t\titem.c = item.c * factor;\r\n\t\t\titem.e = item.e * factor;\r\n\t\t\titem.esum = item.esum * factor;\r\n\t\t}\r\n\t}\r\n\r\n\tloadHistoryData(showAll:boolean) {\r\n\t\tlet list = this.historyDataOrg;\r\n\t\tlet length = list.length;\r\n\t\tif (length <= 10) {\r\n\t\t\tthis.historyData = [];\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (!showAll) {\r\n\t\t\tlet day = this.baseItem.day;\r\n\t\t\tif (day !== undefined) {\r\n\t\t\t\tlet i = length - 1;\r\n\t\t\t\tfor (; i >= 0; --i) {\r\n\t\t\t\t\tlet item = list[i];\r\n\t\t\t\t\tif (item.day <= day) break;\r\n\t\t\t\t}\r\n\t\t\t\tlength = i + 1;\r\n\t\t\t}\r\n\t\t}\r\n\t\tlet endIndex = length - 1;\r\n\t\tlet lastItem = list[endIndex];\r\n\t\tlet lastdayno = lastItem.dayno;\r\n\t\tif (lastdayno === undefined) {\r\n\t\t\twhile (endIndex > 0) {\r\n\t\t\t\t--endIndex;\r\n\t\t\t\tlastItem = list[endIndex];\r\n\t\t\t\tlastdayno = lastItem.dayno;\r\n\t\t\t\tif (lastdayno !== undefined) break;\r\n\t\t\t}\r\n\t\t}\r\n\t\tlet lastDay = lastItem.day;\r\n\t\tlet not = lastdayno % 5;\r\n\t\tlet historyList: any[] = [];\r\n\t\tfor (let i = 0; i <= endIndex; ++i) {\r\n\t\t\tlet {day, price, dayno} = list[i];\r\n\t\t\tif ( dayno % 5 === not) {\r\n\t\t\t\thistoryList.push({day:day, price:this.RestorePrice(price, day, lastDay), ttm:this.CalculateHistoryPE(price, day)});\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.historyData = historyList;\r\n\t}\r\n\r\n\tRestorePrice(price:number, dayFrom:number, dayIndex:number) {\r\n\t\tlet bsum = 0;\r\n\t\tlet pricere = price;\r\n\t\tif (dayFrom < dayIndex) {\r\n\t\tfor (let i = 0; i < this.exrightInfo.length; ++i) {\r\n\t\t\tlet {day, bonus, factor, factore} = this.exrightInfo[i];\r\n\t\t\tif (day <= dayFrom)\r\n\t\t\tcontinue;\r\n\t\t\tif (day > dayIndex)\r\n\t\t\tbreak;\r\n\t\t\tpricere = pricere * factor;\r\n\t\t\tbsum = (bsum + bonus) * factore;\r\n\t\t}\r\n\t\tpricere = pricere - bsum;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tfor (let i = 0; i < this.exrightInfo.length; ++i) {\r\n\t\t\t\tlet {day, bonus, factor, factore} = this.exrightInfo[i];\r\n\t\t\t\tif (day <= dayIndex)\r\n\t\t\t\tcontinue;\r\n\t\t\t\tif (day > dayFrom)\r\n\t\t\t\tbreak;\r\n\t\t\t\tpricere = pricere / factor;\r\n\t\t\t\tbsum = bsum / factore + bonus;\r\n\t\t\t}\r\n\t\t\tpricere = pricere + bsum;\r\n\t\t}\r\n\t\treturn pricere;\r\n\t}\r\n\r\n\tCalculateHistoryPE(price:number, day:number) {\r\n\t\tlet season = GFunc.SeasonnoFromDay(day);\r\n\t\tlet len = this.seasonData.length;\r\n\t\tfor (let i = 0; i < len; ++i) {\r\n\t\t\tlet item = this.seasonData[i];\r\n\t\t\tif (item.season >= season) continue;\r\n\t\t\tif (item.esumorg === undefined) return undefined;\r\n\t\t\tlet {end} = GFunc.SeasonnoToBeginEnd(item.season);\r\n\t\t\tlet pricere = this.RestorePrice(price, day, end);\r\n\t\t\treturn pricere / item.esumorg;\r\n\t\t}\r\n\r\n\t\treturn undefined;\r\n\t}\r\n\r\n\tasync internalStart(param: any) {\r\n\t\tthis.baseItem = param as NStockInfo;\r\n\t\tlet {id} = this.baseItem;\r\n\t\tthis.isMySelect = this.cApp.store.isMySelect(id);\r\n\t\tthis.initLoad();\r\n\t\tthis.openVPage(VStockInfo);\r\n\t}\r\n\r\n\topenMetaView = () => {\r\n\t}\r\n\r\n\tonSelectTag = async () => {\r\n\t\t//await this.loadTags();\r\n\t\tthis.selectedTags = this.cApp.store.stockGroups.getSelected(this.stockTags);\r\n\t\t/*\r\n\t\tthis.cApp.store.stockGroups.filter(v => {\r\n\t\t\tlet i = this.stockTags.findIndex(st => st.tag === v.groupId);\r\n\t\t\treturn i >= 0;\r\n\t\t});\r\n\t\t*/\r\n\t\t//await this.loadTags();\r\n\t\tthis.openVPage(VTags);\r\n\t}\r\n\r\n\tonNewTag = () => {\r\n\t\tthis.openVPage(VNewTag);\r\n\t}\r\n\r\n\tonEditTag = (param: any) => {\r\n\t\tthis.openVPage(VEditTag, param);\r\n\t}\r\n\r\n\tonSaveNewTag = async (data: any) => {\r\n\t\tlet { name } = data;\r\n\t\t//let param = { id: undefined, name: name };\r\n\t\t//let ret = await this.cApp.store.miApi.call('t_tag$save', [this.user.id, undefined, name]);\r\n\t\tlet ret = await this.cApp.miNet.t_tag$save(name);\r\n\t\tlet { retId } = ret;\r\n\t\tif (retId < 0) {\r\n\t\t\talert(name + ' 已经被使用了');\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tthis.cApp.store.stockGroups.add(\r\n\t\t\tnew StockGroup(name, name, this.cApp.miNet)\r\n\t\t);\r\n\t\treturn true;\r\n\t}\r\n\r\n\tonSaveTag = async (data: any) => {\r\n\t\tlet { id, name } = data;\r\n\t\tlet {stockGroups} = this.cApp.store;\r\n\t\tlet param = { id: id, name: name };\r\n\t\tlet exists = stockGroups.exists(id, name);\r\n\t\tif (exists === true) {\r\n\t\t\talert(name + ' 已经被使用了');\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tlet ret = await this.cApp.miNet.t_tag$save(name);\r\n\t\tlet { retId } = ret;\r\n\t\tif (retId === undefined || retId < 0) {\r\n\t\t\talert(name + ' 已经被使用了');\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tlet group = stockGroups.groupFromId(id);\r\n\t\tif (group) {\r\n\t\t\tgroup.name = name;\r\n\t\t}\r\n\t\treturn true;\r\n\t}\r\n\r\n\tonClickSelectTag = async (tag: any, isSelected: boolean) => {\r\n\t\tlet param = {\r\n\t\t\tuser: nav.user.id,\r\n\t\t\ttag: tag.id,\r\n\t\t\tarr1: [\r\n\t\t\t\t{ stock: this.baseItem.id }\r\n\t\t\t]\r\n\t\t};\r\n\t\tif (isSelected === true) {\r\n\t\t\t//let ret = await this.cApp.store.miApi.call('t_tagstock$add', [this.user.id, tag.id, this.baseItem.id]); //.uqs.mi.TagStock.add(param);\r\n\t\t\tawait this.cApp.store.addTagStock(this.baseItem as any);\r\n\t\t\t//let ret = this.cApp.miNet.t_tagstock$add(tag.id, this.baseItem.id);\r\n\t\t\tlet newTag = {\r\n\t\t\t\ttag: {\r\n\t\t\t\t\tid: tag.id,\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.stockTags.push(newTag);\r\n\t\t}\r\n\t\telse {\r\n\t\t\t//let ret = await this.cApp.store.miApi.call('t_tagstock$del', [this.user.id, tag.id, this.baseItem.id]); // //await this.uqs.mi.TagStock.del(param);\r\n\t\t\t//let ret = this.cApp.miNet.t_tagstock$del(tag.id, this.baseItem.id);\r\n\t\t\tawait this.cApp.store.removeTagStock(this.baseItem as any);\r\n\t\t\tlet i = this.stockTags.findIndex(v => v.tag.id === tag.id);\r\n\t\t\tthis.stockTags.splice(i, 1);\r\n\t\t}\r\n\t}\r\n\r\n\tonClickDefaultTag = async (isSelected: boolean) => {\r\n\t\t//let tagid = this.cApp.store.defaultListTagID;\r\n\t\tlet {store} = this.cApp;\r\n\t\tlet {id: groupId} = store.stockGroups.defaultGroup;\r\n\t\tif (isSelected === true) {\r\n\t\t\t//let ret = this.cApp.miNet.t_tagstock$add(tagid, this.baseItem.id);\r\n\t\t\tawait store.addTagStock(this.baseItem as any);\r\n\t\t\tlet newTag = {\r\n\t\t\t\ttag: {\r\n\t\t\t\t\tid: store.stockGroups.defaultGroup.id,\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.stockTags.push(newTag);\r\n\t\t}\r\n\t\telse {\r\n\t\t\t//let ret = await this.cApp.store.miApi.call('t_tagstock$del', [this.user.id, tagid, this.baseItem.id]); // //await this.uqs.mi.TagStock.del(param);\r\n\t\t\tawait this.cApp.store.removeTagStock(this.baseItem as any);\r\n\t\t\t//let ret = this.cApp.miNet.t_tagstock$del(tagid, this.baseItem.id);\r\n\t\t\tlet i = this.stockTags.findIndex(v => v.tag.id === groupId);\r\n\t\t\tthis.stockTags.splice(i, 1);\r\n\t\t}\r\n\t}\r\n\r\n\tshowSelectStock = async (day:number): Promise<any> => {\r\n\t\tlet cStock = new CSelectStock(this.cApp);\r\n\t\tlet item = await cStock.call() as any;\r\n\t\tlet b = {...item}\r\n\t\tb.day = day;\r\n\t\tthis.baseItem = b;\r\n\t\tthis.loaded = false;\r\n\t\tawait this.load();\r\n\t}\r\n\r\n\tchangeDay = async (day:number) => {\r\n\t\tif (this.baseItem.day === day) return;\r\n\t\tlet {id, name, code, symbol} = this.baseItem;\r\n\t\tlet ni = {id:id, name:name, code:code, symbol:symbol, day:day ===0 ? undefined : day};\r\n\t\tthis.baseItem = ni;\r\n\t\tthis.loaded = false;\r\n\t\tawait this.load();\r\n\t}\r\n}\r\n","import { Res, UI } from \"tonva-react\";\r\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\nimport { FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-react\";\r\nimport { Account } from \"./BruceYuMi\";\r\n\r\n/*--fields--*/\r\nconst fields = {\r\n\tid: {\r\n\t\t\"name\": \"id\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": false,\r\n\t\t\"label\": \"Id\"\r\n\t} as FieldItemId,\r\n\tno: {\r\n\t\t\"name\": \"no\",\r\n\t\t\"type\": \"string\",\r\n\t\t\"isKey\": true,\r\n\t\t\"widget\": \"string\",\r\n\t\t\"label\": \"No\"\r\n\t} as FieldItemString,\r\n\tname: {\r\n\t\t\"name\": \"name\",\r\n\t\t\"type\": \"string\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"string\",\r\n\t\t\"label\": \"Name\"\r\n\t} as FieldItemString,\r\n};\r\n/*==fields==*/\r\n\r\nexport const fieldArr: FieldItem[] = [\r\n\tfields.no, fields.name, \r\n];\r\n\r\nexport const ui: UI = {\r\n\tlabel: \"Account\",\r\n\tfieldArr,\r\n\tfields,\r\n};\r\n\r\nexport const res: Res<any> = {\r\n\tzh: {\r\n\t},\r\n\ten: {\r\n\t}\r\n};\r\n\r\nexport function render(item: Account):JSX.Element {\r\n\treturn <>{JSON.stringify(item)}</>;\r\n};\r\n","import { Res, UI } from \"tonva-react\";\r\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\nimport { FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-react\";\r\nimport { Holding } from \"./BruceYuMi\";\r\n\r\n/*--fields--*/\r\nconst fields = {\r\n\tid: {\r\n\t\t\"name\": \"id\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": false,\r\n\t\t\"label\": \"Id\"\r\n\t} as FieldItemId,\r\n\taccount: {\r\n\t\t\"name\": \"account\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": true,\r\n\t\t\"label\": \"Account\"\r\n\t} as FieldItemId,\r\n\tstock: {\r\n\t\t\"name\": \"stock\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": true,\r\n\t\t\"label\": \"Stock\"\r\n\t} as FieldItemId,\r\n};\r\n/*==fields==*/\r\n\r\nexport const fieldArr: FieldItem[] = [\r\n\tfields.account, fields.stock, \r\n];\r\n\r\nexport const ui: UI = {\r\n\tlabel: \"Holding\",\r\n\tfieldArr,\r\n\tfields,\r\n};\r\n\r\nexport const res: Res<any> = {\r\n\tzh: {\r\n\t},\r\n\ten: {\r\n\t}\r\n};\r\n\r\nexport function render(item: Holding):JSX.Element {\r\n\treturn <>{JSON.stringify(item)}</>;\r\n};\r\n","import { Res, UI } from \"tonva-react\";\r\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\nimport { FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-react\";\r\nimport { Transaction } from \"./BruceYuMi\";\r\n\r\n/*--fields--*/\r\nconst fields = {\r\n\tid: {\r\n\t\t\"name\": \"id\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": false,\r\n\t\t\"label\": \"Id\"\r\n\t} as FieldItemId,\r\n\tholding: {\r\n\t\t\"name\": \"holding\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": true,\r\n\t\t\"label\": \"Holding\"\r\n\t} as FieldItemId,\r\n\ttick: {\r\n\t\t\"name\": \"tick\",\r\n\t\t\"isKey\": true,\r\n\t\t\"label\": \"Tick\"\r\n\t} as undefined,\r\n\tprice: {\r\n\t\t\"name\": \"price\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Price\"\r\n\t} as FieldItemInt,\r\n\tquantity: {\r\n\t\t\"name\": \"quantity\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Quantity\"\r\n\t} as FieldItemInt,\r\n\tamount: {\r\n\t\t\"name\": \"amount\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Amount\"\r\n\t} as FieldItemInt,\r\n};\r\n/*==fields==*/\r\n\r\nexport const fieldArr: FieldItem[] = [\r\n\tfields.holding, fields.tick, fields.price, fields.quantity, fields.amount, \r\n];\r\n\r\nexport const ui: UI = {\r\n\tlabel: \"Transaction\",\r\n\tfieldArr,\r\n\tfields,\r\n};\r\n\r\nexport const res: Res<any> = {\r\n\tzh: {\r\n\t},\r\n\ten: {\r\n\t}\r\n};\r\n\r\nexport function render(item: Transaction):JSX.Element {\r\n\treturn <>{JSON.stringify(item)}</>;\r\n};\r\n","import { Res, UI } from \"tonva-react\";\r\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\nimport { FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-react\";\r\nimport { Stock } from \"./BruceYuMi\";\r\n\r\n/*--fields--*/\r\nconst fields = {\r\n\tid: {\r\n\t\t\"name\": \"id\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": false,\r\n\t\t\"label\": \"Id\"\r\n\t} as FieldItemId,\r\n\tmarket: {\r\n\t\t\"name\": \"market\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": true,\r\n\t\t\"label\": \"Market\"\r\n\t} as FieldItemId,\r\n\tcode: {\r\n\t\t\"name\": \"code\",\r\n\t\t\"type\": \"string\",\r\n\t\t\"isKey\": true,\r\n\t\t\"widget\": \"string\",\r\n\t\t\"label\": \"Code\"\r\n\t} as FieldItemString,\r\n\tname: {\r\n\t\t\"name\": \"name\",\r\n\t\t\"type\": \"string\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"string\",\r\n\t\t\"label\": \"Name\"\r\n\t} as FieldItemString,\r\n};\r\n/*==fields==*/\r\n\r\nexport const fieldArr: FieldItem[] = [\r\n\tfields.market, fields.code, fields.name, \r\n];\r\n\r\nexport const ui: UI = {\r\n\tlabel: \"Stock\",\r\n\tfieldArr,\r\n\tfields,\r\n};\r\n\r\nexport const res: Res<any> = {\r\n\tzh: {\r\n\t},\r\n\ten: {\r\n\t}\r\n};\r\n\r\nexport function render(item: Stock):JSX.Element {\r\n\treturn <>{JSON.stringify(item)}</>;\r\n};\r\n","import { Res, UI } from \"tonva-react\";\r\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\nimport { FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-react\";\r\nimport { Market } from \"./BruceYuMi\";\r\n\r\n/*--fields--*/\r\nconst fields = {\r\n\tid: {\r\n\t\t\"name\": \"id\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": false,\r\n\t\t\"label\": \"Id\"\r\n\t} as FieldItemId,\r\n\tname: {\r\n\t\t\"name\": \"name\",\r\n\t\t\"type\": \"string\",\r\n\t\t\"isKey\": true,\r\n\t\t\"widget\": \"string\",\r\n\t\t\"label\": \"Name\"\r\n\t} as FieldItemString,\r\n\tcurrency: {\r\n\t\t\"name\": \"currency\",\r\n\t\t\"type\": \"string\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"string\",\r\n\t\t\"label\": \"Currency\"\r\n\t} as FieldItemString,\r\n};\r\n/*==fields==*/\r\n\r\nexport const fieldArr: FieldItem[] = [\r\n\tfields.name, fields.currency, \r\n];\r\n\r\nexport const ui: UI = {\r\n\tlabel: \"Market\",\r\n\tfieldArr,\r\n\tfields,\r\n};\r\n\r\nexport const res: Res<any> = {\r\n\tzh: {\r\n\t},\r\n\ten: {\r\n\t}\r\n};\r\n\r\nexport function render(item: Market):JSX.Element {\r\n\treturn <>{JSON.stringify(item)}</>;\r\n};\r\n","import { Res, UI } from \"tonva-react\";\r\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\nimport { FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-react\";\r\nimport { Portfolio } from \"./BruceYuMi\";\r\n\r\n/*--fields--*/\r\nconst fields = {\r\n\tid: {\r\n\t\t\"name\": \"id\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": false,\r\n\t\t\"label\": \"Id\"\r\n\t} as FieldItemId,\r\n\tquantity: {\r\n\t\t\"name\": \"quantity\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Quantity\"\r\n\t} as FieldItemInt,\r\n};\r\n/*==fields==*/\r\n\r\nexport const fieldArr: FieldItem[] = [\r\n\tfields.quantity, \r\n];\r\n\r\nexport const ui: UI = {\r\n\tlabel: \"Portfolio\",\r\n\tfieldArr,\r\n\tfields,\r\n};\r\n\r\nexport const res: Res<any> = {\r\n\tzh: {\r\n\t},\r\n\ten: {\r\n\t}\r\n};\r\n\r\nexport function render(item: Portfolio):JSX.Element {\r\n\treturn <>{JSON.stringify(item)}</>;\r\n};\r\n","import { Res, UI } from \"tonva-react\";\r\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\nimport { FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-react\";\r\nimport { StockValue } from \"./BruceYuMi\";\r\n\r\n/*--fields--*/\r\nconst fields = {\r\n\tid: {\r\n\t\t\"name\": \"id\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": false,\r\n\t\t\"label\": \"Id\"\r\n\t} as FieldItemId,\r\n\tmiRate: {\r\n\t\t\"name\": \"miRate\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"MiRate\"\r\n\t} as FieldItemInt,\r\n\tttm: {\r\n\t\t\"name\": \"ttm\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Ttm\"\r\n\t} as FieldItemInt,\r\n\tdivident: {\r\n\t\t\"name\": \"divident\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Divident\"\r\n\t} as FieldItemInt,\r\n\tprice: {\r\n\t\t\"name\": \"price\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Price\"\r\n\t} as FieldItemInt,\r\n\troe: {\r\n\t\t\"name\": \"roe\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Roe\"\r\n\t} as FieldItemInt,\r\n\tinc1: {\r\n\t\t\"name\": \"inc1\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Inc1\"\r\n\t} as FieldItemInt,\r\n\tinc2: {\r\n\t\t\"name\": \"inc2\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Inc2\"\r\n\t} as FieldItemInt,\r\n\tinc3: {\r\n\t\t\"name\": \"inc3\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Inc3\"\r\n\t} as FieldItemInt,\r\n\tinc4: {\r\n\t\t\"name\": \"inc4\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Inc4\"\r\n\t} as FieldItemInt,\r\n\tpreInc: {\r\n\t\t\"name\": \"preInc\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"PreInc\"\r\n\t} as FieldItemInt,\r\n\tmarketValue: {\r\n\t\t\"name\": \"marketValue\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"MarketValue\"\r\n\t} as FieldItemInt,\r\n};\r\n/*==fields==*/\r\n\r\nexport const fieldArr: FieldItem[] = [\r\n\tfields.miRate, fields.ttm, fields.divident, fields.price, fields.roe, fields.inc1, fields.inc2, fields.inc3, fields.inc4, fields.preInc, fields.marketValue, \r\n];\r\n\r\nexport const ui: UI = {\r\n\tlabel: \"StockValue\",\r\n\tfieldArr,\r\n\tfields,\r\n};\r\n\r\nexport const res: Res<any> = {\r\n\tzh: {\r\n\t},\r\n\ten: {\r\n\t}\r\n};\r\n\r\nexport function render(item: StockValue):JSX.Element {\r\n\treturn <>{JSON.stringify(item)}</>;\r\n};\r\n","import { Res, UI } from \"tonva-react\";\r\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\nimport { FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-react\";\r\nimport { AccountValue } from \"./BruceYuMi\";\r\n\r\n/*--fields--*/\r\nconst fields = {\r\n\tid: {\r\n\t\t\"name\": \"id\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": false,\r\n\t\t\"label\": \"Id\"\r\n\t} as FieldItemId,\r\n\tmi: {\r\n\t\t\"name\": \"mi\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Mi\"\r\n\t} as FieldItemInt,\r\n\tmarket: {\r\n\t\t\"name\": \"market\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Market\"\r\n\t} as FieldItemInt,\r\n\tcount: {\r\n\t\t\"name\": \"count\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Count\"\r\n\t} as FieldItemInt,\r\n};\r\n/*==fields==*/\r\n\r\nexport const fieldArr: FieldItem[] = [\r\n\tfields.mi, fields.market, fields.count, \r\n];\r\n\r\nexport const ui: UI = {\r\n\tlabel: \"AccountValue\",\r\n\tfieldArr,\r\n\tfields,\r\n};\r\n\r\nexport const res: Res<any> = {\r\n\tzh: {\r\n\t},\r\n\ten: {\r\n\t}\r\n};\r\n\r\nexport function render(item: AccountValue):JSX.Element {\r\n\treturn <>{JSON.stringify(item)}</>;\r\n};\r\n","import { Res, UI } from \"tonva-react\";\r\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\nimport { FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-react\";\r\nimport { UserAccount } from \"./BruceYuMi\";\r\n\r\n/*--fields--*/\r\nconst fields = {\r\n\tid: {\r\n\t\t\"name\": \"id\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": false,\r\n\t\t\"label\": \"Id\"\r\n\t} as FieldItemId,\r\n\tid2: {\r\n\t\t\"name\": \"id2\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": false,\r\n\t\t\"label\": \"Id2\"\r\n\t} as FieldItemId,\r\n};\r\n/*==fields==*/\r\n\r\nexport const fieldArr: FieldItem[] = [\r\n\t\r\n];\r\n\r\nexport const ui: UI = {\r\n\tlabel: \"UserAccount\",\r\n\tfieldArr,\r\n\tfields,\r\n};\r\n\r\nexport const res: Res<any> = {\r\n\tzh: {\r\n\t},\r\n\ten: {\r\n\t}\r\n};\r\n\r\nexport function render(item: UserAccount):JSX.Element {\r\n\treturn <>{JSON.stringify(item)}</>;\r\n};\r\n","export const consts = {\r\n    uqBasedata: \"bruce/mi\",\r\n    appIcon: 'https://tv.jkchemical.com/imgs/Bear-icon.png',\r\n    miApiHost: 'https://mi.jjol.cn/',\r\n    miApiHostDebug: 'http://localhost:6010/',\r\n    isDevelopment: process.env.NODE_ENV === 'development',\r\n}\r\n\r\nexport const defaultGroupName = '自选股';\r\nexport const defaultBlackListGroupName = '黑名单';\r\n\r\n","export class SlrForEarning {\r\n  slope: number;\r\n  intercept: number;\r\n  y: number[];\r\n  slopeR: number;\r\n  endY: number;\r\n  r2: number;\r\n\r\n  constructor(y:number[]) {\r\n    this.y = y;\r\n    this.regress();\r\n    let score = this.score();\r\n    this.r2 = score.r2;\r\n  }\r\n\r\n  regress() {\r\n    const n = this.y.length;\r\n    let xSum = 0;\r\n    let ySum = 0;\r\n  \r\n    let xSquared = 0;\r\n    let xY = 0;\r\n  \r\n    for (let x = 0; x < n; ++x) {\r\n      xSum += x;\r\n      ySum += this.y[x];\r\n      xSquared += x * x;\r\n      xY += x * this.y[x];\r\n    }\r\n  \r\n    const numerator = n * xY - xSum * ySum;\r\n    this.slope = numerator / (n * xSquared - xSum * xSum);\r\n    this.intercept = (1 / n) * ySum - this.slope * (1 / n) * xSum;\r\n\r\n    let ym = this.slope > 0 ? this.predict(n-2) : this.predict(1);\r\n    this.slopeR = ym < 0.01 ? undefined : this.slope / ym;\r\n  }\r\n\r\n  score() {\r\n    const n = this.y.length;\r\n    const y2 = new Array(n);\r\n    for (let i = 0; i < n; i++) {\r\n      y2[i] = this.predict(i);\r\n    }\r\n\r\n    let xSum = 0;\r\n    let ySum = 0;\r\n    let chi2 = 0;\r\n    let rmsd = 0;\r\n    let xSquared = 0;\r\n    let ySquared = 0;\r\n    let xY = 0;\r\n    for (let i = 0; i < n; i++) {\r\n      let yi2 = y2[i];\r\n      xSum += yi2;\r\n      let yi = this.y[i];\r\n      ySum += yi;\r\n      xSquared += yi2 * yi2;\r\n      ySquared += yi * yi;\r\n      xY += yi2 * yi;\r\n      let yiyi2 = yi - yi2;\r\n      if (yi !== 0) {\r\n        chi2 += (yiyi2 * yiyi2) / yi;\r\n      }\r\n      rmsd += yiyi2 * yiyi2;\r\n    }\r\n\r\n    const r =\r\n      (n * xY - xSum * ySum) /\r\n      Math.sqrt((n * xSquared - xSum * xSum) * (n * ySquared - ySum * ySum));\r\n\r\n    return {\r\n      r: r,\r\n      r2: r * r,\r\n      chi2: chi2,\r\n      rmsd: Math.sqrt(rmsd / n)\r\n    };\r\n  }\r\n\r\n\r\n  predict(x:number) {\r\n    return this.slope * x + this.intercept;\r\n  }\r\n\r\n  computeX(y:number) {\r\n    return (y - this.intercept) / this.slope;\r\n  }\r\n}\r\n","export class ErForEarning {\r\n  A:number;\r\n  B:number;\r\n  y: number[];\r\n  r2: number;\r\n\r\n  constructor(y:number[]) {\r\n    this.y = y;\r\n    this.regress();\r\n    let score = this.score();\r\n    this.r2 = score.r2;\r\n  }\r\n\r\n  regress() {\r\n    const n = this.y.length;\r\n    let xSum = 0;\r\n    let ySum = 0;\r\n  \r\n    let xSquared = 0;\r\n    let xY = 0;\r\n  \r\n    for (let x = 0; x < n; ++x) {\r\n      xSum += x;\r\n      let yx = Math.log(this.y[x]);\r\n      ySum += yx;\r\n      xSquared += x * x;\r\n      xY += x * yx;\r\n    }\r\n  \r\n    const numerator = n * xY - xSum * ySum;\r\n    let slope = numerator / (n * xSquared - xSum * xSum);\r\n    let intercept = (1 / n) * ySum - slope * (1 / n) * xSum;\r\n    this.A = Math.exp(intercept);\r\n    this.B = slope;\r\n  }\r\n\r\n  score() {\r\n    const n = this.y.length;\r\n    const y2 = new Array(n);\r\n    for (let i = 0; i < n; i++) {\r\n      y2[i] = this.predict(i);\r\n    }\r\n\r\n    let xSum = 0;\r\n    let ySum = 0;\r\n    let chi2 = 0;\r\n    let rmsd = 0;\r\n    let xSquared = 0;\r\n    let ySquared = 0;\r\n    let xY = 0;\r\n    for (let i = 0; i < n; i++) {\r\n      let yi2 = y2[i];\r\n      xSum += yi2;\r\n      let yi = this.y[i];\r\n      ySum += yi;\r\n      xSquared += yi2 * yi2;\r\n      ySquared += yi * yi;\r\n      xY += yi2 * yi;\r\n      let yiyi2 = yi - yi2;\r\n      if (yi !== 0) {\r\n        chi2 += (yiyi2 * yiyi2) / yi;\r\n      }\r\n      rmsd += yiyi2 * yiyi2;\r\n    }\r\n\r\n    const r =\r\n      (n * xY - xSum * ySum) /\r\n      Math.sqrt((n * xSquared - xSum * xSum) * (n * ySquared - ySum * ySum));\r\n\r\n    return {\r\n      r: r,\r\n      r2: r * r,\r\n      chi2: chi2,\r\n      rmsd: Math.sqrt(rmsd / n)\r\n    };\r\n  }\r\n\r\n  predict(x:number) {\r\n    return this.A * Math.exp(x * this.B);\r\n  }\r\n}\r\n","import React from 'react';\r\nimport { NavView, start } from 'tonva-react';\r\n//import logo from './logo.svg';\r\nimport './App.css';\r\nimport { CApp } from './UqApp';\r\nimport { appConfig } from './appConfig';\r\n/*\r\nfunction App() {\r\n  return (\r\n    <div className=\"App\">\r\n      <header className=\"App-header\">\r\n        <img src={logo} className=\"App-logo\" alt=\"logo\" />\r\n        <p>\r\n          Edit <code>src/App.tsx</code> and save to reload.\r\n        </p>\r\n        <a\r\n          className=\"App-link\"\r\n          href=\"https://reactjs.org\"\r\n          target=\"_blank\"\r\n          rel=\"noopener noreferrer\"\r\n        >\r\n          Learn React\r\n        </a>\r\n      </header>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;\r\n*/\r\nclass App extends React.Component {\r\n  \r\n\tprivate onLogined = async () => {\r\n\t  await start(CApp, appConfig);\r\n\t}\r\n\tpublic render() {\r\n\t  return <NavView onLogined={this.onLogined} />\r\n\t}\r\n}\r\n\r\nexport default App;\r\n  ","import { ReportHandler } from 'web-vitals';\r\n\r\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\r\n  if (onPerfEntry && onPerfEntry instanceof Function) {\r\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\r\n      getCLS(onPerfEntry);\r\n      getFID(onPerfEntry);\r\n      getFCP(onPerfEntry);\r\n      getLCP(onPerfEntry);\r\n      getTTFB(onPerfEntry);\r\n    });\r\n  }\r\n};\r\n\r\nexport default reportWebVitals;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport 'bootstrap/dist/css/bootstrap.css';\r\nimport './index.css';\r\nimport App from './App';\r\nimport reportWebVitals from './reportWebVitals';\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport { FA, LMR } from 'tonva-react';\r\nimport { NStockInfo } from '../stockinfo';\r\nimport {percent0, percent1, number, numberToMarketValue, calculateZZ3} from '../tool';\r\n\r\nfunction renderSortCol(radioName:string, sortMethod:string, caption:string, \r\n\tsort: (sortMethod:string) => void, defaultSort:string) {\r\n\treturn <label className=\"btn btn-outline-info mb-0\">\r\n\t\t<input type=\"radio\" className=\"btn-sm btn-check mr-1\"\r\n\t\t\tname={radioName} defaultChecked={sortMethod === defaultSort}\r\n\t\t\tonClick={() => sort(sortMethod)} />\r\n\t\t{caption}\r\n\t</label>\r\n}\r\n\r\nexport function renderSortHeaders(radioName:string, defaultSort:string, sort: (sortMethod:string) => void) {\r\n\tif (!defaultSort) defaultSort = 'tagv';\r\n\treturn <div className=\"btn-group\" role=\"group\" aria-label=\"Basic radio toggle button group\">\r\n\t\t{renderSortCol(radioName, 'tagv', '米息分', sort, defaultSort)}\r\n\t\t{renderSortCol(radioName, 'tagpe', 'TTM', sort, defaultSort)}\r\n\t\t{renderSortCol(radioName, 'tagdp', '股息率', sort, defaultSort)}\r\n\t</div>;\r\n}\r\n\r\nfunction renderValue(caption:string, value:number, valueType:'p0'|'p1'|'n1'|'n2'|'yi'):JSX.Element {\r\n\tconst _cn = 'px-2 mb-1 text-right '; \r\n\tlet cn = _cn + 'c5';\r\n\tlet cnYI = _cn + 'c5'\r\n\tlet vStr:string;\r\n\tif (isNaN(value) === true) {\r\n\t\tvStr = '-'\r\n\t}\r\n\telse {\r\n\t\tswitch (valueType) {\r\n\t\t\tcase 'p0': vStr = percent0(value); break;\r\n\t\t\tcase 'p1': vStr = percent1(value); break;\r\n\t\t\tcase 'n1': vStr = number(value, 1); break;\r\n\t\t\tcase 'n2': vStr = number(value, 2); break;\r\n\t\t\tcase 'yi': \r\n\t\t\t\tvStr = numberToMarketValue(value);\r\n\t\t\t\tcn = cnYI;\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\treturn <div key={caption} className={cn}>\r\n\t\t<span className=\"text-muted small\">{caption}</span><br />\r\n\t\t{vStr}\r\n\t</div>;\r\n}\r\n\r\nexport function renderStockInfoRow(row: NStockInfo, onClickName: (row:NStockInfo) => void, inputSelect:JSX.Element, right:JSX.Element):JSX.Element {\r\n  \tlet { id, name, code, pe, roe, price, divyield, v, order, symbol, l, e, ep, e3, total } = row;\r\n  \tlet zzl = calculateZZ3((row as any).dataArr);\r\n  \tlet left = <div className=\"cursor-pointer\" onClick={()=>onClickName(row)}>\r\n\t\t<span className=\"text-primary\">{name}</span>\r\n\t\t&nbsp; \r\n\t\t<span className=\"text-info\">{code}</span>\r\n\t  \t&nbsp;\r\n\t\t<small className=\"small ml-1\"><span className=\"text-danger\">{order}</span></small>\r\n  \t</div>;\r\n\tlet rows:[string,number,'p0'|'p1'|'n1'|'n2'|'yi'][] = [\r\n\t\t['米息分', Math.log2(v), 'n1'],\r\n\t\t['TTM', pe, 'n1'],\r\n\t\t['股息率', divyield*100, 'n1'],\r\n\t\t['价格', price, 'n2'],\r\n\t\t['ROE', roe*100, 'n1'],\r\n\t\t['预增', l, 'p0'],\r\n\t\t['现增', zzl[3], 'p0'],\r\n\t\t['增 1', zzl[2], 'p0'],\r\n\t\t['增 2', zzl[1], 'p0'],\r\n\t\t['增 3', zzl[0], 'p0'],\r\n\t\t['市值', total*price, 'yi'],\r\n  \t];\r\n\tlet inputSelectSpan:any;\r\n\tif (inputSelect) {\r\n\t\tinputSelectSpan = <span className=\"ml-4\">{inputSelect}</span>\r\n\t}\r\n  \treturn <div className=\"d-block border-top\">\r\n\t\t<LMR className=\"px-2 py-1 bg-light\" left={left} right = {right}>{inputSelectSpan}</LMR>\r\n\t\t<div className=\"d-flex flex-wrap p-1\" >\r\n\t\t\t{rows.map(v => renderValue(v[0], v[1], v[2]))}\r\n\t  \t</div>\r\n  \t</div>;\r\n}\r\n\r\nexport function renderStockUrl(row: NStockInfo) {\r\n    let { symbol } = row;\r\n\treturn <a className=\"text-info\" href={`https://finance.sina.com.cn/realstock/company/${symbol}/nc.shtml`} target=\"_blank\" rel=\"noopener noreferrer\" onClick={(e)=>{e.stopPropagation();}}>\r\n\t\t<FA name=\"angle-double-right\" />\r\n\t</a>;\r\n}","export function numberToFixString(n: number, w = 2) {\r\n    return n === undefined ? '' : n.toFixed(w);\r\n}\r\n\r\nexport function number(n: number, w=2) {\r\n\treturn n === undefined ? '' : n.toFixed(w);\r\n}\r\n\r\nexport function numberToMarketValue(n: number) {\r\n\treturn n === undefined || isNaN(n) ? '' : Math.round(n/10000).toString(); // + '亿';\r\n}\r\n\r\nexport function numberToString(n: number, precision = 2) {\r\n\treturn n === undefined ? '' : n.toPrecision(precision);\r\n}\r\n\r\nexport function numberToPrecision(n: number, precision = 4) {\r\n\treturn n === undefined ? undefined : Number.parseFloat(n.toPrecision(precision));\r\n}\r\n\r\nexport function percentToFixString(n: number) {\r\n\treturn n === undefined || isNaN(n) ? '' : (n * 100).toFixed(2) + '%';\r\n}\r\n\r\nexport function percent0(n: number) {\r\n\treturn n === undefined || isNaN(n) ? '' : (n * 100).toFixed(0) + '%';\r\n}\r\nexport function percent1(n: number) {\r\n\treturn n === undefined || isNaN(n) ? '' : (n * 100).toFixed(1) + '%';\r\n}\r\n\r\nexport function warningTypeString(t: string) {\r\n\tswitch (t) {\r\n\t\tcase 'gt': return '大于';\r\n\t\tcase 'lt': return '小于';\r\n\t\tdefault: return t;\r\n\t}\r\n}\r\n\r\nexport function predictCutRatio(r2:number) {\r\n\treturn r2 * 2 - r2 * r2;\r\n}\r\n\r\nexport function evaluatePricePrice(iRate:number, e1:number, e2:number, e3:number) {\r\n\tlet r = 1 + iRate;\r\n\tlet r2 = r * r;\r\n\tlet r3 = r2 * r;\r\n\treturn (e1/r + e2 /r2 + e3 / r3 + e3 / iRate / r3) / 2;\r\n}\r\n\r\nexport function calculateV(z:number, divyield:number, pe:number) {\r\n\tif (pe === undefined || isNaN(pe)) {\r\n\t\treturn undefined;\r\n\t}\r\n\r\n\tlet r = 0;\r\n\tif (z !== undefined) {\r\n\t\tif (z > 0.25) {\r\n\t\tz = 0.25;\r\n\t\t}\r\n\t\tr += z * 100;\r\n\t}\r\n\tif (divyield !== undefined) {\r\n\t\tr += divyield * 100;\r\n\t}\r\n\treturn r / pe;\r\n}\r\n\r\nexport function calculateVN(z:number, e:number, bonus:number, price:number) {\r\n\tif (price === undefined || isNaN(price) || e === undefined || isNaN(e)) {\r\n\t\treturn undefined;\r\n\t}\r\n\r\n\tlet r = 0;\r\n\tif (z !== undefined && e > 0) {\r\n\t\tif (z > 0.25) {\r\n\t\tz = 0.24 + Math.pow((z-0.24)*100, 0.6667) / 100;\r\n\t\t}\r\n\t\tz = 1 + z;\r\n\t\tz = z * z * z - 1;\r\n\t\tr += z * e * 100;\r\n\t}\r\n\tif (bonus !== undefined && !isNaN(bonus)) {\r\n\t\tr += bonus * 100;\r\n\t}\r\n\treturn r / price;\r\n}\r\n\r\nexport function calculateZZ3(data:number[]) {\r\n\tlet ret:number[] = [undefined, undefined, undefined, undefined] ;\r\n\tif (data === undefined)\r\n\t\treturn ret;\r\n\tlet len = data.length;\r\n\tif (len < 5)\r\n\t\treturn ret;\r\n\r\n\tlet funcz = (n:number, p:number) => {\r\n\t\tif (p <= 0 || n <= 0)\r\n\t\treturn undefined;\r\n\t\treturn ((n / p) - 1);\r\n\t}\r\n\tfor (let i = 0; i < 4; ++i) {\r\n\t\tret[i] = funcz(data[i+1], data[i]);\r\n\t}\r\n\treturn ret;\r\n}\r\n\r\n//export function caption = (value:string) => <span className=\"text-muted small\">{value}</span>;\r\n\r\nexport function MonthnoFromDay(day:number) {\r\n\tlet year = Math.floor(day/10000);\r\n\tlet month = Math.floor((day%10000)/100) - 1;\r\n\treturn (year-1995)*12+month;\r\n}\r\n\r\nexport function SeasonnoFromDay(day:number) {\r\n\tlet year = Math.floor(day/10000);\r\n\tlet month = Math.floor((day%10000)/100) - 1;\r\n\tlet season = Math.floor(month / 3);\r\n\treturn (year-1995)*4 + season;\r\n}\r\n\r\nexport function SeasonnoFromYearMonth(year:number, month:number) {\r\n\tlet season = Math.floor((month-1) / 3);\r\n\treturn (year-1995)*4 + season;\r\n}\r\n\r\nexport function SeasonnoToYearMonth(no: number) {\r\n\tlet year = Math.floor(no / 4) + 1995;\r\n\tlet month = (Math.floor(no % 4) + 1) * 3;\r\n\treturn year * 100 + month;\r\n}\r\n\r\nexport function SeasonnoToBeginEnd(season:number) {\r\n\tlet year = (1995 + Math.floor(season / 4)) * 10000;\r\n\tlet s = season % 4;\r\n\tif (s === 0) {\r\n\t\treturn {begin: year + 101, end: year + 331};\r\n\t} \r\n\tif (s === 1) {\r\n\t\treturn {begin: year + 401, end: year + 630};\r\n\t}\r\n\tif (s === 2) {\r\n\t\treturn {begin: year + 701, end: year + 930};\r\n\t}\r\n\treturn {begin: year + 1001, end: year + 1231};\r\n}\r\n\r\nexport function CalculatePredictAvg(arr: {predictpe:number}[]) {\r\n\tlet ret : {avg20:number, avg50:number, avg100:number} = {avg20:undefined, avg50:undefined, avg100:undefined};\r\n\r\n\tlet length = arr.length;\r\n\tlet calcuOne = (count:number) : number => {\r\n\t\tlet endIndex = count;\r\n\t\tif (endIndex > length)\r\n\t\tendIndex = length;\r\n\t\tif (endIndex >= 10) {\r\n\t\tlet sum = 0;\r\n\t\tfor (let i = 3; i < endIndex; ++i) {\r\n\t\t\tsum += arr[i].predictpe\r\n\t\t}\r\n\t\treturn sum / (endIndex - 3);\r\n\t\t}\r\n\t\telse {\r\n\t\treturn undefined;\r\n\t\t}\r\n\t}\r\n\r\n\tret.avg20 = calcuOne(20);\r\n\tret.avg50 = calcuOne(50);\r\n\tret.avg100 = calcuOne(100);\r\n\treturn ret;\r\n}\r\n\r\nexport function CalculateValueAvg(arr: {v:number}[]) {\r\n\tlet ret : {avg20:number, avg50:number, avg100:number, avg:number} = {avg20:undefined, avg50:undefined, avg100:undefined, avg:undefined};\r\n\r\n\tlet length = arr.length;\r\n\tlet calcuOne = (count:number) : number => {\r\n\t\tlet endIndex = count;\r\n\t\tif (count === 0 || endIndex > length)\r\n\t\tendIndex = length;\r\n\t\tif (endIndex >= 10) {\r\n\t\tlet sum = 0;\r\n\t\tfor (let i = 3; i < endIndex; ++i) {\r\n\t\t\tsum += arr[i].v;\r\n\t\t}\r\n\t\treturn sum / (endIndex - 3);\r\n\t\t}\r\n\t\telse {\r\n\t\treturn undefined;\r\n\t\t}\r\n\t}\r\n\r\n\tret.avg20 = calcuOne(20);\r\n\tret.avg50 = calcuOne(50);\r\n\tret.avg100 = calcuOne(100);\r\n\tret.avg = calcuOne(0);\r\n\treturn ret;\r\n}\r\n","export * from './types';\r\nexport * from './store';\r\nexport * from './sortStocks';\r\nexport * from './stockGroup';\r\nexport * from './stockGroups';\r\n","function getsortFunc(sortType:string) {\r\n\tswitch (sortType) {\r\n\t\tcase 'tagpe':\r\n\t\t\treturn (a, b) => a.pe - b.pe;\r\n\t\tcase 'tagdp': \r\n\t\t\treturn (a, b) => b.divyield - a.divyield;\r\n\t\tdefault:\r\n\t\t\treturn (a, b) => b.v - a.v;\r\n\t}\r\n}\r\n\r\nexport function sortStocks(sortType:string, arr:any[]) {\r\n\tarr.sort(getsortFunc(sortType));\r\n\tlet o = 1;\r\n\tfor (let item of arr) {\r\n\t\titem.order = o;\r\n\t\t++o;\r\n\t}\r\n}\r\n","//=== UqApp builder created on Tue Jan 12 2021 23:14:51 GMT-0500 (GMT-05:00) ===//\r\nimport { AppConfig, DevConfig } from \"tonva-react\";\r\n\r\nconst bruce: DevConfig = {\r\n\tname: 'bruce',\r\n\talias: undefined,\r\n}\r\n\r\nexport const appConfig: AppConfig = {\r\n\tversion: '0.1.0',\t\t// 界面端app的版本\r\n\tapp: undefined,\r\n\tuqs: [\r\n\t\t{\r\n\t\t\tdev: bruce,\r\n\t\t\tname: 'yumi',\r\n\t\t\talias: 'YuMi',\r\n\t\t\tversion: '0.1.0',\r\n\t\t},\r\n\t],\r\n\tnoUnit: true,\r\n    tvs: {},\r\n\toem: undefined,\r\n\thtmlTitle: '鱼米乡 - 私享投资圈',\r\n};\r\n","//=== UqApp builder created on Mon Mar 01 2021 23:10:09 GMT-0500 (GMT-05:00) ===//\r\nimport { CSub, CBase, CAppBase, IConstructor } from 'tonva-react';\r\nimport { UQs } from './uqs';\r\nimport { CApp } from './CApp';\r\n\r\nexport abstract class CUqBase extends CBase<CApp, UQs> {\r\n}\r\n\r\nexport abstract class CUqSub<A extends CAppBase<U>, U, T extends CBase<A,U>> extends CSub<A, U, T> {\r\n}\r\n\r\nexport abstract class CUqApp extends CAppBase<UQs> {\r\n\tprotected newC<T extends CUqBase>(type: IConstructor<T>): T {\r\n\t\tlet c = new type(this);\r\n\t\tc.init();\r\n\t\treturn c;\r\n\t}\r\n}\r\n","export default __webpack_public_path__ + \"static/media/logo.2d27ead7.svg\";","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport * as React from 'react';\r\nimport { View, nav } from 'tonva-react';\r\nimport { LMR, FA, SearchBox } from 'tonva-react';\r\nimport logo from '../images/logo.svg';\r\nimport { CHome } from './CHome';\r\n\r\nexport class VSiteHeader extends View<CHome> {\r\n    render() {\r\n        let currentSalesRegion = <FA name=\"globe\" />\r\n        let login = <div>\r\n            登录\r\n        </div>\r\n        let left = <img className=\"m-1\" src={logo} alt=\"logo\" style={{height: \"3rem\", width: \"3rem\"}} />;\r\n        //let cart = this.controller.cApp.cCart.renderCartLabel();\r\n        let right = undefined;\r\n        /*\r\n        <div className=\"d-flex flex-row mr-1 align-items-center\">\r\n            {currentSalesRegion} &nbsp;\r\n            <button onClick={()=>nav.start()}>Try</button>\r\n        </div>;*/\r\n        return <LMR\r\n            className=\"mb-3 align-items-center bg-white\"\r\n            left={left} right={right}>\r\n            <div className=\"\">\r\n                {this.controller.renderSearchHeader('md')}\r\n            </div>\r\n        </LMR>\r\n    }\r\n}","import * as React from 'react';\r\nimport { View } from 'tonva-react';\r\nimport { CHome } from './CHome';\r\nimport { SearchBox } from 'tonva-react';\r\n\r\nexport class VSearchHeader extends View<CHome> {\r\n\r\n    private onSearch = async (key: string) => {\r\n        // let { cProduct } = this.controller.cApp;\r\n        // cProduct.start(key);\r\n    }\r\n\r\n    render(param: any) {\r\n        return <SearchBox className=\"px-1 w-100\" \r\n            size={param}\r\n            onSearch={this.onSearch} \r\n            placeholder=\"功能...\" />\r\n    }\r\n}","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport * as React from 'react';\r\nimport { observer } from 'mobx-react';\r\nimport { VPage, List, LMR, FA, Scroller, DropdownActions, DropdownAction } from 'tonva-react';\r\nimport { NStockInfo } from '../stockinfo';\r\nimport { CHome } from './CHome';\r\nimport { renderSortHeaders, renderStockInfoRow, renderStockUrl } from '../tool';\r\n\r\nexport class VHome extends VPage<CHome> {\r\n\theader() {\r\n\t\treturn React.createElement(observer(() => {\r\n\t\t\treturn <span className=\"ml-3\">首页 - {this.controller.stockGroup.name}</span>;\r\n\t\t}));\r\n\t}\r\n\tright() {\r\n\t\treturn React.createElement(observer(() => {\r\n\t\t/*\r\n\t\treturn <button className=\"btn btn-sm btn-info mr-2\"\r\n\t\tonClick={()=>{this.controller.openMarketPE()}}>\r\n\t\t市场平均PE\r\n\t\t</button>;\r\n\t\t*/\r\n\t\tlet {store} = this.controller;\r\n\t\tlet groups = store.stockGroups.groups.map(v => (\r\n\t\t\t{\r\n\t\t\t\tcaption: v.name,\r\n\t\t\t\taction: () => this.controller.changeGroup(v)\r\n\t\t\t}\r\n\t\t));\r\n\t\tlet actions: DropdownAction[] = [\r\n\t\t\t{\r\n\t\t\t\tcaption: '市场平均PE',\r\n\t\t\t\taction: this.controller.openMarketPE,\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tcaption: '选择股票',\r\n\t\t\t\taction: this.controller.onAddStock,\r\n\t\t\t},\r\n\t\t\tundefined,\r\n\t\t\t...groups,\r\n\t\t\tundefined,\r\n\t\t\t{\r\n\t\t\t\tcaption: '管理自选组',\r\n\t\t\t\taction: this.controller.manageGroups,\r\n\t\t\t},\r\n\t\t];\r\n\t\treturn <DropdownActions actions={actions} icon=\"bars\" className=\"mr-2 text-white bg-transparent border-0\" />;\r\n\t}));\r\n\t}\r\n\r\n\tprotected onPageScrollBottom(scroller: Scroller): Promise<void> {\r\n\t\tthis.controller.onPage();\r\n\t\treturn;\r\n\t}\r\n\r\n\tcontent() {\r\n\t\treturn React.createElement(observer(() => {\r\n\t\t\tlet {setSortType, stockGroup, sortType} = this.controller;\r\n\t\t\t/*\r\n\t\t\tlet {store} = cApp;\r\n\t\t\tlet {config} = store;\r\n\t\t\tlet title = config.groupName;\r\n\t\t\tlet { items } = home;\r\n\t\t\t*/\r\n\t\t\tlet title = stockGroup.name;\r\n\t\t\tlet items = stockGroup.stocks;\r\n\r\n\t\t\tlet {  onSelectTag, onAddStock } = this.controller;\r\n\t\t\t/*\r\n\t\t\tlet right = <div className=\"d-flex\">\r\n\t\t\t\t<div className=\"btn cursor-pointer\" onClick={onAddStock}><FA name=\"plus\" inverse={false} /></div>\r\n\t\t\t\t<div className=\"btn cursor-pointer ml-2\" onClick={onSelectTag}><FA name=\"bars\" inverse={false} /></div>\r\n\t\t\t</div>;\r\n\t\t\tlet left = <div className=\"align-self-center\">{title}</div>\r\n\t\t\t<LMR className=\"px-2 py-1\" left={left} right={right}></LMR>\r\n\t\t\t*/\r\n\t\t\treturn <div>\r\n\t\t\t\t<div className=\"d-flex justify-content-end mr-2 my-1\">\r\n\t\t\t\t\t{renderSortHeaders('radioHome', sortType, setSortType)}\r\n\t\t\t\t</div>\r\n\t\t\t\t<List items={items}\r\n\t\t\t\t\titem={{ render: this.renderRow, key: this.rowKey }}\r\n\t\t\t\t\tbefore={'...'}\r\n\t\t\t\t\tnone={<small className=\"px-3 py-3 text-info\">无自选股, 请选股</small>}\r\n\t\t\t\t/>\r\n\t\t\t</div>;\r\n\t\t}));\r\n\t}\r\n\r\n\trenderRow = (item: any, index: number): JSX.Element => { //<this.rowContent {...item} />;\r\n\t\treturn this.rowContent(item);\r\n\t} \r\n\tprotected rowContent = (row: any): JSX.Element => {\r\n\t\tlet right = renderStockUrl(row);\r\n\t\treturn renderStockInfoRow(row, this.onClickName, null, right);\r\n\t}\r\n\r\n\tprivate rowKey = (item: any) => {\r\n\t\tlet { id } = item;\r\n\t\treturn id;\r\n\t}\r\n\r\n\tprotected onClickName = (item: NStockInfo) => {\r\n\t\tthis.controller.openStockInfo(item);\r\n\t}\r\n\r\n\tprotected onSelected = async (item: any): Promise<void> => {\r\n\t\tlet a = 0;\r\n\t}\r\n\r\n\tprivate callOnSelected(item: any) {\r\n\t\tif (this.onSelected === undefined) {\r\n\t\talert('onSelect is undefined');\r\n\t\treturn;\r\n\t\t}\r\n\t\tthis.onSelected(item);\r\n\t}\r\n\tclickRow = (item: any) => {\r\n\t\tthis.callOnSelected(item);\r\n\t}\r\n}","import * as React from 'react';\r\nimport { observer } from 'mobx-react-lite';\r\nimport { VPage, Page, List } from 'tonva-react';\r\nimport { CHome } from './CHome';\r\n\r\nexport class VSelectTag extends VPage<CHome> {\r\n    async open(param?: any) {\r\n        this.openPage(this.page);\r\n    }\r\n\r\n    private renderTag = (tag:any) => {\r\n        return <div className=\"px-3 py-2 cursor-pointer\">{tag.name}</div>;\r\n    }\r\n\r\n    private page = observer(() => {\r\n        let {stockGroups} = this.controller.cApp.store;\r\n        let { onClickTag } = this.controller;\r\n        return <Page header=\"选择分组\" headerClassName=\"bg-primary\">\r\n            <List items={stockGroups.groups} item={{onClick:onClickTag, render:this.renderTag}} />\r\n        </Page>;\r\n    })\r\n}\r\n","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport * as React from 'react';\r\nimport classNames from 'classnames';\r\nimport { VPage, Page, View, List, LMR, left0, FA } from 'tonva-react';\r\nimport { observable } from 'mobx';\r\nimport { observer } from 'mobx-react';\r\nimport RC2 from 'react-chartjs2'\r\nimport { GFunc } from '../tool/GFunc';\r\nimport {CMarketPE } from './CMarketPE'\r\n\r\nexport class VMarketPE extends VPage<CMarketPE> {\r\n  private input: HTMLInputElement;\r\n  private key: string = undefined;\r\n\r\n  async open(param?: any) {\r\n    this.openPage(this.page);\r\n  }\r\n\r\n  render(param: any): JSX.Element {\r\n    return <this.page />\r\n  }\r\n\r\n  checkLimitShow = (e)=> {\r\n    let check = e.target.checked as boolean;\r\n    let f = check ? 1:0;\r\n    this.controller.onLongShortFlag(f);\r\n  }\r\n\r\n  private page = observer(() => {\r\n  let head = <div >{''}</div>\r\n    return <Page header={head}\r\n      headerClassName='bg-primary'>\r\n      <this.pageContent />\r\n    </Page>;\r\n  })\r\n\r\n  private pageContent = observer(() => {\r\n    return <>\r\n      <this.historyChart />\r\n    </>\r\n  });\r\n\r\n  protected historyChart = observer(() => {\r\n    let {historyData} = this.controller;\r\n    if (historyData === undefined) \r\n      return <></>;\r\n    let chartHistory = <></>;\r\n    let labelList:any[] = [];\r\n    let peList:number[] = [];\r\n    let eList:number[] = [];\r\n    for (let item of historyData) {\r\n      let {day, pe, e} = item;\r\n      labelList.push(day);\r\n      peList.push(GFunc.numberToPrecision(pe, 4));\r\n      eList.push(e);\r\n    }\r\n    let chartdata1 = {\r\n      labels: labelList,\r\n      datasets: [\r\n        {\r\n          label: 'PE',\r\n          data: peList,\r\n          borderColor:'blue',\r\n          backgroundColor:'skyBlue',\r\n          borderWidth: 1,\r\n          fill: false,\r\n          yAxisID: 'y-axis-1',\r\n        },\r\n        {\r\n          label: 'e',\r\n          data: eList,\r\n          borderColor:'red',\r\n          backgroundColor:'pink',\r\n          borderWidth: 1,\r\n          fill: false,\r\n          yAxisID: 'y-axis-2',\r\n        }\r\n      ]\r\n    };\r\n    let options = {\r\n      scales:{\r\n        yAxes: [{\r\n          type: 'linear',\r\n          display: true,\r\n          position: 'right',\r\n          id: 'y-axis-1',\r\n        }, {\r\n          type: 'linear',\r\n          display: true,\r\n          position: 'left',\r\n          id: 'y-axis-2',\r\n          gridLines: {\r\n              drawOnChartArea: false\r\n          }\r\n        }],    \r\n      }\r\n    }\r\n    chartHistory = <RC2 data={chartdata1} type='line' options={options} />;\r\n    let right = <></>;\r\n    right = <label className=\"px-3\"> <input type=\"checkbox\" name=\"selectType\" defaultChecked={false}\r\n    onChange={this.checkLimitShow} />长期</label>;\r\n    return <><LMR className=\"px-3 py-2 bg-white\" left={'市场PE历史走势'} right={right}></LMR>\r\n      <div className=\"px-3\" style={{width:'95%'}}>{chartHistory}</div>\r\n    </>;\r\n  });\r\n\r\n\r\n}","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport { observable } from 'mobx';\r\nimport { CUqBase } from '../UqApp';\r\nimport { VMarketPE } from './VMarketPE';\r\n\r\nexport class CMarketPE extends CUqBase {\r\n    @observable historyData:{day:number, pe:number, e:number}[] =  [];\r\n    private longshortFlag:number = 0;\r\n\r\n    async internalStart(param: any) {\r\n        this.loadData();\r\n        this.openVPage(VMarketPE as any);\r\n    }\r\n\r\n    loadData = async () => {\r\n        let dt = new Date();\r\n        let param = [dt.getFullYear()*10000+(dt.getMonth()+1)*100+dt.getDate(), 750, this.longshortFlag];\r\n        //let rets = await this.cApp.store.miApi.query('q_marketpe', param) as {day:number, pe:number, e:number}[];\r\n\t\tlet rets = await this.cApp.miNet.q_marketpe(param);\r\n        this.historyData = rets.reverse();\r\n    }\r\n\r\n    onLongShortFlag(f:number) {\r\n        if (f === this.longshortFlag)\r\n            return;\r\n        this.longshortFlag = f;\r\n        this.loadData();\r\n    }\r\n}","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport { CApp, CUqBase } from '../UqApp';\r\nimport { CStockInfo, NStockInfo } from '../stockinfo';\r\nimport { VSiteHeader } from './VSiteHeader';\r\nimport { VSearchHeader } from './VSearchHeader';\r\nimport { VHome } from './VHome';\r\nimport { VSelectTag } from './VSelectTag';\r\nimport { CMarketPE } from './CMarketPE';\r\nimport { CSelectStock } from 'selectStock';\r\nimport { Stock, StockGroup, Store } from '../store';\r\nimport { makeObservable, observable } from 'mobx';\r\n\r\nexport class CHome extends CUqBase {\r\n\tstore: Store;\r\n\tstockGroup: StockGroup;\r\n\tsortType: string;\r\n\r\n\tconstructor(cApp: CApp) {\r\n\t\tsuper(cApp);\r\n\t\tmakeObservable(this, {\r\n\t\t\tstockGroup: observable,\r\n\t\t\tsortType: observable,\r\n\t\t});\r\n\t\tlet {store} = cApp;\r\n\t\tthis.store = store;\r\n\t}\r\n\r\n\tload = async () => {\r\n\t\tthis.stockGroup = this.store.getHomeStockGroup();\r\n\t\tif (!this.stockGroup) debugger;\r\n\t\tthis.sortType = this.store.config.userStock.sortType;\r\n\t\tif (!this.sortType) this.sortType = '';\r\n\t\tawait this.stockGroup.loadItems();\r\n\t\tthis.stockGroup.sort(this.sortType)\r\n\t\t/*\r\n\t\tlet tagID = this.store.tagID;\r\n\t\tif (tagID > 0) {\r\n\t\t\tif (this.lastLoadTick && Date.now() - this.lastLoadTick < 300*1000) return;\r\n\t\t\t\tawait this.store.loadHomeItems();\r\n\t\t\tthis.lastLoadTick = Date.now();\r\n\t\t}\r\n\t\t*/\r\n\t}\r\n\r\n\tasync changeGroup(stockGroup: StockGroup) {\r\n\t\tthis.stockGroup = stockGroup;\r\n\t\tawait this.stockGroup.loadItems();\r\n\t}\r\n\r\n\tmanageGroups = async () => {\r\n\t\tthis.cApp.showGroupsManage();\r\n\t}\r\n\r\n\tonSelectTag = async () => {\r\n\t\tthis.openVPage(VSelectTag);\r\n\t}\r\n\r\n\tonAddStock = async () => {\r\n\t\tlet cStock = new CSelectStock(this.cApp);\r\n\t\tlet r = await cStock.call() as Stock;\r\n\r\n\t\tif (r !== undefined) {\r\n\t\t\tawait this.stockGroup.addStock(r);\r\n\t\t}\r\n\t}\r\n\r\n\tonClickTag = async (item:any) => {\r\n\t\tawait this.cApp.store.selectTag(item);\r\n\t\tthis.closePage();\r\n\t}\r\n\r\n\tonPage = async () => {\r\n\t\t//this.PageItems.more();\r\n\t}\r\n\r\n\tonWarningConfg = () => {\r\n\t\tthis.cApp.cWarning.onWarningConfg();\r\n\t}\r\n\r\n\r\n\t// async searchMain(key: any) {\r\n\t//   if (key !== undefined) await this.PageItems.first(key);\r\n\t// }\r\n\r\n\t\t//作为tabs中的首页，internalStart不会被调用\r\n\tasync internalStart(param: any) {\r\n\t}\r\n\r\n\trenderSiteHeader = () => {\r\n\t\treturn this.renderView(VSiteHeader);\r\n\t}\r\n\r\n\trenderSearchHeader = (size?: string) => {\r\n\t\treturn this.renderView(VSearchHeader, size);\r\n\t}\r\n\r\n\ttab = () => this.renderView(VHome);\r\n\r\n\topenStockInfo = (item: NStockInfo) => {\r\n\t\tlet cStockInfo = this.newC(CStockInfo);\r\n\t\tcStockInfo.start(item);\r\n\t}\r\n\r\n\topenMarketPE = () => {\r\n\t\tlet cm = this.newC(CMarketPE);\r\n\t\tcm.start();\r\n\t}\r\n\r\n\tsetSortType = (type:string) => {\r\n\t\tthis.stockGroup.sort(type);\r\n\t\tthis.store.setUserSortType(type);\r\n\t}\r\n}","import * as React from 'react';\r\nimport { observable } from 'mobx';\r\nimport {\r\n    userApi, ItemSchema, StringSchema, ImageSchema, UiTextItem, UiImageItem, nav, Page,\r\n    Edit, UiSchema, VPage, Prop, FA, IconText, PropGrid\r\n} from 'tonva-react';\r\nimport { CMe } from './CMe';\r\n\r\nexport class VEditMe extends VPage<CMe>{\r\n\r\n    async open(param: any) {\r\n        this.openPage(this.page);\r\n    }\r\n\r\n    private schema: ItemSchema[] = [\r\n        { name: 'nick', type: 'string' } as StringSchema,\r\n        { name: 'icon', type: 'image' } as ImageSchema,\r\n    ];\r\n    private uiSchema: UiSchema = {\r\n        items: {\r\n            nick: { widget: 'text', label: '别名', placeholder: '好的别名更方便记忆' } as UiTextItem,\r\n            icon: { widget: 'image', label: '头像' } as UiImageItem,\r\n        }\r\n    }\r\n    @observable private data: any;\r\n\r\n    constructor(props: any) {\r\n        super(props);\r\n        let { nick, icon } = nav.user;\r\n        this.data = {\r\n            nick: nick,\r\n            icon: icon,\r\n        };\r\n    }\r\n\r\n    private onItemChanged = async (itemSchema: ItemSchema, newValue: any, preValue: any) => {\r\n        let { name } = itemSchema;\r\n        await userApi.userSetProp(name, newValue);\r\n        this.data[name] = newValue;\r\n        nav.user.name = newValue;\r\n        nav.saveLocalUser();\r\n    }\r\n\r\n\tprivate onExit = () => {\r\n        nav.showLogout();\r\n    }\r\n\r\n\tprivate changePassword = async () => {\r\n        await nav.changePassword();\r\n    }\r\n\r\n    private page = () => {\r\n\t\tlet { schema, uiSchema, data, onItemChanged } = this;\r\n\t\tlet gridRows: Prop[] = [\r\n\t\t\t'',\r\n\t\t\t{\r\n\t\t\t\ttype: 'component',\r\n\t\t\t\tcomponent: <IconText iconClass=\"text-info mr-2\" icon=\"key\" text={this.t('changePassword')} />,\r\n\t\t\t\tonClick: this.changePassword\r\n\t\t\t},\r\n\t\t\t'',\r\n\t\t\t'',\r\n\t\t\t{\r\n\t\t\t\ttype: 'component',\r\n\t\t\t\tbk: '',\r\n\t\t\t\tcomponent: <div className=\"w-100 text-center\">\r\n\t\t\t\t\t<button className=\"btn btn-danger w-100 w-max-20c\" onClick={this.onExit}>\r\n\t\t\t\t\t\t<FA name=\"sign-out\" size=\"lg\" /> {this.t('logout')}\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</div>\r\n\t\t\t},\r\n\t\t];\r\n\r\n\r\n\t\t/*\r\n\t\tlet vAdmin: any;\r\n\t\t\r\n\t\tlet { role } = this.controller;\r\n\t\tif ((role & 2) === 2) {\r\n\t\t\tvAdmin = <div className=\"px-3 py-2 cursor-pointer bg-white border-bottom\" onClick={this.controller.showAdmin}>管理员</div>;\r\n\t\t}\r\n\t\t{vAdmin}\r\n\t\t*/\r\n        return <Page header=\"个人信息\">\r\n            <Edit schema={schema} uiSchema={uiSchema}\r\n                data={data}\r\n                onItemChanged={onItemChanged} />\r\n\t\t\t<PropGrid rows={gridRows} values={{}} />\r\n        </Page>;\r\n    }\r\n}\r\n\r\nexport const webUserSchema: ItemSchema[] = [\r\n    { name: 'firstName', type: 'string', required: true } as StringSchema,\r\n    { name: 'gender', type: 'string' } as StringSchema,\r\n    { name: 'salutation', type: 'string' } as StringSchema,\r\n    { name: 'organizationName', type: 'string', required: true } as StringSchema,\r\n    { name: 'departmentName', type: 'string' } as StringSchema,\r\n];\r\n\r\n","import { VPage } from \"tonva-react\";\r\nimport { CMe } from \"./CMe\";\r\n\r\nexport class VFaq extends VPage<CMe> {\r\n\theader() {return '基本概念'}\r\n\tcontent() {\r\n\t\treturn <ul>\r\n\t\t\t<li className=\"my-3\">\r\n\t\t\t\t<div className=\"my-2\">基本公理</div>\r\n\t\t\t\t<ul className=\"px-3 text-info\">\r\n\t\t\t\t\t<li><span className=\"mr-3\">公理1: </span>进步是社会的必然</li>\r\n\t\t\t\t\t<li><span className=\"mr-3\">公理2: </span>信任是经济的基石</li>\r\n\t\t\t\t\t<li><span className=\"mr-3\">公理3: </span>价值是价格的准心</li>\r\n\t\t\t\t\t<li><span className=\"mr-3\">公理4: </span>发展是企业的基因</li>\r\n\t\t\t\t</ul>\r\n\t\t\t</li>\r\n\t\t\t<li className=\"my-3\">\r\n\t\t\t\t<div className=\"my-2\">米投定律</div>\r\n\t\t\t\t<ul className=\"px-3 text-info\">\r\n\t\t\t\t\t<li><span className=\"mr-3\">定律1: </span>投资无风险</li>\r\n\t\t\t\t</ul>\r\n\t\t\t</li>\r\n\t\t\t<li className=\"my-3\">\r\n\t\t\t\t<div className=\"my-2\">米投原则</div>\r\n\t\t\t\t<ul className=\"px-3 text-info\">\r\n\t\t\t\t\t<li><span className=\"mr-3\">原则1: </span>低估</li>\r\n\t\t\t\t\t<li><span className=\"mr-3\">原则2: </span>分散</li>\r\n\t\t\t\t\t<li><span className=\"mr-3\">原则3: </span>不深研</li>\r\n\t\t\t\t</ul>\r\n\t\t\t</li>\r\n\t\t\t<li className=\"my-3\">\r\n\t\t\t\t<div className=\"my-2\">米息定义</div>\r\n\t\t\t\t<ul className=\"px-3 text-info\">\r\n\t\t\t\t\t<li><span className=\"mr-3\">定义1: </span>米息 = 增息 + 股息</li>\r\n\t\t\t\t\t<li><span className=\"mr-3\">定义2: </span>增息 = 企业未来三年利润增长值</li>\r\n\t\t\t\t\t<li><span className=\"mr-3\">定义3: </span>米息率 = 米息 / 股价</li>\r\n\t\t\t\t\t<li><span className=\"mr-3\">定义4: </span>米息率大一倍，米息分加1</li>\r\n\t\t\t\t\t<li><span className=\"mr-3\">定义5: </span>PE = 股价 / 利润</li>\r\n\t\t\t\t</ul>\r\n\t\t\t</li>\r\n\t\t</ul>\r\n\t}\r\n}","import { VPage } from \"tonva-react\";\r\nimport { appConfig } from \"../appConfig\";\r\nimport { CMe } from \"./CMe\";\r\n\r\nexport class VAbout extends VPage<CMe> {\r\n\theader() {return '关于APP';}\r\n\tcontent() {\r\n\t\treturn <div className=\"py-5 px-3 my-3 w-max-30c mx-auto bg-white\">\r\n\t\t\t<div className=\"text-center mb-5 position-relative\">\r\n\t\t\t\t<small className=\"text-muted position-absolute\"\r\n\t\t\t\t\tstyle={{right:'0', top:'-2.8rem'}}>\r\n\t\t\t\t\t版本: {appConfig.version}\r\n\t\t\t\t</small>\r\n\t\t\t\t<i className=\"text-danger position-absolute top-0 start-0 fa fa-fire fa-2x\" \r\n\t\t\t\t\tstyle={{left:'2rem', top:'0.5rem'}} />\r\n\t\t\t\t<b className=\"text-danger h5 mb-0\">\r\n\t\t\t\t\t<span className=\"text-primary\">鱼</span>\r\n\t\t\t\t\t<b className=\"mx-1\">米</b>\r\n\t\t\t\t\t<span className=\"text-success\">乡</span>\r\n\t\t\t\t</b>\r\n\t\t\t\t<br/>\r\n\t\t\t\t<small className=\"text-info\">私享投资圈</small>\r\n\t\t\t</div>\r\n\t\t\t<ul>\r\n\t\t\t\t<li>跟家人和好友一起分享投资思考。</li>\r\n\t\t\t\t<li>世界级投资大师年化收益率11%。</li>\r\n\t\t\t\t<li>全球最大的成长经济体GDP增长率高于5%。</li>\r\n\t\t\t\t<li>以10%为基础，期待<b className=\"text-danger mx-1\">15%以上</b>的高水平。</li>\r\n\t\t\t</ul>\r\n\t\t\t<div className=\"mt-5 text-center\">\r\n\t\t\t\t<small className=\"text-muted mr-2\">by</small>\r\n\t\t\t\t同花投顾\r\n\t\t\t</div>\r\n\t\t</div>;\r\n\t}\r\n}\r\n","import React from 'react';\r\nimport { observer } from 'mobx-react';\r\nimport { Image, VPage, nav, IconText, PropGrid, LMR, FA, Prop } from 'tonva-react';\r\nimport { CMe } from './CMe';\r\nimport { appConfig } from '../appConfig';\r\nimport { VFaq } from './VFaq';\r\nimport { VAbout } from './VAbout';\r\n\r\nexport class VMe extends VPage<CMe> {\r\n\theader() {return this.t('me')}\r\n\r\n\tcontent() {\r\n        const { user } = nav;\r\n        let aboutRows: Prop[] = [\r\n            '',\r\n            {\r\n                type: 'component',\r\n                component: <LMR className=\"w-100\" onClick={this.faq}\r\n\t\t\t\t\tright={<FA className=\"align-self-center\" name=\"angle-right\" />}>\r\n                    <IconText iconClass=\"text-info mr-2\" icon=\"comments-o\" text={this.t('基本概念')} />                    \r\n                </LMR>,\r\n            },\r\n            {\r\n                type: 'component',\r\n                component: <LMR className=\"w-100\" onClick={this.about}\r\n\t\t\t\t\tright={<FA className=\"align-self-center\" name=\"angle-right\" />}>\r\n                    <IconText iconClass=\"text-info mr-2\" \r\n\t\t\t\t\t\ticon=\"smile-o\" \r\n\t\t\t\t\t\ttext={<>{this.t('aboutTheApp')} <small>版本 {appConfig.version}</small></>} />                    \r\n                </LMR>,\r\n            },\r\n        ];\r\n\r\n        let rows: Prop[];\r\n        if (user === undefined) {\r\n            rows = aboutRows;\r\n            rows.push(\r\n                {\r\n                    type: 'component',\r\n                    component: <button className=\"btn btn-success w-100 my-2\" onClick={() => nav.logout()}>\r\n                        <FA name=\"sign-out\" size=\"lg\" /> {this.t('pleaseLogin')}\r\n                    </button>\r\n                },\r\n            );\r\n        }\r\n        else {\r\n            let logOutRows: Prop[] = [\r\n            ];\r\n\r\n            rows = [\r\n                '',\r\n                {\r\n                    type: 'component',\r\n                    component: <this.meInfo />\r\n                },\r\n            ]\r\n            rows.push(...aboutRows, ...logOutRows);\r\n        }\r\n        return <PropGrid rows={[...rows]} values={{}} />;\r\n\t}\r\n\r\n\tprivate meInfo = observer(() => {\r\n        let { user } = nav;\r\n        if (user === undefined) return null;\r\n        let { id, name, nick, icon } = user;\r\n        return <LMR className=\"py-2 cursor-pointer w-100\"\r\n            left={<Image className=\"w-3c h-3c mr-3\" src={icon || '.user-o'} />}\r\n            right={<FA className=\"align-self-end\" name=\"angle-right\" />}\r\n            onClick={this.controller.showEditMe}>\r\n            <div>\r\n                <div>{userSpan(name, nick)}</div>\r\n                <div className=\"small\"><span className=\"text-muted\">ID:</span> {id > 10000 ? id : String(id + 10000).substr(1)}</div>\r\n            </div>\r\n        </LMR>;\r\n    });\r\n\r\n\tprivate faq = () => {\r\n\t\tthis.openVPage(VFaq);\r\n\t}\r\n\r\n\tprivate about = () => {\r\n\t\tthis.openVPage(VAbout);\r\n\t}\r\n}\r\n\r\nfunction userSpan(name: string, nick: string): JSX.Element {\r\n    return nick ?\r\n        <><b>{nick} &nbsp; <small className=\"muted\">{name}</small></b></>\r\n        : <b>{name}</b>\r\n}\r\n","import { QueryPager, User } from \"tonva-react\";\r\nimport { CUqBase } from \"../UqApp\";\r\n//import { VAdmin } from \"./VAdmin\";\r\nimport { VEditMe } from \"./VEditMe\";\r\nimport { VMe } from \"./VMe\";\r\n\r\nexport interface RootUnitItem {\r\n\tid: number;\t\t\t\t\t// root unit id\r\n\towner: any;\r\n\tname: string;\t\t\t\t// 唯一\r\n\tcontent: string;\r\n\ttonvaUnit: number;\t\t\t// 跟tonva机构对应的值\r\n\tx: number;\r\n}\r\n\r\nexport class CMe extends CUqBase {\r\n\trole: number;\r\n\tunitOwner: User;\r\n\trootUnits: QueryPager<any>;\r\n\r\n    protected async internalStart() {\r\n\t}\r\n\r\n\ttab = () => this.renderView(VMe);\r\n\r\n\tshowEditMe = async () => {\r\n\t\t//let result = await this.uqs.Notes.GetSystemRole.query({});\r\n\t\tthis.role = undefined; // result.ret[0]?.role;\r\n\t\tthis.openVPage(VEditMe);\r\n\t}\r\n\t/*\r\n\tshowAdmin = async () => {\r\n\t\tthis.rootUnits = new QueryPager<any>(this.uqs.Notes.GetRootUnits, undefined, undefined, true);\r\n\t\tthis.rootUnits.first({});\r\n\t\tthis.openVPage(VAdmin);\r\n\t}\r\n\r\n\tasync createRootUnit(param: {name:string; content:string; owner:number}): Promise<number> {\r\n\t\tlet result = await this.uqs.Notes.CreateRootUnit.submit(param);\r\n\t\treturn result.id;\r\n\t}\r\n\r\n\tasync changeRootUnitName(item:RootUnitItem, name:string) {\r\n\t\tawait this.uqs.Notes.ChangeRootUnitProp.submit({unit:item.id, prop:'name', value: name})\r\n\t\titem.name = name;\r\n\t}\r\n\r\n\tasync changeRootUnitTonva(item:RootUnitItem, tonvaUnit:any) {\r\n\t\tawait this.uqs.Notes.ChangeRootUnitProp.submit({unit:item.id, prop:'tonvaUnit', value: tonvaUnit})\r\n\t\titem.tonvaUnit = tonvaUnit;\r\n\t}\r\n\r\n\tasync changeRootUnitX(item:RootUnitItem, x:number) {\r\n\t\tawait this.uqs.Notes.ChangeRootUnitProp.submit({unit:item.id, prop:'x', value: x as any})\r\n\t\titem.x = x;\r\n\t}\r\n\t*/\r\n}\r\n","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport { LMR, View } from 'tonva-react';\r\nimport logo from '../images/logo.svg';\r\nimport { CExplorer } from './CExplorer';\r\n\r\nexport class VSiteHeader extends View<CExplorer> {\r\n    render() {\r\n        let left = <img className=\"m-1\" src={logo} alt=\"logo\" style={{height: \"3rem\", width: \"3rem\"}} />;\r\n        let right = undefined;\r\n        return <LMR\r\n            className=\"mb-3 align-items-center bg-white\"\r\n            left={left} right={right}>\r\n            <div className=\"\">\r\n                {this.controller.renderSiteHeader()}\r\n            </div>\r\n        </LMR>\r\n    }\r\n}","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport * as React from 'react';\r\nimport { observer } from 'mobx-react';\r\nimport { VPage, List, LMR, FA, Scroller } from 'tonva-react';\r\nimport { NStockInfo } from '../stockinfo';\r\nimport { GFunc } from '../tool/GFunc';\r\nimport { CExplorer } from './CExplorer';\r\nimport { renderSortHeaders, renderStockInfoRow, renderStockUrl } from '../tool';\r\n\r\nexport class VExplorer extends VPage<CExplorer> {\r\n\theader() {return '股票发现'}\r\n\tprotected onPageScrollBottom(scroller: Scroller): Promise<void> {\r\n\t\tthis.controller.onPage();\r\n\t\treturn;\r\n\t}\r\n\r\n\tright() {\r\n\t\tlet { onConfig } = this.controller;\r\n\t\treturn <div className=\"btn align-self-center cursor-pointer \" onClick={onConfig}><FA name=\"cog\" size=\"lg\" inverse={true} /></div>\r\n\t}\r\n\r\n\tcontent() {\r\n\t\treturn React.createElement(observer(() => {\r\n\t\t\tlet {explore, load, setSortType} = this.controller;\r\n\t\t\tlet {items, avgs, sortType } = explore;\r\n\r\n\t\t\tlet left: any;\r\n\t\t\tlet right = <div className=\"btn btn-link cursor-pointer py-1\" onClick={load}>刷新</div>;\r\n\t\t\t/*if (avgs.avg20 !== undefined || avgs.avg50 !== undefined || avgs.avg100 !== undefined) {\r\n\t\t\t\tlet avgStr = ` top20 : ${GFunc.numberToFixString(avgs.avg20)} \r\n  -  top50 : ${GFunc.numberToFixString(avgs.avg50)}\r\n  -  top100 : ${GFunc.numberToFixString(avgs.avg100)}\r\n  -  all : ${GFunc.numberToFixString(avgs.avg)}\r\n  ...查看历史走势`;\r\n\t\t\t\tleft = <div className=\"px-3 cursor-pointer align-self-center\"\r\n\t\t\t\t\tonClick={this.controller.onClickPredictAVG}>\r\n\t\t\t\t\t\t{GFunc.caption('价值指数均值')}{avgStr}\r\n\t\t\t\t\t</div>;\r\n\t\t\t}*/\r\n\t\t\tif (avgs.avg !== undefined) {\r\n\t\t\t\tlet avgStr = ` : ${GFunc.numberToFixString(Math.log(avgs.avg), 1)}`;\r\n\t\t\t\tleft = <div className=\"px-3 cursor-pointer align-self-center\">\r\n\t\t\t\t\t\t{GFunc.caption('米息分均值')}{avgStr}\r\n\t\t\t\t\t</div>;\r\n\t\t\t}\t\t\t\r\n\t\t\treturn <>\r\n\t\t\t\t<LMR left={left} right={right} />\r\n\t\t\t\t<div className=\"d-flex justify-content-end mr-2 my-1\">\r\n\t\t\t\t\t{renderSortHeaders('radioHome', sortType, setSortType)}\r\n\t\t\t\t</div>\r\n\t\t\t\t<List items={items}\r\n\t\t\t\t\titem={{ render: this.renderRow, key: this.rowKey }}\r\n\t\t\t\t\tbefore={'选股'}\r\n\t\t\t\t/>\r\n\t\t\t</>\r\n\t\t}));\r\n\t}\r\n\r\n\trenderRow = (item: any, index: number): JSX.Element => {\r\n\t\treturn this.rowContent(item);\r\n\t} \r\n\tprotected rowContent = (row: any): JSX.Element => {\r\n\t\tlet {store} = this.controller.cApp;\r\n\t\tlet { id, symbol } = row as NStockInfo;\r\n\t\tif (store.isMyBlack(id) === true) return null;\r\n\t\tlet labelId = 'vexl_' + id;\r\n\t\tlet isMySelect = store.isMySelect(id); // defList.findIndex(v=>v===id);\r\n\t\tlet middle = <label className=\"mb-0 cursor-pointer\">\r\n\t\t\t<input className=\"mr-1\" type=\"checkbox\" value=\"\" id={labelId}\r\n\t\t\tdefaultChecked={isMySelect}\r\n\t\t\tonChange={e => this.onSelect(row, e.target.checked)}/>\r\n\t\t\t<small className=\"text-muted\">自选</small>\r\n\t\t</label>;\r\n\r\n\t\tlet right = <div className=\"d-flex\">\r\n\t\t\t{renderStockUrl(row)}\r\n\t\t</div>;\r\n\t\treturn renderStockInfoRow(row, this.onClickName, middle, right);\r\n\t};\r\n\r\n\tprivate rowKey = (item: any) => {\r\n\t\tif (item.item !== undefined) {\r\n\t\t\treturn item.item.id;\r\n\t\t}\r\n\t\tlet { id } = item;\r\n\t\treturn id;\r\n\t}\r\n\r\n\tprotected onClickName = (item: NStockInfo) => {\r\n\t\tthis.controller.openStockInfo(item);\r\n\t}\r\n\r\n\tprotected onSelect = async (item: any, isSelected:boolean): Promise<void> => {\r\n\t\tthis.controller.onSelectItem(item, isSelected);\r\n\t}\r\n\r\n\tprotected onClickItem = async (item: any): Promise<void> => {\r\n\t\tthis.controller.openStockInfo(item);\r\n\t}\r\n}","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport * as React from 'react';\r\nimport { observer } from 'mobx-react';\r\nimport { VPage, Page, FA, List, Form, ItemSchema, StringSchema, UiInputItem, UiSchema, Context, IdSchema, UiIdItem, LMR, UiSelect, UiTextItem } from 'tonva-react';\r\nimport { CExplorer } from './CExplorer';\r\n\r\nconst schema: ItemSchema[] = [\r\n  { name: 'irate', type: 'number', required: true},\r\n  { name: 'bmin', type: 'number', required: true},\r\n  { name: 'bmax', type: 'number', required: true},\r\n  { name: 'r2', type: 'number', required: true},\r\n  { name: 'lmin', type: 'number', required: true},\r\n  { name: 'lmax', type: 'number', required: true},\r\n  { name: 'lr2', type: 'number', required: true},\r\n  { name: 'mcount', type: 'integer', required: true},\r\n  { name: 'lr4', type: 'number', required: true},\r\n  { name: 'r210', type: 'number', required: true},\r\n  { name: 'submit', type: 'submit', },\r\n];\r\n\r\nconst uiSchema: UiSchema = {\r\n  items: {\r\n    irate: { widget: 'number', label: '无风险收益率', placeholder: '0.04'} as UiInputItem,\r\n    bmin: { widget: 'number', label: '指数回归最小值', placeholder: '0.00'} as UiInputItem,\r\n    bmax: { widget: 'number', label: '指数回归最大值', placeholder: '0.00'} as UiInputItem,\r\n    r2: { widget: 'number', label: '指数回归R2', placeholder: '0.00'} as UiInputItem,\r\n    lmin: { widget: 'number', label: '线性回归最小值', placeholder: '0.00'} as UiInputItem,\r\n    lmax: { widget: 'number', label: '线性回归最大值', placeholder: '0.00'} as UiInputItem,\r\n    lr2: { widget: 'number', label: '线性回归R2', placeholder: '0.00'} as UiInputItem,\r\n    lr4: { widget: 'number', label: '末年与前4年均值最大比值', placeholder: '0.00'} as UiInputItem,\r\n    mcount: { widget: 'number', label: '5年内单季亏损最多允许出现次数', placeholder: '0.00'} as UiInputItem,\r\n    r210: { widget: 'number', label: '十年回归R2', placeholder: '0.00'} as UiInputItem,\r\n    submit: { widget: 'button', label: '保存', className: 'btn btn-primary' },\r\n  }\r\n};\r\n\r\n\r\nexport class VExplorerCfg extends VPage<CExplorer> {\r\n  async open(param?: any) {\r\n    this.openPage(this.page);\r\n  }\r\n\r\n  sortChage = (e)=> {\r\n    let newType = e.target.value;\r\n\r\n    this.controller.cApp.store.setStockSortType(newType);\r\n  }\r\n\r\n  selectChange = (e)=> {\r\n    let newType = e.target.value;\r\n\r\n    this.controller.cApp.store.setStockSelectType(newType);\r\n  }\r\n\r\n  onChange = (e) => {\r\n    let {name, value} = e.target;\r\n  }\r\n\r\n  private onFormButtonClick = async (name: string, context: Context) => {\r\n    //await this.controller.onSaveNewWarning(context.data);\r\n    let {bmin, bmax, r2, lmin, lmax, lr2, mcount, lr4, r210, irate} = context.data;\r\n    let cfg = {bmin:bmin, bmax:bmax, r2:r2, lmin:lmin, lmax:lmax, lr2:lr2, mcount:mcount, lr4:lr4, r210:r210, irate:irate};\r\n    await this.controller.cApp.store.setRegressionConfig(cfg);\r\n    this.controller.closePage();\r\n  }\r\n\r\n\r\n  private page = observer(() => {\r\n    let scfg = this.controller.cApp.store.findStockConfg;\r\n    //let findType = scfg.sortType;\r\n    // let selectType = scfg.selectType;\r\n    // if (selectType === undefined) {\r\n    //   selectType = 'all';\r\n    // }\r\n    let fData = this.controller.cApp.store.config.regression;\r\n    if (fData.irate === undefined)\r\n      fData.irate = 0.04;\r\n\r\n    return <Page header=\"选股设置\" headerClassName=\"bg-primary\">\r\n      {/* <div className=\"px-3 py-2\">方法</div>\r\n      <div className=\"px-3 py-2 d-flex flex-wrap\">\r\n        <label className=\"px-3 c8\"> <input type=\"radio\" name=\"selectType\" value=\"all\" checked={selectType===\"all\"}\r\n          onChange={this.selectChange} />预期PE</label><br />\r\n        <label className=\"px-3 c8\"> <input type=\"radio\" name=\"selectType\" value=\"value\" checked={selectType===\"value\"}\r\n          onChange={this.selectChange} />价值指数</label><br />\r\n      </div> */}\r\n      <div className=\"px-3 py-2\">回归参数</div>\r\n      <Form schema={schema}\r\n          uiSchema={uiSchema}\r\n          formData={fData}\r\n          onButtonClick={this.onFormButtonClick}\r\n        />\r\n    </Page>;\r\n  })\r\n}\r\n","import { makeObservable, observable, runInAction, toJS } from \"mobx\";\r\nimport { SlrForEarning } from \"regression\";\r\nimport { GFunc } from \"../tool\";\r\nimport { Store, sortStocks } from \"../store\";\r\n\r\ninterface Avg {\r\n\tavg20?: number;\r\n\tavg50?: number;\r\n\tavg100?: number;\r\n\tavg?: number;\r\n}\r\n\r\nexport class Explore {\r\n\tprivate store: Store;\r\n\titems: any[]; // = observable.array<any>([], { deep: true });\r\n\tavgs: Avg = {};\r\n\tlastTradeDay: number;\r\n\tsortType: string;\r\n\tselectedItems: any[] = [];\r\n  \r\n\tconstructor(store: Store) {\r\n\t\tthis.store = store;\r\n\t\tmakeObservable(this, {\r\n\t\t\tavgs: observable,\r\n\t\t\titems: observable,\r\n\t\t\tsortType: observable,\r\n\t\t});\r\n\t}\r\n\t\r\n\tload = async () => {\r\n\t\tthis.selectedItems = [];\r\n\t\tlet items = await this.loadItems();\r\n\t\trunInAction(() => {\r\n\t\t\tthis.sortType = this.store.config.userStock.sortType;\r\n\t\t\tsortStocks(this.sortType, items);\r\n\t\t\tif (!this.items) {\r\n\t\t\t\tthis.items = items;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tthis.items.splice(0, this.items.length, items);\r\n\t\t\t}\t\r\n\t\t});\r\n\t}\r\n\r\n\tprivate async loadItems():Promise<any[]> {\r\n\t\tlet queryName = 'all';\r\n\t\tlet rets = await this.store.loadExportItems(queryName);\r\n\t\tlet lastDayRet = rets[1] as {day:number}[];\r\n\t\tif (Array.isArray(lastDayRet) && lastDayRet.length > 0) {\r\n\t\t\tthis.lastTradeDay = lastDayRet[0].day;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.lastTradeDay = undefined;\r\n\t\t}\r\n\t\tlet result = rets[0];\r\n\t\tif (Array.isArray(result) === false) {\r\n\t\t\treturn;\r\n\t\t};\r\n\t\tlet arr = result as {id:number, data?:string, v:number, pe:number, e:number, ep:number, price:number, exprice:number, divyield:number, r2:number, lr2:number, e3:number, predictpe:number, order:number, ma:number, dataArr?:number[]}[];\r\n\t\tfor (let item of arr) {\r\n\t\t\tlet dataArray = JSON.parse(item.data) as number[];\r\n\t\t\titem.dataArr = dataArray;\r\n\t\t\tlet sl = new SlrForEarning(dataArray);\r\n\t\t\t//let ep = GFunc.evaluatePricePrice(irate, sl.predict(5), sl.predict(6), sl.predict(7));\r\n\t\t\titem.ep = (sl.predict(4) + item.e) / 2;\r\n\t\t\titem.v = GFunc.calculateVN(sl.slopeR, item.ep, item.divyield * item.price, item.exprice);\r\n\t\t\titem.e3 = sl.predict(7);\r\n\t\t}\r\n\t\trunInAction(() => {\r\n\t\t\tif (queryName === 'all') {\r\n\t\t\t\tthis.avgs = GFunc.CalculateValueAvg(arr);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tthis.avgs = {};\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn arr;\r\n\t}\r\n\r\n\tasync onItemSelected(item:any) {\r\n\t\tthis.store.addTagStock(item);\r\n\t}\r\n\r\n\tasync onItemUnselected(item:any) {\r\n\t\tthis.store.removeTagStock(item);\r\n\t}\r\n\r\n\tsetSortType(type:string) {\r\n\t\trunInAction(() => {\r\n\t\t\tsortStocks(type, this.items);\r\n\t\t\tthis.store.setUserSortType(type);\t\r\n\t\t});\r\n\t}\r\n}\r\n","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport { CApp, CUqBase } from '../UqApp';\r\nimport { CStockInfo, NStockInfo } from '../stockinfo';\r\nimport { VSiteHeader } from './VSiteHeader';\r\nimport { VExplorer } from './VExplorer';\r\nimport { VExplorerCfg } from './VExplorerCfg';\r\nimport { PredictHistoryParam } from 'predicthistory/CPredictHistory';\r\nimport { Explore } from './explore';\r\n\r\nexport class CExplorer extends CUqBase {\r\n\texplore: Explore;\r\n\r\n\tconstructor(cApp: CApp) {\r\n\t\tsuper(cApp);\r\n\t\tlet {store} = cApp;\r\n\t\tthis.explore = new Explore(store);\r\n\t}\r\n\r\n\tload = async () => {\r\n\t\tthis.explore.load();\r\n\t}\r\n\r\n\tonPage = async () => {\r\n\t\t//this.PageItems.more();\r\n\t}\r\n\r\n\tonConfig = async () => {\r\n\t\tthis.openVPage(VExplorerCfg);\r\n\t}\r\n\r\n\tasync internalStart(param: any) {\r\n\t}\r\n\r\n\tonSelectItem = async (item:any, isSelected:boolean) => {\r\n\t\tif (isSelected === true) {\r\n\t\t\tthis.explore.onItemSelected(item);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.explore.onItemUnselected(item);\r\n\t\t}\r\n\t}\r\n\r\n\tsetSortType = (type:string) => this.explore.setSortType(type);\r\n\r\n\trenderSiteHeader = () => {\r\n\t\treturn this.renderView(VSiteHeader);\r\n\t}\r\n\r\n\trenderHome = () => {\r\n\t\treturn this.renderView(VExplorer);\r\n\t}\r\n\r\n\r\n\topenMetaView = () => {}\r\n\r\n\ttab = () => this.renderHome();\r\n\r\n\topenStockInfo = (item: NStockInfo) => {\r\n\t\tlet cStockInfo = this.newC(CStockInfo);\r\n\t\tcStockInfo.start(item);\r\n\t}\r\n\r\n\tonClickPredictAVG = () => {\r\n\t\tlet {avgs, lastTradeDay} = this.explore;\r\n\t\tlet param: PredictHistoryParam = {\r\n\t\t  day:undefined,\r\n\t\t  priceDay:lastTradeDay,\r\n\t\t  avg20:avgs.avg20,\r\n\t\t  avg50:avgs.avg50,\r\n\t\t  avg100:avgs.avg100,\r\n\t\t  avg:avgs.avg,\r\n\t\t}\r\n\t\tthis.cApp.openPredictAVG(param);\r\n\t}\r\n}\r\n","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport * as React from 'react';\r\nimport { observer } from 'mobx-react-lite';\r\nimport { VPage, Page, FA, List, Form, ItemSchema, StringSchema, UiInputItem, UiSchema, Context, IdSchema, UiIdItem, LMR, UiSelect, UiTextItem } from 'tonva-react';\r\nimport { CWarning } from './CWarning';\r\nimport { GFunc } from 'tool/GFunc';\r\n\r\nexport class VWarningConfig extends VPage<CWarning> {\r\n  async open(param?: any) {\r\n    this.openPage(this.page);\r\n  }\r\n\r\n  private onSelect = (item: any, isSelected: boolean, anySelected: boolean) => {\r\n    //this.controller.onTaged(item, isSelected);\r\n  }\r\n\r\n  private page = observer(() => {\r\n    let { warnings } = this.controller;\r\n    let divNewTag = warnings.length >= 100 ? '' :\r\n      <div className=\"px-3 py-2 cursor-pointer\" onClick={this.controller.onNewWarning}><FA name=\"plus\" className=\"text-primary\" /> &nbsp; 新建预警</div>;\r\n    return <Page header=\"预警\" headerClassName=\"bg-primary\">\r\n      {divNewTag}\r\n      <List items={warnings} \r\n        item={{ render: this.renderWarning }} \r\n        none={'--'} />\r\n    </Page>;\r\n  })\r\n\r\n  private renderWarning = (witem: any) => {\r\n    let {name, code, type, price} = witem;\r\n    let left = <div className=\"px-3 cursor-pointer\">\r\n      {name}\r\n      <small className=\" mx-3\" >{code}</small></div>;\r\n    return <LMR className=\"mx-3 my-2\" left={left} >\r\n      <div className=\"d-flex flex-wrap\">\r\n        <div className=\"px-3 c6\">{GFunc.warningTypeString(type)}</div>\r\n        <div className=\"px-3 c6\">{GFunc.numberToFixString(price)}</div>\r\n      </div>\r\n    </LMR>;\r\n  }\r\n}\r\n\r\nconst schema: ItemSchema[] = [\r\n  { name: 'id', type: 'id' } as IdSchema,\r\n  { name: 'type', type: 'string', required: true, maxLength: 2 } as StringSchema,\r\n  { name: 'price', type: 'number', required: true},\r\n  { name: 'submit', type: 'submit', },\r\n];\r\n\r\nconst uiSchema: UiSchema = {\r\n  items: {\r\n    id: { widget: 'id',\r\n      label: '股票',\r\n      visible: true} as UiIdItem,\r\n    type: { widget: 'select', label: '类型', \r\n    list: [{value:'gt', title:'大于'}, {value:'lt', title:'小于'}] } as UiSelect,\r\n    price: { widget: 'text', label: '价格', placeholder: '0.00'} as UiTextItem,\r\n    submit: { widget: 'button', label: '保存', className: 'btn btn-primary' },\r\n  }\r\n};\r\n\r\nexport class VNewWarning extends VPage<CWarning> {\r\n  async open(param?: any) {\r\n    this.openPage(this.page);\r\n  }\r\n\r\n  private newuiSchema: UiSchema = {\r\n    items: {\r\n      id: { widget: 'id',\r\n        label: '股票',\r\n        visible: true,\r\n        placeholder: <small className=\"text-muted\">请选择股票</small>,\r\n        pickId: async (context: Context, name: string, value: number) => {\r\n          return await this.controller.showSelectStock(context, name, value)\r\n        },\r\n        Templet: (item: any) => {\r\n          let { name, code } = item;\r\n          if (!item) return <small className=\"text-muted\">请选择股票</small>;\r\n          return <div>\r\n              {name}\r\n              <small className=\" mx-3\" >{code}</small>\r\n          </div>;\r\n        }\r\n      } as UiIdItem,\r\n      type: { widget: 'select', label: '类型', \r\n      list: [{value:'gt', title:'大于'}, {value:'lt', title:'小于'}] } as UiSelect,\r\n      price: { widget: 'text', label: '价格', placeholder: '0.00'} as UiTextItem,\r\n      submit: { widget: 'button', label: '保存', className: 'btn btn-primary' },\r\n    }\r\n  };\r\n  \r\n  private onFormButtonClick = async (name: string, context: Context) => {\r\n    await this.controller.onSaveNewWarning(context.data);\r\n  }\r\n\r\n  private page = () => {\r\n    let fData = {type:'lt'};\r\n    return <Page header=\"新建预警\" headerClassName=\"bg-primary\">\r\n      <div className=\"px-3 py-3\">\r\n        <Form schema={schema}\r\n          uiSchema={this.newuiSchema}\r\n          formData={fData}\r\n          onButtonClick={this.onFormButtonClick}\r\n        />\r\n      </div>\r\n    </Page>;\r\n  }\r\n}\r\n\r\nexport class VEditWarning extends VPage<CWarning> {\r\n  async open(param?: any) {\r\n    this.openPage(this.page, param);\r\n  }\r\n\r\n  private onFormButtonClick = async (name: string, context: Context) => {\r\n    await this.controller.onSaveWarning(context.data);\r\n  }\r\n\r\n  private page = (param?: any) => {\r\n    let {id, type, price} = param;\r\n    let fData = {id:id, type:type, price:price};\r\n    return <Page header=\"编辑预警\" headerClassName=\"bg-primary\">\r\n      <div className=\"px-3 py-3\">\r\n        <Form schema={schema}\r\n          uiSchema={uiSchema}\r\n          formData={fData}\r\n          onButtonClick={this.onFormButtonClick}\r\n        />\r\n      </div>\r\n    </Page>;\r\n  }\r\n}\r\n","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport { Context } from 'tonva-react';\r\nimport { observable } from 'mobx';\r\nimport { CUqBase } from '../UqApp';\r\nimport { CSelectStock } from '../selectStock';\r\nimport { VWarningConfig, VNewWarning } from './VWarningConfig';\r\n\r\nexport class CWarning extends CUqBase {\r\n\t//get cApp(): CApp { return this._cApp as CApp };\r\n\t@observable warnings:any[] = [];\r\n\r\n\tasync internalStart(param: any) {\r\n\t\tlet a = 1;\r\n\t}\r\n\r\n\tasync loadWarnings() {\r\n\t\t//let r = await this.cApp.store.miApi.call('t_stockwarning$all', [this.user.id]);//await this.uqs.mi.StockWarningAll.query(undefined);\r\n\t\tlet r = await this.cApp.miNet.t_stockwarning$all();\r\n\t\tlet ret = r as any[];\r\n\t\tthis.warnings = ret;\r\n\t}\r\n\r\n\tonNewWarning = () => {\r\n\t\tthis.openVPage(VNewWarning);\r\n\t}\r\n\r\n\tonWarningConfg = async () => {\r\n\t\tawait this.loadWarnings();\r\n\t\tthis.openVPage(VWarningConfig);\r\n\t}\r\n\r\n\tonSaveNewWarning = async (data: any) => {\r\n\t\tlet { id, type, price } = data;\r\n\t\t// let param = {\r\n\t\t//   user: this.cApp.user.id,\r\n\t\t//   stock: id,\r\n\t\t//   arr1: [\r\n\t\t//     { type: type, price: price }\r\n\t\t//   ]};\r\n\t\t//let ret = await this.uqs.mi.StockWarning.add(param);\r\n\t\t//await this.cApp.store.miApi.call('t_stockwarning$add', [this.cApp.user.id, id.id, type, price]);\r\n\t\tawait this.cApp.miNet.t_stockwarning$add(id.id, type, price);\r\n\t\tthis.closePage();\r\n\t}\r\n\r\n\tonSaveWarning = async (data: any) => {\r\n\r\n\t}\r\n\r\n\tshowSelectStock = async (context: Context, name: string, value: number): Promise<any> => {\r\n\t\tlet cStock = new CSelectStock(this.cApp);\r\n\t\treturn await cStock.call();\r\n\t}\r\n}","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport * as React from 'react';\r\nimport { observer } from 'mobx-react';\r\nimport RC2 from 'react-chartjs2'\r\nimport { VPage, Page, View, List, LMR, FA } from 'tonva-react';\r\nimport { CPredictHistory } from './CPredictHistory';\r\n\r\nexport class VPredictHistory extends VPage<CPredictHistory> {\r\n  async open(param?: any) {\r\n    this.openPage(this.page);\r\n  }\r\n\r\n  render(param: any): JSX.Element {\r\n    return <this.page />\r\n  }\r\n\r\n  private page = observer(() => {\r\n    return <Page header=\"预期收益比均值历史\">\r\n      <this.pageContent />\r\n    </Page>;\r\n  })\r\n\r\n  private pageContent = observer(() => {\r\n    return <>\r\n    <this.historyChart />\r\n    </>\r\n  });\r\n\r\n  protected historyChart = observer(() => {\r\n    let {items} = this.controller;\r\n    if (items === undefined) \r\n      return <></>;\r\n    let chartHistory = <></>;\r\n    let labelList:any[] = [];\r\n    let avg20List:number[] = [];\r\n    let avg50List:number[] = [];\r\n    let avg100List:number[] = [];\r\n    for (let item of items) {\r\n      let {day, avg20, avg50, avg100} = item;\r\n      labelList.push(day);\r\n      avg20List.push(avg20);\r\n      avg50List.push(avg50);\r\n      avg100List.push(avg100);\r\n    }\r\n    let chartdata1 = {\r\n      labels: labelList,\r\n      datasets: [\r\n        {\r\n          label: 'avg20',\r\n          data: avg20List,\r\n          borderColor:'blue',\r\n          backgroundColor:'skyBlue',\r\n          borderWidth: 1,\r\n          fill: false,\r\n          yAxisID: 'y-axis-1',\r\n        },\r\n        {\r\n          label: 'avg50',\r\n          data: avg50List,\r\n          borderColor:'red',\r\n          backgroundColor:'pink',\r\n          borderWidth: 1,\r\n          fill: false,\r\n          yAxisID: 'y-axis-1',\r\n        },\r\n        {\r\n          label: 'avg100',\r\n          data: avg100List,\r\n          borderColor:'DarkGreen',\r\n          backgroundColor:'green',\r\n          borderWidth: 1,\r\n          fill: false,\r\n          yAxisID: 'y-axis-1',\r\n        },\r\n      ]\r\n    };\r\n    let options = {\r\n      scales:{\r\n        yAxes: [{\r\n            type: 'linear',\r\n            display: true,\r\n            position: 'right',\r\n            id: 'y-axis-1',\r\n        }],       \r\n      }\r\n    }\r\n\r\n    chartHistory = <RC2 data={chartdata1} type='line' options={options}/>;\r\n    return <><LMR className=\"px-3 py-2 bg-white\" left={'历史走势'}></LMR>\r\n      <div className=\"px-3\" style={{width:'95%'}}>{chartHistory}</div>\r\n    </>;\r\n  });\r\n\r\n}","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport { observable, IObservableArray } from 'mobx';\r\nimport { CUqBase } from '../UqApp';\r\nimport { VPredictHistory } from './VPredictHistory'\r\n\r\nexport interface PredictHistoryParam {\r\n\tday?:number,\r\n\tpriceDay?:number,\r\n\tavg20?:number,\r\n\tavg50?:number,\r\n\tavg100?:number,\r\n\tavg?:number,\r\n}\r\n\r\ninterface PredictItem {\r\n\tday:number, \r\n\tavg20:number, \r\n\tavg50:number,\r\n\tavg100:number,\r\n\tavg?:number\r\n}\r\n\r\nexport class CPredictHistory extends CUqBase {\r\n\titems: IObservableArray<PredictItem> = observable.array<PredictItem>([], { deep: true });\r\n\tday: number;\r\n\tprotected lastItem: PredictItem;\r\n\r\n\tasync internalStart(param: any) {\r\n\t\tlet p = param as PredictHistoryParam;\r\n\t\tif (p !== undefined) {\r\n\t\tthis.day = p.day;\r\n\t\tif (p.priceDay !== undefined) {\r\n\t\t\tthis.lastItem = {day:p.priceDay, avg20:p.avg20, avg50:p.avg50, avg100:p.avg100};\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.lastItem = undefined;\r\n\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\tthis.day = undefined;\r\n\t\tthis.lastItem = undefined;\r\n\t\t}\r\n\t\tawait this.load();\r\n\t\tthis.openVPage(VPredictHistory as any);\r\n\t}\r\n\r\n\tasync load() {\r\n\t\t//let ret = await this.cApp.store.miApi.call('t_toppredictavg$query', [this.day]) as PredictItem[];\r\n\t\tlet ret:PredictItem[] = await this.cApp.miNet.t_toppredictavg$query(this.day);\r\n\t\tthis.items.clear();\r\n\t\tif (!Array.isArray(ret))\r\n\t\treturn;\r\n\t\tthis.items.push(...ret);\r\n\t\tif (this.lastItem !== undefined) {\r\n\t\tlet li = {...this.lastItem};\r\n\t\tthis.items.push(li);\r\n\t\t}\r\n\t}\r\n}","import { zh } from \"./zh\";\r\nimport { en } from \"./en\";\r\n\r\nexport const res = {\r\n\t$zh: zh,\r\n\t$en: en,\r\n}\r\n","export const zh = {\r\n\thome: '首页',\r\n\trelation: '关系',\r\n\tdiscover: '发现',\r\n\tme: '我的',\r\n\r\n\tchangePassword: '修改密码',\r\n\taboutTheApp: '关于APP',\r\n\tlogout: '退出登录',\r\n\tpleaseLogin: '登录',\r\n\r\n\tnotes: '小单',\r\n\ttask: '任务',\r\n\tassign: '作业单',\r\n\r\n\tnoteSpace: '群',\r\n\r\n\tnoteText: '文字单',\r\n\tnoteList: '列表单',\r\n\tnoteCheckable: '勾选单',\r\n\tnoteTask: '布置任务',\r\n\tnoteFolder: '小单夹',\r\n\tnoteCreateSpace: '新建群',\r\n\r\n\tcontent: '内容',\r\n}\r\n","export const en = {\r\n\thome: 'Home',\r\n\trelation: 'Relation',\r\n\tdiscover: 'Discover',\r\n\tme: 'Me',\r\n\r\n\tchangePassword: 'Change password',\r\n\taboutTheApp: 'About the APP',\r\n\tlogout: 'Logout',\r\n\tpleaseLogin: 'Login',\r\n\r\n\tnotes: 'Notes',\r\n\ttask: 'Task',\r\n\tassign: 'Assign',\r\n\r\n\tnoteSpace: 'Group',\r\n\r\n\tnoteText: 'Text',\r\n\tnoteList: 'List',\r\n\tnoteCheckable: 'Checkable',\r\n\tnoteTask: 'Task',\r\n\tnoteFolder: 'Folder',\r\n\tnoteCreateSpace: 'Create Group',\r\n\r\n\tcontent: 'Content',\r\n}\r\n","import { FA, List, LMR, VPage } from \"tonva-react\";\r\nimport { CHolding } from \"./CHolding\";\r\nimport { Account, AccountValue } from \"UqApp/uqs/BruceYuMi\";\r\n\r\nexport class VHolding extends VPage<CHolding> {\r\n\theader() {return <span className=\"ml-3\">持仓组合 <small className=\"text-muted\">正在设计实现中...</small></span>}\r\n\tcontent() {\r\n\t\treturn <div>\r\n\t\t\t<List items={this.controller.accounts} item={{render: this.renderAccount, onClick: this.onClickAccount}} />\r\n\t\t</div>;\r\n\t}\r\n\r\n\tprivate renderAccount = (item:Account&AccountValue, index:number):JSX.Element => {\r\n\t\tfunction renderValue(caption:string, value:number) {\r\n\t\t\treturn <span className=\"mr-3\"><small className=\"text-muted\">{caption}: </small>{value??0}</span>;\r\n\t\t}\r\n\t\tlet {name, mi, market, count} = item;\r\n\t\tlet right = <div className=\"px-2 d-flex align-items-center\">\r\n\t\t\t<FA className=\"align-\" name=\"angle-right\" />\r\n\t\t</div>;\r\n\t\treturn <LMR right={right}>\r\n\t\t\t<div className=\"px-3 py-2 bg-white d-block\">\r\n\t\t\t\t<div>{name}</div>\r\n\t\t\t\t<div className=\"mt-2\">\r\n\t\t\t\t\t<span className=\"mr-3 small\">共{count??0}只</span>\r\n\t\t\t\t\t{renderValue('总米值', mi as number)}\r\n\t\t\t\t\t{renderValue('总市值', market as number)}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</LMR>;\r\n\t}\r\n\r\n\tprivate onClickAccount = (item:Account&AccountValue) => {\r\n\t\tthis.controller.showAccount(item);\r\n\t}\r\n}","import { LMR, VPage } from \"tonva-react\";\r\nimport { CHolding } from \"./CHolding\";\r\n\r\nexport class VAccount extends VPage<CHolding> {\r\n\theader() {return this.controller.account.name}\r\n\tcontent() {\r\n\t\tfunction renderValue(caption:string, value:number) {\r\n\t\t\treturn <span className=\"mr-3\"><small className=\"text-muted\">{caption}: </small>{value??0}</span>;\r\n\t\t}\r\n\t\tlet {no, name, mi, market, count} = this.controller.account;\r\n\t\treturn <div className=\"mt-3 px-3 py-2 bg-white d-block\">\r\n\t\t\t<LMR right={<small className=\"text-muted\">组合编号: {no}</small>}>\r\n\t\t\t\t{name}\r\n\t\t\t</LMR>\r\n\t\t\t<div className=\"mt-2\">\r\n\t\t\t\t<span className=\"mr-3 small\">共{count??0}只</span>\r\n\t\t\t\t{renderValue('总米值', mi as number)}\r\n\t\t\t\t{renderValue('总市值', market as number)}\r\n\t\t\t</div>\r\n\t\t</div>;\r\n\t}\r\n}\r\n","import { makeObservable, observable } from \"mobx\";\r\nimport { ParamID, ParamIDinIX } from \"tonva-react\";\r\nimport { CApp, CUqBase } from \"UqApp\";\r\nimport { Account, AccountValue } from \"UqApp/uqs/BruceYuMi\";\r\nimport { VHolding } from \"./VHolding\";\r\nimport { VAccount } from \"./VAccount\";\r\n\r\nexport class CHolding extends CUqBase {\r\n\taccounts: (Account&AccountValue)[];\r\n\taccount: Account&AccountValue;\r\n\r\n\tconstructor(cApp: CApp) {\r\n\t\tsuper(cApp);\r\n\t\tmakeObservable(this, {\r\n\t\t\taccounts: observable,\r\n\t\t});\r\n\t}\r\n\r\n\tprotected async internalStart() {\r\n\t}\r\n\t\r\n\ttab = () => {\r\n\t\treturn this.renderView(VHolding);\r\n\t}\r\n\r\n\tload = async () => {\r\n\t\tlet {BruceYuMi} = this.uqs;\r\n\t\tlet {Account, UserAccount} = BruceYuMi;\r\n\t\tlet param:ParamIDinIX = {\r\n\t\t\tID: Account,\r\n\t\t\tIX: UserAccount,\r\n\t\t\tid: this.user.id,\r\n\t\t};\r\n\t\tlet ret = await BruceYuMi.IDinIX<Account>(param);\r\n\t\tif (ret.length === 0) {\r\n\t\t\t// 没有持仓账号，则创建默认账号\r\n\t\t\tlet accountNO = await BruceYuMi.IDNO({ID: Account});\r\n\t\t\tlet retActs = await BruceYuMi.IDActs({\r\n\t\t\t\taccount: [{\r\n\t\t\t\t\tid: undefined, \r\n\t\t\t\t\tno: accountNO, \r\n\t\t\t\t\tname: '我的持仓组合', \r\n\t\t\t\t}]\r\n\t\t\t});\r\n\t\t\tret = await BruceYuMi.IDinIX(param);\r\n\t\t}\r\n\t\tlet paramValue:ParamID = {\r\n\t\t\tIDX: BruceYuMi.AccountValue,\r\n\t\t\tid: ret.map(v => (v as unknown as Account).id),\r\n\t\t}\r\n\t\tlet values = await BruceYuMi.ID<AccountValue>(paramValue);\r\n\t\tthis.accounts = ret as unknown as (Account&AccountValue)[];\r\n\t\tthis.accounts.forEach(account => {\r\n\t\t\tlet {id} = account;\r\n\t\t\tlet value = values.find(v => v.id === id);\r\n\t\t\tif (value) {\r\n\t\t\t\tObject.assign(account, value);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tshowAccount = async (item:Account&AccountValue) => {\r\n\t\tthis.account = item;\r\n\t\tthis.openVPage(VAccount);\r\n\t};\r\n}\r\n","//=== UqApp builder created on Mon Mar 01 2021 15:27:12 GMT-0500 (GMT-05:00) ===//\r\nimport { VPage, TabCaptionComponent, TabProp, TabsProps } from 'tonva-react';\r\nimport { CApp } from './CApp';\r\n\r\nconst color = (selected: boolean) => selected === true ? 'text-primary' : 'text-muted';\r\n\r\nexport class VMain extends VPage<CApp> {\r\n\t/*\r\n\tasync open(param?: any) {\r\n\t\tthis.openPage(this.render);\r\n\t}\r\n\t*/\r\n\theader() {return false;}\r\n\r\n\tprotected get tabsProps(): TabsProps {\r\n\t\tlet { cHome, cHolding, cExporer, cMe } = this.controller;\r\n\t\tlet tabs: TabProp[] = [\r\n\t\t\t{ \r\n\t\t\t\tname: 'home', label: '首页', icon: 'home', content: cHome.tab, \r\n\t\t\t\tnotify: undefined, \r\n\t\t\t\tload: cHome.load, \r\n\t\t\t\tonShown: cHome.load,\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tname: 'explorer', label: '持仓', icon: 'money', content: cHolding.tab, load: cHolding.load \r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tname: 'explorer', label: '选股', icon: 'search', content: cExporer.tab, load: cExporer.load\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tname: 'me', label: '我的', icon: 'user', content: cMe.tab, onShown: undefined\r\n\t\t\t}\r\n\t\t].map(v => {\r\n\t\t\tlet { name, label, icon, content, notify, load, onShown } = v;\r\n\t\t\treturn {\r\n\t\t\t\tname,\r\n\t\t\t\tcaption: (selected: boolean) => TabCaptionComponent(label, icon, color(selected)),\r\n\t\t\t\tcontent,\r\n\t\t\t\tnotify,\r\n\t\t\t\tload,\r\n\t\t\t\tonShown,\r\n\t\t\t};\r\n\t\t});\r\n\t\treturn {tabs};\r\n\t}\r\n}\r\n","import {FetchError} from './fetchError';\r\nimport {HttpChannelUI} from './httpChannelUI';\r\nimport {nav} from 'tonva-react';\r\nimport { consts } from '../consts';\r\n\r\nexport async function httpGet(url:string, params?:any):Promise<any> {\r\n    let channel = new HttpChannel(url, undefined, undefined);\r\n    let ret = await channel.get('', params);\r\n    return ret;\r\n}\r\n\r\nexport async function httpPost(url:string, params?:any):Promise<any> {\r\n    let channel = new HttpChannel(url, undefined, undefined);\r\n    let ret = await channel.post('', params);\r\n    return ret;\r\n}\r\n\r\nexport class HttpChannel {\r\n    private hostUrl: string;\r\n    private apiToken: string;\r\n    private ui?: HttpChannelUI;\r\n    private timeout: number;\r\n\r\n    constructor(hostUrl: string, apiToken:string, ui?: HttpChannelUI) {\r\n        this.hostUrl = hostUrl;\r\n        this.apiToken = apiToken;\r\n        this.ui = ui;\r\n        this.timeout = consts.isDevelopment === true? 500000:20000;\r\n    }\r\n\r\n    private startWait = () => {\r\n        if (this.ui !== undefined) this.ui.startWait();\r\n    }\r\n\r\n    private endWait = (url?:string, reject?:(reason?:any)=>void) => {\r\n        if (this.ui !== undefined) this.ui.endWait();\r\n        if (reject !== undefined) reject('访问webapi超时 ' + url);\r\n    }\r\n\r\n    private showError = async (error:FetchError) => {\r\n        if (this.ui !== undefined) await this.ui.showError(error);\r\n    }\r\n\r\n    used() {\r\n        this.post('', {});\r\n    }\r\n\r\n    async get(url: string, params: any = undefined): Promise<any> {\r\n        if (params) {\r\n            let keys = Object.keys(params);\r\n            if (keys.length > 0) {\r\n                let c = '?';\r\n                for (let k of keys) {\r\n                    let v = params[k];\r\n                    if (v === undefined) continue;\r\n                    url += c + k + '=' + params[k];\r\n                    c = '&';\r\n                }\r\n            }\r\n        }\r\n        let options = this.buildOptions();\r\n        options.method = 'GET';\r\n        return await this.innerFetch(url, options);\r\n    }\r\n\r\n    async post(url: string, params: any): Promise<any> {\r\n        let options = this.buildOptions();\r\n        options.method = 'POST';\r\n        options.body = JSON.stringify(params);\r\n        return await this.innerFetch(url, options);\r\n    }\r\n\r\n    async put(url: string, params: any): Promise<any> {\r\n        let options = this.buildOptions();\r\n        options.method = 'PUT';\r\n        options.body = JSON.stringify(params);\r\n        return await this.innerFetch(url, options);\r\n    }\r\n\r\n    async delete(url: string, params: any): Promise<any> {\r\n        let options = this.buildOptions();\r\n        options.method = 'DELETE';\r\n        options.body = JSON.stringify(params);\r\n        return await this.innerFetch(url, options);\r\n    }\r\n    async fetch(url: string, options: any, resolve:(value?:any)=>any, reject:(reason?:any)=>void):Promise<void> {\r\n        let that = this;\r\n        this.startWait();\r\n        let path = url;\r\n        function buildError(err: string) {\r\n            return {\r\n                channel: that,\r\n                url: path,\r\n                options: options,\r\n                resolve: resolve,\r\n                reject: reject,\r\n                error: err,\r\n            }\r\n        }\r\n        try {\r\n            console.log('%s %s', options.method, path);\r\n            let timeOutHandler = setTimeout(() => that.endWait(url, reject), this.timeout);\r\n            let res = await fetch(encodeURI(path), options);\r\n            if (res.ok === false) {\r\n                clearTimeout(timeOutHandler);\r\n                that.endWait();\r\n                console.log('call error %s', res.statusText);\r\n                throw res.statusText;\r\n            }\r\n            let ct = res.headers.get('content-type');\r\n            if (ct && ct.indexOf('json')>=0) {\r\n                return res.json().then(async retJson => {\r\n                    clearTimeout(timeOutHandler);\r\n                    that.endWait();\r\n                    if (retJson.ok === true) {\r\n                        return resolve(retJson.res);\r\n                    }\r\n                    if (retJson.error === undefined) {\r\n                        await that.showError(buildError('not valid tonva json'));\r\n                    }\r\n                    else {\r\n                        await that.showError(buildError(retJson.error));\r\n                        reject(retJson.error);\r\n                    }\r\n                    //throw retJson.error;\r\n                }).catch(async error => {\r\n                    await that.showError(buildError(error.message));\r\n                });\r\n            }\r\n            else {\r\n                let text = await res.text();\r\n                clearTimeout(timeOutHandler);\r\n                that.endWait();\r\n                resolve(text);\r\n            }\r\n        }\r\n        catch(error) {\r\n            if (typeof error === 'string') {\r\n                if (error.toLowerCase().startsWith('unauthorized') === true) {\r\n                    nav.logout();\r\n                    return;\r\n                }\r\n            }\r\n            await this.showError(buildError(error.message));\r\n        };\r\n    }\r\n\r\n    private async innerFetch(url: string, options: any): Promise<any> {\r\n        let u = this.hostUrl + url;\r\n        return await new Promise<any>(async (resolve, reject) => {\r\n            await this.fetch(u, options, resolve, reject);\r\n        });\r\n    }\r\n\r\n    async callFetch(url:string, method:string, body:any):Promise<any> {\r\n        let options = this.buildOptions();\r\n        options.method = method;\r\n        options.body = body;\r\n        return await new Promise<any>(async (resolve, reject) => {\r\n            await this.fetch(url, options, resolve, reject);\r\n        });\r\n    }\r\n\r\n    private buildOptions(): any {\r\n        let {language, culture} = nav;\r\n        let headers = new Headers();\r\n        //headers.append('Access-Control-Allow-Origin', '*');\r\n        headers.append('Content-Type', 'application/json;charset=UTF-8');\r\n        let lang = language;\r\n        if (culture) lang += '-' + culture;\r\n        headers.append('Accept-Language', lang);\r\n        if (this.apiToken) { \r\n            headers.append('Authorization', this.apiToken); \r\n        }\r\n        let options = {\r\n            headers: headers,\r\n            // cache: 'no-cache',\r\n        };\r\n        return options;\r\n    }\r\n}\r\n","import {nav} from 'tonva-react';\r\n\r\nexport interface HttpChannelUI {\r\n    startWait():void;\r\n    endWait():void;\r\n    showError(error:any):Promise<void>;\r\n}\r\n\r\nexport class HttpChannelNavUI implements HttpChannelUI {\r\n    startWait() {\r\n        nav.startWait();\r\n    }\r\n    endWait() {\r\n        nav.endWait();\r\n    }\r\n    async showError(error:any):Promise<void> {\r\n        nav.endWait();\r\n        /*\r\n        if (error.name === 'SyntaxError') {\r\n            error = {\r\n                name: error.name,\r\n                message: error.message,\r\n            }\r\n        }*/\r\n        await nav.onError(error);\r\n    }\r\n}\r\n\r\n","//import {isDevelopment} from '../local';\r\nimport {HttpChannel} from './httpChannel';\r\n\r\nexport async function refetchApi(channel:HttpChannel, url, options, resolve, reject) {\r\n    await channel.fetch(url, options, resolve, reject);\r\n}\r\n\r\nexport abstract class ApiBase {\r\n    protected token: string;\r\n    protected path: string;\r\n    protected showWaiting: boolean;\r\n\r\n    constructor(path: string, showWaiting: boolean) {\r\n        this.path = path || '';\r\n        this.showWaiting = showWaiting;\r\n    }\r\n\r\n    protected abstract getHttpChannel(): Promise<HttpChannel>;\r\n\r\n    public async call(url:string, method:string, body:any):Promise<any> {\r\n        let channel = await this.getHttpChannel();\r\n        return await channel.callFetch(url, method, body);\r\n    }\r\n\r\n    public async get(path:string, params:any=undefined): Promise<any> {\r\n        let channel = await this.getHttpChannel();\r\n        return await channel.get(this.path + path, params);\r\n    }\r\n\r\n    public async post(path:string, params:any): Promise<any> {\r\n        let channel = await this.getHttpChannel();\r\n        return await channel.post(this.path + path, params);\r\n    }\r\n\r\n    public async put(path:string, params:any): Promise<any> {\r\n        let channel = await this.getHttpChannel();\r\n        return await channel.put(this.path + path, params);\r\n    }\r\n\r\n    public async delete(path:string, params:any): Promise<any> {\r\n        let channel = await this.getHttpChannel();\r\n        return await channel.delete(this.path + path, params);\r\n    }\r\n}\r\n","import _ from 'lodash';\r\nimport { HttpChannel } from './httpChannel';\r\nimport { HttpChannelNavUI } from './httpChannelUI';\r\nimport { ApiBase } from './apiBase';\r\n\r\nlet channelUIs: { [name: string]: HttpChannel } = {};\r\nlet channelNoUIs: { [name: string]: HttpChannel } = {};\r\n\r\nclass MiApiChannel extends ApiBase {\r\n\tprivate apiName: string;\r\n\turl: string;\r\n\r\n\tconstructor(url: string, basePath: string, apiName: string, uqToken: string, showWaiting?: boolean) {\r\n\t\tsuper(basePath, showWaiting);\r\n\t\tthis.showWaiting = showWaiting;\r\n\t\tthis.apiName = apiName;\r\n\t\tthis.token = uqToken;\r\n\t\tthis.url = url;\r\n\t}\r\n\r\n\tprotected async getHttpChannel(): Promise<HttpChannel> {\r\n\t\tlet channels: { [name: string]: HttpChannel };\r\n\t\tlet channelUI: HttpChannelNavUI;\r\n\t\tif (this.showWaiting === true || this.showWaiting === undefined) {\r\n\t\t\tchannels = channelUIs;\r\n\t\t\tchannelUI = new HttpChannelNavUI();\r\n\t\t}\r\n\t\telse {\r\n\t\t\tchannels = channelNoUIs;\r\n\t\t}\r\n\t\tlet channel = channels[this.apiName];\r\n\t\tif (channel !== undefined) return channel;\r\n\t\tchannel = new HttpChannel(this.url, this.token, channelUI);\r\n\t\treturn channels[this.apiName] = channel;\r\n\t}\r\n}\r\n\r\nexport class MiApi {\r\n\tprivate channel: MiApiChannel;\r\n\r\n\tconstructor(url: string, basePath: string, apiName: string, uqToken: string, showWaiting?: boolean) {\r\n\t\tthis.channel = new MiApiChannel(url, basePath, apiName, uqToken, showWaiting);\r\n\t}\r\n\r\n\tasync call(name: string, params: any[]): Promise<any> {\r\n\t\tlet pbody = { call: name, params: params };\r\n\t\treturn await this.channel.post('sql/call', pbody);\r\n\t}\r\n\r\n\tasync query(name: string, params: any[]): Promise<any> {\r\n\t\tlet pbody = { call: name, params: params };\r\n\t\treturn await this.channel.post('sql/call', pbody);\r\n\t}\r\n\r\n\tasync page(name: string, params: any[], pageStart: number, pageSize: number): Promise<any> {\r\n\t\tlet p: any[];\r\n\t\tswitch (typeof params) {\r\n\t\t\tcase 'undefined': p = []; break;\r\n\t\t\tdefault: p = _.clone(params); break;\r\n\t\t}\r\n\t\tp.push(pageStart);\r\n\t\tp.push(pageSize);\r\n\t\tlet pbody = { call: name, params: p };\r\n\t\treturn await this.channel.post('sql/call', pbody);\r\n\t}\r\n\r\n\tasync process(proc: any, params: any[]): Promise<any> {\r\n\t\tlet pbody = { proc: proc, params: params };\r\n\t\treturn await this.channel.post('sql/query', pbody);\r\n\t}\r\n}\r\n","import { consts } from \"consts\";\r\nimport { User } from \"tonva-react\";\r\nimport { MiApi } from \"./miApi\";\r\n\r\nexport class MiNet {\r\n\tprivate miApi: MiApi;\r\n\tprivate user: User;\r\n\r\n\tconstructor(user: User) {\r\n\t\tlet miHost = consts.miApiHost;\r\n\t\tif (document.baseURI.indexOf('localmiserver') > 0) {\r\n\t\t\tmiHost = consts.miApiHostDebug;\r\n\t\t}\r\n\t\tthis.user = user;\r\n\t\tthis.miApi = new MiApi(miHost, 'fsjs/', 'miapi', user.token, false);\r\n\t}\r\n\r\n\tget userId():number {return this.user.id;}\r\n\r\n\tasync process(proc:any, params:any[]) {\r\n\t\treturn await this.miApi.process(proc, params);\r\n\t}\r\n\r\n\tasync q_marketpe(param:any):Promise<{day:number, pe:number, e:number}[]> {\r\n\t\tlet rets = await this.miApi.query('q_marketpe', param) as {day:number, pe:number, e:number}[];\r\n\t\treturn rets;\r\n\t}\r\n\r\n\tasync t_toppredictavg$query(day:any):Promise<any[]> {\r\n\t\tlet ret = await this.miApi.call('t_toppredictavg$query', [day]);\r\n\t\treturn ret;\r\n\t}\r\n\r\n\tasync q_stocks$page(p:any, pageStart:any, pageSize:any):Promise<any> {\r\n\t\tlet ret = await this.miApi.page('q_stocks$page', p, pageStart, pageSize);\r\n\t\treturn ret;\r\n\t}\r\n\r\n\tasync q_stockallinfo(id:any, day:any) {\r\n\t\treturn this.miApi.query('q_stockallinfo', [id, day]);\r\n\t}\r\n\r\n\tasync t_tagstock$query(tagId:any, id:any) {\r\n\t\treturn this.miApi.query('t_tagstock$query', [this.user.id, tagId, id]) //this.uqs.mi.TagStock.query({ user: nav.user.id, stock: id })\r\n\t}\r\n\r\n\tasync t_tag$all() {\r\n\t\treturn await this.miApi.query('t_tag$all', [this.user.id]);\r\n\t}\r\n\r\n\tasync t_tag$save(name:string) {\r\n\t\treturn await this.miApi.call('t_tag$save', [this.user.id, undefined, name]);\r\n\t}\r\n\r\n\tasync t_tagstock$add(tagId:any, baseId:any) {\r\n\t\treturn await this.miApi.call('t_tagstock$add', [this.user.id, tagId, baseId]); //.uqs.mi.TagStock.add(param);\r\n\t}\r\n\r\n\tasync t_tagstock$del(tagId:any, baseId:any) {\r\n\t\treturn await this.miApi.call('t_tagstock$del', [this.user.id, tagId, baseId]); // //await this.uqs.mi.TagStock.del(param);\r\n\t}\r\n\r\n\tasync t_stockwarning$all() {\r\n\t\treturn await this.miApi.call('t_stockwarning$all', [this.user.id]);//await this.uqs.mi.StockWarningAll.query(undefined);\r\n\t}\r\n\r\n\tasync t_stockwarning$add(id:any, type:any, price:any) {\r\n\t\treturn await this.miApi.call('t_stockwarning$add', [this.user.id, id, type, price]);\r\n\t}\r\n\r\n\tasync t_usersettings$save(v:string) {\r\n\t\treturn await this.miApi.call('t_usersettings$save', [this.user.id, 'config', v]);\r\n\t}\r\n\r\n\tasync t_usersettings$query() {\r\n\t\treturn await this.miApi.query('t_usersettings$query', [this.user.id, 'config']);\r\n\t}\r\n\r\n\tasync t_allaccounts() {\r\n\t\treturn await this.miApi.query('t_allaccounts', [this.user.id]);\r\n\t}\r\n\r\n\tasync q_getlasttradeday() {\r\n\t\treturn await this.miApi.call('q_getlasttradeday', []);\r\n\t}\r\n}\r\n","import { VPage } from \"tonva-react\";\r\nimport { CGroup } from \"./CGroup\";\r\n\r\nexport class VGroup extends VPage<CGroup> {\r\n\theader() {return '自选组管理'}\r\n\tcontent() {\r\n\t\treturn <div className=\"p-3\">\r\n\t\t\t自选组管理\r\n\t\t</div>;\r\n\t}\r\n}","import { CUqBase } from \"UqApp\";\r\nimport { VGroup } from \"./VGroup\";\r\n\r\nexport class CGroup extends CUqBase {\r\n\tasync internalStart(param: any) {\r\n\t\tthis.openVPage(VGroup);\r\n\t}\r\n}\r\n","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport { Controller, VPage } from 'tonva-react';\r\nimport { CHome } from '../home';\r\nimport { CMe } from '../me';\r\nimport { CExplorer } from '../explorer';\r\nimport { CWarning } from '../warning';\r\nimport { CPredictHistory } from '../predicthistory';\r\nimport { CUqApp } from './CBase';\r\nimport { res } from './res';\r\nimport { CHolding } from 'holding';\r\nimport { VMain } from './VMain';\r\nimport { Store } from 'store';\r\nimport { MiNet } from '../net';\r\nimport { CGroup } from '../group';\r\n\r\nexport class CApp extends CUqApp {\r\n\tcHome: CHome;\r\n\tcHolding: CHolding;\r\n\tcExporer: CExplorer;\r\n\tcWarning: CWarning;\r\n\tcMe: CMe;\r\n\tmiNet: MiNet;\r\n\tstore: Store;\r\n\r\n\tprotected async internalStart() {\r\n\t\tthis.setRes(res);\r\n\r\n\t\tthis.miNet = new MiNet(this.user);\r\n\t\tthis.store = new Store(this.miNet);\r\n\t\tawait this.store.load();\r\n\t\t\r\n\t\tthis.cHome = this.newC(CHome);\r\n\t\tthis.cExporer = this.newC(CExplorer);\r\n\t\tthis.cHolding = this.newC(CHolding);\r\n\t\tthis.cMe = this.newC(CMe);\r\n\t\tthis.cWarning = this.newC(CWarning);\r\n\r\n\t\tthis.openVPage(VMain);\r\n\t}\r\n\r\n\topenPredictAVG(param:any) {\r\n\t\tlet pc = this.newC(CPredictHistory);\r\n\t\tpc.start(param);\r\n\t}\r\n\r\n\tasync showOneVPage(vp: new (coordinator: Controller) => VPage<Controller>, param?: any): Promise<void> {\r\n\t\tawait (new vp(this)).open(param);\r\n\t}\r\n\r\n\tprotected onDispose() {\r\n\t}\r\n\r\n\tshowGroupsManage() {\r\n\t\tlet cGroup = this.newC(CGroup);\r\n\t\tcGroup.start();\r\n\t}\r\n}\r\n","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport { VPage, List, LMR, SearchBox, Scroller } from 'tonva-react';\r\nimport { CSelectStock } from './CSelectStock'\r\n\r\nexport class VStockSelect extends VPage<CSelectStock> {\r\n\tprivate onClickStock = async (model: any) => {\r\n\t\tawait this.controller.returnStock(model);\r\n\t\tthis.closePage();\r\n\t}\r\n\r\n\theader() {return '选择股票'}\r\n\tget headerClassName() {return 'bg-primary'}\r\n\tprotected async onPageScrollBottom(scroller: Scroller) {\r\n\t\tawait this.controller.pageItems.more();\r\n\t}\r\n\r\n\tcontent() {\r\n\t\tlet { pageItems, searchByKey } = this.controller;\r\n\t\tlet none = <div className=\"p-3 small text-muted\">无结果</div>;\r\n\t\treturn <div>\r\n\t\t\t<SearchBox className=\"px-1 w-100  mt-2 mr-2\"\r\n\t\t\t\tsize='md'\r\n\t\t\t\tallowEmptySearch={true}\r\n\t\t\t\tonSearch={searchByKey}\r\n\t\t\t\tplaceholder=\"搜索股票\" />\r\n\t\t\t<List before={''} none={none} \r\n\t\t\t\titems={pageItems} \r\n\t\t\t\titem={{ render: this.renderStock, onClick: this.onClickStock }} />\r\n\t\t</div>\r\n\t}\r\n\r\n\tprivate renderStock = (stock: any, index: number) => {\r\n\t\tlet { name, code } = stock;\r\n\t\treturn <LMR className=\"px-3 py-2 \" >\r\n\t\t\t<div className=\"font-weight-bold\"></div>\r\n\t\t\t<div>{name + ' ' + code}</div>\r\n\t\t</LMR >\r\n\t}\r\n}","import { PageItems } from 'tonva-react';\r\nimport { Stock } from 'store';\r\nimport { MiNet } from '../net';\r\nimport { CUqBase } from '../UqApp';\r\nimport { VStockSelect } from './VSelectStock';\r\n\r\nclass PageStockItems<T> extends PageItems<T> {\r\n\tprivate miNet: MiNet;\r\n\r\n\tconstructor(miNet: MiNet) {\r\n\t\tsuper(true);\r\n\t\tthis.miNet = miNet;\r\n\t\tthis.firstSize = this.pageSize = 30;\r\n\t}\r\n\r\n\tprotected async loadResults(param: any, pageStart: any, pageSize: number): Promise<{\r\n\t\t\t[name: string]: any[];\r\n\t\t}> {\r\n\t\tif (pageStart === undefined) pageStart = 0;\r\n\t\tlet p = ['%' + param.key + '%'];\r\n\t\ttry {\r\n\t\t\t//let ret = await this.cStock.cApp.store.miApi.page('q_stocks$page', p, pageStart, pageSize);\r\n\t\t\tlet ret = await this.miNet.q_stocks$page(p, pageStart, pageSize);\r\n\t\t\treturn {$page: ret};\r\n\t\t}\r\n\t\tcatch (error) {\r\n\t\t\tlet e = error;\r\n\t\t\treturn undefined;\r\n\t\t}\r\n\t}\r\n\r\n\tprotected setPageStart(item: any): any {\r\n\t\tthis.pageStart = item === undefined ? 0 : item.id;\r\n\t}\r\n}\r\n\r\nexport class CSelectStock extends CUqBase {\r\n\tpageItems: PageStockItems<Stock>;\r\n\r\n\tasync internalStart(param: any) {\r\n\t\tthis.pageItems = new PageStockItems<any>(this.cApp.miNet);\r\n\t\tthis.openVPage(VStockSelect);\r\n\t}\r\n\r\n\tsearchByKey = async (key: string) => {\r\n\t\tthis.pageItems.first({ key: key });\r\n\t}\r\n\r\n\t//给调用页面返回id\r\n\treturnStock = async (item: any): Promise<any> => {\r\n\t\tthis.returnCall(item);\r\n\t}\r\n\r\n\tonPage = async () => {\r\n\t\tawait this.pageItems.more();\r\n\t}\r\n}\r\n","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport * as React from 'react';\r\nimport classNames from 'classnames';\r\nimport { VPage, Page, View, List, LMR, left0, FA } from 'tonva-react';\r\nimport { observable } from 'mobx';\r\nimport { observer } from 'mobx-react';\r\nimport RC2 from 'react-chartjs2'\r\nimport { GFunc } from '../tool/GFunc';\r\nimport { CStockInfo } from './CStockInfo'\r\nimport { NStockInfo, StockCapitalearning, StockBonus } from './StockInfoType';\r\nimport { ErForEarning, SlrForEarning } from 'regression';\r\n\r\nexport class VStockInfo extends VPage<CStockInfo> {\r\n\tprivate input: HTMLInputElement;\r\n\tprivate key: string = undefined;\r\n\r\n\tasync open(param?: any) {\r\n\t\tthis.openPage(this.page);\r\n\t}\r\n\r\n\t@observable protected ttmLimit:boolean = false;\r\n\r\n\trender(param: any): JSX.Element {\r\n\t\treturn this.page();\r\n\t}\r\n\r\n\tcheckLimitShow = (e)=> {\r\n\t\tlet check = e.target.checked as boolean;\r\n\t\tthis.ttmLimit = check;\r\n\t}\r\n\r\n\tcheckShowLater = (e)=> {\r\n\t\tlet check = e.target.checked as boolean;\r\n\t\tthis.controller.loadHistoryData(check);\r\n\t}\r\n\r\n\tcheckDefaultTag = (e)=> {\r\n\t\tlet check = e.target.checked as boolean;\r\n\t\tthis.controller.onClickDefaultTag(check);\r\n\t}\r\n\r\n\tprivate page = observer(() => {\r\n\t\tlet { openMetaView, baseItem, onSelectTag, stockTags, isLogined } = this.controller;\r\n\t\tlet { name, code, day } = baseItem;\r\n\t\tlet viewMetaButton = <></>;\r\n\t\tif (isLogined) {\r\n\t\tviewMetaButton = <button type=\"button\" className=\"btn w-100\" onClick={openMetaView}>view</button>\r\n\t\t}\r\n\t\tlet right = stockTags && <button \r\n\t\t\tclassName=\"btn btn-sm mr-2 btn-outline-success bg-light align-self-center\"\r\n\t\t\tonClick={onSelectTag}>\r\n\t\t{stockTags.length === 0? '加自选' : '设分组'}\r\n\t\t</button>;\r\n\t\tlet headStr = name + ' ' + code;\r\n\t\tif (day !== undefined) {\r\n\t\theadStr += ' - ' + day;\r\n\t\t}\r\n\tlet head = <div onClick={()=>this.controller.showSelectStock(day)}>{headStr}</div>\r\n\t\treturn <Page header={head} right={right}\r\n\t\theaderClassName='bg-primary'>\r\n\t\t{React.createElement(this.pageContent)}\r\n\t\t</Page>;\r\n\t})\r\n\r\n\tprivate pageContent = observer(() => {\r\n\t\treturn <>\r\n\t\t{this.dateHead()}\r\n\t\t{React.createElement(this.baseInfo)}\r\n\t\t{React.createElement(this.historyChart)}\r\n\t\t{React.createElement(this.predictInfo)}\r\n\t\t{React.createElement(this.predictSeasonEarning)}\r\n\t\t{React.createElement(this.seasonEarning)}\r\n\t\t{React.createElement(this.capitalEarning)}\r\n\t\t{React.createElement(this.bonus)}\r\n\t\t</>\r\n\t});\r\n\r\n\tprivate onChange = (evt: React.ChangeEvent<any>) => {\r\n\t\tlet v = evt.target.value;\r\n\t\tlet n = Number(v);\r\n\t\tif (isNaN(n) === true || !Number.isInteger(n)) {\r\n\t\tif (this.input) {\r\n\t\t\tthis.input.value = this.key;\r\n\t\t}\r\n\t\treturn;\r\n\t\t}\r\n\t\tthis.key = evt.target.value;\r\n\t\tif (this.key !== undefined) {\r\n\t\t\tthis.key = this.key.trim();\r\n\t\t\tif (this.key === '') this.key = undefined;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate onSubmit = async (evt: React.FormEvent<any>) => {\r\n\t\tevt.preventDefault();\r\n\t\tif (this.key === undefined) this.key = '';\r\n\t\tlet n = Number(this.key);\r\n\t\tif (!isNaN(n) && Number.isInteger((n))) {\r\n\t\tif (n ===0 || (n >= 20000101 && n < 30000101)) {\r\n\t\t\tawait this.controller.changeDay(n);\r\n\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\r\n\tprivate dateHead = () => {\r\n\t\tlet {day} = this.controller.baseItem;\r\n\t\tlet dayString = day === undefined || isNaN(day) ? '' : day.toString();\r\n\t\treturn <div className=\"px-3 py-2\">\r\n\t\t\t<form className=\"w-100\" onSubmit={this.onSubmit} >\r\n\t\t\t\t<div className=\"input-group input-group-sm\">\r\n\t\t\t\t\t<label className=\"input-group-addon mr-2 mb-0 align-self-center\">{'日期'}</label>\r\n\t\t\t\t\t<input ref={v=>this.input=v} onChange={this.onChange}\r\n\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\tname=\"key\"\r\n\t\t\t\t\t\t\tdefaultValue={dayString}\r\n\t\t\t\t\t\t\tclassName=\"form-control border-primary px-2\"\r\n\t\t\t\t\t\t\tplaceholder={'yyyymmdd'}\r\n\t\t\t\t\t\t\tmaxLength={8} />\r\n\t\t\t\t\t<div className=\"input-group-append\">\r\n\t\t\t\t\t\t\t<button className=\"btn btn-primary px-2\"\r\n\t\t\t\t\t\t\t\ttype=\"submit\">\r\n\t\t\t\t\t\t\t\t<i className='fa fa-search' />\r\n\t\t\t\t\t\t\t\t<i className=\"fa\"/>\r\n\t\t\t\t\t\t\t\t{'跳转'}\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</form>\r\n\t\t</div>;\r\n\t}\r\n\r\n\r\n\tprivate baseInfo = observer(() => {\r\n\t\tlet {baseItem, isMySelect} = this.controller;\r\n\t\tlet { id, name, code, symbol, pe, roe, price, order, divyield, e, capital, bonus } = baseItem;\r\n\r\n\t\t//let list = this.controller.cApp.store.defaultList;\r\n\t\t//let fInList = list.findIndex(v=>v===id) >= 0;\r\n\t\t//let fInList = this.controller.cApp.store.isMySelect(id);\r\n\t\tlet right = <label className=\"align-self-center px-3\"> <input type=\"checkbox\" name=\"checkDefaultList\" defaultChecked={isMySelect}\r\n\t\tonChange={this.checkDefaultTag} />自选股</label>;\r\n\t\treturn <LMR className=\"bg-white\" right={right}> <div className=\"px-3 py-2\" >\r\n\t\t<div className=\"d-flex flex-wrap\">\r\n\t\t\t<div className=\"px-3 c8\">{GFunc.caption('TTM')}{GFunc.numberToFixString(pe)}</div>\r\n\t\t\t<div className=\"px-3 c8\">{GFunc.caption('股息率')}{GFunc.percentToFixString(divyield)}</div>\r\n\t\t\t<div className=\"px-3 c8\">{GFunc.caption('ROE')}{GFunc.percentToFixString(roe)}</div>\r\n\t\t\t<div className=\"px-3 c8\">{GFunc.caption('价格')}{GFunc.numberToFixString(price)}</div>\r\n\t\t\t<a className=\"px-3 text-info\" href={`https://finance.sina.com.cn/realstock/company/${symbol}/nc.shtml`} target=\"_blank\" rel=\"noopener noreferrer\" onClick={(e) =>{e.stopPropagation() }}>新浪财经</a>\r\n\t\t</div>    \r\n\t\t</div>\r\n\t\t</LMR>;\r\n\t});\r\n\r\n\tprotected onClickName = async (item: NStockInfo) => {\r\n\t\tlet { symbol } = item;\r\n\t\tlet url = `http://finance.sina.com.cn/realstock/company/${symbol}/nc.shtml`;\r\n\t\tlet w = window.open(url, '');\r\n\t\tw.opener = undefined;\r\n\t}\r\n\r\n\tprotected historyChart = observer(() => {\r\n\t\tlet {historyData, baseItem} = this.controller;\r\n\t\tif (historyData === undefined) \r\n\t\treturn <></>;\r\n\t\tlet chartHistory = <></>;\r\n\t\tlet labelList:any[] = [];\r\n\t\tlet priceList:number[] = [];\r\n\t\tlet ttmList:number[] = [];\r\n\t\tfor (let item of historyData) {\r\n\t\tlet {day, price, ttm} = item;\r\n\t\tlabelList.push(day);\r\n\t\tpriceList.push(GFunc.numberToPrecision(price, 4));\r\n\t\tif (ttm <= 0) \r\n\t\t\tttmList.push(undefined);\r\n\t\telse {\r\n\t\t\tif (this.ttmLimit && ttm >= 35) {\r\n\t\t\tttmList.push(35);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\tttmList.push(GFunc.numberToPrecision(ttm, 4));\r\n\t\t\t}\r\n\t\t}\r\n\t\t}\r\n\t\tlet chartdata1 = {\r\n\t\tlabels: labelList,\r\n\t\tdatasets: [\r\n\t\t\t{\r\n\t\t\tlabel: '价格',\r\n\t\t\tdata: priceList,\r\n\t\t\tborderColor:'blue',\r\n\t\t\tbackgroundColor:'skyBlue',\r\n\t\t\tborderWidth: 1,\r\n\t\t\tfill: false,\r\n\t\t\tyAxisID: 'y-axis-1',\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\tlabel: 'TTM',\r\n\t\t\tdata: ttmList,\r\n\t\t\tborderColor:'red',\r\n\t\t\tbackgroundColor:'pink',\r\n\t\t\tborderWidth: 1,\r\n\t\t\tfill: false,\r\n\t\t\tyAxisID: 'y-axis-2',\r\n\t\t\t}\r\n\t\t]\r\n\t\t};\r\n\t\tlet options = {\r\n\t\tscales:{\r\n\t\t\tyAxes: [{\r\n\t\t\t\ttype: 'linear',\r\n\t\t\t\tdisplay: true,\r\n\t\t\t\tposition: 'left',\r\n\t\t\t\tid: 'y-axis-1',\r\n\t\t\t}, {\r\n\t\t\t\ttype: 'linear',\r\n\t\t\t\tdisplay: true,\r\n\t\t\t\tposition: 'right',\r\n\t\t\t\tid: 'y-axis-2',\r\n\t\t\t\tgridLines: {\r\n\t\t\t\t\tdrawOnChartArea: false\r\n\t\t\t\t}\r\n\t\t\t}],       \r\n\t\t}\r\n\t\t}\r\n\t\tchartHistory = <RC2 data={chartdata1} type='line' options={options} />;\r\n\t\tlet right = <></>;\r\n\t\tif (baseItem.day !== undefined) {\r\n\t\tright = <><label className=\"px-3\"> <input type=\"checkbox\" name=\"showLater\" defaultChecked={false}\r\n\t\t\t\tonChange={this.checkShowLater} />显示后面数据</label>\r\n\t\t\t<label className=\"px-3\"> <input type=\"checkbox\" name=\"selectType\" defaultChecked={this.ttmLimit}\r\n\t\t\tonChange={this.checkLimitShow} />限制TTM显示范围</label>\r\n\t\t\t</>;\r\n\r\n\t\t}\r\n\t\telse {\r\n\t\tright = <label className=\"px-3\"> <input type=\"checkbox\" name=\"selectType\" defaultChecked={this.ttmLimit}\r\n\t\t\tonChange={this.checkLimitShow} />限制TTM显示范围</label>;\r\n\t\t}\r\n\t\treturn <><LMR className=\"px-3 py-2 bg-white\" left={'历史走势'} right={right}></LMR>\r\n\t\t<div className=\"px-3\" style={{width:'95%'}}>{chartHistory}</div>\r\n\t\t</>;\r\n\t});\r\n\r\n\tprotected predictInfo = observer(() => {\r\n\t\tlet {predictData, ypredict} = this.controller;\r\n\t\tif (predictData === undefined) \r\n\t\treturn <></>;\r\n\t\tlet { e, b, r2, epre, l, lr2, lpre } = predictData;\r\n\t\tlet chart1 = <></>;\r\n\t\tif (ypredict.length === 5) {\r\n\t\tlet er = new ErForEarning(ypredict);\r\n\t\tlet chartdata1 = {\r\n\t\t\tlabels: ['0', '1', '2', '3', '4'],\r\n\t\t\tdatasets: [\r\n\t\t\t{\r\n\t\t\t\tlabel: '原值',\r\n\t\t\t\tdata: ypredict.map(v=>GFunc.numberToPrecision(v)),\r\n\t\t\t\tborderColor:'black',\r\n\t\t\t\tbackgroundColor:'skyBlue',\r\n\t\t\t\tshowLine: false,\r\n\t\t\t\tpointStyle: \"crossRot\",\r\n\t\t\t\tborderWidth: 1,\r\n\t\t\t\tpointRadius: 5,\r\n\t\t\t\tfill: false,\r\n\t\t\t} as any\r\n\t\t\t]\r\n\t\t};\r\n\t\tif (!(isNaN(er.B) || isNaN(er.A))) {\r\n\t\t\tlet per:number[] = [];\r\n\t\t\tfor (let i = 0; i < 5; ++i) {\r\n\t\t\tper.push(GFunc.numberToPrecision(er.predict(i), 4));\r\n\t\t\t}\r\n\t\t\tchartdata1.datasets.push(\r\n\t\t\t{\r\n\t\t\t\tlabel: '指数回归',\r\n\t\t\t\tdata: per,\r\n\t\t\t\tborderColor:'red',\r\n\t\t\t\tbackgroundColor:'pink',\r\n\t\t\t\tborderWidth: 1,\r\n\t\t\t\tfill: false,\r\n\t\t\t});\r\n\t\t}\r\n\t\tlet lr = new SlrForEarning(ypredict);\r\n\t\tif (!(isNaN(lr.slope) || isNaN(lr.intercept))) {\r\n\t\t\tlet plr:number[] = [];\r\n\t\t\tfor (let i = 0; i < 5; ++i) {\r\n\t\t\tplr.push(GFunc.numberToPrecision(lr.predict(i), 4));\r\n\t\t\t}\r\n\t\t\tchartdata1.datasets.push(\r\n\t\t\t{\r\n\t\t\t\tlabel: '线性回归',\r\n\t\t\t\tdata: plr,\r\n\t\t\t\tborderColor:'blue',\r\n\t\t\t\tbackgroundColor:'pink',\r\n\t\t\t\tborderWidth: 1,\r\n\t\t\t\tfill: false,\r\n\t\t\t});\r\n\t\t}\r\n\t\tchart1 = <RC2 data={chartdata1} type='line' />;\r\n\t\t}\r\n\t\tlet chart2 = this.predictChartFullInfo();\r\n\t\tlet chart3 = this.predictChartROE();\r\n\t\treturn <><div className=\"px-3 py-2 bg-white\">指数回归预测</div>\r\n\t\t<div className=\"d-flex flex-wrap\">\r\n\t\t\t<div className=\"px-3 c12\">{GFunc.caption('e')}{GFunc.numberToString(e, 4)}</div>\r\n\t\t\t<div className=\"px-3 c12\">{GFunc.caption('指数b')}{GFunc.numberToString(b, 4)}</div>\r\n\t\t\t<div className=\"px-3 c12\">{GFunc.caption('r2')}{GFunc.numberToString(r2, 4)}</div>\r\n\t\t\t<div className=\"px-3 c12\">{GFunc.caption('e预测')}{GFunc.numberToString(epre)}</div>\r\n\t\t</div>\r\n\t\t<div className=\"px-3 py-2 bg-white\">线性回归预测</div>\r\n\t\t<div className=\"d-flex flex-wrap\">\r\n\t\t<div className=\"px-3 c12\">{GFunc.caption('e')}{GFunc.numberToString(e, 4)}</div>\r\n\t\t\t<div className=\"px-3 c12\">{GFunc.caption('增长率')}{GFunc.numberToString(l, 4)}</div>\r\n\t\t\t<div className=\"px-3 c12\">{GFunc.caption('r2')}{GFunc.numberToString(lr2, 4)}</div>\r\n\t\t\t<div className=\"px-3 c12\">{GFunc.caption('e预测')}{GFunc.numberToString(lpre)}</div>\r\n\t\t</div>\r\n\t\t<div className=\"d-flex\">\r\n\t\t\t<div className=\"px-2\" style={{width:'50%'}}>{chart1}</div>\r\n\t\t\t<div className=\"px-2\" style={{width:'50%'}}>{chart2}</div>\r\n\t\t</div>\r\n\t\t<div className=\"d-flex\">\r\n\t\t\t<div className=\"px-2\" style={{width:'50%'}}>{chart3}</div>\r\n\t\t</div>\r\n\t\t</>;\r\n\t});\r\n\r\n\tprotected predictChartFullInfo = () => {\r\n\t\tlet { predictSeasonDataFull } = this.controller;\r\n\t\tlet len = predictSeasonDataFull.length;\r\n\t\tif (len <= 0)\r\n\t\treturn <></>;\r\n\t\tlet label = [];\r\n\t\tlet y:number[] = [];\r\n\t\tfor (let i = len - 1; i >= 0; --i) {\r\n\t\tlet item = predictSeasonDataFull[i];\r\n\t\tif (item.esum === undefined)\r\n\t\t\tcontinue;\r\n\t\tlabel.push(GFunc.SeasonnoToYearMonth(item.season));\r\n\t\ty.push(item.esum);\r\n\t\t}\r\n\r\n\t\tlet er = new ErForEarning(y);\r\n\t\tlet chartdataFull = {\r\n\t\tlabels: label,\r\n\t\tdatasets: [\r\n\t\t\t{\r\n\t\t\tlabel: '原值',\r\n\t\t\tdata: y.map(v=>GFunc.numberToPrecision(v)),\r\n\t\t\tborderColor:'black',\r\n\t\t\tbackgroundColor:'skyBlue',\r\n\t\t\tshowLine: false,\r\n\t\t\tpointStyle: \"crossRot\",\r\n\t\t\tborderWidth: 1,\r\n\t\t\tpointRadius: 5,\r\n\t\t\tfill: false,\r\n\t\t\t} as any\r\n\t\t]\r\n\t\t};\r\n\t\tif (!(isNaN(er.B) || isNaN(er.A))) {\r\n\t\tlet per:number[] = [];\r\n\t\tfor (let i = 0; i < len; ++i) {\r\n\t\t\tper.push(GFunc.numberToPrecision(er.predict(i), 4));\r\n\t\t}\r\n\t\tchartdataFull.datasets.push(\r\n\t\t\t{\r\n\t\t\tlabel: '指数 R2:' + GFunc.numberToString(er.r2, 4),\r\n\t\t\tdata: per,\r\n\t\t\tborderColor:'red',\r\n\t\t\tbackgroundColor:'pink',\r\n\t\t\tborderWidth: 1,\r\n\t\t\tfill: false,\r\n\t\t});\r\n\t\t}\r\n\t\tlet lr = new SlrForEarning(y);\r\n\t\tif (!(isNaN(lr.slope) || isNaN(lr.intercept))) {\r\n\t\tlet plr:number[] = [];\r\n\t\tfor (let i = 0; i < len; ++i) {\r\n\t\t\tplr.push(GFunc.numberToPrecision(lr.predict(i), 4));\r\n\t\t}\r\n\t\tchartdataFull.datasets.push(\r\n\t\t\t{\r\n\t\t\tlabel: '线性 R2:' + GFunc.numberToString(lr.r2, 4),\r\n\t\t\tdata: plr,\r\n\t\t\tborderColor:'blue',\r\n\t\t\tbackgroundColor:'pink',\r\n\t\t\tborderWidth: 1,\r\n\t\t\tfill: false,\r\n\t\t});\r\n\t\t}\r\n\t\treturn <RC2 data={chartdataFull} type='line' />;\r\n\t};\r\n\r\n\tprotected predictChartROE = () => {\r\n\t\tlet { predictSeasonDataFull } = this.controller;\r\n\t\tlet len = predictSeasonDataFull.length;\r\n\t\tif (len <= 0)\r\n\t\treturn <></>;\r\n\t\tlet label = [];\r\n\t\tlet y:number[] = [];\r\n\t\tfor (let i = len - 1; i >= 0; --i) {\r\n\t\tlet item = predictSeasonDataFull[i];\r\n\t\tif (item.esum === undefined)\r\n\t\t\tcontinue;\r\n\t\tlabel.push(GFunc.SeasonnoToYearMonth(item.season));\r\n\t\ty.push(item.esumorg / item.corg);\r\n\t\t}\r\n\r\n\t\tlet chartdataFull = {\r\n\t\tlabels: label,\r\n\t\tdatasets: [\r\n\t\t\t{\r\n\t\t\tlabel: 'ROE原值',\r\n\t\t\tdata: y.map(v=>GFunc.numberToPrecision(v)),\r\n\t\t\tborderColor:'black',\r\n\t\t\tbackgroundColor:'skyBlue',\r\n\t\t\tshowLine: false,\r\n\t\t\tpointStyle: \"crossRot\",\r\n\t\t\tborderWidth: 1,\r\n\t\t\tpointRadius: 5,\r\n\t\t\tfill: false,\r\n\t\t\t} as any\r\n\t\t]\r\n\t\t};\r\n\t\tlet lr = new SlrForEarning(y);\r\n\t\tif (!(isNaN(lr.slope) || isNaN(lr.intercept))) {\r\n\t\tlet plr:number[] = [];\r\n\t\tfor (let i = 0; i < len; ++i) {\r\n\t\t\tplr.push(Number.parseFloat(lr.predict(i).toPrecision(4)));\r\n\t\t}\r\n\t\tchartdataFull.datasets.push(\r\n\t\t\t{\r\n\t\t\tlabel: '线性 R2:' + GFunc.numberToString(lr.r2, 4),\r\n\t\t\tdata: plr,\r\n\t\t\tborderColor:'blue',\r\n\t\t\tbackgroundColor:'pink',\r\n\t\t\tborderWidth: 1,\r\n\t\t\tfill: false,\r\n\t\t});\r\n\t\t}\r\n\t\treturn <RC2 data={chartdataFull} type='line' />;\r\n\t};\r\n\r\n\tprivate predictSeasonEarning = observer(() => {\r\n\t\tlet items = this.controller.predictSeasonData;\r\n\t\tlet header = <div className=\"px-3\">\r\n\t\t<div className=\"px-3 c6\">年月</div>\r\n\t\t<div className=\"px-3 c6 text-right\">股本</div>\r\n\t\t<div className=\"px-3 c6 text-right\">季收益</div>\r\n\t\t<div className=\"px-3 c6 text-right\">年收益</div>\r\n\t\t<div className=\"px-3 c6 text-right\">ROE</div>\r\n\t\t<div className=\"px-3 c6 text-right\">股本o</div>\r\n\t\t<div className=\"px-3 c6 text-right\">季收益o</div>\r\n\t\t<div className=\"px-3 c6 text-right\">年收益o</div>\r\n\t\t</div>;\r\n\t\treturn <>\r\n\t\t<div className=\"px-3 py-1\">历年股本收益-用于回归计算</div>\r\n\t\t<List header={header} loading=\"...\"\r\n\t\t\titems={items}\r\n\t\t\titem={{\r\n\t\t\trender: (row: {season:number, c:number, e:number, esum:number, corg:number, eorg:number, esumorg:number}) => {\r\n\t\t\t\tlet {season, c, e, esum, corg, eorg, esumorg} = row;\r\n\t\t\t\tlet ym = GFunc.SeasonnoToYearMonth(season);\r\n\t\t\t\tlet a = 0;\r\n\t\t\t\treturn <div className=\"px-3 py-2 d-flex flex-wrap\">\r\n\t\t\t\t<div className=\"px-3 c6\">{ym.toString()}</div>\r\n\t\t\t\t<div className=\"px-3 c6 text-right\">{GFunc.numberToFixString(c)}</div>\r\n\t\t\t\t<div className=\"px-3 c6 text-right\">{GFunc.numberToFixString(e)}</div>\r\n\t\t\t\t<div className=\"px-3 c6 text-right\">{GFunc.numberToFixString(esum)}</div>\r\n\t\t\t\t<div className=\"px-3 c6 text-right\">{GFunc.percentToFixString(esum/c)}</div>\r\n\t\t\t\t<div className=\"px-3 c6 text-right\">{GFunc.numberToFixString(corg)}</div>\r\n\t\t\t\t<div className=\"px-3 c6 text-right\">{GFunc.numberToFixString(eorg)}</div>\r\n\t\t\t\t<div className=\"px-3 c6 text-right\">{GFunc.numberToFixString(esumorg)}</div>\r\n\t\t\t\t</div>\r\n\t\t\t}\r\n\t\t\t}}\r\n\t\t/>\r\n\t\t</>\r\n\t});\r\n\r\n\r\n\tprivate seasonEarning = observer(() => {\r\n\t\tlet items = this.controller.seasonData;\r\n\t\tlet header = <div className=\"px-3\">\r\n\t\t<div className=\"px-3 c6\">年月</div>\r\n\t\t<div className=\"px-3 c6 text-right\">股本</div>\r\n\t\t<div className=\"px-3 c6 text-right\">季收益</div>\r\n\t\t<div className=\"px-3 c6 text-right\">年收益</div>\r\n\t\t<div className=\"px-3 c6 text-right\">ROE</div>\r\n\t\t<div className=\"px-3 c6 text-right\">股本o</div>\r\n\t\t<div className=\"px-3 c6 text-right\">季收益o</div>\r\n\t\t<div className=\"px-3 c6 text-right\">年收益o</div>\r\n\t\t</div>;\r\n\t\treturn <>\r\n\t\t<div className=\"px-3 py-1\">历年季度股本收益</div>\r\n\t\t<List header={header} loading=\"...\"\r\n\t\t\titems={items}\r\n\t\t\titem={{\r\n\t\t\trender: (row: {season:number, c:number, e:number, esum:number, corg:number, eorg:number, esumorg:number}) => {\r\n\t\t\t\tlet {season, c, e, esum, corg, eorg, esumorg} = row;\r\n\t\t\t\tlet ym = GFunc.SeasonnoToYearMonth(season);\r\n\t\t\t\tlet a = 0;\r\n\t\t\t\treturn <div className=\"px-3 py-2 d-flex flex-wrap\">\r\n\t\t\t\t<div className=\"px-3 c6\">{ym.toString()}</div>\r\n\t\t\t\t<div className=\"px-3 c6 text-right\">{GFunc.numberToFixString(c)}</div>\r\n\t\t\t\t<div className=\"px-3 c6 text-right\">{GFunc.numberToFixString(e)}</div>\r\n\t\t\t\t<div className=\"px-3 c6 text-right\">{GFunc.numberToFixString(esum)}</div>\r\n\t\t\t\t<div className=\"px-3 c6 text-right\">{GFunc.percentToFixString(esum/c)}</div>\r\n\t\t\t\t<div className=\"px-3 c6 text-right\">{GFunc.numberToFixString(corg)}</div>\r\n\t\t\t\t<div className=\"px-3 c6 text-right\">{GFunc.numberToFixString(eorg)}</div>\r\n\t\t\t\t<div className=\"px-3 c6 text-right\">{GFunc.numberToFixString(esumorg)}</div>\r\n\t\t\t\t</div>\r\n\t\t\t}\r\n\t\t\t}}\r\n\t\t/>\r\n\t\t</>\r\n\t});\r\n\r\n\r\n\tprivate capitalEarning = observer(() => {\r\n\t\tlet items = this.controller.capitalearning;\r\n\t\tlet header = <div className=\"px-3\">\r\n\t\t<div className=\"px-3 c6\">年</div>\r\n\t\t<div className=\"px-3 c6 text-right\">股本</div>\r\n\t\t<div className=\"px-3 c6 text-right\">收益</div>\r\n\t\t<div className=\"px-3 c6 text-right\">ROE</div>\r\n\t\t</div>;\r\n\t\treturn <>\r\n\t\t<div className=\"px-3 py-1\">历年股本收益</div>\r\n\t\t<List header={header} loading=\"...\"\r\n\t\t\titems={items}\r\n\t\t\titem={{\r\n\t\t\trender: (row: StockCapitalearning) => {\r\n\t\t\t\tlet {capital, earning} = row;\r\n\t\t\t\treturn <div className=\"px-3 py-2 d-flex flex-wrap\">\r\n\t\t\t\t<div className=\"px-3 c6\">{row.year}</div>\r\n\t\t\t\t<div className=\"px-3 c6 text-right\"> {capital.toFixed(2)}</div>\r\n\t\t\t\t<div className=\"px-3 c6 text-right\"> {earning.toFixed(2)}</div>\r\n\t\t\t\t<div className=\"px-3 c6 text-right\"> {(earning/capital*100).toFixed(1)}%</div>\r\n\t\t\t\t</div>\r\n\t\t\t}\r\n\t\t\t}}\r\n\t\t/>\r\n\t\t</>\r\n\t});\r\n\r\n\tprivate bonus = observer(() => {\r\n\t\tlet items = this.controller.bonus;\r\n\t\tlet header = <div className=\"px-3\">\r\n\t\t<div className=\"px-3 c8\">日期</div>\r\n\t\t<div className=\"px-3 c6 text-right\">分红</div>\r\n\t\t</div>;\r\n\t\treturn <>\r\n\t\t<div className=\"px-3 py-1\">历年分红</div>\r\n\t\t<List header={header} loading=\"...\"\r\n\t\t\titems={items}\r\n\t\t\titem={{\r\n\t\t\trender: (row: StockBonus) => {\r\n\t\t\t\treturn <div className=\"px-3 py-2 d-flex flex-wrap\">\r\n\t\t\t\t<div className=\"px-3 c8\">{row.day}</div>\r\n\t\t\t\t<div className=\"px-3 c6 text-right\"> {row.bonus.toFixed(2)}</div>\r\n\t\t\t\t</div>\r\n\t\t\t}\r\n\t\t\t}}\r\n\t\t/>\r\n\t\t</>\r\n\t});\r\n}","import { defaultBlackListGroupName, defaultGroupName } from \"consts\";\r\nimport { IObservableArray, observable } from \"mobx\";\r\nimport { MiNet } from \"../net\";\r\nimport { StockGroup } from \"./stockGroup\";\r\n\r\nexport class StockGroups {\r\n\tprivate miNet: MiNet;\r\n\treadonly groups: IObservableArray<StockGroup>;\r\n\tdefaultGroup: StockGroup;\r\n\tblackGroup: StockGroup;\r\n\r\n\tconstructor(miNet: MiNet) {\r\n\t\tthis.miNet = miNet;\r\n\t\tthis.groups = observable.array<StockGroup>([], { deep: true });\r\n\t}\r\n\r\n\tasync init() {\r\n\t\tthis.defaultGroup = this.groupFromName(defaultGroupName);\r\n\t\tthis.blackGroup = this.groupFromName(defaultBlackListGroupName);\r\n\t\tawait Promise.all([\r\n\t\t\tthis.defaultGroup?.loadItems(),\r\n\t\t\tthis.blackGroup?.loadItems(),\r\n\t\t]);\r\n\t}\r\n\t\r\n\tgroupFromName(groupName:string) {\r\n\t\treturn this.groups.find(v => v.name === groupName);\r\n\t}\r\n\r\n\tgroupFromId(id:number) {\r\n\t\treturn this.groups.find(v => v.id === id);\r\n\t}\r\n\r\n\tget group0() {return this.groups[0]}\r\n\r\n\tgetSelected(tags:{tag:number}[]) {\r\n\t\tlet ret = this.groups.filter(v => {\r\n\t\t\tlet i = tags.findIndex(st => st.tag === v.id);\r\n\t\t\treturn i >= 0;\r\n\t\t});\r\n\t\treturn ret;\r\n\t}\r\n\r\n\tadd(group: StockGroup) {\r\n\t\tthis.groups.push(group);\r\n\t}\r\n\r\n\texists(id:number, name:string): boolean {\r\n\t\treturn this.groups.findIndex(v => v.id === id && v.name === name) >= 0;\r\n\t}\r\n\t\r\n\tisMySelect(id:number): boolean {\r\n\t\tfor (let group of this.groups) {\r\n\t\t\tif (group.exists(id) === true) return true;\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\t\r\n\tisMyBlack(id:number): boolean {\r\n\t\tif (!this.blackGroup) return false;\r\n\t\treturn this.blackGroup.exists(id);\r\n\t}\r\n\r\n\tasync load(): Promise<void> {\r\n\t\tlet r = await this.miNet.t_tag$all();\r\n\t\tlet ret = r as any[];\r\n\t\tlet bc = await this.checkDefaultTags(ret);\r\n\t\tif (bc) {\r\n\t\t\t//r = await this.miApi.query('t_tag$all', [this.user.id]);\r\n\t\t\tr = await this.miNet.t_tag$all();\r\n\t\t\tret = r as any[];\r\n\t\t}\r\n\t\tlet r1 = [];\r\n\t\tlet i = ret.findIndex(v=>v.name === defaultGroupName);\r\n\t\tif (i >= 0) {\r\n\t\t\tr1.push(ret[i]);\r\n\t\t\tret.splice(i, 1);\r\n\t\t}\r\n\t\ti = ret.findIndex(v=> v.name === defaultBlackListGroupName);\r\n\t\tif (i >= 0) {\r\n\t\t\tr1.push(ret[i]);\r\n\t\t\tret.splice(i, 1);\r\n\t\t}\r\n\t\tr1.push(...ret);\r\n\t\tthis.groups.replace(r1.map(v => new StockGroup(v.name, v.id, this.miNet)));\r\n\t}\r\n\r\n\tprivate async checkDefaultTags(list:any[]): Promise<boolean> {\r\n\t\tlet br = false;\r\n\t\tif (list === undefined) {\r\n\t\t\tawait this.miNet.t_tag$save(defaultGroupName);\r\n\t\t\tawait this.miNet.t_tag$save(defaultBlackListGroupName);\r\n\t\t\tbr = true;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tlet i = list.findIndex(v => v.name === defaultGroupName);\r\n\t\t\tif (i < 0) {\r\n\t\t\t\tawait this.miNet.t_tag$save(defaultGroupName);\r\n\t\t\t\tbr = true;\r\n\t\t\t}\r\n\t\t\ti = list.findIndex(v => v.name === defaultBlackListGroupName);\r\n\t\t\tif (i < 0) {\r\n\t\t\t\tawait this.miNet.t_tag$save(defaultBlackListGroupName);\r\n\t\t\t\tbr = true;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn br;\r\n\t}\r\n}\r\n","import { IObservableArray, observable, runInAction } from \"mobx\";\r\nimport { SlrForEarning } from \"regression\";\r\nimport { GFunc } from \"tool\";\r\nimport { MiNet } from \"../net\";\r\nimport { sortStocks } from \"./sortStocks\";\r\nimport { Stock } from \"./types\";\r\n\r\nexport class StockGroup {\r\n\tprivate miNet: MiNet;\r\n\tprivate sortType: string;\r\n\r\n\tid: number;\r\n\tname: string;\r\n\tstocks: IObservableArray<Stock>;\r\n\r\n\tconstructor(groupName:string, groupId:number, miNet: MiNet) {\r\n\t\tthis.name = groupName;\r\n\t\tthis.id = groupId;\r\n\t\tthis.miNet = miNet;\r\n\t\tthis.stocks = observable.array<Stock>([], { deep: true });\r\n\t}\r\n\r\n\tasync loadItems() {\r\n\t\t// 距离上次\r\n\t\tlet queryName = 'taguser';\r\n\r\n\t\tlet query = {\r\n\t\t\tname: queryName,\r\n\t\t\tpageStart: 0,\r\n\t\t\tpageSize: 1000,\r\n\t\t\tuser: this.miNet.userId,\r\n\t\t\ttag: this.id,\r\n\t\t\tyearlen: 1,\r\n\t\t};\r\n\t\tlet result = await this.miNet.process(query, []);\r\n\t\tif (Array.isArray(result) === false) return;\r\n\r\n\t\tlet arr: Stock[] = result;\r\n\t\tfor (let item of arr) {\r\n\t\t\tlet dataArray = JSON.parse(item.data) as number[];\r\n\t\t\titem.dataArr = dataArray;\r\n\t\t\tlet sl = new SlrForEarning(dataArray);\r\n\t\t\titem.ep = (sl.predict(4) + item.e) / 2;\r\n\t\t\titem.e3 = sl.predict(7);\r\n\t\t\titem.v = GFunc.calculateVN(sl.slopeR, item.ep, item.divyield * item.price, item.exprice);\r\n\t\t\titem.predictpe = item.price / item.e3;\r\n\t\t}\r\n\t\tsortStocks(undefined, arr);\r\n\r\n\t\trunInAction(() => {\r\n\t\t\tthis.stocks.clear();\r\n\t\t\tthis.stocks.push(...arr);\t\r\n\t\t});\r\n\t}\r\n\r\n\tsort(sortType: string) {\r\n\t\tthis.sortType = sortType;\r\n\t\tsortStocks(sortType, this.stocks);\r\n\t}\r\n\r\n\tasync addStock(stock: Stock) {\r\n\t\tawait this.miNet.t_tagstock$add(this.id, stock.id);\r\n\t\tlet index = this.stocks.findIndex(v => v.id === stock.id);\r\n\t\tif (index >= 0) {\r\n\t\t\tlet rows = this.stocks.splice(index, 1);\r\n\t\t\tthis.stocks.unshift(rows[0]);\r\n\t\t}\r\n\t\telse {\r\n\t\t\t// 重新加载stock的其它值\r\n\t\t\t// await ...\r\n\t\t\t//this.stocks.unshift(stock);\r\n\t\t\tawait this.loadItems();\r\n\t\t\tsortStocks(this.sortType, this.stocks);\r\n\t\t}\r\n\t}\r\n\r\n\tasync removeStock(stock: Stock) {\r\n\t\tawait this.miNet.t_tagstock$del(this.id, stock.id);\r\n\t\tlet index = this.stocks.findIndex(v => v.id === stock.id);\r\n\t\tif (index >= 0) this.stocks.splice(index, 1);\r\n\t}\r\n\r\n\texists(stockId: number): boolean {\r\n\t\tfor (let stock of this.stocks) {\r\n\t\t\tif (stock.id === stockId) return true;\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n}\r\n","import { UqExt as Uq } from './BruceYuMi';\r\nimport * as Account from './Account.ui';\r\nimport * as Holding from './Holding.ui';\r\nimport * as Transaction from './Transaction.ui';\r\nimport * as Stock from './Stock.ui';\r\nimport * as Market from './Market.ui';\r\nimport * as Portfolio from './Portfolio.ui';\r\nimport * as StockValue from './StockValue.ui';\r\nimport * as AccountValue from './AccountValue.ui';\r\nimport * as UserAccount from './UserAccount.ui';\r\n\r\nexport function setUI(uq: Uq) {\r\n\tObject.assign(uq.Account, Account);\r\n\tObject.assign(uq.Holding, Holding);\r\n\tObject.assign(uq.Transaction, Transaction);\r\n\tObject.assign(uq.Stock, Stock);\r\n\tObject.assign(uq.Market, Market);\r\n\tObject.assign(uq.Portfolio, Portfolio);\r\n\tObject.assign(uq.StockValue, StockValue);\r\n\tObject.assign(uq.AccountValue, AccountValue);\r\n\tObject.assign(uq.UserAccount, UserAccount);\r\n}\r\nexport * from './BruceYuMi';\r\n","export * from './StockInfoType';\r\nexport { CStockInfo } from './CStockInfo';\r\nexport { VStockInfo } from './VStockInfo';"],"sourceRoot":""}