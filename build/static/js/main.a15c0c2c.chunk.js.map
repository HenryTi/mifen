{"version":3,"sources":["stockinfo/VTags.tsx","stockinfo/CStockInfo.tsx","UqApp/uqs/BruceYuMi/Account.ui.tsx","UqApp/uqs/BruceYuMi/Holding.ui.tsx","UqApp/uqs/BruceYuMi/Transaction.ui.tsx","UqApp/uqs/BruceYuMi/Stock.ui.tsx","UqApp/uqs/BruceYuMi/Market.ui.tsx","UqApp/uqs/BruceYuMi/Portfolio.ui.tsx","UqApp/uqs/BruceYuMi/StockValue.ui.tsx","UqApp/uqs/BruceYuMi/AccountValue.ui.tsx","UqApp/uqs/BruceYuMi/UserAccount.ui.tsx","consts.ts","regression/SlrForEarning.ts","regression/ErForEarning.ts","App.tsx","reportWebVitals.ts","index.tsx","UqApp/CBase.ts","images/logo.svg","home/VSiteHeader.tsx","home/VSearchHeader.tsx","tool/render.tsx","tool/func.ts","home/VHome.tsx","home/VSelectTag.tsx","home/VMarketPE.tsx","home/CMarketPE.tsx","home/CHome.tsx","me/VEditMe.tsx","me/VFaq.tsx","me/VMe.tsx","me/CMe.ts","net/httpChannel.ts","net/httpChannelUI.ts","net/apiBase.ts","net/miApi.ts","explorer/VSiteHeader.tsx","explorer/VExplorer.tsx","explorer/VExplorerCfg.tsx","explorer/CExplorer.tsx","warning/VWarningConfig.tsx","warning/CWarning.tsx","predicthistory/VPredictHistory.tsx","predicthistory/CPredictHistory.tsx","UqApp/res/index.ts","UqApp/res/zh.ts","UqApp/res/en.ts","holding/VHolding.tsx","holding/VAccount.tsx","holding/CHolding.ts","UqApp/VMain.tsx","UqApp/CApp.ts","appConfig.ts","stockinfo/VStockInfo.tsx","UqApp/uqs/BruceYuMi/index.ts","stock/VSelectStock.tsx","stock/CStock.tsx","stockinfo/index.ts","tool/GFunc.tsx"],"names":["VTags","onSelect","item","isSelected","anySelected","controller","onClickSelectTag","onEditTag","tag","e","preventDefault","renderTag","left","className","name","right","defaultBlackListTagName","defaultTagName","onClick","page","observer","selectedTags","tags","cApp","divNewTag","length","onNewTag","header","headerClassName","items","render","selectedItems","param","a","this","openPage","VPage","schema","type","required","maxLength","uiSchema","widget","label","placeholder","id","visible","submit","VNewTag","onFormButtonClick","context","onSaveNewTag","data","closePage","formData","undefined","onButtonClick","VEditTag","onSaveTag","fData","CStockInfo","exrightForEarning","exrightInfo","historyDataOrg","_capitalearning","observable","array","deep","_bonus","_divideInfo","loadData","loading","baseItem","day","Promise","all","miApi","query","user","rets","stockTags","ret","Array","isArray","arr1","price","clear","arr2","push","arr3","arr4","loadTTMEarning","LoadHistoryData","loaded","openMetaView","onSelectTag","filter","v","findIndex","st","openVPage","call","retId","alert","i","nav","stock","newTag","AddTagStockID","splice","RemoveTagStockID","onClickDefaultTag","tagid","defaultListTagID","showSelectStock","cStock","CStock","b","changeDay","code","symbol","ni","makeObservable","list","seasonData","seasonlist","len","minNo","seasonno","lastItem","maxNo","GFunc","SeasonnoToBeginEnd","end","no","sItem","season","c","capital","es","esum","earning","corg","eorg","esumorg","ExrightEarning","si","pastitem","noBegin","predictData","predictSeasonData","predictSeasonDataFull","ypredict","x","er","ErForEarning","lr","SlrForEarning","B","r2","epre","predict","l","slopeR","lr2","lpre","endDay","exitem","factor","showAll","historyData","endIndex","lastdayno","dayno","lastDay","not","historyList","RestorePrice","ttm","CalculateHistoryPE","dayFrom","dayIndex","bsum","pricere","bonus","factore","SeasonnoFromDay","VStockInfo","CUqBase","computed","fields","fieldArr","ui","res","zh","en","JSON","stringify","account","holding","tick","quantity","amount","market","currency","miRate","divident","roe","inc1","inc2","inc3","inc4","preInc","marketValue","mi","count","id2","consts","uqBasedata","appIcon","miApiHost","miApiHostDebug","isDevelopment","process","y","slope","intercept","endY","regress","score","n","xSum","ySum","xSquared","xY","numerator","ym","y2","chi2","rmsd","ySquared","yi2","yi","yiyi2","r","Math","sqrt","A","yx","log","exp","App","onLogined","start","CApp","appConfig","React","Component","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","StrictMode","document","getElementById","CBase","CUqApp","CSub","init","CAppBase","VSiteHeader","src","logo","alt","style","height","width","renderSearchHeader","View","VSearchHeader","onSearch","key","size","renderSortCol","radioName","sortMethod","caption","sort","checked","defaultChecked","renderSortHeaders","role","aria-label","renderValue","value","valueType","vStr","_cn","cn","isNaN","toFixed","percent1","number","round","toString","numberToMarketValue","renderStockInfoRow","row","onClickName","inputSelect","inputSelectSpan","pe","divyield","order","total","ep","e3","zzl","funcz","p","calculateZZ3","dataArr","rows","map","renderStockUrl","href","target","rel","stopPropagation","w","VHome","setSortType","renderRow","index","rowContent","rowKey","openStockInfo","onSelected","clickRow","callOnSelected","openMarketPE","scroller","onPage","title","config","tagName","onAddStock","inverse","before","none","VSelectTag","onClickTag","VMarketPE","input","checkLimitShow","f","onLongShortFlag","head","pageContent","historyChart","chartHistory","labelList","peList","eList","numberToPrecision","chartdata1","labels","datasets","borderColor","backgroundColor","borderWidth","fill","yAxisID","options","scales","yAxes","display","position","gridLines","drawOnChartArea","onChange","CMarketPE","longshortFlag","dt","Date","getFullYear","getMonth","getDate","reverse","CHome","lastLoadTick","userTag","oldSortType","loadItems","selectTag","onWarningConfg","cWarning","load","tagID","now","setUserSortType","arr","slice","sortStocks","replace","renderSiteHeader","renderView","renderHome","tab","newC","stockID","pageStart","pageSize","yearlen","result","dataArray","parse","sl","calculateVN","exprice","predictpe","o","runInAction","VEditMe","props","nick","icon","onItemChanged","itemSchema","newValue","preValue","userApi","userSetProp","saveLocalUser","VFaq","VMe","onExit","showLogout","changePassword","meInfo","showEditMe","userSpan","String","substr","faq","t","aboutRows","component","iconClass","text","app","version","logout","logOutRows","bk","values","CMe","unitOwner","rootUnits","HttpChannel","hostUrl","apiToken","timeout","startWait","endWait","url","reject","showError","error","post","params","keys","Object","k","buildOptions","method","innerFetch","body","resolve","buildError","err","channel","that","path","console","timeOutHandler","setTimeout","fetch","encodeURI","ok","clearTimeout","statusText","ct","headers","get","indexOf","json","retJson","catch","message","toLowerCase","startsWith","u","language","culture","Headers","append","lang","HttpChannelNavUI","onError","channelUIs","channelNoUIs","MiApiChannel","basePath","apiName","uqToken","showWaiting","token","channels","channelUI","getHttpChannel","callFetch","put","delete","MiApi","pbody","_","clone","proc","VExplorer","onClickPredictAVG","avgs","priceDay","lastTradeDay","avg20","avg50","avg100","avg","openPredictAVG","blackList","labelId","fInDef","defaultList","middle","onSelectItem","onClickItem","onConfig","avgHead","reload","avgStr","numberToFixString","irate","bmin","bmax","lmin","lmax","lr4","mcount","r210","VExplorerCfg","sortChage","newType","setStockSortType","selectChange","setStockSelectType","cfg","setRegressionConfig","findStockConfg","regression","CExplorer","oldSelectType","disposeAutorun","autorun","newSelectType","stockFind","selectType","queryName","blackID","blackListTagID","bMin","bMax","lMin","lMax","lastDayRet","CalculateValueAvg","VWarningConfig","warnings","onNewWarning","renderWarning","witem","warningTypeString","VNewWarning","newuiSchema","pickId","Templet","onSaveNewWarning","CWarning","loadWarnings","onSaveWarning","_cApp","VPredictHistory","avg20List","avg50List","avg100List","CPredictHistory","li","$zh","home","relation","discover","me","aboutTheApp","pleaseLogin","notes","task","assign","noteSpace","noteText","noteList","noteCheckable","noteTask","noteFolder","noteCreateSpace","content","$en","VHolding","renderAccount","onClickAccount","showAccount","accounts","VAccount","CHolding","BruceYuMi","uqs","Account","UserAccount","ID","IX","IDinIX","IDNO","accountNO","IDActs","paramValue","IDX","AccountValue","forEach","find","color","selected","VMain","cHome","cHolding","cExporer","cMe","tabs","notify","onShown","TabCaptionComponent","tabsProps","getsortFunc","sortType","userStock","saveConfig","selectAccount","accountName","setRes","isLogined","miHost","loadConfig","loadTags","loadAccounts","cStr","loadBlackList","loadDefaultList","checkDefaultTags","r1","br","blackid","AddBlackID","AddDefaultID","stockIDs","RemoveBlackID","RemoveDefaultID","vp","open","dev","alias","noUnit","tvs","oem","htmlTitle","check","ttmLimit","checkShowLater","checkDefaultTag","headStr","dateHead","baseInfo","predictInfo","predictSeasonEarning","seasonEarning","capitalEarning","evt","Number","isInteger","trim","onSubmit","dayString","ref","defaultValue","fInList","percentToFixString","window","opener","priceList","ttmList","chart1","showLine","pointStyle","pointRadius","per","plr","chart2","predictChartFullInfo","chart3","predictChartROE","numberToString","SeasonnoToYearMonth","chartdataFull","parseFloat","toPrecision","capitalearning","year","setUI","uq","Holding","Transaction","Stock","Market","Portfolio","StockValue","VStockSelect","onClickStock","model","returnStock","customer","pageItems","onScrollBottom","allowEmptySearch","searchByKey","renderStock","PageStockItems","cs","firstSize","PageItems","first","returnCall","more","precision","iRate","e1","e2","r3","z","pow","floor","month","s","begin","calcuOne","sum"],"mappings":"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","file":"static/js/main.a15c0c2c.chunk.js","sourcesContent":["import * as React from 'react';\r\nimport { observer } from 'mobx-react-lite';\r\nimport { VPage, Page, FA, List, Form, ItemSchema, StringSchema, UiInputItem, UiSchema, Context, IdSchema, UiIdItem, LMR } from 'tonva-react';\r\nimport { CStockInfo } from './CStockInfo';\r\nimport { defaultBlackListTagName, defaultTagName } from '../consts';\r\n\r\nexport class VTags extends VPage<CStockInfo> {\r\n  async open(param?: any) {\r\n    this.openPage(this.page);\r\n  }\r\n\r\n  private onSelect = (item: any, isSelected: boolean, anySelected: boolean) => {\r\n    this.controller.onClickSelectTag(item, isSelected);\r\n  }\r\n\r\n  private onEditTag = (tag:any, e:React.MouseEvent) => {\r\n    e.preventDefault();\r\n    this.controller.onEditTag(tag);\r\n  }\r\n\r\n  private renderTag = (tag: any) => {\r\n    let left = <div className=\"px-3 py-2 cursor-pointer\">{tag.name}</div>;\r\n    let fdTag = tag.name === defaultBlackListTagName || tag.name === defaultTagName;\r\n    let right = fdTag ? '' : <div className=\"px-3 py-2 cursor-pointer\" onClick={(e)=>this.onEditTag(tag, e)}>编辑</div>;\r\n    return <LMR className=\"mx-3 my-2\" left={left} right={right}>\r\n    </LMR>;\r\n  }\r\n\r\n  private page = observer(() => {\r\n    let { selectedTags } = this.controller;\r\n    let { tags } = this.controller.cApp;\r\n    let divNewTag = tags.length >= 10 ? '' :\r\n      <div className=\"px-3 py-2 cursor-pointer\" onClick={this.controller.onNewTag}><FA name=\"plus\" className=\"text-primary\" /> &nbsp; 新建分组</div>;\r\n    return <Page header=\"选择分组\" headerClassName=\"bg-primary\">\r\n      {divNewTag}\r\n      <List items={tags} item={{ onSelect: this.onSelect, render: this.renderTag }} selectedItems={selectedTags} />\r\n    </Page>;\r\n  })\r\n}\r\n\r\nconst schema: ItemSchema[] = [\r\n  { name: 'name', type: 'string', required: true, maxLength: 10 } as StringSchema,\r\n  { name: 'id', type: 'id' } as IdSchema,\r\n  { name: 'submit', type: 'submit', },\r\n];\r\nconst uiSchema: UiSchema = {\r\n  items: {\r\n    name: { widget: 'text', label: null, placeholder: '分组名称' } as UiInputItem,\r\n    id: { widget: 'id', visible: false } as UiIdItem,\r\n    submit: { widget: 'button', label: '保存', className: 'btn btn-primary' },\r\n  }\r\n};\r\n\r\nexport class VNewTag extends VPage<CStockInfo> {\r\n  async open(param?: any) {\r\n    this.openPage(this.page);\r\n  }\r\n\r\n  private onFormButtonClick = async (name: string, context: Context) => {\r\n    if (await this.controller.onSaveNewTag(context.data)) {\r\n      this.controller.closePage();\r\n    }\r\n  }\r\n\r\n  private page = () => {\r\n    return <Page header=\"新建分组\" headerClassName=\"bg-primary\">\r\n      <div className=\"px-3 py-3\">\r\n        <Form schema={schema}\r\n          uiSchema={uiSchema}\r\n          formData={undefined}\r\n          onButtonClick={this.onFormButtonClick}\r\n        />\r\n      </div>\r\n    </Page>;\r\n  }\r\n}\r\n\r\nexport class VEditTag extends VPage<CStockInfo> {\r\n  async open(param?: any) {\r\n    this.openPage(this.page, param);\r\n  }\r\n\r\n  private onFormButtonClick = async (name: string, context: Context) => {\r\n    if (await this.controller.onSaveTag(context.data)) {\r\n      this.controller.closePage();\r\n    }\r\n  }\r\n\r\n  private page = (param?: any) => {\r\n    let {id, name} = param;\r\n    let fData = {id:id, name:name};\r\n    return <Page header=\"编辑分组\" headerClassName=\"bg-primary\">\r\n      <div className=\"px-3 py-3\">\r\n        <Form schema={schema}\r\n          uiSchema={uiSchema}\r\n          formData={fData}\r\n          onButtonClick={this.onFormButtonClick}\r\n        />\r\n      </div>\r\n    </Page>;\r\n  }\r\n}\r\n","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport { observable, IObservableArray, computed, makeObservable } from 'mobx';\r\nimport { nav } from 'tonva-react';\r\nimport { CUqBase } from '../UqApp';\r\nimport { GFunc } from '../tool/GFunc';\r\nimport { VStockInfo } from './VStockInfo'\r\nimport { NStockInfo, StockPrice, StockEarning, StockRoe, StockCapitalearning, StockBonus, StockDivideInfo } from './StockInfoType';\r\nimport { VTags, VNewTag, VEditTag } from './VTags';\r\nimport { ErForEarning, SlrForEarning } from 'regression';\r\nimport { CStock } from 'stock/CStock';\r\n\r\nexport class CStockInfo extends CUqBase {\r\n\r\n  constructor(cApp: any) {\r\n    super(cApp);\r\n    makeObservable(this);\r\n  }\r\n  @observable baseItem: NStockInfo;\r\n  @observable protected loaded: boolean = false;\r\n\r\n  @observable price: StockPrice;\r\n  //@observable roe: StockRoe;\r\n  //@observable tags: any[] = undefined;\r\n  @observable stockTags: any[];\r\n  selectedTags: any[];\r\n\r\n  protected exrightForEarning: {day:number, factor:number}[] = [];\r\n  protected exrightInfo: {day:number, bonus:number, factor:number, factore:number}[] = [];\r\n  @observable seasonData:{season:number, c:number, e:number, esum:number, corg:number, eorg:number, esumorg:number}[] = [];\r\n  @observable predictSeasonData:{season:number, c:number, e:number, esum:number, corg:number, eorg:number, esumorg:number}[] = [];\r\n  @observable predictSeasonDataFull:{season:number, c:number, e:number, esum:number, corg:number, eorg:number, esumorg:number}[] = [];\r\n  @observable predictData: { e:number, b: number, r2: number, epre:number, l:number, lr2:number, lpre:number};\r\n  @observable ypredict: number[] = [];\r\n  @observable historyData:{day:number, price:number, ttm:number}[] =  [];\r\n  protected historyDataOrg:{day:number, price:number, dayno:number}[] = [];\r\n\r\n  //protected _earning: IObservableArray<StockEarning> = observable.array<StockEarning>([], { deep: true });\r\n  protected _capitalearning: IObservableArray<StockCapitalearning> = observable.array<StockCapitalearning>([], { deep: true });\r\n  protected _bonus: IObservableArray<StockBonus> = observable.array<StockBonus>([], { deep: true });\r\n  protected _divideInfo: IObservableArray<StockDivideInfo> = observable.array<StockDivideInfo>([], { deep: true });\r\n\r\n  // @computed get earning(): IObservableArray<StockEarning> {\r\n  //   if (this.loaded === false) return undefined;\r\n  //   return this._earning;\r\n  // }\r\n\r\n  @computed get capitalearning(): IObservableArray<StockCapitalearning> {\r\n    if (this.loaded === false) return undefined;\r\n    return this._capitalearning;\r\n  }\r\n\r\n  @computed get bonus(): IObservableArray<StockBonus> {\r\n    if (this.loaded === false) return undefined;\r\n    return this._bonus;\r\n  }\r\n\r\n  @computed get divideInfo(): IObservableArray<StockDivideInfo> {\r\n    if (this.loaded === false) return undefined;\r\n    return this._divideInfo;\r\n  }\r\n\r\n  loadData = () => {\r\n    this.loading();\r\n  }\r\n\r\n  loading = async () => {\r\n    if (!this.baseItem)\r\n      return;\r\n    let { id, day } = this.baseItem;\r\n    let rets = await Promise.all([\r\n      this.cApp.miApi.query('q_stockallinfo', [id, day]),\r\n      this.cApp.miApi.query('t_tagstock$query', [this.user.id, undefined, id]) //this.uqs.mi.TagStock.query({ user: nav.user.id, stock: id })\r\n    ]);\r\n    this.stockTags = rets[1];\r\n    let ret = rets[0];\r\n    if (Array.isArray(ret[0])) {\r\n      let arr1 = ret[1];\r\n      if (Array.isArray(arr1)) {\r\n        this.price = arr1[0];\r\n      }\r\n\r\n      if (this._capitalearning.length > 0) {\r\n        this._capitalearning.clear();\r\n      }\r\n      let arr2 = ret[2];\r\n      if (Array.isArray(arr2)) {\r\n        this._capitalearning.push(...arr2);\r\n      }\r\n\r\n      this._bonus.clear();\r\n      let arr3 = ret[3];\r\n      if (Array.isArray(arr3)) {\r\n        this._bonus.push(...arr3);\r\n      }\r\n\r\n      this._divideInfo.clear();\r\n      let arr4 = ret[4];\r\n      if (Array.isArray(arr4)) {\r\n        this._divideInfo.push(...arr4);\r\n      }\r\n\r\n      this.exrightForEarning = ret[5];\r\n      await this.loadTTMEarning(ret[6]);\r\n      this.exrightInfo = ret[7];\r\n\r\n      this.historyDataOrg = ret[8];\r\n      this.LoadHistoryData(false);\r\n    }\r\n\r\n    this.loaded = true;\r\n  }\r\n\r\n  protected async loadTTMEarning(list: {seasonno:number, capital:number, earning:number, es:number}[]) {\r\n    this.seasonData.splice(0);\r\n    let seasonlist: {[index:number]:{season:number, c:number, e:number, esum:number, corg:number, eorg:number, esumorg:number}} = {};\r\n    let len = list.length;\r\n    if (len <= 0)\r\n      return;\r\n    let minNo = list[len - 1].seasonno;\r\n    let lastItem = list[0];\r\n    let maxNo = lastItem.seasonno;\r\n\r\n    let {end} = GFunc.SeasonnoToBeginEnd(maxNo);\r\n    for (let item of list) {\r\n      let no = item.seasonno;\r\n      let sItem = {season:no, c: item.capital, e: item.es, esum: item.earning, corg: item.capital, eorg: item.es, esumorg: item.earning}\r\n      this.ExrightEarning(end, no, sItem);\r\n      seasonlist[no] = sItem;\r\n    }\r\n\r\n    let i = 0;\r\n    let esum = 0;\r\n    for (let seasonno = minNo; seasonno <= maxNo; ++seasonno, ++i) {\r\n      let si = seasonlist[seasonno];\r\n      if (si === undefined) {\r\n        continue;\r\n      }\r\n      esum += si.e;\r\n      if (i < 3) {\r\n        si.esum = undefined;\r\n      }\r\n      else {\r\n        si.esum = esum;\r\n        let pastitem = seasonlist[seasonno-3];\r\n        if (pastitem !== undefined) {\r\n          esum -= pastitem.e;\r\n        }\r\n      }\r\n      this.seasonData.splice(0,0, si);\r\n    }\r\n\r\n    let noBegin = maxNo - 19;\r\n    this.predictData = undefined;\r\n    this.predictSeasonData.splice(0);\r\n    this.predictSeasonDataFull.splice(0);\r\n    if (noBegin < minNo)\r\n      return;\r\n    noBegin += 3;\r\n    this.ypredict = [];\r\n    for (let x = noBegin; x <= maxNo; x += 4) {\r\n      let item = seasonlist[x];\r\n      if (item === undefined)\r\n        break;\r\n      this.predictSeasonData.splice(0, 0, item);\r\n      this.ypredict.push(item.esum);\r\n    }\r\n\r\n    for (let x = maxNo; x >= minNo; x -= 4) {\r\n      let item = seasonlist[x];\r\n      if (item === undefined)\r\n        break;\r\n      this.predictSeasonDataFull.push(item);\r\n    }\r\n    if (this.ypredict.length === 5) {\r\n      let er = new ErForEarning(this.ypredict);\r\n      let lr = new SlrForEarning(this.ypredict);\r\n      this.predictData = {e:this.ypredict[4], b: er.B, r2: er.r2, epre: er.predict(4), l: lr.slopeR, lr2: lr.r2, lpre: lr.predict(4)};\r\n    }\r\n    else {\r\n      this.predictSeasonData.splice(0);\r\n    }\r\n  }\r\n\r\n  protected ExrightEarning(endDay:number, season:number, item:{c:number, e:number, esum:number}) {\r\n    let {end} = GFunc.SeasonnoToBeginEnd(season);\r\n    for (let i = 0; i < this.exrightForEarning.length; ++i) {\r\n      let exitem = this.exrightForEarning[i];\r\n      let day = exitem.day;\r\n      if (day > endDay)\r\n        break;\r\n      else if (day < end)\r\n        continue;\r\n      else {\r\n        let factor = exitem.factor;\r\n        item.c = item.c * factor;\r\n        item.e = item.e * factor;\r\n        item.esum = item.esum * factor;\r\n      }\r\n    }\r\n  }\r\n\r\n  LoadHistoryData(showAll:boolean) {\r\n    let list = this.historyDataOrg;\r\n    let length = list.length;\r\n    if (length <= 10) {\r\n      this.historyData = [];\r\n      return;\r\n    }\r\n    if (!showAll) {\r\n      let day = this.baseItem.day;\r\n      if (day !== undefined) {\r\n        let i = length - 1;\r\n        for (; i >= 0; --i) {\r\n          let item = list[i];\r\n          if (item.day <= day) {\r\n            break;\r\n          }\r\n        }\r\n        length = i + 1;\r\n      }\r\n    }\r\n    let endIndex = length - 1;\r\n    let lastItem = list[endIndex];\r\n    let lastdayno = lastItem.dayno;\r\n    if (lastdayno === undefined) {\r\n      while (endIndex > 0) {\r\n        --endIndex;\r\n        lastItem = list[endIndex];\r\n        lastdayno = lastItem.dayno;\r\n        if (lastdayno !== undefined)\r\n          break;\r\n      }\r\n    }\r\n    let lastDay = lastItem.day;\r\n    let not = lastdayno % 5;\r\n    let historyList: any[] = [];\r\n    for (let i = 0; i <= endIndex; ++i) {\r\n      let {day, price, dayno} = list[i];\r\n      if ( dayno % 5 === not) {\r\n        historyList.push({day:day, price:this.RestorePrice(price, day, lastDay), ttm:this.CalculateHistoryPE(price, day)});\r\n      }\r\n    }\r\n    this.historyData = historyList;\r\n  }\r\n\r\n  RestorePrice(price:number, dayFrom:number, dayIndex:number) {\r\n    let bsum = 0;\r\n    let pricere = price;\r\n    if (dayFrom < dayIndex) {\r\n      for (let i = 0; i < this.exrightInfo.length; ++i) {\r\n        let {day, bonus, factor, factore} = this.exrightInfo[i];\r\n        if (day <= dayFrom)\r\n          continue;\r\n        if (day > dayIndex)\r\n          break;\r\n        pricere = pricere * factor;\r\n        bsum = (bsum + bonus) * factore;\r\n      }\r\n      pricere = pricere - bsum;\r\n    }\r\n    else {\r\n      for (let i = 0; i < this.exrightInfo.length; ++i) {\r\n        let {day, bonus, factor, factore} = this.exrightInfo[i];\r\n        if (day <= dayIndex)\r\n          continue;\r\n        if (day > dayFrom)\r\n          break;\r\n        pricere = pricere / factor;\r\n        bsum = bsum / factore + bonus;\r\n      }\r\n      pricere = pricere + bsum;\r\n    }\r\n    return pricere;\r\n  }\r\n\r\n  CalculateHistoryPE(price:number, day:number) {\r\n    let season = GFunc.SeasonnoFromDay(day);\r\n    let len = this.seasonData.length;\r\n    for (let i = 0; i < len; ++i) {\r\n      let item = this.seasonData[i];\r\n      if (item.season >= season) {\r\n        continue;\r\n      }\r\n\r\n      if (item.esumorg === undefined)\r\n        return undefined;\r\n\r\n      let {end} = GFunc.SeasonnoToBeginEnd(item.season);\r\n      let pricere = this.RestorePrice(price, day, end);\r\n      return pricere / item.esumorg;\r\n    }\r\n\r\n    return undefined;\r\n  }\r\n\r\n  async internalStart(param: any) {\r\n    this.baseItem = param as NStockInfo;\r\n    this.loadData();\r\n    this.openVPage(VStockInfo);\r\n  }\r\n\r\n  openMetaView = () => {\r\n  }\r\n\r\n  onSelectTag = async () => {\r\n    //await this.loadTags();\r\n    this.selectedTags = this.cApp.tags.filter(v => {\r\n      let i = this.stockTags.findIndex(st => st.tag === v.id);\r\n      return i >= 0;\r\n    });\r\n    //await this.loadTags();\r\n    this.openVPage(VTags);\r\n  }\r\n\r\n  onNewTag = () => {\r\n    this.openVPage(VNewTag);\r\n  }\r\n\r\n  onEditTag = (param: any) => {\r\n    this.openVPage(VEditTag, param);\r\n  }\r\n\r\n  onSaveNewTag = async (data: any) => {\r\n    let { name } = data;\r\n    //let param = { id: undefined, name: name };\r\n    let ret = await this.cApp.miApi.call('t_tag$save', [this.user.id, undefined, name]);\r\n    let { retId } = ret;\r\n    if (retId < 0) {\r\n      alert(name + ' 已经被使用了');\r\n      return false;\r\n    }\r\n    this.cApp.tags.push({ id: retId, name: name });\r\n    return true;\r\n  }\r\n\r\n  onSaveTag = async (data: any) => {\r\n    let { id, name } = data;\r\n    let param = { id: id, name: name };\r\n    let i = this.cApp.tags.findIndex(v => v.id !== id && v.name === name);\r\n    if (i >= 0) {\r\n      alert(name + ' 已经被使用了');\r\n      return false;\r\n    }\r\n    let ret = await this.cApp.miApi.call('t_tag$save', [this.user.id, undefined, name]);\r\n    let { retId } = ret;\r\n    if (retId === undefined || retId < 0) {\r\n      alert(name + ' 已经被使用了');\r\n      return false;\r\n    }\r\n    i = this.cApp.tags.findIndex(v => v.id === id);\r\n    if (i >= 0) {\r\n      this.cApp.tags[i].name = name;\r\n    }\r\n    return true;\r\n  }\r\n\r\n  onClickSelectTag = async (tag: any, isSelected: boolean) => {\r\n    let param = {\r\n      user: nav.user.id,\r\n      tag: tag.id,\r\n      arr1: [\r\n        { stock: this.baseItem.id }\r\n      ]\r\n    };\r\n    if (isSelected === true) {\r\n      let ret = await this.cApp.miApi.call('t_tagstock$add', [this.user.id, tag.id, this.baseItem.id]); //.uqs.mi.TagStock.add(param);\r\n      let newTag = {\r\n        tag: {\r\n          id: tag.id,\r\n        }\r\n      }\r\n      this.stockTags.push(newTag);\r\n      await this.cApp.AddTagStockID(tag.id, this.baseItem.id);\r\n    }\r\n    else {\r\n      let ret = await this.cApp.miApi.call('t_tagstock$del', [this.user.id, tag.id, this.baseItem.id]); // //await this.uqs.mi.TagStock.del(param);\r\n      let i = this.stockTags.findIndex(v => v.tag.id === tag.id);\r\n      this.stockTags.splice(i, 1);\r\n      await this.cApp.RemoveTagStockID(tag.id, this.baseItem.id);\r\n    }\r\n  }\r\n\r\n  onClickDefaultTag = async (isSelected: boolean) => {\r\n    let tagid = this.cApp.defaultListTagID;\r\n    if (isSelected === true) {\r\n      let ret = await this.cApp.miApi.call('t_tagstock$add', [this.user.id, tagid, this.baseItem.id]); //.uqs.mi.TagStock.add(param);\r\n      let newTag = {\r\n        tag: {\r\n          id: tagid,\r\n        }\r\n      }\r\n      this.stockTags.push(newTag);\r\n      await this.cApp.AddTagStockID(tagid, this.baseItem.id);\r\n    }\r\n    else {\r\n      let ret = await this.cApp.miApi.call('t_tagstock$del', [this.user.id, tagid, this.baseItem.id]); // //await this.uqs.mi.TagStock.del(param);\r\n      let i = this.stockTags.findIndex(v => v.tag.id === tagid);\r\n      this.stockTags.splice(i, 1);\r\n      await this.cApp.RemoveTagStockID(tagid, this.baseItem.id);\r\n    }\r\n  }\r\n\r\n  showSelectStock = async (day:number): Promise<any> => {\r\n    let cStock = new CStock(this.cApp);\r\n    let item = await cStock.call() as any;\r\n    let b = {...item}\r\n    b.day = day;\r\n    this.baseItem = b;\r\n    this.loaded = false;\r\n    await this.loading();\r\n  }\r\n\r\n  changeDay = async (day:number) => {\r\n    if (this.baseItem.day === day)\r\n      return;\r\n    let {id, name, code, symbol} = this.baseItem;\r\n    let ni = {id:id, name:name, code:code, symbol:symbol, day:day ===0 ? undefined : day};\r\n    this.baseItem = ni;\r\n    this.loaded = false;\r\n    await this.loading();\r\n  }\r\n}\r\n","import { Res, UI } from \"tonva-react\";\r\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\nimport { FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-react\";\r\nimport { Account } from \"./BruceYuMi\";\r\n\r\n/*--fields--*/\r\nconst fields = {\r\n\tid: {\r\n\t\t\"name\": \"id\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": false,\r\n\t\t\"label\": \"Id\"\r\n\t} as FieldItemId,\r\n\tno: {\r\n\t\t\"name\": \"no\",\r\n\t\t\"type\": \"string\",\r\n\t\t\"isKey\": true,\r\n\t\t\"widget\": \"string\",\r\n\t\t\"label\": \"No\"\r\n\t} as FieldItemString,\r\n\tname: {\r\n\t\t\"name\": \"name\",\r\n\t\t\"type\": \"string\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"string\",\r\n\t\t\"label\": \"Name\"\r\n\t} as FieldItemString,\r\n};\r\n/*==fields==*/\r\n\r\nexport const fieldArr: FieldItem[] = [\r\n\tfields.no, fields.name, \r\n];\r\n\r\nexport const ui: UI = {\r\n\tlabel: \"Account\",\r\n\tfieldArr,\r\n\tfields,\r\n};\r\n\r\nexport const res: Res<any> = {\r\n\tzh: {\r\n\t},\r\n\ten: {\r\n\t}\r\n};\r\n\r\nexport function render(item: Account):JSX.Element {\r\n\treturn <>{JSON.stringify(item)}</>;\r\n};\r\n","import { Res, UI } from \"tonva-react\";\r\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\nimport { FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-react\";\r\nimport { Holding } from \"./BruceYuMi\";\r\n\r\n/*--fields--*/\r\nconst fields = {\r\n\tid: {\r\n\t\t\"name\": \"id\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": false,\r\n\t\t\"label\": \"Id\"\r\n\t} as FieldItemId,\r\n\taccount: {\r\n\t\t\"name\": \"account\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": true,\r\n\t\t\"label\": \"Account\"\r\n\t} as FieldItemId,\r\n\tstock: {\r\n\t\t\"name\": \"stock\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": true,\r\n\t\t\"label\": \"Stock\"\r\n\t} as FieldItemId,\r\n};\r\n/*==fields==*/\r\n\r\nexport const fieldArr: FieldItem[] = [\r\n\tfields.account, fields.stock, \r\n];\r\n\r\nexport const ui: UI = {\r\n\tlabel: \"Holding\",\r\n\tfieldArr,\r\n\tfields,\r\n};\r\n\r\nexport const res: Res<any> = {\r\n\tzh: {\r\n\t},\r\n\ten: {\r\n\t}\r\n};\r\n\r\nexport function render(item: Holding):JSX.Element {\r\n\treturn <>{JSON.stringify(item)}</>;\r\n};\r\n","import { Res, UI } from \"tonva-react\";\r\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\nimport { FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-react\";\r\nimport { Transaction } from \"./BruceYuMi\";\r\n\r\n/*--fields--*/\r\nconst fields = {\r\n\tid: {\r\n\t\t\"name\": \"id\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": false,\r\n\t\t\"label\": \"Id\"\r\n\t} as FieldItemId,\r\n\tholding: {\r\n\t\t\"name\": \"holding\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": true,\r\n\t\t\"label\": \"Holding\"\r\n\t} as FieldItemId,\r\n\ttick: {\r\n\t\t\"name\": \"tick\",\r\n\t\t\"isKey\": true,\r\n\t\t\"label\": \"Tick\"\r\n\t} as undefined,\r\n\tprice: {\r\n\t\t\"name\": \"price\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Price\"\r\n\t} as FieldItemInt,\r\n\tquantity: {\r\n\t\t\"name\": \"quantity\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Quantity\"\r\n\t} as FieldItemInt,\r\n\tamount: {\r\n\t\t\"name\": \"amount\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Amount\"\r\n\t} as FieldItemInt,\r\n};\r\n/*==fields==*/\r\n\r\nexport const fieldArr: FieldItem[] = [\r\n\tfields.holding, fields.tick, fields.price, fields.quantity, fields.amount, \r\n];\r\n\r\nexport const ui: UI = {\r\n\tlabel: \"Transaction\",\r\n\tfieldArr,\r\n\tfields,\r\n};\r\n\r\nexport const res: Res<any> = {\r\n\tzh: {\r\n\t},\r\n\ten: {\r\n\t}\r\n};\r\n\r\nexport function render(item: Transaction):JSX.Element {\r\n\treturn <>{JSON.stringify(item)}</>;\r\n};\r\n","import { Res, UI } from \"tonva-react\";\r\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\nimport { FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-react\";\r\nimport { Stock } from \"./BruceYuMi\";\r\n\r\n/*--fields--*/\r\nconst fields = {\r\n\tid: {\r\n\t\t\"name\": \"id\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": false,\r\n\t\t\"label\": \"Id\"\r\n\t} as FieldItemId,\r\n\tmarket: {\r\n\t\t\"name\": \"market\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": true,\r\n\t\t\"label\": \"Market\"\r\n\t} as FieldItemId,\r\n\tcode: {\r\n\t\t\"name\": \"code\",\r\n\t\t\"type\": \"string\",\r\n\t\t\"isKey\": true,\r\n\t\t\"widget\": \"string\",\r\n\t\t\"label\": \"Code\"\r\n\t} as FieldItemString,\r\n\tname: {\r\n\t\t\"name\": \"name\",\r\n\t\t\"type\": \"string\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"string\",\r\n\t\t\"label\": \"Name\"\r\n\t} as FieldItemString,\r\n};\r\n/*==fields==*/\r\n\r\nexport const fieldArr: FieldItem[] = [\r\n\tfields.market, fields.code, fields.name, \r\n];\r\n\r\nexport const ui: UI = {\r\n\tlabel: \"Stock\",\r\n\tfieldArr,\r\n\tfields,\r\n};\r\n\r\nexport const res: Res<any> = {\r\n\tzh: {\r\n\t},\r\n\ten: {\r\n\t}\r\n};\r\n\r\nexport function render(item: Stock):JSX.Element {\r\n\treturn <>{JSON.stringify(item)}</>;\r\n};\r\n","import { Res, UI } from \"tonva-react\";\r\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\nimport { FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-react\";\r\nimport { Market } from \"./BruceYuMi\";\r\n\r\n/*--fields--*/\r\nconst fields = {\r\n\tid: {\r\n\t\t\"name\": \"id\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": false,\r\n\t\t\"label\": \"Id\"\r\n\t} as FieldItemId,\r\n\tname: {\r\n\t\t\"name\": \"name\",\r\n\t\t\"type\": \"string\",\r\n\t\t\"isKey\": true,\r\n\t\t\"widget\": \"string\",\r\n\t\t\"label\": \"Name\"\r\n\t} as FieldItemString,\r\n\tcurrency: {\r\n\t\t\"name\": \"currency\",\r\n\t\t\"type\": \"string\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"string\",\r\n\t\t\"label\": \"Currency\"\r\n\t} as FieldItemString,\r\n};\r\n/*==fields==*/\r\n\r\nexport const fieldArr: FieldItem[] = [\r\n\tfields.name, fields.currency, \r\n];\r\n\r\nexport const ui: UI = {\r\n\tlabel: \"Market\",\r\n\tfieldArr,\r\n\tfields,\r\n};\r\n\r\nexport const res: Res<any> = {\r\n\tzh: {\r\n\t},\r\n\ten: {\r\n\t}\r\n};\r\n\r\nexport function render(item: Market):JSX.Element {\r\n\treturn <>{JSON.stringify(item)}</>;\r\n};\r\n","import { Res, UI } from \"tonva-react\";\r\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\nimport { FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-react\";\r\nimport { Portfolio } from \"./BruceYuMi\";\r\n\r\n/*--fields--*/\r\nconst fields = {\r\n\tid: {\r\n\t\t\"name\": \"id\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": false,\r\n\t\t\"label\": \"Id\"\r\n\t} as FieldItemId,\r\n\tquantity: {\r\n\t\t\"name\": \"quantity\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Quantity\"\r\n\t} as FieldItemInt,\r\n};\r\n/*==fields==*/\r\n\r\nexport const fieldArr: FieldItem[] = [\r\n\tfields.quantity, \r\n];\r\n\r\nexport const ui: UI = {\r\n\tlabel: \"Portfolio\",\r\n\tfieldArr,\r\n\tfields,\r\n};\r\n\r\nexport const res: Res<any> = {\r\n\tzh: {\r\n\t},\r\n\ten: {\r\n\t}\r\n};\r\n\r\nexport function render(item: Portfolio):JSX.Element {\r\n\treturn <>{JSON.stringify(item)}</>;\r\n};\r\n","import { Res, UI } from \"tonva-react\";\r\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\nimport { FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-react\";\r\nimport { StockValue } from \"./BruceYuMi\";\r\n\r\n/*--fields--*/\r\nconst fields = {\r\n\tid: {\r\n\t\t\"name\": \"id\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": false,\r\n\t\t\"label\": \"Id\"\r\n\t} as FieldItemId,\r\n\tmiRate: {\r\n\t\t\"name\": \"miRate\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"MiRate\"\r\n\t} as FieldItemInt,\r\n\tttm: {\r\n\t\t\"name\": \"ttm\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Ttm\"\r\n\t} as FieldItemInt,\r\n\tdivident: {\r\n\t\t\"name\": \"divident\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Divident\"\r\n\t} as FieldItemInt,\r\n\tprice: {\r\n\t\t\"name\": \"price\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Price\"\r\n\t} as FieldItemInt,\r\n\troe: {\r\n\t\t\"name\": \"roe\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Roe\"\r\n\t} as FieldItemInt,\r\n\tinc1: {\r\n\t\t\"name\": \"inc1\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Inc1\"\r\n\t} as FieldItemInt,\r\n\tinc2: {\r\n\t\t\"name\": \"inc2\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Inc2\"\r\n\t} as FieldItemInt,\r\n\tinc3: {\r\n\t\t\"name\": \"inc3\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Inc3\"\r\n\t} as FieldItemInt,\r\n\tinc4: {\r\n\t\t\"name\": \"inc4\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Inc4\"\r\n\t} as FieldItemInt,\r\n\tpreInc: {\r\n\t\t\"name\": \"preInc\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"PreInc\"\r\n\t} as FieldItemInt,\r\n\tmarketValue: {\r\n\t\t\"name\": \"marketValue\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"MarketValue\"\r\n\t} as FieldItemInt,\r\n};\r\n/*==fields==*/\r\n\r\nexport const fieldArr: FieldItem[] = [\r\n\tfields.miRate, fields.ttm, fields.divident, fields.price, fields.roe, fields.inc1, fields.inc2, fields.inc3, fields.inc4, fields.preInc, fields.marketValue, \r\n];\r\n\r\nexport const ui: UI = {\r\n\tlabel: \"StockValue\",\r\n\tfieldArr,\r\n\tfields,\r\n};\r\n\r\nexport const res: Res<any> = {\r\n\tzh: {\r\n\t},\r\n\ten: {\r\n\t}\r\n};\r\n\r\nexport function render(item: StockValue):JSX.Element {\r\n\treturn <>{JSON.stringify(item)}</>;\r\n};\r\n","import { Res, UI } from \"tonva-react\";\r\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\nimport { FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-react\";\r\nimport { AccountValue } from \"./BruceYuMi\";\r\n\r\n/*--fields--*/\r\nconst fields = {\r\n\tid: {\r\n\t\t\"name\": \"id\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": false,\r\n\t\t\"label\": \"Id\"\r\n\t} as FieldItemId,\r\n\tmi: {\r\n\t\t\"name\": \"mi\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Mi\"\r\n\t} as FieldItemInt,\r\n\tmarket: {\r\n\t\t\"name\": \"market\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Market\"\r\n\t} as FieldItemInt,\r\n\tcount: {\r\n\t\t\"name\": \"count\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Count\"\r\n\t} as FieldItemInt,\r\n};\r\n/*==fields==*/\r\n\r\nexport const fieldArr: FieldItem[] = [\r\n\tfields.mi, fields.market, fields.count, \r\n];\r\n\r\nexport const ui: UI = {\r\n\tlabel: \"AccountValue\",\r\n\tfieldArr,\r\n\tfields,\r\n};\r\n\r\nexport const res: Res<any> = {\r\n\tzh: {\r\n\t},\r\n\ten: {\r\n\t}\r\n};\r\n\r\nexport function render(item: AccountValue):JSX.Element {\r\n\treturn <>{JSON.stringify(item)}</>;\r\n};\r\n","import { Res, UI } from \"tonva-react\";\r\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\nimport { FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-react\";\r\nimport { UserAccount } from \"./BruceYuMi\";\r\n\r\n/*--fields--*/\r\nconst fields = {\r\n\tid: {\r\n\t\t\"name\": \"id\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": false,\r\n\t\t\"label\": \"Id\"\r\n\t} as FieldItemId,\r\n\tid2: {\r\n\t\t\"name\": \"id2\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": false,\r\n\t\t\"label\": \"Id2\"\r\n\t} as FieldItemId,\r\n};\r\n/*==fields==*/\r\n\r\nexport const fieldArr: FieldItem[] = [\r\n\t\r\n];\r\n\r\nexport const ui: UI = {\r\n\tlabel: \"UserAccount\",\r\n\tfieldArr,\r\n\tfields,\r\n};\r\n\r\nexport const res: Res<any> = {\r\n\tzh: {\r\n\t},\r\n\ten: {\r\n\t}\r\n};\r\n\r\nexport function render(item: UserAccount):JSX.Element {\r\n\treturn <>{JSON.stringify(item)}</>;\r\n};\r\n","export const consts = {\r\n    uqBasedata: \"bruce/mi\",\r\n    appIcon: 'https://tv.jkchemical.com/imgs/Bear-icon.png',\r\n    miApiHost: 'https://mi.jjol.cn/',\r\n    miApiHostDebug: 'http://localhost:6010/',\r\n    isDevelopment: process.env.NODE_ENV === 'development',\r\n}\r\n\r\nexport const defaultTagName = '自选股';\r\nexport const defaultBlackListTagName = '黑名单';\r\n\r\n","export class SlrForEarning {\r\n  slope: number;\r\n  intercept: number;\r\n  y: number[];\r\n  slopeR: number;\r\n  endY: number;\r\n  r2: number;\r\n\r\n  constructor(y:number[]) {\r\n    this.y = y;\r\n    this.regress();\r\n    let score = this.score();\r\n    this.r2 = score.r2;\r\n  }\r\n\r\n  regress() {\r\n    const n = this.y.length;\r\n    let xSum = 0;\r\n    let ySum = 0;\r\n  \r\n    let xSquared = 0;\r\n    let xY = 0;\r\n  \r\n    for (let x = 0; x < n; ++x) {\r\n      xSum += x;\r\n      ySum += this.y[x];\r\n      xSquared += x * x;\r\n      xY += x * this.y[x];\r\n    }\r\n  \r\n    const numerator = n * xY - xSum * ySum;\r\n    this.slope = numerator / (n * xSquared - xSum * xSum);\r\n    this.intercept = (1 / n) * ySum - this.slope * (1 / n) * xSum;\r\n\r\n    let ym = this.slope > 0 ? this.predict(n-2) : this.predict(1);\r\n    this.slopeR = ym < 0.01 ? undefined : this.slope / ym;\r\n  }\r\n\r\n  score() {\r\n    const n = this.y.length;\r\n    const y2 = new Array(n);\r\n    for (let i = 0; i < n; i++) {\r\n      y2[i] = this.predict(i);\r\n    }\r\n\r\n    let xSum = 0;\r\n    let ySum = 0;\r\n    let chi2 = 0;\r\n    let rmsd = 0;\r\n    let xSquared = 0;\r\n    let ySquared = 0;\r\n    let xY = 0;\r\n    for (let i = 0; i < n; i++) {\r\n      let yi2 = y2[i];\r\n      xSum += yi2;\r\n      let yi = this.y[i];\r\n      ySum += yi;\r\n      xSquared += yi2 * yi2;\r\n      ySquared += yi * yi;\r\n      xY += yi2 * yi;\r\n      let yiyi2 = yi - yi2;\r\n      if (yi !== 0) {\r\n        chi2 += (yiyi2 * yiyi2) / yi;\r\n      }\r\n      rmsd += yiyi2 * yiyi2;\r\n    }\r\n\r\n    const r =\r\n      (n * xY - xSum * ySum) /\r\n      Math.sqrt((n * xSquared - xSum * xSum) * (n * ySquared - ySum * ySum));\r\n\r\n    return {\r\n      r: r,\r\n      r2: r * r,\r\n      chi2: chi2,\r\n      rmsd: Math.sqrt(rmsd / n)\r\n    };\r\n  }\r\n\r\n\r\n  predict(x:number) {\r\n    return this.slope * x + this.intercept;\r\n  }\r\n\r\n  computeX(y:number) {\r\n    return (y - this.intercept) / this.slope;\r\n  }\r\n}\r\n","export class ErForEarning {\r\n  A:number;\r\n  B:number;\r\n  y: number[];\r\n  r2: number;\r\n\r\n  constructor(y:number[]) {\r\n    this.y = y;\r\n    this.regress();\r\n    let score = this.score();\r\n    this.r2 = score.r2;\r\n  }\r\n\r\n  regress() {\r\n    const n = this.y.length;\r\n    let xSum = 0;\r\n    let ySum = 0;\r\n  \r\n    let xSquared = 0;\r\n    let xY = 0;\r\n  \r\n    for (let x = 0; x < n; ++x) {\r\n      xSum += x;\r\n      let yx = Math.log(this.y[x]);\r\n      ySum += yx;\r\n      xSquared += x * x;\r\n      xY += x * yx;\r\n    }\r\n  \r\n    const numerator = n * xY - xSum * ySum;\r\n    let slope = numerator / (n * xSquared - xSum * xSum);\r\n    let intercept = (1 / n) * ySum - slope * (1 / n) * xSum;\r\n    this.A = Math.exp(intercept);\r\n    this.B = slope;\r\n  }\r\n\r\n  score() {\r\n    const n = this.y.length;\r\n    const y2 = new Array(n);\r\n    for (let i = 0; i < n; i++) {\r\n      y2[i] = this.predict(i);\r\n    }\r\n\r\n    let xSum = 0;\r\n    let ySum = 0;\r\n    let chi2 = 0;\r\n    let rmsd = 0;\r\n    let xSquared = 0;\r\n    let ySquared = 0;\r\n    let xY = 0;\r\n    for (let i = 0; i < n; i++) {\r\n      let yi2 = y2[i];\r\n      xSum += yi2;\r\n      let yi = this.y[i];\r\n      ySum += yi;\r\n      xSquared += yi2 * yi2;\r\n      ySquared += yi * yi;\r\n      xY += yi2 * yi;\r\n      let yiyi2 = yi - yi2;\r\n      if (yi !== 0) {\r\n        chi2 += (yiyi2 * yiyi2) / yi;\r\n      }\r\n      rmsd += yiyi2 * yiyi2;\r\n    }\r\n\r\n    const r =\r\n      (n * xY - xSum * ySum) /\r\n      Math.sqrt((n * xSquared - xSum * xSum) * (n * ySquared - ySum * ySum));\r\n\r\n    return {\r\n      r: r,\r\n      r2: r * r,\r\n      chi2: chi2,\r\n      rmsd: Math.sqrt(rmsd / n)\r\n    };\r\n  }\r\n\r\n  predict(x:number) {\r\n    return this.A * Math.exp(x * this.B);\r\n  }\r\n}\r\n","import React from 'react';\r\nimport { NavView, start } from 'tonva-react';\r\n//import logo from './logo.svg';\r\nimport './App.css';\r\nimport { CApp } from './UqApp';\r\nimport { appConfig } from './appConfig';\r\n/*\r\nfunction App() {\r\n  return (\r\n    <div className=\"App\">\r\n      <header className=\"App-header\">\r\n        <img src={logo} className=\"App-logo\" alt=\"logo\" />\r\n        <p>\r\n          Edit <code>src/App.tsx</code> and save to reload.\r\n        </p>\r\n        <a\r\n          className=\"App-link\"\r\n          href=\"https://reactjs.org\"\r\n          target=\"_blank\"\r\n          rel=\"noopener noreferrer\"\r\n        >\r\n          Learn React\r\n        </a>\r\n      </header>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;\r\n*/\r\nclass App extends React.Component {\r\n  \r\n\tprivate onLogined = async () => {\r\n\t  await start(CApp, appConfig);\r\n\t}\r\n\tpublic render() {\r\n\t  return <NavView onLogined={this.onLogined} />\r\n\t}\r\n}\r\n\r\nexport default App;\r\n  ","import { ReportHandler } from 'web-vitals';\r\n\r\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\r\n  if (onPerfEntry && onPerfEntry instanceof Function) {\r\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\r\n      getCLS(onPerfEntry);\r\n      getFID(onPerfEntry);\r\n      getFCP(onPerfEntry);\r\n      getLCP(onPerfEntry);\r\n      getTTFB(onPerfEntry);\r\n    });\r\n  }\r\n};\r\n\r\nexport default reportWebVitals;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport 'bootstrap/dist/css/bootstrap.css';\r\nimport './index.css';\r\nimport App from './App';\r\nimport reportWebVitals from './reportWebVitals';\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n","//=== UqApp builder created on Mon Mar 01 2021 18:29:19 GMT-0500 (GMT-05:00) ===//\r\nimport { CSub, CBase, CAppBase, IConstructor } from 'tonva-react';\r\nimport { UQs } from './uqs';\r\nimport { CApp } from './CApp';\r\n\r\nexport abstract class CUqBase extends CBase<CApp, UQs> {\r\n}\r\n\r\nexport abstract class CUqSub<A extends CAppBase<U>, U, T extends CBase<A,U>> extends CSub<A, U, T> {\r\n}\r\n\r\nexport abstract class CUqApp extends CAppBase<UQs> {\r\n\tprotected newC<T extends CUqBase>(type: IConstructor<T>): T {\r\n\t\tlet c = new type(this);\r\n\t\tc.init();\r\n\t\treturn c;\r\n\t}\r\n}\r\n","export default __webpack_public_path__ + \"static/media/logo.2d27ead7.svg\";","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport * as React from 'react';\r\nimport { View, nav } from 'tonva-react';\r\nimport { LMR, FA, SearchBox } from 'tonva-react';\r\nimport logo from '../images/logo.svg';\r\nimport { CHome } from './CHome';\r\n\r\nexport class VSiteHeader extends View<CHome> {\r\n    render() {\r\n        let currentSalesRegion = <FA name=\"globe\" />\r\n        let login = <div>\r\n            登录\r\n        </div>\r\n        let left = <img className=\"m-1\" src={logo} alt=\"logo\" style={{height: \"3rem\", width: \"3rem\"}} />;\r\n        //let cart = this.controller.cApp.cCart.renderCartLabel();\r\n        let right = undefined;\r\n        /*\r\n        <div className=\"d-flex flex-row mr-1 align-items-center\">\r\n            {currentSalesRegion} &nbsp;\r\n            <button onClick={()=>nav.start()}>Try</button>\r\n        </div>;*/\r\n        return <LMR\r\n            className=\"mb-3 align-items-center bg-white\"\r\n            left={left} right={right}>\r\n            <div className=\"\">\r\n                {this.controller.renderSearchHeader('md')}\r\n            </div>\r\n        </LMR>\r\n    }\r\n}","import * as React from 'react';\r\nimport { View } from 'tonva-react';\r\nimport { CHome } from './CHome';\r\nimport { SearchBox } from 'tonva-react';\r\n\r\nexport class VSearchHeader extends View<CHome> {\r\n\r\n    private onSearch = async (key: string) => {\r\n        // let { cProduct } = this.controller.cApp;\r\n        // cProduct.start(key);\r\n    }\r\n\r\n    render(param: any) {\r\n        return <SearchBox className=\"px-1 w-100\" \r\n            size={param}\r\n            onSearch={this.onSearch} \r\n            placeholder=\"功能...\" />\r\n    }\r\n}","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport * as React from 'react';\r\nimport { FA, LMR } from 'tonva-react';\r\nimport { NStockInfo } from '../stockinfo';\r\nimport {percent0, percent1, number, numberToMarketValue, calculateZZ3} from '../tool';\r\n\r\nfunction renderSortCol(radioName:string, sortMethod:string, caption:string, sort: (sortMethod:string) => void, checked:boolean = false) {\r\n\treturn <label className=\"btn btn-outline-info mb-0\">\r\n\t\t<input type=\"radio\" className=\"btn-sm btn-check mr-1\"\r\n\t\t\tname={radioName} defaultChecked={checked}\r\n\t\t\tonClick={() => sort(sortMethod)} />\r\n\t\t{caption}\r\n\t</label>\r\n}\r\n\r\nexport function renderSortHeaders(radioName:string, sort: (sortMethod:string) => void) {\r\n\treturn <div className=\"my-1 justify-content-end mr-2\">\r\n\t\t<div className=\"btn-group\" role=\"group\" aria-label=\"Basic radio toggle button group\">\r\n\t\t\t{renderSortCol(radioName, 'tagv', '米息率', sort, true)}\r\n\t\t\t{renderSortCol(radioName, 'tagpe', 'TTM', sort)}\r\n\t\t\t{renderSortCol(radioName, 'tagdp', '股息率', sort)}\r\n\t\t</div>\r\n\t</div>;\r\n}\r\n\r\nfunction renderValue(caption:string, value:number, valueType:'p0'|'p1'|'n1'|'n2'|'yi'):JSX.Element {\r\n\tconst _cn = 'px-2 mb-2 text-right '; \r\n\tlet cn = _cn + 'c5';\r\n\tlet cnYI = _cn + 'c5'\r\n\tlet vStr:string;\r\n\tswitch (valueType) {\r\n\t\tcase 'p0': vStr = percent0(value); break;\r\n\t\tcase 'p1': vStr = percent1(value); break;\r\n\t\tcase 'n1': vStr = number(value, 1); break;\r\n\t\tcase 'n2': vStr = number(value, 2); break;\r\n\t\tcase 'yi': \r\n\t\t\tvStr = numberToMarketValue(value);\r\n\t\t\tcn = cnYI;\r\n\t\t\tbreak;\r\n\t}\r\n\treturn <div key={caption} className={cn}>\r\n\t\t<span className=\"text-muted small\">{caption}</span><br />\r\n\t\t{vStr}\r\n\t</div>;\r\n}\r\n\r\nexport function renderStockInfoRow(row: NStockInfo, onClickName: (row:NStockInfo) => void, inputSelect:JSX.Element, right:JSX.Element):JSX.Element {\r\n  \tlet { id, name, code, pe, roe, price, divyield, v, order, symbol, l, e, ep, e3, total } = row;\r\n  \tlet zzl = calculateZZ3((row as any).dataArr);\r\n  \tlet left = <div className=\"cursor-pointer\" onClick={()=>onClickName(row)}>\r\n\t\t<span className=\"text-primary\">{name}</span>\r\n\t\t&nbsp; \r\n\t\t<span className=\"text-info\">{code}</span>\r\n\t  \t&nbsp;\r\n\t\t<small className=\"small ml-1\"><span className=\"text-danger\">{order}</span></small>\r\n  \t</div>;\r\n\tlet rows:[string,number,'p0'|'p1'|'n1'|'n2'|'yi'][] = [\r\n\t\t['米息率', v, 'n1'],\r\n\t\t['TTM', pe, 'n1'],\r\n\t\t['股息率', divyield*100, 'n1'],\r\n\t\t['价格', price, 'n2'],\r\n\t\t['ROE', roe*100, 'n1'],\r\n\t\t['增1', zzl[0], 'p0'],\r\n\t\t['增2', zzl[1], 'p0'],\r\n\t\t['增3', zzl[2], 'p0'],\r\n\t\t['增4', zzl[3], 'p0'],\r\n\t\t['预增', l, 'p0'],\r\n\t\t['市值', total*price, 'yi'],\r\n  \t];\r\n\tlet inputSelectSpan:any;\r\n\tif (inputSelect) {\r\n\t\tinputSelectSpan = <span className=\"ml-4\">{inputSelect}</span>\r\n\t}\r\n  \treturn <div className=\"d-block border-top\">\r\n\t\t<LMR className=\"px-2 py-1 bg-light\" left={left} right = {right}>{inputSelectSpan}</LMR>\r\n\t\t<div className=\"d-flex flex-wrap\" >\r\n\t\t\t{rows.map(v => renderValue(v[0], v[1], v[2]))}\r\n\t  \t</div>\r\n  \t</div>;\r\n}\r\n\r\nexport function renderStockUrl(row: NStockInfo) {\r\n    let { symbol } = row;\r\n\treturn <a className=\"text-info\" href={`https://finance.sina.com.cn/realstock/company/${symbol}/nc.shtml`} target=\"_blank\" rel=\"noopener noreferrer\" onClick={(e)=>{e.stopPropagation();}}>\r\n\t\t<FA name=\"angle-double-right\" />\r\n\t</a>;\r\n}\r\n","export function numberToFixString(n: number, w = 2) {\r\n    return n === undefined ? '' : n.toFixed(w);\r\n}\r\n\r\nexport function number(n: number, w=2) {\r\n\treturn n === undefined ? '' : n.toFixed(w);\r\n}\r\n\r\nexport function numberToMarketValue(n: number) {\r\n\treturn n === undefined || isNaN(n) ? '' : Math.round(n/10000).toString(); // + '亿';\r\n}\r\n\r\nexport function numberToString(n: number, precision = 2) {\r\n\treturn n === undefined ? '' : n.toPrecision(precision);\r\n}\r\n\r\nexport function numberToPrecision(n: number, precision = 4) {\r\n\treturn n === undefined ? undefined : Number.parseFloat(n.toPrecision(precision));\r\n}\r\n\r\nexport function percentToFixString(n: number) {\r\n\treturn n === undefined || isNaN(n) ? '' : (n * 100).toFixed(2) + '%';\r\n}\r\n\r\nexport function percent0(n: number) {\r\n\treturn n === undefined || isNaN(n) ? '' : (n * 100).toFixed(0) + '%';\r\n}\r\nexport function percent1(n: number) {\r\n\treturn n === undefined || isNaN(n) ? '' : (n * 100).toFixed(1) + '%';\r\n}\r\n\r\nexport function warningTypeString(t: string) {\r\n\tswitch (t) {\r\n\t\tcase 'gt': return '大于';\r\n\t\tcase 'lt': return '小于';\r\n\t\tdefault: return t;\r\n\t}\r\n}\r\n\r\nexport function predictCutRatio(r2:number) {\r\n\treturn r2 * 2 - r2 * r2;\r\n}\r\n\r\nexport function evaluatePricePrice(iRate:number, e1:number, e2:number, e3:number) {\r\n\tlet r = 1 + iRate;\r\n\tlet r2 = r * r;\r\n\tlet r3 = r2 * r;\r\n\treturn (e1/r + e2 /r2 + e3 / r3 + e3 / iRate / r3) / 2;\r\n}\r\n\r\nexport function calculateV(z:number, divyield:number, pe:number) {\r\n\tif (pe === undefined || isNaN(pe)) {\r\n\t\treturn undefined;\r\n\t}\r\n\r\n\tlet r = 0;\r\n\tif (z !== undefined) {\r\n\t\tif (z > 0.25) {\r\n\t\tz = 0.25;\r\n\t\t}\r\n\t\tr += z * 100;\r\n\t}\r\n\tif (divyield !== undefined) {\r\n\t\tr += divyield * 100;\r\n\t}\r\n\treturn r / pe;\r\n}\r\n\r\nexport function calculateVN(z:number, e:number, bonus:number, price:number) {\r\n\tif (price === undefined || isNaN(price) || e === undefined || isNaN(e)) {\r\n\t\treturn undefined;\r\n\t}\r\n\r\n\tlet r = 0;\r\n\tif (z !== undefined && e > 0) {\r\n\t\tif (z > 0.25) {\r\n\t\tz = 0.24 + Math.pow((z-0.24)*100, 0.6667) / 100;\r\n\t\t}\r\n\t\tz = 1 + z;\r\n\t\tz = z * z * z - 1;\r\n\t\tr += z * e * 100;\r\n\t}\r\n\tif (bonus !== undefined && !isNaN(bonus)) {\r\n\t\tr += bonus * 100;\r\n\t}\r\n\treturn r / price;\r\n}\r\n\r\nexport function calculateZZ3(data:number[]) {\r\n\tlet ret:number[] = [undefined, undefined, undefined, undefined] ;\r\n\tif (data === undefined)\r\n\t\treturn ret;\r\n\tlet len = data.length;\r\n\tif (len < 5)\r\n\t\treturn ret;\r\n\r\n\tlet funcz = (n:number, p:number) => {\r\n\t\tif (p <= 0 || n <= 0)\r\n\t\treturn undefined;\r\n\t\treturn ((n / p) - 1);\r\n\t}\r\n\tfor (let i = 0; i < 4; ++i) {\r\n\t\tret[i] = funcz(data[i+1], data[i]);\r\n\t}\r\n\treturn ret;\r\n}\r\n\r\n//export function caption = (value:string) => <span className=\"text-muted small\">{value}</span>;\r\n\r\nexport function MonthnoFromDay(day:number) {\r\n\tlet year = Math.floor(day/10000);\r\n\tlet month = Math.floor((day%10000)/100) - 1;\r\n\treturn (year-1995)*12+month;\r\n}\r\n\r\nexport function SeasonnoFromDay(day:number) {\r\n\tlet year = Math.floor(day/10000);\r\n\tlet month = Math.floor((day%10000)/100) - 1;\r\n\tlet season = Math.floor(month / 3);\r\n\treturn (year-1995)*4 + season;\r\n}\r\n\r\nexport function SeasonnoFromYearMonth(year:number, month:number) {\r\n\tlet season = Math.floor((month-1) / 3);\r\n\treturn (year-1995)*4 + season;\r\n}\r\n\r\nexport function SeasonnoToYearMonth(no: number) {\r\n\tlet year = Math.floor(no / 4) + 1995;\r\n\tlet month = (Math.floor(no % 4) + 1) * 3;\r\n\treturn year * 100 + month;\r\n}\r\n\r\nexport function SeasonnoToBeginEnd(season:number) {\r\n\tlet year = (1995 + Math.floor(season / 4)) * 10000;\r\n\tlet s = season % 4;\r\n\tif (s === 0) {\r\n\t\treturn {begin: year + 101, end: year + 331};\r\n\t} \r\n\tif (s === 1) {\r\n\t\treturn {begin: year + 401, end: year + 630};\r\n\t}\r\n\tif (s === 2) {\r\n\t\treturn {begin: year + 701, end: year + 930};\r\n\t}\r\n\treturn {begin: year + 1001, end: year + 1231};\r\n}\r\n\r\nexport function CalculatePredictAvg(arr: {predictpe:number}[]) {\r\n\tlet ret : {avg20:number, avg50:number, avg100:number} = {avg20:undefined, avg50:undefined, avg100:undefined};\r\n\r\n\tlet length = arr.length;\r\n\tlet calcuOne = (count:number) : number => {\r\n\t\tlet endIndex = count;\r\n\t\tif (endIndex > length)\r\n\t\tendIndex = length;\r\n\t\tif (endIndex >= 10) {\r\n\t\tlet sum = 0;\r\n\t\tfor (let i = 3; i < endIndex; ++i) {\r\n\t\t\tsum += arr[i].predictpe\r\n\t\t}\r\n\t\treturn sum / (endIndex - 3);\r\n\t\t}\r\n\t\telse {\r\n\t\treturn undefined;\r\n\t\t}\r\n\t}\r\n\r\n\tret.avg20 = calcuOne(20);\r\n\tret.avg50 = calcuOne(50);\r\n\tret.avg100 = calcuOne(100);\r\n\treturn ret;\r\n}\r\n\r\nexport function CalculateValueAvg(arr: {v:number}[]) {\r\n\tlet ret : {avg20:number, avg50:number, avg100:number, avg:number} = {avg20:undefined, avg50:undefined, avg100:undefined, avg:undefined};\r\n\r\n\tlet length = arr.length;\r\n\tlet calcuOne = (count:number) : number => {\r\n\t\tlet endIndex = count;\r\n\t\tif (count === 0 || endIndex > length)\r\n\t\tendIndex = length;\r\n\t\tif (endIndex >= 10) {\r\n\t\tlet sum = 0;\r\n\t\tfor (let i = 3; i < endIndex; ++i) {\r\n\t\t\tsum += arr[i].v;\r\n\t\t}\r\n\t\treturn sum / (endIndex - 3);\r\n\t\t}\r\n\t\telse {\r\n\t\treturn undefined;\r\n\t\t}\r\n\t}\r\n\r\n\tret.avg20 = calcuOne(20);\r\n\tret.avg50 = calcuOne(50);\r\n\tret.avg100 = calcuOne(100);\r\n\tret.avg = calcuOne(0);\r\n\treturn ret;\r\n}\r\n","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport * as React from 'react';\r\nimport { observer } from 'mobx-react';\r\nimport { VPage, List, LMR, FA, Scroller } from 'tonva-react';\r\nimport { NStockInfo } from '../stockinfo';\r\nimport { CHome } from './CHome';\r\nimport { renderSortHeaders, renderStockInfoRow, renderStockUrl } from '../tool';\r\n\r\nexport class VHome extends VPage<CHome> {\r\n  header() {\r\n    return '首页'\r\n  }\r\n  right() {\r\n  \treturn <button className=\"btn btn-sm btn-info mr-2\"\r\n\t  \tonClick={()=>{this.controller.openMarketPE()}}>\r\n\t\t  市场平均PE\r\n\t  </button>;\r\n  }\r\n\r\n  protected onPageScrollBottom(scroller: Scroller): Promise<void> {\r\n\tthis.controller.onPage();\r\n\treturn;\r\n  }\r\n\r\n  private setSortType = (type:string) => {\r\n    this.controller.setSortType(type);\r\n  }\r\n\r\n  content() {\r\n\t  return React.createElement(observer(() => {\r\n      let title = this.controller.cApp.config.tagName;\r\n      let { items } = this.controller;\r\n      let { onSelectTag, onAddStock } = this.controller;\r\n      let right = <div className=\"d-flex\">\r\n        <div className=\"btn cursor-pointer\" onClick={onAddStock}><FA name=\"plus\" inverse={false} /></div>\r\n        <div className=\"btn cursor-pointer ml-2\" onClick={onSelectTag}><FA name=\"bars\" inverse={false} /></div>\r\n      </div>;\r\n      let left = <div className=\"align-self-center\">{title}</div>\r\n      return <div>\r\n      <LMR className=\"px-2 py-1\" left={left} right={right}></LMR>\r\n      <List header={renderSortHeaders('radioHome', this.setSortType)}\r\n        items={items}\r\n        item={{ render: this.renderRow, key: this.rowKey }}\r\n        before={'搜索'}\r\n        none={<small className=\"px-2 py-3 text-info\">无自选股, 请选股</small>}\r\n      />\r\n      </div>;\r\n    }));\r\n  }\r\n\r\n  renderRow = (item: any, index: number): JSX.Element => { //<this.rowContent {...item} />;\r\n    return this.rowContent(item);\r\n  } \r\n  protected rowContent = (row: any): JSX.Element => {\r\n    let right = renderStockUrl(row);\r\n\treturn renderStockInfoRow(row, this.onClickName, null, right);\r\n  }\r\n\r\n  private rowKey = (item: any) => {\r\n    let { id } = item;\r\n    return id;\r\n  }\r\n\r\n  protected onClickName = (item: NStockInfo) => {\r\n    this.controller.openStockInfo(item);\r\n  }\r\n\r\n  protected onSelected = async (item: any): Promise<void> => {\r\n    let a = 0;\r\n  }\r\n\r\n  private callOnSelected(item: any) {\r\n    if (this.onSelected === undefined) {\r\n      alert('onSelect is undefined');\r\n      return;\r\n    }\r\n    this.onSelected(item);\r\n  }\r\n  clickRow = (item: any) => {\r\n    this.callOnSelected(item);\r\n  }\r\n}","import * as React from 'react';\r\nimport { observer } from 'mobx-react-lite';\r\nimport { VPage, Page, List } from 'tonva-react';\r\nimport { CHome } from './CHome';\r\n\r\nexport class VSelectTag extends VPage<CHome> {\r\n    async open(param?: any) {\r\n        this.openPage(this.page);\r\n    }\r\n\r\n    private renderTag = (tag:any) => {\r\n        return <div className=\"px-3 py-2 cursor-pointer\">{tag.name}</div>;\r\n    }\r\n\r\n    private page = observer(() => {\r\n        let {tags} = this.controller.cApp;\r\n        let { onClickTag } = this.controller;\r\n        return <Page header=\"选择分组\" headerClassName=\"bg-primary\">\r\n            <List items={tags} item={{onClick:onClickTag, render:this.renderTag}} />\r\n        </Page>;\r\n    })\r\n}\r\n","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport * as React from 'react';\r\nimport classNames from 'classnames';\r\nimport { VPage, Page, View, List, LMR, left0, FA } from 'tonva-react';\r\nimport { observable } from 'mobx';\r\nimport { observer } from 'mobx-react';\r\nimport RC2 from 'react-chartjs2'\r\nimport { GFunc } from '../tool/GFunc';\r\nimport {CMarketPE } from './CMarketPE'\r\n\r\nexport class VMarketPE extends VPage<CMarketPE> {\r\n  private input: HTMLInputElement;\r\n  private key: string = undefined;\r\n\r\n  async open(param?: any) {\r\n    this.openPage(this.page);\r\n  }\r\n\r\n  render(param: any): JSX.Element {\r\n    return <this.page />\r\n  }\r\n\r\n  checkLimitShow = (e)=> {\r\n    let check = e.target.checked as boolean;\r\n    let f = check ? 1:0;\r\n    this.controller.onLongShortFlag(f);\r\n  }\r\n\r\n  private page = observer(() => {\r\n  let head = <div >{''}</div>\r\n    return <Page header={head}\r\n      headerClassName='bg-primary'>\r\n      <this.pageContent />\r\n    </Page>;\r\n  })\r\n\r\n  private pageContent = observer(() => {\r\n    return <>\r\n      <this.historyChart />\r\n    </>\r\n  });\r\n\r\n  protected historyChart = observer(() => {\r\n    let {historyData} = this.controller;\r\n    if (historyData === undefined) \r\n      return <></>;\r\n    let chartHistory = <></>;\r\n    let labelList:any[] = [];\r\n    let peList:number[] = [];\r\n    let eList:number[] = [];\r\n    for (let item of historyData) {\r\n      let {day, pe, e} = item;\r\n      labelList.push(day);\r\n      peList.push(GFunc.numberToPrecision(pe, 4));\r\n      eList.push(e);\r\n    }\r\n    let chartdata1 = {\r\n      labels: labelList,\r\n      datasets: [\r\n        {\r\n          label: 'PE',\r\n          data: peList,\r\n          borderColor:'blue',\r\n          backgroundColor:'skyBlue',\r\n          borderWidth: 1,\r\n          fill: false,\r\n          yAxisID: 'y-axis-1',\r\n        },\r\n        {\r\n          label: 'e',\r\n          data: eList,\r\n          borderColor:'red',\r\n          backgroundColor:'pink',\r\n          borderWidth: 1,\r\n          fill: false,\r\n          yAxisID: 'y-axis-2',\r\n        }\r\n      ]\r\n    };\r\n    let options = {\r\n      scales:{\r\n        yAxes: [{\r\n          type: 'linear',\r\n          display: true,\r\n          position: 'right',\r\n          id: 'y-axis-1',\r\n        }, {\r\n          type: 'linear',\r\n          display: true,\r\n          position: 'left',\r\n          id: 'y-axis-2',\r\n          gridLines: {\r\n              drawOnChartArea: false\r\n          }\r\n        }],    \r\n      }\r\n    }\r\n    chartHistory = <RC2 data={chartdata1} type='line' options={options} />;\r\n    let right = <></>;\r\n    right = <label className=\"px-3\"> <input type=\"checkbox\" name=\"selectType\" defaultChecked={false}\r\n    onChange={this.checkLimitShow} />长期</label>;\r\n    return <><LMR className=\"px-3 py-2 bg-white\" left={'市场PE历史走势'} right={right}></LMR>\r\n      <div className=\"px-3\" style={{width:'95%'}}>{chartHistory}</div>\r\n    </>;\r\n  });\r\n\r\n\r\n}","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport { observable } from 'mobx';\r\nimport { CUqBase } from '../UqApp';\r\nimport { VMarketPE } from './VMarketPE';\r\n\r\nexport class CMarketPE extends CUqBase {\r\n    @observable historyData:{day:number, pe:number, e:number}[] =  [];\r\n    private longshortFlag:number = 0;\r\n\r\n    async internalStart(param: any) {\r\n        this.loadData();\r\n        this.openVPage(VMarketPE as any);\r\n    }\r\n\r\n    loadData = async () => {\r\n        let dt = new Date();\r\n        let param = [dt.getFullYear()*10000+(dt.getMonth()+1)*100+dt.getDate(), 750, this.longshortFlag];\r\n        let rets = await this.cApp.miApi.query('q_marketpe', param) as {day:number, pe:number, e:number}[];\r\n        this.historyData = rets.reverse();\r\n    }\r\n\r\n    onLongShortFlag(f:number) {\r\n        if (f === this.longshortFlag)\r\n            return;\r\n        this.longshortFlag = f;\r\n        this.loadData();\r\n    }\r\n}","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport * as React from 'react';\r\nimport { observable, IObservableArray, autorun, runInAction } from 'mobx';\r\nimport { ErForEarning, SlrForEarning } from 'regression';\r\nimport { UserTag } from '../types';\r\nimport { CUqBase } from '../UqApp';\r\nimport { CStockInfo, NStockInfo } from '../stockinfo';\r\nimport { VSiteHeader } from './VSiteHeader';\r\nimport { VSearchHeader } from './VSearchHeader';\r\nimport { VHome } from './VHome';\r\nimport { VSelectTag } from './VSelectTag';\r\nimport { GFunc } from 'tool/GFunc';\r\nimport { CMarketPE } from './CMarketPE';\r\nimport { CStock } from 'stock';\r\n\r\nexport class CHome extends CUqBase {\r\n\tprivate lastLoadTick: number;\r\n\titems: IObservableArray<any> = observable.array<any>([], { deep: true });\r\n\tuserTag: UserTag;\r\n\tprotected oldSortType: string;\r\n\t//@observable warnings: any[] = [];\r\n\r\n  /*\r\n  disposeAutorun = autorun(async () => {\r\n    let needLoad = false;\r\n    let oldID = this.userTag && this.userTag.tagID;\r\n    this.userTag = { tagName: this.cApp.config.tagName, tagID: this.cApp.tagID };\r\n    if (oldID !== this.userTag.tagID) {\r\n      needLoad = true;\r\n    }\r\n\r\n    let newSortType = this.cApp.config.userStock.sortType;\r\n    if (this.oldSortType === undefined) {\r\n      this.oldSortType = newSortType;\r\n    }\r\n    else if (this.oldSortType !== newSortType) {\r\n      this.oldSortType = newSortType;\r\n      needLoad = true;\r\n    }\r\n\r\n    if (needLoad) {\r\n      await this.load();\r\n    }\r\n  });\r\n  */\r\n\r\n  public AddTagStockID(tagid: number, stockID: number) {\r\n    if (this.userTag && this.userTag.tagID === tagid) {\r\n      this.loadItems();\r\n    }\r\n  }\r\n\r\n  public RemoveTagStockID(tagid: number, stockID: number) {\r\n    if (this.userTag && this.userTag.tagID === tagid) {\r\n      //this.PageItems.RemoveStock(stockID);\r\n      let i = this.items.findIndex(v=>{return v.id === stockID})\r\n     if (i >= 0) {\r\n       this.items.splice(i, 1);\r\n     }\r\n    }\r\n  }\r\n\r\n\r\n  onSelectTag = async () => {\r\n    this.openVPage(VSelectTag);\r\n  }\r\n\r\n  onAddStock = async () => {\r\n    let cStock = new CStock(this.cApp);\r\n    let r = await cStock.call() as {id:number};\r\n\r\n    if (r !== undefined) {\r\n      let id = r.id;\r\n      if (id > 0) {\r\n        let tagid = this.cApp.defaultListTagID;\r\n        await this.cApp.miApi.call('t_tagstock$add', [this.user.id, tagid, id]);\r\n        await this.cApp.AddTagStockID(tagid, id);\r\n        await this.loadItems();\r\n      }\r\n    }\r\n  }\r\n\r\n  onClickTag = async (item:any) => {\r\n    await this.cApp.selectTag(item);\r\n    this.closePage();\r\n  }\r\n\r\n  onPage = async () => {\r\n    //this.PageItems.more();\r\n  }\r\n\r\n  onWarningConfg = () => {\r\n    this.cApp.cWarning.onWarningConfg();\r\n  }\r\n\r\n\r\n  // async searchMain(key: any) {\r\n  //   if (key !== undefined) await this.PageItems.first(key);\r\n  // }\r\n\r\n\t//作为tabs中的首页，internalStart不会被调用\r\n\tasync internalStart(param: any) {\r\n\t}\r\n\r\n  \tload = async () => {\r\n    \tlet tagID = this.cApp.tagID;\r\n    \tif (tagID > 0) {\r\n\t\t\tif (this.lastLoadTick && Date.now() - this.lastLoadTick < 300*1000) return;\r\n      \t\tawait this.loadItems();\r\n    \t}\r\n  \t}\r\n\r\n\tasync loadItems() {\r\n\t\t// 距离上次\r\n\t\tlet queryName = 'taguser';\r\n\r\n\t\tlet query = {\r\n\t\tname: queryName,\r\n\t\tpageStart: 0,\r\n\t\tpageSize: 1000,\r\n\t\tuser: this.user.id,\r\n\t\ttag: this.cApp.tagID,\r\n\t\tyearlen: 1,\r\n\t\t};\r\n\t\tlet result = await this.cApp.miApi.process(query, []);\r\n\t\tif (Array.isArray(result) === false) {\r\n\t\treturn;\r\n\t\t};\r\n\t\tlet arr = result as {id:number, order:number, data?:string, v?:number, e:number, e3:number, ep:number, price:number, exprice:number, divyield:number, r2:number, lr2:number, predictpe?:number, dataArr?:number[]}[];\r\n\t\tfor (let item of arr) {\r\n\t\tlet dataArray = JSON.parse(item.data) as number[];\r\n\t\titem.dataArr = dataArray;\r\n\t\tlet sl = new SlrForEarning(dataArray);\r\n\t\titem.ep = (sl.predict(4) + item.e) / 2;\r\n\t\titem.e3 = sl.predict(7);\r\n\t\titem.v = GFunc.calculateVN(sl.slopeR, item.ep, item.divyield * item.price, item.exprice);\r\n\t\titem.predictpe = item.price / item.e3;\r\n\t\t}\r\n\t\tthis.cApp.sortStocks(arr);\r\n\t\tlet o = 1;\r\n\t\tfor (let item of arr) {\r\n\t\titem.order = o;\r\n\t\t++o;\r\n\t\t}\r\n\t\trunInAction(() => {\r\n\t\t\tthis.items.clear();\r\n\t\t\tthis.items.push(...arr);\t\r\n\t\t\tthis.lastLoadTick = Date.now();\r\n\t\t});\r\n\t}\r\n\r\n  setSortType = (type:string) => {\r\n    this.cApp.setUserSortType(type);\r\n    let arr = this.items.slice();\r\n    this.cApp.sortStocks(arr);\r\n\r\n    this.items.replace(arr);\r\n  }\r\n\r\n  // async loadWarning() {\r\n  //   let r = await this.cApp.miApi.query('q_warnings', [this.cApp.user.id]);\r\n  //   if (r !== undefined && Array.isArray(r)) {\r\n  //     this.warnings = r;\r\n  //   }\r\n  //   else {\r\n  //     if (this.warnings.length > 0) {\r\n  //       this.warnings = [];\r\n  //     }\r\n  //   }\r\n  // }\r\n\r\n  renderSiteHeader = () => {\r\n    return this.renderView(VSiteHeader);\r\n  }\r\n\r\n  renderSearchHeader = (size?: string) => {\r\n    return this.renderView(VSearchHeader, size);\r\n  }\r\n\r\n\r\n  renderHome = () => {\r\n    return this.renderView(VHome);\r\n  }\r\n\r\n  openMetaView = () => {\r\n  }\r\n\r\n  tab = () => {\r\n    return this.renderHome();\r\n  }\r\n\r\n  openStockInfo = (item: NStockInfo) => {\r\n    let cStockInfo = this.newC(CStockInfo);\r\n    cStockInfo.start(item);\r\n  }\r\n\r\n  openMarketPE = () => {\r\n    let cm = this.newC(CMarketPE);\r\n    cm.start();\r\n  }\r\n}","import * as React from 'react';\r\nimport { observable } from 'mobx';\r\nimport {\r\n    userApi, ItemSchema, StringSchema, ImageSchema, UiTextItem, UiImageItem, nav, Page,\r\n    Edit, UiSchema, VPage\r\n} from 'tonva-react';\r\nimport { CMe } from './CMe';\r\n\r\nexport class VEditMe extends VPage<CMe>{\r\n\r\n    async open(param: any) {\r\n        this.openPage(this.page);\r\n    }\r\n\r\n    private schema: ItemSchema[] = [\r\n        { name: 'nick', type: 'string' } as StringSchema,\r\n        { name: 'icon', type: 'image' } as ImageSchema,\r\n    ];\r\n    private uiSchema: UiSchema = {\r\n        items: {\r\n            nick: { widget: 'text', label: '别名', placeholder: '好的别名更方便记忆' } as UiTextItem,\r\n            icon: { widget: 'image', label: '头像' } as UiImageItem,\r\n        }\r\n    }\r\n    @observable private data: any;\r\n\r\n    constructor(props: any) {\r\n        super(props);\r\n        let { nick, icon } = nav.user;\r\n        this.data = {\r\n            nick: nick,\r\n            icon: icon,\r\n        };\r\n    }\r\n\r\n    private onItemChanged = async (itemSchema: ItemSchema, newValue: any, preValue: any) => {\r\n        let { name } = itemSchema;\r\n        await userApi.userSetProp(name, newValue);\r\n        this.data[name] = newValue;\r\n        nav.user.name = newValue;\r\n        nav.saveLocalUser();\r\n    }\r\n\r\n    private page = () => {\r\n\t\tlet { schema, uiSchema, data, onItemChanged } = this;\r\n\t\t/*\r\n\t\tlet vAdmin: any;\r\n\t\t\r\n\t\tlet { role } = this.controller;\r\n\t\tif ((role & 2) === 2) {\r\n\t\t\tvAdmin = <div className=\"px-3 py-2 cursor-pointer bg-white border-bottom\" onClick={this.controller.showAdmin}>管理员</div>;\r\n\t\t}\r\n\t\t{vAdmin}\r\n\t\t*/\r\n        return <Page header=\"个人信息\">\r\n            <Edit schema={schema} uiSchema={uiSchema}\r\n                data={data}\r\n                onItemChanged={onItemChanged} />\r\n        </Page>;\r\n    }\r\n}\r\n\r\nexport const webUserSchema: ItemSchema[] = [\r\n    { name: 'firstName', type: 'string', required: true } as StringSchema,\r\n    { name: 'gender', type: 'string' } as StringSchema,\r\n    { name: 'salutation', type: 'string' } as StringSchema,\r\n    { name: 'organizationName', type: 'string', required: true } as StringSchema,\r\n    { name: 'departmentName', type: 'string' } as StringSchema,\r\n];\r\n\r\n","import { VPage } from \"tonva-react\";\r\nimport { CMe } from \"./CMe\";\r\n\r\nexport class VFaq extends VPage<CMe> {\r\n\theader() {return '基本概念'}\r\n\tcontent() {\r\n\t\treturn <ul>\r\n\t\t\t<li className=\"my-3\">\r\n\t\t\t\t<div className=\"my-2\">基本公理</div>\r\n\t\t\t\t<ul className=\"px-3 text-info\">\r\n\t\t\t\t\t<li><span className=\"mr-3\">公理1: </span>进步是社会的必然</li>\r\n\t\t\t\t\t<li><span className=\"mr-3\">公理2: </span>信任是经济的基石</li>\r\n\t\t\t\t\t<li><span className=\"mr-3\">公理3: </span>价值是价格的准心</li>\r\n\t\t\t\t\t<li><span className=\"mr-3\">公理4: </span>发展是企业的基因</li>\r\n\t\t\t\t</ul>\r\n\t\t\t</li>\r\n\t\t\t<li className=\"my-3\">\r\n\t\t\t\t<div className=\"my-2\">米投定律</div>\r\n\t\t\t\t<ul className=\"px-3 text-info\">\r\n\t\t\t\t\t<li><span className=\"mr-3\">定律1: </span>投资无风险</li>\r\n\t\t\t\t</ul>\r\n\t\t\t</li>\r\n\t\t\t<li className=\"my-3\">\r\n\t\t\t\t<div className=\"my-2\">米投原则</div>\r\n\t\t\t\t<ul className=\"px-3 text-info\">\r\n\t\t\t\t\t<li><span className=\"mr-3\">原则1: </span>低估</li>\r\n\t\t\t\t\t<li><span className=\"mr-3\">原则2: </span>分散</li>\r\n\t\t\t\t\t<li><span className=\"mr-3\">原则3: </span>不深研</li>\r\n\t\t\t\t</ul>\r\n\t\t\t</li>\r\n\t\t\t<li className=\"my-3\">\r\n\t\t\t\t<div className=\"my-2\">米息定义</div>\r\n\t\t\t\t<ul className=\"px-3 text-info\">\r\n\t\t\t\t\t<li><span className=\"mr-3\">定义1: </span>米息 = 增息 + 股息</li>\r\n\t\t\t\t\t<li><span className=\"mr-3\">定义2: </span>增息 = 企业未来三年利润增长值</li>\r\n\t\t\t\t\t<li><span className=\"mr-3\">定义3: </span>米息率 = 米息 / PE</li>\r\n\t\t\t\t\t<li><span className=\"mr-3\">定义4: </span>PE = 股价 / 利润</li>\r\n\t\t\t\t</ul>\r\n\t\t\t</li>\r\n\t\t</ul>\r\n\t}\r\n}","import React from 'react';\r\nimport { observer } from 'mobx-react';\r\nimport { Image, VPage, nav, IconText, PropGrid, LMR, FA, Prop } from 'tonva-react';\r\nimport { CMe } from './CMe';\r\nimport { appConfig } from '../appConfig';\r\nimport { VFaq } from './VFaq';\r\n\r\nexport class VMe extends VPage<CMe> {\r\n\theader() {return this.t('me')}\r\n\r\n\tcontent() {\r\n        const { user } = nav;\r\n        let aboutRows: Prop[] = [\r\n            '',\r\n            {\r\n                type: 'component',\r\n                component: <LMR className=\"w-100\" onClick={this.faq}\r\n\t\t\t\t\tright={<FA className=\"align-self-center\" name=\"angle-right\" />}>\r\n                    <IconText iconClass=\"text-info mr-2\" icon=\"comments-o\" text={this.t('基本概念')} />                    \r\n                </LMR>,\r\n            },\r\n            {\r\n                type: 'component',\r\n                component: <div className=\"w-100 d-flex justify-content-between\">\r\n                    <IconText iconClass=\"text-info mr-2\" icon=\"smile-o\" text={this.t('aboutTheApp')} />\r\n                    <div className=\"py-2 small\">V{appConfig?.app?.version}</div>\r\n                </div>,\r\n            },\r\n        ];\r\n\r\n        let rows: Prop[];\r\n        if (user === undefined) {\r\n            rows = aboutRows;\r\n            rows.push(\r\n                {\r\n                    type: 'component',\r\n                    component: <button className=\"btn btn-success w-100 my-2\" onClick={() => nav.logout()}>\r\n                        <FA name=\"sign-out\" size=\"lg\" /> {this.t('pleaseLogin')}\r\n                    </button>\r\n                },\r\n            );\r\n        }\r\n        else {\r\n            let logOutRows: Prop[] = [\r\n                '',\r\n                {\r\n                    type: 'component',\r\n                    bk: '',\r\n                    component: <button className=\"btn btn-danger w-100\" onClick={this.onExit}>\r\n                        <FA name=\"sign-out\" size=\"lg\" /> {this.t('logout')}\r\n                </button>\r\n                },\r\n            ];\r\n\r\n            rows = [\r\n                '',\r\n                {\r\n                    type: 'component',\r\n                    component: <this.meInfo />\r\n                },\r\n                '',\r\n                {\r\n                    type: 'component',\r\n                    component: <IconText iconClass=\"text-info mr-2\" icon=\"key\" text={this.t('changePassword')} />,\r\n                    onClick: this.changePassword\r\n                },\r\n            ]\r\n            rows.push(...aboutRows, ...logOutRows);\r\n        }\r\n        return <PropGrid rows={[...rows]} values={{}} />;\r\n\t}\r\n\r\n\tprivate onExit = () => {\r\n        nav.showLogout();\r\n    }\r\n\r\n    private changePassword = async () => {\r\n        await nav.changePassword();\r\n    }\r\n\r\n    private meInfo = observer(() => {\r\n        let { user } = nav;\r\n        if (user === undefined) return null;\r\n        let { id, name, nick, icon } = user;\r\n        return <LMR className=\"py-2 cursor-pointer w-100\"\r\n            left={<Image className=\"w-3c h-3c mr-3\" src={icon || '.user-o'} />}\r\n            right={<FA className=\"align-self-end\" name=\"angle-right\" />}\r\n            onClick={this.controller.showEditMe}>\r\n            <div>\r\n                <div>{userSpan(name, nick)}</div>\r\n                <div className=\"small\"><span className=\"text-muted\">ID:</span> {id > 10000 ? id : String(id + 10000).substr(1)}</div>\r\n            </div>\r\n        </LMR>;\r\n    });\r\n\r\n\tprivate faq = () => {\r\n\t\tthis.openVPage(VFaq);\r\n\t}\r\n}\r\n\r\nfunction userSpan(name: string, nick: string): JSX.Element {\r\n    return nick ?\r\n        <><b>{nick} &nbsp; <small className=\"muted\">{name}</small></b></>\r\n        : <b>{name}</b>\r\n}\r\n","import { QueryPager, User } from \"tonva-react\";\r\nimport { CUqBase } from \"../UqApp\";\r\n//import { VAdmin } from \"./VAdmin\";\r\nimport { VEditMe } from \"./VEditMe\";\r\nimport { VMe } from \"./VMe\";\r\n\r\nexport interface RootUnitItem {\r\n\tid: number;\t\t\t\t\t// root unit id\r\n\towner: any;\r\n\tname: string;\t\t\t\t// 唯一\r\n\tcontent: string;\r\n\ttonvaUnit: number;\t\t\t// 跟tonva机构对应的值\r\n\tx: number;\r\n}\r\n\r\nexport class CMe extends CUqBase {\r\n\trole: number;\r\n\tunitOwner: User;\r\n\trootUnits: QueryPager<any>;\r\n\r\n    protected async internalStart() {\r\n\t}\r\n\r\n\ttab = () => this.renderView(VMe);\r\n\r\n\tshowEditMe = async () => {\r\n\t\t//let result = await this.uqs.Notes.GetSystemRole.query({});\r\n\t\tthis.role = undefined; // result.ret[0]?.role;\r\n\t\tthis.openVPage(VEditMe);\r\n\t}\r\n\t/*\r\n\tshowAdmin = async () => {\r\n\t\tthis.rootUnits = new QueryPager<any>(this.uqs.Notes.GetRootUnits, undefined, undefined, true);\r\n\t\tthis.rootUnits.first({});\r\n\t\tthis.openVPage(VAdmin);\r\n\t}\r\n\r\n\tasync createRootUnit(param: {name:string; content:string; owner:number}): Promise<number> {\r\n\t\tlet result = await this.uqs.Notes.CreateRootUnit.submit(param);\r\n\t\treturn result.id;\r\n\t}\r\n\r\n\tasync changeRootUnitName(item:RootUnitItem, name:string) {\r\n\t\tawait this.uqs.Notes.ChangeRootUnitProp.submit({unit:item.id, prop:'name', value: name})\r\n\t\titem.name = name;\r\n\t}\r\n\r\n\tasync changeRootUnitTonva(item:RootUnitItem, tonvaUnit:any) {\r\n\t\tawait this.uqs.Notes.ChangeRootUnitProp.submit({unit:item.id, prop:'tonvaUnit', value: tonvaUnit})\r\n\t\titem.tonvaUnit = tonvaUnit;\r\n\t}\r\n\r\n\tasync changeRootUnitX(item:RootUnitItem, x:number) {\r\n\t\tawait this.uqs.Notes.ChangeRootUnitProp.submit({unit:item.id, prop:'x', value: x as any})\r\n\t\titem.x = x;\r\n\t}\r\n\t*/\r\n}\r\n","import {FetchError} from './fetchError';\r\nimport {HttpChannelUI} from './httpChannelUI';\r\nimport {nav} from 'tonva-react';\r\nimport { consts } from '../consts';\r\n\r\nexport async function httpGet(url:string, params?:any):Promise<any> {\r\n    let channel = new HttpChannel(url, undefined, undefined);\r\n    let ret = await channel.get('', params);\r\n    return ret;\r\n}\r\n\r\nexport async function httpPost(url:string, params?:any):Promise<any> {\r\n    let channel = new HttpChannel(url, undefined, undefined);\r\n    let ret = await channel.post('', params);\r\n    return ret;\r\n}\r\n\r\nexport class HttpChannel {\r\n    private hostUrl: string;\r\n    private apiToken: string;\r\n    private ui?: HttpChannelUI;\r\n    private timeout: number;\r\n\r\n    constructor(hostUrl: string, apiToken:string, ui?: HttpChannelUI) {\r\n        this.hostUrl = hostUrl;\r\n        this.apiToken = apiToken;\r\n        this.ui = ui;\r\n        this.timeout = consts.isDevelopment === true? 500000:20000;\r\n    }\r\n\r\n    private startWait = () => {\r\n        if (this.ui !== undefined) this.ui.startWait();\r\n    }\r\n\r\n    private endWait = (url?:string, reject?:(reason?:any)=>void) => {\r\n        if (this.ui !== undefined) this.ui.endWait();\r\n        if (reject !== undefined) reject('访问webapi超时 ' + url);\r\n    }\r\n\r\n    private showError = async (error:FetchError) => {\r\n        if (this.ui !== undefined) await this.ui.showError(error);\r\n    }\r\n\r\n    used() {\r\n        this.post('', {});\r\n    }\r\n\r\n    async get(url: string, params: any = undefined): Promise<any> {\r\n        if (params) {\r\n            let keys = Object.keys(params);\r\n            if (keys.length > 0) {\r\n                let c = '?';\r\n                for (let k of keys) {\r\n                    let v = params[k];\r\n                    if (v === undefined) continue;\r\n                    url += c + k + '=' + params[k];\r\n                    c = '&';\r\n                }\r\n            }\r\n        }\r\n        let options = this.buildOptions();\r\n        options.method = 'GET';\r\n        return await this.innerFetch(url, options);\r\n    }\r\n\r\n    async post(url: string, params: any): Promise<any> {\r\n        let options = this.buildOptions();\r\n        options.method = 'POST';\r\n        options.body = JSON.stringify(params);\r\n        return await this.innerFetch(url, options);\r\n    }\r\n\r\n    async put(url: string, params: any): Promise<any> {\r\n        let options = this.buildOptions();\r\n        options.method = 'PUT';\r\n        options.body = JSON.stringify(params);\r\n        return await this.innerFetch(url, options);\r\n    }\r\n\r\n    async delete(url: string, params: any): Promise<any> {\r\n        let options = this.buildOptions();\r\n        options.method = 'DELETE';\r\n        options.body = JSON.stringify(params);\r\n        return await this.innerFetch(url, options);\r\n    }\r\n    async fetch(url: string, options: any, resolve:(value?:any)=>any, reject:(reason?:any)=>void):Promise<void> {\r\n        let that = this;\r\n        this.startWait();\r\n        let path = url;\r\n        function buildError(err: string) {\r\n            return {\r\n                channel: that,\r\n                url: path,\r\n                options: options,\r\n                resolve: resolve,\r\n                reject: reject,\r\n                error: err,\r\n            }\r\n        }\r\n        try {\r\n            console.log('%s %s', options.method, path);\r\n            let timeOutHandler = setTimeout(() => that.endWait(url, reject), this.timeout);\r\n            let res = await fetch(encodeURI(path), options);\r\n            if (res.ok === false) {\r\n                clearTimeout(timeOutHandler);\r\n                that.endWait();\r\n                console.log('call error %s', res.statusText);\r\n                throw res.statusText;\r\n            }\r\n            let ct = res.headers.get('content-type');\r\n            if (ct && ct.indexOf('json')>=0) {\r\n                return res.json().then(async retJson => {\r\n                    clearTimeout(timeOutHandler);\r\n                    that.endWait();\r\n                    if (retJson.ok === true) {\r\n                        return resolve(retJson.res);\r\n                    }\r\n                    if (retJson.error === undefined) {\r\n                        await that.showError(buildError('not valid tonva json'));\r\n                    }\r\n                    else {\r\n                        await that.showError(buildError(retJson.error));\r\n                        reject(retJson.error);\r\n                    }\r\n                    //throw retJson.error;\r\n                }).catch(async error => {\r\n                    await that.showError(buildError(error.message));\r\n                });\r\n            }\r\n            else {\r\n                let text = await res.text();\r\n                clearTimeout(timeOutHandler);\r\n                that.endWait();\r\n                resolve(text);\r\n            }\r\n        }\r\n        catch(error) {\r\n            if (typeof error === 'string') {\r\n                if (error.toLowerCase().startsWith('unauthorized') === true) {\r\n                    nav.logout();\r\n                    return;\r\n                }\r\n            }\r\n            await this.showError(buildError(error.message));\r\n        };\r\n    }\r\n\r\n    private async innerFetch(url: string, options: any): Promise<any> {\r\n        let u = this.hostUrl + url;\r\n        return await new Promise<any>(async (resolve, reject) => {\r\n            await this.fetch(u, options, resolve, reject);\r\n        });\r\n    }\r\n\r\n    async callFetch(url:string, method:string, body:any):Promise<any> {\r\n        let options = this.buildOptions();\r\n        options.method = method;\r\n        options.body = body;\r\n        return await new Promise<any>(async (resolve, reject) => {\r\n            await this.fetch(url, options, resolve, reject);\r\n        });\r\n    }\r\n\r\n    private buildOptions(): any {\r\n        let {language, culture} = nav;\r\n        let headers = new Headers();\r\n        //headers.append('Access-Control-Allow-Origin', '*');\r\n        headers.append('Content-Type', 'application/json;charset=UTF-8');\r\n        let lang = language;\r\n        if (culture) lang += '-' + culture;\r\n        headers.append('Accept-Language', lang);\r\n        if (this.apiToken) { \r\n            headers.append('Authorization', this.apiToken); \r\n        }\r\n        let options = {\r\n            headers: headers,\r\n            // cache: 'no-cache',\r\n        };\r\n        return options;\r\n    }\r\n}\r\n","import {nav} from 'tonva-react';\r\n\r\nexport interface HttpChannelUI {\r\n    startWait():void;\r\n    endWait():void;\r\n    showError(error:any):Promise<void>;\r\n}\r\n\r\nexport class HttpChannelNavUI implements HttpChannelUI {\r\n    startWait() {\r\n        nav.startWait();\r\n    }\r\n    endWait() {\r\n        nav.endWait();\r\n    }\r\n    async showError(error:any):Promise<void> {\r\n        nav.endWait();\r\n        /*\r\n        if (error.name === 'SyntaxError') {\r\n            error = {\r\n                name: error.name,\r\n                message: error.message,\r\n            }\r\n        }*/\r\n        await nav.onError(error);\r\n    }\r\n}\r\n\r\n","//import {isDevelopment} from '../local';\r\nimport {HttpChannel} from './httpChannel';\r\n\r\nexport async function refetchApi(channel:HttpChannel, url, options, resolve, reject) {\r\n    await channel.fetch(url, options, resolve, reject);\r\n}\r\n\r\nexport abstract class ApiBase {\r\n    protected token: string;\r\n    protected path: string;\r\n    protected showWaiting: boolean;\r\n\r\n    constructor(path: string, showWaiting: boolean) {\r\n        this.path = path || '';\r\n        this.showWaiting = showWaiting;\r\n    }\r\n\r\n    protected abstract getHttpChannel(): Promise<HttpChannel>;\r\n\r\n    public async call(url:string, method:string, body:any):Promise<any> {\r\n        let channel = await this.getHttpChannel();\r\n        return await channel.callFetch(url, method, body);\r\n    }\r\n\r\n    public async get(path:string, params:any=undefined): Promise<any> {\r\n        let channel = await this.getHttpChannel();\r\n        return await channel.get(this.path + path, params);\r\n    }\r\n\r\n    public async post(path:string, params:any): Promise<any> {\r\n        let channel = await this.getHttpChannel();\r\n        return await channel.post(this.path + path, params);\r\n    }\r\n\r\n    public async put(path:string, params:any): Promise<any> {\r\n        let channel = await this.getHttpChannel();\r\n        return await channel.put(this.path + path, params);\r\n    }\r\n\r\n    public async delete(path:string, params:any): Promise<any> {\r\n        let channel = await this.getHttpChannel();\r\n        return await channel.delete(this.path + path, params);\r\n    }\r\n}\r\n","import _ from 'lodash';\r\nimport { HttpChannel } from './httpChannel';\r\nimport { HttpChannelNavUI } from './httpChannelUI';\r\nimport { ApiBase } from './apiBase';\r\n\r\nlet channelUIs: { [name: string]: HttpChannel } = {};\r\nlet channelNoUIs: { [name: string]: HttpChannel } = {};\r\n\r\nclass MiApiChannel extends ApiBase {\r\n  private apiName: string;\r\n  url: string;\r\n\r\n  constructor(url: string, basePath: string, apiName: string, uqToken: string, showWaiting?: boolean) {\r\n    super(basePath, showWaiting);\r\n    this.showWaiting = showWaiting;\r\n    this.apiName = apiName;\r\n    this.token = uqToken;\r\n    this.url = url;\r\n  }\r\n\r\n  protected async getHttpChannel(): Promise<HttpChannel> {\r\n    let channels: { [name: string]: HttpChannel };\r\n    let channelUI: HttpChannelNavUI;\r\n    if (this.showWaiting === true || this.showWaiting === undefined) {\r\n      channels = channelUIs;\r\n      channelUI = new HttpChannelNavUI();\r\n    }\r\n    else {\r\n      channels = channelNoUIs;\r\n    }\r\n    let channel = channels[this.apiName];\r\n    if (channel !== undefined) return channel;\r\n    channel = new HttpChannel(this.url, this.token, channelUI);\r\n    return channels[this.apiName] = channel;\r\n  }\r\n}\r\n\r\nexport class MiApi {\r\n  private channel: MiApiChannel;\r\n\r\n  constructor(url: string, basePath: string, apiName: string, uqToken: string, showWaiting?: boolean) {\r\n    this.channel = new MiApiChannel(url, basePath, apiName, uqToken, showWaiting);\r\n  }\r\n\r\n  async call(name: string, params: any[]): Promise<any> {\r\n    let pbody = { call: name, params: params };\r\n    return await this.channel.post('sql/call', pbody);\r\n  }\r\n\r\n  async query(name: string, params: any[]): Promise<any> {\r\n    let pbody = { call: name, params: params };\r\n    return await this.channel.post('sql/call', pbody);\r\n  }\r\n\r\n  async page(name: string, params: any[], pageStart: number, pageSize: number): Promise<any> {\r\n    let p: any[];\r\n    switch (typeof params) {\r\n      case 'undefined': p = []; break;\r\n      default: p = _.clone(params); break;\r\n    }\r\n    p.push(pageStart);\r\n    p.push(pageSize);\r\n    let pbody = { call: name, params: p };\r\n    return await this.channel.post('sql/call', pbody);\r\n  }\r\n\r\n  async process(proc: any, params: any[]): Promise<any> {\r\n    let pbody = { proc: proc, params: params };\r\n    return await this.channel.post('sql/query', pbody);\r\n  }\r\n}\r\n","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport * as React from 'react';\r\nimport { View, nav } from 'tonva-react';\r\nimport { LMR, FA, SearchBox } from 'tonva-react';\r\nimport logo from '../images/logo.svg';\r\nimport { CExplorer } from './CExplorer';\r\n\r\nexport class VSiteHeader extends View<CExplorer> {\r\n    render() {\r\n        let currentSalesRegion = <FA name=\"globe\" />\r\n        let login = <div>\r\n            登录\r\n        </div>\r\n        let left = <img className=\"m-1\" src={logo} alt=\"logo\" style={{height: \"3rem\", width: \"3rem\"}} />;\r\n        //let cart = this.controller.cApp.cCart.renderCartLabel();\r\n        let right = undefined;\r\n        /*\r\n        <div className=\"d-flex flex-row mr-1 align-items-center\">\r\n            {currentSalesRegion} &nbsp;\r\n            <button onClick={()=>nav.start()}>Try</button>\r\n        </div>;*/\r\n        return <LMR\r\n            className=\"mb-3 align-items-center bg-white\"\r\n            left={left} right={right}>\r\n            <div className=\"\">\r\n                {this.controller.renderSiteHeader()}\r\n            </div>\r\n        </LMR>\r\n    }\r\n}","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport * as React from 'react';\r\nimport { observer } from 'mobx-react';\r\nimport { VPage, List, LMR, FA, Scroller } from 'tonva-react';\r\nimport { NStockInfo } from '../stockinfo';\r\nimport { GFunc } from '../tool/GFunc';\r\nimport { CExplorer } from './CExplorer';\r\nimport { PredictHistoryParam } from 'predicthistory/CPredictHistory';\r\nimport { renderSortHeaders, renderStockInfoRow, renderStockUrl } from '../tool';\r\n\r\nexport class VExplorer extends VPage<CExplorer> {\r\n  header() {return '股票发现'}\r\n  protected onPageScrollBottom(scroller: Scroller): Promise<void> {\r\n\tthis.controller.onPage();\r\n\treturn;\r\n  }\r\n\r\n  right() {\r\n    let { onConfig } = this.controller;\r\n  \treturn <div className=\"btn align-self-center cursor-pointer \" onClick={onConfig}><FA name=\"cog\" size=\"lg\" inverse={true} /></div>\r\n  }\r\n\r\n  private onClickPredictAVG = () => {\r\n    let {avgs, lastTradeDay} = this.controller;\r\n    let param: PredictHistoryParam = {\r\n      day:undefined,\r\n      priceDay:lastTradeDay,\r\n      avg20:avgs.avg20,\r\n      avg50:avgs.avg50,\r\n      avg100:avgs.avg100,\r\n      avg:avgs.avg,\r\n    }\r\n    this.controller.cApp.openPredictAVG(param);\r\n  }\r\n\r\n  content() {\r\n\t  return React.createElement(observer(() => {\r\n      let {items, avgs, reload} = this.controller;\r\n      let avgHead: JSX.Element;\r\n      let right = <div>\r\n      <div className=\"btn cursor-pointer py-3\" onClick={reload}>刷新</div>\r\n      </div>\r\n      if (avgs.avg20 !== undefined || avgs.avg50 !== undefined || avgs.avg100 !== undefined) {\r\n      let avgStr = ' top20 : ' + GFunc.numberToFixString(avgs.avg20) \r\n        + '  -  top50 : ' + GFunc.numberToFixString(avgs.avg50)\r\n        + '  -  top100 : ' + GFunc.numberToFixString(avgs.avg100)\r\n        + '  -  all : ' + GFunc.numberToFixString(avgs.avg)\r\n        + '  ...查看历史走势';\r\n      avgHead = <LMR right={right}><div className=\"px-3 cursor-pointer\" onClick={this.onClickPredictAVG}>{GFunc.caption('价值指数均值')}{avgStr}</div></LMR>\r\n      }\r\n      else {\r\n      avgHead = <LMR right={right}></LMR>\r\n      }\r\n      \r\n      return <>\r\n      {avgHead}\r\n      <List header={renderSortHeaders('radioExplorer', this.setSortType)}\r\n        items={items}\r\n        item={{ render: this.renderRow, key: this.rowKey }}\r\n        before={'选股'}\r\n      />\r\n      </>\r\n    }));\r\n  }\r\n\r\n  renderRow = (item: any, index: number): JSX.Element => { //<this.rowContent {...item} />;\r\n    return this.rowContent(item);\r\n  } \r\n  protected rowContent = (row: any): JSX.Element => {\r\n    let blackList = this.controller.cApp.blackList;\r\n    let fInBlack = blackList.findIndex(v=>v===id);\r\n    if (fInBlack >= 0) return null;\r\n\r\n    let { id, symbol } = row as NStockInfo;\r\n    let labelId = 'vexl_' + id;\r\n\tlet defList = this.controller.cApp.defaultList;\r\n\tlet fInDef = defList.findIndex(v=>v===id);\r\n\tlet middle = <label className=\"mb-0 cursor-pointer\">\r\n\t\t<input className=\"mr-1\" type=\"checkbox\" value=\"\" id={labelId}\r\n\t\tdefaultChecked={fInDef >= 0}\r\n\t\tonChange={e => this.onSelect(row, e.target.checked)}/>\r\n\t\t<small className=\"text-muted\">自选</small>\r\n\t</label>;\r\n\r\n\tlet right = <div className=\"d-flex\">\r\n\t\t{renderStockUrl(row)}\r\n\t</div>;\r\n\treturn renderStockInfoRow(row, this.onClickName, middle, right);\r\n  };\r\n\r\n  private rowKey = (item: any) => {\r\n    if (item.item !== undefined) {\r\n      return item.item.id;\r\n    }\r\n    let { id } = item;\r\n    return id;\r\n  }\r\n\r\n  private setSortType = (type:string) => {\r\n    this.controller.setSortType(type);\r\n  }\r\n\r\n  protected onClickName = (item: NStockInfo) => {\r\n    this.controller.openStockInfo(item);\r\n  }\r\n\r\n  protected onSelect = async (item: any, isSelected:boolean): Promise<void> => {\r\n    this.controller.onSelectItem(item, isSelected);\r\n  }\r\n\r\n  protected onClickItem = async (item: any): Promise<void> => {\r\n    this.controller.openStockInfo(item);\r\n  }\r\n}","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport * as React from 'react';\r\nimport { observer } from 'mobx-react';\r\nimport { VPage, Page, FA, List, Form, ItemSchema, StringSchema, UiInputItem, UiSchema, Context, IdSchema, UiIdItem, LMR, UiSelect, UiTextItem } from 'tonva-react';\r\nimport { CExplorer } from './CExplorer';\r\n\r\nconst schema: ItemSchema[] = [\r\n  { name: 'irate', type: 'number', required: true},\r\n  { name: 'bmin', type: 'number', required: true},\r\n  { name: 'bmax', type: 'number', required: true},\r\n  { name: 'r2', type: 'number', required: true},\r\n  { name: 'lmin', type: 'number', required: true},\r\n  { name: 'lmax', type: 'number', required: true},\r\n  { name: 'lr2', type: 'number', required: true},\r\n  { name: 'mcount', type: 'integer', required: true},\r\n  { name: 'lr4', type: 'number', required: true},\r\n  { name: 'r210', type: 'number', required: true},\r\n  { name: 'submit', type: 'submit', },\r\n];\r\n\r\nconst uiSchema: UiSchema = {\r\n  items: {\r\n    irate: { widget: 'number', label: '无风险收益率', placeholder: '0.04'} as UiInputItem,\r\n    bmin: { widget: 'number', label: '指数回归最小值', placeholder: '0.00'} as UiInputItem,\r\n    bmax: { widget: 'number', label: '指数回归最大值', placeholder: '0.00'} as UiInputItem,\r\n    r2: { widget: 'number', label: '指数回归R2', placeholder: '0.00'} as UiInputItem,\r\n    lmin: { widget: 'number', label: '线性回归最小值', placeholder: '0.00'} as UiInputItem,\r\n    lmax: { widget: 'number', label: '线性回归最大值', placeholder: '0.00'} as UiInputItem,\r\n    lr2: { widget: 'number', label: '线性回归R2', placeholder: '0.00'} as UiInputItem,\r\n    lr4: { widget: 'number', label: '末年与前4年均值最大比值', placeholder: '0.00'} as UiInputItem,\r\n    mcount: { widget: 'number', label: '5年内单季亏损最多允许出现次数', placeholder: '0.00'} as UiInputItem,\r\n    r210: { widget: 'number', label: '十年回归R2', placeholder: '0.00'} as UiInputItem,\r\n    submit: { widget: 'button', label: '保存', className: 'btn btn-primary' },\r\n  }\r\n};\r\n\r\n\r\nexport class VExplorerCfg extends VPage<CExplorer> {\r\n  async open(param?: any) {\r\n    this.openPage(this.page);\r\n  }\r\n\r\n  sortChage = (e)=> {\r\n    let newType = e.target.value;\r\n\r\n    this.controller.cApp.setStockSortType(newType);\r\n  }\r\n\r\n  selectChange = (e)=> {\r\n    let newType = e.target.value;\r\n\r\n    this.controller.cApp.setStockSelectType(newType);\r\n  }\r\n\r\n  onChange = (e) => {\r\n    let {name, value} = e.target;\r\n  }\r\n\r\n  private onFormButtonClick = async (name: string, context: Context) => {\r\n    //await this.controller.onSaveNewWarning(context.data);\r\n    let {bmin, bmax, r2, lmin, lmax, lr2, mcount, lr4, r210, irate} = context.data;\r\n    let cfg = {bmin:bmin, bmax:bmax, r2:r2, lmin:lmin, lmax:lmax, lr2:lr2, mcount:mcount, lr4:lr4, r210:r210, irate:irate};\r\n    await this.controller.cApp.setRegressionConfig(cfg);\r\n    this.controller.closePage();\r\n  }\r\n\r\n\r\n  private page = observer(() => {\r\n    let scfg = this.controller.cApp.findStockConfg;\r\n    //let findType = scfg.sortType;\r\n    // let selectType = scfg.selectType;\r\n    // if (selectType === undefined) {\r\n    //   selectType = 'all';\r\n    // }\r\n    let fData = this.controller.cApp.config.regression;\r\n    if (fData.irate === undefined)\r\n      fData.irate = 0.04;\r\n\r\n    return <Page header=\"选股设置\" headerClassName=\"bg-primary\">\r\n      {/* <div className=\"px-3 py-2\">方法</div>\r\n      <div className=\"px-3 py-2 d-flex flex-wrap\">\r\n        <label className=\"px-3 c8\"> <input type=\"radio\" name=\"selectType\" value=\"all\" checked={selectType===\"all\"}\r\n          onChange={this.selectChange} />预期PE</label><br />\r\n        <label className=\"px-3 c8\"> <input type=\"radio\" name=\"selectType\" value=\"value\" checked={selectType===\"value\"}\r\n          onChange={this.selectChange} />价值指数</label><br />\r\n      </div> */}\r\n      <div className=\"px-3 py-2\">回归参数</div>\r\n      <Form schema={schema}\r\n          uiSchema={uiSchema}\r\n          formData={fData}\r\n          onButtonClick={this.onFormButtonClick}\r\n        />\r\n    </Page>;\r\n  })\r\n}\r\n","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport { observable, IObservableArray, computed } from 'mobx';\r\nimport * as React from 'react';\r\nimport { autorun } from 'mobx';\r\nimport { ErForEarning, SlrForEarning } from 'regression';\r\nimport { CUqBase } from '../UqApp';\r\nimport { CStockInfo, NStockInfo } from '../stockinfo';\r\nimport { VSiteHeader } from './VSiteHeader';\r\nimport { VExplorer } from './VExplorer';\r\nimport { VExplorerCfg } from './VExplorerCfg';\r\nimport { GFunc } from 'tool/GFunc';\r\n\r\nexport class CExplorer extends CUqBase {\r\n  items: IObservableArray<any> = observable.array<any>([], { deep: true });\r\n  @observable avgs : {avg20?:number, avg50?:number, avg100?:number, avg?:number} = {};\r\n  lastTradeDay: number;\r\n  protected oldSelectType: string;\r\n  selectedItems: any[] = [];\r\n\r\n  disposeAutorun = autorun(async () => {\r\n    let newSelectType = this.cApp.config.stockFind.selectType;\r\n    if (newSelectType === this.oldSelectType)\r\n      return;\r\n    if (this.oldSelectType === undefined) {\r\n      this.oldSelectType = newSelectType;\r\n      return;\r\n    }\r\n    this.oldSelectType = newSelectType;\r\n    await this.load();\r\n  });\r\n\r\n  onPage = async () => {\r\n    //this.PageItems.more();\r\n  }\r\n\r\n  onConfig = async () => {\r\n    this.openVPage(VExplorerCfg);\r\n  }\r\n\r\n  async internalStart(param: any) {\r\n  }\r\n\r\n  reload = async () => {\r\n    await this.load();\r\n  }\r\n\r\n  load = async () => {\r\n    this.selectedItems = [];\r\n    await this.loadItems();\r\n  }\r\n\r\n  async loadItems() {\r\n    let queryName = 'all';\r\n    //let sName = this.cApp.config.stockFind.selectType;\r\n    let {bmin, bmax, r2, lmin, lmax, lr2, mcount, lr4, r210, irate} = this.cApp.config.regression;\r\n    //if (sName !== undefined)\r\n    //  queryName = sName;\r\n    let query = {\r\n      name: queryName,\r\n      pageStart: 0,\r\n      pageSize: 3000,\r\n      user: this.user.id,\r\n      blackID:this.cApp.blackListTagID,\r\n      bMin: bmin,\r\n      bMax: bmax,\r\n      r2: r2,\r\n      lMin: lmin,\r\n      lMax: lmax,\r\n      lr2: lr2,\r\n      mcount: mcount,\r\n      lr4: lr4,\r\n      r210: r210,\r\n    };\r\n    let rets = await Promise.all([\r\n\t\tthis.cApp.miApi.process(query, []),\r\n        this.cApp.miApi.call('q_getlasttradeday', [])\r\n    ]);\r\n    let lastDayRet = rets[1] as {day:number}[];\r\n    if (Array.isArray(lastDayRet) && lastDayRet.length > 0) {\r\n      this.lastTradeDay = lastDayRet[0].day;\r\n    }\r\n    else {\r\n      this.lastTradeDay = undefined;\r\n    }\r\n    let result = rets[0];\r\n    if (Array.isArray(result) === false) {\r\n      return;\r\n    };\r\n    let arr = result as {id:number, data?:string, v:number, pe:number, e:number, ep:number, price:number, exprice:number, divyield:number, r2:number, lr2:number, e3:number, predictpe:number, order:number, ma:number, dataArr?:number[]}[];\r\n    for (let item of arr) {\r\n      let dataArray = JSON.parse(item.data) as number[];\r\n      item.dataArr = dataArray;\r\n      let sl = new SlrForEarning(dataArray);\r\n      //let ep = GFunc.evaluatePricePrice(irate, sl.predict(5), sl.predict(6), sl.predict(7));\r\n      item.ep = (sl.predict(4) + item.e) / 2;\r\n      item.v = GFunc.calculateVN(sl.slopeR, item.ep, item.divyield * item.price, item.exprice);\r\n      item.e3 = sl.predict(7);\r\n    }\r\n    if (queryName === 'all') {\r\n      this.cApp.sortStocks(arr);\r\n      this.avgs = GFunc.CalculateValueAvg(arr);\r\n    }\r\n    else {\r\n      this.avgs = {};\r\n    }\r\n    this.items.clear();\r\n    this.items.push(...arr);\r\n  }\r\n\r\n  onSelectItem = async (item:any, isSelected:boolean) => {\r\n    let tagid = this.cApp.defaultListTagID;\r\n    if (isSelected === true) {\r\n      await this.cApp.miApi.call('t_tagstock$add', [this.user.id, tagid, item.id]);\r\n      await this.cApp.AddTagStockID(tagid, item.id);\r\n    }\r\n    else {\r\n      await this.cApp.miApi.call('t_tagstock$del', [this.user.id, tagid, item.id]);\r\n      await this.cApp.RemoveTagStockID(tagid, item.id);\r\n    }\r\n  }\r\n\r\n  setSortType = (type:string) => {\r\n    this.cApp.setUserSortType(type);\r\n    let arr = this.items.slice();\r\n    this.cApp.sortStocks(arr);\r\n\r\n    this.items.replace(arr);\r\n  }\r\n\r\n  renderSiteHeader = () => {\r\n    return this.renderView(VSiteHeader);\r\n  }\r\n\r\n  renderHome = () => {\r\n    return this.renderView(VExplorer);\r\n  }\r\n\r\n\r\n  openMetaView = () => {\r\n  }\r\n\r\n  tab = () => {\r\n    return this.renderHome()\r\n  }\r\n\r\n  openStockInfo = (item: NStockInfo) => {\r\n    let cStockInfo = this.newC(CStockInfo);\r\n    cStockInfo.start(item);\r\n  }\r\n}","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport * as React from 'react';\r\nimport { observer } from 'mobx-react-lite';\r\nimport { VPage, Page, FA, List, Form, ItemSchema, StringSchema, UiInputItem, UiSchema, Context, IdSchema, UiIdItem, LMR, UiSelect, UiTextItem } from 'tonva-react';\r\nimport { CWarning } from './CWarning';\r\nimport { GFunc } from 'tool/GFunc';\r\n\r\nexport class VWarningConfig extends VPage<CWarning> {\r\n  async open(param?: any) {\r\n    this.openPage(this.page);\r\n  }\r\n\r\n  private onSelect = (item: any, isSelected: boolean, anySelected: boolean) => {\r\n    //this.controller.onTaged(item, isSelected);\r\n  }\r\n\r\n  private page = observer(() => {\r\n    let { warnings } = this.controller;\r\n    let divNewTag = warnings.length >= 100 ? '' :\r\n      <div className=\"px-3 py-2 cursor-pointer\" onClick={this.controller.onNewWarning}><FA name=\"plus\" className=\"text-primary\" /> &nbsp; 新建预警</div>;\r\n    return <Page header=\"预警\" headerClassName=\"bg-primary\">\r\n      {divNewTag}\r\n      <List items={warnings} \r\n        item={{ render: this.renderWarning }} \r\n        none={'--'} />\r\n    </Page>;\r\n  })\r\n\r\n  private renderWarning = (witem: any) => {\r\n    let {name, code, type, price} = witem;\r\n    let left = <div className=\"px-3 cursor-pointer\">\r\n      {name}\r\n      <small className=\" mx-3\" >{code}</small></div>;\r\n    return <LMR className=\"mx-3 my-2\" left={left} >\r\n      <div className=\"d-flex flex-wrap\">\r\n        <div className=\"px-3 c6\">{GFunc.warningTypeString(type)}</div>\r\n        <div className=\"px-3 c6\">{GFunc.numberToFixString(price)}</div>\r\n      </div>\r\n    </LMR>;\r\n  }\r\n}\r\n\r\nconst schema: ItemSchema[] = [\r\n  { name: 'id', type: 'id' } as IdSchema,\r\n  { name: 'type', type: 'string', required: true, maxLength: 2 } as StringSchema,\r\n  { name: 'price', type: 'number', required: true},\r\n  { name: 'submit', type: 'submit', },\r\n];\r\n\r\nconst uiSchema: UiSchema = {\r\n  items: {\r\n    id: { widget: 'id',\r\n      label: '股票',\r\n      visible: true} as UiIdItem,\r\n    type: { widget: 'select', label: '类型', \r\n    list: [{value:'gt', title:'大于'}, {value:'lt', title:'小于'}] } as UiSelect,\r\n    price: { widget: 'text', label: '价格', placeholder: '0.00'} as UiTextItem,\r\n    submit: { widget: 'button', label: '保存', className: 'btn btn-primary' },\r\n  }\r\n};\r\n\r\nexport class VNewWarning extends VPage<CWarning> {\r\n  async open(param?: any) {\r\n    this.openPage(this.page);\r\n  }\r\n\r\n  private newuiSchema: UiSchema = {\r\n    items: {\r\n      id: { widget: 'id',\r\n        label: '股票',\r\n        visible: true,\r\n        placeholder: <small className=\"text-muted\">请选择股票</small>,\r\n        pickId: async (context: Context, name: string, value: number) => {\r\n          return await this.controller.showSelectStock(context, name, value)\r\n        },\r\n        Templet: (item: any) => {\r\n          let { name, code } = item;\r\n          if (!item) return <small className=\"text-muted\">请选择股票</small>;\r\n          return <div>\r\n              {name}\r\n              <small className=\" mx-3\" >{code}</small>\r\n          </div>;\r\n        }\r\n      } as UiIdItem,\r\n      type: { widget: 'select', label: '类型', \r\n      list: [{value:'gt', title:'大于'}, {value:'lt', title:'小于'}] } as UiSelect,\r\n      price: { widget: 'text', label: '价格', placeholder: '0.00'} as UiTextItem,\r\n      submit: { widget: 'button', label: '保存', className: 'btn btn-primary' },\r\n    }\r\n  };\r\n  \r\n  private onFormButtonClick = async (name: string, context: Context) => {\r\n    await this.controller.onSaveNewWarning(context.data);\r\n  }\r\n\r\n  private page = () => {\r\n    let fData = {type:'lt'};\r\n    return <Page header=\"新建预警\" headerClassName=\"bg-primary\">\r\n      <div className=\"px-3 py-3\">\r\n        <Form schema={schema}\r\n          uiSchema={this.newuiSchema}\r\n          formData={fData}\r\n          onButtonClick={this.onFormButtonClick}\r\n        />\r\n      </div>\r\n    </Page>;\r\n  }\r\n}\r\n\r\nexport class VEditWarning extends VPage<CWarning> {\r\n  async open(param?: any) {\r\n    this.openPage(this.page, param);\r\n  }\r\n\r\n  private onFormButtonClick = async (name: string, context: Context) => {\r\n    await this.controller.onSaveWarning(context.data);\r\n  }\r\n\r\n  private page = (param?: any) => {\r\n    let {id, type, price} = param;\r\n    let fData = {id:id, type:type, price:price};\r\n    return <Page header=\"编辑预警\" headerClassName=\"bg-primary\">\r\n      <div className=\"px-3 py-3\">\r\n        <Form schema={schema}\r\n          uiSchema={uiSchema}\r\n          formData={fData}\r\n          onButtonClick={this.onFormButtonClick}\r\n        />\r\n      </div>\r\n    </Page>;\r\n  }\r\n}\r\n","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport { Context } from 'tonva-react';\r\nimport { observable } from 'mobx';\r\nimport { CApp, CUqBase } from '../UqApp';\r\nimport { CStock } from '../stock';\r\nimport { VWarningConfig, VNewWarning } from './VWarningConfig';\r\n\r\nexport class CWarning extends CUqBase {\r\n  get cApp(): CApp { return this._cApp as CApp };\r\n  @observable warnings:any[] = [];\r\n\r\n  async internalStart(param: any) {\r\n    let a = 1;\r\n  }\r\n\r\n  async loadWarnings() {\r\n    let r = await this.cApp.miApi.call('t_stockwarning$all', [this.user.id]);//await this.uqs.mi.StockWarningAll.query(undefined);\r\n    let ret = r as any[];\r\n    this.warnings = ret;\r\n  }\r\n\r\n  onNewWarning = () => {\r\n    this.openVPage(VNewWarning);\r\n  }\r\n\r\n  onWarningConfg = async () => {\r\n    await this.loadWarnings();\r\n    this.openVPage(VWarningConfig);\r\n  }\r\n\r\n  onSaveNewWarning = async (data: any) => {\r\n    let { id, type, price } = data;\r\n    // let param = {\r\n    //   user: this.cApp.user.id,\r\n    //   stock: id,\r\n    //   arr1: [\r\n    //     { type: type, price: price }\r\n    //   ]};\r\n    //let ret = await this.uqs.mi.StockWarning.add(param);\r\n    await this.cApp.miApi.call('t_stockwarning$add', [this.cApp.user.id, id.id, type, price]);\r\n    this.closePage();\r\n  }\r\n\r\n  onSaveWarning = async (data: any) => {\r\n\r\n  }\r\n\r\n  showSelectStock = async (context: Context, name: string, value: number): Promise<any> => {\r\n    let cStock = new CStock(this.cApp);\r\n    return await cStock.call();\r\n  }\r\n}","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport * as React from 'react';\r\nimport { observer } from 'mobx-react';\r\nimport RC2 from 'react-chartjs2'\r\nimport { VPage, Page, View, List, LMR, FA } from 'tonva-react';\r\nimport { CPredictHistory } from './CPredictHistory';\r\n\r\nexport class VPredictHistory extends VPage<CPredictHistory> {\r\n  async open(param?: any) {\r\n    this.openPage(this.page);\r\n  }\r\n\r\n  render(param: any): JSX.Element {\r\n    return <this.page />\r\n  }\r\n\r\n  private page = observer(() => {\r\n    return <Page header=\"预期收益比均值历史\">\r\n      <this.pageContent />\r\n    </Page>;\r\n  })\r\n\r\n  private pageContent = observer(() => {\r\n    return <>\r\n    <this.historyChart />\r\n    </>\r\n  });\r\n\r\n  protected historyChart = observer(() => {\r\n    let {items} = this.controller;\r\n    if (items === undefined) \r\n      return <></>;\r\n    let chartHistory = <></>;\r\n    let labelList:any[] = [];\r\n    let avg20List:number[] = [];\r\n    let avg50List:number[] = [];\r\n    let avg100List:number[] = [];\r\n    for (let item of items) {\r\n      let {day, avg20, avg50, avg100} = item;\r\n      labelList.push(day);\r\n      avg20List.push(avg20);\r\n      avg50List.push(avg50);\r\n      avg100List.push(avg100);\r\n    }\r\n    let chartdata1 = {\r\n      labels: labelList,\r\n      datasets: [\r\n        {\r\n          label: 'avg20',\r\n          data: avg20List,\r\n          borderColor:'blue',\r\n          backgroundColor:'skyBlue',\r\n          borderWidth: 1,\r\n          fill: false,\r\n          yAxisID: 'y-axis-1',\r\n        },\r\n        {\r\n          label: 'avg50',\r\n          data: avg50List,\r\n          borderColor:'red',\r\n          backgroundColor:'pink',\r\n          borderWidth: 1,\r\n          fill: false,\r\n          yAxisID: 'y-axis-1',\r\n        },\r\n        {\r\n          label: 'avg100',\r\n          data: avg100List,\r\n          borderColor:'DarkGreen',\r\n          backgroundColor:'green',\r\n          borderWidth: 1,\r\n          fill: false,\r\n          yAxisID: 'y-axis-1',\r\n        },\r\n      ]\r\n    };\r\n    let options = {\r\n      scales:{\r\n        yAxes: [{\r\n            type: 'linear',\r\n            display: true,\r\n            position: 'right',\r\n            id: 'y-axis-1',\r\n        }],       \r\n      }\r\n    }\r\n\r\n    chartHistory = <RC2 data={chartdata1} type='line' options={options}/>;\r\n    return <><LMR className=\"px-3 py-2 bg-white\" left={'历史走势'}></LMR>\r\n      <div className=\"px-3\" style={{width:'95%'}}>{chartHistory}</div>\r\n    </>;\r\n  });\r\n\r\n}","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport { observable, IObservableArray } from 'mobx';\r\nimport { CUqBase } from '../UqApp';\r\nimport { VPredictHistory } from './VPredictHistory'\r\n\r\nexport interface PredictHistoryParam {\r\n  day?:number,\r\n  priceDay?:number,\r\n  avg20?:number,\r\n  avg50?:number,\r\n  avg100?:number,\r\n  avg?:number,\r\n}\r\n\r\ninterface PredictItem {\r\n  day:number, \r\n  avg20:number, \r\n  avg50:number,\r\n  avg100:number,\r\n  avg?:number\r\n}\r\n\r\nexport class CPredictHistory extends CUqBase {\r\n  items: IObservableArray<PredictItem> = observable.array<PredictItem>([], { deep: true });\r\n  day: number;\r\n  protected lastItem: PredictItem;\r\n\r\n  async internalStart(param: any) {\r\n    let p = param as PredictHistoryParam;\r\n    if (p !== undefined) {\r\n      this.day = p.day;\r\n      if (p.priceDay !== undefined) {\r\n        this.lastItem = {day:p.priceDay, avg20:p.avg20, avg50:p.avg50, avg100:p.avg100};\r\n      }\r\n      else {\r\n        this.lastItem = undefined;\r\n      }\r\n    }\r\n    else {\r\n      this.day = undefined;\r\n      this.lastItem = undefined;\r\n    }\r\n    await this.load();\r\n    this.openVPage(VPredictHistory as any);\r\n  }\r\n\r\n  async load() {\r\n    let ret = await this.cApp.miApi.call('t_toppredictavg$query', [this.day]) as PredictItem[];\r\n    this.items.clear();\r\n    if (!Array.isArray(ret))\r\n      return;\r\n    this.items.push(...ret);\r\n    if (this.lastItem !== undefined) {\r\n      let li = {...this.lastItem};\r\n      this.items.push(li);\r\n    }\r\n  }\r\n\r\n}","import { zh } from \"./zh\";\r\nimport { en } from \"./en\";\r\n\r\nexport const res = {\r\n\t$zh: zh,\r\n\t$en: en,\r\n}\r\n","export const zh = {\r\n\thome: '首页',\r\n\trelation: '关系',\r\n\tdiscover: '发现',\r\n\tme: '我的',\r\n\r\n\tchangePassword: '修改密码',\r\n\taboutTheApp: '关于本APP',\r\n\tlogout: '退出登录',\r\n\tpleaseLogin: '登录',\r\n\r\n\tnotes: '小单',\r\n\ttask: '任务',\r\n\tassign: '作业单',\r\n\r\n\tnoteSpace: '群',\r\n\r\n\tnoteText: '文字单',\r\n\tnoteList: '列表单',\r\n\tnoteCheckable: '勾选单',\r\n\tnoteTask: '布置任务',\r\n\tnoteFolder: '小单夹',\r\n\tnoteCreateSpace: '新建群',\r\n\r\n\tcontent: '内容',\r\n}\r\n","export const en = {\r\n\thome: 'Home',\r\n\trelation: 'Relation',\r\n\tdiscover: 'Discover',\r\n\tme: 'Me',\r\n\r\n\tchangePassword: 'Change password',\r\n\taboutTheApp: 'About the APP',\r\n\tlogout: 'Logout',\r\n\tpleaseLogin: 'Login',\r\n\r\n\tnotes: 'Notes',\r\n\ttask: 'Task',\r\n\tassign: 'Assign',\r\n\r\n\tnoteSpace: 'Group',\r\n\r\n\tnoteText: 'Text',\r\n\tnoteList: 'List',\r\n\tnoteCheckable: 'Checkable',\r\n\tnoteTask: 'Task',\r\n\tnoteFolder: 'Folder',\r\n\tnoteCreateSpace: 'Create Group',\r\n\r\n\tcontent: 'Content',\r\n}\r\n","import { FA, List, LMR, VPage } from \"tonva-react\";\r\nimport { CHolding } from \"./CHolding\";\r\nimport { Account, AccountValue } from \"UqApp/uqs/BruceYuMi\";\r\n\r\nexport class VHolding extends VPage<CHolding> {\r\n\theader() {return <span className=\"ml-3\">持仓组合 <small className=\"text-muted\">正在设计实现中...</small></span>}\r\n\tcontent() {\r\n\t\treturn <div>\r\n\t\t\t<List items={this.controller.accounts} item={{render: this.renderAccount, onClick: this.onClickAccount}} />\r\n\t\t</div>;\r\n\t}\r\n\r\n\tprivate renderAccount = (item:Account&AccountValue, index:number):JSX.Element => {\r\n\t\tfunction renderValue(caption:string, value:number) {\r\n\t\t\treturn <span className=\"mr-3\"><small className=\"text-muted\">{caption}: </small>{value??0}</span>;\r\n\t\t}\r\n\t\tlet {id, no, name, mi, market, count} = item;\r\n\t\tlet right = <div className=\"px-2 d-flex align-items-center\">\r\n\t\t\t<FA className=\"align-\" name=\"angle-right\" />\r\n\t\t</div>;\r\n\t\treturn <LMR right={right}>\r\n\t\t\t<div className=\"px-3 py-2 bg-white d-block\">\r\n\t\t\t\t<div>{name}</div>\r\n\t\t\t\t<div className=\"mt-2\">\r\n\t\t\t\t\t<span className=\"mr-3 small\">共{count??0}只</span>\r\n\t\t\t\t\t{renderValue('总米值', mi as number)}\r\n\t\t\t\t\t{renderValue('总市值', market as number)}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</LMR>;\r\n\t}\r\n\r\n\tprivate onClickAccount = (item:Account&AccountValue) => {\r\n\t\tthis.controller.showAccount(item);\r\n\t}\r\n}","import { FA, LMR, VPage } from \"tonva-react\";\r\nimport { CHolding } from \"./CHolding\";\r\n\r\nexport class VAccount extends VPage<CHolding> {\r\n\theader() {return this.controller.account.name}\r\n\tcontent() {\r\n\t\tfunction renderValue(caption:string, value:number) {\r\n\t\t\treturn <span className=\"mr-3\"><small className=\"text-muted\">{caption}: </small>{value??0}</span>;\r\n\t\t}\r\n\t\tlet {id, no, name, mi, market, count} = this.controller.account;\r\n\t\treturn <div className=\"mt-3 px-3 py-2 bg-white d-block\">\r\n\t\t\t<LMR right={<small className=\"text-muted\">组合编号: {no}</small>}>\r\n\t\t\t\t{name}\r\n\t\t\t</LMR>\r\n\t\t\t<div className=\"mt-2\">\r\n\t\t\t\t<span className=\"mr-3 small\">共{count??0}只</span>\r\n\t\t\t\t{renderValue('总米值', mi as number)}\r\n\t\t\t\t{renderValue('总市值', market as number)}\r\n\t\t\t</div>\r\n\t\t</div>;\r\n\t}\r\n}\r\n","import { makeObservable, observable } from \"mobx\";\r\nimport { ParamID, ParamIDinIX, ParamIX } from \"tonva-react\";\r\nimport { CApp, CUqBase } from \"UqApp\";\r\nimport { Account, AccountValue } from \"UqApp/uqs/BruceYuMi\";\r\nimport { VHolding } from \"./VHolding\";\r\nimport { VAccount } from \"./VAccount\";\r\n\r\nexport class CHolding extends CUqBase {\r\n\taccounts: (Account&AccountValue)[];\r\n\taccount: Account&AccountValue;\r\n\r\n\tconstructor(cApp: CApp) {\r\n\t\tsuper(cApp);\r\n\t\tmakeObservable(this, {\r\n\t\t\taccounts: observable,\r\n\t\t});\r\n\t}\r\n\r\n\tprotected async internalStart() {\r\n\t}\r\n\t\r\n\ttab = () => {\r\n\t\treturn this.renderView(VHolding);\r\n\t}\r\n\r\n\tload = async () => {\r\n\t\tlet {BruceYuMi} = this.uqs;\r\n\t\tlet {Account, UserAccount} = BruceYuMi;\r\n\t\tlet param:ParamIDinIX = {\r\n\t\t\tID: Account,\r\n\t\t\tIX: UserAccount,\r\n\t\t\tid: this.user.id,\r\n\t\t};\r\n\t\tlet ret = await BruceYuMi.IDinIX<Account>(param);\r\n\t\tif (ret.length === 0) {\r\n\t\t\t// 没有持仓账号，则创建默认账号\r\n\t\t\tlet accountNO = await BruceYuMi.IDNO({ID: Account});\r\n\t\t\tlet retActs = await BruceYuMi.IDActs({\r\n\t\t\t\taccount: [{\r\n\t\t\t\t\tid: undefined, \r\n\t\t\t\t\tno: accountNO, \r\n\t\t\t\t\tname: '我的持仓组合', \r\n\t\t\t\t}]\r\n\t\t\t});\r\n\t\t\tret = await BruceYuMi.IDinIX(param);\r\n\t\t}\r\n\t\tlet paramValue:ParamID = {\r\n\t\t\tIDX: BruceYuMi.AccountValue,\r\n\t\t\tid: ret.map(v => (v as unknown as Account).id),\r\n\t\t}\r\n\t\tlet values = await BruceYuMi.ID<AccountValue>(paramValue);\r\n\t\tthis.accounts = ret as unknown as (Account&AccountValue)[];\r\n\t\tthis.accounts.forEach(account => {\r\n\t\t\tlet {id} = account;\r\n\t\t\tlet value = values.find(v => v.id === id);\r\n\t\t\tif (value) {\r\n\t\t\t\tObject.assign(account, value);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tshowAccount = async (item:Account&AccountValue) => {\r\n\t\tthis.account = item;\r\n\t\tthis.openVPage(VAccount);\r\n\t};\r\n}\r\n","//=== UqApp builder created on Mon Mar 01 2021 15:27:12 GMT-0500 (GMT-05:00) ===//\r\nimport { VPage, TabCaptionComponent, Page, TabProp } from 'tonva-react';\r\nimport { CApp } from './CApp';\r\n\r\nconst color = (selected: boolean) => selected === true ? 'text-primary' : 'text-muted';\r\n\r\nexport class VMain extends VPage<CApp> {\r\n\tasync open(param?: any) {\r\n\t\tthis.openPage(this.render);\r\n\t}\r\n\trender = (param?: any): JSX.Element => {\r\n\t\tlet { cHome, cHolding, cExporer, cMe } = this.controller;\r\n\t\tlet tabs: TabProp[] = [\r\n\t\t\t{ \r\n\t\t\t\tname: 'home', label: '首页', icon: 'home', content: cHome.tab, \r\n\t\t\t\tnotify: undefined, \r\n\t\t\t\t//load: cHome.load, \r\n\t\t\t\tonShown: cHome.load,\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tname: 'explorer', label: '持仓', icon: 'money', content: cHolding.tab, load: cHolding.load \r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tname: 'explorer', label: '选股', icon: 'search', content: cExporer.tab, load: cExporer.load \r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tname: 'me', label: '我的', icon: 'user', content: cMe.tab, onShown: undefined\r\n\t\t\t}\r\n\t\t].map(v => {\r\n\t\t\tlet { name, label, icon, content, notify, load, onShown } = v;\r\n\t\t\treturn {\r\n\t\t\t\tname,\r\n\t\t\t\tcaption: (selected: boolean) => TabCaptionComponent(label, icon, color(selected)),\r\n\t\t\t\tcontent,\r\n\t\t\t\tnotify,\r\n\t\t\t\tload,\r\n\t\t\t\tonShown,\r\n\t\t\t};\r\n\t\t});\r\n\t\treturn <Page header={false} tabsProps={{tabs}} />\r\n\t}\r\n}\r\n","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport { observable, computed } from 'mobx';\r\nimport { Controller, VPage } from 'tonva-react';\r\nimport { CHome } from '../home';\r\nimport { CMe } from '../me';\r\nimport { consts, defaultBlackListTagName, defaultTagName } from '../consts';\r\nimport { MiApi } from '../net';\r\nimport { CExplorer } from '../explorer';\r\nimport { MiConfigs, StockFindConfig, IdName, RegressionConfig } from '../types';\r\nimport { CWarning } from '../warning';\r\nimport { CPredictHistory } from '../predicthistory';\r\nimport { CUqApp } from './CBase';\r\nimport { res } from './res';\r\nimport { CHolding } from 'holding';\r\nimport { VMain } from './VMain';\r\n\r\nexport class CApp extends CUqApp {\r\n  cHome: CHome;\r\n  cHolding: CHolding;\r\n  cExporer: CExplorer;\r\n  cWarning: CWarning;\r\n  cMe: CMe;\r\n  miApi: MiApi;\r\n  @observable config: MiConfigs = { \r\n    tagName: defaultTagName, \r\n    stockFind: { sortType:'pe' },\r\n    userStock: { sortType:'tagpe'},\r\n    regression: {bmin:0, bmax:0.5, r2:0.7, lmin:0.01, lmax:0.5, lr2:0.7, mcount:2, lr4: 3, r210:0.6, irate:0.04}\r\n  };\r\n  @observable tags: IdName[] = undefined;\r\n  @observable blackList: any[] = [];\r\n  @observable defaultList: any[] = [];\r\n  @observable accounts: IdName[] = undefined;\r\n\r\n  @computed get tagID(): number {\r\n    if (this.tags !== undefined) {\r\n      let name = this.config.tagName;\r\n      let i = this.tags.findIndex(v => v.name === name);\r\n      if (i >= 0) {\r\n        return this.tags[i].id as number;\r\n      }\r\n    }\r\n    return -1;\r\n  }\r\n\r\n  @computed get accountID(): number {\r\n    let name = this.config.accountName;\r\n    if (name !== undefined && this.accounts !== undefined) {\r\n      let i = this.accounts.findIndex(v => v.name === name);\r\n      if (i >= 0) {\r\n        return this.accounts[i].id as number;\r\n      }\r\n    }\r\n    return -1;\r\n  }\r\n\r\n  get findStockConfg(): StockFindConfig {\r\n    return this.config.stockFind;\r\n  }\r\n\r\n  @computed get blackListTagID(): number {\r\n    if (this.tags !== undefined) {\r\n      let name = this.config.tagName;\r\n      let i = this.tags.findIndex(v => v.name === defaultBlackListTagName);\r\n      if (i >= 0) {\r\n        return this.tags[i].id as number;\r\n      }\r\n    }\r\n    return -1;\r\n  }\r\n\r\n  @computed get defaultListTagID(): number {\r\n    if (this.tags !== undefined) {\r\n      let name = this.config.tagName;\r\n      let i = this.tags.findIndex(v => v.name === defaultTagName);\r\n      if (i >= 0) {\r\n        return this.tags[i].id as number;\r\n      }\r\n    }\r\n    return -1;\r\n  }\r\n\r\n  protected async internalStart() {\r\n\tthis.setRes(res);\r\n    if (this.isLogined) {\r\n    }\r\n\r\n    let token = this.user.token;\r\n\r\n    //let miHost = consts.isDevelopment ? consts.miApiHostDebug : consts.miApiHost;\r\n\tlet miHost = consts.miApiHost;\r\n    this.miApi = new MiApi(miHost, 'fsjs/', 'miapi', token, false);\r\n    this.cHome = this.newC(CHome);\r\n    this.cExporer = this.newC(CExplorer);\r\n    this.cHolding = this.newC(CHolding);\r\n\tthis.cMe = this.newC(CMe);\r\n    this.cWarning = this.newC(CWarning);\r\n\r\n    //some test code\r\n    //let params = [];\r\n    //let ret = await this.miApi.page('q_stocksquery', params, 0, 100);\r\n    let env = process.env;\r\n    //\r\n    await this.loadConfig();\r\n    //await this.cHome.loadWarning();\r\n\tawait this.cHome.load();\r\n    this.openVPage(VMain);\r\n  }\r\n\r\n  async saveConfig() {\r\n    let v = JSON.stringify(this.config);\r\n    await this.miApi.call('t_usersettings$save', [this.user.id, 'config', v]);\r\n  }\r\n\r\n  protected async loadConfig() {\r\n    let rets = await Promise.all([this.miApi.query('t_usersettings$query', [this.user.id, 'config']),\r\n        this.loadTags(),\r\n        this.loadAccounts()]);\r\n    let r = rets[0];\r\n    if (r !== undefined) {\r\n      let ret = r;\r\n      if (ret !== undefined && ret.length > 0) {\r\n        let cStr = ret[0].value;\r\n        let c = JSON.parse(cStr);\r\n        if (this.tags !== undefined) {\r\n          let name = c.tagName;\r\n          let i = this.tags.findIndex(v => v.name === name);\r\n          if (i < 0 && this.tags.length > 0) {\r\n            i = this.tags.findIndex(v => v.name === defaultTagName);\r\n            if (i >= 0) {\r\n              c.tagName = defaultTagName;\r\n            }\r\n            else {\r\n              c.tagName = this.tags[0].name;\r\n            }\r\n          }\r\n        }\r\n        this.config = c;\r\n      }\r\n    }\r\n    if (this.config.stockFind === undefined) {\r\n      this.config.stockFind = { sortType: 'pe' };\r\n    }\r\n    else {\r\n      switch (this.config.stockFind.selectType) {\r\n        case 'all': break;\r\n        case 'peroe': break;\r\n        case 'pe': break;\r\n        case 'dp': break;\r\n        default:\r\n          this.config.stockFind.selectType = 'all';\r\n          break;\r\n      }\r\n    }\r\n    if (this.config.userStock === undefined) {\r\n      this.config.userStock = { sortType: 'tagpe' };\r\n    }\r\n    if (this.config.regression === undefined) {\r\n      this.config.regression = {bmin:0, bmax:0.5, r2:0.7, lmin:0.01, lmax:0.5, lr2:0.7, mcount:2, lr4: 3, r210:0.6, irate:0.04};\r\n    }\r\n    else {\r\n      if (this.config.regression.r210 === undefined) {\r\n        this.config.regression.r210 = 0.6;\r\n      }\r\n      if (this.config.regression.irate === undefined) {\r\n        this.config.regression.irate = 0.04;\r\n      }\r\n    }\r\n    await this.loadBlackList();\r\n    await this.loadDefaultList();\r\n  }\r\n\r\n  getsortFunc = () => {\r\n    let sortType = this.config.userStock.sortType;\r\n    if (sortType === 'tagpe') {\r\n      return (a, b) => {\r\n        return a.pe - b.pe;\r\n      }\r\n    }\r\n    else if (sortType === 'tagdp') {\r\n      return (a, b) => {\r\n        return b.divyield - a.divyield;\r\n      }\r\n    }\r\n    else {\r\n      return (a, b) => {\r\n        return b.v - a.v;\r\n      }\r\n    }\r\n  }\r\n\r\n  sortStocks = (arr:any[]) => {\r\n    arr.sort(this.getsortFunc());\r\n    let o = 1;\r\n    for (let item of arr) {\r\n      item.order = o;\r\n      ++o;\r\n    }\r\n  }\r\n\r\n\r\n  setStockSortType = async (type:string)=> {\r\n    if (this.config.stockFind.sortType === type)\r\n      return;\r\n    this.config.stockFind.sortType = type;\r\n    await this.saveConfig();\r\n  }\r\n\r\n  setStockSelectType = async (type:string) => {\r\n    if (this.config.stockFind.selectType === type)\r\n      return;\r\n    this.config.stockFind.selectType = type;\r\n    await this.saveConfig();\r\n  }\r\n\r\n  setUserSortType = async (type:string)=> {\r\n    if (this.config.userStock.sortType === type)\r\n      return;\r\n    this.config.userStock.sortType = type;\r\n    await this.saveConfig();\r\n  }\r\n\r\n  selectTag = async (item:any) => {\r\n    let {name, id} = item as {name:string, id:number};\r\n    let i = this.tags.findIndex(v => v.name === name);\r\n    if (i >= 0) {\r\n      this.config.tagName = name;\r\n      this.saveConfig();\r\n    }\r\n  }\r\n\r\n  selectAccount = async (item:any) => {\r\n    let {name, id} = item as {name:string, id:number};\r\n    let i = this.accounts.findIndex(v => v.name === name);\r\n    if (i >= 0) {\r\n      this.config.accountName = name;\r\n      this.saveConfig();\r\n    }\r\n  }\r\n\r\n  setRegressionConfig = async (cfg: RegressionConfig) => {\r\n    this.config.regression = cfg;\r\n    await this.saveConfig();\r\n  }\r\n\r\n  protected async loadTags(): Promise<void> {\r\n    if (this.tags === undefined) {\r\n      let r = await this.miApi.query('t_tag$all', [this.user.id]);\r\n      let ret = r as any[];\r\n      let bc = await this.checkDefaultTags(ret);\r\n      if (bc) {\r\n        r = await this.miApi.query('t_tag$all', [this.user.id]);\r\n        ret = r as any[];\r\n      }\r\n      let r1 = [];\r\n      let i = ret.findIndex(v=>v.name === defaultTagName);\r\n      if (i >= 0) {\r\n        r1.push(ret[i]);\r\n        ret.splice(i, 1);\r\n      }\r\n      i = ret.findIndex(v=> v.name === defaultBlackListTagName);\r\n      if (i >= 0) {\r\n        r1.push(ret[i]);\r\n        ret.splice(i, 1);\r\n      }\r\n      r1.push(...ret);\r\n      this.tags = r1;\r\n    }\r\n  }\r\n\r\n  protected async checkDefaultTags(list:any[]): Promise<boolean> {\r\n    let br = false;\r\n    if (list === undefined) {\r\n      await this.miApi.call('t_tag$save', [this.user.id, undefined, defaultTagName]);\r\n      await this.miApi.call('t_tag$save', [this.user.id, undefined, defaultBlackListTagName]);\r\n      br = true;\r\n    }\r\n    else {\r\n      let param;\r\n      let i = list.findIndex(v => v.name === defaultTagName);\r\n      if (i < 0) {\r\n        await this.miApi.call('t_tag$save', [this.user.id, undefined, defaultTagName]);\r\n        br = true;\r\n      }\r\n      i = list.findIndex(v => v.name === defaultBlackListTagName);\r\n      if (i < 0) {\r\n        await this.miApi.call('t_tag$save', [this.user.id, undefined, defaultBlackListTagName]);\r\n        br = true;\r\n      }\r\n    }\r\n\r\n    return br;\r\n  }\r\n\r\n  protected async loadAccounts(): Promise<void> {\r\n    let r = await this.miApi.query('t_allaccounts', [this.user.id]);\r\n    if (Array.isArray(r)) {\r\n      this.accounts = r;\r\n    }\r\n  }\r\n\r\n  protected async loadBlackList(): Promise<void> {\r\n    let blackid = this.blackListTagID;\r\n    if (blackid <= 0) {\r\n      this.blackList = [];\r\n      return;\r\n    }\r\n\r\n    let param = { user:this.user.id, tag:blackid};\r\n    try {\r\n      let ret = await this.miApi.call('t_tagstock$query', [this.user.id, blackid, undefined]);//await this.uqs.mi.TagStock.query(param);\r\n      let r = ret.map(item=> {\r\n        return item.stock;\r\n      });\r\n      this.blackList = r;\r\n    }\r\n    catch (error) {\r\n      let e = error;\r\n    }\r\n  }\r\n\r\n  protected async loadDefaultList(): Promise<void> {\r\n    let id = this.defaultListTagID;\r\n    if (id <= 0) {\r\n      this.defaultList = [];\r\n      return;\r\n    }\r\n\r\n    let param = { user:this.user.id, tag:id};\r\n    try {\r\n      let ret = await this.miApi.call('t_tagstock$query', [this.user.id, id, undefined]);//await this.uqs.mi.TagStock.query(param);\r\n      let r = ret.map(item=> {\r\n        return item.stock;\r\n      });\r\n      this.defaultList = r;\r\n    }\r\n    catch (error) {\r\n      let e = error;\r\n    }\r\n  }\r\n\r\n  async AddTagStockID(tagid: number, stockID: number) {\r\n    if (tagid === this.blackListTagID) {\r\n      this.AddBlackID(stockID);\r\n    }\r\n    else if (tagid === this.defaultListTagID) {\r\n      this.AddDefaultID(stockID);\r\n    }\r\n  }\r\n\r\n  async AddTagStockIDs(tagid: number, stockIDs: number[]) {\r\n    if (tagid === this.blackListTagID) {\r\n      stockIDs.map(v=>this.AddBlackID(v));\r\n    }\r\n    else if (tagid === this.defaultListTagID) {\r\n      stockIDs.map(v=>this.AddDefaultID(v));\r\n    }\r\n  }\r\n\r\n  async RemoveTagStockID(tagid: number, stockID: number) {\r\n    if (tagid === this.blackListTagID) {\r\n      this.RemoveBlackID(stockID);\r\n    }\r\n    else if (tagid === this.defaultListTagID) {\r\n      this.RemoveDefaultID(stockID);\r\n    }\r\n    this.cHome.RemoveTagStockID(tagid, stockID);\r\n  }\r\n\r\n  protected AddBlackID(id:number) {\r\n    let i = this.blackList.findIndex(v=> v===id);\r\n    if (i < 0) {\r\n      this.blackList.push(id);\r\n    }\r\n  }\r\n\r\n  protected RemoveBlackID(id:number) {\r\n    let i = this.blackList.findIndex(v=> v===id);\r\n    if (i >= 0) {\r\n      this.blackList.splice(i, 1);\r\n    }\r\n  }\r\n\r\n  protected AddDefaultID(id:number) {\r\n    let i = this.defaultList.findIndex(v=> v===id);\r\n    if (i < 0) {\r\n      this.defaultList.push(id);\r\n    }\r\n  }\r\n\r\n  protected RemoveDefaultID(id:number) {\r\n    let i = this.defaultList.findIndex(v=> v===id);\r\n    if (i >= 0) {\r\n      this.defaultList.splice(i, 1);\r\n    }\r\n  }\r\n/*\r\n  newC<T extends CUqBase>(type: IConstructor<T>): T {\r\n    return new type(this);\r\n  }\r\n*/\r\n  public async showOneVPage(vp: new (coordinator: Controller) => VPage<Controller>, param?: any): Promise<void> {\r\n    await (new vp(this)).open(param);\r\n  }\r\n\r\n  protected onDispose() {\r\n  }\r\n\r\n  openPredictAVG(param:any) {\r\n    let pc = this.newC(CPredictHistory);\r\n    pc.start(param);\r\n  }\r\n}\r\n","//=== UqApp builder created on Tue Jan 12 2021 23:14:51 GMT-0500 (GMT-05:00) ===//\r\nimport { AppConfig, DevConfig } from \"tonva-react\";\r\n\r\nconst bruce: DevConfig = {\r\n\tname: 'bruce',\r\n\talias: undefined,\r\n}\r\n\r\nexport const appConfig: AppConfig = {\r\n\tapp: undefined,\r\n\tuqs: [\r\n\t\t{\r\n\t\t\tdev: bruce,\r\n\t\t\tname: 'yumi',\r\n\t\t\talias: 'YuMi',\r\n\t\t\tversion: '0.1.0',\r\n\t\t},\r\n\t],\r\n\tnoUnit: true,\r\n    tvs: {},\r\n\toem: undefined,\r\n\thtmlTitle: '鱼米乡 - 私享投资圈',\r\n};\r\n","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport * as React from 'react';\r\nimport classNames from 'classnames';\r\nimport { VPage, Page, View, List, LMR, left0, FA } from 'tonva-react';\r\nimport { observable } from 'mobx';\r\nimport { observer } from 'mobx-react';\r\nimport RC2 from 'react-chartjs2'\r\nimport { GFunc } from '../tool/GFunc';\r\nimport { CStockInfo } from './CStockInfo'\r\nimport { NStockInfo, StockCapitalearning, StockBonus } from './StockInfoType';\r\nimport { ErForEarning, SlrForEarning } from 'regression';\r\n\r\nexport class VStockInfo extends VPage<CStockInfo> {\r\n  private input: HTMLInputElement;\r\n  private key: string = undefined;\r\n\r\n  async open(param?: any) {\r\n    this.openPage(this.page);\r\n  }\r\n\r\n  @observable protected ttmLimit:boolean = false;\r\n\r\n  render(param: any): JSX.Element {\r\n    return this.page();\r\n  }\r\n\r\n  checkLimitShow = (e)=> {\r\n    let check = e.target.checked as boolean;\r\n    this.ttmLimit = check;\r\n  }\r\n\r\n  checkShowLater = (e)=> {\r\n    let check = e.target.checked as boolean;\r\n    this.controller.LoadHistoryData(check);\r\n  }\r\n\r\n  checkDefaultTag = (e)=> {\r\n    let check = e.target.checked as boolean;\r\n    this.controller.onClickDefaultTag(check);\r\n  }\r\n\r\n  private page = observer(() => {\r\n    let { openMetaView, baseItem, onSelectTag, stockTags, isLogined } = this.controller;\r\n    let { name, code, day } = baseItem;\r\n    let viewMetaButton = <></>;\r\n    if (isLogined) {\r\n      viewMetaButton = <button type=\"button\" className=\"btn w-100\" onClick={openMetaView}>view</button>\r\n    }\r\n    let right = stockTags && <button \r\n\t\tclassName=\"btn btn-sm mr-2 btn-outline-success bg-light align-self-center\"\r\n\t\tonClick={onSelectTag}>\r\n      {stockTags.length === 0? '加自选' : '设分组'}\r\n      </button>;\r\n    let headStr = name + ' ' + code;\r\n    if (day !== undefined) {\r\n      headStr += ' - ' + day;\r\n    }\r\n  let head = <div onClick={()=>this.controller.showSelectStock(day)}>{headStr}</div>\r\n    return <Page header={head} right={right}\r\n      headerClassName='bg-primary'>\r\n      {React.createElement(this.pageContent)}\r\n    </Page>;\r\n  })\r\n\r\n  private pageContent = observer(() => {\r\n    return <>\r\n      {this.dateHead()}\r\n      {React.createElement(this.baseInfo)}\r\n      {React.createElement(this.historyChart)}\r\n      {React.createElement(this.predictInfo)}\r\n      {React.createElement(this.predictSeasonEarning)}\r\n      {React.createElement(this.seasonEarning)}\r\n      {React.createElement(this.capitalEarning)}\r\n      {React.createElement(this.bonus)}\r\n    </>\r\n  });\r\n\r\n  private onChange = (evt: React.ChangeEvent<any>) => {\r\n    let v = evt.target.value;\r\n    let n = Number(v);\r\n    if (isNaN(n) === true || !Number.isInteger(n)) {\r\n      if (this.input) {\r\n        this.input.value = this.key;\r\n      }\r\n      return;\r\n    }\r\n    this.key = evt.target.value;\r\n    if (this.key !== undefined) {\r\n        this.key = this.key.trim();\r\n        if (this.key === '') this.key = undefined;\r\n    }\r\n  }\r\n\r\n  private onSubmit = async (evt: React.FormEvent<any>) => {\r\n    evt.preventDefault();\r\n    if (this.key === undefined) this.key = '';\r\n    let n = Number(this.key);\r\n    if (!isNaN(n) && Number.isInteger((n))) {\r\n      if (n ===0 || (n >= 20000101 && n < 30000101)) {\r\n        await this.controller.changeDay(n);\r\n      }\r\n    }\r\n  }\r\n\r\n\r\n  private dateHead = () => {\r\n    let {day} = this.controller.baseItem;\r\n    let dayString = day === undefined || isNaN(day) ? '' : day.toString();\r\n    return <div className=\"px-3 py-2\">\r\n\t\t<form className=\"w-100\" onSubmit={this.onSubmit} >\r\n\t\t\t<div className=\"input-group input-group-sm\">\r\n\t\t\t\t<label className=\"input-group-addon mr-2 mb-0 align-self-center\">{'日期'}</label>\r\n\t\t\t\t<input ref={v=>this.input=v} onChange={this.onChange}\r\n\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\tname=\"key\"\r\n\t\t\t\t\t\tdefaultValue={dayString}\r\n\t\t\t\t\t\tclassName=\"form-control border-primary px-2\"\r\n\t\t\t\t\t\tplaceholder={'yyyymmdd'}\r\n\t\t\t\t\t\tmaxLength={8} />\r\n\t\t\t\t<div className=\"input-group-append\">\r\n\t\t\t\t\t\t<button className=\"btn btn-primary px-2\"\r\n\t\t\t\t\t\t\ttype=\"submit\">\r\n\t\t\t\t\t\t\t<i className='fa fa-search' />\r\n\t\t\t\t\t\t\t<i className=\"fa\"/>\r\n\t\t\t\t\t\t\t{'跳转'}\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</form>\r\n\t</div>;\r\n  }\r\n\r\n\r\n  private baseInfo = observer(() => {\r\n    let {baseItem} = this.controller;\r\n    let { id, name, code, symbol, pe, roe, price, order, divyield, e, capital, bonus } = baseItem;\r\n\r\n    let list = this.controller.cApp.defaultList;\r\n    let fInList = list.findIndex(v=>v===id) >= 0;\r\n    let right = <label className=\"align-self-center px-3\"> <input type=\"checkbox\" name=\"checkDefaultList\" defaultChecked={fInList}\r\n      onChange={this.checkDefaultTag} />自选股</label>;\r\n    return <LMR className=\"bg-white\" right={right}> <div className=\"px-3 py-2\" >\r\n      <div className=\"d-flex flex-wrap\">\r\n        <div className=\"px-3 c8\">{GFunc.caption('TTM')}{GFunc.numberToFixString(pe)}</div>\r\n        <div className=\"px-3 c8\">{GFunc.caption('股息率')}{GFunc.percentToFixString(divyield)}</div>\r\n        <div className=\"px-3 c8\">{GFunc.caption('ROE')}{GFunc.percentToFixString(roe)}</div>\r\n        <div className=\"px-3 c8\">{GFunc.caption('价格')}{GFunc.numberToFixString(price)}</div>\r\n        <a className=\"px-3 text-info\" href={`https://finance.sina.com.cn/realstock/company/${symbol}/nc.shtml`} target=\"_blank\" rel=\"noopener noreferrer\" onClick={(e) =>{e.stopPropagation() }}>新浪财经</a>\r\n      </div>    \r\n    </div>\r\n    </LMR>;\r\n  });\r\n\r\n  protected onClickName = async (item: NStockInfo) => {\r\n    let { symbol } = item;\r\n    let url = `http://finance.sina.com.cn/realstock/company/${symbol}/nc.shtml`;\r\n    let w = window.open(url, '');\r\n    w.opener = undefined;\r\n  }\r\n\r\n  protected historyChart = observer(() => {\r\n    let {historyData, baseItem} = this.controller;\r\n    if (historyData === undefined) \r\n      return <></>;\r\n    let chartHistory = <></>;\r\n    let labelList:any[] = [];\r\n    let priceList:number[] = [];\r\n    let ttmList:number[] = [];\r\n    for (let item of historyData) {\r\n      let {day, price, ttm} = item;\r\n      labelList.push(day);\r\n      priceList.push(GFunc.numberToPrecision(price, 4));\r\n      if (ttm <= 0) \r\n        ttmList.push(undefined);\r\n      else {\r\n        if (this.ttmLimit && ttm >= 35) {\r\n          ttmList.push(35);\r\n        }\r\n        else {\r\n          ttmList.push(GFunc.numberToPrecision(ttm, 4));\r\n        }\r\n      }\r\n    }\r\n    let chartdata1 = {\r\n      labels: labelList,\r\n      datasets: [\r\n        {\r\n          label: '价格',\r\n          data: priceList,\r\n          borderColor:'blue',\r\n          backgroundColor:'skyBlue',\r\n          borderWidth: 1,\r\n          fill: false,\r\n          yAxisID: 'y-axis-1',\r\n        },\r\n        {\r\n          label: 'TTM',\r\n          data: ttmList,\r\n          borderColor:'red',\r\n          backgroundColor:'pink',\r\n          borderWidth: 1,\r\n          fill: false,\r\n          yAxisID: 'y-axis-2',\r\n        }\r\n      ]\r\n    };\r\n    let options = {\r\n      scales:{\r\n        yAxes: [{\r\n            type: 'linear',\r\n            display: true,\r\n            position: 'left',\r\n            id: 'y-axis-1',\r\n        }, {\r\n            type: 'linear',\r\n            display: true,\r\n            position: 'right',\r\n            id: 'y-axis-2',\r\n            gridLines: {\r\n                drawOnChartArea: false\r\n            }\r\n        }],       \r\n      }\r\n    }\r\n    chartHistory = <RC2 data={chartdata1} type='line' options={options} />;\r\n    let right = <></>;\r\n    if (baseItem.day !== undefined) {\r\n      right = <><label className=\"px-3\"> <input type=\"checkbox\" name=\"showLater\" defaultChecked={false}\r\n            onChange={this.checkShowLater} />显示后面数据</label>\r\n          <label className=\"px-3\"> <input type=\"checkbox\" name=\"selectType\" defaultChecked={this.ttmLimit}\r\n          onChange={this.checkLimitShow} />限制TTM显示范围</label>\r\n        </>;\r\n\r\n    }\r\n    else {\r\n      right = <label className=\"px-3\"> <input type=\"checkbox\" name=\"selectType\" defaultChecked={this.ttmLimit}\r\n        onChange={this.checkLimitShow} />限制TTM显示范围</label>;\r\n    }\r\n    return <><LMR className=\"px-3 py-2 bg-white\" left={'历史走势'} right={right}></LMR>\r\n      <div className=\"px-3\" style={{width:'95%'}}>{chartHistory}</div>\r\n    </>;\r\n  });\r\n\r\n  protected predictInfo = observer(() => {\r\n    let {predictData, ypredict} = this.controller;\r\n    if (predictData === undefined) \r\n      return <></>;\r\n    let { e, b, r2, epre, l, lr2, lpre } = predictData;\r\n    let chart1 = <></>;\r\n    if (ypredict.length === 5) {\r\n      let er = new ErForEarning(ypredict);\r\n      let chartdata1 = {\r\n        labels: ['0', '1', '2', '3', '4'],\r\n        datasets: [\r\n          {\r\n            label: '原值',\r\n            data: ypredict.map(v=>GFunc.numberToPrecision(v)),\r\n            borderColor:'black',\r\n            backgroundColor:'skyBlue',\r\n            showLine: false,\r\n            pointStyle: \"crossRot\",\r\n            borderWidth: 1,\r\n            pointRadius: 5,\r\n            fill: false,\r\n          } as any\r\n        ]\r\n      };\r\n      if (!(isNaN(er.B) || isNaN(er.A))) {\r\n        let per:number[] = [];\r\n        for (let i = 0; i < 5; ++i) {\r\n          per.push(GFunc.numberToPrecision(er.predict(i), 4));\r\n        }\r\n        chartdata1.datasets.push(\r\n          {\r\n            label: '指数回归',\r\n            data: per,\r\n            borderColor:'red',\r\n            backgroundColor:'pink',\r\n            borderWidth: 1,\r\n            fill: false,\r\n        });\r\n      }\r\n      let lr = new SlrForEarning(ypredict);\r\n      if (!(isNaN(lr.slope) || isNaN(lr.intercept))) {\r\n        let plr:number[] = [];\r\n        for (let i = 0; i < 5; ++i) {\r\n          plr.push(GFunc.numberToPrecision(lr.predict(i), 4));\r\n        }\r\n        chartdata1.datasets.push(\r\n          {\r\n            label: '线性回归',\r\n            data: plr,\r\n            borderColor:'blue',\r\n            backgroundColor:'pink',\r\n            borderWidth: 1,\r\n            fill: false,\r\n        });\r\n      }\r\n      chart1 = <RC2 data={chartdata1} type='line' />;\r\n    }\r\n    let chart2 = this.predictChartFullInfo();\r\n    let chart3 = this.predictChartROE();\r\n    return <><div className=\"px-3 py-2 bg-white\">指数回归预测</div>\r\n      <div className=\"d-flex flex-wrap\">\r\n        <div className=\"px-3 c12\">{GFunc.caption('e')}{GFunc.numberToString(e, 4)}</div>\r\n        <div className=\"px-3 c12\">{GFunc.caption('指数b')}{GFunc.numberToString(b, 4)}</div>\r\n        <div className=\"px-3 c12\">{GFunc.caption('r2')}{GFunc.numberToString(r2, 4)}</div>\r\n        <div className=\"px-3 c12\">{GFunc.caption('e预测')}{GFunc.numberToString(epre)}</div>\r\n      </div>\r\n      <div className=\"px-3 py-2 bg-white\">线性回归预测</div>\r\n      <div className=\"d-flex flex-wrap\">\r\n      <div className=\"px-3 c12\">{GFunc.caption('e')}{GFunc.numberToString(e, 4)}</div>\r\n        <div className=\"px-3 c12\">{GFunc.caption('增长率')}{GFunc.numberToString(l, 4)}</div>\r\n        <div className=\"px-3 c12\">{GFunc.caption('r2')}{GFunc.numberToString(lr2, 4)}</div>\r\n        <div className=\"px-3 c12\">{GFunc.caption('e预测')}{GFunc.numberToString(lpre)}</div>\r\n      </div>\r\n      <div className=\"d-flex\">\r\n        <div className=\"px-2\" style={{width:'50%'}}>{chart1}</div>\r\n        <div className=\"px-2\" style={{width:'50%'}}>{chart2}</div>\r\n      </div>\r\n      <div className=\"d-flex\">\r\n        <div className=\"px-2\" style={{width:'50%'}}>{chart3}</div>\r\n      </div>\r\n    </>;\r\n  });\r\n\r\n  protected predictChartFullInfo = () => {\r\n    let { predictSeasonDataFull } = this.controller;\r\n    let len = predictSeasonDataFull.length;\r\n    if (len <= 0)\r\n      return <></>;\r\n    let label = [];\r\n    let y:number[] = [];\r\n    for (let i = len - 1; i >= 0; --i) {\r\n      let item = predictSeasonDataFull[i];\r\n      if (item.esum === undefined)\r\n        continue;\r\n      label.push(GFunc.SeasonnoToYearMonth(item.season));\r\n      y.push(item.esum);\r\n    }\r\n\r\n    let er = new ErForEarning(y);\r\n    let chartdataFull = {\r\n      labels: label,\r\n      datasets: [\r\n        {\r\n          label: '原值',\r\n          data: y.map(v=>GFunc.numberToPrecision(v)),\r\n          borderColor:'black',\r\n          backgroundColor:'skyBlue',\r\n          showLine: false,\r\n          pointStyle: \"crossRot\",\r\n          borderWidth: 1,\r\n          pointRadius: 5,\r\n          fill: false,\r\n        } as any\r\n      ]\r\n    };\r\n    if (!(isNaN(er.B) || isNaN(er.A))) {\r\n      let per:number[] = [];\r\n      for (let i = 0; i < len; ++i) {\r\n        per.push(GFunc.numberToPrecision(er.predict(i), 4));\r\n      }\r\n      chartdataFull.datasets.push(\r\n        {\r\n          label: '指数 R2:' + GFunc.numberToString(er.r2, 4),\r\n          data: per,\r\n          borderColor:'red',\r\n          backgroundColor:'pink',\r\n          borderWidth: 1,\r\n          fill: false,\r\n      });\r\n    }\r\n    let lr = new SlrForEarning(y);\r\n    if (!(isNaN(lr.slope) || isNaN(lr.intercept))) {\r\n      let plr:number[] = [];\r\n      for (let i = 0; i < len; ++i) {\r\n        plr.push(GFunc.numberToPrecision(lr.predict(i), 4));\r\n      }\r\n      chartdataFull.datasets.push(\r\n        {\r\n          label: '线性 R2:' + GFunc.numberToString(lr.r2, 4),\r\n          data: plr,\r\n          borderColor:'blue',\r\n          backgroundColor:'pink',\r\n          borderWidth: 1,\r\n          fill: false,\r\n      });\r\n    }\r\n    return <RC2 data={chartdataFull} type='line' />;\r\n  };\r\n\r\n  protected predictChartROE = () => {\r\n    let { predictSeasonDataFull } = this.controller;\r\n    let len = predictSeasonDataFull.length;\r\n    if (len <= 0)\r\n      return <></>;\r\n    let label = [];\r\n    let y:number[] = [];\r\n    for (let i = len - 1; i >= 0; --i) {\r\n      let item = predictSeasonDataFull[i];\r\n      if (item.esum === undefined)\r\n        continue;\r\n      label.push(GFunc.SeasonnoToYearMonth(item.season));\r\n      y.push(item.esumorg / item.corg);\r\n    }\r\n\r\n    let chartdataFull = {\r\n      labels: label,\r\n      datasets: [\r\n        {\r\n          label: 'ROE原值',\r\n          data: y.map(v=>GFunc.numberToPrecision(v)),\r\n          borderColor:'black',\r\n          backgroundColor:'skyBlue',\r\n          showLine: false,\r\n          pointStyle: \"crossRot\",\r\n          borderWidth: 1,\r\n          pointRadius: 5,\r\n          fill: false,\r\n        } as any\r\n      ]\r\n    };\r\n    let lr = new SlrForEarning(y);\r\n    if (!(isNaN(lr.slope) || isNaN(lr.intercept))) {\r\n      let plr:number[] = [];\r\n      for (let i = 0; i < len; ++i) {\r\n        plr.push(Number.parseFloat(lr.predict(i).toPrecision(4)));\r\n      }\r\n      chartdataFull.datasets.push(\r\n        {\r\n          label: '线性 R2:' + GFunc.numberToString(lr.r2, 4),\r\n          data: plr,\r\n          borderColor:'blue',\r\n          backgroundColor:'pink',\r\n          borderWidth: 1,\r\n          fill: false,\r\n      });\r\n    }\r\n    return <RC2 data={chartdataFull} type='line' />;\r\n  };\r\n\r\n  private predictSeasonEarning = observer(() => {\r\n    let items = this.controller.predictSeasonData;\r\n    let header = <div className=\"px-3\">\r\n      <div className=\"px-3 c6\">年月</div>\r\n      <div className=\"px-3 c6 text-right\">股本</div>\r\n      <div className=\"px-3 c6 text-right\">季收益</div>\r\n      <div className=\"px-3 c6 text-right\">年收益</div>\r\n      <div className=\"px-3 c6 text-right\">ROE</div>\r\n      <div className=\"px-3 c6 text-right\">股本o</div>\r\n      <div className=\"px-3 c6 text-right\">季收益o</div>\r\n      <div className=\"px-3 c6 text-right\">年收益o</div>\r\n    </div>;\r\n    return <>\r\n      <div className=\"px-3 py-1\">历年股本收益-用于回归计算</div>\r\n      <List header={header} loading=\"...\"\r\n        items={items}\r\n        item={{\r\n          render: (row: {season:number, c:number, e:number, esum:number, corg:number, eorg:number, esumorg:number}) => {\r\n            let {season, c, e, esum, corg, eorg, esumorg} = row;\r\n            let ym = GFunc.SeasonnoToYearMonth(season);\r\n            let a = 0;\r\n            return <div className=\"px-3 py-2 d-flex flex-wrap\">\r\n              <div className=\"px-3 c6\">{ym.toString()}</div>\r\n              <div className=\"px-3 c6 text-right\">{GFunc.numberToFixString(c)}</div>\r\n              <div className=\"px-3 c6 text-right\">{GFunc.numberToFixString(e)}</div>\r\n              <div className=\"px-3 c6 text-right\">{GFunc.numberToFixString(esum)}</div>\r\n              <div className=\"px-3 c6 text-right\">{GFunc.percentToFixString(esum/c)}</div>\r\n              <div className=\"px-3 c6 text-right\">{GFunc.numberToFixString(corg)}</div>\r\n              <div className=\"px-3 c6 text-right\">{GFunc.numberToFixString(eorg)}</div>\r\n              <div className=\"px-3 c6 text-right\">{GFunc.numberToFixString(esumorg)}</div>\r\n            </div>\r\n          }\r\n        }}\r\n      />\r\n    </>\r\n  });\r\n\r\n\r\n  private seasonEarning = observer(() => {\r\n    let items = this.controller.seasonData;\r\n    let header = <div className=\"px-3\">\r\n      <div className=\"px-3 c6\">年月</div>\r\n      <div className=\"px-3 c6 text-right\">股本</div>\r\n      <div className=\"px-3 c6 text-right\">季收益</div>\r\n      <div className=\"px-3 c6 text-right\">年收益</div>\r\n      <div className=\"px-3 c6 text-right\">ROE</div>\r\n      <div className=\"px-3 c6 text-right\">股本o</div>\r\n      <div className=\"px-3 c6 text-right\">季收益o</div>\r\n      <div className=\"px-3 c6 text-right\">年收益o</div>\r\n    </div>;\r\n    return <>\r\n      <div className=\"px-3 py-1\">历年股本收益</div>\r\n      <List header={header} loading=\"...\"\r\n        items={items}\r\n        item={{\r\n          render: (row: {season:number, c:number, e:number, esum:number, corg:number, eorg:number, esumorg:number}) => {\r\n            let {season, c, e, esum, corg, eorg, esumorg} = row;\r\n            let ym = GFunc.SeasonnoToYearMonth(season);\r\n            let a = 0;\r\n            return <div className=\"px-3 py-2 d-flex flex-wrap\">\r\n              <div className=\"px-3 c6\">{ym.toString()}</div>\r\n              <div className=\"px-3 c6 text-right\">{GFunc.numberToFixString(c)}</div>\r\n              <div className=\"px-3 c6 text-right\">{GFunc.numberToFixString(e)}</div>\r\n              <div className=\"px-3 c6 text-right\">{GFunc.numberToFixString(esum)}</div>\r\n              <div className=\"px-3 c6 text-right\">{GFunc.percentToFixString(esum/c)}</div>\r\n              <div className=\"px-3 c6 text-right\">{GFunc.numberToFixString(corg)}</div>\r\n              <div className=\"px-3 c6 text-right\">{GFunc.numberToFixString(eorg)}</div>\r\n              <div className=\"px-3 c6 text-right\">{GFunc.numberToFixString(esumorg)}</div>\r\n            </div>\r\n          }\r\n        }}\r\n      />\r\n    </>\r\n  });\r\n\r\n\r\n  private capitalEarning = observer(() => {\r\n    let items = this.controller.capitalearning;\r\n    let header = <div className=\"px-3\">\r\n      <div className=\"px-3 c6\">年</div>\r\n      <div className=\"px-3 c6 text-right\">股本</div>\r\n      <div className=\"px-3 c6 text-right\">收益</div>\r\n      <div className=\"px-3 c6 text-right\">ROE</div>\r\n    </div>;\r\n    return <>\r\n      <div className=\"px-3 py-1\">历年股本收益</div>\r\n      <List header={header} loading=\"...\"\r\n        items={items}\r\n        item={{\r\n          render: (row: StockCapitalearning) => {\r\n            let {capital, earning} = row;\r\n            return <div className=\"px-3 py-2 d-flex flex-wrap\">\r\n              <div className=\"px-3 c6\">{row.year}</div>\r\n              <div className=\"px-3 c6 text-right\"> {capital.toFixed(2)}</div>\r\n              <div className=\"px-3 c6 text-right\"> {earning.toFixed(2)}</div>\r\n              <div className=\"px-3 c6 text-right\"> {(earning/capital*100).toFixed(1)}%</div>\r\n            </div>\r\n          }\r\n        }}\r\n      />\r\n    </>\r\n  });\r\n\r\n  private bonus = observer(() => {\r\n    let items = this.controller.bonus;\r\n    let header = <div className=\"px-3\">\r\n      <div className=\"px-3 c8\">日期</div>\r\n      <div className=\"px-3 c6 text-right\">分红</div>\r\n    </div>;\r\n    return <>\r\n      <div className=\"px-3 py-1\">历年分红</div>\r\n      <List header={header} loading=\"...\"\r\n        items={items}\r\n        item={{\r\n          render: (row: StockBonus) => {\r\n            return <div className=\"px-3 py-2 d-flex flex-wrap\">\r\n              <div className=\"px-3 c8\">{row.day}</div>\r\n              <div className=\"px-3 c6 text-right\"> {row.bonus.toFixed(2)}</div>\r\n            </div>\r\n          }\r\n        }}\r\n      />\r\n    </>\r\n  });\r\n}","import { UqExt as Uq } from './BruceYuMi';\r\nimport * as Account from './Account.ui';\r\nimport * as Holding from './Holding.ui';\r\nimport * as Transaction from './Transaction.ui';\r\nimport * as Stock from './Stock.ui';\r\nimport * as Market from './Market.ui';\r\nimport * as Portfolio from './Portfolio.ui';\r\nimport * as StockValue from './StockValue.ui';\r\nimport * as AccountValue from './AccountValue.ui';\r\nimport * as UserAccount from './UserAccount.ui';\r\n\r\nexport function setUI(uq: Uq) {\r\n\tObject.assign(uq.Account, Account);\r\n\tObject.assign(uq.Holding, Holding);\r\n\tObject.assign(uq.Transaction, Transaction);\r\n\tObject.assign(uq.Stock, Stock);\r\n\tObject.assign(uq.Market, Market);\r\n\tObject.assign(uq.Portfolio, Portfolio);\r\n\tObject.assign(uq.StockValue, StockValue);\r\n\tObject.assign(uq.AccountValue, AccountValue);\r\n\tObject.assign(uq.UserAccount, UserAccount);\r\n}\r\nexport * from './BruceYuMi';\r\n","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport * as React from 'react';\r\nimport { observer } from 'mobx-react-lite';\r\nimport { VPage, Page, List, LMR, SearchBox } from 'tonva-react';\r\nimport { CStock } from './CStock'\r\n\r\nexport class VStockSelect extends VPage<CStock> {\r\n  async open(item: any) {\r\n      this.openPage(this.page, item);\r\n  }\r\n\r\n  private renderStock(stock: any, index: number) {\r\n      let { name, code } = stock;\r\n      return <LMR className=\"px-3 py-2 \" >\r\n          <div className=\"font-weight-bold\"></div>\r\n          <div>{name + ' ' + code}</div>\r\n      </LMR >\r\n  }\r\n\r\n  private onClickStock = async (model: any) => {\r\n      await this.controller.returnStock(model);\r\n      this.closePage();\r\n  }\r\n\r\n  private page = observer((customer: any) => {\r\n      let { pageItems, onPage } = this.controller;\r\n      let none = <div className=\"my-3 mx-2 text-warning\">请搜索股票！</div>;\r\n      return <Page header=\"选择股票\" headerClassName='bg-primary' onScrollBottom={onPage}>\r\n          <SearchBox className=\"px-1 w-100  mt-2 mr-2\"\r\n              size='md'\r\n              allowEmptySearch={true}\r\n              onSearch={(key: string) => this.controller.searchByKey(key)}\r\n              placeholder=\"搜索股票\" />\r\n          <List before={''} none={none} items={pageItems} item={{ render: this.renderStock, onClick: this.onClickStock }} />\r\n      </Page>\r\n  })\r\n}","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport { observable } from 'mobx';\r\nimport { PageItems } from 'tonva-react';\r\nimport { CUqBase } from '../UqApp';\r\nimport { VStockSelect } from './VSelectStock';\r\n\r\nclass PageStockItems<T> extends PageItems<T> {\r\n  cStock: CStock;\r\n\r\n  constructor(cs: CStock) {\r\n      super(true);\r\n      this.cStock = cs;\r\n      this.firstSize = this.pageSize = 30;\r\n  }\r\n\r\n  protected async loadResults(param: any, pageStart: any, pageSize: number): Promise<{\r\n\t[name: string]: any[];\r\n\t}> {\r\n      if (pageStart === undefined) pageStart = 0;\r\n      let p = ['%' + param.key + '%'];\r\n      try {\r\n        let ret = await this.cStock.cApp.miApi.page('q_stocks$page', p, pageStart, pageSize);\r\n        return ret;\r\n      }\r\n      catch (error) {\r\n        let e = error;\r\n        return undefined;\r\n      }\r\n  }\r\n\r\n  protected setPageStart(item: any): any {\r\n      this.pageStart = item === undefined ? 0 : item.id;\r\n  }\r\n}\r\n\r\nexport class CStock extends CUqBase {\r\n  @observable pageItems: PageStockItems<any> = new PageStockItems<any>(this);\r\n\r\n  //get cApp(): CMiApp { return this._cApp as CMiApp };\r\n\r\n  async internalStart(param: any) {\r\n    this.openVPage(VStockSelect);\r\n}\r\n\r\n  searchByKey = async (key: string) => {\r\n    this.pageItems = new PageStockItems<any>(this);\r\n    this.pageItems.first({ key: key });\r\n  }\r\n\r\n  //给调用页面返回id\r\n  returnStock = async (item: any): Promise<any> => {\r\n    this.returnCall(item);\r\n  }\r\n\r\n  onPage = async () => {\r\n    await this.pageItems.more();\r\n  }\r\n}","export * from './StockInfoType';\r\nexport { CStockInfo } from './CStockInfo';\r\nexport { VStockInfo } from './VStockInfo';","import * as React from 'react';\r\n\r\nexport class GFunc {\r\n  public static numberToFixString(n: number, w = 2) {\r\n    return n === undefined ? '' : n.toFixed(w);\r\n  }\r\n  public static number(n: number, w=2) {\r\n    return n === undefined ? '' : n.toFixed(w);\r\n  }\r\n\r\n  public static numberToMarketValue(n: number) {\r\n    return n === undefined || isNaN(n) ? '' : Math.round(n/10000).toString(); // + '亿';\r\n  }\r\n\r\n  public static numberToString(n: number, precision = 2) {\r\n    return n === undefined ? '' : n.toPrecision(precision);\r\n  }\r\n\r\n  public static numberToPrecision(n: number, precision = 4) {\r\n    return n === undefined ? undefined : Number.parseFloat(n.toPrecision(precision));\r\n  }\r\n\r\n  public static percentToFixString(n: number) {\r\n    return n === undefined || isNaN(n) ? '' : (n * 100).toFixed(2) + '%';\r\n  }\r\n\r\n  public static percent0(n: number) {\r\n    return n === undefined || isNaN(n) ? '' : (n * 100).toFixed(0) + '%';\r\n  }\r\n  public static percent1(n: number) {\r\n    return n === undefined || isNaN(n) ? '' : (n * 100).toFixed(1) + '%';\r\n  }\r\n\r\n  public static warningTypeString(t: string) {\r\n    switch (t) {\r\n      case 'gt': return '大于';\r\n      case 'lt': return '小于';\r\n      default: return t;\r\n    }\r\n  }\r\n\r\n  public static predictCutRatio(r2:number) {\r\n    return r2 * 2 - r2 * r2;\r\n  }\r\n\r\n  public static evaluatePricePrice(iRate:number, e1:number, e2:number, e3:number) {\r\n    let r = 1 + iRate;\r\n    let r2 = r * r;\r\n    let r3 = r2 * r;\r\n    return (e1/r + e2 /r2 + e3 / r3 + e3 / iRate / r3) / 2;\r\n  }\r\n\r\n  public static calculateV(z:number, divyield:number, pe:number) {\r\n    if (pe === undefined || isNaN(pe)) {\r\n      return undefined;\r\n    }\r\n\r\n    let r = 0;\r\n    if (z !== undefined) {\r\n      if (z > 0.25) {\r\n        z = 0.25;\r\n      }\r\n      r += z * 100;\r\n    }\r\n    if (divyield !== undefined) {\r\n      r += divyield * 100;\r\n    }\r\n    return r / pe;\r\n  }\r\n\r\n  public static calculateVN(z:number, e:number, bonus:number, price:number) {\r\n    if (price === undefined || isNaN(price) || e === undefined || isNaN(e)) {\r\n      return undefined;\r\n    }\r\n\r\n    let r = 0;\r\n    if (z !== undefined && e > 0) {\r\n      if (z > 0.25) {\r\n        z = 0.24 + Math.pow((z-0.24)*100, 0.6667) / 100;\r\n      }\r\n      z = 1 + z;\r\n      z = z * z * z - 1;\r\n      r += z * e * 100;\r\n    }\r\n    if (bonus !== undefined && !isNaN(bonus)) {\r\n      r += bonus * 100;\r\n    }\r\n    return r / price;\r\n  }\r\n\r\n  public static calculateZZ3(data:number[]) {\r\n    let ret:number[] = [undefined, undefined, undefined, undefined] ;\r\n    if (data === undefined)\r\n      return ret;\r\n    let len = data.length;\r\n    if (len < 5)\r\n      return ret;\r\n    \r\n    let funcz = (n:number, p:number) => {\r\n      if (p <= 0 || n <= 0)\r\n        return undefined;\r\n      return ((n / p) - 1);\r\n    }\r\n    for (let i = 0; i < 4; ++i) {\r\n      ret[i] = funcz(data[i+1], data[i]);\r\n    }\r\n    return ret;\r\n  }\r\n\r\n  public static caption = (value:string) => <span className=\"text-muted small\">{value}</span>;\r\n\r\n  public static MonthnoFromDay(day:number) {\r\n    let year = Math.floor(day/10000);\r\n    let month = Math.floor((day%10000)/100) - 1;\r\n    return (year-1995)*12+month;\r\n  }\r\n  \r\n  public static SeasonnoFromDay(day:number) {\r\n    let year = Math.floor(day/10000);\r\n    let month = Math.floor((day%10000)/100) - 1;\r\n    let season = Math.floor(month / 3);\r\n    return (year-1995)*4 + season;\r\n  }\r\n  \r\n  public static SeasonnoFromYearMonth(year:number, month:number) {\r\n    let season = Math.floor((month-1) / 3);\r\n    return (year-1995)*4 + season;\r\n  }\r\n\r\n  public static SeasonnoToYearMonth(no: number) {\r\n    let year = Math.floor(no / 4) + 1995;\r\n    let month = (Math.floor(no % 4) + 1) * 3;\r\n    return year * 100 + month;\r\n  }\r\n  \r\n  public static SeasonnoToBeginEnd(season:number) {\r\n    let year = (1995 + Math.floor(season / 4)) * 10000;\r\n    let s = season % 4;\r\n    if (s === 0) {\r\n      return {begin: year + 101, end: year + 331};\r\n    } \r\n    else if (s === 1) {\r\n      return {begin: year + 401, end: year + 630};\r\n    }\r\n    else if (s === 2) {\r\n      return {begin: year + 701, end: year + 930};\r\n    }\r\n    return {begin: year + 1001, end: year + 1231};\r\n  }\r\n\r\n  public static CalculatePredictAvg(arr: {predictpe:number}[]) {\r\n    let ret : {avg20:number, avg50:number, avg100:number} = {avg20:undefined, avg50:undefined, avg100:undefined};\r\n\r\n    let length = arr.length;\r\n    let calcuOne = (count:number) : number => {\r\n      let endIndex = count;\r\n      if (endIndex > length)\r\n        endIndex = length;\r\n      if (endIndex >= 10) {\r\n        let sum = 0;\r\n        for (let i = 3; i < endIndex; ++i) {\r\n          sum += arr[i].predictpe\r\n        }\r\n        return sum / (endIndex - 3);\r\n      }\r\n      else {\r\n        return undefined;\r\n      }\r\n    }\r\n\r\n    ret.avg20 = calcuOne(20);\r\n    ret.avg50 = calcuOne(50);\r\n    ret.avg100 = calcuOne(100);\r\n    return ret;\r\n  }\r\n\r\n  public static CalculateValueAvg(arr: {v:number}[]) {\r\n    let ret : {avg20:number, avg50:number, avg100:number, avg:number} = {avg20:undefined, avg50:undefined, avg100:undefined, avg:undefined};\r\n\r\n    let length = arr.length;\r\n    let calcuOne = (count:number) : number => {\r\n      let endIndex = count;\r\n      if (count === 0 || endIndex > length)\r\n        endIndex = length;\r\n      if (endIndex >= 10) {\r\n        let sum = 0;\r\n        for (let i = 3; i < endIndex; ++i) {\r\n          sum += arr[i].v;\r\n        }\r\n        return sum / (endIndex - 3);\r\n      }\r\n      else {\r\n        return undefined;\r\n      }\r\n    }\r\n\r\n    ret.avg20 = calcuOne(20);\r\n    ret.avg50 = calcuOne(50);\r\n    ret.avg100 = calcuOne(100);\r\n    ret.avg = calcuOne(0);\r\n    return ret;\r\n  }\r\n}\r\n"],"sourceRoot":""}