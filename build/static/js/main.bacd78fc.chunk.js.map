{"version":3,"sources":["stockinfo/VTags.tsx","stockinfo/CStockInfo.tsx","App.tsx","reportWebVitals.ts","index.tsx","regression/SlrForEarning.ts","regression/ErForEarning.ts","UqApp/CBase.ts","UqApp/consts.ts","images/logo.svg","home/VSiteHeader.tsx","home/VSearchHeader.tsx","tool/render.tsx","tool/func.ts","home/VHome.tsx","home/VSelectTag.tsx","home/VMarketPE.tsx","home/CMarketPE.tsx","home/CHome.tsx","net/httpChannel.ts","net/httpChannelUI.ts","net/apiBase.ts","net/miApi.ts","me/index.tsx","ui/main.tsx","explorer/VSiteHeader.tsx","explorer/VExplorer.tsx","explorer/VExplorerCfg.tsx","explorer/CExplorer.tsx","warning/VWarningConfig.tsx","warning/CWarning.tsx","predicthistory/VPredictHistory.tsx","predicthistory/CPredictHistory.tsx","UqApp/CMiApp.tsx","tool/GFunc.tsx","stockinfo/VStockInfo.tsx","stock/VSelectStock.tsx","stock/CStock.tsx","stockinfo/index.ts"],"names":["VTags","onSelect","item","isSelected","anySelected","controller","onClickSelectTag","onEditTag","tag","e","preventDefault","renderTag","left","className","name","right","defaultBlackListTagName","defaultTagName","onClick","page","observer","selectedTags","tags","cApp","divNewTag","length","onNewTag","header","headerClassName","items","render","selectedItems","param","a","this","openPage","VPage","schema","type","required","maxLength","uiSchema","widget","label","placeholder","id","visible","submit","VNewTag","onFormButtonClick","context","onSaveNewTag","data","closePage","formData","undefined","onButtonClick","VEditTag","onSaveTag","fData","CStockInfo","exrightForEarning","exrightInfo","historyDataOrg","_capitalearning","observable","array","deep","_bonus","_divideInfo","loadData","loading","baseItem","day","Promise","all","miApi","query","user","rets","stockTags","ret","Array","isArray","arr1","price","clear","arr2","push","arr3","arr4","loadTTMEarning","LoadHistoryData","loaded","openMetaView","onSelectTag","filter","v","findIndex","st","openVPage","call","retId","alert","i","nav","stock","newTag","AddTagStockID","splice","RemoveTagStockID","onClickDefaultTag","tagid","defaultListTagID","showSelectStock","cStock","CStock","b","changeDay","code","symbol","ni","list","seasonData","seasonlist","len","minNo","seasonno","lastItem","maxNo","GFunc","SeasonnoToBeginEnd","end","no","sItem","season","c","capital","es","esum","earning","corg","eorg","esumorg","ExrightEarning","si","pastitem","noBegin","predictData","predictSeasonData","predictSeasonDataFull","ypredict","x","er","ErForEarning","lr","SlrForEarning","B","r2","epre","predict","l","slopeR","lr2","lpre","endDay","exitem","factor","showAll","historyData","endIndex","lastdayno","dayno","lastDay","not","historyList","RestorePrice","ttm","CalculateHistoryPE","dayFrom","dayIndex","bsum","pricere","bonus","factore","SeasonnoFromDay","VStockInfo","CUqBase","computed","appConfig","appName","version","tvs","uqNameMap","App","onLogined","start","CMiApp","React","Component","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","StrictMode","document","getElementById","y","slope","intercept","endY","regress","score","n","xSum","ySum","xSquared","xY","numerator","ym","y2","chi2","rmsd","ySquared","yi2","yi","yiyi2","r","Math","sqrt","A","yx","log","exp","CBase","CUqApp","CSub","init","CAppBase","consts","uqBasedata","appIcon","miApiHost","miApiHostDebug","isDevelopment","process","VSiteHeader","src","logo","alt","style","height","width","renderSearchHeader","View","VSearchHeader","onSearch","key","size","renderSortCol","caption","sort","checked","defaultChecked","renderSortHeaders","role","aria-label","renderValue","value","valueType","vStr","_cn","cn","isNaN","toFixed","percent1","number","round","toString","numberToMarketValue","renderStockInfoRow","row","onClickName","pe","roe","divyield","order","total","ep","e3","zzl","funcz","p","calculateZZ3","dataArr","rows","map","w","VHome","setSortType","renderRow","index","rowContent","href","target","rel","stopPropagation","rowKey","openStockInfo","onSelected","clickRow","callOnSelected","openMarketPE","scroller","onPage","V","title","config","tagName","onAddStock","inverse","before","none","VSelectTag","onClickTag","VMarketPE","input","checkLimitShow","f","onLongShortFlag","head","pageContent","historyChart","chartHistory","labelList","peList","eList","numberToPrecision","chartdata1","labels","datasets","borderColor","backgroundColor","borderWidth","fill","yAxisID","options","scales","yAxes","display","position","gridLines","drawOnChartArea","onChange","CMarketPE","longshortFlag","dt","Date","getFullYear","getMonth","getDate","reverse","CHome","userTag","oldSortType","disposeAutorun","autorun","needLoad","oldID","tagID","newSortType","userStock","sortType","load","selectTag","onWarningConfg","cWarning","setUserSortType","arr","slice","sortStocks","replace","renderSiteHeader","renderView","renderHome","tab","newC","stockID","loadItems","pageStart","pageSize","yearlen","result","dataArray","JSON","parse","sl","calculateVN","exprice","predictpe","warnings","HttpChannel","hostUrl","apiToken","ui","timeout","startWait","endWait","url","reject","showError","error","post","params","keys","Object","k","buildOptions","method","innerFetch","body","stringify","resolve","buildError","err","channel","that","path","console","timeOutHandler","setTimeout","fetch","encodeURI","res","ok","clearTimeout","statusText","ct","headers","get","indexOf","json","retJson","catch","message","text","toLowerCase","startsWith","logout","u","language","culture","Headers","append","lang","HttpChannelNavUI","onError","channelUIs","channelNoUIs","MiApiChannel","basePath","apiName","uqToken","showWaiting","token","channels","channelUI","getHttpChannel","callFetch","put","delete","MiApi","pbody","_","clone","proc","meTab","LoadableComponent","Loadable","loader","Loading","color","selected","cHome","cExporer","tabs","icon","content","notify","onShown","TabCaptionComponent","tabsProps","VExplorer","onClickPredictAVG","avgs","priceDay","lastTradeDay","avg20","avg50","avg100","avg","openPredictAVG","blackList","labelId","fInDef","defaultList","onSelectItem","onClickItem","onConfig","avgHead","reload","avgStr","numberToFixString","irate","bmin","bmax","lmin","lmax","lr4","mcount","r210","VExplorerCfg","sortChage","newType","setStockSortType","selectChange","setStockSelectType","cfg","setRegressionConfig","findStockConfg","regression","CExplorer","oldSelectType","newSelectType","stockFind","selectType","queryName","blackID","blackListTagID","bMin","bMax","lMin","lMax","lastDayRet","CalculateValueAvg","VWarningConfig","onNewWarning","renderWarning","witem","warningTypeString","VNewWarning","newuiSchema","pickId","Templet","onSaveNewWarning","CWarning","loadWarnings","onSaveWarning","_cApp","VPredictHistory","avg20List","avg50List","avg100List","CPredictHistory","li","getsortFunc","o","saveConfig","selectAccount","accounts","accountName","isLogined","miHost","loadConfig","loadWarning","loadTags","loadAccounts","cStr","loadBlackList","loadDefaultList","checkDefaultTags","r1","br","blackid","AddBlackID","AddDefaultID","stockIDs","RemoveBlackID","RemoveDefaultID","vp","open","precision","toPrecision","Number","parseFloat","t","iRate","e1","e2","r3","z","pow","floor","year","month","s","begin","calcuOne","count","sum","check","ttmLimit","checkShowLater","checkDefaultTag","headStr","dateHead","baseInfo","predictInfo","predictSeasonEarning","seasonEarning","capitalEarning","evt","isInteger","trim","onSubmit","dayString","ref","defaultValue","fInList","percentToFixString","window","opener","priceList","ttmList","chart1","showLine","pointStyle","pointRadius","per","plr","chart2","predictChartFullInfo","chart3","predictChartROE","numberToString","SeasonnoToYearMonth","chartdataFull","capitalearning","VStockSelect","onClickStock","model","returnStock","customer","PageItems","onScrollBottom","allowEmptySearch","searchByKey","renderStock","PageStockItems","cs","firstSize","first","returnCall","more"],"mappings":"wVAMaA,EAAb,4MAKUC,SAAW,SAACC,EAAWC,EAAqBC,GAClD,EAAKC,WAAWC,iBAAiBJ,EAAMC,IAN3C,EASUI,UAAY,SAACC,EAASC,GAC5BA,EAAEC,iBACF,EAAKL,WAAWE,UAAUC,IAX9B,EAcUG,UAAY,SAACH,GACnB,IAAII,EAAO,qBAAKC,UAAU,2BAAf,SAA2CL,EAAIM,OAEtDC,EADQP,EAAIM,OAASE,KAA2BR,EAAIM,OAASG,IAC7C,GAAK,qBAAKJ,UAAU,2BAA2BK,QAAS,SAACT,GAAD,OAAK,EAAKF,UAAUC,EAAKC,IAA5E,0BACzB,OAAO,cAAC,MAAD,CAAKI,UAAU,YAAYD,KAAMA,EAAMG,MAAOA,KAlBzD,EAsBUI,KAAOC,aAAS,WAAO,IACvBC,EAAiB,EAAKhB,WAAtBgB,aACAC,EAAS,EAAKjB,WAAWkB,KAAzBD,KACFE,EAAYF,EAAKG,QAAU,GAAK,GAClC,sBAAKZ,UAAU,2BAA2BK,QAAS,EAAKb,WAAWqB,SAAnE,UAA6E,cAAC,KAAD,CAAIZ,KAAK,OAAOD,UAAU,iBAAvG,oCACF,OAAO,eAAC,OAAD,CAAMc,OAAO,2BAAOC,gBAAgB,aAApC,UACJJ,EACD,cAAC,OAAD,CAAMK,MAAOP,EAAMpB,KAAM,CAAED,SAAU,EAAKA,SAAU6B,OAAQ,EAAKnB,WAAaoB,cAAeV,UA7BnG,iFACE,WAAWW,GAAX,SAAAC,EAAA,sDACEC,KAAKC,SAASD,KAAKf,MADrB,gDADF,4DAA2BiB,SAkCrBC,EAAuB,CAC3B,CAAEvB,KAAM,OAAQwB,KAAM,SAAUC,UAAU,EAAMC,UAAW,IAC3D,CAAE1B,KAAM,KAAMwB,KAAM,MACpB,CAAExB,KAAM,SAAUwB,KAAM,WAEpBG,EAAqB,CACzBZ,MAAO,CACLf,KAAM,CAAE4B,OAAQ,OAAQC,MAAO,KAAMC,YAAa,4BAClDC,GAAI,CAAEH,OAAQ,KAAMI,SAAS,GAC7BC,OAAQ,CAAEL,OAAQ,SAAUC,MAAO,eAAM9B,UAAW,qBAI3CmC,EAAb,4MAKUC,kBALV,uCAK8B,WAAOnC,EAAcoC,GAArB,SAAAjB,EAAA,sEAChB,EAAK5B,WAAW8C,aAAaD,EAAQE,MADrB,kCAExB,EAAK/C,WAAWgD,YAFQ,2CAL9B,0DAWUlC,KAAO,WACb,OAAO,cAAC,OAAD,CAAMQ,OAAO,2BAAOC,gBAAgB,aAApC,SACL,qBAAKf,UAAU,YAAf,SACE,cAAC,OAAD,CAAMwB,OAAQA,EACZI,SAAUA,EACVa,cAAUC,EACVC,cAAe,EAAKP,yBAjB9B,iFACE,WAAWjB,GAAX,SAAAC,EAAA,sDACEC,KAAKC,SAASD,KAAKf,MADrB,gDADF,4DAA6BiB,SAwBhBqB,EAAb,4MAKUR,kBALV,uCAK8B,WAAOnC,EAAcoC,GAArB,SAAAjB,EAAA,sEAChB,EAAK5B,WAAWqD,UAAUR,EAAQE,MADlB,kCAExB,EAAK/C,WAAWgD,YAFQ,2CAL9B,0DAWUlC,KAAO,SAACa,GAAiB,IAE3B2B,EAAQ,CAACd,GADIb,EAAZa,GACe/B,KADHkB,EAARlB,MAET,OAAO,cAAC,OAAD,CAAMa,OAAO,2BAAOC,gBAAgB,aAApC,SACL,qBAAKf,UAAU,YAAf,SACE,cAAC,OAAD,CAAMwB,OAAQA,EACZI,SAAUA,EACVa,SAAUK,EACVH,cAAe,EAAKP,yBAnB9B,iFACE,WAAWjB,GAAX,SAAAC,EAAA,sDACEC,KAAKC,SAASD,KAAKf,KAAMa,GAD3B,gDADF,4DAA8BI,S,gBClEjBwB,GAAb,uXAQEvC,kBARF,IAUYwC,kBAAmD,GAV/D,EAWYC,YAA2E,GAXvF,kSAkBYC,eAA4D,GAlBxE,EAqBYC,gBAAyDC,aAAWC,MAA2B,GAAI,CAAEC,MAAM,IArBvH,EAsBYC,OAAuCH,aAAWC,MAAkB,GAAI,CAAEC,MAAM,IAtB5F,EAuBYE,YAAiDJ,aAAWC,MAAuB,GAAI,CAAEC,MAAM,IAvB3G,EA6CEG,SAAW,WACT,EAAKC,WA9CT,EAiDEA,QAjDF,sBAiDY,kDAAAtC,EAAA,yDACH,EAAKuC,SADF,0DAGU,EAAKA,SAAjB3B,EAHE,EAGFA,GAAI4B,EAHF,EAGEA,IAHF,SAISC,QAAQC,IAAI,CAC3B,EAAKpD,KAAKqD,MAAMC,MAAM,iBAAkB,CAAChC,EAAI4B,IAC7C,EAAKlD,KAAKqD,MAAMC,MAAM,mBAAoB,CAAC,EAAKC,KAAKjC,QAAIU,EAAWV,MAN9D,UAIJkC,EAJI,OAQR,EAAKC,UAAYD,EAAK,GAClBE,EAAMF,EAAK,IACXG,MAAMC,QAAQF,EAAI,IAVd,wBAWFG,EAAOH,EAAI,GACXC,MAAMC,QAAQC,KAChB,EAAKC,MAAQD,EAAK,IAGhB,EAAKpB,gBAAgBvC,OAAS,GAChC,EAAKuC,gBAAgBsB,QAEnBC,EAAON,EAAI,GACXC,MAAMC,QAAQI,KAChB,IAAKvB,iBAAgBwB,KAArB,oBAA6BD,IAG/B,EAAKnB,OAAOkB,QACRG,EAAOR,EAAI,GACXC,MAAMC,QAAQM,KAChB,IAAKrB,QAAOoB,KAAZ,oBAAoBC,IAGtB,EAAKpB,YAAYiB,QACbI,EAAOT,EAAI,GACXC,MAAMC,QAAQO,KAChB,IAAKrB,aAAYmB,KAAjB,oBAAyBE,IAG3B,EAAK7B,kBAAoBoB,EAAI,GApCvB,UAqCA,EAAKU,eAAeV,EAAI,IArCxB,QAsCN,EAAKnB,YAAcmB,EAAI,GAEvB,EAAKlB,eAAiBkB,EAAI,GAC1B,EAAKW,iBAAgB,GAzCf,QA4CR,EAAKC,QAAS,EA5CN,4CAjDZ,EA6REC,aAAe,aA7RjB,EAgSEC,YAhSF,sBAgSgB,sBAAA9D,EAAA,sDAEZ,EAAKZ,aAAe,EAAKE,KAAKD,KAAK0E,QAAO,SAAAC,GAExC,OADQ,EAAKjB,UAAUkB,WAAU,SAAAC,GAAE,OAAIA,EAAG3F,MAAQyF,EAAEpD,OACxC,KAGd,EAAKuD,UAAUpG,GAPH,2CAhShB,EA0SE0B,SAAW,WACT,EAAK0E,UAAUpD,IA3SnB,EA8SEzC,UAAY,SAACyB,GACX,EAAKoE,UAAU3C,EAAUzB,IA/S7B,EAkTEmB,aAlTF,uCAkTiB,WAAOC,GAAP,mBAAAnB,EAAA,6DACPnB,EAASsC,EAATtC,KADO,SAGG,EAAKS,KAAKqD,MAAMyB,KAAK,aAAc,CAAC,EAAKvB,KAAKjC,QAAIU,EAAWzC,IAHhE,UAGTmE,EAHS,UAIPqB,EAAUrB,EAAVqB,OACM,GALC,uBAMXC,MAAMzF,EAAO,yCANF,mBAOJ,GAPI,cASb,EAAKS,KAAKD,KAAKkE,KAAK,CAAE3C,GAAIyD,EAAOxF,KAAMA,IAT1B,mBAUN,GAVM,4CAlTjB,wDA+TE4C,UA/TF,uCA+Tc,WAAON,GAAP,uBAAAnB,EAAA,yDACJY,EAAaO,EAAbP,GAAI/B,EAASsC,EAATtC,KACE,CAAE+B,GAAIA,EAAI/B,KAAMA,MACxB0F,EAAI,EAAKjF,KAAKD,KAAK4E,WAAU,SAAAD,GAAC,OAAIA,EAAEpD,KAAOA,GAAMoD,EAAEnF,OAASA,OACvD,GAJC,uBAKRyF,MAAMzF,EAAO,yCALL,mBAMD,GANC,uBAQM,EAAKS,KAAKqD,MAAMyB,KAAK,aAAc,CAAC,EAAKvB,KAAKjC,QAAIU,EAAWzC,IARnE,UAQNmE,EARM,cAUI1B,KADR+C,EAAUrB,EAAVqB,QACqBA,EAAQ,GAVzB,wBAWRC,MAAMzF,EAAO,yCAXL,mBAYD,GAZC,eAcV0F,EAAI,EAAKjF,KAAKD,KAAK4E,WAAU,SAAAD,GAAC,OAAIA,EAAEpD,KAAOA,OAClC,IACP,EAAKtB,KAAKD,KAAKkF,GAAG1F,KAAOA,GAhBjB,mBAkBH,GAlBG,4CA/Td,wDAoVER,iBApVF,uCAoVqB,WAAOE,EAAUL,GAAjB,iBAAA8B,EAAA,yDACL,CACV6C,KAAM2B,MAAI3B,KAAKjC,GACfrC,IAAKA,EAAIqC,GACTuC,KAAM,CACJ,CAAEsB,MAAO,EAAKlC,SAAS3B,OAGR,IAAf1C,EARa,iCASC,EAAKoB,KAAKqD,MAAMyB,KAAK,iBAAkB,CAAC,EAAKvB,KAAKjC,GAAIrC,EAAIqC,GAAI,EAAK2B,SAAS3B,KAT7E,qBAUX8D,EAAS,CACXnG,IAAK,CACHqC,GAAIrC,EAAIqC,KAGZ,EAAKmC,UAAUQ,KAAKmB,GAfL,SAgBT,EAAKpF,KAAKqF,cAAcpG,EAAIqC,GAAI,EAAK2B,SAAS3B,IAhBrC,gDAmBC,EAAKtB,KAAKqD,MAAMyB,KAAK,iBAAkB,CAAC,EAAKvB,KAAKjC,GAAIrC,EAAIqC,GAAI,EAAK2B,SAAS3B,KAnB7E,sBAoBX2D,EAAI,EAAKxB,UAAUkB,WAAU,SAAAD,GAAC,OAAIA,EAAEzF,IAAIqC,KAAOrC,EAAIqC,MACvD,EAAKmC,UAAU6B,OAAOL,EAAG,GArBV,UAsBT,EAAKjF,KAAKuF,iBAAiBtG,EAAIqC,GAAI,EAAK2B,SAAS3B,IAtBxC,4CApVrB,0DA8WEkE,kBA9WF,uCA8WsB,WAAO5G,GAAP,mBAAA8B,EAAA,yDACd+E,EAAQ,EAAKzF,KAAK0F,kBACH,IAAf9G,EAFc,iCAGA,EAAKoB,KAAKqD,MAAMyB,KAAK,iBAAkB,CAAC,EAAKvB,KAAKjC,GAAImE,EAAO,EAAKxC,SAAS3B,KAH3E,qBAIZ8D,EAAS,CACXnG,IAAK,CACHqC,GAAImE,IAGR,EAAKhC,UAAUQ,KAAKmB,GATJ,SAUV,EAAKpF,KAAKqF,cAAcI,EAAO,EAAKxC,SAAS3B,IAVnC,gDAaA,EAAKtB,KAAKqD,MAAMyB,KAAK,iBAAkB,CAAC,EAAKvB,KAAKjC,GAAImE,EAAO,EAAKxC,SAAS3B,KAb3E,sBAcZ2D,EAAI,EAAKxB,UAAUkB,WAAU,SAAAD,GAAC,OAAIA,EAAEzF,IAAIqC,KAAOmE,KACnD,EAAKhC,UAAU6B,OAAOL,EAAG,GAfT,UAgBV,EAAKjF,KAAKuF,iBAAiBE,EAAO,EAAKxC,SAAS3B,IAhBtC,4CA9WtB,wDAkYEqE,gBAlYF,uCAkYoB,WAAOzC,GAAP,mBAAAxC,EAAA,6DACZkF,EAAS,IAAIC,IAAO,EAAK7F,MADb,SAEC4F,EAAOd,OAFR,cAEZnG,EAFY,QAGZmH,EAHY,eAGJnH,IACVuE,IAAMA,EACR,EAAKD,SAAW6C,EAChB,EAAKxB,QAAS,EANE,UAOV,EAAKtB,UAPK,4CAlYpB,wDA4YE+C,UA5YF,uCA4Yc,WAAO7C,GAAP,yBAAAxC,EAAA,yDACN,EAAKuC,SAASC,MAAQA,EADhB,0DAGqB,EAAKD,SAA/B3B,EAHK,EAGLA,GAAI/B,EAHC,EAGDA,KAAMyG,EAHL,EAGKA,KAAMC,EAHX,EAGWA,OACjBC,EAAK,CAAC5E,GAAGA,EAAI/B,KAAKA,EAAMyG,KAAKA,EAAMC,OAAOA,EAAQ/C,IAAW,IAAPA,OAAWlB,EAAYkB,GACjF,EAAKD,SAAWiD,EAChB,EAAK5B,QAAS,EANJ,SAOJ,EAAKtB,UAPD,2CA5Yd,wGA8BE,WACE,IAAoB,IAAhBrC,KAAK2D,OACT,OAAO3D,KAAK8B,kBAhChB,iBAmCE,WACE,IAAoB,IAAhB9B,KAAK2D,OACT,OAAO3D,KAAKkC,SArChB,sBAwCE,WACE,IAAoB,IAAhBlC,KAAK2D,OACT,OAAO3D,KAAKmC,cA1ChB,mEAgGE,WAA+BqD,GAA/B,wHACExF,KAAKyF,WAAWd,OAAO,GACnBe,EAA0H,MAC1HC,EAAMH,EAAKjG,SACJ,GAJb,iDAMMqG,EAAQJ,EAAKG,EAAM,GAAGE,SACtBC,EAAWN,EAAK,GAChBO,EAAQD,EAASD,SARvB,EAUcG,IAAMC,mBAAmBF,GAAhCG,EAVP,EAUOA,IAVP,cAWmBV,GAXnB,IAWE,2BAASxH,EAAc,QACjBmI,EAAKnI,EAAK6H,SACVO,EAAQ,CAACC,OAAOF,EAAIG,EAAGtI,EAAKuI,QAAShI,EAAGP,EAAKwI,GAAIC,KAAMzI,EAAK0I,QAASC,KAAM3I,EAAKuI,QAASK,KAAM5I,EAAKwI,GAAIK,QAAS7I,EAAK0I,SAC1H1G,KAAK8G,eAAeZ,EAAKC,EAAIC,GAC7BV,EAAWS,GAAMC,EAfrB,8BAkBM9B,EAAI,EACJmC,EAAO,EACFZ,EAAWD,EApBtB,aAoB6BC,GAAYE,GApBzC,yBAsBe1E,KADP0F,EAAKrB,EAAWG,IArBxB,wDAyBIY,GAAQM,EAAGxI,EACP+F,EAAI,EACNyC,EAAGN,UAAOpF,GAGV0F,EAAGN,KAAOA,OAEOpF,KADb2F,EAAWtB,EAAWG,EAAS,MAEjCY,GAAQO,EAASzI,IAGrByB,KAAKyF,WAAWd,OAAO,EAAE,EAAGoC,GApChC,UAoBkDlB,IAAYvB,EApB9D,2BAuCM2C,EAAUlB,EAAQ,GACtB/F,KAAKkH,iBAAc7F,EACnBrB,KAAKmH,kBAAkBxC,OAAO,GAC9B3E,KAAKoH,sBAAsBzC,OAAO,KAC9BsC,EAAUrB,GA3ChB,mDA6CEqB,GAAW,EACXjH,KAAKqH,SAAW,GACPC,EAAIL,EA/Cf,aA+CwBK,GAAKvB,GA/C7B,yBAiDiB1E,KADTrD,EAAO0H,EAAW4B,IAhD1B,qDAmDItH,KAAKmH,kBAAkBxC,OAAO,EAAG,EAAG3G,GACpCgC,KAAKqH,SAAS/D,KAAKtF,EAAKyI,MApD5B,QA+CoCa,GAAK,EA/CzC,wBAuDWA,EAAIvB,EAvDf,aAuDsBuB,GAAK1B,GAvD3B,yBAyDiBvE,KADTrD,EAAO0H,EAAW4B,IAxD1B,qDA2DItH,KAAKoH,sBAAsB9D,KAAKtF,GA3DpC,QAuDkCsJ,GAAK,EAvDvC,wBA6D+B,IAAzBtH,KAAKqH,SAAS9H,QACZgI,EAAK,IAAIC,IAAaxH,KAAKqH,UAC3BI,EAAK,IAAIC,IAAc1H,KAAKqH,UAChCrH,KAAKkH,YAAc,CAAC3I,EAAEyB,KAAKqH,SAAS,GAAIlC,EAAGoC,EAAGI,EAAGC,GAAIL,EAAGK,GAAIC,KAAMN,EAAGO,QAAQ,GAAIC,EAAGN,EAAGO,OAAQC,IAAKR,EAAGG,GAAIM,KAAMT,EAAGK,QAAQ,KAG5H9H,KAAKmH,kBAAkBxC,OAAO,GAnElC,iDAhGF,mFAuKE,SAAyBwD,EAAe9B,EAAerI,GAErD,IAF8F,IACzFkI,EAAOF,IAAMC,mBAAmBI,GAAhCH,IACI5B,EAAI,EAAGA,EAAItE,KAAK2B,kBAAkBpC,SAAU+E,EAAG,CACtD,IAAI8D,EAASpI,KAAK2B,kBAAkB2C,GAChC/B,EAAM6F,EAAO7F,IACjB,GAAIA,EAAM4F,EACR,MACG,KAAI5F,EAAM2D,GAAV,CAGH,IAAImC,EAASD,EAAOC,OACpBrK,EAAKsI,EAAItI,EAAKsI,EAAI+B,EAClBrK,EAAKO,EAAIP,EAAKO,EAAI8J,EAClBrK,EAAKyI,KAAOzI,EAAKyI,KAAO4B,MApLhC,6BAyLE,SAAgBC,GACd,IAAI9C,EAAOxF,KAAK6B,eACZtC,EAASiG,EAAKjG,OAClB,GAAIA,GAAU,GACZS,KAAKuI,YAAc,OADrB,CAIA,IAAKD,EAAS,CACZ,IAAI/F,EAAMvC,KAAKsC,SAASC,IACxB,QAAYlB,IAARkB,EAAmB,CAErB,IADA,IAAI+B,EAAI/E,EAAS,EACV+E,GAAK,IAAKA,EAAG,CAElB,GADWkB,EAAKlB,GACP/B,KAAOA,EACd,MAGJhD,EAAS+E,EAAI,GAGjB,IAAIkE,EAAWjJ,EAAS,EACpBuG,EAAWN,EAAKgD,GAChBC,EAAY3C,EAAS4C,MACzB,QAAkBrH,IAAdoH,EACF,KAAOD,EAAW,QAIEnH,KADlBoH,GADA3C,EAAWN,IADTgD,IAEmBE,SAQzB,IAHA,IAAIC,EAAU7C,EAASvD,IACnBqG,EAAMH,EAAY,EAClBI,EAAqB,GAChBvE,EAAI,EAAGA,GAAKkE,IAAYlE,EAAG,CAAC,IAAD,EACRkB,EAAKlB,GAA1B/B,EAD6B,EAC7BA,IAAKY,EADwB,EACxBA,MADwB,EACjBuF,MACJ,IAAME,GACjBC,EAAYvF,KAAK,CAACf,IAAIA,EAAKY,MAAMnD,KAAK8I,aAAa3F,EAAOZ,EAAKoG,GAAUI,IAAI/I,KAAKgJ,mBAAmB7F,EAAOZ,KAGhHvC,KAAKuI,YAAcM,KAlOvB,0BAqOE,SAAa1F,EAAc8F,EAAgBC,GACzC,IAAIC,EAAO,EACPC,EAAUjG,EACd,GAAI8F,EAAUC,EAAU,CACtB,IAAK,IAAI5E,EAAI,EAAGA,EAAItE,KAAK4B,YAAYrC,SAAU+E,EAAG,CAAC,IAAD,EACZtE,KAAK4B,YAAY0C,GAAhD/B,EAD2C,EAC3CA,IAAK8G,EADsC,EACtCA,MAAOhB,EAD+B,EAC/BA,OAAQiB,EADuB,EACvBA,QACzB,KAAI/G,GAAO0G,GAAX,CAEA,GAAI1G,EAAM2G,EACR,MACFE,GAAoBf,EACpBc,GAAQA,EAAOE,GAASC,GAE1BF,GAAoBD,MAEjB,CACH,IAAK,IAAI7E,EAAI,EAAGA,EAAItE,KAAK4B,YAAYrC,SAAU+E,EAAG,CAAC,IAAD,EACZtE,KAAK4B,YAAY0C,GAAhD/B,EAD2C,EAC3CA,IAAK8G,EADsC,EACtCA,MAAOhB,EAD+B,EAC/BA,OAAQiB,EADuB,EACvBA,QACzB,KAAI/G,GAAO2G,GAAX,CAEA,GAAI3G,EAAM0G,EACR,MACFG,GAAoBf,EACpBc,EAAOA,EAAOG,EAAUD,GAE1BD,GAAoBD,EAEtB,OAAOC,IAhQX,gCAmQE,SAAmBjG,EAAcZ,GAG/B,IAFA,IAAI8D,EAASL,IAAMuD,gBAAgBhH,GAC/BoD,EAAM3F,KAAKyF,WAAWlG,OACjB+E,EAAI,EAAGA,EAAIqB,IAAOrB,EAAG,CAC5B,IAAItG,EAAOgC,KAAKyF,WAAWnB,GAC3B,KAAItG,EAAKqI,QAAUA,GAAnB,CAIA,QAAqBhF,IAAjBrD,EAAK6I,QACP,OAP0B,IASvBX,EAAOF,IAAMC,mBAAmBjI,EAAKqI,QAArCH,IAEL,OADclG,KAAK8I,aAAa3F,EAAOZ,EAAK2D,GAC3BlI,EAAK6I,YAjR5B,kEAuRE,WAAoB/G,GAApB,SAAAC,EAAA,sDACEC,KAAKsC,SAAWxC,EAChBE,KAAKoC,WACLpC,KAAKkE,UAAUsF,KAHjB,gDAvRF,4DAAgCC,KAAhC,sCACG1H,cADH,kGAEGA,cAFH,yEAE0C,KAF1C,mCAIGA,cAJH,qGAOGA,cAPH,sGAYGA,cAZH,wEAYwH,MAZxH,+CAaGA,cAbH,wEAa+H,MAb/H,mDAcGA,cAdH,wEAcmI,MAdnI,yCAeGA,cAfH,oGAgBGA,cAhBH,wEAgBmC,MAhBnC,yCAiBGA,cAjBH,wEAiBsE,MAjBtE,0CA8BG2H,YA9BH,4GAmCGA,YAnCH,wGAwCGA,YAxCH,2E,6NCkBMC,EAAsB,CAC3BC,QAAS,cACTC,QAAS,OACTC,SAAKzI,EACL0I,UAAW,IAaKC,E,4MARRC,U,sBAAY,sBAAAlK,EAAA,sEACZmK,gBAAMC,IAAQR,GADF,2C,4CAGpB,WACE,OAAO,cAAC,UAAD,CAASM,UAAWjK,KAAKiK,gB,GANfG,IAAMC,WCtBXC,EAZS,SAACC,GACnBA,GAAeA,aAAuBC,UACxC,8BAAqBC,MAAK,YAAkD,IAA/CC,EAA8C,EAA9CA,OAAQC,EAAsC,EAAtCA,OAAQC,EAA8B,EAA9BA,OAAQC,EAAsB,EAAtBA,OAAQC,EAAc,EAAdA,QAC3DJ,EAAOH,GACPI,EAAOJ,GACPK,EAAOL,GACPM,EAAON,GACPO,EAAQP,OCFdQ,IAASnL,OACP,cAAC,IAAMoL,WAAP,UACE,cAAC,EAAD,MAEFC,SAASC,eAAe,SAM1BZ,K,sHCjBa5C,EAAb,WAQE,WAAYyD,GAAa,yBAPzBC,WAOwB,OANxBC,eAMwB,OALxBF,OAKwB,OAJxBnD,YAIwB,OAHxBsD,UAGwB,OAFxB1D,QAEwB,EACtB5H,KAAKmL,EAAIA,EACTnL,KAAKuL,UACL,IAAIC,EAAQxL,KAAKwL,QACjBxL,KAAK4H,GAAK4D,EAAM5D,GAZpB,2CAeE,WAQE,IAPA,IAAM6D,EAAIzL,KAAKmL,EAAE5L,OACbmM,EAAO,EACPC,EAAO,EAEPC,EAAW,EACXC,EAAK,EAEAvE,EAAI,EAAGA,EAAImE,IAAKnE,EACvBoE,GAAQpE,EACRqE,GAAQ3L,KAAKmL,EAAE7D,GACfsE,GAAYtE,EAAIA,EAChBuE,GAAMvE,EAAItH,KAAKmL,EAAE7D,GAGnB,IAAMwE,EAAYL,EAAII,EAAKH,EAAOC,EAClC3L,KAAKoL,MAAQU,GAAaL,EAAIG,EAAWF,EAAOA,GAChD1L,KAAKqL,UAAa,EAAII,EAAKE,EAAO3L,KAAKoL,OAAS,EAAIK,GAAKC,EAEzD,IAAIK,EAAK/L,KAAKoL,MAAQ,EAAIpL,KAAK8H,QAAQ2D,EAAE,GAAKzL,KAAK8H,QAAQ,GAC3D9H,KAAKgI,OAAS+D,EAAK,SAAO1K,EAAYrB,KAAKoL,MAAQW,IAnCvD,mBAsCE,WAGE,IAFA,IAAMN,EAAIzL,KAAKmL,EAAE5L,OACXyM,EAAK,IAAIhJ,MAAMyI,GACZnH,EAAI,EAAGA,EAAImH,EAAGnH,IACrB0H,EAAG1H,GAAKtE,KAAK8H,QAAQxD,GAUvB,IAPA,IAAIoH,EAAO,EACPC,EAAO,EACPM,EAAO,EACPC,EAAO,EACPN,EAAW,EACXO,EAAW,EACXN,EAAK,EACAvH,EAAI,EAAGA,EAAImH,EAAGnH,IAAK,CAC1B,IAAI8H,EAAMJ,EAAG1H,GACboH,GAAQU,EACR,IAAIC,EAAKrM,KAAKmL,EAAE7G,GAChBqH,GAAQU,EACRT,GAAYQ,EAAMA,EAClBD,GAAYE,EAAKA,EACjBR,GAAMO,EAAMC,EACZ,IAAIC,EAAQD,EAAKD,EACN,IAAPC,IACFJ,GAASK,EAAQA,EAASD,GAE5BH,GAAQI,EAAQA,EAGlB,IAAMC,GACHd,EAAII,EAAKH,EAAOC,GACjBa,KAAKC,MAAMhB,EAAIG,EAAWF,EAAOA,IAASD,EAAIU,EAAWR,EAAOA,IAElE,MAAO,CACLY,EAAGA,EACH3E,GAAI2E,EAAIA,EACRN,KAAMA,EACNC,KAAMM,KAAKC,KAAKP,EAAOT,MA3E7B,qBAgFE,SAAQnE,GACN,OAAOtH,KAAKoL,MAAQ9D,EAAItH,KAAKqL,YAjFjC,sBAoFE,SAASF,GACP,OAAQA,EAAInL,KAAKqL,WAAarL,KAAKoL,UArFvC,KCAa5D,EAAb,WAME,WAAY2D,GAAa,yBALzBuB,OAKwB,OAJxB/E,OAIwB,OAHxBwD,OAGwB,OAFxBvD,QAEwB,EACtB5H,KAAKmL,EAAIA,EACTnL,KAAKuL,UACL,IAAIC,EAAQxL,KAAKwL,QACjBxL,KAAK4H,GAAK4D,EAAM5D,GAVpB,2CAaE,WAQE,IAPA,IAAM6D,EAAIzL,KAAKmL,EAAE5L,OACbmM,EAAO,EACPC,EAAO,EAEPC,EAAW,EACXC,EAAK,EAEAvE,EAAI,EAAGA,EAAImE,IAAKnE,EAAG,CAC1BoE,GAAQpE,EACR,IAAIqF,EAAKH,KAAKI,IAAI5M,KAAKmL,EAAE7D,IACzBqE,GAAQgB,EACRf,GAAYtE,EAAIA,EAChBuE,GAAMvE,EAAIqF,EAGZ,IACIvB,GADcK,EAAII,EAAKH,EAAOC,IACTF,EAAIG,EAAWF,EAAOA,GAC3CL,EAAa,EAAII,EAAKE,EAAOP,GAAS,EAAIK,GAAKC,EACnD1L,KAAK0M,EAAIF,KAAKK,IAAIxB,GAClBrL,KAAK2H,EAAIyD,IAjCb,mBAoCE,WAGE,IAFA,IAAMK,EAAIzL,KAAKmL,EAAE5L,OACXyM,EAAK,IAAIhJ,MAAMyI,GACZnH,EAAI,EAAGA,EAAImH,EAAGnH,IACrB0H,EAAG1H,GAAKtE,KAAK8H,QAAQxD,GAUvB,IAPA,IAAIoH,EAAO,EACPC,EAAO,EACPM,EAAO,EACPC,EAAO,EACPN,EAAW,EACXO,EAAW,EACXN,EAAK,EACAvH,EAAI,EAAGA,EAAImH,EAAGnH,IAAK,CAC1B,IAAI8H,EAAMJ,EAAG1H,GACboH,GAAQU,EACR,IAAIC,EAAKrM,KAAKmL,EAAE7G,GAChBqH,GAAQU,EACRT,GAAYQ,EAAMA,EAClBD,GAAYE,EAAKA,EACjBR,GAAMO,EAAMC,EACZ,IAAIC,EAAQD,EAAKD,EACN,IAAPC,IACFJ,GAASK,EAAQA,EAASD,GAE5BH,GAAQI,EAAQA,EAGlB,IAAMC,GACHd,EAAII,EAAKH,EAAOC,GACjBa,KAAKC,MAAMhB,EAAIG,EAAWF,EAAOA,IAASD,EAAIU,EAAWR,EAAOA,IAElE,MAAO,CACLY,EAAGA,EACH3E,GAAI2E,EAAIA,EACRN,KAAMA,EACNC,KAAMM,KAAKC,KAAKP,EAAOT,MAzE7B,qBA6EE,SAAQnE,GACN,OAAOtH,KAAK0M,EAAIF,KAAKK,IAAIvF,EAAItH,KAAK2H,OA9EtC,M,sPCKsB8B,EAAtB,4HAAsCqD,SAMhBC,GAHeC,OAGrC,0JACC,SAAkC5M,GACjC,IAAIkG,EAAI,IAAIlG,EAAKJ,MAEjB,OADAsG,EAAE2G,OACK3G,MAJT,GAAqC4G,aCXxBC,EAAS,CAClBC,WAAY,WACZC,QAAS,+CACTC,UAAW,wBACXC,eAAgB,yBAChBC,eAAeC,G,qGCLJ,MAA0B,iC,OCO5BC,EAAb,4JACI,WAC8B,KAA1B,IAIIhP,EAAO,qBAAKC,UAAU,MAAMgP,IAAKC,EAAMC,IAAI,OAAOC,MAAO,CAACC,OAAQ,OAAQC,MAAO,UAQrF,OAAO,cAAC,MAAD,CACHrP,UAAU,mCACVD,KAAMA,EAAMG,MARJwC,UAML,SAGH,qBAAK1C,UAAU,GAAf,SACKqB,KAAK7B,WAAW8P,mBAAmB,cAlBpD,GAAiCC,QCFpBC,EAAb,4MAEYC,SAFZ,uCAEuB,WAAOC,GAAP,SAAAtO,EAAA,0FAFvB,kGAOI,SAAOD,GACH,OAAO,cAAC,YAAD,CAAWnB,UAAU,aACxB2P,KAAMxO,EACNsO,SAAUpO,KAAKoO,SACf1N,YAAY,wBAXxB,GAAmCwN,Q,gBCCnC,SAASK,EAAcnO,EAAaoO,EAAgBC,GAA2D,IAA1BC,EAAyB,wDAC7G,OAAO,wBAAO/P,UAAU,4BAAjB,UACN,uBAAOyB,KAAK,QAAQzB,UAAU,wBAC7BC,KAAK,WAAW+P,eAAgBD,EAChC1P,QAAS,kBAAMyP,EAAKrO,MACpBoO,KAII,SAASI,EAAkBH,GACjC,OAAO,qBAAK9P,UAAU,gCAAf,SACN,sBAAKA,UAAU,YAAYkQ,KAAK,QAAQC,aAAW,kCAAnD,UACEP,EAAc,OAAQ,qBAAOE,GAAM,GACnCF,EAAc,QAAS,MAAOE,GAC9BF,EAAc,QAAS,qBAAOE,QAKlC,SAASM,EAAYP,EAAgBQ,EAAcC,GAClD,IAGIC,ECLoBzD,EDElB0D,EAAM,wBACRC,EAAKD,EAAM,KAGf,OAAQF,GACP,IAAK,KAAMC,OCNC7N,KADWoK,EDOIuD,ICNFK,MAAM5D,GAAK,IAAU,IAAJA,GAAS6D,QAAQ,GAAK,IDM7B,MACnC,IAAK,KAAMJ,ECLN,SAAkBzD,GACxB,YAAapK,IAANoK,GAAmB4D,MAAM5D,GAAK,IAAU,IAAJA,GAAS6D,QAAQ,GAAK,IDI9CC,CAASP,GAAQ,MACnC,IAAK,KAAME,EAAOM,EAAOR,EAAO,GAAI,MACpC,IAAK,KAAME,EAAOM,EAAOR,EAAO,GAAI,MACpC,IAAK,KACJE,EC5BI,SAA6BzD,GACnC,YAAapK,IAANoK,GAAmB4D,MAAM5D,GAAK,GAAKe,KAAKiD,MAAMhE,EAAE,KAAOiE,WD2BrDC,CAAoBX,GAC3BI,EATSD,0BAYX,OAAO,sBAAmBxQ,UAAWyQ,EAA9B,UACN,sBAAMzQ,UAAU,mBAAhB,SAAoC6P,IAAe,uBAClDU,IAFeV,GAMX,SAASoB,EAAmBC,EAAiBC,EAAuCjR,GACEgR,EAApFlP,GADkH,IAC9G/B,EAAgFiR,EAAhFjR,KAAMyG,EAA0EwK,EAA1ExK,KAAM0K,EAAoEF,EAApEE,GAAIC,EAAgEH,EAAhEG,IAAK7M,EAA2D0M,EAA3D1M,MAAO8M,EAAoDJ,EAApDI,SAAUlM,EAA0C8L,EAA1C9L,EAAGmM,EAAuCL,EAAvCK,MAAenI,GAAwB8H,EAAhCvK,OAAgCuK,EAAxB9H,GAAcoI,GAAUN,EAArBtR,EAAqBsR,EAAlBO,GAAkBP,EAAdQ,GAAcR,EAAVM,OAC5EG,ECwCA,SAAsBpP,GAC5B,IAAI6B,EAAe,MAAC1B,OAAWA,OAAWA,OAAWA,GACrD,QAAaA,IAATH,EACH,OAAO6B,EAER,GADU7B,EAAK3B,OACL,EACT,OAAOwD,EAOR,IALA,IAAIwN,EAAQ,SAAC9E,EAAU+E,GACtB,KAAIA,GAAK,GAAK/E,GAAK,GAEnB,OAASA,EAAI+E,EAAK,GAEVlM,EAAI,EAAGA,EAAI,IAAKA,EACxBvB,EAAIuB,GAAKiM,EAAMrP,EAAKoD,EAAE,GAAIpD,EAAKoD,IAEhC,OAAOvB,EDxDK0N,CAAcZ,EAAYa,SAChChS,EAAO,sBAAKC,UAAU,iBAAiBK,QAAS,kBAAI8Q,EAAYD,IAAzD,UACZ,sBAAMlR,UAAU,eAAhB,SAAgCC,IADpB,OAGZ,sBAAMD,UAAU,YAAhB,SAA6B0G,IAHjB,OAKZ,sBAAM1G,UAAU,aAAhB,SAA8BuR,OAE3BS,EAAkD,CACrD,CAAC,qBAAO5M,EAAG,MACX,CAAC,MAAOgM,EAAI,MACZ,CAAC,qBAAgB,IAATE,EAAc,MACtB,CAAC,eAAM9M,EAAO,MACd,CAAC,MAAW,IAAJ6M,EAAS,MACjB,CAAC,UAAMM,EAAI,GAAI,MACf,CAAC,UAAMA,EAAI,GAAI,MACf,CAAC,UAAMA,EAAI,GAAI,MACf,CAAC,UAAMA,EAAI,GAAI,MACf,CAAC,eAAMvI,EAAG,MACV,CAAC,eAAMoI,EAAMhN,EAAO,OAEnB,OAAO,sBAAKxE,UAAU,UAAf,UACR,cAAC,MAAD,CAAKA,UAAU,YAAYD,KAAMA,EAAMG,MAASA,IAChD,qBAAKF,UAAU,mBAAf,SACEgS,EAAKC,KAAI,SAAA7M,GAAC,OAAIgL,EAAYhL,EAAE,GAAIA,EAAE,GAAIA,EAAE,YCpErC,SAASyL,EAAO/D,GAAiB,IAANoF,EAAK,uDAAH,EACnC,YAAaxP,IAANoK,EAAkB,GAAKA,EAAE6D,QAAQuB,GCGlC,I,QAAMC,EAAb,mNAkCUC,YAAc,SAAC3Q,GACrB,EAAKjC,WAAW4S,YAAY3Q,IAnChC,EA6DE4Q,UAAY,SAAChT,EAAWiT,GAAZ,OAA2C,cAAC,EAAKC,WAAN,eAAqBlT,KA7D9E,EA8DYkT,WAAa,SAACrB,GAA2B,IAC3CvK,EAAWuK,EAAXvK,OACFzG,EAAQ,qBAAKF,UAAU,SAAf,SACR,mBAAGA,UAAU,iBAAiBwS,KAAI,wDAAmD7L,EAAnD,aAAsE8L,OAAO,SAASC,IAAI,sBAAsBrS,QAAS,SAACT,GAAKA,EAAE+S,mBAAnK,wCAEP,OAAO1B,EAAmBC,EAAK,EAAKC,YAAajR,IAnElD,EAsEU0S,OAAS,SAACvT,GAEhB,OADaA,EAAP2C,IAvEV,EA2EYmP,YAAc,SAAC9R,GACvB,EAAKG,WAAWqT,cAAcxT,IA5ElC,EA+EYyT,WA/EZ,uCA+EyB,WAAOzT,GAAP,SAAA+B,EAAA,sDACb,EADa,2CA/EzB,wDA0FE2R,SAAW,SAAC1T,GACV,EAAK2T,eAAe3T,IA3FxB,4CAqBE,WAAU,MAAO,iBArBnB,mBAsBE,WAAS,IAAD,OACT,OAAO,wBAAQW,UAAU,sBACxBK,QAAS,WAAK,EAAKb,WAAWyT,gBADxB,0CAvBR,gCA6BE,SAA6BC,GAC9B7R,KAAK7B,WAAW2T,WA9BjB,qBAsCE,WAAW,IAAD,OACPC,EAAI7S,oBAAS,WAChB,IAAI8S,EAAQ,EAAK7T,WAAWkB,KAAK4S,OAAOC,QAClCvS,EAAU,EAAKxB,WAAfwB,MAFgB,EAGY,EAAKxB,WAAjC0F,EAHgB,EAGhBA,YAAasO,EAHG,EAGHA,WACftT,EAAQ,sBAAKF,UAAU,SAAf,UACX,qBAAKA,UAAU,qBAAqBK,QAASmT,EAA7C,SAAyD,cAAC,KAAD,CAAIvT,KAAK,OAAOwT,SAAS,MAClF,qBAAKzT,UAAU,0BAA0BK,QAAS6E,EAAlD,SAA+D,cAAC,KAAD,CAAIjF,KAAK,OAAOwT,SAAS,SAErF1T,EAAO,qBAAKC,UAAU,oBAAf,SAAoCqT,IAC/C,OAAO,gCACP,cAAC,MAAD,CAAKrT,UAAU,YAAYD,KAAMA,EAAMG,MAAOA,IAC9C,cAAC,OAAD,CAAMY,OAAQmP,EAAkB,EAAKmC,aACpCpR,MAAOA,EACP3B,KAAM,CAAE4B,OAAQ,EAAKoR,UAAW3C,IAAK,EAAKkD,QAC1Cc,OAAQ,eACRC,KAAM,eAIR,OAAO,cAACP,EAAD,MA1DR,4BAmFE,SAAuB/T,QACGqD,IAApBrB,KAAKyR,WAITzR,KAAKyR,WAAWzT,GAHdqG,MAAM,6BArFZ,GAA2BnE,S,QCHdqS,EAAb,4MAKY9T,UAAY,SAACH,GACjB,OAAO,qBAAKK,UAAU,2BAAf,SAA2CL,EAAIM,QAN9D,EASYK,KAAOC,aAAS,WAAO,IACtBE,EAAQ,EAAKjB,WAAWkB,KAAxBD,KACCoT,EAAe,EAAKrU,WAApBqU,WACN,OAAO,cAAC,OAAD,CAAM/S,OAAO,2BAAOC,gBAAgB,aAApC,SACH,cAAC,OAAD,CAAMC,MAAOP,EAAMpB,KAAM,CAACgB,QAAQwT,EAAY5S,OAAO,EAAKnB,kBAbtE,iFACI,WAAWqB,GAAX,SAAAC,EAAA,sDACIC,KAAKC,SAASD,KAAKf,MADvB,gDADJ,4DAAgCiB,S,wBCKnBuS,EAAb,mNACUC,WADV,IAEUrE,SAAchN,EAFxB,EAYEsR,eAAiB,SAACpU,GAChB,IACIqU,EADQrU,EAAE6S,OAAO1C,QACL,EAAE,EAClB,EAAKvQ,WAAW0U,gBAAgBD,IAfpC,EAkBU3T,KAAOC,oBAAS,WACxB,IAAI4T,EAAO,8BAAO,KAChB,OAAO,cAAC,OAAD,CAAMrT,OAAQqT,EACnBpT,gBAAgB,aADX,SAEL,cAAC,EAAKqT,YAAN,SAtBN,EA0BUA,YAAc7T,oBAAS,WAC7B,OAAO,mCACL,cAAC,EAAK8T,aAAN,SA5BN,EAgCYA,aAAe9T,oBAAS,WAAO,IAClCqJ,EAAe,EAAKpK,WAApBoK,YACL,QAAoBlH,IAAhBkH,EACF,OAAO,6BACT,IAJsC,EAIlC0K,EAAe,WACfC,EAAkB,GAClBC,EAAkB,GAClBC,EAAiB,GAPiB,cAQrB7K,GARqB,IAQtC,2BAA8B,CAAC,IAAtBvK,EAAqB,QACvBuE,EAAcvE,EAAduE,IAAKwN,EAAS/R,EAAT+R,GAAIxR,EAAKP,EAALO,EACd2U,EAAU5P,KAAKf,GACf4Q,EAAO7P,KAAK0C,IAAMqN,kBAAkBtD,EAAI,IACxCqD,EAAM9P,KAAK/E,IAZyB,8BActC,IAAI+U,EAAa,CACfC,OAAQL,EACRM,SAAU,CACR,CACE/S,MAAO,KACPS,KAAMiS,EACNM,YAAY,OACZC,gBAAgB,UAChBC,YAAa,EACbC,MAAM,EACNC,QAAS,YAEX,CACEpT,MAAO,IACPS,KAAMkS,EACNK,YAAY,MACZC,gBAAgB,OAChBC,YAAa,EACbC,MAAM,EACNC,QAAS,cAsBfZ,EAAe,cAAC,IAAD,CAAK/R,KAAMoS,EAAYlT,KAAK,OAAO0T,QAlBpC,CACZC,OAAO,CACLC,MAAO,CAAC,CACN5T,KAAM,SACN6T,SAAS,EACTC,SAAU,QACVvT,GAAI,YACH,CACDP,KAAM,SACN6T,SAAS,EACTC,SAAU,OACVvT,GAAI,WACJwT,UAAW,CACPC,iBAAiB,SAM3B,IAAIvV,EAAQ,WAGZ,OAFAA,EAAQ,wBAAOF,UAAU,OAAjB,cAAyB,uBAAOyB,KAAK,WAAWxB,KAAK,aAAa+P,gBAAgB,EAC1F0F,SAAU,EAAK1B,iBADP,kBAED,qCAAE,cAAC,MAAD,CAAKhU,UAAU,qBAAqBD,KAAM,yCAAYG,MAAOA,IACpE,qBAAKF,UAAU,OAAOmP,MAAO,CAACE,MAAM,OAApC,SAA6CiF,UA5FnD,iFAIE,WAAWnT,GAAX,SAAAC,EAAA,sDACEC,KAAKC,SAASD,KAAKf,MADrB,gDAJF,2EAQE,SAAOa,GACL,OAAO,mBAAMb,KAAN,QATX,GAA+BiB,SCLlBoU,GAAb,6PAEYC,cAAuB,EAFnC,EASInS,SATJ,sBASe,gCAAArC,EAAA,6DACHyU,EAAK,IAAIC,KACT3U,EAAQ,CAAkB,IAAjB0U,EAAGE,cAAsC,KAAjBF,EAAGG,WAAW,GAAOH,EAAGI,UAAW,IAAK,EAAKL,eAF3E,SAGU,EAAKlV,KAAKqD,MAAMC,MAAM,aAAc7C,GAH9C,OAGH+C,EAHG,OAIP,EAAK0F,YAAc1F,EAAKgS,UAJjB,2CATf,0FAII,WAAoB/U,GAApB,SAAAC,EAAA,sDACIC,KAAKoC,WACLpC,KAAKkE,UAAUuO,GAFnB,gDAJJ,oFAgBI,SAAgBG,GACRA,IAAM5S,KAAKuU,gBAEfvU,KAAKuU,cAAgB3B,EACrB5S,KAAKoC,gBApBb,GAA+BqH,GAA/B,yCACK1H,cADL,wEACmE,MADnE,G,QCUa+S,GAAb,qNAEEnV,MAA+BoC,aAAWC,MAAW,GAAI,CAAEC,MAAM,IAFnE,EAGE8S,aAHF,IAIYC,iBAJZ,+CAOEC,eAAiBC,kBAAO,sBAAC,gCAAAnV,EAAA,yDACnBoV,GAAW,EACXC,EAAQ,EAAKL,SAAW,EAAKA,QAAQM,MACzC,EAAKN,QAAU,CAAE7C,QAAS,EAAK7S,KAAK4S,OAAOC,QAASmD,MAAO,EAAKhW,KAAKgW,OACjED,IAAU,EAAKL,QAAQM,QACzBF,GAAW,GAGTG,EAAc,EAAKjW,KAAK4S,OAAOsD,UAAUC,cACpBnU,IAArB,EAAK2T,YACP,EAAKA,YAAcM,EAEZ,EAAKN,cAAgBM,IAC5B,EAAKN,YAAcM,EACnBH,GAAW,IAGTA,EAjBmB,gCAkBf,EAAKM,OAlBU,4CAP3B,EA8CE5R,YA9CF,sBA8CgB,sBAAA9D,EAAA,sDACZ,EAAKmE,UAAUqO,GADH,2CA9ChB,EAkDEJ,WAlDF,sBAkDe,kCAAApS,EAAA,6DACPkF,EAAS,IAAIC,IAAO,EAAK7F,MADlB,SAEG4F,EAAOd,OAFV,eAID9C,KAFNkL,EAFO,+BAKL5L,EAAK4L,EAAE5L,IACF,GANA,wBAOHmE,EAAQ,EAAKzF,KAAK0F,iBAPf,UAQD,EAAK1F,KAAKqD,MAAMyB,KAAK,iBAAkB,CAAC,EAAKvB,KAAKjC,GAAImE,EAAOnE,IAR5D,yBASD,EAAKtB,KAAKqF,cAAcI,EAAOnE,GAT9B,yBAUD,EAAK8U,OAVJ,4CAlDf,EAiEEjD,WAjEF,uCAiEe,WAAOxU,GAAP,SAAA+B,EAAA,sEACL,EAAKV,KAAKqW,UAAU1X,GADf,OAEX,EAAKmD,YAFM,2CAjEf,wDAsEE2Q,OAtEF,sBAsEW,sBAAA/R,EAAA,0FAtEX,EA0EE4V,eAAiB,WACf,EAAKtW,KAAKuW,SAASD,kBA3EvB,EA4HE5E,YAAc,SAAC3Q,GACb,EAAKf,KAAKwW,gBAAgBzV,GAC1B,IAAI0V,EAAM,EAAKnW,MAAMoW,QACrB,EAAK1W,KAAK2W,WAAWF,GAErB,EAAKnW,MAAMsW,QAAQH,IAjIvB,EAgJEI,iBAAmB,WACjB,OAAO,EAAKC,WAAWzI,IAjJ3B,EAoJEO,mBAAqB,SAACK,GACpB,OAAO,EAAK6H,WAAWhI,EAAeG,IArJ1C,EAyJE8H,WAAa,WACX,OAAO,EAAKD,WAAWrF,IA1J3B,EA6JElN,aAAe,aA7JjB,EAgKEyS,IAAM,kBAAM,cAAC,EAAKD,WAAN,KAhKd,EAkKE5E,cAAgB,SAACxT,GACE,EAAKsY,KAAK5U,cAChBwI,MAAMlM,IApKrB,EAuKE4T,aAAe,WACJ,EAAK0E,KAAKhC,GAChBpK,SAzKP,mDA6BE,SAAqBpF,EAAeyR,GAC9BvW,KAAK+U,SAAW/U,KAAK+U,QAAQM,QAAUvQ,GACzC9E,KAAKyV,SA/BX,8BAmCE,SAAwB3Q,EAAeyR,GACrC,GAAIvW,KAAK+U,SAAW/U,KAAK+U,QAAQM,QAAUvQ,EAAO,CAEhD,IAAIR,EAAItE,KAAKL,MAAMqE,WAAU,SAAAD,GAAI,OAAOA,EAAEpD,KAAO4V,KAC9CjS,GAAK,GACPtE,KAAKL,MAAMgF,OAAOL,EAAG,MAxC5B,kEAoFE,WAAoBxE,GAApB,SAAAC,EAAA,0FApFF,gHAuFE,sBAAAA,EAAA,2DACcC,KAAKX,KAAKgW,MACV,GAFd,gCAGUrV,KAAKwW,YAHf,gDAvFF,oHA8FE,4CAAAzW,EAAA,4DACkB,UAEZ4C,EAAQ,CACV/D,KAHc,UAId6X,UAAW,EACXC,SAAU,IACV9T,KAAM5C,KAAK4C,KAAKjC,GAChBrC,IAAK0B,KAAKX,KAAKgW,MACfsB,QAAS,GATb,SAWqB3W,KAAKX,KAAKqD,MAAM+K,QAAQ9K,EAAO,IAXpD,UAWMiU,EAXN,QAYgC,IAA1B5T,MAAMC,QAAQ2T,GAZpB,iDAeMd,EAAMc,EAfZ,cAgBmBd,GAhBnB,IAgBE,2BAAS9X,EAAa,QAChB6Y,EAAYC,KAAKC,MAAM/Y,EAAKkD,MAChClD,EAAK0S,QAAUmG,EACXG,EAAK,IAAItP,IAAcmP,GAC3B7Y,EAAKoS,IAAM4G,EAAGlP,QAAQ,GAAK9J,EAAKO,GAAK,EACrCP,EAAKqS,GAAK2G,EAAGlP,QAAQ,GACrB9J,EAAK+F,EAAIiC,IAAMiR,YAAYD,EAAGhP,OAAQhK,EAAKoS,GAAIpS,EAAKiS,SAAWjS,EAAKmF,MAAOnF,EAAKkZ,SAChFlZ,EAAKmZ,UAAYnZ,EAAKmF,MAAQnF,EAAKqS,GAvBvC,8BAyBErQ,KAAKX,KAAK2W,WAAWF,GACrB9V,KAAKL,MAAMyD,SACX,EAAApD,KAAKL,OAAM2D,KAAX,oBAAmBwS,IA3BrB,iDA9FF,sHAoIE,4BAAA/V,EAAA,sEACgBC,KAAKX,KAAKqD,MAAMC,MAAM,aAAc,CAAC3C,KAAKX,KAAKuD,KAAKjC,KADpE,YAEYU,KADNkL,EADN,SAEyBvJ,MAAMC,QAAQsJ,GACnCvM,KAAKoX,SAAW7K,EAGZvM,KAAKoX,SAAS7X,OAAS,IACzBS,KAAKoX,SAAW,IAPtB,gDApIF,2DAA2B3N,GAA3B,sCAKG1H,cALH,wEAKgC,MALhC,G,iBCEO,IAAMsV,EAAb,WAMI,WAAYC,EAAiBC,EAAiBC,GAAqB,IAAD,gCAL1DF,aAK0D,OAJ1DC,cAI0D,OAH1DC,QAG0D,OAF1DC,aAE0D,OAO1DC,UAAY,gBACArW,IAAZ,EAAKmW,IAAkB,EAAKA,GAAGE,aAR2B,KAW1DC,QAAU,SAACC,EAAaC,QACZxW,IAAZ,EAAKmW,IAAkB,EAAKA,GAAGG,eACpBtW,IAAXwW,GAAsBA,EAAO,kCAAgBD,IAba,KAgB1DE,UAhB0D,uCAgB9C,WAAOC,GAAP,SAAAhY,EAAA,8DACAsB,IAAZ,EAAKmW,GADO,gCACiB,EAAKA,GAAGM,UAAUC,GADnC,2CAhB8C,sDAC9D/X,KAAKsX,QAAUA,EACftX,KAAKuX,SAAWA,EAChBvX,KAAKwX,GAAKA,EACVxX,KAAKyX,SAAmC,IAAzBtK,EAAOK,cAAwB,IAAO,IAV7D,wCA0BI,WACIxN,KAAKgY,KAAK,GAAI,MA3BtB,wDA8BI,WAAUJ,GAAV,uCAAA7X,EAAA,2DAAuBkY,EAAvB,oCAAqC5W,GAArC,uBAEY6W,EAAOC,OAAOD,KAAKD,IACd1Y,OAAS,GAH1B,iBAIgB+G,EAAI,IAJpB,cAK0B4R,GAL1B,4DAKqBE,EALrB,aAO0B/W,IADF4W,EAAOG,GAN/B,wDAQgBR,GAAOtR,EAAI8R,EAAI,IAAMH,EAAOG,GAC5B9R,EAAI,IATpB,sJAaQwN,EAAU9T,KAAKqY,gBACXC,OAAS,MAdrB,UAeiBtY,KAAKuY,WAAWX,EAAK9D,GAftC,yGA9BJ,gHAgDI,WAAW8D,EAAaK,GAAxB,eAAAlY,EAAA,6DACQ+T,EAAU9T,KAAKqY,gBACXC,OAAS,OACjBxE,EAAQ0E,KAAO1B,KAAK2B,UAAUR,GAHlC,SAIiBjY,KAAKuY,WAAWX,EAAK9D,GAJtC,wFAhDJ,iHAuDI,WAAU8D,EAAaK,GAAvB,eAAAlY,EAAA,6DACQ+T,EAAU9T,KAAKqY,gBACXC,OAAS,MACjBxE,EAAQ0E,KAAO1B,KAAK2B,UAAUR,GAHlC,SAIiBjY,KAAKuY,WAAWX,EAAK9D,GAJtC,wFAvDJ,oHA8DI,WAAa8D,EAAaK,GAA1B,eAAAlY,EAAA,6DACQ+T,EAAU9T,KAAKqY,gBACXC,OAAS,SACjBxE,EAAQ0E,KAAO1B,KAAK2B,UAAUR,GAHlC,SAIiBjY,KAAKuY,WAAWX,EAAK9D,GAJtC,wFA9DJ,uOAoEI,WAAY8D,EAAa9D,EAAc4E,EAA2Bb,GAAlE,QAIac,EAJb,iBAAA5Y,EAAA,6DAIa4Y,EAJb,SAIwBC,GAChB,MAAO,CACHC,QAASC,EACTlB,IAAKmB,EACLjF,QAASA,EACT4E,QAASA,EACTb,OAAQA,EACRE,MAAOa,IAVXE,EAAO9Y,KACXA,KAAK0X,YACDqB,EAAOnB,EAHf,SAeQoB,QAAQpM,IAAI,QAASkH,EAAQwE,OAAQS,GACjCE,EAAiBC,YAAW,kBAAMJ,EAAKnB,QAAQC,EAAKC,KAAS7X,KAAKyX,SAhB9E,SAiBwB0B,MAAMC,UAAUL,GAAOjF,GAjB/C,WAkBuB,KADXuF,EAjBZ,QAkBgBC,GAlBhB,uBAmBYC,aAAaN,GACbH,EAAKnB,UACLqB,QAAQpM,IAAI,gBAAiByM,EAAIG,YAC3BH,EAAIG,WAtBtB,cAwBYC,EAAKJ,EAAIK,QAAQC,IAAI,kBACfF,EAAGG,QAAQ,SAAS,GAzBtC,0CA0BmBP,EAAIQ,OAAOpP,KAAX,uCAAgB,WAAMqP,GAAN,SAAA/Z,EAAA,yDACnBwZ,aAAaN,GACbH,EAAKnB,WACc,IAAfmC,EAAQR,GAHO,yCAIRZ,EAAQoB,EAAQT,MAJR,eAMGhY,IAAlByY,EAAQ/B,MANO,gCAOTe,EAAKhB,UAAUa,EAAW,yBAPjB,+CAUTG,EAAKhB,UAAUa,EAAWmB,EAAQ/B,QAVzB,QAWfF,EAAOiC,EAAQ/B,OAXA,4CAAhB,uDAcJgC,MAdI,uCAcE,WAAMhC,GAAN,SAAAhY,EAAA,sEACC+Y,EAAKhB,UAAUa,EAAWZ,EAAMiC,UADjC,2CAdF,wDA1BnB,yBA6C6BX,EAAIY,OA7CjC,QA6CgBA,EA7ChB,OA8CYV,aAAaN,GACbH,EAAKnB,UACLe,EAAQuB,GAhDpB,6DAoD6B,kBAAV,EAAP,GApDZ,qBAqDmE,IAAnD,KAAMC,cAAcC,WAAW,gBArD/C,wBAsDgB5V,MAAI6V,SAtDpB,4CA0Dcpa,KAAK8X,UAAUa,EAAW,KAAMqB,UA1D9C,kEApEJ,6HAkII,WAAyBpC,EAAa9D,GAAtC,qFACQuG,EAAIra,KAAKsX,QAAUM,EAD3B,SAEiB,IAAIpV,QAAJ,uCAAiB,WAAOkW,EAASb,GAAhB,SAAA9X,EAAA,sEACpB,EAAKoZ,MAAMkB,EAAGvG,EAAS4E,EAASb,GADZ,2CAAjB,yDAFjB,wFAlIJ,uHAyII,WAAgBD,EAAYU,EAAeE,GAA3C,sBAAAzY,EAAA,6DACQ+T,EAAU9T,KAAKqY,gBACXC,OAASA,EACjBxE,EAAQ0E,KAAOA,EAHnB,SAIiB,IAAIhW,QAAJ,uCAAiB,WAAOkW,EAASb,GAAhB,SAAA9X,EAAA,sEACpB,EAAKoZ,MAAMvB,EAAK9D,EAAS4E,EAASb,GADd,2CAAjB,yDAJjB,wFAzIJ,qFAkJI,WAA6B,IACpByC,EAAqB/V,MAArB+V,SAAUC,EAAWhW,MAAXgW,QACXb,EAAU,IAAIc,QAElBd,EAAQe,OAAO,eAAgB,kCAC/B,IAAIC,EAAOJ,EAUX,OATIC,IAASG,GAAQ,IAAMH,GAC3Bb,EAAQe,OAAO,kBAAmBC,GAC9B1a,KAAKuX,UACLmC,EAAQe,OAAO,gBAAiBza,KAAKuX,UAE3B,CACVmC,QAASA,OA9JrB,KCTaiB,EAAb,yFACI,WACIpW,MAAImT,cAFZ,qBAII,WACInT,MAAIoT,YALZ,8DAOI,WAAgBI,GAAhB,SAAAhY,EAAA,6DACIwE,MAAIoT,UADR,SASUpT,MAAIqW,QAAQ7C,GATtB,2CAPJ,8DCDO,I,2BCFH8C,GAA8C,GAC9CC,GAAgD,GAE9CC,G,kDAIJ,WAAYnD,EAAaoD,EAAkBC,EAAiBC,EAAiBC,GAAwB,IAAD,8BAClG,cAAMH,EAAUG,IAJVF,aAG4F,IAFpGrD,SAEoG,EAElG,EAAKuD,YAAcA,EACnB,EAAKF,QAAUA,EACf,EAAKG,MAAQF,EACb,EAAKtD,IAAMA,EALuF,E,yFAQpG,4FAG2B,IAArB5X,KAAKmb,kBAA6C9Z,IAArBrB,KAAKmb,aACpCE,EAAWR,GACXS,EAAY,IAAIX,GAGhBU,EAAWP,QAGGzZ,KADZwX,EAAUwC,EAASrb,KAAKib,UAV9B,yCAWoCpC,GAXpC,cAYEA,EAAU,IAAIxB,EAAYrX,KAAK4X,IAAK5X,KAAKob,MAAOE,GAZlD,kBAaSD,EAASrb,KAAKib,SAAWpC,GAblC,gD,2DDbF,WAKI,WAAYE,EAAcoC,GAAuB,yBAJvCC,WAIsC,OAHtCrC,UAGsC,OAFtCoC,iBAEsC,EAC5Cnb,KAAK+Y,KAAOA,GAAQ,GACpB/Y,KAAKmb,YAAcA,EAP3B,+EAYI,WAAkBvD,EAAYU,EAAeE,GAA7C,uFACwBxY,KAAKub,iBAD7B,cACQ1C,EADR,gBAEiBA,EAAQ2C,UAAU5D,EAAKU,EAAQE,GAFhD,wFAZJ,mHAiBI,WAAiBO,GAAjB,4FAA8Bd,EAA9B,oCAAyC5W,EAAzC,SACwBrB,KAAKub,iBAD7B,cACQ1C,EADR,gBAEiBA,EAAQc,IAAI3Z,KAAK+Y,KAAOA,EAAMd,GAF/C,wFAjBJ,gHAsBI,WAAkBc,EAAad,GAA/B,uFACwBjY,KAAKub,iBAD7B,cACQ1C,EADR,gBAEiBA,EAAQb,KAAKhY,KAAK+Y,KAAOA,EAAMd,GAFhD,wFAtBJ,iHA2BI,WAAiBc,EAAad,GAA9B,uFACwBjY,KAAKub,iBAD7B,cACQ1C,EADR,gBAEiBA,EAAQ4C,IAAIzb,KAAK+Y,KAAOA,EAAMd,GAF/C,wFA3BJ,oHAgCI,WAAoBc,EAAad,GAAjC,uFACwBjY,KAAKub,iBAD7B,cACQ1C,EADR,gBAEiBA,EAAQ6C,OAAO1b,KAAK+Y,KAAOA,EAAMd,GAFlD,wFAhCJ,iEC8Ba0D,GAAb,WAGE,WAAY/D,EAAaoD,EAAkBC,EAAiBC,EAAiBC,GAAwB,yBAF7FtC,aAE4F,EAClG7Y,KAAK6Y,QAAU,IAAIkC,GAAanD,EAAKoD,EAAUC,EAASC,EAASC,GAJrE,+EAOE,WAAWvc,EAAcqZ,GAAzB,eAAAlY,EAAA,6DACM6b,EAAQ,CAAEzX,KAAMvF,EAAMqZ,OAAQA,GADpC,SAEejY,KAAK6Y,QAAQb,KAAK,WAAY4D,GAF7C,wFAPF,mHAYE,WAAYhd,EAAcqZ,GAA1B,eAAAlY,EAAA,6DACM6b,EAAQ,CAAEzX,KAAMvF,EAAMqZ,OAAQA,GADpC,SAEejY,KAAK6Y,QAAQb,KAAK,WAAY4D,GAF7C,wFAZF,kHAiBE,WAAWhd,EAAcqZ,EAAexB,EAAmBC,GAA3D,iBAAA3W,EAAA,kEAEiBkY,EAFjB,OAGS,cAHT,6BAGsBzH,EAAI,GAH1B,kCAIaA,EAAIqL,IAAEC,MAAM7D,GAJzB,kCAMEzH,EAAElN,KAAKmT,GACPjG,EAAElN,KAAKoT,GACHkF,EAAQ,CAAEzX,KAAMvF,EAAMqZ,OAAQzH,GARpC,UASexQ,KAAK6Y,QAAQb,KAAK,WAAY4D,GAT7C,0FAjBF,yHA6BE,WAAcG,EAAW9D,GAAzB,eAAAlY,EAAA,6DACM6b,EAAQ,CAAEG,KAAMA,EAAM9D,OAAQA,GADpC,SAEejY,KAAK6Y,QAAQb,KAAK,YAAa4D,GAF9C,wFA7BF,gE,qBCjCaI,GAAQ,WACjB,IAAIC,EAAoBC,KAAS,CAC7BC,OAAQ,kBAAM,+BACd9Z,QAAS+Z,YAEb,OAAO,cAACH,EAAD,KCJLI,GAAQ,SAACC,GAAD,OAAoC,IAAbA,EAAoB,eAAiB,cAE7DxL,GAAb,4MAIElR,OAAS,SAACE,GAA8B,IAAD,EACX,EAAK3B,WAAzBoe,EAD+B,EAC/BA,MAAOC,EADwB,EACxBA,SACTC,EAAkB,CACpB,CAAE7d,KAAM,OAAQ6B,MAAO,eAAMic,KAAM,OAAQC,QAASJ,EAAMlG,IAAKuG,YAAQvb,EAAWoU,KAAK,WAAD,4BAAE,sBAAA1V,EAAA,sEAAoBwc,EAAM9G,OAA1B,2CAAF,kDAAC,GAAqCoH,QAAQ,WAAD,4BAAE,sBAAA9c,EAAA,sEAAoBwc,EAAM9G,OAA1B,2CAAF,kDAAC,IACpI,CAAE7W,KAAM,WAAY6B,MAAO,eAAMic,KAAM,SAAUC,QAASH,EAASnG,IAAKZ,KAAK,WAAD,4BAAE,sBAAA1V,EAAA,sEAAoByc,EAAS/G,OAA7B,2CAAF,kDAAC,IAC7E,CAAE7W,KAAM,KAAM6B,MAAO,eAAMic,KAAM,OAAQC,QAASX,GAAOa,aAASxb,IAClEuP,KAAI,SAAA7M,GAAM,IACJnF,EAAsDmF,EAAtDnF,KAAM6B,EAAgDsD,EAAhDtD,MAAOic,EAAyC3Y,EAAzC2Y,KACnB,MAAO,CACL9d,KAAMA,EACN4P,QAAS,SAAC8N,GAAD,OAAuBQ,8BAAoBrc,EAAOic,EAAML,GAAMC,KACvEK,QAJ0D5Y,EAAnC4Y,QAKvBC,OAL0D7Y,EAA1B6Y,OAMhCnH,KAN0D1R,EAAlB0R,KAOxCoH,QAP0D9Y,EAAZ8Y,YAUlD,OAAO,cAAC,OAAD,CAAMpd,QAAQ,EAAOsd,UAAW,CAACN,WArB5C,iFACE,WAAW3c,GAAX,SAAAC,EAAA,sDACEC,KAAKC,SAASD,KAAKJ,QADrB,gDADF,4DAA2BM,SCAdwN,GAAb,4JACI,WAC8B,KAA1B,IAIIhP,EAAO,qBAAKC,UAAU,MAAMgP,IAAKC,EAAMC,IAAI,OAAOC,MAAO,CAACC,OAAQ,OAAQC,MAAO,UAQrF,OAAO,cAAC,MAAD,CACHrP,UAAU,mCACVD,KAAMA,EAAMG,MARJwC,UAML,SAGH,qBAAK1C,UAAU,GAAf,SACKqB,KAAK7B,WAAW+X,2BAlBjC,GAAiChI,QCGpB8O,GAAb,mNAgCUC,kBAAoB,WAAO,IAAD,EACL,EAAK9e,WAA3B+e,EAD2B,EAC3BA,KACDpd,EAA6B,CAC/ByC,SAAIlB,EACJ8b,SAJ8B,EACrBC,aAITC,MAAMH,EAAKG,MACXC,MAAMJ,EAAKI,MACXC,OAAOL,EAAKK,OACZC,IAAIN,EAAKM,KAEX,EAAKrf,WAAWkB,KAAKoe,eAAe3d,IA1CxC,EA4EEkR,UAAY,SAAChT,EAAWiT,GAAZ,OAA2C,cAAC,EAAKC,WAAN,eAAqBlT,KA5E9E,EA6EYkT,WAAahS,oBAAS,SAAC2Q,GAG/B,GAFgB,EAAK1R,WAAWkB,KAAKqe,UACZ1Z,WAAU,SAAAD,GAAC,OAAEA,IAAIpD,MAC1B,EAAG,OAAO,KAH+B,MAKpCkP,EAAflP,EALmD,EAKnDA,GAAI2E,EAL+C,EAK/CA,OACNqY,EAAU,QAAUhd,EAEvBid,EADU,EAAKzf,WAAWkB,KAAKwe,YACd7Z,WAAU,SAAAD,GAAC,OAAEA,IAAIpD,KAClC9B,EAAQ,sBAAKF,UAAU,SAAf,UACX,wBAAOA,UAAU,OAAjB,UACC,uBAAOA,UAAU,OAAOyB,KAAK,WAAW4O,MAAM,GAAGrO,GAAIgd,EACrDhP,eAAgBiP,GAAU,EAC1BvJ,SAAU,SAAA9V,GAAC,OAAI,EAAKR,SAAS8R,EAAKtR,EAAE6S,OAAO1C,YAC3C,uBAAO/P,UAAU,aAAjB,6BAED,mBAAGA,UAAU,iBACZwS,KAAI,wDAAmD7L,EAAnD,aACJ8L,OAAO,SACPC,IAAI,sBAAsBrS,QAAS,SAACT,GAAKA,EAAE+S,mBAH5C,yCAKD,OAAO1B,EAAmBC,EAAK,EAAKC,YAAajR,MAlGlD,EAqGU0S,OAAS,SAACvT,GAChB,YAAkBqD,IAAdrD,EAAKA,KACAA,EAAKA,KAAK2C,GAEN3C,EAAP2C,IAzGV,EA6GUoQ,YAAc,SAAC3Q,GACrB,EAAKjC,WAAW4S,YAAY3Q,IA9GhC,EAiHY0P,YAAc,SAAC9R,GACvB,EAAKG,WAAWqT,cAAcxT,IAlHlC,EAqHYD,SArHZ,uCAqHuB,WAAOC,EAAWC,GAAlB,SAAA8B,EAAA,sDACnB,EAAK5B,WAAW2f,aAAa9f,EAAMC,GADhB,2CArHvB,0DAyHY8f,YAzHZ,uCAyH0B,WAAO/f,GAAP,SAAA+B,EAAA,sDACtB,EAAK5B,WAAWqT,cAAcxT,GADR,2CAzH1B,kGAqBE,WAAU,MAAO,6BArBnB,gCAsBE,SAA6B6T,GAC9B7R,KAAK7B,WAAW2T,WAvBjB,mBA2BE,WAAS,IACDkM,EAAahe,KAAK7B,WAAlB6f,SACT,OAAO,qBAAKrf,UAAU,wCAAwCK,QAASgf,EAAhE,SAA0E,cAAC,KAAD,CAAIpf,KAAK,MAAM0P,KAAK,KAAK8D,SAAS,QA7BpH,qBA6CE,WAAW,IAAD,OACPL,EAAI7S,oBAAS,WAAO,IAEnB+e,EAFkB,EACM,EAAK9f,WAA5BwB,EADiB,EACjBA,MAAOud,EADU,EACVA,KAAMgB,EADI,EACJA,OAEdrf,EAAQ,8BACZ,qBAAKF,UAAU,0BAA0BK,QAASkf,EAAlD,4BAEA,QAAmB7c,IAAf6b,EAAKG,YAAsChc,IAAf6b,EAAKI,YAAuCjc,IAAhB6b,EAAKK,OAAsB,CACvF,IAAIY,EAAS,YAAcnY,IAAMoY,kBAAkBlB,EAAKG,OACrD,gBAAkBrX,IAAMoY,kBAAkBlB,EAAKI,OAC/C,iBAAmBtX,IAAMoY,kBAAkBlB,EAAKK,QAChD,cAAgBvX,IAAMoY,kBAAkBlB,EAAKM,KAC7C,4CACHS,EAAU,cAAC,MAAD,CAAKpf,MAAOA,EAAZ,SAAmB,sBAAKF,UAAU,sBAAsBK,QAAS,EAAKie,kBAAnD,UAAuEjX,IAAMwI,QAAQ,wCAAW2P,YAG7HF,EAAU,cAAC,MAAD,CAAKpf,MAAOA,IAGtB,OAAO,qCACNof,EACD,cAAC,OAAD,CAAMxe,OAAQmP,EAAkB,EAAKmC,aACpCpR,MAAOA,EACP3B,KAAM,CAAE4B,OAAQ,EAAKoR,UAAW3C,IAAK,EAAKkD,QAC1Cc,OAAQ,uBAIV,OAAO,cAACN,EAAD,QAzER,GAA+B7R,SCJzBC,GAAuB,CAC3B,CAAEvB,KAAM,QAASwB,KAAM,SAAUC,UAAU,GAC3C,CAAEzB,KAAM,OAAQwB,KAAM,SAAUC,UAAU,GAC1C,CAAEzB,KAAM,OAAQwB,KAAM,SAAUC,UAAU,GAC1C,CAAEzB,KAAM,KAAMwB,KAAM,SAAUC,UAAU,GACxC,CAAEzB,KAAM,OAAQwB,KAAM,SAAUC,UAAU,GAC1C,CAAEzB,KAAM,OAAQwB,KAAM,SAAUC,UAAU,GAC1C,CAAEzB,KAAM,MAAOwB,KAAM,SAAUC,UAAU,GACzC,CAAEzB,KAAM,SAAUwB,KAAM,UAAWC,UAAU,GAC7C,CAAEzB,KAAM,MAAOwB,KAAM,SAAUC,UAAU,GACzC,CAAEzB,KAAM,OAAQwB,KAAM,SAAUC,UAAU,GAC1C,CAAEzB,KAAM,SAAUwB,KAAM,WAGpBG,GAAqB,CACzBZ,MAAO,CACL0e,MAAO,CAAE7d,OAAQ,SAAUC,MAAO,uCAAUC,YAAa,QACzD4d,KAAM,CAAE9d,OAAQ,SAAUC,MAAO,6CAAWC,YAAa,QACzD6d,KAAM,CAAE/d,OAAQ,SAAUC,MAAO,6CAAWC,YAAa,QACzDkH,GAAI,CAAEpH,OAAQ,SAAUC,MAAO,6BAAUC,YAAa,QACtD8d,KAAM,CAAEhe,OAAQ,SAAUC,MAAO,6CAAWC,YAAa,QACzD+d,KAAM,CAAEje,OAAQ,SAAUC,MAAO,6CAAWC,YAAa,QACzDuH,IAAK,CAAEzH,OAAQ,SAAUC,MAAO,6BAAUC,YAAa,QACvDge,IAAK,CAAEle,OAAQ,SAAUC,MAAO,sEAAgBC,YAAa,QAC7Die,OAAQ,CAAEne,OAAQ,SAAUC,MAAO,wFAAmBC,YAAa,QACnEke,KAAM,CAAEpe,OAAQ,SAAUC,MAAO,6BAAUC,YAAa,QACxDG,OAAQ,CAAEL,OAAQ,SAAUC,MAAO,eAAM9B,UAAW,qBAK3CkgB,GAAb,4MAKEC,UAAY,SAACvgB,GACX,IAAIwgB,EAAUxgB,EAAE6S,OAAOpC,MAEvB,EAAK7Q,WAAWkB,KAAK2f,iBAAiBD,IAR1C,EAWEE,aAAe,SAAC1gB,GACd,IAAIwgB,EAAUxgB,EAAE6S,OAAOpC,MAEvB,EAAK7Q,WAAWkB,KAAK6f,mBAAmBH,IAd5C,EAiBE1K,SAAW,SAAC9V,GAAO,IAAD,EACIA,EAAE6S,OADN,EACXxS,KADW,EACLoQ,OAlBf,EAqBUjO,kBArBV,uCAqB8B,WAAOnC,EAAcoC,GAArB,qCAAAjB,EAAA,+DAEwCiB,EAAQE,KAArEod,EAFqB,EAErBA,KAAMC,EAFe,EAEfA,KAAM3W,EAFS,EAETA,GAAI4W,EAFK,EAELA,KAAMC,EAFD,EAECA,KAAMxW,EAFP,EAEOA,IAAK0W,EAFZ,EAEYA,OAAQD,EAFpB,EAEoBA,IAAKE,EAFzB,EAEyBA,KAAMP,EAF/B,EAE+BA,MACrDc,EAAM,CAACb,KAAKA,EAAMC,KAAKA,EAAM3W,GAAGA,EAAI4W,KAAKA,EAAMC,KAAKA,EAAMxW,IAAIA,EAAK0W,OAAOA,EAAQD,IAAIA,EAAKE,KAAKA,EAAMP,MAAMA,GAHtF,SAIpB,EAAKlgB,WAAWkB,KAAK+f,oBAAoBD,GAJrB,OAK1B,EAAKhhB,WAAWgD,YALU,2CArB9B,0DA8BUlC,KAAOC,oBAAS,WACX,EAAKf,WAAWkB,KAAKggB,eAAhC,IAMI5d,EAAQ,EAAKtD,WAAWkB,KAAK4S,OAAOqN,WAIxC,YAHoBje,IAAhBI,EAAM4c,QACR5c,EAAM4c,MAAQ,KAET,eAAC,OAAD,CAAM5e,OAAO,2BAAOC,gBAAgB,aAApC,UAQL,qBAAKf,UAAU,YAAf,sCACA,cAAC,OAAD,CAAMwB,OAAQA,GACVI,SAAUA,GACVa,SAAUK,EACVH,cAAe,EAAKP,0BArD9B,iFACE,WAAWjB,GAAX,SAAAC,EAAA,sDACEC,KAAKC,SAASD,KAAKf,MADrB,gDADF,4DAAkCiB,SCzBrBqf,IAAb,qNACE5f,MAA+BoC,aAAWC,MAAW,GAAI,CAAEC,MAAM,IADnE,yCAGEmb,kBAHF,IAIYoC,mBAJZ,IAKE3f,cAAuB,GALzB,EAOEoV,eAAiBC,kBAAO,sBAAC,4BAAAnV,EAAA,0DACnB0f,EAAgB,EAAKpgB,KAAK4S,OAAOyN,UAAUC,cACzB,EAAKH,cAFJ,yDAIIne,IAAvB,EAAKme,cAJc,uBAKrB,EAAKA,cAAgBC,EALA,iCAQvB,EAAKD,cAAgBC,EARE,SASjB,EAAKhK,OATY,4CAP3B,EAmBE3D,OAnBF,sBAmBW,sBAAA/R,EAAA,0FAnBX,EAuBEie,SAvBF,sBAuBa,sBAAAje,EAAA,sDACT,EAAKmE,UAAU2a,IADN,2CAvBb,EA8BEX,OA9BF,sBA8BW,sBAAAne,EAAA,sEACD,EAAK0V,OADJ,2CA9BX,EAgGEqI,aAhGF,uCAgGiB,WAAO9f,EAAUC,GAAjB,eAAA8B,EAAA,yDACT+E,EAAQ,EAAKzF,KAAK0F,kBACH,IAAf9G,EAFS,gCAGL,EAAKoB,KAAKqD,MAAMyB,KAAK,iBAAkB,CAAC,EAAKvB,KAAKjC,GAAImE,EAAO9G,EAAK2C,KAH7D,uBAIL,EAAKtB,KAAKqF,cAAcI,EAAO9G,EAAK2C,IAJ/B,+CAOL,EAAKtB,KAAKqD,MAAMyB,KAAK,iBAAkB,CAAC,EAAKvB,KAAKjC,GAAImE,EAAO9G,EAAK2C,KAP7D,yBAQL,EAAKtB,KAAKuF,iBAAiBE,EAAO9G,EAAK2C,IARlC,4CAhGjB,0DA4GEoQ,YAAc,SAAC3Q,GACb,EAAKf,KAAKwW,gBAAgBzV,GAC1B,IAAI0V,EAAM,EAAKnW,MAAMoW,QACrB,EAAK1W,KAAK2W,WAAWF,GAErB,EAAKnW,MAAMsW,QAAQH,IAjHvB,EAoHEI,iBAAmB,WACjB,OAAO,EAAKC,WAAWzI,KArH3B,EAwHE0I,WAAa,WACX,OAAO,EAAKD,WAAW6G,KAzH3B,EA6HEpZ,aAAe,aA7HjB,EAgIEyS,IAAM,kBAAM,cAAC,EAAKD,WAAN,KAhId,EAkIE5E,cAAgB,SAACxT,GACE,EAAKsY,KAAK5U,cAChBwI,MAAMlM,IApIrB,0FA2BE,WAAoB8B,GAApB,SAAAC,EAAA,0FA3BF,gHAkCE,sBAAAA,EAAA,6DACEC,KAAKH,cAAgB,GADvB,SAEQG,KAAKwW,YAFb,gDAlCF,oHAuCE,sEAAAzW,EAAA,6DACM6f,EAAY,MADlB,EAGoE5f,KAAKX,KAAK4S,OAAOqN,WAA9EhB,EAHP,EAGOA,KAAMC,EAHb,EAGaA,KAAM3W,EAHnB,EAGmBA,GAAI4W,EAHvB,EAGuBA,KAAMC,EAH7B,EAG6BA,KAAMxW,EAHnC,EAGmCA,IAAK0W,EAHxC,EAGwCA,OAAQD,EAHhD,EAGgDA,IAAKE,EAHrD,EAGqDA,KAHrD,EAG2DP,MAGrD1b,EAAQ,CACV/D,KAAMghB,EACNnJ,UAAW,EACXC,SAAU,IACV9T,KAAM5C,KAAK4C,KAAKjC,GAChBkf,QAAQ7f,KAAKX,KAAKygB,eAClBC,KAAMzB,EACN0B,KAAMzB,EACN3W,GAAIA,EACJqY,KAAMzB,EACN0B,KAAMzB,EACNxW,IAAKA,EACL0W,OAAQA,EACRD,IAAKA,EACLE,KAAMA,GApBV,SAsBmBpc,QAAQC,IAAI,CAACzC,KAAKX,KAAKqD,MAAM+K,QAAQ9K,EAAO,IAC/B3C,KAAKX,KAAKqD,MAAMyB,KAAK,oBAAqB,MAvB1E,UAsBMtB,EAtBN,OAyBMsd,EAAatd,EAAK,GAClBG,MAAMC,QAAQkd,IAAeA,EAAW5gB,OAAS,EACnDS,KAAKod,aAAe+C,EAAW,GAAG5d,IAGlCvC,KAAKod,kBAAe/b,EAElBuV,EAAS/T,EAAK,IACY,IAA1BG,MAAMC,QAAQ2T,GAjCpB,mDAoCMd,EAAMc,EApCZ,cAqCmBd,GArCnB,IAqCE,2BAAS9X,EAAa,QAChB6Y,EAAYC,KAAKC,MAAM/Y,EAAKkD,MAChClD,EAAK0S,QAAUmG,EACXG,EAAK,IAAItP,IAAcmP,GAE3B7Y,EAAKoS,IAAM4G,EAAGlP,QAAQ,GAAK9J,EAAKO,GAAK,EACrCP,EAAK+F,EAAIiC,IAAMiR,YAAYD,EAAGhP,OAAQhK,EAAKoS,GAAIpS,EAAKiS,SAAWjS,EAAKmF,MAAOnF,EAAKkZ,SAChFlZ,EAAKqS,GAAK2G,EAAGlP,QAAQ,GA5CzB,8BA8CoB,QAAd8X,GACF5f,KAAKX,KAAK2W,WAAWF,GACrB9V,KAAKkd,KAAOlX,IAAMoa,kBAAkBtK,IAGpC9V,KAAKkd,KAAO,GAEdld,KAAKL,MAAMyD,SACX,EAAApD,KAAKL,OAAM2D,KAAX,oBAAmBwS,IAtDrB,iDAvCF,2DAA+BrM,GAA/B,kCAEG1H,cAFH,wEAEmF,MAFnF,GCLase,GAAb,4MAKUtiB,SAAW,SAACC,EAAWC,EAAqBC,KALtD,EASUe,KAAOC,aAAS,WAAO,IACvBkY,EAAa,EAAKjZ,WAAlBiZ,SACF9X,EAAY8X,EAAS7X,QAAU,IAAM,GACvC,sBAAKZ,UAAU,2BAA2BK,QAAS,EAAKb,WAAWmiB,aAAnE,UAAiF,cAAC,KAAD,CAAI1hB,KAAK,OAAOD,UAAU,iBAA3G,oCACF,OAAO,eAAC,OAAD,CAAMc,OAAO,eAAKC,gBAAgB,aAAlC,UACJJ,EACD,cAAC,OAAD,CAAMK,MAAOyX,EACXpZ,KAAM,CAAE4B,OAAQ,EAAK2gB,eACrBjO,KAAM,aAjBd,EAqBUiO,cAAgB,SAACC,GAAgB,IAClC5hB,EAA2B4hB,EAA3B5hB,KAAMyG,EAAqBmb,EAArBnb,KAAMjF,EAAeogB,EAAfpgB,KAAM+C,EAASqd,EAATrd,MACnBzE,EAAO,sBAAKC,UAAU,sBAAf,UACRC,EACD,uBAAOD,UAAU,QAAjB,SAA2B0G,OAC7B,OAAO,cAAC,MAAD,CAAK1G,UAAU,YAAYD,KAAMA,EAAjC,SACL,sBAAKC,UAAU,mBAAf,UACE,qBAAKA,UAAU,UAAf,SAA0BqH,IAAMya,kBAAkBrgB,KAClD,qBAAKzB,UAAU,UAAf,SAA0BqH,IAAMoY,kBAAkBjb,WA7B1D,iFACE,WAAWrD,GAAX,SAAAC,EAAA,sDACEC,KAAKC,SAASD,KAAKf,MADrB,gDADF,4DAAoCiB,SAmC9BC,GAAuB,CAC3B,CAAEvB,KAAM,KAAMwB,KAAM,MACpB,CAAExB,KAAM,OAAQwB,KAAM,SAAUC,UAAU,EAAMC,UAAW,GAC3D,CAAE1B,KAAM,QAASwB,KAAM,SAAUC,UAAU,GAC3C,CAAEzB,KAAM,SAAUwB,KAAM,WAGpBG,GAAqB,CACzBZ,MAAO,CACLgB,GAAI,CAAEH,OAAQ,KACZC,MAAO,eACPG,SAAS,GACXR,KAAM,CAAEI,OAAQ,SAAUC,MAAO,eACjC+E,KAAM,CAAC,CAACwJ,MAAM,KAAMgD,MAAM,gBAAO,CAAChD,MAAM,KAAMgD,MAAM,kBACpD7O,MAAO,CAAE3C,OAAQ,OAAQC,MAAO,eAAMC,YAAa,QACnDG,OAAQ,CAAEL,OAAQ,SAAUC,MAAO,eAAM9B,UAAW,qBAI3C+hB,GAAb,4MAKUC,YAAwB,CAC9BhhB,MAAO,CACLgB,GAAI,CAAEH,OAAQ,KACZC,MAAO,eACPG,SAAS,EACTF,YAAa,uBAAO/B,UAAU,aAAjB,4CACbiiB,OAAO,WAAD,4BAAE,WAAO5f,EAAkBpC,EAAcoQ,GAAvC,SAAAjP,EAAA,sEACO,EAAK5B,WAAW6G,gBAAgBhE,EAASpC,EAAMoQ,GADtD,mFAAF,uDAAC,GAGP6R,QAAS,SAAC7iB,GAAe,IACjBY,EAAeZ,EAAfY,KAAMyG,EAASrH,EAATqH,KACZ,OAAKrH,EACE,gCACFY,EACD,uBAAOD,UAAU,QAAjB,SAA2B0G,OAHb,uBAAO1G,UAAU,aAAjB,8CAOtByB,KAAM,CAAEI,OAAQ,SAAUC,MAAO,eACjC+E,KAAM,CAAC,CAACwJ,MAAM,KAAMgD,MAAM,gBAAO,CAAChD,MAAM,KAAMgD,MAAM,kBACpD7O,MAAO,CAAE3C,OAAQ,OAAQC,MAAO,eAAMC,YAAa,QACnDG,OAAQ,CAAEL,OAAQ,SAAUC,MAAO,eAAM9B,UAAW,qBA1B1D,EA8BUoC,kBA9BV,uCA8B8B,WAAOnC,EAAcoC,GAArB,SAAAjB,EAAA,sEACpB,EAAK5B,WAAW2iB,iBAAiB9f,EAAQE,MADrB,2CA9B9B,0DAkCUjC,KAAO,WAEb,OAAO,cAAC,OAAD,CAAMQ,OAAO,2BAAOC,gBAAgB,aAApC,SACL,qBAAKf,UAAU,YAAf,SACE,cAAC,OAAD,CAAMwB,OAAQA,GACZI,SAAU,EAAKogB,YACfvf,SALM,CAAChB,KAAK,MAMZkB,cAAe,EAAKP,yBAzC9B,iFACE,WAAWjB,GAAX,SAAAC,EAAA,sDACEC,KAAKC,SAASD,KAAKf,MADrB,gDADF,4DAAiCiB,SCtDpB6gB,IDsGqB7gB,QCtGlC,2PAcEogB,aAAe,WACb,EAAKpc,UAAUwc,KAfnB,EAkBE/K,eAlBF,sBAkBmB,sBAAA5V,EAAA,sEACT,EAAKihB,eADI,OAEf,EAAK9c,UAAUmc,IAFA,2CAlBnB,EAuBES,iBAvBF,uCAuBqB,WAAO5f,GAAP,mBAAAnB,EAAA,6DACXY,EAAoBO,EAApBP,GAAIP,EAAgBc,EAAhBd,KAAM+C,EAAUjC,EAAViC,MADC,SASX,EAAK9D,KAAKqD,MAAMyB,KAAK,qBAAsB,CAAC,EAAK9E,KAAKuD,KAAKjC,GAAIA,EAAGA,GAAIP,EAAM+C,IATjE,OAUjB,EAAKhC,YAVY,2CAvBrB,wDAoCE8f,cApCF,uCAoCkB,WAAO/f,GAAP,SAAAnB,EAAA,0FApClB,wDAwCEiF,gBAxCF,uCAwCoB,WAAOhE,EAAkBpC,EAAcoQ,GAAvC,eAAAjP,EAAA,6DACZkF,EAAS,IAAIC,IAAO,EAAK7F,MADb,SAEH4F,EAAOd,OAFJ,mFAxCpB,kGACE,WAAqB,OAAOnE,KAAKkhB,QADnC,kEAIE,WAAoBphB,GAApB,SAAAC,EAAA,sDACU,EADV,2CAJF,wHAQE,8BAAAA,EAAA,sEACgBC,KAAKX,KAAKqD,MAAMyB,KAAK,qBAAsB,CAACnE,KAAK4C,KAAKjC,KADtE,OACM4L,EADN,OAEMxJ,EAAMwJ,EACVvM,KAAKoX,SAAWrU,EAHlB,gDARF,2DAA8B0G,GAA9B,uCAEG1H,cAFH,wEAE+B,MAF/B,GCAaof,GAAb,mNASUliB,KAAOC,oBAAS,WACtB,OAAO,cAAC,OAAD,CAAMO,OAAO,yDAAb,SACL,cAAC,EAAKsT,YAAN,SAXN,EAeUA,YAAc7T,oBAAS,WAC7B,OAAO,mCACP,cAAC,EAAK8T,aAAN,SAjBJ,EAqBYA,aAAe9T,oBAAS,WAAO,IAClCS,EAAS,EAAKxB,WAAdwB,MACL,QAAc0B,IAAV1B,EACF,OAAO,6BACT,IAJsC,EAIlCsT,EAAe,WACfC,EAAkB,GAClBkO,EAAqB,GACrBC,EAAqB,GACrBC,EAAsB,GARY,cASrB3hB,GATqB,IAStC,2BAAwB,CAAC,IAAhB3B,EAAe,QACjBuE,EAA6BvE,EAA7BuE,IAAK8a,EAAwBrf,EAAxBqf,MAAOC,EAAiBtf,EAAjBsf,MAAOC,EAAUvf,EAAVuf,OACxBrK,EAAU5P,KAAKf,GACf6e,EAAU9d,KAAK+Z,GACfgE,EAAU/d,KAAKga,GACfgE,EAAWhe,KAAKia,IAdoB,8BAgBtC,IAAIjK,EAAa,CACfC,OAAQL,EACRM,SAAU,CACR,CACE/S,MAAO,QACPS,KAAMkgB,EACN3N,YAAY,OACZC,gBAAgB,UAChBC,YAAa,EACbC,MAAM,EACNC,QAAS,YAEX,CACEpT,MAAO,QACPS,KAAMmgB,EACN5N,YAAY,MACZC,gBAAgB,OAChBC,YAAa,EACbC,MAAM,EACNC,QAAS,YAEX,CACEpT,MAAO,SACPS,KAAMogB,EACN7N,YAAY,YACZC,gBAAgB,QAChBC,YAAa,EACbC,MAAM,EACNC,QAAS,cAgBf,OADAZ,EAAe,cAAC,IAAD,CAAK/R,KAAMoS,EAAYlT,KAAK,OAAO0T,QAXpC,CACZC,OAAO,CACLC,MAAO,CAAC,CACJ5T,KAAM,SACN6T,SAAS,EACTC,SAAU,QACVvT,GAAI,iBAML,qCAAE,cAAC,MAAD,CAAKhC,UAAU,qBAAqBD,KAAM,6BACjD,qBAAKC,UAAU,OAAOmP,MAAO,CAACE,MAAM,OAApC,SAA6CiF,UAlFnD,iFACE,WAAWnT,GAAX,SAAAC,EAAA,sDACEC,KAAKC,SAASD,KAAKf,MADrB,gDADF,2EAKE,SAAOa,GACL,OAAO,mBAAMb,KAAN,QANX,GAAqCiB,SCexBqhB,GAAb,4MACE5hB,MAAuCoC,aAAWC,MAAmB,GAAI,CAAEC,MAAM,IADnF,EAEEM,SAFF,IAGYuD,cAHZ,4FAKE,WAAoBhG,GAApB,eAAAC,EAAA,kEAEYsB,KADNmP,EAAI1Q,IAENE,KAAKuC,IAAMiO,EAAEjO,SACMlB,IAAfmP,EAAE2M,SACJnd,KAAK8F,SAAW,CAACvD,IAAIiO,EAAE2M,SAAUE,MAAM7M,EAAE6M,MAAOC,MAAM9M,EAAE8M,MAAOC,OAAO/M,EAAE+M,QAGxEvd,KAAK8F,cAAWzE,IAIlBrB,KAAKuC,SAAMlB,EACXrB,KAAK8F,cAAWzE,GAbpB,SAeQrB,KAAKyV,OAfb,OAgBEzV,KAAKkE,UAAUid,IAhBjB,gDALF,gHAwBE,gCAAAphB,EAAA,sEACkBC,KAAKX,KAAKqD,MAAMyB,KAAK,wBAAyB,CAACnE,KAAKuC,MADtE,UACMQ,EADN,OAEE/C,KAAKL,MAAMyD,QACNJ,MAAMC,QAAQF,GAHrB,kDAKE,EAAA/C,KAAKL,OAAM2D,KAAX,oBAAmBP,SACG1B,IAAlBrB,KAAK8F,WACH0b,EAD2B,eAClBxhB,KAAK8F,UAClB9F,KAAKL,MAAM2D,KAAKke,IARpB,gDAxBF,2DAAqC/X,GCTxB1K,GAAiB,qBACjBD,GAA0B,qBAE1BqL,IAAb,+MACEqS,cADF,IAEED,WAFF,IAGE3G,cAHF,IAIElT,WAJF,8NAsJE+e,YAAc,WACZ,IAAIjM,EAAW,EAAKvD,OAAOsD,UAAUC,SACrC,MAAiB,UAAbA,EACK,SAACzV,EAAGoF,GACT,OAAOpF,EAAEgQ,GAAK5K,EAAE4K,IAGE,UAAbyF,EACA,SAACzV,EAAGoF,GACT,OAAOA,EAAE8K,SAAWlQ,EAAEkQ,UAIjB,SAAClQ,EAAGoF,GACT,OAAOA,EAAEpB,EAAIhE,EAAEgE,IApKvB,EAyKEiS,WAAa,SAACF,GACZA,EAAIrH,KAAK,EAAKgT,eACd,IAF0B,EAEtBC,EAAI,EAFkB,cAGT5L,GAHS,IAG1B,2BAAsB,SACf5F,MAAQwR,IACXA,GALsB,gCAzK9B,EAmLE1C,iBAnLF,uCAmLqB,WAAO5e,GAAP,SAAAL,EAAA,yDACb,EAAKkS,OAAOyN,UAAUlK,WAAapV,EADtB,wDAGjB,EAAK6R,OAAOyN,UAAUlK,SAAWpV,EAHhB,SAIX,EAAKuhB,aAJM,2CAnLrB,wDA0LEzC,mBA1LF,uCA0LuB,WAAO9e,GAAP,SAAAL,EAAA,yDACf,EAAKkS,OAAOyN,UAAUC,aAAevf,EADtB,wDAGnB,EAAK6R,OAAOyN,UAAUC,WAAavf,EAHhB,SAIb,EAAKuhB,aAJQ,2CA1LvB,wDAiME9L,gBAjMF,uCAiMoB,WAAOzV,GAAP,SAAAL,EAAA,yDACZ,EAAKkS,OAAOsD,UAAUC,WAAapV,EADvB,wDAGhB,EAAK6R,OAAOsD,UAAUC,SAAWpV,EAHjB,SAIV,EAAKuhB,aAJK,2CAjMpB,wDAwMEjM,UAxMF,uCAwMc,WAAO1X,GAAP,iBAAA+B,EAAA,sDACLnB,GADK,EACOZ,GAAZY,KADK,EACC+B,GACH,EAAKvB,KAAK4E,WAAU,SAAAD,GAAC,OAAIA,EAAEnF,OAASA,MACnC,IACP,EAAKqT,OAAOC,QAAUtT,EACtB,EAAK+iB,cALG,2CAxMd,wDAiNEC,cAjNF,uCAiNkB,WAAO5jB,GAAP,iBAAA+B,EAAA,sDACTnB,GADS,EACGZ,GAAZY,KADS,EACH+B,GACH,EAAKkhB,SAAS7d,WAAU,SAAAD,GAAC,OAAIA,EAAEnF,OAASA,MACvC,IACP,EAAKqT,OAAO6P,YAAcljB,EAC1B,EAAK+iB,cALO,2CAjNlB,wDA0NEvC,oBA1NF,uCA0NwB,WAAOD,GAAP,SAAApf,EAAA,6DACpB,EAAKkS,OAAOqN,WAAaH,EADL,SAEd,EAAKwC,aAFS,2CA1NxB,+FAgBE,WACE,QAAkBtgB,IAAdrB,KAAKZ,KAAoB,CAC3B,IAAIR,EAAOoB,KAAKiS,OAAOC,QACnB5N,EAAItE,KAAKZ,KAAK4E,WAAU,SAAAD,GAAC,OAAIA,EAAEnF,OAASA,KAC5C,GAAI0F,GAAK,EACP,OAAOtE,KAAKZ,KAAKkF,GAAG3D,GAGxB,OAAQ,IAxBZ,qBA2BE,WACE,IAAI/B,EAAOoB,KAAKiS,OAAO6P,YACvB,QAAazgB,IAATzC,QAAwCyC,IAAlBrB,KAAK6hB,SAAwB,CACrD,IAAIvd,EAAItE,KAAK6hB,SAAS7d,WAAU,SAAAD,GAAC,OAAIA,EAAEnF,OAASA,KAChD,GAAI0F,GAAK,EACP,OAAOtE,KAAK6hB,SAASvd,GAAG3D,GAG5B,OAAQ,IAnCZ,0BAsCE,WACE,OAAOX,KAAKiS,OAAOyN,YAvCvB,0BA0CE,WACE,QAAkBre,IAAdrB,KAAKZ,KAAoB,CAChBY,KAAKiS,OAAOC,QAAvB,IACI5N,EAAItE,KAAKZ,KAAK4E,WAAU,SAAAD,GAAC,OAAIA,EAAEnF,OAASE,MAC5C,GAAIwF,GAAK,EACP,OAAOtE,KAAKZ,KAAKkF,GAAG3D,GAGxB,OAAQ,IAlDZ,4BAqDE,WACE,QAAkBU,IAAdrB,KAAKZ,KAAoB,CAChBY,KAAKiS,OAAOC,QAAvB,IACI5N,EAAItE,KAAKZ,KAAK4E,WAAU,SAAAD,GAAC,OAAIA,EAAEnF,OAASG,MAC5C,GAAIuF,GAAK,EACP,OAAOtE,KAAKZ,KAAKkF,GAAG3D,GAGxB,OAAQ,IA7DZ,kEAgEE,6FACMX,KAAK+hB,UAGL3G,EAAQpb,KAAK4C,KAAKwY,MAGrB4G,EAAS7U,EAAOG,UACjBtN,KAAK0C,MAAQ,IAAIiZ,GAAMqG,EAAQ,QAAS,QAAS5G,GAAO,GACxDpb,KAAKwc,SAAWxc,KAAKsW,KAAKiJ,IAC1Bvf,KAAKuc,MAAQvc,KAAKsW,KAAKxB,GACvB9U,KAAK4V,SAAW5V,KAAKsW,KAAKyK,IAKhBtT,oOAhBZ,UAkBQzN,KAAKiiB,aAlBb,QAmBEjiB,KAAKuc,MAAM2F,cACXliB,KAAKkE,UAAU4M,IApBjB,iDAhEF,qHAuFE,4BAAA/Q,EAAA,6DACMgE,EAAI+S,KAAK2B,UAAUzY,KAAKiS,QAD9B,SAEQjS,KAAK0C,MAAMyB,KAAK,sBAAuB,CAACnE,KAAK4C,KAAKjC,GAAI,SAAUoD,IAFxE,gDAvFF,qHA4FE,gHACmBvB,QAAQC,IAAI,CAACzC,KAAK0C,MAAMC,MAAM,uBAAwB,CAAC3C,KAAK4C,KAAKjC,GAAI,WAClFX,KAAKmiB,WACLniB,KAAKoiB,iBAHX,UACMvf,EADN,YAKYxB,KADNkL,EAAI1J,EAAK,UAGCxB,KADR0B,EAAMwJ,IACexJ,EAAIxD,OAAS,IAChC8iB,EAAOtf,EAAI,GAAGiM,MACd1I,EAAIwQ,KAAKC,MAAMsL,QACDhhB,IAAdrB,KAAKZ,OACHR,EAAO0H,EAAE4L,SACT5N,EAAItE,KAAKZ,KAAK4E,WAAU,SAAAD,GAAC,OAAIA,EAAEnF,OAASA,MACpC,GAAKoB,KAAKZ,KAAKG,OAAS,IAC9B+E,EAAItE,KAAKZ,KAAK4E,WAAU,SAAAD,GAAC,OAAIA,EAAEnF,OAASG,MAEtCuH,EAAE4L,QADA5N,GAAK,EACKvF,GAGAiB,KAAKZ,KAAK,GAAGR,OAI/BoB,KAAKiS,OAAS3L,QAGYjF,IAA1BrB,KAAKiS,OAAOyN,UA1BlB,gBA2BI1f,KAAKiS,OAAOyN,UAAY,CAAElK,SAAU,MA3BxC,4BA8BYxV,KAAKiS,OAAOyN,UAAUC,WA9BlC,OA+BW,QA/BX,QAgCW,UAhCX,QAiCW,OAjCX,QAkCW,OAlCX,4FAoCQ3f,KAAKiS,OAAOyN,UAAUC,WAAa,MApC3C,yCAwCgCte,IAA1BrB,KAAKiS,OAAOsD,YACdvV,KAAKiS,OAAOsD,UAAY,CAAEC,SAAU,eAEPnU,IAA3BrB,KAAKiS,OAAOqN,WACdtf,KAAKiS,OAAOqN,WAAa,CAAChB,KAAK,EAAGC,KAAK,GAAK3W,GAAG,GAAK4W,KAAK,IAAMC,KAAK,GAAKxW,IAAI,GAAK0W,OAAO,EAAGD,IAAK,EAAGE,KAAK,GAAKP,MAAM,WAGhFhd,IAAhCrB,KAAKiS,OAAOqN,WAAWV,OACzB5e,KAAKiS,OAAOqN,WAAWV,KAAO,SAEKvd,IAAjCrB,KAAKiS,OAAOqN,WAAWjB,QACzBre,KAAKiS,OAAOqN,WAAWjB,MAAQ,MAnDrC,UAsDQre,KAAKsiB,gBAtDb,yBAuDQtiB,KAAKuiB,kBAvDb,iDA5FF,mHA+NE,kGACoBlhB,IAAdrB,KAAKZ,KADX,iCAEkBY,KAAK0C,MAAMC,MAAM,YAAa,CAAC3C,KAAK4C,KAAKjC,KAF3D,cAEQ4L,EAFR,OAGQxJ,EAAMwJ,EAHd,SAImBvM,KAAKwiB,iBAAiBzf,GAJzC,oDAMgB/C,KAAK0C,MAAMC,MAAM,YAAa,CAAC3C,KAAK4C,KAAKjC,KANzD,QAMM4L,EANN,OAOMxJ,EAAMwJ,EAPZ,QASQkW,EAAK,IACLne,EAAIvB,EAAIiB,WAAU,SAAAD,GAAC,OAAEA,EAAEnF,OAASG,QAC3B,IACP0jB,EAAGnf,KAAKP,EAAIuB,IACZvB,EAAI4B,OAAOL,EAAG,KAEhBA,EAAIvB,EAAIiB,WAAU,SAAAD,GAAC,OAAGA,EAAEnF,OAASE,QACxB,IACP2jB,EAAGnf,KAAKP,EAAIuB,IACZvB,EAAI4B,OAAOL,EAAG,IAEhBme,EAAGnf,KAAH,MAAAmf,EAAE,YAAS1f,IACX/C,KAAKZ,KAAOqjB,EArBhB,iDA/NF,2HAwPE,WAAiCjd,GAAjC,0EACMkd,GAAK,OACIrhB,IAATmE,EAFN,gCAGUxF,KAAK0C,MAAMyB,KAAK,aAAc,CAACnE,KAAK4C,KAAKjC,QAAIU,EAAWtC,KAHlE,uBAIUiB,KAAK0C,MAAMyB,KAAK,aAAc,CAACnE,KAAK4C,KAAKjC,QAAIU,EAAWvC,KAJlE,OAKI4jB,GAAK,EALT,4BASYld,EAAKxB,WAAU,SAAAD,GAAC,OAAIA,EAAEnF,OAASG,MAC/B,GAVZ,kCAWYiB,KAAK0C,MAAMyB,KAAK,aAAc,CAACnE,KAAK4C,KAAKjC,QAAIU,EAAWtC,KAXpE,QAYM2jB,GAAK,EAZX,aAcQld,EAAKxB,WAAU,SAAAD,GAAC,OAAIA,EAAEnF,OAASE,MAC3B,GAfZ,kCAgBYkB,KAAK0C,MAAMyB,KAAK,aAAc,CAACnE,KAAK4C,KAAKjC,QAAIU,EAAWvC,KAhBpE,QAiBM4jB,GAAK,EAjBX,iCAqBSA,GArBT,iDAxPF,wHAgRE,oGACgB1iB,KAAK0C,MAAMC,MAAM,gBAAiB,CAAC3C,KAAK4C,KAAKjC,KAD7D,OACM4L,EADN,OAEMvJ,MAAMC,QAAQsJ,KAChBvM,KAAK6hB,SAAWtV,GAHpB,gDAhRF,wHAuRE,8FACMoW,EAAU3iB,KAAK8f,iBACJ,GAFjB,uBAGI9f,KAAK0d,UAAY,GAHrB,gCAOc,CAAE9a,KAAK5C,KAAK4C,KAAKjC,GAAIrC,IAAIqkB,GAPvC,kBASoB3iB,KAAK0C,MAAMyB,KAAK,mBAAoB,CAACnE,KAAK4C,KAAKjC,GAAIgiB,OAASthB,IAThF,OASQ0B,EATR,OAUQwJ,EAAIxJ,EAAI6N,KAAI,SAAA5S,GACd,OAAOA,EAAKwG,SAEdxE,KAAK0d,UAAYnR,EAbrB,iHAvRF,0HA2SE,8FACM5L,EAAKX,KAAK+E,mBACJ,GAFZ,uBAGI/E,KAAK6d,YAAc,GAHvB,gCAOc,CAAEjb,KAAK5C,KAAK4C,KAAKjC,GAAIrC,IAAIqC,GAPvC,kBASoBX,KAAK0C,MAAMyB,KAAK,mBAAoB,CAACnE,KAAK4C,KAAKjC,GAAIA,OAAIU,IAT3E,OASQ0B,EATR,OAUQwJ,EAAIxJ,EAAI6N,KAAI,SAAA5S,GACd,OAAOA,EAAKwG,SAEdxE,KAAK6d,YAActR,EAbvB,iHA3SF,wHA+TE,WAAoBzH,EAAeyR,GAAnC,SAAAxW,EAAA,sDACM+E,IAAU9E,KAAK8f,eACjB9f,KAAK4iB,WAAWrM,GAETzR,IAAU9E,KAAK+E,kBACtB/E,KAAK6iB,aAAatM,GALtB,gDA/TF,4HAwUE,WAAqBzR,EAAege,GAApC,oBAAA/iB,EAAA,sDACM+E,IAAU9E,KAAK8f,eACjBgD,EAASlS,KAAI,SAAA7M,GAAC,OAAE,EAAK6e,WAAW7e,MAEzBe,IAAU9E,KAAK+E,kBACtB+d,EAASlS,KAAI,SAAA7M,GAAC,OAAE,EAAK8e,aAAa9e,MALtC,gDAxUF,8HAiVE,WAAuBe,EAAeyR,GAAtC,SAAAxW,EAAA,sDACM+E,IAAU9E,KAAK8f,eACjB9f,KAAK+iB,cAAcxM,GAEZzR,IAAU9E,KAAK+E,kBACtB/E,KAAKgjB,gBAAgBzM,GAEvBvW,KAAKuc,MAAM3X,iBAAiBE,EAAOyR,GAPrC,gDAjVF,iFA2VE,SAAqB5V,GACXX,KAAK0d,UAAU1Z,WAAU,SAAAD,GAAC,OAAGA,IAAIpD,KACjC,GACNX,KAAK0d,UAAUpa,KAAK3C,KA9V1B,2BAkWE,SAAwBA,GACtB,IAAI2D,EAAItE,KAAK0d,UAAU1Z,WAAU,SAAAD,GAAC,OAAGA,IAAIpD,KACrC2D,GAAK,GACPtE,KAAK0d,UAAU/Y,OAAOL,EAAG,KArW/B,0BAyWE,SAAuB3D,GACbX,KAAK6d,YAAY7Z,WAAU,SAAAD,GAAC,OAAGA,IAAIpD,KACnC,GACNX,KAAK6d,YAAYva,KAAK3C,KA5W5B,6BAgXE,SAA0BA,GACxB,IAAI2D,EAAItE,KAAK6d,YAAY7Z,WAAU,SAAAD,GAAC,OAAGA,IAAIpD,KACvC2D,GAAK,GACPtE,KAAK6d,YAAYlZ,OAAOL,EAAG,KAnXjC,iEA2XE,WAA0B2e,EAAwDnjB,GAAlF,iFACS,IAAImjB,EAAGjjB,MAAOkjB,KAAKpjB,GAD5B,gDA3XF,gFA+XE,cA/XF,4BAkYE,SAAeA,GACJE,KAAKsW,KAAKiL,IAChBrX,MAAMpK,OApYb,GAA4BiN,GAA5B,sCAKGhL,cALH,wEAKkC,CAC9BmQ,QAASnT,GACT2gB,UAAW,CAAElK,SAAS,MACtBD,UAAW,CAAEC,SAAS,SACtB8J,WAAY,CAAChB,KAAK,EAAGC,KAAK,GAAK3W,GAAG,GAAK4W,KAAK,IAAMC,KAAK,GAAKxW,IAAI,GAAK0W,OAAO,EAAGD,IAAK,EAAGE,KAAK,GAAKP,MAAM,SAT3G,oCAWGtc,cAXH,+GAYGA,cAZH,wEAYiC,MAZjC,2CAaGA,cAbH,wEAamC,MAbnC,wCAcGA,cAdH,wGAgBG2H,YAhBH,0GA2BGA,YA3BH,mHA0CGA,YA1CH,0HAqDGA,YArDH,oF,iGCda1D,EAAb,sGACE,SAAgCyF,GAAmB,IAARoF,EAAO,uDAAH,EAC7C,YAAaxP,IAANoK,EAAkB,GAAKA,EAAE6D,QAAQuB,KAF5C,oBAIE,SAAqBpF,GAAiB,IAANoF,EAAK,uDAAH,EAChC,YAAaxP,IAANoK,EAAkB,GAAKA,EAAE6D,QAAQuB,KAL5C,iCAQE,SAAkCpF,GAChC,YAAapK,IAANoK,GAAmB4D,MAAM5D,GAAK,GAAKe,KAAKiD,MAAMhE,EAAE,KAAOiE,aATlE,4BAYE,SAA6BjE,GAA2B,IAAhB0X,EAAe,uDAAH,EAClD,YAAa9hB,IAANoK,EAAkB,GAAKA,EAAE2X,YAAYD,KAbhD,+BAgBE,SAAgC1X,GAA2B,IAAhB0X,EAAe,uDAAH,EACrD,YAAa9hB,IAANoK,OAAkBpK,EAAYgiB,OAAOC,WAAW7X,EAAE2X,YAAYD,MAjBzE,gCAoBE,SAAiC1X,GAC/B,YAAapK,IAANoK,GAAmB4D,MAAM5D,GAAK,IAAU,IAAJA,GAAS6D,QAAQ,GAAK,MArBrE,sBAwBE,SAAuB7D,GACrB,YAAapK,IAANoK,GAAmB4D,MAAM5D,GAAK,IAAU,IAAJA,GAAS6D,QAAQ,GAAK,MAzBrE,sBA2BE,SAAuB7D,GACrB,YAAapK,IAANoK,GAAmB4D,MAAM5D,GAAK,IAAU,IAAJA,GAAS6D,QAAQ,GAAK,MA5BrE,+BA+BE,SAAgCiU,GAC9B,OAAQA,GACN,IAAK,KAAM,MAAO,eAClB,IAAK,KAAM,MAAO,eAClB,QAAS,OAAOA,KAnCtB,6BAuCE,SAA8B3b,GAC5B,OAAY,EAALA,EAASA,EAAKA,IAxCzB,gCA2CE,SAAiC4b,EAAcC,EAAWC,EAAWrT,GACnE,IAAI9D,EAAI,EAAIiX,EACR5b,EAAK2E,EAAIA,EACToX,EAAK/b,EAAK2E,EACd,OAAQkX,EAAGlX,EAAImX,EAAI9b,EAAKyI,EAAKsT,EAAKtT,EAAKmT,EAAQG,GAAM,IA/CzD,wBAkDE,SAAyBC,EAAU3T,EAAiBF,GAClD,QAAW1O,IAAP0O,IAAoBV,MAAMU,GAA9B,CAIA,IAAIxD,EAAI,EAUR,YATUlL,IAANuiB,IACEA,EAAI,MACNA,EAAI,KAENrX,GAAS,IAAJqX,QAEUviB,IAAb4O,IACF1D,GAAgB,IAAX0D,GAEA1D,EAAIwD,KAjEf,yBAoEE,SAA0B6T,EAAUrlB,EAAU8K,EAAclG,GAC1D,QAAc9B,IAAV8B,IAAuBkM,MAAMlM,SAAgB9B,IAAN9C,IAAmB8Q,MAAM9Q,GAApE,CAIA,IAAIgO,EAAI,EAYR,YAXUlL,IAANuiB,GAAmBrlB,EAAI,IACrBqlB,EAAI,MACNA,EAAI,IAAOpX,KAAKqX,IAAa,KAARD,EAAE,KAAW,OAAU,KAI9CrX,IADAqX,GADAA,EAAI,EAAIA,GACAA,EAAIA,EAAI,GACPrlB,EAAI,UAED8C,IAAVgI,GAAwBgG,MAAMhG,KAChCkD,GAAa,IAARlD,GAEAkD,EAAIpJ,KArFf,0BAwFE,SAA2BjC,GACzB,IAAI6B,EAAe,MAAC1B,OAAWA,OAAWA,OAAWA,GACrD,QAAaA,IAATH,EACF,OAAO6B,EAET,GADU7B,EAAK3B,OACL,EACR,OAAOwD,EAOT,IALA,IAAIwN,EAAQ,SAAC9E,EAAU+E,GACrB,KAAIA,GAAK,GAAK/E,GAAK,GAEnB,OAASA,EAAI+E,EAAK,GAEXlM,EAAI,EAAGA,EAAI,IAAKA,EACvBvB,EAAIuB,GAAKiM,EAAMrP,EAAKoD,EAAE,GAAIpD,EAAKoD,IAEjC,OAAOvB,IAxGX,4BA6GE,SAA6BR,GAG3B,OAAmB,IAFRiK,KAAKsX,MAAMvhB,EAAI,KAEb,OADDiK,KAAKsX,MAAOvhB,EAAI,IAAO,KAAO,KA/G9C,6BAmHE,SAA8BA,GAC5B,IAAIwhB,EAAOvX,KAAKsX,MAAMvhB,EAAI,KACtByhB,EAAQxX,KAAKsX,MAAOvhB,EAAI,IAAO,KAAO,EAE1C,OAAmB,GAAXwhB,EAAK,MADAvX,KAAKsX,MAAME,EAAQ,KAtHpC,mCA0HE,SAAoCD,EAAaC,GAE/C,OAAmB,GAAXD,EAAK,MADAvX,KAAKsX,OAAOE,EAAM,GAAK,KA3HxC,iCA+HE,SAAkC7d,GAGhC,OAAc,KAFHqG,KAAKsX,MAAM3d,EAAK,GAAK,MACO,GAA1BqG,KAAKsX,MAAM3d,EAAK,GAAK,KAjItC,gCAqIE,SAAiCE,GAC/B,IAAI0d,EAAyC,KAAjC,KAAOvX,KAAKsX,MAAMzd,EAAS,IACnC4d,EAAI5d,EAAS,EACjB,OAAU,IAAN4d,EACK,CAACC,MAAOH,EAAO,IAAK7d,IAAK6d,EAAO,KAE1B,IAANE,EACA,CAACC,MAAOH,EAAO,IAAK7d,IAAK6d,EAAO,KAE1B,IAANE,EACA,CAACC,MAAOH,EAAO,IAAK7d,IAAK6d,EAAO,KAElC,CAACG,MAAOH,EAAO,KAAM7d,IAAK6d,EAAO,QAjJ5C,iCAoJE,SAAkCjO,GAChC,IAAI/S,EAAoD,CAACsa,WAAMhc,EAAWic,WAAMjc,EAAWkc,YAAOlc,GAE9F9B,EAASuW,EAAIvW,OACb4kB,EAAW,SAACC,GACd,IAAI5b,EAAW4b,EAGf,GAFI5b,EAAWjJ,IACbiJ,EAAWjJ,GACTiJ,GAAY,GAAI,CAElB,IADA,IAAI6b,EAAM,EACD/f,EAAI,EAAGA,EAAIkE,IAAYlE,EAC9B+f,GAAOvO,EAAIxR,GAAG6S,UAEhB,OAAOkN,GAAO7b,EAAW,KAU7B,OAHAzF,EAAIsa,MAAQ8G,EAAS,IACrBphB,EAAIua,MAAQ6G,EAAS,IACrBphB,EAAIwa,OAAS4G,EAAS,KACfphB,IA3KX,+BA8KE,SAAgC+S,GAC9B,IAAI/S,EAAgE,CAACsa,WAAMhc,EAAWic,WAAMjc,EAAWkc,YAAOlc,EAAWmc,SAAInc,GAEzH9B,EAASuW,EAAIvW,OACb4kB,EAAW,SAACC,GACd,IAAI5b,EAAW4b,EAGf,IAFc,IAAVA,GAAe5b,EAAWjJ,KAC5BiJ,EAAWjJ,GACTiJ,GAAY,GAAI,CAElB,IADA,IAAI6b,EAAM,EACD/f,EAAI,EAAGA,EAAIkE,IAAYlE,EAC9B+f,GAAOvO,EAAIxR,GAAGP,EAEhB,OAAOsgB,GAAO7b,EAAW,KAW7B,OAJAzF,EAAIsa,MAAQ8G,EAAS,IACrBphB,EAAIua,MAAQ6G,EAAS,IACrBphB,EAAIwa,OAAS4G,EAAS,KACtBphB,EAAIya,IAAM2G,EAAS,GACZphB,MAtMX,KAAaiD,EA2GGwI,QAAU,SAACQ,GAAD,OAAkB,sBAAMrQ,UAAU,mBAAhB,SAAoCqQ,M,yOCjGnExF,GAAb,qNACUkJ,WADV,IAEUrE,SAAchN,EAFxB,6CAcEsR,eAAiB,SAACpU,GAChB,IAAI+lB,EAAQ/lB,EAAE6S,OAAO1C,QACrB,EAAK6V,SAAWD,GAhBpB,EAmBEE,eAAiB,SAACjmB,GAChB,IAAI+lB,EAAQ/lB,EAAE6S,OAAO1C,QACrB,EAAKvQ,WAAWuF,gBAAgB4gB,IArBpC,EAwBEG,gBAAkB,SAAClmB,GACjB,IAAI+lB,EAAQ/lB,EAAE6S,OAAO1C,QACrB,EAAKvQ,WAAW0G,kBAAkByf,IA1BtC,EA6BUrlB,KAAOC,oBAAS,WAAO,IAAD,EACwC,EAAKf,WAAnEyF,EADsB,EACtBA,aAActB,EADQ,EACRA,SAAUuB,EADF,EACEA,YAAaf,EADf,EACeA,UAAWif,EAD1B,EAC0BA,UAChDnjB,EAAoB0D,EAApB1D,KAAMyG,EAAc/C,EAAd+C,KAAM9C,EAAQD,EAARC,IACG,WAIrB,IAAI1D,EAAQiE,GAAa,wBAC3BnE,UAAU,iEACVK,QAAS6E,EAFkB,SAGD,IAArBf,EAAUvD,OAAc,qBAAQ,uBAE/BmlB,EAAU9lB,EAAO,IAAMyG,OACfhE,IAARkB,IACFmiB,GAAW,MAAQniB,GAEvB,IAAIuQ,EAAO,qBAAK9T,QAAS,kBAAI,EAAKb,WAAW6G,gBAAgBzC,IAAlD,SAAyDmiB,IAClE,OAAO,cAAC,OAAD,CAAMjlB,OAAQqT,EAAMjU,MAAOA,EAChCa,gBAAgB,aADX,SAEL,cAAC,EAAKqT,YAAN,SAhDN,EAoDUA,YAAc7T,oBAAS,WAC7B,OAAO,qCACL,cAAC,EAAKylB,SAAN,IACA,cAAC,EAAKC,SAAN,IACA,cAAC,EAAK5R,aAAN,IACA,cAAC,EAAK6R,YAAN,IACA,cAAC,EAAKC,qBAAN,IACA,cAAC,EAAKC,cAAN,IACA,cAAC,EAAKC,eAAN,IACA,cAAC,EAAK3b,MAAN,UA7DN,EAiEUgL,SAAW,SAAC4Q,GAClB,IAAIlhB,EAAIkhB,EAAI7T,OAAOpC,MACfvD,EAAI4X,OAAOtf,IACE,IAAbsL,MAAM5D,IAAgB4X,OAAO6B,UAAUzZ,IAM3C,EAAK4C,IAAM4W,EAAI7T,OAAOpC,WACL3N,IAAb,EAAKgN,MACL,EAAKA,IAAM,EAAKA,IAAI8W,OACH,KAAb,EAAK9W,MAAY,EAAKA,SAAMhN,KAR9B,EAAKqR,QACP,EAAKA,MAAM1D,MAAQ,EAAKX,MAtEhC,EAiFU+W,SAjFV,uCAiFqB,WAAOH,GAAP,eAAAllB,EAAA,yDACjBklB,EAAIzmB,sBACa6C,IAAb,EAAKgN,MAAmB,EAAKA,IAAM,IACnC5C,EAAI4X,OAAO,EAAKhV,KACfgB,MAAM5D,KAAM4X,OAAO6B,UAAWzZ,GAJlB,qBAKN,IAALA,GAAWA,GAAK,UAAYA,EAAI,UALrB,gCAMP,EAAKtN,WAAWiH,UAAUqG,GANnB,2CAjFrB,wDA6FUkZ,SAAW,WAAO,IACnBpiB,EAAO,EAAKpE,WAAWmE,SAAvBC,IACD8iB,OAAoBhkB,IAARkB,GAAqB8M,MAAM9M,GAAO,GAAKA,EAAImN,WAC3D,OAAO,qBAAK/Q,UAAU,YAAf,SACT,sBAAMA,UAAU,QAAQymB,SAAU,EAAKA,SAAvC,SACC,sBAAKzmB,UAAU,6BAAf,UACC,uBAAOA,UAAU,gDAAjB,SAAkE,iBAClE,uBAAO2mB,IAAK,SAAAvhB,GAAC,OAAE,EAAK2O,MAAM3O,GAAGsQ,SAAU,EAAKA,SAC1CjU,KAAK,OACLxB,KAAK,MACL2mB,aAAcF,EACd1mB,UAAU,mCACV+B,YAAa,WACbJ,UAAW,IACb,qBAAK3B,UAAU,qBAAf,SACE,yBAAQA,UAAU,uBACjByB,KAAK,SADN,UAEC,mBAAGzB,UAAU,iBACb,mBAAGA,UAAU,OACZ,4BAhHR,EAyHUimB,SAAW1lB,oBAAS,WAAO,IAC5BoD,EAAY,EAAKnE,WAAjBmE,SACC3B,EAA+E2B,EAA/E3B,GAAgB2E,GAA+DhD,EAA3E1D,KAA2E0D,EAArE+C,KAAqE/C,EAA/DgD,QAAQyK,EAAuDzN,EAAvDyN,GAAIC,EAAmD1N,EAAnD0N,IAAK7M,EAA8Cb,EAA9Ca,MAAc8M,GAAgC3N,EAAvC4N,MAAuC5N,EAAhC2N,UAGjDuV,GAHiFljB,EAAtB/D,EAAsB+D,EAAnBiE,QAAmBjE,EAAV+G,MAEhE,EAAKlL,WAAWkB,KAAKwe,YACb7Z,WAAU,SAAAD,GAAC,OAAEA,IAAIpD,MAAO,GACvC9B,EAAQ,wBAAOF,UAAU,yBAAjB,cAA2C,uBAAOyB,KAAK,WAAWxB,KAAK,mBAAmB+P,eAAgB6W,EACpHnR,SAAU,EAAKoQ,kBADL,wBAEZ,OAAO,eAAC,MAAD,CAAK9lB,UAAU,WAAWE,MAAOA,EAAjC,cAAyC,qBAAKF,UAAU,YAAf,SAC9C,sBAAKA,UAAU,mBAAf,UACE,sBAAKA,UAAU,UAAf,UAA0BqH,IAAMwI,QAAQ,OAAQxI,IAAMoY,kBAAkBrO,MACxE,sBAAKpR,UAAU,UAAf,UAA0BqH,IAAMwI,QAAQ,sBAAQxI,IAAMyf,mBAAmBxV,MACzE,sBAAKtR,UAAU,UAAf,UAA0BqH,IAAMwI,QAAQ,OAAQxI,IAAMyf,mBAAmBzV,MACzE,sBAAKrR,UAAU,UAAf,UAA0BqH,IAAMwI,QAAQ,gBAAOxI,IAAMoY,kBAAkBjb,MACvE,mBAAGxE,UAAU,iBAAiBwS,KAAI,wDAAmD7L,EAAnD,aAAsE8L,OAAO,SAASC,IAAI,sBAAsBrS,QAAS,SAACT,GAAMA,EAAE+S,mBAApK,iDAvIR,EA6IYxB,YA7IZ,uCA6I0B,WAAO9R,GAAP,iBAAA+B,EAAA,sDAChBuF,EAAWtH,EAAXsH,OACFsS,EAFkB,uDAEoCtS,EAFpC,aAGdogB,OAAOxC,KAAKtL,EAAK,IACvB+N,YAAStkB,EAJW,2CA7I1B,wDAoJY2R,aAAe9T,oBAAS,WAAO,IAAD,EACR,EAAKf,WAA9BoK,EADiC,EACjCA,YAAajG,EADoB,EACpBA,SAClB,QAAoBjB,IAAhBkH,EACF,OAAO,6BACT,IAJsC,EAIlC0K,EAAe,WACfC,EAAkB,GAClB0S,EAAqB,GACrBC,EAAmB,GAPe,cAQrBtd,GARqB,IAQtC,2BAA8B,CAAC,IAAtBvK,EAAqB,QACvBuE,EAAmBvE,EAAnBuE,IAAKY,EAAcnF,EAAdmF,MAAO4F,EAAO/K,EAAP+K,IACjBmK,EAAU5P,KAAKf,GACfqjB,EAAUtiB,KAAK0C,IAAMqN,kBAAkBlQ,EAAO,IAC1C4F,GAAO,EACT8c,EAAQviB,UAAKjC,GAET,EAAKkjB,UAAYxb,GAAO,GAC1B8c,EAAQviB,KAAK,IAGbuiB,EAAQviB,KAAK0C,IAAMqN,kBAAkBtK,EAAK,KAnBV,8BAuBtC,IAAIuK,EAAa,CACfC,OAAQL,EACRM,SAAU,CACR,CACE/S,MAAO,eACPS,KAAM0kB,EACNnS,YAAY,OACZC,gBAAgB,UAChBC,YAAa,EACbC,MAAM,EACNC,QAAS,YAEX,CACEpT,MAAO,MACPS,KAAM2kB,EACNpS,YAAY,MACZC,gBAAgB,OAChBC,YAAa,EACbC,MAAM,EACNC,QAAS,cAsBfZ,EAAe,cAAC,IAAD,CAAK/R,KAAMoS,EAAYlT,KAAK,OAAO0T,QAlBpC,CACZC,OAAO,CACLC,MAAO,CAAC,CACJ5T,KAAM,SACN6T,SAAS,EACTC,SAAU,OACVvT,GAAI,YACL,CACCP,KAAM,SACN6T,SAAS,EACTC,SAAU,QACVvT,GAAI,WACJwT,UAAW,CACPC,iBAAiB,SAM7B,IAAIvV,EAAQ,6BAaZ,OAXEA,OADmBwC,IAAjBiB,EAASC,IACH,qCAAE,wBAAO5D,UAAU,OAAjB,cAAyB,uBAAOyB,KAAK,WAAWxB,KAAK,YAAY+P,gBAAgB,EACrF0F,SAAU,EAAKmQ,iBADX,0CAEN,wBAAO7lB,UAAU,OAAjB,cAAyB,uBAAOyB,KAAK,WAAWxB,KAAK,aAAa+P,eAAgB,EAAK4V,SACvFlQ,SAAU,EAAK1B,iBADf,gDAMI,wBAAOhU,UAAU,OAAjB,cAAyB,uBAAOyB,KAAK,WAAWxB,KAAK,aAAa+P,eAAgB,EAAK4V,SAC7FlQ,SAAU,EAAK1B,iBADT,6CAGH,qCAAE,cAAC,MAAD,CAAKhU,UAAU,qBAAqBD,KAAM,2BAAQG,MAAOA,IAChE,qBAAKF,UAAU,OAAOmP,MAAO,CAACE,MAAM,OAApC,SAA6CiF,UAnOnD,EAuOY4R,YAAc3lB,oBAAS,WAAO,IAAD,EACP,EAAKf,WAA9B+I,EADgC,EAChCA,YAAaG,EADmB,EACnBA,SAClB,QAAoBhG,IAAhB6F,EACF,OAAO,6BAH4B,IAI/B3I,EAAiC2I,EAAjC3I,EAAG4G,EAA8B+B,EAA9B/B,EAAGyC,EAA2BV,EAA3BU,GAAIC,EAAuBX,EAAvBW,KAAME,EAAiBb,EAAjBa,EAAGE,EAAcf,EAAde,IAAKC,EAAShB,EAATgB,KAC1B4d,EAAS,6BACb,GAAwB,IAApBze,EAAS9H,OAAc,CACzB,IAAIgI,EAAK,IAAIC,IAAaH,GACtBiM,EAAa,CACfC,OAAQ,CAAC,IAAK,IAAK,IAAK,IAAK,KAC7BC,SAAU,CACR,CACE/S,MAAO,eACPS,KAAMmG,EAASuJ,KAAI,SAAA7M,GAAC,OAAEiC,IAAMqN,kBAAkBtP,MAC9C0P,YAAY,QACZC,gBAAgB,UAChBqS,UAAU,EACVC,WAAY,WACZrS,YAAa,EACbsS,YAAa,EACbrS,MAAM,KAIZ,IAAMvE,MAAM9H,EAAGI,KAAM0H,MAAM9H,EAAGmF,GAAK,CAEjC,IADA,IAAIwZ,EAAe,GACV5hB,EAAI,EAAGA,EAAI,IAAKA,EACvB4hB,EAAI5iB,KAAK0C,IAAMqN,kBAAkB9L,EAAGO,QAAQxD,GAAI,IAElDgP,EAAWE,SAASlQ,KAClB,CACE7C,MAAO,2BACPS,KAAMglB,EACNzS,YAAY,MACZC,gBAAgB,OAChBC,YAAa,EACbC,MAAM,IAGZ,IAAInM,EAAK,IAAIC,IAAcL,GAC3B,IAAMgI,MAAM5H,EAAG2D,SAAUiE,MAAM5H,EAAG4D,WAAa,CAE7C,IADA,IAAI8a,EAAe,GACV7hB,EAAI,EAAGA,EAAI,IAAKA,EACvB6hB,EAAI7iB,KAAK0C,IAAMqN,kBAAkB5L,EAAGK,QAAQxD,GAAI,IAElDgP,EAAWE,SAASlQ,KAClB,CACE7C,MAAO,2BACPS,KAAMilB,EACN1S,YAAY,OACZC,gBAAgB,OAChBC,YAAa,EACbC,MAAM,IAGZkS,EAAS,cAAC,IAAD,CAAK5kB,KAAMoS,EAAYlT,KAAK,SAEvC,IAAIgmB,EAAS,EAAKC,uBACdC,EAAS,EAAKC,kBAClB,OAAO,qCAAE,qBAAK5nB,UAAU,qBAAf,kDACP,sBAAKA,UAAU,mBAAf,UACE,sBAAKA,UAAU,WAAf,UAA2BqH,IAAMwI,QAAQ,KAAMxI,IAAMwgB,eAAejoB,EAAG,MACvE,sBAAKI,UAAU,WAAf,UAA2BqH,IAAMwI,QAAQ,iBAAQxI,IAAMwgB,eAAerhB,EAAG,MACzE,sBAAKxG,UAAU,WAAf,UAA2BqH,IAAMwI,QAAQ,MAAOxI,IAAMwgB,eAAe5e,EAAI,MACzE,sBAAKjJ,UAAU,WAAf,UAA2BqH,IAAMwI,QAAQ,iBAAQxI,IAAMwgB,eAAe3e,SAExE,qBAAKlJ,UAAU,qBAAf,kDACA,sBAAKA,UAAU,mBAAf,UACA,sBAAKA,UAAU,WAAf,UAA2BqH,IAAMwI,QAAQ,KAAMxI,IAAMwgB,eAAejoB,EAAG,MACrE,sBAAKI,UAAU,WAAf,UAA2BqH,IAAMwI,QAAQ,sBAAQxI,IAAMwgB,eAAeze,EAAG,MACzE,sBAAKpJ,UAAU,WAAf,UAA2BqH,IAAMwI,QAAQ,MAAOxI,IAAMwgB,eAAeve,EAAK,MAC1E,sBAAKtJ,UAAU,WAAf,UAA2BqH,IAAMwI,QAAQ,iBAAQxI,IAAMwgB,eAAete,SAExE,sBAAKvJ,UAAU,SAAf,UACE,qBAAKA,UAAU,OAAOmP,MAAO,CAACE,MAAM,OAApC,SAA6C8X,IAC7C,qBAAKnnB,UAAU,OAAOmP,MAAO,CAACE,MAAM,OAApC,SAA6CoY,OAE/C,qBAAKznB,UAAU,SAAf,SACE,qBAAKA,UAAU,OAAOmP,MAAO,CAACE,MAAM,OAApC,SAA6CsY,YArTrD,EA0TYD,qBAAuB,WAAO,IAChCjf,EAA0B,EAAKjJ,WAA/BiJ,sBACFzB,EAAMyB,EAAsB7H,OAChC,GAAIoG,GAAO,EACT,OAAO,6BAGT,IAFA,IAAIlF,EAAQ,GACR0K,EAAa,GACR7G,EAAIqB,EAAM,EAAGrB,GAAK,IAAKA,EAAG,CACjC,IAAItG,EAAOoJ,EAAsB9C,QACfjD,IAAdrD,EAAKyI,OAEThG,EAAM6C,KAAK0C,IAAMygB,oBAAoBzoB,EAAKqI,SAC1C8E,EAAE7H,KAAKtF,EAAKyI,OAGd,IAAIc,EAAK,IAAIC,IAAa2D,GACtBub,EAAgB,CAClBnT,OAAQ9S,EACR+S,SAAU,CACR,CACE/S,MAAO,eACPS,KAAMiK,EAAEyF,KAAI,SAAA7M,GAAC,OAAEiC,IAAMqN,kBAAkBtP,MACvC0P,YAAY,QACZC,gBAAgB,UAChBqS,UAAU,EACVC,WAAY,WACZrS,YAAa,EACbsS,YAAa,EACbrS,MAAM,KAIZ,IAAMvE,MAAM9H,EAAGI,KAAM0H,MAAM9H,EAAGmF,GAAK,CAEjC,IADA,IAAIwZ,EAAe,GACV5hB,EAAI,EAAGA,EAAIqB,IAAOrB,EACzB4hB,EAAI5iB,KAAK0C,IAAMqN,kBAAkB9L,EAAGO,QAAQxD,GAAI,IAElDoiB,EAAclT,SAASlQ,KACrB,CACE7C,MAAO,mBAAWuF,IAAMwgB,eAAejf,EAAGK,GAAI,GAC9C1G,KAAMglB,EACNzS,YAAY,MACZC,gBAAgB,OAChBC,YAAa,EACbC,MAAM,IAGZ,IAAInM,EAAK,IAAIC,IAAcyD,GAC3B,IAAMkE,MAAM5H,EAAG2D,SAAUiE,MAAM5H,EAAG4D,WAAa,CAE7C,IADA,IAAI8a,EAAe,GACV7hB,EAAI,EAAGA,EAAIqB,IAAOrB,EACzB6hB,EAAI7iB,KAAK0C,IAAMqN,kBAAkB5L,EAAGK,QAAQxD,GAAI,IAElDoiB,EAAclT,SAASlQ,KACrB,CACE7C,MAAO,mBAAWuF,IAAMwgB,eAAe/e,EAAGG,GAAI,GAC9C1G,KAAMilB,EACN1S,YAAY,OACZC,gBAAgB,OAChBC,YAAa,EACbC,MAAM,IAGZ,OAAO,cAAC,IAAD,CAAK1S,KAAMwlB,EAAetmB,KAAK,UAzX1C,EA4XYmmB,gBAAkB,WAAO,IAC3Bnf,EAA0B,EAAKjJ,WAA/BiJ,sBACFzB,EAAMyB,EAAsB7H,OAChC,GAAIoG,GAAO,EACT,OAAO,6BAGT,IAFA,IAAIlF,EAAQ,GACR0K,EAAa,GACR7G,EAAIqB,EAAM,EAAGrB,GAAK,IAAKA,EAAG,CACjC,IAAItG,EAAOoJ,EAAsB9C,QACfjD,IAAdrD,EAAKyI,OAEThG,EAAM6C,KAAK0C,IAAMygB,oBAAoBzoB,EAAKqI,SAC1C8E,EAAE7H,KAAKtF,EAAK6I,QAAU7I,EAAK2I,OAG7B,IAAI+f,EAAgB,CAClBnT,OAAQ9S,EACR+S,SAAU,CACR,CACE/S,MAAO,kBACPS,KAAMiK,EAAEyF,KAAI,SAAA7M,GAAC,OAAEiC,IAAMqN,kBAAkBtP,MACvC0P,YAAY,QACZC,gBAAgB,UAChBqS,UAAU,EACVC,WAAY,WACZrS,YAAa,EACbsS,YAAa,EACbrS,MAAM,KAIRnM,EAAK,IAAIC,IAAcyD,GAC3B,IAAMkE,MAAM5H,EAAG2D,SAAUiE,MAAM5H,EAAG4D,WAAa,CAE7C,IADA,IAAI8a,EAAe,GACV7hB,EAAI,EAAGA,EAAIqB,IAAOrB,EACzB6hB,EAAI7iB,KAAK+f,OAAOC,WAAW7b,EAAGK,QAAQxD,GAAG8e,YAAY,KAEvDsD,EAAclT,SAASlQ,KACrB,CACE7C,MAAO,mBAAWuF,IAAMwgB,eAAe/e,EAAGG,GAAI,GAC9C1G,KAAMilB,EACN1S,YAAY,OACZC,gBAAgB,OAChBC,YAAa,EACbC,MAAM,IAGZ,OAAO,cAAC,IAAD,CAAK1S,KAAMwlB,EAAetmB,KAAK,UA3a1C,EA8aU0kB,qBAAuB5lB,oBAAS,WACtC,IAAIS,EAAQ,EAAKxB,WAAWgJ,kBACxB1H,EAAS,sBAAKd,UAAU,OAAf,UACX,qBAAKA,UAAU,UAAf,0BACA,qBAAKA,UAAU,qBAAf,0BACA,qBAAKA,UAAU,qBAAf,gCACA,qBAAKA,UAAU,qBAAf,gCACA,qBAAKA,UAAU,qBAAf,iBACA,qBAAKA,UAAU,qBAAf,2BACA,qBAAKA,UAAU,qBAAf,iCACA,qBAAKA,UAAU,qBAAf,oCAEF,OAAO,qCACL,qBAAKA,UAAU,YAAf,uFACA,cAAC,OAAD,CAAMc,OAAQA,EAAQ4C,QAAQ,MAC5B1C,MAAOA,EACP3B,KAAM,CACJ4B,OAAQ,SAACiQ,GAAqG,IACvGxJ,EAA2CwJ,EAA3CxJ,OAAQC,EAAmCuJ,EAAnCvJ,EAAG/H,EAAgCsR,EAAhCtR,EAAGkI,EAA6BoJ,EAA7BpJ,KAAME,EAAuBkJ,EAAvBlJ,KAAMC,EAAiBiJ,EAAjBjJ,KAAMC,EAAWgJ,EAAXhJ,QACjCkF,EAAK/F,IAAMygB,oBAAoBpgB,GAEnC,OAAO,sBAAK1H,UAAU,6BAAf,UACL,qBAAKA,UAAU,UAAf,SAA0BoN,EAAG2D,aAC7B,qBAAK/Q,UAAU,qBAAf,SAAqCqH,IAAMoY,kBAAkB9X,KAC7D,qBAAK3H,UAAU,qBAAf,SAAqCqH,IAAMoY,kBAAkB7f,KAC7D,qBAAKI,UAAU,qBAAf,SAAqCqH,IAAMoY,kBAAkB3X,KAC7D,qBAAK9H,UAAU,qBAAf,SAAqCqH,IAAMyf,mBAAmBhf,EAAKH,KACnE,qBAAK3H,UAAU,qBAAf,SAAqCqH,IAAMoY,kBAAkBzX,KAC7D,qBAAKhI,UAAU,qBAAf,SAAqCqH,IAAMoY,kBAAkBxX,KAC7D,qBAAKjI,UAAU,qBAAf,SAAqCqH,IAAMoY,kBAAkBvX,kBA3c3E,EAodUke,cAAgB7lB,oBAAS,WAC/B,IAAIS,EAAQ,EAAKxB,WAAWsH,WACxBhG,EAAS,sBAAKd,UAAU,OAAf,UACX,qBAAKA,UAAU,UAAf,0BACA,qBAAKA,UAAU,qBAAf,0BACA,qBAAKA,UAAU,qBAAf,gCACA,qBAAKA,UAAU,qBAAf,gCACA,qBAAKA,UAAU,qBAAf,iBACA,qBAAKA,UAAU,qBAAf,2BACA,qBAAKA,UAAU,qBAAf,iCACA,qBAAKA,UAAU,qBAAf,oCAEF,OAAO,qCACL,qBAAKA,UAAU,YAAf,kDACA,cAAC,OAAD,CAAMc,OAAQA,EAAQ4C,QAAQ,MAC5B1C,MAAOA,EACP3B,KAAM,CACJ4B,OAAQ,SAACiQ,GAAqG,IACvGxJ,EAA2CwJ,EAA3CxJ,OAAQC,EAAmCuJ,EAAnCvJ,EAAG/H,EAAgCsR,EAAhCtR,EAAGkI,EAA6BoJ,EAA7BpJ,KAAME,EAAuBkJ,EAAvBlJ,KAAMC,EAAiBiJ,EAAjBjJ,KAAMC,EAAWgJ,EAAXhJ,QACjCkF,EAAK/F,IAAMygB,oBAAoBpgB,GAEnC,OAAO,sBAAK1H,UAAU,6BAAf,UACL,qBAAKA,UAAU,UAAf,SAA0BoN,EAAG2D,aAC7B,qBAAK/Q,UAAU,qBAAf,SAAqCqH,IAAMoY,kBAAkB9X,KAC7D,qBAAK3H,UAAU,qBAAf,SAAqCqH,IAAMoY,kBAAkB7f,KAC7D,qBAAKI,UAAU,qBAAf,SAAqCqH,IAAMoY,kBAAkB3X,KAC7D,qBAAK9H,UAAU,qBAAf,SAAqCqH,IAAMyf,mBAAmBhf,EAAKH,KACnE,qBAAK3H,UAAU,qBAAf,SAAqCqH,IAAMoY,kBAAkBzX,KAC7D,qBAAKhI,UAAU,qBAAf,SAAqCqH,IAAMoY,kBAAkBxX,KAC7D,qBAAKjI,UAAU,qBAAf,SAAqCqH,IAAMoY,kBAAkBvX,kBAjf3E,EA0fUme,eAAiB9lB,oBAAS,WAChC,IAAIS,EAAQ,EAAKxB,WAAWwoB,eACxBlnB,EAAS,sBAAKd,UAAU,OAAf,UACX,qBAAKA,UAAU,UAAf,oBACA,qBAAKA,UAAU,qBAAf,0BACA,qBAAKA,UAAU,qBAAf,0BACA,qBAAKA,UAAU,qBAAf,oBAEF,OAAO,qCACL,qBAAKA,UAAU,YAAf,kDACA,cAAC,OAAD,CAAMc,OAAQA,EAAQ4C,QAAQ,MAC5B1C,MAAOA,EACP3B,KAAM,CACJ4B,OAAQ,SAACiQ,GAA8B,IAChCtJ,EAAoBsJ,EAApBtJ,QAASG,EAAWmJ,EAAXnJ,QACd,OAAO,sBAAK/H,UAAU,6BAAf,UACL,qBAAKA,UAAU,UAAf,SAA0BkR,EAAIkU,OAC9B,sBAAKplB,UAAU,qBAAf,cAAsC4H,EAAQ+I,QAAQ,MACtD,sBAAK3Q,UAAU,qBAAf,cAAsC+H,EAAQ4I,QAAQ,MACtD,sBAAK3Q,UAAU,qBAAf,eAAuC+H,EAAQH,EAAQ,KAAK+I,QAAQ,GAApE,oBA7gBd,EAqhBUjG,MAAQnK,oBAAS,WACvB,IAAIS,EAAQ,EAAKxB,WAAWkL,MACxB5J,EAAS,sBAAKd,UAAU,OAAf,UACX,qBAAKA,UAAU,UAAf,0BACA,qBAAKA,UAAU,qBAAf,6BAEF,OAAO,qCACL,qBAAKA,UAAU,YAAf,sCACA,cAAC,OAAD,CAAMc,OAAQA,EAAQ4C,QAAQ,MAC5B1C,MAAOA,EACP3B,KAAM,CACJ4B,OAAQ,SAACiQ,GACP,OAAO,sBAAKlR,UAAU,6BAAf,UACL,qBAAKA,UAAU,UAAf,SAA0BkR,EAAItN,MAC9B,sBAAK5D,UAAU,qBAAf,cAAsCkR,EAAIxG,MAAMiG,QAAQ,mBAniBtE,iFAIE,WAAWxP,GAAX,SAAAC,EAAA,sDACEC,KAAKC,SAASD,KAAKf,MADrB,gDAJF,2EAUE,SAAOa,GACL,OAAO,mBAAMb,KAAN,QAXX,GAAgCiB,SAAhC,sCAQG6B,cARH,yEAQ2C,KAR3C,I,2MCNa6kB,EAAb,4MAaUC,aAbV,uCAayB,WAAOC,GAAP,SAAA/mB,EAAA,sEACb,EAAK5B,WAAW4oB,YAAYD,GADf,OAEnB,EAAK3lB,YAFc,2CAbzB,wDAkBUlC,KAAOC,aAAS,SAAC8nB,GAAmB,IAAD,EACX,EAAK7oB,WAA3B8oB,EADiC,EACjCA,UAAWnV,EADsB,EACtBA,OACbQ,EAAO,qBAAK3T,UAAU,yBAAf,kDACX,OAAO,eAAC,OAAD,CAAMc,OAAO,2BAAOC,gBAAgB,aAAawnB,eAAgBpV,EAAjE,UACH,cAAC,YAAD,CAAWnT,UAAU,wBACjB2P,KAAK,KACL6Y,kBAAkB,EAClB/Y,SAAU,SAACC,GAAD,OAAiB,EAAKlQ,WAAWipB,YAAY/Y,IACvD3N,YAAY,6BAChB,cAAC,OAAD,CAAM2R,OAAQ,GAAIC,KAAMA,EAAM3S,MAAOsnB,EAAWjpB,KAAM,CAAE4B,OAAQ,EAAKynB,YAAaroB,QAAS,EAAK6nB,sBA3B1G,iFACE,WAAW7oB,GAAX,SAAA+B,EAAA,sDACIC,KAAKC,SAASD,KAAKf,KAAMjB,GAD7B,gDADF,gFAKE,SAAoBwG,EAAYyM,GAAgB,IACtCrS,EAAe4F,EAAf5F,KAAMyG,EAASb,EAATa,KACZ,OAAO,eAAC,MAAD,CAAK1G,UAAU,aAAf,UACH,qBAAKA,UAAU,qBACf,8BAAMC,EAAO,IAAMyG,WAT7B,GAAkCnF,SCA5BonB,E,kDAGJ,WAAYC,GAAa,IAAD,8BACpB,eAAM,IAHVtiB,YAEwB,EAEpB,EAAKA,OAASsiB,EACd,EAAKC,UAAY,EAAK9Q,SAAW,GAHb,E,sFAMxB,WAA4B5W,EAAY2W,EAAgBC,GAAxD,IAAAlG,EAAA,+EAGsBnP,IAAdoV,IAAyBA,EAAY,GACrCjG,EAAI,CAAC,IAAM1Q,EAAMuO,IAAM,KAJ/B,kBAMsBrO,KAAKiF,OAAO5F,KAAKqD,MAAMzD,KAAK,gBAAiBuR,EAAGiG,EAAWC,GANjF,cAMU3T,EANV,yBAOaA,GAPb,mEAWa1B,GAXb,yD,qFAeA,SAAuBrD,GACnBgC,KAAKyW,eAAqBpV,IAATrD,EAAqB,EAAIA,EAAK2C,O,GAzBrBsmB,aA6BnB/hB,GAAb,2PASEkiB,YATF,uCASgB,WAAO/Y,GAAP,SAAAtO,EAAA,sDACZ,EAAKknB,UAAY,IAAIK,EAAJ,gBACjB,EAAKL,UAAUQ,MAAM,CAAEpZ,IAAKA,IAFhB,2CAThB,wDAeE0Y,YAfF,uCAegB,WAAO/oB,GAAP,SAAA+B,EAAA,sDACZ,EAAK2nB,WAAW1pB,GADJ,2CAfhB,wDAmBE8T,OAnBF,sBAmBW,sBAAA/R,EAAA,sEACD,EAAKknB,UAAUU,OADd,2CAnBX,0FAKE,WAAoB7nB,GAApB,SAAAC,EAAA,sDACEC,KAAKkE,UAAU0iB,GADjB,gDALF,4DAA4Bnd,KAA5B,uCACG1H,cADH,yEAC+C,IAAIulB,EAAoBtnB,SADvE,I,gCCnCA,yE","file":"static/js/main.bacd78fc.chunk.js","sourcesContent":["import * as React from 'react';\r\nimport { observer } from 'mobx-react-lite';\r\nimport { VPage, Page, FA, List, Form, ItemSchema, StringSchema, UiInputItem, UiSchema, Context, IdSchema, UiIdItem, LMR } from 'tonva';\r\nimport { CStockInfo } from './CStockInfo';\r\nimport { defaultBlackListTagName, defaultTagName } from '../UqApp';\r\n\r\nexport class VTags extends VPage<CStockInfo> {\r\n  async open(param?: any) {\r\n    this.openPage(this.page);\r\n  }\r\n\r\n  private onSelect = (item: any, isSelected: boolean, anySelected: boolean) => {\r\n    this.controller.onClickSelectTag(item, isSelected);\r\n  }\r\n\r\n  private onEditTag = (tag:any, e:React.MouseEvent) => {\r\n    e.preventDefault();\r\n    this.controller.onEditTag(tag);\r\n  }\r\n\r\n  private renderTag = (tag: any) => {\r\n    let left = <div className=\"px-3 py-2 cursor-pointer\">{tag.name}</div>;\r\n    let fdTag = tag.name === defaultBlackListTagName || tag.name === defaultTagName;\r\n    let right = fdTag ? '' : <div className=\"px-3 py-2 cursor-pointer\" onClick={(e)=>this.onEditTag(tag, e)}>编辑</div>;\r\n    return <LMR className=\"mx-3 my-2\" left={left} right={right}>\r\n    </LMR>;\r\n  }\r\n\r\n  private page = observer(() => {\r\n    let { selectedTags } = this.controller;\r\n    let { tags } = this.controller.cApp;\r\n    let divNewTag = tags.length >= 10 ? '' :\r\n      <div className=\"px-3 py-2 cursor-pointer\" onClick={this.controller.onNewTag}><FA name=\"plus\" className=\"text-primary\" /> &nbsp; 新建分组</div>;\r\n    return <Page header=\"选择分组\" headerClassName=\"bg-primary\">\r\n      {divNewTag}\r\n      <List items={tags} item={{ onSelect: this.onSelect, render: this.renderTag }} selectedItems={selectedTags} />\r\n    </Page>;\r\n  })\r\n}\r\n\r\nconst schema: ItemSchema[] = [\r\n  { name: 'name', type: 'string', required: true, maxLength: 10 } as StringSchema,\r\n  { name: 'id', type: 'id' } as IdSchema,\r\n  { name: 'submit', type: 'submit', },\r\n];\r\nconst uiSchema: UiSchema = {\r\n  items: {\r\n    name: { widget: 'text', label: null, placeholder: '分组名称' } as UiInputItem,\r\n    id: { widget: 'id', visible: false } as UiIdItem,\r\n    submit: { widget: 'button', label: '保存', className: 'btn btn-primary' },\r\n  }\r\n};\r\n\r\nexport class VNewTag extends VPage<CStockInfo> {\r\n  async open(param?: any) {\r\n    this.openPage(this.page);\r\n  }\r\n\r\n  private onFormButtonClick = async (name: string, context: Context) => {\r\n    if (await this.controller.onSaveNewTag(context.data)) {\r\n      this.controller.closePage();\r\n    }\r\n  }\r\n\r\n  private page = () => {\r\n    return <Page header=\"新建分组\" headerClassName=\"bg-primary\">\r\n      <div className=\"px-3 py-3\">\r\n        <Form schema={schema}\r\n          uiSchema={uiSchema}\r\n          formData={undefined}\r\n          onButtonClick={this.onFormButtonClick}\r\n        />\r\n      </div>\r\n    </Page>;\r\n  }\r\n}\r\n\r\nexport class VEditTag extends VPage<CStockInfo> {\r\n  async open(param?: any) {\r\n    this.openPage(this.page, param);\r\n  }\r\n\r\n  private onFormButtonClick = async (name: string, context: Context) => {\r\n    if (await this.controller.onSaveTag(context.data)) {\r\n      this.controller.closePage();\r\n    }\r\n  }\r\n\r\n  private page = (param?: any) => {\r\n    let {id, name} = param;\r\n    let fData = {id:id, name:name};\r\n    return <Page header=\"编辑分组\" headerClassName=\"bg-primary\">\r\n      <div className=\"px-3 py-3\">\r\n        <Form schema={schema}\r\n          uiSchema={uiSchema}\r\n          formData={fData}\r\n          onButtonClick={this.onFormButtonClick}\r\n        />\r\n      </div>\r\n    </Page>;\r\n  }\r\n}\r\n","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport { observable, IObservableArray, computed } from 'mobx';\r\nimport { nav } from 'tonva';\r\nimport { CUqBase } from '../UqApp';\r\nimport { GFunc } from '../tool/GFunc';\r\nimport { VStockInfo } from './VStockInfo'\r\nimport { NStockInfo, StockPrice, StockEarning, StockRoe, StockCapitalearning, StockBonus, StockDivideInfo } from './StockInfoType';\r\nimport { VTags, VNewTag, VEditTag } from './VTags';\r\nimport { ErForEarning, SlrForEarning } from 'regression';\r\nimport { CStock } from 'stock/CStock';\r\n\r\nexport class CStockInfo extends CUqBase {\r\n  @observable baseItem: NStockInfo;\r\n  @observable protected loaded: boolean = false;\r\n\r\n  @observable price: StockPrice;\r\n  //@observable roe: StockRoe;\r\n  //@observable tags: any[] = undefined;\r\n  @observable stockTags: any[];\r\n  selectedTags: any[];\r\n\r\n  protected exrightForEarning: {day:number, factor:number}[] = [];\r\n  protected exrightInfo: {day:number, bonus:number, factor:number, factore:number}[] = [];\r\n  @observable seasonData:{season:number, c:number, e:number, esum:number, corg:number, eorg:number, esumorg:number}[] = [];\r\n  @observable predictSeasonData:{season:number, c:number, e:number, esum:number, corg:number, eorg:number, esumorg:number}[] = [];\r\n  @observable predictSeasonDataFull:{season:number, c:number, e:number, esum:number, corg:number, eorg:number, esumorg:number}[] = [];\r\n  @observable predictData: { e:number, b: number, r2: number, epre:number, l:number, lr2:number, lpre:number};\r\n  @observable ypredict: number[] = [];\r\n  @observable historyData:{day:number, price:number, ttm:number}[] =  [];\r\n  protected historyDataOrg:{day:number, price:number, dayno:number}[] = [];\r\n\r\n  //protected _earning: IObservableArray<StockEarning> = observable.array<StockEarning>([], { deep: true });\r\n  protected _capitalearning: IObservableArray<StockCapitalearning> = observable.array<StockCapitalearning>([], { deep: true });\r\n  protected _bonus: IObservableArray<StockBonus> = observable.array<StockBonus>([], { deep: true });\r\n  protected _divideInfo: IObservableArray<StockDivideInfo> = observable.array<StockDivideInfo>([], { deep: true });\r\n\r\n  // @computed get earning(): IObservableArray<StockEarning> {\r\n  //   if (this.loaded === false) return undefined;\r\n  //   return this._earning;\r\n  // }\r\n\r\n  @computed get capitalearning(): IObservableArray<StockCapitalearning> {\r\n    if (this.loaded === false) return undefined;\r\n    return this._capitalearning;\r\n  }\r\n\r\n  @computed get bonus(): IObservableArray<StockBonus> {\r\n    if (this.loaded === false) return undefined;\r\n    return this._bonus;\r\n  }\r\n\r\n  @computed get divideInfo(): IObservableArray<StockDivideInfo> {\r\n    if (this.loaded === false) return undefined;\r\n    return this._divideInfo;\r\n  }\r\n\r\n  loadData = () => {\r\n    this.loading();\r\n  }\r\n\r\n  loading = async () => {\r\n    if (!this.baseItem)\r\n      return;\r\n    let { id, day } = this.baseItem;\r\n    let rets = await Promise.all([\r\n      this.cApp.miApi.query('q_stockallinfo', [id, day]),\r\n      this.cApp.miApi.query('t_tagstock$query', [this.user.id, undefined, id]) //this.uqs.mi.TagStock.query({ user: nav.user.id, stock: id })\r\n    ]);\r\n    this.stockTags = rets[1];\r\n    let ret = rets[0];\r\n    if (Array.isArray(ret[0])) {\r\n      let arr1 = ret[1];\r\n      if (Array.isArray(arr1)) {\r\n        this.price = arr1[0];\r\n      }\r\n\r\n      if (this._capitalearning.length > 0) {\r\n        this._capitalearning.clear();\r\n      }\r\n      let arr2 = ret[2];\r\n      if (Array.isArray(arr2)) {\r\n        this._capitalearning.push(...arr2);\r\n      }\r\n\r\n      this._bonus.clear();\r\n      let arr3 = ret[3];\r\n      if (Array.isArray(arr3)) {\r\n        this._bonus.push(...arr3);\r\n      }\r\n\r\n      this._divideInfo.clear();\r\n      let arr4 = ret[4];\r\n      if (Array.isArray(arr4)) {\r\n        this._divideInfo.push(...arr4);\r\n      }\r\n\r\n      this.exrightForEarning = ret[5];\r\n      await this.loadTTMEarning(ret[6]);\r\n      this.exrightInfo = ret[7];\r\n\r\n      this.historyDataOrg = ret[8];\r\n      this.LoadHistoryData(false);\r\n    }\r\n\r\n    this.loaded = true;\r\n  }\r\n\r\n  protected async loadTTMEarning(list: {seasonno:number, capital:number, earning:number, es:number}[]) {\r\n    this.seasonData.splice(0);\r\n    let seasonlist: {[index:number]:{season:number, c:number, e:number, esum:number, corg:number, eorg:number, esumorg:number}} = {};\r\n    let len = list.length;\r\n    if (len <= 0)\r\n      return;\r\n    let minNo = list[len - 1].seasonno;\r\n    let lastItem = list[0];\r\n    let maxNo = lastItem.seasonno;\r\n\r\n    let {end} = GFunc.SeasonnoToBeginEnd(maxNo);\r\n    for (let item of list) {\r\n      let no = item.seasonno;\r\n      let sItem = {season:no, c: item.capital, e: item.es, esum: item.earning, corg: item.capital, eorg: item.es, esumorg: item.earning}\r\n      this.ExrightEarning(end, no, sItem);\r\n      seasonlist[no] = sItem;\r\n    }\r\n\r\n    let i = 0;\r\n    let esum = 0;\r\n    for (let seasonno = minNo; seasonno <= maxNo; ++seasonno, ++i) {\r\n      let si = seasonlist[seasonno];\r\n      if (si === undefined) {\r\n        continue;\r\n      }\r\n      esum += si.e;\r\n      if (i < 3) {\r\n        si.esum = undefined;\r\n      }\r\n      else {\r\n        si.esum = esum;\r\n        let pastitem = seasonlist[seasonno-3];\r\n        if (pastitem !== undefined) {\r\n          esum -= pastitem.e;\r\n        }\r\n      }\r\n      this.seasonData.splice(0,0, si);\r\n    }\r\n\r\n    let noBegin = maxNo - 19;\r\n    this.predictData = undefined;\r\n    this.predictSeasonData.splice(0);\r\n    this.predictSeasonDataFull.splice(0);\r\n    if (noBegin < minNo)\r\n      return;\r\n    noBegin += 3;\r\n    this.ypredict = [];\r\n    for (let x = noBegin; x <= maxNo; x += 4) {\r\n      let item = seasonlist[x];\r\n      if (item === undefined)\r\n        break;\r\n      this.predictSeasonData.splice(0, 0, item);\r\n      this.ypredict.push(item.esum);\r\n    }\r\n\r\n    for (let x = maxNo; x >= minNo; x -= 4) {\r\n      let item = seasonlist[x];\r\n      if (item === undefined)\r\n        break;\r\n      this.predictSeasonDataFull.push(item);\r\n    }\r\n    if (this.ypredict.length === 5) {\r\n      let er = new ErForEarning(this.ypredict);\r\n      let lr = new SlrForEarning(this.ypredict);\r\n      this.predictData = {e:this.ypredict[4], b: er.B, r2: er.r2, epre: er.predict(4), l: lr.slopeR, lr2: lr.r2, lpre: lr.predict(4)};\r\n    }\r\n    else {\r\n      this.predictSeasonData.splice(0);\r\n    }\r\n  }\r\n\r\n  protected ExrightEarning(endDay:number, season:number, item:{c:number, e:number, esum:number}) {\r\n    let {end} = GFunc.SeasonnoToBeginEnd(season);\r\n    for (let i = 0; i < this.exrightForEarning.length; ++i) {\r\n      let exitem = this.exrightForEarning[i];\r\n      let day = exitem.day;\r\n      if (day > endDay)\r\n        break;\r\n      else if (day < end)\r\n        continue;\r\n      else {\r\n        let factor = exitem.factor;\r\n        item.c = item.c * factor;\r\n        item.e = item.e * factor;\r\n        item.esum = item.esum * factor;\r\n      }\r\n    }\r\n  }\r\n\r\n  LoadHistoryData(showAll:boolean) {\r\n    let list = this.historyDataOrg;\r\n    let length = list.length;\r\n    if (length <= 10) {\r\n      this.historyData = [];\r\n      return;\r\n    }\r\n    if (!showAll) {\r\n      let day = this.baseItem.day;\r\n      if (day !== undefined) {\r\n        let i = length - 1;\r\n        for (; i >= 0; --i) {\r\n          let item = list[i];\r\n          if (item.day <= day) {\r\n            break;\r\n          }\r\n        }\r\n        length = i + 1;\r\n      }\r\n    }\r\n    let endIndex = length - 1;\r\n    let lastItem = list[endIndex];\r\n    let lastdayno = lastItem.dayno;\r\n    if (lastdayno === undefined) {\r\n      while (endIndex > 0) {\r\n        --endIndex;\r\n        lastItem = list[endIndex];\r\n        lastdayno = lastItem.dayno;\r\n        if (lastdayno !== undefined)\r\n          break;\r\n      }\r\n    }\r\n    let lastDay = lastItem.day;\r\n    let not = lastdayno % 5;\r\n    let historyList: any[] = [];\r\n    for (let i = 0; i <= endIndex; ++i) {\r\n      let {day, price, dayno} = list[i];\r\n      if ( dayno % 5 === not) {\r\n        historyList.push({day:day, price:this.RestorePrice(price, day, lastDay), ttm:this.CalculateHistoryPE(price, day)});\r\n      }\r\n    }\r\n    this.historyData = historyList;\r\n  }\r\n\r\n  RestorePrice(price:number, dayFrom:number, dayIndex:number) {\r\n    let bsum = 0;\r\n    let pricere = price;\r\n    if (dayFrom < dayIndex) {\r\n      for (let i = 0; i < this.exrightInfo.length; ++i) {\r\n        let {day, bonus, factor, factore} = this.exrightInfo[i];\r\n        if (day <= dayFrom)\r\n          continue;\r\n        if (day > dayIndex)\r\n          break;\r\n        pricere = pricere * factor;\r\n        bsum = (bsum + bonus) * factore;\r\n      }\r\n      pricere = pricere - bsum;\r\n    }\r\n    else {\r\n      for (let i = 0; i < this.exrightInfo.length; ++i) {\r\n        let {day, bonus, factor, factore} = this.exrightInfo[i];\r\n        if (day <= dayIndex)\r\n          continue;\r\n        if (day > dayFrom)\r\n          break;\r\n        pricere = pricere / factor;\r\n        bsum = bsum / factore + bonus;\r\n      }\r\n      pricere = pricere + bsum;\r\n    }\r\n    return pricere;\r\n  }\r\n\r\n  CalculateHistoryPE(price:number, day:number) {\r\n    let season = GFunc.SeasonnoFromDay(day);\r\n    let len = this.seasonData.length;\r\n    for (let i = 0; i < len; ++i) {\r\n      let item = this.seasonData[i];\r\n      if (item.season >= season) {\r\n        continue;\r\n      }\r\n\r\n      if (item.esumorg === undefined)\r\n        return undefined;\r\n\r\n      let {end} = GFunc.SeasonnoToBeginEnd(item.season);\r\n      let pricere = this.RestorePrice(price, day, end);\r\n      return pricere / item.esumorg;\r\n    }\r\n\r\n    return undefined;\r\n  }\r\n\r\n  async internalStart(param: any) {\r\n    this.baseItem = param as NStockInfo;\r\n    this.loadData();\r\n    this.openVPage(VStockInfo);\r\n  }\r\n\r\n  openMetaView = () => {\r\n  }\r\n\r\n  onSelectTag = async () => {\r\n    //await this.loadTags();\r\n    this.selectedTags = this.cApp.tags.filter(v => {\r\n      let i = this.stockTags.findIndex(st => st.tag === v.id);\r\n      return i >= 0;\r\n    });\r\n    //await this.loadTags();\r\n    this.openVPage(VTags);\r\n  }\r\n\r\n  onNewTag = () => {\r\n    this.openVPage(VNewTag);\r\n  }\r\n\r\n  onEditTag = (param: any) => {\r\n    this.openVPage(VEditTag, param);\r\n  }\r\n\r\n  onSaveNewTag = async (data: any) => {\r\n    let { name } = data;\r\n    //let param = { id: undefined, name: name };\r\n    let ret = await this.cApp.miApi.call('t_tag$save', [this.user.id, undefined, name]);\r\n    let { retId } = ret;\r\n    if (retId < 0) {\r\n      alert(name + ' 已经被使用了');\r\n      return false;\r\n    }\r\n    this.cApp.tags.push({ id: retId, name: name });\r\n    return true;\r\n  }\r\n\r\n  onSaveTag = async (data: any) => {\r\n    let { id, name } = data;\r\n    let param = { id: id, name: name };\r\n    let i = this.cApp.tags.findIndex(v => v.id !== id && v.name === name);\r\n    if (i >= 0) {\r\n      alert(name + ' 已经被使用了');\r\n      return false;\r\n    }\r\n    let ret = await this.cApp.miApi.call('t_tag$save', [this.user.id, undefined, name]);\r\n    let { retId } = ret;\r\n    if (retId === undefined || retId < 0) {\r\n      alert(name + ' 已经被使用了');\r\n      return false;\r\n    }\r\n    i = this.cApp.tags.findIndex(v => v.id === id);\r\n    if (i >= 0) {\r\n      this.cApp.tags[i].name = name;\r\n    }\r\n    return true;\r\n  }\r\n\r\n  onClickSelectTag = async (tag: any, isSelected: boolean) => {\r\n    let param = {\r\n      user: nav.user.id,\r\n      tag: tag.id,\r\n      arr1: [\r\n        { stock: this.baseItem.id }\r\n      ]\r\n    };\r\n    if (isSelected === true) {\r\n      let ret = await this.cApp.miApi.call('t_tagstock$add', [this.user.id, tag.id, this.baseItem.id]); //.uqs.mi.TagStock.add(param);\r\n      let newTag = {\r\n        tag: {\r\n          id: tag.id,\r\n        }\r\n      }\r\n      this.stockTags.push(newTag);\r\n      await this.cApp.AddTagStockID(tag.id, this.baseItem.id);\r\n    }\r\n    else {\r\n      let ret = await this.cApp.miApi.call('t_tagstock$del', [this.user.id, tag.id, this.baseItem.id]); // //await this.uqs.mi.TagStock.del(param);\r\n      let i = this.stockTags.findIndex(v => v.tag.id === tag.id);\r\n      this.stockTags.splice(i, 1);\r\n      await this.cApp.RemoveTagStockID(tag.id, this.baseItem.id);\r\n    }\r\n  }\r\n\r\n  onClickDefaultTag = async (isSelected: boolean) => {\r\n    let tagid = this.cApp.defaultListTagID;\r\n    if (isSelected === true) {\r\n      let ret = await this.cApp.miApi.call('t_tagstock$add', [this.user.id, tagid, this.baseItem.id]); //.uqs.mi.TagStock.add(param);\r\n      let newTag = {\r\n        tag: {\r\n          id: tagid,\r\n        }\r\n      }\r\n      this.stockTags.push(newTag);\r\n      await this.cApp.AddTagStockID(tagid, this.baseItem.id);\r\n    }\r\n    else {\r\n      let ret = await this.cApp.miApi.call('t_tagstock$del', [this.user.id, tagid, this.baseItem.id]); // //await this.uqs.mi.TagStock.del(param);\r\n      let i = this.stockTags.findIndex(v => v.tag.id === tagid);\r\n      this.stockTags.splice(i, 1);\r\n      await this.cApp.RemoveTagStockID(tagid, this.baseItem.id);\r\n    }\r\n  }\r\n\r\n  showSelectStock = async (day:number): Promise<any> => {\r\n    let cStock = new CStock(this.cApp);\r\n    let item = await cStock.call() as any;\r\n    let b = {...item}\r\n    b.day = day;\r\n    this.baseItem = b;\r\n    this.loaded = false;\r\n    await this.loading();\r\n  }\r\n\r\n  changeDay = async (day:number) => {\r\n    if (this.baseItem.day === day)\r\n      return;\r\n    let {id, name, code, symbol} = this.baseItem;\r\n    let ni = {id:id, name:name, code:code, symbol:symbol, day:day ===0 ? undefined : day};\r\n    this.baseItem = ni;\r\n    this.loaded = false;\r\n    await this.loading();\r\n  }\r\n}\r\n","import React from 'react';\r\nimport { AppConfig, NavView, start } from 'tonva';\r\n//import logo from './logo.svg';\r\nimport './App.css';\r\nimport { CMiApp } from './UqApp';\r\n/*\r\nfunction App() {\r\n  return (\r\n    <div className=\"App\">\r\n      <header className=\"App-header\">\r\n        <img src={logo} className=\"App-logo\" alt=\"logo\" />\r\n        <p>\r\n          Edit <code>src/App.tsx</code> and save to reload.\r\n        </p>\r\n        <a\r\n          className=\"App-link\"\r\n          href=\"https://reactjs.org\"\r\n          target=\"_blank\"\r\n          rel=\"noopener noreferrer\"\r\n        >\r\n          Learn React\r\n        </a>\r\n      </header>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;\r\n*/\r\nconst appConfig:AppConfig = {\r\n\tappName: 'bruce/mifen',\r\n\tversion: '1.01',\r\n\ttvs: undefined, //TVs;\r\n\tuqNameMap: {}\r\n  };\r\n  \r\n  class App extends React.Component {\r\n  \r\n\tprivate onLogined = async () => {\r\n\t  await start(CMiApp, appConfig);\r\n\t}\r\n\tpublic render() {\r\n\t  return <NavView onLogined={this.onLogined} />\r\n\t}\r\n  }\r\n  \r\n  export default App;\r\n  ","import { ReportHandler } from 'web-vitals';\r\n\r\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\r\n  if (onPerfEntry && onPerfEntry instanceof Function) {\r\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\r\n      getCLS(onPerfEntry);\r\n      getFID(onPerfEntry);\r\n      getFCP(onPerfEntry);\r\n      getLCP(onPerfEntry);\r\n      getTTFB(onPerfEntry);\r\n    });\r\n  }\r\n};\r\n\r\nexport default reportWebVitals;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport 'bootstrap/dist/css/bootstrap.css';\r\nimport './index.css';\r\nimport App from './App';\r\nimport reportWebVitals from './reportWebVitals';\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n","export class SlrForEarning {\r\n  slope: number;\r\n  intercept: number;\r\n  y: number[];\r\n  slopeR: number;\r\n  endY: number;\r\n  r2: number;\r\n\r\n  constructor(y:number[]) {\r\n    this.y = y;\r\n    this.regress();\r\n    let score = this.score();\r\n    this.r2 = score.r2;\r\n  }\r\n\r\n  regress() {\r\n    const n = this.y.length;\r\n    let xSum = 0;\r\n    let ySum = 0;\r\n  \r\n    let xSquared = 0;\r\n    let xY = 0;\r\n  \r\n    for (let x = 0; x < n; ++x) {\r\n      xSum += x;\r\n      ySum += this.y[x];\r\n      xSquared += x * x;\r\n      xY += x * this.y[x];\r\n    }\r\n  \r\n    const numerator = n * xY - xSum * ySum;\r\n    this.slope = numerator / (n * xSquared - xSum * xSum);\r\n    this.intercept = (1 / n) * ySum - this.slope * (1 / n) * xSum;\r\n\r\n    let ym = this.slope > 0 ? this.predict(n-2) : this.predict(1);\r\n    this.slopeR = ym < 0.01 ? undefined : this.slope / ym;\r\n  }\r\n\r\n  score() {\r\n    const n = this.y.length;\r\n    const y2 = new Array(n);\r\n    for (let i = 0; i < n; i++) {\r\n      y2[i] = this.predict(i);\r\n    }\r\n\r\n    let xSum = 0;\r\n    let ySum = 0;\r\n    let chi2 = 0;\r\n    let rmsd = 0;\r\n    let xSquared = 0;\r\n    let ySquared = 0;\r\n    let xY = 0;\r\n    for (let i = 0; i < n; i++) {\r\n      let yi2 = y2[i];\r\n      xSum += yi2;\r\n      let yi = this.y[i];\r\n      ySum += yi;\r\n      xSquared += yi2 * yi2;\r\n      ySquared += yi * yi;\r\n      xY += yi2 * yi;\r\n      let yiyi2 = yi - yi2;\r\n      if (yi !== 0) {\r\n        chi2 += (yiyi2 * yiyi2) / yi;\r\n      }\r\n      rmsd += yiyi2 * yiyi2;\r\n    }\r\n\r\n    const r =\r\n      (n * xY - xSum * ySum) /\r\n      Math.sqrt((n * xSquared - xSum * xSum) * (n * ySquared - ySum * ySum));\r\n\r\n    return {\r\n      r: r,\r\n      r2: r * r,\r\n      chi2: chi2,\r\n      rmsd: Math.sqrt(rmsd / n)\r\n    };\r\n  }\r\n\r\n\r\n  predict(x:number) {\r\n    return this.slope * x + this.intercept;\r\n  }\r\n\r\n  computeX(y:number) {\r\n    return (y - this.intercept) / this.slope;\r\n  }\r\n}\r\n","export class ErForEarning {\r\n  A:number;\r\n  B:number;\r\n  y: number[];\r\n  r2: number;\r\n\r\n  constructor(y:number[]) {\r\n    this.y = y;\r\n    this.regress();\r\n    let score = this.score();\r\n    this.r2 = score.r2;\r\n  }\r\n\r\n  regress() {\r\n    const n = this.y.length;\r\n    let xSum = 0;\r\n    let ySum = 0;\r\n  \r\n    let xSquared = 0;\r\n    let xY = 0;\r\n  \r\n    for (let x = 0; x < n; ++x) {\r\n      xSum += x;\r\n      let yx = Math.log(this.y[x]);\r\n      ySum += yx;\r\n      xSquared += x * x;\r\n      xY += x * yx;\r\n    }\r\n  \r\n    const numerator = n * xY - xSum * ySum;\r\n    let slope = numerator / (n * xSquared - xSum * xSum);\r\n    let intercept = (1 / n) * ySum - slope * (1 / n) * xSum;\r\n    this.A = Math.exp(intercept);\r\n    this.B = slope;\r\n  }\r\n\r\n  score() {\r\n    const n = this.y.length;\r\n    const y2 = new Array(n);\r\n    for (let i = 0; i < n; i++) {\r\n      y2[i] = this.predict(i);\r\n    }\r\n\r\n    let xSum = 0;\r\n    let ySum = 0;\r\n    let chi2 = 0;\r\n    let rmsd = 0;\r\n    let xSquared = 0;\r\n    let ySquared = 0;\r\n    let xY = 0;\r\n    for (let i = 0; i < n; i++) {\r\n      let yi2 = y2[i];\r\n      xSum += yi2;\r\n      let yi = this.y[i];\r\n      ySum += yi;\r\n      xSquared += yi2 * yi2;\r\n      ySquared += yi * yi;\r\n      xY += yi2 * yi;\r\n      let yiyi2 = yi - yi2;\r\n      if (yi !== 0) {\r\n        chi2 += (yiyi2 * yiyi2) / yi;\r\n      }\r\n      rmsd += yiyi2 * yiyi2;\r\n    }\r\n\r\n    const r =\r\n      (n * xY - xSum * ySum) /\r\n      Math.sqrt((n * xSquared - xSum * xSum) * (n * ySquared - ySum * ySum));\r\n\r\n    return {\r\n      r: r,\r\n      r2: r * r,\r\n      chi2: chi2,\r\n      rmsd: Math.sqrt(rmsd / n)\r\n    };\r\n  }\r\n\r\n  predict(x:number) {\r\n    return this.A * Math.exp(x * this.B);\r\n  }\r\n}\r\n","//=== UqApp builder created on Mon Feb 15 2021 23:34:19 GMT-0500 (GMT-05:00) ===//\r\nimport { CSub, CBase, CAppBase, IConstructor } from 'tonva';\r\n//import { UQs } from './uqs';\r\n//import { CApp } from './CApp';\r\n\r\nexport abstract class CUqBase extends CBase {\r\n}\r\n\r\nexport abstract class CUqSub extends CSub<any> {\r\n}\r\n\r\nexport abstract class CUqApp extends CAppBase {\r\n\tprotected newC<T extends CUqBase>(type: IConstructor<T>): T {\r\n\t\tlet c = new type(this);\r\n\t\tc.init();\r\n\t\treturn c;\r\n\t}\r\n}\r\n","export const consts = {\r\n    uqBasedata: \"bruce/mi\",\r\n    appIcon: 'https://tv.jkchemical.com/imgs/Bear-icon.png',\r\n    miApiHost: 'https://note.jjol.cn/',\r\n    miApiHostDebug: 'http://localhost:6010/',\r\n    isDevelopment: process.env.NODE_ENV === 'development',\r\n}","export default __webpack_public_path__ + \"static/media/logo.2d27ead7.svg\";","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport * as React from 'react';\r\nimport { View, nav } from 'tonva';\r\nimport { LMR, FA, SearchBox } from 'tonva';\r\nimport logo from '../images/logo.svg';\r\nimport { CHome } from './CHome';\r\n\r\nexport class VSiteHeader extends View<CHome> {\r\n    render() {\r\n        let currentSalesRegion = <FA name=\"globe\" />\r\n        let login = <div>\r\n            登录\r\n        </div>\r\n        let left = <img className=\"m-1\" src={logo} alt=\"logo\" style={{height: \"3rem\", width: \"3rem\"}} />;\r\n        //let cart = this.controller.cApp.cCart.renderCartLabel();\r\n        let right = undefined;\r\n        /*\r\n        <div className=\"d-flex flex-row mr-1 align-items-center\">\r\n            {currentSalesRegion} &nbsp;\r\n            <button onClick={()=>nav.start()}>Try</button>\r\n        </div>;*/\r\n        return <LMR\r\n            className=\"mb-3 align-items-center bg-white\"\r\n            left={left} right={right}>\r\n            <div className=\"\">\r\n                {this.controller.renderSearchHeader('md')}\r\n            </div>\r\n        </LMR>\r\n    }\r\n}","import * as React from 'react';\r\nimport { View } from 'tonva';\r\nimport { CHome } from './CHome';\r\nimport { SearchBox } from 'tonva';\r\n\r\nexport class VSearchHeader extends View<CHome> {\r\n\r\n    private onSearch = async (key: string) => {\r\n        // let { cProduct } = this.controller.cApp;\r\n        // cProduct.start(key);\r\n    }\r\n\r\n    render(param: any) {\r\n        return <SearchBox className=\"px-1 w-100\" \r\n            size={param}\r\n            onSearch={this.onSearch} \r\n            placeholder=\"功能...\" />\r\n    }\r\n}","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport * as React from 'react';\r\nimport { FA, LMR } from 'tonva';\r\nimport { NStockInfo } from '../stockinfo';\r\nimport {percent0, percent1, number, numberToMarketValue, calculateZZ3} from '../tool';\r\n\r\nfunction renderSortCol(type:string, caption:string, sort: (sortType:string) => void, checked:boolean = false) {\r\n\treturn <label className=\"btn btn-outline-info mb-0\">\r\n\t\t<input type=\"radio\" className=\"btn-sm btn-check mr-1\"\r\n\t\t\tname=\"btnradio\" defaultChecked={checked}\r\n\t\t\tonClick={() => sort(type)} />\r\n\t\t{caption}\r\n\t</label>\r\n}\r\n\r\nexport function renderSortHeaders(sort: (sortType:string) => void) {\r\n\treturn <div className=\"my-1 justify-content-end mr-3\">\r\n\t\t<div className=\"btn-group\" role=\"group\" aria-label=\"Basic radio toggle button group\">\r\n\t\t\t{renderSortCol('tagv', '米息率', sort, true)}\r\n\t\t\t{renderSortCol('tagpe', 'TTM', sort)}\r\n\t\t\t{renderSortCol('tagdp', '股息率', sort)}\r\n\t\t</div>\r\n\t</div>;\r\n}\r\n\r\nfunction renderValue(caption:string, value:number, valueType:'p0'|'p1'|'n1'|'n2'|'yi'):JSX.Element {\r\n\tconst _cn = 'px-2 mb-2 text-right '; \r\n\tlet cn = _cn + 'c5';\r\n\tlet cnYI = _cn + 'c5'\r\n\tlet vStr:string;\r\n\tswitch (valueType) {\r\n\t\tcase 'p0': vStr = percent0(value); break;\r\n\t\tcase 'p1': vStr = percent1(value); break;\r\n\t\tcase 'n1': vStr = number(value, 1); break;\r\n\t\tcase 'n2': vStr = number(value, 2); break;\r\n\t\tcase 'yi': \r\n\t\t\tvStr = numberToMarketValue(value);\r\n\t\t\tcn = cnYI;\r\n\t\t\tbreak;\r\n\t}\r\n\treturn <div key={caption} className={cn}>\r\n\t\t<span className=\"text-muted small\">{caption}</span><br />\r\n\t\t{vStr}\r\n\t</div>;\r\n}\r\n\r\nexport function renderStockInfoRow(row: NStockInfo, onClickName: (row:NStockInfo) => void, right:JSX.Element):JSX.Element {\r\n  \tlet { id, name, code, pe, roe, price, divyield, v, order, symbol, l, e, ep, e3, total } = row;\r\n  \tlet zzl = calculateZZ3((row as any).dataArr);\r\n  \tlet left = <div className=\"cursor-pointer\" onClick={()=>onClickName(row)}>\r\n\t\t<span className=\"text-primary\">{name}</span>\r\n\t\t&nbsp; \r\n\t\t<span className=\"text-info\">{code}</span>\r\n\t  \t&nbsp;\r\n\t\t<span className=\"small ml-5\">{order}</span>\r\n  \t</div>;\r\n\tlet rows:[string,number,'p0'|'p1'|'n1'|'n2'|'yi'][] = [\r\n\t\t['米息率', v, 'n1'],\r\n\t\t['TTM', pe, 'n1'],\r\n\t\t['股息率', divyield*100, 'n1'],\r\n\t\t['价格', price, 'n2'],\r\n\t\t['ROE', roe*100, 'n1'],\r\n\t\t['增1', zzl[0], 'p0'],\r\n\t\t['增2', zzl[1], 'p0'],\r\n\t\t['增3', zzl[2], 'p0'],\r\n\t\t['增4', zzl[3], 'p0'],\r\n\t\t['预增', l, 'p0'],\r\n\t\t['市值', total*price, 'yi'],\r\n  \t];\r\n  \treturn <div className=\"d-block\">\r\n\t\t<LMR className=\"px-1 py-1\" left={left} right = {right} />\r\n\t\t<div className=\"d-flex flex-wrap\" >\r\n\t\t\t{rows.map(v => renderValue(v[0], v[1], v[2]))}\r\n\t  \t</div>\r\n  \t</div>;\r\n}\r\n","export function numberToFixString(n: number, w = 2) {\r\n    return n === undefined ? '' : n.toFixed(w);\r\n}\r\n\r\nexport function number(n: number, w=2) {\r\n\treturn n === undefined ? '' : n.toFixed(w);\r\n}\r\n\r\nexport function numberToMarketValue(n: number) {\r\n\treturn n === undefined || isNaN(n) ? '' : Math.round(n/10000).toString(); // + '亿';\r\n}\r\n\r\nexport function numberToString(n: number, precision = 2) {\r\n\treturn n === undefined ? '' : n.toPrecision(precision);\r\n}\r\n\r\nexport function numberToPrecision(n: number, precision = 4) {\r\n\treturn n === undefined ? undefined : Number.parseFloat(n.toPrecision(precision));\r\n}\r\n\r\nexport function percentToFixString(n: number) {\r\n\treturn n === undefined || isNaN(n) ? '' : (n * 100).toFixed(2) + '%';\r\n}\r\n\r\nexport function percent0(n: number) {\r\n\treturn n === undefined || isNaN(n) ? '' : (n * 100).toFixed(0) + '%';\r\n}\r\nexport function percent1(n: number) {\r\n\treturn n === undefined || isNaN(n) ? '' : (n * 100).toFixed(1) + '%';\r\n}\r\n\r\nexport function warningTypeString(t: string) {\r\n\tswitch (t) {\r\n\t\tcase 'gt': return '大于';\r\n\t\tcase 'lt': return '小于';\r\n\t\tdefault: return t;\r\n\t}\r\n}\r\n\r\nexport function predictCutRatio(r2:number) {\r\n\treturn r2 * 2 - r2 * r2;\r\n}\r\n\r\nexport function evaluatePricePrice(iRate:number, e1:number, e2:number, e3:number) {\r\n\tlet r = 1 + iRate;\r\n\tlet r2 = r * r;\r\n\tlet r3 = r2 * r;\r\n\treturn (e1/r + e2 /r2 + e3 / r3 + e3 / iRate / r3) / 2;\r\n}\r\n\r\nexport function calculateV(z:number, divyield:number, pe:number) {\r\n\tif (pe === undefined || isNaN(pe)) {\r\n\t\treturn undefined;\r\n\t}\r\n\r\n\tlet r = 0;\r\n\tif (z !== undefined) {\r\n\t\tif (z > 0.25) {\r\n\t\tz = 0.25;\r\n\t\t}\r\n\t\tr += z * 100;\r\n\t}\r\n\tif (divyield !== undefined) {\r\n\t\tr += divyield * 100;\r\n\t}\r\n\treturn r / pe;\r\n}\r\n\r\nexport function calculateVN(z:number, e:number, bonus:number, price:number) {\r\n\tif (price === undefined || isNaN(price) || e === undefined || isNaN(e)) {\r\n\t\treturn undefined;\r\n\t}\r\n\r\n\tlet r = 0;\r\n\tif (z !== undefined && e > 0) {\r\n\t\tif (z > 0.25) {\r\n\t\tz = 0.24 + Math.pow((z-0.24)*100, 0.6667) / 100;\r\n\t\t}\r\n\t\tz = 1 + z;\r\n\t\tz = z * z * z - 1;\r\n\t\tr += z * e * 100;\r\n\t}\r\n\tif (bonus !== undefined && !isNaN(bonus)) {\r\n\t\tr += bonus * 100;\r\n\t}\r\n\treturn r / price;\r\n}\r\n\r\nexport function calculateZZ3(data:number[]) {\r\n\tlet ret:number[] = [undefined, undefined, undefined, undefined] ;\r\n\tif (data === undefined)\r\n\t\treturn ret;\r\n\tlet len = data.length;\r\n\tif (len < 5)\r\n\t\treturn ret;\r\n\r\n\tlet funcz = (n:number, p:number) => {\r\n\t\tif (p <= 0 || n <= 0)\r\n\t\treturn undefined;\r\n\t\treturn ((n / p) - 1);\r\n\t}\r\n\tfor (let i = 0; i < 4; ++i) {\r\n\t\tret[i] = funcz(data[i+1], data[i]);\r\n\t}\r\n\treturn ret;\r\n}\r\n\r\n//export function caption = (value:string) => <span className=\"text-muted small\">{value}</span>;\r\n\r\nexport function MonthnoFromDay(day:number) {\r\n\tlet year = Math.floor(day/10000);\r\n\tlet month = Math.floor((day%10000)/100) - 1;\r\n\treturn (year-1995)*12+month;\r\n}\r\n\r\nexport function SeasonnoFromDay(day:number) {\r\n\tlet year = Math.floor(day/10000);\r\n\tlet month = Math.floor((day%10000)/100) - 1;\r\n\tlet season = Math.floor(month / 3);\r\n\treturn (year-1995)*4 + season;\r\n}\r\n\r\nexport function SeasonnoFromYearMonth(year:number, month:number) {\r\n\tlet season = Math.floor((month-1) / 3);\r\n\treturn (year-1995)*4 + season;\r\n}\r\n\r\nexport function SeasonnoToYearMonth(no: number) {\r\n\tlet year = Math.floor(no / 4) + 1995;\r\n\tlet month = (Math.floor(no % 4) + 1) * 3;\r\n\treturn year * 100 + month;\r\n}\r\n\r\nexport function SeasonnoToBeginEnd(season:number) {\r\n\tlet year = (1995 + Math.floor(season / 4)) * 10000;\r\n\tlet s = season % 4;\r\n\tif (s === 0) {\r\n\t\treturn {begin: year + 101, end: year + 331};\r\n\t} \r\n\tif (s === 1) {\r\n\t\treturn {begin: year + 401, end: year + 630};\r\n\t}\r\n\tif (s === 2) {\r\n\t\treturn {begin: year + 701, end: year + 930};\r\n\t}\r\n\treturn {begin: year + 1001, end: year + 1231};\r\n}\r\n\r\nexport function CalculatePredictAvg(arr: {predictpe:number}[]) {\r\n\tlet ret : {avg20:number, avg50:number, avg100:number} = {avg20:undefined, avg50:undefined, avg100:undefined};\r\n\r\n\tlet length = arr.length;\r\n\tlet calcuOne = (count:number) : number => {\r\n\t\tlet endIndex = count;\r\n\t\tif (endIndex > length)\r\n\t\tendIndex = length;\r\n\t\tif (endIndex >= 10) {\r\n\t\tlet sum = 0;\r\n\t\tfor (let i = 3; i < endIndex; ++i) {\r\n\t\t\tsum += arr[i].predictpe\r\n\t\t}\r\n\t\treturn sum / (endIndex - 3);\r\n\t\t}\r\n\t\telse {\r\n\t\treturn undefined;\r\n\t\t}\r\n\t}\r\n\r\n\tret.avg20 = calcuOne(20);\r\n\tret.avg50 = calcuOne(50);\r\n\tret.avg100 = calcuOne(100);\r\n\treturn ret;\r\n}\r\n\r\nexport function CalculateValueAvg(arr: {v:number}[]) {\r\n\tlet ret : {avg20:number, avg50:number, avg100:number, avg:number} = {avg20:undefined, avg50:undefined, avg100:undefined, avg:undefined};\r\n\r\n\tlet length = arr.length;\r\n\tlet calcuOne = (count:number) : number => {\r\n\t\tlet endIndex = count;\r\n\t\tif (count === 0 || endIndex > length)\r\n\t\tendIndex = length;\r\n\t\tif (endIndex >= 10) {\r\n\t\tlet sum = 0;\r\n\t\tfor (let i = 3; i < endIndex; ++i) {\r\n\t\t\tsum += arr[i].v;\r\n\t\t}\r\n\t\treturn sum / (endIndex - 3);\r\n\t\t}\r\n\t\telse {\r\n\t\treturn undefined;\r\n\t\t}\r\n\t}\r\n\r\n\tret.avg20 = calcuOne(20);\r\n\tret.avg50 = calcuOne(50);\r\n\tret.avg100 = calcuOne(100);\r\n\tret.avg = calcuOne(0);\r\n\treturn ret;\r\n}\r\n","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport * as React from 'react';\r\nimport { observer } from 'mobx-react';\r\nimport { VPage, Page, View, List, LMR, FA, Scroller } from 'tonva';\r\nimport { NStockInfo } from '../stockinfo';\r\nimport { CHome } from './CHome';\r\nimport { renderSortHeaders, renderStockInfoRow } from '../tool';\r\n\r\nexport class VHome extends VPage<CHome> {\r\n\r\n/*\r\n  render(param: any): JSX.Element {\r\n    return <this.page />\r\n  }\r\n\r\n  private page = observer(() => {\r\n    let { openMetaView, onPage } = this.controller;\r\n    // let viewMetaButton = <></>;\r\n    // if (this.controller.isLogined) {\r\n    //   viewMetaButton = <button type=\"button\" className=\"btn w-100\" onClick={openMetaView}>view</button>\r\n    // }\r\n\tlet right = ;\r\n\r\n    return <Page header=\"首页\" right={right} onScrollBottom={onPage}\r\n      headerClassName='bg-primary py-1 px-3'>      \r\n      <this.content />\r\n    </Page>;\r\n  })\r\n*/\r\n  header() {return '首页'}\r\n  right() {\r\n\treturn <button className=\"btn btn-sm btn-info\"\r\n\t\tonClick={()=>{this.controller.openMarketPE()}}>\r\n\t\t市场平均PE\r\n\t</button>;\r\n  }\r\n\r\n  protected onPageScrollBottom(scroller: Scroller): Promise<void> {\r\n\tthis.controller.onPage();\r\n\treturn;\r\n  }\r\n\r\n  private setSortType = (type:string) => {\r\n    this.controller.setSortType(type);\r\n  }\r\n\r\n  content() {\r\n\tlet V = observer(() => {\r\n\t\tlet title = this.controller.cApp.config.tagName;\r\n\t\tlet { items } = this.controller;\r\n\t\tlet { onSelectTag, onAddStock } = this.controller;\r\n\t\tlet right = <div className=\"d-flex\">\r\n\t\t\t<div className=\"btn cursor-pointer\" onClick={onAddStock}><FA name=\"plus\" inverse={false} /></div>\r\n\t\t\t<div className=\"btn cursor-pointer ml-2\" onClick={onSelectTag}><FA name=\"bars\" inverse={false} /></div>\r\n\t\t</div>;\r\n\t\tlet left = <div className=\"align-self-center\">{title}</div>\r\n\t\treturn <div>\r\n\t\t<LMR className=\"px-3 py-1\" left={left} right={right}></LMR>\r\n\t\t<List header={renderSortHeaders(this.setSortType)}\r\n\t\t\titems={items}\r\n\t\t\titem={{ render: this.renderRow, key: this.rowKey }}\r\n\t\t\tbefore={'搜索'}\r\n\t\t\tnone={'----'}\r\n\t\t/>\r\n\t\t</div>;\r\n\t});\r\n\treturn <V />;\r\n  }\r\n\r\n  renderRow = (item: any, index: number): JSX.Element => <this.rowContent {...item} />;\r\n  protected rowContent = (row: any): JSX.Element => {\r\n    let { symbol } = row as NStockInfo;\r\n    let right = <div className=\"d-flex\">\r\n        <a className=\"px-3 text-info\" href={`https://finance.sina.com.cn/realstock/company/${symbol}/nc.shtml`} target=\"_blank\" rel=\"noopener noreferrer\" onClick={(e)=>{e.stopPropagation();}}>新浪财经</a>\r\n      </div>;\r\n\treturn renderStockInfoRow(row, this.onClickName, right);\r\n  }\r\n\r\n  private rowKey = (item: any) => {\r\n    let { id } = item;\r\n    return id;\r\n  }\r\n\r\n  protected onClickName = (item: NStockInfo) => {\r\n    this.controller.openStockInfo(item);\r\n  }\r\n\r\n  protected onSelected = async (item: any): Promise<void> => {\r\n    let a = 0;\r\n  }\r\n\r\n  private callOnSelected(item: any) {\r\n    if (this.onSelected === undefined) {\r\n      alert('onSelect is undefined');\r\n      return;\r\n    }\r\n    this.onSelected(item);\r\n  }\r\n  clickRow = (item: any) => {\r\n    this.callOnSelected(item);\r\n  }\r\n}","import * as React from 'react';\r\nimport { observer } from 'mobx-react-lite';\r\nimport { VPage, Page, List } from 'tonva';\r\nimport { CHome } from './CHome';\r\n\r\nexport class VSelectTag extends VPage<CHome> {\r\n    async open(param?: any) {\r\n        this.openPage(this.page);\r\n    }\r\n\r\n    private renderTag = (tag:any) => {\r\n        return <div className=\"px-3 py-2 cursor-pointer\">{tag.name}</div>;\r\n    }\r\n\r\n    private page = observer(() => {\r\n        let {tags} = this.controller.cApp;\r\n        let { onClickTag } = this.controller;\r\n        return <Page header=\"选择分组\" headerClassName=\"bg-primary\">\r\n            <List items={tags} item={{onClick:onClickTag, render:this.renderTag}} />\r\n        </Page>;\r\n    })\r\n}\r\n","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport * as React from 'react';\r\nimport classNames from 'classnames';\r\nimport { VPage, Page, View, List, LMR, left0, FA } from 'tonva';\r\nimport { observable } from 'mobx';\r\nimport { observer } from 'mobx-react';\r\nimport RC2 from 'react-chartjs2'\r\nimport { GFunc } from '../tool/GFunc';\r\nimport {CMarketPE } from './CMarketPE'\r\n\r\nexport class VMarketPE extends VPage<CMarketPE> {\r\n  private input: HTMLInputElement;\r\n  private key: string = undefined;\r\n\r\n  async open(param?: any) {\r\n    this.openPage(this.page);\r\n  }\r\n\r\n  render(param: any): JSX.Element {\r\n    return <this.page />\r\n  }\r\n\r\n  checkLimitShow = (e)=> {\r\n    let check = e.target.checked as boolean;\r\n    let f = check ? 1:0;\r\n    this.controller.onLongShortFlag(f);\r\n  }\r\n\r\n  private page = observer(() => {\r\n  let head = <div >{''}</div>\r\n    return <Page header={head}\r\n      headerClassName='bg-primary'>\r\n      <this.pageContent />\r\n    </Page>;\r\n  })\r\n\r\n  private pageContent = observer(() => {\r\n    return <>\r\n      <this.historyChart />\r\n    </>\r\n  });\r\n\r\n  protected historyChart = observer(() => {\r\n    let {historyData} = this.controller;\r\n    if (historyData === undefined) \r\n      return <></>;\r\n    let chartHistory = <></>;\r\n    let labelList:any[] = [];\r\n    let peList:number[] = [];\r\n    let eList:number[] = [];\r\n    for (let item of historyData) {\r\n      let {day, pe, e} = item;\r\n      labelList.push(day);\r\n      peList.push(GFunc.numberToPrecision(pe, 4));\r\n      eList.push(e);\r\n    }\r\n    let chartdata1 = {\r\n      labels: labelList,\r\n      datasets: [\r\n        {\r\n          label: 'PE',\r\n          data: peList,\r\n          borderColor:'blue',\r\n          backgroundColor:'skyBlue',\r\n          borderWidth: 1,\r\n          fill: false,\r\n          yAxisID: 'y-axis-1',\r\n        },\r\n        {\r\n          label: 'e',\r\n          data: eList,\r\n          borderColor:'red',\r\n          backgroundColor:'pink',\r\n          borderWidth: 1,\r\n          fill: false,\r\n          yAxisID: 'y-axis-2',\r\n        }\r\n      ]\r\n    };\r\n    let options = {\r\n      scales:{\r\n        yAxes: [{\r\n          type: 'linear',\r\n          display: true,\r\n          position: 'right',\r\n          id: 'y-axis-1',\r\n        }, {\r\n          type: 'linear',\r\n          display: true,\r\n          position: 'left',\r\n          id: 'y-axis-2',\r\n          gridLines: {\r\n              drawOnChartArea: false\r\n          }\r\n        }],    \r\n      }\r\n    }\r\n    chartHistory = <RC2 data={chartdata1} type='line' options={options} />;\r\n    let right = <></>;\r\n    right = <label className=\"px-3\"> <input type=\"checkbox\" name=\"selectType\" defaultChecked={false}\r\n    onChange={this.checkLimitShow} />长期</label>;\r\n    return <><LMR className=\"px-3 py-2 bg-white\" left={'市场PE历史走势'} right={right}></LMR>\r\n      <div className=\"px-3\" style={{width:'95%'}}>{chartHistory}</div>\r\n    </>;\r\n  });\r\n\r\n\r\n}","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport { observable } from 'mobx';\r\nimport { CUqBase } from '../UqApp';\r\nimport { VMarketPE } from './VMarketPE';\r\n\r\nexport class CMarketPE extends CUqBase {\r\n    @observable historyData:{day:number, pe:number, e:number}[] =  [];\r\n    private longshortFlag:number = 0;\r\n\r\n    async internalStart(param: any) {\r\n        this.loadData();\r\n        this.openVPage(VMarketPE as any);\r\n    }\r\n\r\n    loadData = async () => {\r\n        let dt = new Date();\r\n        let param = [dt.getFullYear()*10000+(dt.getMonth()+1)*100+dt.getDate(), 750, this.longshortFlag];\r\n        let rets = await this.cApp.miApi.query('q_marketpe', param) as {day:number, pe:number, e:number}[];\r\n        this.historyData = rets.reverse();\r\n    }\r\n\r\n    onLongShortFlag(f:number) {\r\n        if (f === this.longshortFlag)\r\n            return;\r\n        this.longshortFlag = f;\r\n        this.loadData();\r\n    }\r\n}","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport * as React from 'react';\r\nimport { observable, IObservableArray, autorun } from 'mobx';\r\nimport { ErForEarning, SlrForEarning } from 'regression';\r\nimport { UserTag } from '../types';\r\nimport { CUqBase } from '../UqApp';\r\nimport { CStockInfo, NStockInfo } from '../stockinfo';\r\nimport { VSiteHeader } from './VSiteHeader';\r\nimport { VSearchHeader } from './VSearchHeader';\r\nimport { VHome } from './VHome';\r\nimport { VSelectTag } from './VSelectTag';\r\nimport { GFunc } from 'tool/GFunc';\r\nimport { CMarketPE } from './CMarketPE';\r\nimport { CStock } from 'stock';\r\n\r\nexport class CHome extends CUqBase {\r\n  //PageItems: HomePageItems = new HomePageItems(this);\r\n  items: IObservableArray<any> = observable.array<any>([], { deep: true });\r\n  userTag: UserTag;\r\n  protected oldSortType: string;\r\n  @observable warnings: any[] = [];\r\n\r\n  disposeAutorun = autorun(async () => {\r\n    let needLoad = false;\r\n    let oldID = this.userTag && this.userTag.tagID;\r\n    this.userTag = { tagName: this.cApp.config.tagName, tagID: this.cApp.tagID };\r\n    if (oldID !== this.userTag.tagID) {\r\n      needLoad = true;\r\n    }\r\n\r\n    let newSortType = this.cApp.config.userStock.sortType;\r\n    if (this.oldSortType === undefined) {\r\n      this.oldSortType = newSortType;\r\n    }\r\n    else if (this.oldSortType !== newSortType) {\r\n      this.oldSortType = newSortType;\r\n      needLoad = true;\r\n    }\r\n\r\n    if (needLoad) {\r\n      await this.load();\r\n    }\r\n  });\r\n\r\n  public AddTagStockID(tagid: number, stockID: number) {\r\n    if (this.userTag && this.userTag.tagID === tagid) {\r\n      this.load();\r\n    }\r\n  }\r\n\r\n  public RemoveTagStockID(tagid: number, stockID: number) {\r\n    if (this.userTag && this.userTag.tagID === tagid) {\r\n      //this.PageItems.RemoveStock(stockID);\r\n      let i = this.items.findIndex(v=>{return v.id === stockID})\r\n     if (i >= 0) {\r\n       this.items.splice(i, 1);\r\n     }\r\n    }\r\n  }\r\n\r\n\r\n  onSelectTag = async () => {\r\n    this.openVPage(VSelectTag);\r\n  }\r\n\r\n  onAddStock = async () => {\r\n    let cStock = new CStock(this.cApp);\r\n    let r = await cStock.call() as {id:number};\r\n\r\n    if (r !== undefined) {\r\n      let id = r.id;\r\n      if (id > 0) {\r\n        let tagid = this.cApp.defaultListTagID;\r\n        await this.cApp.miApi.call('t_tagstock$add', [this.user.id, tagid, id]);\r\n        await this.cApp.AddTagStockID(tagid, id);\r\n        await this.load();\r\n      }\r\n    }\r\n  }\r\n\r\n  onClickTag = async (item:any) => {\r\n    await this.cApp.selectTag(item);\r\n    this.closePage();\r\n  }\r\n\r\n  onPage = async () => {\r\n    //this.PageItems.more();\r\n  }\r\n\r\n  onWarningConfg = () => {\r\n    this.cApp.cWarning.onWarningConfg();\r\n  }\r\n\r\n\r\n  // async searchMain(key: any) {\r\n  //   if (key !== undefined) await this.PageItems.first(key);\r\n  // }\r\n\r\n  //作为tabs中的首页，internalStart不会被调用\r\n  async internalStart(param: any) {\r\n  }\r\n\r\n  async load() {\r\n    let tagID = this.cApp.tagID;\r\n    if (tagID > 0) {\r\n      await this.loadItems();\r\n    }\r\n  }\r\n\r\n  async loadItems() {\r\n    let queryName = 'taguser';\r\n\r\n    let query = {\r\n      name: queryName,\r\n      pageStart: 0,\r\n      pageSize: 1000,\r\n      user: this.user.id,\r\n      tag: this.cApp.tagID,\r\n      yearlen: 1,\r\n    };\r\n    let result = await this.cApp.miApi.process(query, []);\r\n    if (Array.isArray(result) === false) {\r\n      return;\r\n    };\r\n    let arr = result as {id:number, order:number, data?:string, v?:number, e:number, e3:number, ep:number, price:number, exprice:number, divyield:number, r2:number, lr2:number, predictpe?:number, dataArr?:number[]}[];\r\n    for (let item of arr) {\r\n      let dataArray = JSON.parse(item.data) as number[];\r\n      item.dataArr = dataArray;\r\n      let sl = new SlrForEarning(dataArray);\r\n      item.ep = (sl.predict(4) + item.e) / 2;\r\n      item.e3 = sl.predict(7);\r\n      item.v = GFunc.calculateVN(sl.slopeR, item.ep, item.divyield * item.price, item.exprice);\r\n      item.predictpe = item.price / item.e3;\r\n    }\r\n    this.cApp.sortStocks(arr);\r\n    this.items.clear();\r\n    this.items.push(...arr);\r\n  }\r\n\r\n  setSortType = (type:string) => {\r\n    this.cApp.setUserSortType(type);\r\n    let arr = this.items.slice();\r\n    this.cApp.sortStocks(arr);\r\n\r\n    this.items.replace(arr);\r\n  }\r\n\r\n  async loadWarning() {\r\n    let r = await this.cApp.miApi.query('q_warnings', [this.cApp.user.id]);\r\n    if (r !== undefined && Array.isArray(r)) {\r\n      this.warnings = r;\r\n    }\r\n    else {\r\n      if (this.warnings.length > 0) {\r\n        this.warnings = [];\r\n      }\r\n    }\r\n  }\r\n\r\n  renderSiteHeader = () => {\r\n    return this.renderView(VSiteHeader);\r\n  }\r\n\r\n  renderSearchHeader = (size?: string) => {\r\n    return this.renderView(VSearchHeader, size);\r\n  }\r\n\r\n\r\n  renderHome = () => {\r\n    return this.renderView(VHome);\r\n  }\r\n\r\n  openMetaView = () => {\r\n  }\r\n\r\n  tab = () => <this.renderHome />;\r\n\r\n  openStockInfo = (item: NStockInfo) => {\r\n    let cStockInfo = this.newC(CStockInfo);\r\n    cStockInfo.start(item);\r\n  }\r\n\r\n  openMarketPE = () => {\r\n    let cm = this.newC(CMarketPE);\r\n    cm.start();\r\n  }\r\n}","import {FetchError} from './fetchError';\r\nimport {HttpChannelUI} from './httpChannelUI';\r\nimport {nav} from 'tonva';\r\nimport { consts } from '../UqApp';\r\n\r\nexport async function httpGet(url:string, params?:any):Promise<any> {\r\n    let channel = new HttpChannel(url, undefined, undefined);\r\n    let ret = await channel.get('', params);\r\n    return ret;\r\n}\r\n\r\nexport async function httpPost(url:string, params?:any):Promise<any> {\r\n    let channel = new HttpChannel(url, undefined, undefined);\r\n    let ret = await channel.post('', params);\r\n    return ret;\r\n}\r\n\r\nexport class HttpChannel {\r\n    private hostUrl: string;\r\n    private apiToken: string;\r\n    private ui?: HttpChannelUI;\r\n    private timeout: number;\r\n\r\n    constructor(hostUrl: string, apiToken:string, ui?: HttpChannelUI) {\r\n        this.hostUrl = hostUrl;\r\n        this.apiToken = apiToken;\r\n        this.ui = ui;\r\n        this.timeout = consts.isDevelopment === true? 500000:20000;\r\n    }\r\n\r\n    private startWait = () => {\r\n        if (this.ui !== undefined) this.ui.startWait();\r\n    }\r\n\r\n    private endWait = (url?:string, reject?:(reason?:any)=>void) => {\r\n        if (this.ui !== undefined) this.ui.endWait();\r\n        if (reject !== undefined) reject('访问webapi超时 ' + url);\r\n    }\r\n\r\n    private showError = async (error:FetchError) => {\r\n        if (this.ui !== undefined) await this.ui.showError(error);\r\n    }\r\n\r\n    used() {\r\n        this.post('', {});\r\n    }\r\n\r\n    async get(url: string, params: any = undefined): Promise<any> {\r\n        if (params) {\r\n            let keys = Object.keys(params);\r\n            if (keys.length > 0) {\r\n                let c = '?';\r\n                for (let k of keys) {\r\n                    let v = params[k];\r\n                    if (v === undefined) continue;\r\n                    url += c + k + '=' + params[k];\r\n                    c = '&';\r\n                }\r\n            }\r\n        }\r\n        let options = this.buildOptions();\r\n        options.method = 'GET';\r\n        return await this.innerFetch(url, options);\r\n    }\r\n\r\n    async post(url: string, params: any): Promise<any> {\r\n        let options = this.buildOptions();\r\n        options.method = 'POST';\r\n        options.body = JSON.stringify(params);\r\n        return await this.innerFetch(url, options);\r\n    }\r\n\r\n    async put(url: string, params: any): Promise<any> {\r\n        let options = this.buildOptions();\r\n        options.method = 'PUT';\r\n        options.body = JSON.stringify(params);\r\n        return await this.innerFetch(url, options);\r\n    }\r\n\r\n    async delete(url: string, params: any): Promise<any> {\r\n        let options = this.buildOptions();\r\n        options.method = 'DELETE';\r\n        options.body = JSON.stringify(params);\r\n        return await this.innerFetch(url, options);\r\n    }\r\n    async fetch(url: string, options: any, resolve:(value?:any)=>any, reject:(reason?:any)=>void):Promise<void> {\r\n        let that = this;\r\n        this.startWait();\r\n        let path = url;\r\n        function buildError(err: string) {\r\n            return {\r\n                channel: that,\r\n                url: path,\r\n                options: options,\r\n                resolve: resolve,\r\n                reject: reject,\r\n                error: err,\r\n            }\r\n        }\r\n        try {\r\n            console.log('%s %s', options.method, path);\r\n            let timeOutHandler = setTimeout(() => that.endWait(url, reject), this.timeout);\r\n            let res = await fetch(encodeURI(path), options);\r\n            if (res.ok === false) {\r\n                clearTimeout(timeOutHandler);\r\n                that.endWait();\r\n                console.log('call error %s', res.statusText);\r\n                throw res.statusText;\r\n            }\r\n            let ct = res.headers.get('content-type');\r\n            if (ct && ct.indexOf('json')>=0) {\r\n                return res.json().then(async retJson => {\r\n                    clearTimeout(timeOutHandler);\r\n                    that.endWait();\r\n                    if (retJson.ok === true) {\r\n                        return resolve(retJson.res);\r\n                    }\r\n                    if (retJson.error === undefined) {\r\n                        await that.showError(buildError('not valid tonva json'));\r\n                    }\r\n                    else {\r\n                        await that.showError(buildError(retJson.error));\r\n                        reject(retJson.error);\r\n                    }\r\n                    //throw retJson.error;\r\n                }).catch(async error => {\r\n                    await that.showError(buildError(error.message));\r\n                });\r\n            }\r\n            else {\r\n                let text = await res.text();\r\n                clearTimeout(timeOutHandler);\r\n                that.endWait();\r\n                resolve(text);\r\n            }\r\n        }\r\n        catch(error) {\r\n            if (typeof error === 'string') {\r\n                if (error.toLowerCase().startsWith('unauthorized') === true) {\r\n                    nav.logout();\r\n                    return;\r\n                }\r\n            }\r\n            await this.showError(buildError(error.message));\r\n        };\r\n    }\r\n\r\n    private async innerFetch(url: string, options: any): Promise<any> {\r\n        let u = this.hostUrl + url;\r\n        return await new Promise<any>(async (resolve, reject) => {\r\n            await this.fetch(u, options, resolve, reject);\r\n        });\r\n    }\r\n\r\n    async callFetch(url:string, method:string, body:any):Promise<any> {\r\n        let options = this.buildOptions();\r\n        options.method = method;\r\n        options.body = body;\r\n        return await new Promise<any>(async (resolve, reject) => {\r\n            await this.fetch(url, options, resolve, reject);\r\n        });\r\n    }\r\n\r\n    private buildOptions(): any {\r\n        let {language, culture} = nav;\r\n        let headers = new Headers();\r\n        //headers.append('Access-Control-Allow-Origin', '*');\r\n        headers.append('Content-Type', 'application/json;charset=UTF-8');\r\n        let lang = language;\r\n        if (culture) lang += '-' + culture;\r\n        headers.append('Accept-Language', lang);\r\n        if (this.apiToken) { \r\n            headers.append('Authorization', this.apiToken); \r\n        }\r\n        let options = {\r\n            headers: headers,\r\n            // cache: 'no-cache',\r\n        };\r\n        return options;\r\n    }\r\n}\r\n","import {nav} from 'tonva';\r\n\r\nexport interface HttpChannelUI {\r\n    startWait():void;\r\n    endWait():void;\r\n    showError(error:any):Promise<void>;\r\n}\r\n\r\nexport class HttpChannelNavUI implements HttpChannelUI {\r\n    startWait() {\r\n        nav.startWait();\r\n    }\r\n    endWait() {\r\n        nav.endWait();\r\n    }\r\n    async showError(error:any):Promise<void> {\r\n        nav.endWait();\r\n        /*\r\n        if (error.name === 'SyntaxError') {\r\n            error = {\r\n                name: error.name,\r\n                message: error.message,\r\n            }\r\n        }*/\r\n        await nav.onError(error);\r\n    }\r\n}\r\n\r\n","//import {isDevelopment} from '../local';\r\nimport {HttpChannel} from './httpChannel';\r\n\r\nexport async function refetchApi(channel:HttpChannel, url, options, resolve, reject) {\r\n    await channel.fetch(url, options, resolve, reject);\r\n}\r\n\r\nexport abstract class ApiBase {\r\n    protected token: string;\r\n    protected path: string;\r\n    protected showWaiting: boolean;\r\n\r\n    constructor(path: string, showWaiting: boolean) {\r\n        this.path = path || '';\r\n        this.showWaiting = showWaiting;\r\n    }\r\n\r\n    protected abstract getHttpChannel(): Promise<HttpChannel>;\r\n\r\n    public async call(url:string, method:string, body:any):Promise<any> {\r\n        let channel = await this.getHttpChannel();\r\n        return await channel.callFetch(url, method, body);\r\n    }\r\n\r\n    public async get(path:string, params:any=undefined): Promise<any> {\r\n        let channel = await this.getHttpChannel();\r\n        return await channel.get(this.path + path, params);\r\n    }\r\n\r\n    public async post(path:string, params:any): Promise<any> {\r\n        let channel = await this.getHttpChannel();\r\n        return await channel.post(this.path + path, params);\r\n    }\r\n\r\n    public async put(path:string, params:any): Promise<any> {\r\n        let channel = await this.getHttpChannel();\r\n        return await channel.put(this.path + path, params);\r\n    }\r\n\r\n    public async delete(path:string, params:any): Promise<any> {\r\n        let channel = await this.getHttpChannel();\r\n        return await channel.delete(this.path + path, params);\r\n    }\r\n}\r\n","import _ from 'lodash';\r\nimport { HttpChannel } from './httpChannel';\r\nimport { HttpChannelNavUI } from './httpChannelUI';\r\nimport { ApiBase } from './apiBase';\r\n\r\nlet channelUIs: { [name: string]: HttpChannel } = {};\r\nlet channelNoUIs: { [name: string]: HttpChannel } = {};\r\n\r\nclass MiApiChannel extends ApiBase {\r\n  private apiName: string;\r\n  url: string;\r\n\r\n  constructor(url: string, basePath: string, apiName: string, uqToken: string, showWaiting?: boolean) {\r\n    super(basePath, showWaiting);\r\n    this.showWaiting = showWaiting;\r\n    this.apiName = apiName;\r\n    this.token = uqToken;\r\n    this.url = url;\r\n  }\r\n\r\n  protected async getHttpChannel(): Promise<HttpChannel> {\r\n    let channels: { [name: string]: HttpChannel };\r\n    let channelUI: HttpChannelNavUI;\r\n    if (this.showWaiting === true || this.showWaiting === undefined) {\r\n      channels = channelUIs;\r\n      channelUI = new HttpChannelNavUI();\r\n    }\r\n    else {\r\n      channels = channelNoUIs;\r\n    }\r\n    let channel = channels[this.apiName];\r\n    if (channel !== undefined) return channel;\r\n    channel = new HttpChannel(this.url, this.token, channelUI);\r\n    return channels[this.apiName] = channel;\r\n  }\r\n}\r\n\r\nexport class MiApi {\r\n  private channel: MiApiChannel;\r\n\r\n  constructor(url: string, basePath: string, apiName: string, uqToken: string, showWaiting?: boolean) {\r\n    this.channel = new MiApiChannel(url, basePath, apiName, uqToken, showWaiting);\r\n  }\r\n\r\n  async call(name: string, params: any[]): Promise<any> {\r\n    let pbody = { call: name, params: params };\r\n    return await this.channel.post('sql/call', pbody);\r\n  }\r\n\r\n  async query(name: string, params: any[]): Promise<any> {\r\n    let pbody = { call: name, params: params };\r\n    return await this.channel.post('sql/call', pbody);\r\n  }\r\n\r\n  async page(name: string, params: any[], pageStart: number, pageSize: number): Promise<any> {\r\n    let p: any[];\r\n    switch (typeof params) {\r\n      case 'undefined': p = []; break;\r\n      default: p = _.clone(params); break;\r\n    }\r\n    p.push(pageStart);\r\n    p.push(pageSize);\r\n    let pbody = { call: name, params: p };\r\n    return await this.channel.post('sql/call', pbody);\r\n  }\r\n\r\n  async process(proc: any, params: any[]): Promise<any> {\r\n    let pbody = { proc: proc, params: params };\r\n    return await this.channel.post('sql/query', pbody);\r\n  }\r\n}\r\n","import * as React from 'react';\r\nimport Loadable from 'react-loadable';\r\nimport { Loading } from 'tonva';\r\n\r\nexport const meTab = () => {\r\n    let LoadableComponent = Loadable({\r\n        loader: () => import('./tab'),\r\n        loading: Loading\r\n    });\r\n    return <LoadableComponent />;\r\n}\r\n","import * as React from 'react';\r\nimport { VPage, TabCaptionComponent, Page, TabProp } from 'tonva';\r\nimport { CMiApp } from '../UqApp';\r\nimport { meTab } from '../me';\r\n\r\nconst color = (selected: boolean) => selected === true ? 'text-primary' : 'text-muted';\r\n\r\nexport class VHome extends VPage<CMiApp> {\r\n  async open(param?: any) {\r\n    this.openPage(this.render);\r\n  }\r\n  render = (param?: any): JSX.Element => {\r\n    let { cHome, cExporer } = this.controller;\r\n    let tabs: TabProp[] = [\r\n      { name: 'home', label: '首页', icon: 'home', content: cHome.tab, notify: undefined, load: async () => { await cHome.load() }, onShown: async () => { await cHome.load() } },\r\n      { name: 'explorer', label: '选股', icon: 'search', content: cExporer.tab, load: async () => { await cExporer.load() } },\r\n      { name: 'me', label: '我的', icon: 'user', content: meTab, onShown: undefined }\r\n    ].map(v => {\r\n      let { name, label, icon, content, notify, load, onShown } = v;\r\n      return {\r\n        name: name,\r\n        caption: (selected: boolean) => TabCaptionComponent(label, icon, color(selected)),\r\n        content: content,\r\n        notify: notify,\r\n        load: load,\r\n        onShown: onShown\r\n      }\r\n    });\r\n    return <Page header={false} tabsProps={{tabs}} />\r\n  }\r\n}\r\n","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport * as React from 'react';\r\nimport { View, nav } from 'tonva';\r\nimport { LMR, FA, SearchBox } from 'tonva';\r\nimport logo from '../images/logo.svg';\r\nimport { CExplorer } from './CExplorer';\r\n\r\nexport class VSiteHeader extends View<CExplorer> {\r\n    render() {\r\n        let currentSalesRegion = <FA name=\"globe\" />\r\n        let login = <div>\r\n            登录\r\n        </div>\r\n        let left = <img className=\"m-1\" src={logo} alt=\"logo\" style={{height: \"3rem\", width: \"3rem\"}} />;\r\n        //let cart = this.controller.cApp.cCart.renderCartLabel();\r\n        let right = undefined;\r\n        /*\r\n        <div className=\"d-flex flex-row mr-1 align-items-center\">\r\n            {currentSalesRegion} &nbsp;\r\n            <button onClick={()=>nav.start()}>Try</button>\r\n        </div>;*/\r\n        return <LMR\r\n            className=\"mb-3 align-items-center bg-white\"\r\n            left={left} right={right}>\r\n            <div className=\"\">\r\n                {this.controller.renderSiteHeader()}\r\n            </div>\r\n        </LMR>\r\n    }\r\n}","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport * as React from 'react';\r\nimport { observer } from 'mobx-react';\r\nimport { VPage, List, LMR, FA, Scroller } from 'tonva';\r\nimport { NStockInfo } from '../stockinfo';\r\nimport { GFunc } from '../tool/GFunc';\r\nimport { CExplorer } from './CExplorer';\r\nimport { PredictHistoryParam } from 'predicthistory/CPredictHistory';\r\nimport { renderSortHeaders, renderStockInfoRow } from '../tool';\r\n\r\nexport class VExplorer extends VPage<CExplorer> {\r\n/*\r\n  render(param: any): JSX.Element {\r\n    return <this.page />\r\n  }\r\n\r\n  private page = observer(() => {\r\n    let { openMetaView, onPage } = this.controller;\r\n    let viewMetaButton = <></>;\r\n    if (this.controller.isLogined) {\r\n      viewMetaButton = <button type=\"button\" className=\"btn w-100\" onClick={openMetaView}>view</button>\r\n    }\r\n    let { onConfig, reload } = this.controller;\r\n    let right = <div className=\"btn align-self-center cursor-pointer \" onClick={onConfig}><FA name=\"cog\" size=\"lg\" inverse={true} /></div>\r\n    return <Page header=\"股票发现\"  onScrollBottom={onPage} right={right}\r\n      headerClassName='bg-primary py-1 px-3'>\r\n      \r\n      <this.content />\r\n    </Page>;\r\n  })\r\n*/\r\n  header() {return '股票发现'}\r\n  protected onPageScrollBottom(scroller: Scroller): Promise<void> {\r\n\tthis.controller.onPage();\r\n\treturn;\r\n  }\r\n\r\n  right() {\r\n    let { onConfig } = this.controller;\r\n\treturn <div className=\"btn align-self-center cursor-pointer \" onClick={onConfig}><FA name=\"cog\" size=\"lg\" inverse={true} /></div>\r\n  }\r\n\r\n  private onClickPredictAVG = () => {\r\n    let {avgs, lastTradeDay} = this.controller;\r\n    let param: PredictHistoryParam = {\r\n      day:undefined,\r\n      priceDay:lastTradeDay,\r\n      avg20:avgs.avg20,\r\n      avg50:avgs.avg50,\r\n      avg100:avgs.avg100,\r\n      avg:avgs.avg,\r\n    }\r\n    this.controller.cApp.openPredictAVG(param);\r\n  }\r\n\r\n  content() {\r\n\tlet V = observer(() => {\r\n\t\tlet {items, avgs, reload} = this.controller;\r\n\t\tlet avgHead: JSX.Element;\r\n\t\tlet right = <div>\r\n\t\t<div className=\"btn cursor-pointer py-3\" onClick={reload}>刷新</div>\r\n\t\t</div>\r\n\t\tif (avgs.avg20 !== undefined || avgs.avg50 !== undefined || avgs.avg100 !== undefined) {\r\n\t\tlet avgStr = ' top20 : ' + GFunc.numberToFixString(avgs.avg20) \r\n\t\t\t+ '  -  top50 : ' + GFunc.numberToFixString(avgs.avg50)\r\n\t\t\t+ '  -  top100 : ' + GFunc.numberToFixString(avgs.avg100)\r\n\t\t\t+ '  -  all : ' + GFunc.numberToFixString(avgs.avg)\r\n\t\t\t+ '  ...查看历史走势';\r\n\t\tavgHead = <LMR right={right}><div className=\"px-3 cursor-pointer\" onClick={this.onClickPredictAVG}>{GFunc.caption('价值指数均值')}{avgStr}</div></LMR>\r\n\t\t}\r\n\t\telse {\r\n\t\tavgHead = <LMR right={right}></LMR>\r\n\t\t}\r\n\t\t\r\n\t\treturn <>\r\n\t\t{avgHead}\r\n\t\t<List header={renderSortHeaders(this.setSortType)}\r\n\t\t\titems={items}\r\n\t\t\titem={{ render: this.renderRow, key: this.rowKey }}\r\n\t\t\tbefore={'选股'}\r\n\t\t/>\r\n\t\t</>\r\n\t});\r\n\treturn <V />;\r\n  }\r\n\r\n  renderRow = (item: any, index: number): JSX.Element => <this.rowContent {...item} />;\r\n  protected rowContent = observer((row: any): JSX.Element => {\r\n    let blackList = this.controller.cApp.blackList;\r\n    let fInBlack = blackList.findIndex(v=>v===id);\r\n    if (fInBlack >= 0) return null;\r\n\r\n    let { id, symbol } = row as NStockInfo;\r\n    let labelId = 'vexl_' + id;\r\n\tlet defList = this.controller.cApp.defaultList;\r\n\tlet fInDef = defList.findIndex(v=>v===id);\r\n\tlet right = <div className=\"d-flex\">\r\n\t\t<label className=\"px-2\">\r\n\t\t\t<input className=\"mr-1\" type=\"checkbox\" value=\"\" id={labelId}\r\n\t\t\tdefaultChecked={fInDef >= 0}\r\n\t\t\tonChange={e => this.onSelect(row, e.target.checked)}/>\r\n\t\t\t<small className=\"text-muted\">自选</small>\r\n\t\t</label>\r\n\t\t<a className=\"px-3 text-info\" \r\n\t\t\thref={`https://finance.sina.com.cn/realstock/company/${symbol}/nc.shtml`} \r\n\t\t\ttarget=\"_blank\" \r\n\t\t\trel=\"noopener noreferrer\" onClick={(e)=>{e.stopPropagation();}}>新浪财经</a>\r\n\t</div>;\r\n\treturn renderStockInfoRow(row, this.onClickName, right);\r\n  });\r\n\r\n  private rowKey = (item: any) => {\r\n    if (item.item !== undefined) {\r\n      return item.item.id;\r\n    }\r\n    let { id } = item;\r\n    return id;\r\n  }\r\n\r\n  private setSortType = (type:string) => {\r\n    this.controller.setSortType(type);\r\n  }\r\n\r\n  protected onClickName = (item: NStockInfo) => {\r\n    this.controller.openStockInfo(item);\r\n  }\r\n\r\n  protected onSelect = async (item: any, isSelected:boolean): Promise<void> => {\r\n    this.controller.onSelectItem(item, isSelected);\r\n  }\r\n\r\n  protected onClickItem = async (item: any): Promise<void> => {\r\n    this.controller.openStockInfo(item);\r\n  }\r\n}","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport * as React from 'react';\r\nimport { observer } from 'mobx-react';\r\nimport { VPage, Page, FA, List, Form, ItemSchema, StringSchema, UiInputItem, UiSchema, Context, IdSchema, UiIdItem, LMR, UiSelect, UiTextItem } from 'tonva';\r\nimport { CExplorer } from './CExplorer';\r\n\r\nconst schema: ItemSchema[] = [\r\n  { name: 'irate', type: 'number', required: true},\r\n  { name: 'bmin', type: 'number', required: true},\r\n  { name: 'bmax', type: 'number', required: true},\r\n  { name: 'r2', type: 'number', required: true},\r\n  { name: 'lmin', type: 'number', required: true},\r\n  { name: 'lmax', type: 'number', required: true},\r\n  { name: 'lr2', type: 'number', required: true},\r\n  { name: 'mcount', type: 'integer', required: true},\r\n  { name: 'lr4', type: 'number', required: true},\r\n  { name: 'r210', type: 'number', required: true},\r\n  { name: 'submit', type: 'submit', },\r\n];\r\n\r\nconst uiSchema: UiSchema = {\r\n  items: {\r\n    irate: { widget: 'number', label: '无风险收益率', placeholder: '0.04'} as UiInputItem,\r\n    bmin: { widget: 'number', label: '指数回归最小值', placeholder: '0.00'} as UiInputItem,\r\n    bmax: { widget: 'number', label: '指数回归最大值', placeholder: '0.00'} as UiInputItem,\r\n    r2: { widget: 'number', label: '指数回归R2', placeholder: '0.00'} as UiInputItem,\r\n    lmin: { widget: 'number', label: '线性回归最小值', placeholder: '0.00'} as UiInputItem,\r\n    lmax: { widget: 'number', label: '线性回归最大值', placeholder: '0.00'} as UiInputItem,\r\n    lr2: { widget: 'number', label: '线性回归R2', placeholder: '0.00'} as UiInputItem,\r\n    lr4: { widget: 'number', label: '末年与前4年均值最大比值', placeholder: '0.00'} as UiInputItem,\r\n    mcount: { widget: 'number', label: '5年内单季亏损最多允许出现次数', placeholder: '0.00'} as UiInputItem,\r\n    r210: { widget: 'number', label: '十年回归R2', placeholder: '0.00'} as UiInputItem,\r\n    submit: { widget: 'button', label: '保存', className: 'btn btn-primary' },\r\n  }\r\n};\r\n\r\n\r\nexport class VExplorerCfg extends VPage<CExplorer> {\r\n  async open(param?: any) {\r\n    this.openPage(this.page);\r\n  }\r\n\r\n  sortChage = (e)=> {\r\n    let newType = e.target.value;\r\n\r\n    this.controller.cApp.setStockSortType(newType);\r\n  }\r\n\r\n  selectChange = (e)=> {\r\n    let newType = e.target.value;\r\n\r\n    this.controller.cApp.setStockSelectType(newType);\r\n  }\r\n\r\n  onChange = (e) => {\r\n    let {name, value} = e.target;\r\n  }\r\n\r\n  private onFormButtonClick = async (name: string, context: Context) => {\r\n    //await this.controller.onSaveNewWarning(context.data);\r\n    let {bmin, bmax, r2, lmin, lmax, lr2, mcount, lr4, r210, irate} = context.data;\r\n    let cfg = {bmin:bmin, bmax:bmax, r2:r2, lmin:lmin, lmax:lmax, lr2:lr2, mcount:mcount, lr4:lr4, r210:r210, irate:irate};\r\n    await this.controller.cApp.setRegressionConfig(cfg);\r\n    this.controller.closePage();\r\n  }\r\n\r\n\r\n  private page = observer(() => {\r\n    let scfg = this.controller.cApp.findStockConfg;\r\n    //let findType = scfg.sortType;\r\n    // let selectType = scfg.selectType;\r\n    // if (selectType === undefined) {\r\n    //   selectType = 'all';\r\n    // }\r\n    let fData = this.controller.cApp.config.regression;\r\n    if (fData.irate === undefined)\r\n      fData.irate = 0.04;\r\n\r\n    return <Page header=\"选股设置\" headerClassName=\"bg-primary\">\r\n      {/* <div className=\"px-3 py-2\">方法</div>\r\n      <div className=\"px-3 py-2 d-flex flex-wrap\">\r\n        <label className=\"px-3 c8\"> <input type=\"radio\" name=\"selectType\" value=\"all\" checked={selectType===\"all\"}\r\n          onChange={this.selectChange} />预期PE</label><br />\r\n        <label className=\"px-3 c8\"> <input type=\"radio\" name=\"selectType\" value=\"value\" checked={selectType===\"value\"}\r\n          onChange={this.selectChange} />价值指数</label><br />\r\n      </div> */}\r\n      <div className=\"px-3 py-2\">回归参数</div>\r\n      <Form schema={schema}\r\n          uiSchema={uiSchema}\r\n          formData={fData}\r\n          onButtonClick={this.onFormButtonClick}\r\n        />\r\n    </Page>;\r\n  })\r\n}\r\n","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport { observable, IObservableArray, computed } from 'mobx';\r\nimport * as React from 'react';\r\nimport { autorun } from 'mobx';\r\nimport { ErForEarning, SlrForEarning } from 'regression';\r\nimport { CUqBase } from '../UqApp';\r\nimport { CStockInfo, NStockInfo } from '../stockinfo';\r\nimport { VSiteHeader } from './VSiteHeader';\r\nimport { VExplorer } from './VExplorer';\r\nimport { VExplorerCfg } from './VExplorerCfg';\r\nimport { GFunc } from 'tool/GFunc';\r\n\r\nexport class CExplorer extends CUqBase {\r\n  items: IObservableArray<any> = observable.array<any>([], { deep: true });\r\n  @observable avgs : {avg20?:number, avg50?:number, avg100?:number, avg?:number} = {};\r\n  lastTradeDay: number;\r\n  protected oldSelectType: string;\r\n  selectedItems: any[] = [];\r\n\r\n  disposeAutorun = autorun(async () => {\r\n    let newSelectType = this.cApp.config.stockFind.selectType;\r\n    if (newSelectType === this.oldSelectType)\r\n      return;\r\n    if (this.oldSelectType === undefined) {\r\n      this.oldSelectType = newSelectType;\r\n      return;\r\n    }\r\n    this.oldSelectType = newSelectType;\r\n    await this.load();\r\n  });\r\n\r\n  onPage = async () => {\r\n    //this.PageItems.more();\r\n  }\r\n\r\n  onConfig = async () => {\r\n    this.openVPage(VExplorerCfg);\r\n  }\r\n\r\n  async internalStart(param: any) {\r\n  }\r\n\r\n  reload = async () => {\r\n    await this.load();\r\n  }\r\n\r\n  async load() {\r\n    this.selectedItems = [];\r\n    await this.loadItems();\r\n  }\r\n\r\n  async loadItems() {\r\n    let queryName = 'all';\r\n    //let sName = this.cApp.config.stockFind.selectType;\r\n    let {bmin, bmax, r2, lmin, lmax, lr2, mcount, lr4, r210, irate} = this.cApp.config.regression;\r\n    //if (sName !== undefined)\r\n    //  queryName = sName;\r\n    let query = {\r\n      name: queryName,\r\n      pageStart: 0,\r\n      pageSize: 3000,\r\n      user: this.user.id,\r\n      blackID:this.cApp.blackListTagID,\r\n      bMin: bmin,\r\n      bMax: bmax,\r\n      r2: r2,\r\n      lMin: lmin,\r\n      lMax: lmax,\r\n      lr2: lr2,\r\n      mcount: mcount,\r\n      lr4: lr4,\r\n      r210: r210,\r\n    };\r\n    let rets = await Promise.all([this.cApp.miApi.process(query, []),\r\n                                  this.cApp.miApi.call('q_getlasttradeday', [])\r\n      ]);\r\n    let lastDayRet = rets[1] as {day:number}[];\r\n    if (Array.isArray(lastDayRet) && lastDayRet.length > 0) {\r\n      this.lastTradeDay = lastDayRet[0].day;\r\n    }\r\n    else {\r\n      this.lastTradeDay = undefined;\r\n    }\r\n    let result = rets[0];\r\n    if (Array.isArray(result) === false) {\r\n      return;\r\n    };\r\n    let arr = result as {id:number, data?:string, v:number, pe:number, e:number, ep:number, price:number, exprice:number, divyield:number, r2:number, lr2:number, e3:number, predictpe:number, order:number, ma:number, dataArr?:number[]}[];\r\n    for (let item of arr) {\r\n      let dataArray = JSON.parse(item.data) as number[];\r\n      item.dataArr = dataArray;\r\n      let sl = new SlrForEarning(dataArray);\r\n      //let ep = GFunc.evaluatePricePrice(irate, sl.predict(5), sl.predict(6), sl.predict(7));\r\n      item.ep = (sl.predict(4) + item.e) / 2;\r\n      item.v = GFunc.calculateVN(sl.slopeR, item.ep, item.divyield * item.price, item.exprice);\r\n      item.e3 = sl.predict(7);\r\n    }\r\n    if (queryName === 'all') {\r\n      this.cApp.sortStocks(arr);\r\n      this.avgs = GFunc.CalculateValueAvg(arr);\r\n    }\r\n    else {\r\n      this.avgs = {};\r\n    }\r\n    this.items.clear();\r\n    this.items.push(...arr);\r\n  }\r\n\r\n  onSelectItem = async (item:any, isSelected:boolean) => {\r\n    let tagid = this.cApp.defaultListTagID;\r\n    if (isSelected === true) {\r\n      await this.cApp.miApi.call('t_tagstock$add', [this.user.id, tagid, item.id]);\r\n      await this.cApp.AddTagStockID(tagid, item.id);\r\n    }\r\n    else {\r\n      await this.cApp.miApi.call('t_tagstock$del', [this.user.id, tagid, item.id]);\r\n      await this.cApp.RemoveTagStockID(tagid, item.id);\r\n    }\r\n  }\r\n\r\n  setSortType = (type:string) => {\r\n    this.cApp.setUserSortType(type);\r\n    let arr = this.items.slice();\r\n    this.cApp.sortStocks(arr);\r\n\r\n    this.items.replace(arr);\r\n  }\r\n\r\n  renderSiteHeader = () => {\r\n    return this.renderView(VSiteHeader);\r\n  }\r\n\r\n  renderHome = () => {\r\n    return this.renderView(VExplorer);\r\n  }\r\n\r\n\r\n  openMetaView = () => {\r\n  }\r\n\r\n  tab = () => <this.renderHome />;\r\n\r\n  openStockInfo = (item: NStockInfo) => {\r\n    let cStockInfo = this.newC(CStockInfo);\r\n    cStockInfo.start(item);\r\n  }\r\n}","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport * as React from 'react';\r\nimport { observer } from 'mobx-react-lite';\r\nimport { VPage, Page, FA, List, Form, ItemSchema, StringSchema, UiInputItem, UiSchema, Context, IdSchema, UiIdItem, LMR, UiSelect, UiTextItem } from 'tonva';\r\nimport { CWarning } from './CWarning';\r\nimport { GFunc } from 'tool/GFunc';\r\n\r\nexport class VWarningConfig extends VPage<CWarning> {\r\n  async open(param?: any) {\r\n    this.openPage(this.page);\r\n  }\r\n\r\n  private onSelect = (item: any, isSelected: boolean, anySelected: boolean) => {\r\n    //this.controller.onTaged(item, isSelected);\r\n  }\r\n\r\n  private page = observer(() => {\r\n    let { warnings } = this.controller;\r\n    let divNewTag = warnings.length >= 100 ? '' :\r\n      <div className=\"px-3 py-2 cursor-pointer\" onClick={this.controller.onNewWarning}><FA name=\"plus\" className=\"text-primary\" /> &nbsp; 新建预警</div>;\r\n    return <Page header=\"预警\" headerClassName=\"bg-primary\">\r\n      {divNewTag}\r\n      <List items={warnings} \r\n        item={{ render: this.renderWarning }} \r\n        none={'--'} />\r\n    </Page>;\r\n  })\r\n\r\n  private renderWarning = (witem: any) => {\r\n    let {name, code, type, price} = witem;\r\n    let left = <div className=\"px-3 cursor-pointer\">\r\n      {name}\r\n      <small className=\" mx-3\" >{code}</small></div>;\r\n    return <LMR className=\"mx-3 my-2\" left={left} >\r\n      <div className=\"d-flex flex-wrap\">\r\n        <div className=\"px-3 c6\">{GFunc.warningTypeString(type)}</div>\r\n        <div className=\"px-3 c6\">{GFunc.numberToFixString(price)}</div>\r\n      </div>\r\n    </LMR>;\r\n  }\r\n}\r\n\r\nconst schema: ItemSchema[] = [\r\n  { name: 'id', type: 'id' } as IdSchema,\r\n  { name: 'type', type: 'string', required: true, maxLength: 2 } as StringSchema,\r\n  { name: 'price', type: 'number', required: true},\r\n  { name: 'submit', type: 'submit', },\r\n];\r\n\r\nconst uiSchema: UiSchema = {\r\n  items: {\r\n    id: { widget: 'id',\r\n      label: '股票',\r\n      visible: true} as UiIdItem,\r\n    type: { widget: 'select', label: '类型', \r\n    list: [{value:'gt', title:'大于'}, {value:'lt', title:'小于'}] } as UiSelect,\r\n    price: { widget: 'text', label: '价格', placeholder: '0.00'} as UiTextItem,\r\n    submit: { widget: 'button', label: '保存', className: 'btn btn-primary' },\r\n  }\r\n};\r\n\r\nexport class VNewWarning extends VPage<CWarning> {\r\n  async open(param?: any) {\r\n    this.openPage(this.page);\r\n  }\r\n\r\n  private newuiSchema: UiSchema = {\r\n    items: {\r\n      id: { widget: 'id',\r\n        label: '股票',\r\n        visible: true,\r\n        placeholder: <small className=\"text-muted\">请选择股票</small>,\r\n        pickId: async (context: Context, name: string, value: number) => {\r\n          return await this.controller.showSelectStock(context, name, value)\r\n        },\r\n        Templet: (item: any) => {\r\n          let { name, code } = item;\r\n          if (!item) return <small className=\"text-muted\">请选择股票</small>;\r\n          return <div>\r\n              {name}\r\n              <small className=\" mx-3\" >{code}</small>\r\n          </div>;\r\n        }\r\n      } as UiIdItem,\r\n      type: { widget: 'select', label: '类型', \r\n      list: [{value:'gt', title:'大于'}, {value:'lt', title:'小于'}] } as UiSelect,\r\n      price: { widget: 'text', label: '价格', placeholder: '0.00'} as UiTextItem,\r\n      submit: { widget: 'button', label: '保存', className: 'btn btn-primary' },\r\n    }\r\n  };\r\n  \r\n  private onFormButtonClick = async (name: string, context: Context) => {\r\n    await this.controller.onSaveNewWarning(context.data);\r\n  }\r\n\r\n  private page = () => {\r\n    let fData = {type:'lt'};\r\n    return <Page header=\"新建预警\" headerClassName=\"bg-primary\">\r\n      <div className=\"px-3 py-3\">\r\n        <Form schema={schema}\r\n          uiSchema={this.newuiSchema}\r\n          formData={fData}\r\n          onButtonClick={this.onFormButtonClick}\r\n        />\r\n      </div>\r\n    </Page>;\r\n  }\r\n}\r\n\r\nexport class VEditWarning extends VPage<CWarning> {\r\n  async open(param?: any) {\r\n    this.openPage(this.page, param);\r\n  }\r\n\r\n  private onFormButtonClick = async (name: string, context: Context) => {\r\n    await this.controller.onSaveWarning(context.data);\r\n  }\r\n\r\n  private page = (param?: any) => {\r\n    let {id, type, price} = param;\r\n    let fData = {id:id, type:type, price:price};\r\n    return <Page header=\"编辑预警\" headerClassName=\"bg-primary\">\r\n      <div className=\"px-3 py-3\">\r\n        <Form schema={schema}\r\n          uiSchema={uiSchema}\r\n          formData={fData}\r\n          onButtonClick={this.onFormButtonClick}\r\n        />\r\n      </div>\r\n    </Page>;\r\n  }\r\n}\r\n","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport { Context } from 'tonva';\r\nimport { observable } from 'mobx';\r\nimport { CMiApp, CUqBase } from '../UqApp';\r\nimport { CStock } from '../stock';\r\nimport { VWarningConfig, VNewWarning } from './VWarningConfig';\r\n\r\nexport class CWarning extends CUqBase {\r\n  get cApp(): CMiApp { return this._cApp as CMiApp };\r\n  @observable warnings:any[] = [];\r\n\r\n  async internalStart(param: any) {\r\n    let a = 1;\r\n  }\r\n\r\n  async loadWarnings() {\r\n    let r = await this.cApp.miApi.call('t_stockwarning$all', [this.user.id]);//await this.uqs.mi.StockWarningAll.query(undefined);\r\n    let ret = r as any[];\r\n    this.warnings = ret;\r\n  }\r\n\r\n  onNewWarning = () => {\r\n    this.openVPage(VNewWarning);\r\n  }\r\n\r\n  onWarningConfg = async () => {\r\n    await this.loadWarnings();\r\n    this.openVPage(VWarningConfig);\r\n  }\r\n\r\n  onSaveNewWarning = async (data: any) => {\r\n    let { id, type, price } = data;\r\n    // let param = {\r\n    //   user: this.cApp.user.id,\r\n    //   stock: id,\r\n    //   arr1: [\r\n    //     { type: type, price: price }\r\n    //   ]};\r\n    //let ret = await this.uqs.mi.StockWarning.add(param);\r\n    await this.cApp.miApi.call('t_stockwarning$add', [this.cApp.user.id, id.id, type, price]);\r\n    this.closePage();\r\n  }\r\n\r\n  onSaveWarning = async (data: any) => {\r\n\r\n  }\r\n\r\n  showSelectStock = async (context: Context, name: string, value: number): Promise<any> => {\r\n    let cStock = new CStock(this.cApp);\r\n    return await cStock.call();\r\n  }\r\n}","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport * as React from 'react';\r\nimport { observer } from 'mobx-react';\r\nimport RC2 from 'react-chartjs2'\r\nimport { VPage, Page, View, List, LMR, FA } from 'tonva';\r\nimport { CPredictHistory } from './CPredictHistory';\r\n\r\nexport class VPredictHistory extends VPage<CPredictHistory> {\r\n  async open(param?: any) {\r\n    this.openPage(this.page);\r\n  }\r\n\r\n  render(param: any): JSX.Element {\r\n    return <this.page />\r\n  }\r\n\r\n  private page = observer(() => {\r\n    return <Page header=\"预期收益比均值历史\">\r\n      <this.pageContent />\r\n    </Page>;\r\n  })\r\n\r\n  private pageContent = observer(() => {\r\n    return <>\r\n    <this.historyChart />\r\n    </>\r\n  });\r\n\r\n  protected historyChart = observer(() => {\r\n    let {items} = this.controller;\r\n    if (items === undefined) \r\n      return <></>;\r\n    let chartHistory = <></>;\r\n    let labelList:any[] = [];\r\n    let avg20List:number[] = [];\r\n    let avg50List:number[] = [];\r\n    let avg100List:number[] = [];\r\n    for (let item of items) {\r\n      let {day, avg20, avg50, avg100} = item;\r\n      labelList.push(day);\r\n      avg20List.push(avg20);\r\n      avg50List.push(avg50);\r\n      avg100List.push(avg100);\r\n    }\r\n    let chartdata1 = {\r\n      labels: labelList,\r\n      datasets: [\r\n        {\r\n          label: 'avg20',\r\n          data: avg20List,\r\n          borderColor:'blue',\r\n          backgroundColor:'skyBlue',\r\n          borderWidth: 1,\r\n          fill: false,\r\n          yAxisID: 'y-axis-1',\r\n        },\r\n        {\r\n          label: 'avg50',\r\n          data: avg50List,\r\n          borderColor:'red',\r\n          backgroundColor:'pink',\r\n          borderWidth: 1,\r\n          fill: false,\r\n          yAxisID: 'y-axis-1',\r\n        },\r\n        {\r\n          label: 'avg100',\r\n          data: avg100List,\r\n          borderColor:'DarkGreen',\r\n          backgroundColor:'green',\r\n          borderWidth: 1,\r\n          fill: false,\r\n          yAxisID: 'y-axis-1',\r\n        },\r\n      ]\r\n    };\r\n    let options = {\r\n      scales:{\r\n        yAxes: [{\r\n            type: 'linear',\r\n            display: true,\r\n            position: 'right',\r\n            id: 'y-axis-1',\r\n        }],       \r\n      }\r\n    }\r\n\r\n    chartHistory = <RC2 data={chartdata1} type='line' options={options}/>;\r\n    return <><LMR className=\"px-3 py-2 bg-white\" left={'历史走势'}></LMR>\r\n      <div className=\"px-3\" style={{width:'95%'}}>{chartHistory}</div>\r\n    </>;\r\n  });\r\n\r\n}","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport { observable, IObservableArray } from 'mobx';\r\nimport { CUqBase } from '../UqApp';\r\nimport { VPredictHistory } from './VPredictHistory'\r\n\r\nexport interface PredictHistoryParam {\r\n  day?:number,\r\n  priceDay?:number,\r\n  avg20?:number,\r\n  avg50?:number,\r\n  avg100?:number,\r\n  avg?:number,\r\n}\r\n\r\ninterface PredictItem {\r\n  day:number, \r\n  avg20:number, \r\n  avg50:number,\r\n  avg100:number,\r\n  avg?:number\r\n}\r\n\r\nexport class CPredictHistory extends CUqBase {\r\n  items: IObservableArray<PredictItem> = observable.array<PredictItem>([], { deep: true });\r\n  day: number;\r\n  protected lastItem: PredictItem;\r\n\r\n  async internalStart(param: any) {\r\n    let p = param as PredictHistoryParam;\r\n    if (p !== undefined) {\r\n      this.day = p.day;\r\n      if (p.priceDay !== undefined) {\r\n        this.lastItem = {day:p.priceDay, avg20:p.avg20, avg50:p.avg50, avg100:p.avg100};\r\n      }\r\n      else {\r\n        this.lastItem = undefined;\r\n      }\r\n    }\r\n    else {\r\n      this.day = undefined;\r\n      this.lastItem = undefined;\r\n    }\r\n    await this.load();\r\n    this.openVPage(VPredictHistory as any);\r\n  }\r\n\r\n  async load() {\r\n    let ret = await this.cApp.miApi.call('t_toppredictavg$query', [this.day]) as PredictItem[];\r\n    this.items.clear();\r\n    if (!Array.isArray(ret))\r\n      return;\r\n    this.items.push(...ret);\r\n    if (this.lastItem !== undefined) {\r\n      let li = {...this.lastItem};\r\n      this.items.push(li);\r\n    }\r\n  }\r\n\r\n}","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport { observable, computed } from 'mobx';\r\nimport { Controller, VPage } from 'tonva';\r\nimport { CHome } from '../home';\r\nimport { consts } from './consts';\r\nimport { MiApi } from '../net';\r\nimport { VHome } from '../ui';\r\nimport { CExplorer } from '../explorer';\r\nimport { MiConfigs, StockFindConfig, IdName, RegressionConfig } from '../types';\r\nimport { CWarning } from '../warning';\r\nimport { CPredictHistory } from '../predicthistory';\r\nimport { CUqApp } from './CBase';\r\n\r\nexport const defaultTagName = '自选股';\r\nexport const defaultBlackListTagName = '黑名单';\r\n\r\nexport class CMiApp extends CUqApp {\r\n  cExporer: CExplorer;\r\n  cHome: CHome;\r\n  cWarning: CWarning;\r\n  miApi: MiApi;\r\n  @observable config: MiConfigs = { \r\n    tagName: defaultTagName, \r\n    stockFind: { sortType:'pe' },\r\n    userStock: { sortType:'tagpe'},\r\n    regression: {bmin:0, bmax:0.5, r2:0.7, lmin:0.01, lmax:0.5, lr2:0.7, mcount:2, lr4: 3, r210:0.6, irate:0.04}\r\n  };\r\n  @observable tags: IdName[] = undefined;\r\n  @observable blackList: any[] = [];\r\n  @observable defaultList: any[] = [];\r\n  @observable accounts: IdName[] = undefined;\r\n\r\n  @computed get tagID(): number {\r\n    if (this.tags !== undefined) {\r\n      let name = this.config.tagName;\r\n      let i = this.tags.findIndex(v => v.name === name);\r\n      if (i >= 0) {\r\n        return this.tags[i].id as number;\r\n      }\r\n    }\r\n    return -1;\r\n  }\r\n\r\n  @computed get accountID(): number {\r\n    let name = this.config.accountName;\r\n    if (name !== undefined && this.accounts !== undefined) {\r\n      let i = this.accounts.findIndex(v => v.name === name);\r\n      if (i >= 0) {\r\n        return this.accounts[i].id as number;\r\n      }\r\n    }\r\n    return -1;\r\n  }\r\n\r\n  get findStockConfg(): StockFindConfig {\r\n    return this.config.stockFind;\r\n  }\r\n\r\n  @computed get blackListTagID(): number {\r\n    if (this.tags !== undefined) {\r\n      let name = this.config.tagName;\r\n      let i = this.tags.findIndex(v => v.name === defaultBlackListTagName);\r\n      if (i >= 0) {\r\n        return this.tags[i].id as number;\r\n      }\r\n    }\r\n    return -1;\r\n  }\r\n\r\n  @computed get defaultListTagID(): number {\r\n    if (this.tags !== undefined) {\r\n      let name = this.config.tagName;\r\n      let i = this.tags.findIndex(v => v.name === defaultTagName);\r\n      if (i >= 0) {\r\n        return this.tags[i].id as number;\r\n      }\r\n    }\r\n    return -1;\r\n  }\r\n\r\n  protected async internalStart() {\r\n    if (this.isLogined) {\r\n    }\r\n\r\n    let token = this.user.token;\r\n\r\n    //let miHost = consts.isDevelopment ? consts.miApiHostDebug : consts.miApiHost;\r\n\tlet miHost = consts.miApiHost;\r\n    this.miApi = new MiApi(miHost, 'fsjs/', 'miapi', token, false);\r\n    this.cExporer = this.newC(CExplorer);\r\n    this.cHome = this.newC(CHome);\r\n    this.cWarning = this.newC(CWarning);\r\n\r\n    //some test code\r\n    //let params = [];\r\n    //let ret = await this.miApi.page('q_stocksquery', params, 0, 100);\r\n    let env = process.env;\r\n    //\r\n    await this.loadConfig();\r\n    this.cHome.loadWarning();\r\n    this.openVPage(VHome);\r\n  }\r\n\r\n  async saveConfig() {\r\n    let v = JSON.stringify(this.config);\r\n    await this.miApi.call('t_usersettings$save', [this.user.id, 'config', v]);\r\n  }\r\n\r\n  protected async loadConfig() {\r\n    let rets = await Promise.all([this.miApi.query('t_usersettings$query', [this.user.id, 'config']),\r\n        this.loadTags(),\r\n        this.loadAccounts()]);\r\n    let r = rets[0];\r\n    if (r !== undefined) {\r\n      let ret = r;\r\n      if (ret !== undefined && ret.length > 0) {\r\n        let cStr = ret[0].value;\r\n        let c = JSON.parse(cStr);\r\n        if (this.tags !== undefined) {\r\n          let name = c.tagName;\r\n          let i = this.tags.findIndex(v => v.name === name);\r\n          if (i < 0 && this.tags.length > 0) {\r\n            i = this.tags.findIndex(v => v.name === defaultTagName);\r\n            if (i >= 0) {\r\n              c.tagName = defaultTagName;\r\n            }\r\n            else {\r\n              c.tagName = this.tags[0].name;\r\n            }\r\n          }\r\n        }\r\n        this.config = c;\r\n      }\r\n    }\r\n    if (this.config.stockFind === undefined) {\r\n      this.config.stockFind = { sortType: 'pe' };\r\n    }\r\n    else {\r\n      switch (this.config.stockFind.selectType) {\r\n        case 'all': break;\r\n        case 'peroe': break;\r\n        case 'pe': break;\r\n        case 'dp': break;\r\n        default:\r\n          this.config.stockFind.selectType = 'all';\r\n          break;\r\n      }\r\n    }\r\n    if (this.config.userStock === undefined) {\r\n      this.config.userStock = { sortType: 'tagpe' };\r\n    }\r\n    if (this.config.regression === undefined) {\r\n      this.config.regression = {bmin:0, bmax:0.5, r2:0.7, lmin:0.01, lmax:0.5, lr2:0.7, mcount:2, lr4: 3, r210:0.6, irate:0.04};\r\n    }\r\n    else {\r\n      if (this.config.regression.r210 === undefined) {\r\n        this.config.regression.r210 = 0.6;\r\n      }\r\n      if (this.config.regression.irate === undefined) {\r\n        this.config.regression.irate = 0.04;\r\n      }\r\n    }\r\n    await this.loadBlackList();\r\n    await this.loadDefaultList();\r\n  }\r\n\r\n  getsortFunc = () => {\r\n    let sortType = this.config.userStock.sortType;\r\n    if (sortType === 'tagpe') {\r\n      return (a, b) => {\r\n        return a.pe - b.pe;\r\n      }\r\n    }\r\n    else if (sortType === 'tagdp') {\r\n      return (a, b) => {\r\n        return b.divyield - a.divyield;\r\n      }\r\n    }\r\n    else {\r\n      return (a, b) => {\r\n        return b.v - a.v;\r\n      }\r\n    }\r\n  }\r\n\r\n  sortStocks = (arr:any[]) => {\r\n    arr.sort(this.getsortFunc());\r\n    let o = 1;\r\n    for (let item of arr) {\r\n      item.order = o;\r\n      ++o;\r\n    }\r\n  }\r\n\r\n\r\n  setStockSortType = async (type:string)=> {\r\n    if (this.config.stockFind.sortType === type)\r\n      return;\r\n    this.config.stockFind.sortType = type;\r\n    await this.saveConfig();\r\n  }\r\n\r\n  setStockSelectType = async (type:string) => {\r\n    if (this.config.stockFind.selectType === type)\r\n      return;\r\n    this.config.stockFind.selectType = type;\r\n    await this.saveConfig();\r\n  }\r\n\r\n  setUserSortType = async (type:string)=> {\r\n    if (this.config.userStock.sortType === type)\r\n      return;\r\n    this.config.userStock.sortType = type;\r\n    await this.saveConfig();\r\n  }\r\n\r\n  selectTag = async (item:any) => {\r\n    let {name, id} = item as {name:string, id:number};\r\n    let i = this.tags.findIndex(v => v.name === name);\r\n    if (i >= 0) {\r\n      this.config.tagName = name;\r\n      this.saveConfig();\r\n    }\r\n  }\r\n\r\n  selectAccount = async (item:any) => {\r\n    let {name, id} = item as {name:string, id:number};\r\n    let i = this.accounts.findIndex(v => v.name === name);\r\n    if (i >= 0) {\r\n      this.config.accountName = name;\r\n      this.saveConfig();\r\n    }\r\n  }\r\n\r\n  setRegressionConfig = async (cfg: RegressionConfig) => {\r\n    this.config.regression = cfg;\r\n    await this.saveConfig();\r\n  }\r\n\r\n  protected async loadTags(): Promise<void> {\r\n    if (this.tags === undefined) {\r\n      let r = await this.miApi.query('t_tag$all', [this.user.id]);\r\n      let ret = r as any[];\r\n      let bc = await this.checkDefaultTags(ret);\r\n      if (bc) {\r\n        r = await this.miApi.query('t_tag$all', [this.user.id]);\r\n        ret = r as any[];\r\n      }\r\n      let r1 = [];\r\n      let i = ret.findIndex(v=>v.name === defaultTagName);\r\n      if (i >= 0) {\r\n        r1.push(ret[i]);\r\n        ret.splice(i, 1);\r\n      }\r\n      i = ret.findIndex(v=> v.name === defaultBlackListTagName);\r\n      if (i >= 0) {\r\n        r1.push(ret[i]);\r\n        ret.splice(i, 1);\r\n      }\r\n      r1.push(...ret);\r\n      this.tags = r1;\r\n    }\r\n  }\r\n\r\n  protected async checkDefaultTags(list:any[]): Promise<boolean> {\r\n    let br = false;\r\n    if (list === undefined) {\r\n      await this.miApi.call('t_tag$save', [this.user.id, undefined, defaultTagName]);\r\n      await this.miApi.call('t_tag$save', [this.user.id, undefined, defaultBlackListTagName]);\r\n      br = true;\r\n    }\r\n    else {\r\n      let param;\r\n      let i = list.findIndex(v => v.name === defaultTagName);\r\n      if (i < 0) {\r\n        await this.miApi.call('t_tag$save', [this.user.id, undefined, defaultTagName]);\r\n        br = true;\r\n      }\r\n      i = list.findIndex(v => v.name === defaultBlackListTagName);\r\n      if (i < 0) {\r\n        await this.miApi.call('t_tag$save', [this.user.id, undefined, defaultBlackListTagName]);\r\n        br = true;\r\n      }\r\n    }\r\n\r\n    return br;\r\n  }\r\n\r\n  protected async loadAccounts(): Promise<void> {\r\n    let r = await this.miApi.query('t_allaccounts', [this.user.id]);\r\n    if (Array.isArray(r)) {\r\n      this.accounts = r;\r\n    }\r\n  }\r\n\r\n  protected async loadBlackList(): Promise<void> {\r\n    let blackid = this.blackListTagID;\r\n    if (blackid <= 0) {\r\n      this.blackList = [];\r\n      return;\r\n    }\r\n\r\n    let param = { user:this.user.id, tag:blackid};\r\n    try {\r\n      let ret = await this.miApi.call('t_tagstock$query', [this.user.id, blackid, undefined]);//await this.uqs.mi.TagStock.query(param);\r\n      let r = ret.map(item=> {\r\n        return item.stock;\r\n      });\r\n      this.blackList = r;\r\n    }\r\n    catch (error) {\r\n      let e = error;\r\n    }\r\n  }\r\n\r\n  protected async loadDefaultList(): Promise<void> {\r\n    let id = this.defaultListTagID;\r\n    if (id <= 0) {\r\n      this.defaultList = [];\r\n      return;\r\n    }\r\n\r\n    let param = { user:this.user.id, tag:id};\r\n    try {\r\n      let ret = await this.miApi.call('t_tagstock$query', [this.user.id, id, undefined]);//await this.uqs.mi.TagStock.query(param);\r\n      let r = ret.map(item=> {\r\n        return item.stock;\r\n      });\r\n      this.defaultList = r;\r\n    }\r\n    catch (error) {\r\n      let e = error;\r\n    }\r\n  }\r\n\r\n  async AddTagStockID(tagid: number, stockID: number) {\r\n    if (tagid === this.blackListTagID) {\r\n      this.AddBlackID(stockID);\r\n    }\r\n    else if (tagid === this.defaultListTagID) {\r\n      this.AddDefaultID(stockID);\r\n    }\r\n  }\r\n\r\n  async AddTagStockIDs(tagid: number, stockIDs: number[]) {\r\n    if (tagid === this.blackListTagID) {\r\n      stockIDs.map(v=>this.AddBlackID(v));\r\n    }\r\n    else if (tagid === this.defaultListTagID) {\r\n      stockIDs.map(v=>this.AddDefaultID(v));\r\n    }\r\n  }\r\n\r\n  async RemoveTagStockID(tagid: number, stockID: number) {\r\n    if (tagid === this.blackListTagID) {\r\n      this.RemoveBlackID(stockID);\r\n    }\r\n    else if (tagid === this.defaultListTagID) {\r\n      this.RemoveDefaultID(stockID);\r\n    }\r\n    this.cHome.RemoveTagStockID(tagid, stockID);\r\n  }\r\n\r\n  protected AddBlackID(id:number) {\r\n    let i = this.blackList.findIndex(v=> v===id);\r\n    if (i < 0) {\r\n      this.blackList.push(id);\r\n    }\r\n  }\r\n\r\n  protected RemoveBlackID(id:number) {\r\n    let i = this.blackList.findIndex(v=> v===id);\r\n    if (i >= 0) {\r\n      this.blackList.splice(i, 1);\r\n    }\r\n  }\r\n\r\n  protected AddDefaultID(id:number) {\r\n    let i = this.defaultList.findIndex(v=> v===id);\r\n    if (i < 0) {\r\n      this.defaultList.push(id);\r\n    }\r\n  }\r\n\r\n  protected RemoveDefaultID(id:number) {\r\n    let i = this.defaultList.findIndex(v=> v===id);\r\n    if (i >= 0) {\r\n      this.defaultList.splice(i, 1);\r\n    }\r\n  }\r\n/*\r\n  newC<T extends CUqBase>(type: IConstructor<T>): T {\r\n    return new type(this);\r\n  }\r\n*/\r\n  public async showOneVPage(vp: new (coordinator: Controller) => VPage<Controller>, param?: any): Promise<void> {\r\n    await (new vp(this)).open(param);\r\n  }\r\n\r\n  protected onDispose() {\r\n  }\r\n\r\n  openPredictAVG(param:any) {\r\n    let pc = this.newC(CPredictHistory);\r\n    pc.start(param);\r\n  }\r\n}\r\n","import * as React from 'react';\r\n\r\nexport class GFunc {\r\n  public static numberToFixString(n: number, w = 2) {\r\n    return n === undefined ? '' : n.toFixed(w);\r\n  }\r\n  public static number(n: number, w=2) {\r\n    return n === undefined ? '' : n.toFixed(w);\r\n  }\r\n\r\n  public static numberToMarketValue(n: number) {\r\n    return n === undefined || isNaN(n) ? '' : Math.round(n/10000).toString(); // + '亿';\r\n  }\r\n\r\n  public static numberToString(n: number, precision = 2) {\r\n    return n === undefined ? '' : n.toPrecision(precision);\r\n  }\r\n\r\n  public static numberToPrecision(n: number, precision = 4) {\r\n    return n === undefined ? undefined : Number.parseFloat(n.toPrecision(precision));\r\n  }\r\n\r\n  public static percentToFixString(n: number) {\r\n    return n === undefined || isNaN(n) ? '' : (n * 100).toFixed(2) + '%';\r\n  }\r\n\r\n  public static percent0(n: number) {\r\n    return n === undefined || isNaN(n) ? '' : (n * 100).toFixed(0) + '%';\r\n  }\r\n  public static percent1(n: number) {\r\n    return n === undefined || isNaN(n) ? '' : (n * 100).toFixed(1) + '%';\r\n  }\r\n\r\n  public static warningTypeString(t: string) {\r\n    switch (t) {\r\n      case 'gt': return '大于';\r\n      case 'lt': return '小于';\r\n      default: return t;\r\n    }\r\n  }\r\n\r\n  public static predictCutRatio(r2:number) {\r\n    return r2 * 2 - r2 * r2;\r\n  }\r\n\r\n  public static evaluatePricePrice(iRate:number, e1:number, e2:number, e3:number) {\r\n    let r = 1 + iRate;\r\n    let r2 = r * r;\r\n    let r3 = r2 * r;\r\n    return (e1/r + e2 /r2 + e3 / r3 + e3 / iRate / r3) / 2;\r\n  }\r\n\r\n  public static calculateV(z:number, divyield:number, pe:number) {\r\n    if (pe === undefined || isNaN(pe)) {\r\n      return undefined;\r\n    }\r\n\r\n    let r = 0;\r\n    if (z !== undefined) {\r\n      if (z > 0.25) {\r\n        z = 0.25;\r\n      }\r\n      r += z * 100;\r\n    }\r\n    if (divyield !== undefined) {\r\n      r += divyield * 100;\r\n    }\r\n    return r / pe;\r\n  }\r\n\r\n  public static calculateVN(z:number, e:number, bonus:number, price:number) {\r\n    if (price === undefined || isNaN(price) || e === undefined || isNaN(e)) {\r\n      return undefined;\r\n    }\r\n\r\n    let r = 0;\r\n    if (z !== undefined && e > 0) {\r\n      if (z > 0.25) {\r\n        z = 0.24 + Math.pow((z-0.24)*100, 0.6667) / 100;\r\n      }\r\n      z = 1 + z;\r\n      z = z * z * z - 1;\r\n      r += z * e * 100;\r\n    }\r\n    if (bonus !== undefined && !isNaN(bonus)) {\r\n      r += bonus * 100;\r\n    }\r\n    return r / price;\r\n  }\r\n\r\n  public static calculateZZ3(data:number[]) {\r\n    let ret:number[] = [undefined, undefined, undefined, undefined] ;\r\n    if (data === undefined)\r\n      return ret;\r\n    let len = data.length;\r\n    if (len < 5)\r\n      return ret;\r\n    \r\n    let funcz = (n:number, p:number) => {\r\n      if (p <= 0 || n <= 0)\r\n        return undefined;\r\n      return ((n / p) - 1);\r\n    }\r\n    for (let i = 0; i < 4; ++i) {\r\n      ret[i] = funcz(data[i+1], data[i]);\r\n    }\r\n    return ret;\r\n  }\r\n\r\n  public static caption = (value:string) => <span className=\"text-muted small\">{value}</span>;\r\n\r\n  public static MonthnoFromDay(day:number) {\r\n    let year = Math.floor(day/10000);\r\n    let month = Math.floor((day%10000)/100) - 1;\r\n    return (year-1995)*12+month;\r\n  }\r\n  \r\n  public static SeasonnoFromDay(day:number) {\r\n    let year = Math.floor(day/10000);\r\n    let month = Math.floor((day%10000)/100) - 1;\r\n    let season = Math.floor(month / 3);\r\n    return (year-1995)*4 + season;\r\n  }\r\n  \r\n  public static SeasonnoFromYearMonth(year:number, month:number) {\r\n    let season = Math.floor((month-1) / 3);\r\n    return (year-1995)*4 + season;\r\n  }\r\n\r\n  public static SeasonnoToYearMonth(no: number) {\r\n    let year = Math.floor(no / 4) + 1995;\r\n    let month = (Math.floor(no % 4) + 1) * 3;\r\n    return year * 100 + month;\r\n  }\r\n  \r\n  public static SeasonnoToBeginEnd(season:number) {\r\n    let year = (1995 + Math.floor(season / 4)) * 10000;\r\n    let s = season % 4;\r\n    if (s === 0) {\r\n      return {begin: year + 101, end: year + 331};\r\n    } \r\n    else if (s === 1) {\r\n      return {begin: year + 401, end: year + 630};\r\n    }\r\n    else if (s === 2) {\r\n      return {begin: year + 701, end: year + 930};\r\n    }\r\n    return {begin: year + 1001, end: year + 1231};\r\n  }\r\n\r\n  public static CalculatePredictAvg(arr: {predictpe:number}[]) {\r\n    let ret : {avg20:number, avg50:number, avg100:number} = {avg20:undefined, avg50:undefined, avg100:undefined};\r\n\r\n    let length = arr.length;\r\n    let calcuOne = (count:number) : number => {\r\n      let endIndex = count;\r\n      if (endIndex > length)\r\n        endIndex = length;\r\n      if (endIndex >= 10) {\r\n        let sum = 0;\r\n        for (let i = 3; i < endIndex; ++i) {\r\n          sum += arr[i].predictpe\r\n        }\r\n        return sum / (endIndex - 3);\r\n      }\r\n      else {\r\n        return undefined;\r\n      }\r\n    }\r\n\r\n    ret.avg20 = calcuOne(20);\r\n    ret.avg50 = calcuOne(50);\r\n    ret.avg100 = calcuOne(100);\r\n    return ret;\r\n  }\r\n\r\n  public static CalculateValueAvg(arr: {v:number}[]) {\r\n    let ret : {avg20:number, avg50:number, avg100:number, avg:number} = {avg20:undefined, avg50:undefined, avg100:undefined, avg:undefined};\r\n\r\n    let length = arr.length;\r\n    let calcuOne = (count:number) : number => {\r\n      let endIndex = count;\r\n      if (count === 0 || endIndex > length)\r\n        endIndex = length;\r\n      if (endIndex >= 10) {\r\n        let sum = 0;\r\n        for (let i = 3; i < endIndex; ++i) {\r\n          sum += arr[i].v;\r\n        }\r\n        return sum / (endIndex - 3);\r\n      }\r\n      else {\r\n        return undefined;\r\n      }\r\n    }\r\n\r\n    ret.avg20 = calcuOne(20);\r\n    ret.avg50 = calcuOne(50);\r\n    ret.avg100 = calcuOne(100);\r\n    ret.avg = calcuOne(0);\r\n    return ret;\r\n  }\r\n}\r\n","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport * as React from 'react';\r\nimport classNames from 'classnames';\r\nimport { VPage, Page, View, List, LMR, left0, FA } from 'tonva';\r\nimport { observable } from 'mobx';\r\nimport { observer } from 'mobx-react';\r\nimport RC2 from 'react-chartjs2'\r\nimport { GFunc } from '../tool/GFunc';\r\nimport { CStockInfo } from './CStockInfo'\r\nimport { NStockInfo, StockCapitalearning, StockBonus } from './StockInfoType';\r\nimport { ErForEarning, SlrForEarning } from 'regression';\r\n\r\nexport class VStockInfo extends VPage<CStockInfo> {\r\n  private input: HTMLInputElement;\r\n  private key: string = undefined;\r\n\r\n  async open(param?: any) {\r\n    this.openPage(this.page);\r\n  }\r\n\r\n  @observable protected ttmLimit:boolean = false;\r\n\r\n  render(param: any): JSX.Element {\r\n    return <this.page />\r\n  }\r\n\r\n  checkLimitShow = (e)=> {\r\n    let check = e.target.checked as boolean;\r\n    this.ttmLimit = check;\r\n  }\r\n\r\n  checkShowLater = (e)=> {\r\n    let check = e.target.checked as boolean;\r\n    this.controller.LoadHistoryData(check);\r\n  }\r\n\r\n  checkDefaultTag = (e)=> {\r\n    let check = e.target.checked as boolean;\r\n    this.controller.onClickDefaultTag(check);\r\n  }\r\n\r\n  private page = observer(() => {\r\n    let { openMetaView, baseItem, onSelectTag, stockTags, isLogined } = this.controller;\r\n    let { name, code, day } = baseItem;\r\n    let viewMetaButton = <></>;\r\n    if (isLogined) {\r\n      viewMetaButton = <button type=\"button\" className=\"btn w-100\" onClick={openMetaView}>view</button>\r\n    }\r\n    let right = stockTags && <button \r\n\t\tclassName=\"btn btn-sm mr-2 btn-outline-success bg-light align-self-center\"\r\n\t\tonClick={onSelectTag}>\r\n      {stockTags.length === 0? '加自选' : '设分组'}\r\n      </button>;\r\n    let headStr = name + ' ' + code;\r\n    if (day !== undefined) {\r\n      headStr += ' - ' + day;\r\n    }\r\n  let head = <div onClick={()=>this.controller.showSelectStock(day)}>{headStr}</div>\r\n    return <Page header={head} right={right}\r\n      headerClassName='bg-primary'>\r\n      <this.pageContent />\r\n    </Page>;\r\n  })\r\n\r\n  private pageContent = observer(() => {\r\n    return <>\r\n      <this.dateHead />\r\n      <this.baseInfo />\r\n      <this.historyChart />\r\n      <this.predictInfo />\r\n      <this.predictSeasonEarning />\r\n      <this.seasonEarning />\r\n      <this.capitalEarning />\r\n      <this.bonus />\r\n    </>\r\n  });\r\n\r\n  private onChange = (evt: React.ChangeEvent<any>) => {\r\n    let v = evt.target.value;\r\n    let n = Number(v);\r\n    if (isNaN(n) === true || !Number.isInteger(n)) {\r\n      if (this.input) {\r\n        this.input.value = this.key;\r\n      }\r\n      return;\r\n    }\r\n    this.key = evt.target.value;\r\n    if (this.key !== undefined) {\r\n        this.key = this.key.trim();\r\n        if (this.key === '') this.key = undefined;\r\n    }\r\n  }\r\n\r\n  private onSubmit = async (evt: React.FormEvent<any>) => {\r\n    evt.preventDefault();\r\n    if (this.key === undefined) this.key = '';\r\n    let n = Number(this.key);\r\n    if (!isNaN(n) && Number.isInteger((n))) {\r\n      if (n ===0 || (n >= 20000101 && n < 30000101)) {\r\n        await this.controller.changeDay(n);\r\n      }\r\n    }\r\n  }\r\n\r\n\r\n  private dateHead = () => {\r\n    let {day} = this.controller.baseItem;\r\n    let dayString = day === undefined || isNaN(day) ? '' : day.toString();\r\n    return <div className=\"px-3 py-2\">\r\n\t\t<form className=\"w-100\" onSubmit={this.onSubmit} >\r\n\t\t\t<div className=\"input-group input-group-sm\">\r\n\t\t\t\t<label className=\"input-group-addon mr-2 mb-0 align-self-center\">{'日期'}</label>\r\n\t\t\t\t<input ref={v=>this.input=v} onChange={this.onChange}\r\n\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\tname=\"key\"\r\n\t\t\t\t\t\tdefaultValue={dayString}\r\n\t\t\t\t\t\tclassName=\"form-control border-primary px-2\"\r\n\t\t\t\t\t\tplaceholder={'yyyymmdd'}\r\n\t\t\t\t\t\tmaxLength={8} />\r\n\t\t\t\t<div className=\"input-group-append\">\r\n\t\t\t\t\t\t<button className=\"btn btn-primary px-2\"\r\n\t\t\t\t\t\t\ttype=\"submit\">\r\n\t\t\t\t\t\t\t<i className='fa fa-search' />\r\n\t\t\t\t\t\t\t<i className=\"fa\"/>\r\n\t\t\t\t\t\t\t{'跳转'}\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</form>\r\n\t</div>;\r\n  }\r\n\r\n\r\n  private baseInfo = observer(() => {\r\n    let {baseItem} = this.controller;\r\n    let { id, name, code, symbol, pe, roe, price, order, divyield, e, capital, bonus } = baseItem;\r\n\r\n    let list = this.controller.cApp.defaultList;\r\n    let fInList = list.findIndex(v=>v===id) >= 0;\r\n    let right = <label className=\"align-self-center px-3\"> <input type=\"checkbox\" name=\"checkDefaultList\" defaultChecked={fInList}\r\n      onChange={this.checkDefaultTag} />自选股</label>;\r\n    return <LMR className=\"bg-white\" right={right}> <div className=\"px-3 py-2\" >\r\n      <div className=\"d-flex flex-wrap\">\r\n        <div className=\"px-3 c8\">{GFunc.caption('TTM')}{GFunc.numberToFixString(pe)}</div>\r\n        <div className=\"px-3 c8\">{GFunc.caption('股息率')}{GFunc.percentToFixString(divyield)}</div>\r\n        <div className=\"px-3 c8\">{GFunc.caption('ROE')}{GFunc.percentToFixString(roe)}</div>\r\n        <div className=\"px-3 c8\">{GFunc.caption('价格')}{GFunc.numberToFixString(price)}</div>\r\n        <a className=\"px-3 text-info\" href={`https://finance.sina.com.cn/realstock/company/${symbol}/nc.shtml`} target=\"_blank\" rel=\"noopener noreferrer\" onClick={(e) =>{e.stopPropagation() }}>新浪财经</a>\r\n      </div>    \r\n    </div>\r\n    </LMR>;\r\n  });\r\n\r\n  protected onClickName = async (item: NStockInfo) => {\r\n    let { symbol } = item;\r\n    let url = `http://finance.sina.com.cn/realstock/company/${symbol}/nc.shtml`;\r\n    let w = window.open(url, '');\r\n    w.opener = undefined;\r\n  }\r\n\r\n  protected historyChart = observer(() => {\r\n    let {historyData, baseItem} = this.controller;\r\n    if (historyData === undefined) \r\n      return <></>;\r\n    let chartHistory = <></>;\r\n    let labelList:any[] = [];\r\n    let priceList:number[] = [];\r\n    let ttmList:number[] = [];\r\n    for (let item of historyData) {\r\n      let {day, price, ttm} = item;\r\n      labelList.push(day);\r\n      priceList.push(GFunc.numberToPrecision(price, 4));\r\n      if (ttm <= 0) \r\n        ttmList.push(undefined);\r\n      else {\r\n        if (this.ttmLimit && ttm >= 35) {\r\n          ttmList.push(35);\r\n        }\r\n        else {\r\n          ttmList.push(GFunc.numberToPrecision(ttm, 4));\r\n        }\r\n      }\r\n    }\r\n    let chartdata1 = {\r\n      labels: labelList,\r\n      datasets: [\r\n        {\r\n          label: '价格',\r\n          data: priceList,\r\n          borderColor:'blue',\r\n          backgroundColor:'skyBlue',\r\n          borderWidth: 1,\r\n          fill: false,\r\n          yAxisID: 'y-axis-1',\r\n        },\r\n        {\r\n          label: 'TTM',\r\n          data: ttmList,\r\n          borderColor:'red',\r\n          backgroundColor:'pink',\r\n          borderWidth: 1,\r\n          fill: false,\r\n          yAxisID: 'y-axis-2',\r\n        }\r\n      ]\r\n    };\r\n    let options = {\r\n      scales:{\r\n        yAxes: [{\r\n            type: 'linear',\r\n            display: true,\r\n            position: 'left',\r\n            id: 'y-axis-1',\r\n        }, {\r\n            type: 'linear',\r\n            display: true,\r\n            position: 'right',\r\n            id: 'y-axis-2',\r\n            gridLines: {\r\n                drawOnChartArea: false\r\n            }\r\n        }],       \r\n      }\r\n    }\r\n    chartHistory = <RC2 data={chartdata1} type='line' options={options} />;\r\n    let right = <></>;\r\n    if (baseItem.day !== undefined) {\r\n      right = <><label className=\"px-3\"> <input type=\"checkbox\" name=\"showLater\" defaultChecked={false}\r\n            onChange={this.checkShowLater} />显示后面数据</label>\r\n          <label className=\"px-3\"> <input type=\"checkbox\" name=\"selectType\" defaultChecked={this.ttmLimit}\r\n          onChange={this.checkLimitShow} />限制TTM显示范围</label>\r\n        </>;\r\n\r\n    }\r\n    else {\r\n      right = <label className=\"px-3\"> <input type=\"checkbox\" name=\"selectType\" defaultChecked={this.ttmLimit}\r\n        onChange={this.checkLimitShow} />限制TTM显示范围</label>;\r\n    }\r\n    return <><LMR className=\"px-3 py-2 bg-white\" left={'历史走势'} right={right}></LMR>\r\n      <div className=\"px-3\" style={{width:'95%'}}>{chartHistory}</div>\r\n    </>;\r\n  });\r\n\r\n  protected predictInfo = observer(() => {\r\n    let {predictData, ypredict} = this.controller;\r\n    if (predictData === undefined) \r\n      return <></>;\r\n    let { e, b, r2, epre, l, lr2, lpre } = predictData;\r\n    let chart1 = <></>;\r\n    if (ypredict.length === 5) {\r\n      let er = new ErForEarning(ypredict);\r\n      let chartdata1 = {\r\n        labels: ['0', '1', '2', '3', '4'],\r\n        datasets: [\r\n          {\r\n            label: '原值',\r\n            data: ypredict.map(v=>GFunc.numberToPrecision(v)),\r\n            borderColor:'black',\r\n            backgroundColor:'skyBlue',\r\n            showLine: false,\r\n            pointStyle: \"crossRot\",\r\n            borderWidth: 1,\r\n            pointRadius: 5,\r\n            fill: false,\r\n          } as any\r\n        ]\r\n      };\r\n      if (!(isNaN(er.B) || isNaN(er.A))) {\r\n        let per:number[] = [];\r\n        for (let i = 0; i < 5; ++i) {\r\n          per.push(GFunc.numberToPrecision(er.predict(i), 4));\r\n        }\r\n        chartdata1.datasets.push(\r\n          {\r\n            label: '指数回归',\r\n            data: per,\r\n            borderColor:'red',\r\n            backgroundColor:'pink',\r\n            borderWidth: 1,\r\n            fill: false,\r\n        });\r\n      }\r\n      let lr = new SlrForEarning(ypredict);\r\n      if (!(isNaN(lr.slope) || isNaN(lr.intercept))) {\r\n        let plr:number[] = [];\r\n        for (let i = 0; i < 5; ++i) {\r\n          plr.push(GFunc.numberToPrecision(lr.predict(i), 4));\r\n        }\r\n        chartdata1.datasets.push(\r\n          {\r\n            label: '线性回归',\r\n            data: plr,\r\n            borderColor:'blue',\r\n            backgroundColor:'pink',\r\n            borderWidth: 1,\r\n            fill: false,\r\n        });\r\n      }\r\n      chart1 = <RC2 data={chartdata1} type='line' />;\r\n    }\r\n    let chart2 = this.predictChartFullInfo();\r\n    let chart3 = this.predictChartROE();\r\n    return <><div className=\"px-3 py-2 bg-white\">指数回归预测</div>\r\n      <div className=\"d-flex flex-wrap\">\r\n        <div className=\"px-3 c12\">{GFunc.caption('e')}{GFunc.numberToString(e, 4)}</div>\r\n        <div className=\"px-3 c12\">{GFunc.caption('指数b')}{GFunc.numberToString(b, 4)}</div>\r\n        <div className=\"px-3 c12\">{GFunc.caption('r2')}{GFunc.numberToString(r2, 4)}</div>\r\n        <div className=\"px-3 c12\">{GFunc.caption('e预测')}{GFunc.numberToString(epre)}</div>\r\n      </div>\r\n      <div className=\"px-3 py-2 bg-white\">线性回归预测</div>\r\n      <div className=\"d-flex flex-wrap\">\r\n      <div className=\"px-3 c12\">{GFunc.caption('e')}{GFunc.numberToString(e, 4)}</div>\r\n        <div className=\"px-3 c12\">{GFunc.caption('增长率')}{GFunc.numberToString(l, 4)}</div>\r\n        <div className=\"px-3 c12\">{GFunc.caption('r2')}{GFunc.numberToString(lr2, 4)}</div>\r\n        <div className=\"px-3 c12\">{GFunc.caption('e预测')}{GFunc.numberToString(lpre)}</div>\r\n      </div>\r\n      <div className=\"d-flex\">\r\n        <div className=\"px-2\" style={{width:'50%'}}>{chart1}</div>\r\n        <div className=\"px-2\" style={{width:'50%'}}>{chart2}</div>\r\n      </div>\r\n      <div className=\"d-flex\">\r\n        <div className=\"px-2\" style={{width:'50%'}}>{chart3}</div>\r\n      </div>\r\n    </>;\r\n  });\r\n\r\n  protected predictChartFullInfo = () => {\r\n    let { predictSeasonDataFull } = this.controller;\r\n    let len = predictSeasonDataFull.length;\r\n    if (len <= 0)\r\n      return <></>;\r\n    let label = [];\r\n    let y:number[] = [];\r\n    for (let i = len - 1; i >= 0; --i) {\r\n      let item = predictSeasonDataFull[i];\r\n      if (item.esum === undefined)\r\n        continue;\r\n      label.push(GFunc.SeasonnoToYearMonth(item.season));\r\n      y.push(item.esum);\r\n    }\r\n\r\n    let er = new ErForEarning(y);\r\n    let chartdataFull = {\r\n      labels: label,\r\n      datasets: [\r\n        {\r\n          label: '原值',\r\n          data: y.map(v=>GFunc.numberToPrecision(v)),\r\n          borderColor:'black',\r\n          backgroundColor:'skyBlue',\r\n          showLine: false,\r\n          pointStyle: \"crossRot\",\r\n          borderWidth: 1,\r\n          pointRadius: 5,\r\n          fill: false,\r\n        } as any\r\n      ]\r\n    };\r\n    if (!(isNaN(er.B) || isNaN(er.A))) {\r\n      let per:number[] = [];\r\n      for (let i = 0; i < len; ++i) {\r\n        per.push(GFunc.numberToPrecision(er.predict(i), 4));\r\n      }\r\n      chartdataFull.datasets.push(\r\n        {\r\n          label: '指数 R2:' + GFunc.numberToString(er.r2, 4),\r\n          data: per,\r\n          borderColor:'red',\r\n          backgroundColor:'pink',\r\n          borderWidth: 1,\r\n          fill: false,\r\n      });\r\n    }\r\n    let lr = new SlrForEarning(y);\r\n    if (!(isNaN(lr.slope) || isNaN(lr.intercept))) {\r\n      let plr:number[] = [];\r\n      for (let i = 0; i < len; ++i) {\r\n        plr.push(GFunc.numberToPrecision(lr.predict(i), 4));\r\n      }\r\n      chartdataFull.datasets.push(\r\n        {\r\n          label: '线性 R2:' + GFunc.numberToString(lr.r2, 4),\r\n          data: plr,\r\n          borderColor:'blue',\r\n          backgroundColor:'pink',\r\n          borderWidth: 1,\r\n          fill: false,\r\n      });\r\n    }\r\n    return <RC2 data={chartdataFull} type='line' />;\r\n  };\r\n\r\n  protected predictChartROE = () => {\r\n    let { predictSeasonDataFull } = this.controller;\r\n    let len = predictSeasonDataFull.length;\r\n    if (len <= 0)\r\n      return <></>;\r\n    let label = [];\r\n    let y:number[] = [];\r\n    for (let i = len - 1; i >= 0; --i) {\r\n      let item = predictSeasonDataFull[i];\r\n      if (item.esum === undefined)\r\n        continue;\r\n      label.push(GFunc.SeasonnoToYearMonth(item.season));\r\n      y.push(item.esumorg / item.corg);\r\n    }\r\n\r\n    let chartdataFull = {\r\n      labels: label,\r\n      datasets: [\r\n        {\r\n          label: 'ROE原值',\r\n          data: y.map(v=>GFunc.numberToPrecision(v)),\r\n          borderColor:'black',\r\n          backgroundColor:'skyBlue',\r\n          showLine: false,\r\n          pointStyle: \"crossRot\",\r\n          borderWidth: 1,\r\n          pointRadius: 5,\r\n          fill: false,\r\n        } as any\r\n      ]\r\n    };\r\n    let lr = new SlrForEarning(y);\r\n    if (!(isNaN(lr.slope) || isNaN(lr.intercept))) {\r\n      let plr:number[] = [];\r\n      for (let i = 0; i < len; ++i) {\r\n        plr.push(Number.parseFloat(lr.predict(i).toPrecision(4)));\r\n      }\r\n      chartdataFull.datasets.push(\r\n        {\r\n          label: '线性 R2:' + GFunc.numberToString(lr.r2, 4),\r\n          data: plr,\r\n          borderColor:'blue',\r\n          backgroundColor:'pink',\r\n          borderWidth: 1,\r\n          fill: false,\r\n      });\r\n    }\r\n    return <RC2 data={chartdataFull} type='line' />;\r\n  };\r\n\r\n  private predictSeasonEarning = observer(() => {\r\n    let items = this.controller.predictSeasonData;\r\n    let header = <div className=\"px-3\">\r\n      <div className=\"px-3 c6\">年月</div>\r\n      <div className=\"px-3 c6 text-right\">股本</div>\r\n      <div className=\"px-3 c6 text-right\">季收益</div>\r\n      <div className=\"px-3 c6 text-right\">年收益</div>\r\n      <div className=\"px-3 c6 text-right\">ROE</div>\r\n      <div className=\"px-3 c6 text-right\">股本o</div>\r\n      <div className=\"px-3 c6 text-right\">季收益o</div>\r\n      <div className=\"px-3 c6 text-right\">年收益o</div>\r\n    </div>;\r\n    return <>\r\n      <div className=\"px-3 py-1\">历年股本收益-用于回归计算</div>\r\n      <List header={header} loading=\"...\"\r\n        items={items}\r\n        item={{\r\n          render: (row: {season:number, c:number, e:number, esum:number, corg:number, eorg:number, esumorg:number}) => {\r\n            let {season, c, e, esum, corg, eorg, esumorg} = row;\r\n            let ym = GFunc.SeasonnoToYearMonth(season);\r\n            let a = 0;\r\n            return <div className=\"px-3 py-2 d-flex flex-wrap\">\r\n              <div className=\"px-3 c6\">{ym.toString()}</div>\r\n              <div className=\"px-3 c6 text-right\">{GFunc.numberToFixString(c)}</div>\r\n              <div className=\"px-3 c6 text-right\">{GFunc.numberToFixString(e)}</div>\r\n              <div className=\"px-3 c6 text-right\">{GFunc.numberToFixString(esum)}</div>\r\n              <div className=\"px-3 c6 text-right\">{GFunc.percentToFixString(esum/c)}</div>\r\n              <div className=\"px-3 c6 text-right\">{GFunc.numberToFixString(corg)}</div>\r\n              <div className=\"px-3 c6 text-right\">{GFunc.numberToFixString(eorg)}</div>\r\n              <div className=\"px-3 c6 text-right\">{GFunc.numberToFixString(esumorg)}</div>\r\n            </div>\r\n          }\r\n        }}\r\n      />\r\n    </>\r\n  });\r\n\r\n\r\n  private seasonEarning = observer(() => {\r\n    let items = this.controller.seasonData;\r\n    let header = <div className=\"px-3\">\r\n      <div className=\"px-3 c6\">年月</div>\r\n      <div className=\"px-3 c6 text-right\">股本</div>\r\n      <div className=\"px-3 c6 text-right\">季收益</div>\r\n      <div className=\"px-3 c6 text-right\">年收益</div>\r\n      <div className=\"px-3 c6 text-right\">ROE</div>\r\n      <div className=\"px-3 c6 text-right\">股本o</div>\r\n      <div className=\"px-3 c6 text-right\">季收益o</div>\r\n      <div className=\"px-3 c6 text-right\">年收益o</div>\r\n    </div>;\r\n    return <>\r\n      <div className=\"px-3 py-1\">历年股本收益</div>\r\n      <List header={header} loading=\"...\"\r\n        items={items}\r\n        item={{\r\n          render: (row: {season:number, c:number, e:number, esum:number, corg:number, eorg:number, esumorg:number}) => {\r\n            let {season, c, e, esum, corg, eorg, esumorg} = row;\r\n            let ym = GFunc.SeasonnoToYearMonth(season);\r\n            let a = 0;\r\n            return <div className=\"px-3 py-2 d-flex flex-wrap\">\r\n              <div className=\"px-3 c6\">{ym.toString()}</div>\r\n              <div className=\"px-3 c6 text-right\">{GFunc.numberToFixString(c)}</div>\r\n              <div className=\"px-3 c6 text-right\">{GFunc.numberToFixString(e)}</div>\r\n              <div className=\"px-3 c6 text-right\">{GFunc.numberToFixString(esum)}</div>\r\n              <div className=\"px-3 c6 text-right\">{GFunc.percentToFixString(esum/c)}</div>\r\n              <div className=\"px-3 c6 text-right\">{GFunc.numberToFixString(corg)}</div>\r\n              <div className=\"px-3 c6 text-right\">{GFunc.numberToFixString(eorg)}</div>\r\n              <div className=\"px-3 c6 text-right\">{GFunc.numberToFixString(esumorg)}</div>\r\n            </div>\r\n          }\r\n        }}\r\n      />\r\n    </>\r\n  });\r\n\r\n\r\n  private capitalEarning = observer(() => {\r\n    let items = this.controller.capitalearning;\r\n    let header = <div className=\"px-3\">\r\n      <div className=\"px-3 c6\">年</div>\r\n      <div className=\"px-3 c6 text-right\">股本</div>\r\n      <div className=\"px-3 c6 text-right\">收益</div>\r\n      <div className=\"px-3 c6 text-right\">ROE</div>\r\n    </div>;\r\n    return <>\r\n      <div className=\"px-3 py-1\">历年股本收益</div>\r\n      <List header={header} loading=\"...\"\r\n        items={items}\r\n        item={{\r\n          render: (row: StockCapitalearning) => {\r\n            let {capital, earning} = row;\r\n            return <div className=\"px-3 py-2 d-flex flex-wrap\">\r\n              <div className=\"px-3 c6\">{row.year}</div>\r\n              <div className=\"px-3 c6 text-right\"> {capital.toFixed(2)}</div>\r\n              <div className=\"px-3 c6 text-right\"> {earning.toFixed(2)}</div>\r\n              <div className=\"px-3 c6 text-right\"> {(earning/capital*100).toFixed(1)}%</div>\r\n            </div>\r\n          }\r\n        }}\r\n      />\r\n    </>\r\n  });\r\n\r\n  private bonus = observer(() => {\r\n    let items = this.controller.bonus;\r\n    let header = <div className=\"px-3\">\r\n      <div className=\"px-3 c8\">日期</div>\r\n      <div className=\"px-3 c6 text-right\">分红</div>\r\n    </div>;\r\n    return <>\r\n      <div className=\"px-3 py-1\">历年分红</div>\r\n      <List header={header} loading=\"...\"\r\n        items={items}\r\n        item={{\r\n          render: (row: StockBonus) => {\r\n            return <div className=\"px-3 py-2 d-flex flex-wrap\">\r\n              <div className=\"px-3 c8\">{row.day}</div>\r\n              <div className=\"px-3 c6 text-right\"> {row.bonus.toFixed(2)}</div>\r\n            </div>\r\n          }\r\n        }}\r\n      />\r\n    </>\r\n  });\r\n}","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport * as React from 'react';\r\nimport { observer } from 'mobx-react-lite';\r\nimport { VPage, Page, FA, List, Form, ItemSchema, StringSchema, UiInputItem, UiSchema, Context, IdSchema, UiIdItem, LMR, UiSelect, UiTextItem, PageItems, SearchBox } from 'tonva';\r\nimport { CStock } from './CStock'\r\n\r\nexport class VStockSelect extends VPage<CStock> {\r\n  async open(item: any) {\r\n      this.openPage(this.page, item);\r\n  }\r\n\r\n  private renderStock(stock: any, index: number) {\r\n      let { name, code } = stock;\r\n      return <LMR className=\"px-3 py-2 \" >\r\n          <div className=\"font-weight-bold\"></div>\r\n          <div>{name + ' ' + code}</div>\r\n      </LMR >\r\n  }\r\n\r\n  private onClickStock = async (model: any) => {\r\n      await this.controller.returnStock(model);\r\n      this.closePage();\r\n  }\r\n\r\n  private page = observer((customer: any) => {\r\n      let { PageItems, onPage } = this.controller;\r\n      let none = <div className=\"my-3 mx-2 text-warning\">请搜索股票！</div>;\r\n      return <Page header=\"选择股票\" headerClassName='bg-primary' onScrollBottom={onPage}>\r\n          <SearchBox className=\"px-1 w-100  mt-2 mr-2\"\r\n              size='md'\r\n              allowEmptySearch={true}\r\n              onSearch={(key: string) => this.controller.searchByKey(key)}\r\n              placeholder=\"搜索股票\" />\r\n          <List before={''} none={none} items={PageItems} item={{ render: this.renderStock, onClick: this.onClickStock }} />\r\n      </Page>\r\n  })\r\n}","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport { observable } from 'mobx';\r\nimport { nav, PageItems } from 'tonva';\r\nimport { CUqBase } from '../UqApp';\r\nimport { VStockSelect } from './VSelectStock';\r\n\r\nclass PageStockItems<T> extends PageItems<T> {\r\n  cStock: CStock;\r\n\r\n  constructor(cs: CStock) {\r\n      super(true);\r\n      this.cStock = cs;\r\n      this.firstSize = this.pageSize = 30;\r\n  }\r\n\r\n  protected async loadResults(param: any, pageStart: any, pageSize: number): Promise<{\r\n\t[name: string]: any[];\r\n\t}> {\r\n      if (pageStart === undefined) pageStart = 0;\r\n      let p = ['%' + param.key + '%'];\r\n      try {\r\n        let ret = await this.cStock.cApp.miApi.page('q_stocks$page', p, pageStart, pageSize);\r\n        return ret;\r\n      }\r\n      catch (error) {\r\n        let e = error;\r\n        return undefined;\r\n      }\r\n  }\r\n\r\n  protected setPageStart(item: any): any {\r\n      this.pageStart = item === undefined ? 0 : item.id;\r\n  }\r\n}\r\n\r\nexport class CStock extends CUqBase {\r\n  @observable PageItems: PageStockItems<any> = new PageStockItems<any>(this);\r\n\r\n  //get cApp(): CMiApp { return this._cApp as CMiApp };\r\n\r\n  async internalStart(param: any) {\r\n    this.openVPage(VStockSelect);\r\n}\r\n\r\n  searchByKey = async (key: string) => {\r\n    this.PageItems = new PageStockItems<any>(this);\r\n    this.PageItems.first({ key: key });\r\n  }\r\n\r\n  //给调用页面返回id\r\n  returnStock = async (item: any): Promise<any> => {\r\n    this.returnCall(item);\r\n  }\r\n\r\n  onPage = async () => {\r\n    await this.PageItems.more();\r\n  }\r\n}","export * from './StockInfoType';\r\nexport { CStockInfo } from './CStockInfo';\r\nexport { VStockInfo } from './VStockInfo';"],"sourceRoot":""}