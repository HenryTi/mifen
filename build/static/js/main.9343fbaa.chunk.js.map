{"version":3,"sources":["stockinfo/VTags.tsx","stockinfo/CStockInfo.tsx","App.tsx","reportWebVitals.ts","index.tsx","regression/SlrForEarning.ts","regression/ErForEarning.ts","UqApp/CBase.ts","UqApp/consts.ts","images/logo.svg","home/VSiteHeader.tsx","home/VSearchHeader.tsx","tool/render.tsx","tool/func.ts","home/VHome.tsx","home/VSelectTag.tsx","home/VMarketPE.tsx","home/CMarketPE.tsx","home/CHome.tsx","me/VAdmin.tsx","me/VEditMe.tsx","me/VMe.tsx","me/CMe.ts","net/httpChannel.ts","net/httpChannelUI.ts","net/apiBase.ts","net/miApi.ts","ui/main.tsx","explorer/VSiteHeader.tsx","explorer/VExplorer.tsx","explorer/VExplorerCfg.tsx","explorer/CExplorer.tsx","warning/VWarningConfig.tsx","warning/CWarning.tsx","predicthistory/VPredictHistory.tsx","predicthistory/CPredictHistory.tsx","UqApp/CMiApp.tsx","UqApp/appConfig.ts","stockinfo/VStockInfo.tsx","stock/VSelectStock.tsx","stock/CStock.tsx","stockinfo/index.ts","tool/GFunc.tsx"],"names":["VTags","onSelect","item","isSelected","anySelected","controller","onClickSelectTag","onEditTag","tag","e","preventDefault","renderTag","left","className","name","right","defaultBlackListTagName","defaultTagName","onClick","page","observer","selectedTags","tags","cApp","divNewTag","length","onNewTag","header","headerClassName","items","render","selectedItems","param","a","this","openPage","VPage","schema","type","required","maxLength","uiSchema","widget","label","placeholder","id","visible","submit","VNewTag","onFormButtonClick","context","onSaveNewTag","data","closePage","formData","undefined","onButtonClick","VEditTag","onSaveTag","fData","CStockInfo","exrightForEarning","exrightInfo","historyDataOrg","_capitalearning","observable","array","deep","_bonus","_divideInfo","loadData","loading","baseItem","day","Promise","all","miApi","query","user","rets","stockTags","ret","Array","isArray","arr1","price","clear","arr2","push","arr3","arr4","loadTTMEarning","LoadHistoryData","loaded","openMetaView","onSelectTag","filter","v","findIndex","st","openVPage","call","retId","alert","i","nav","stock","newTag","AddTagStockID","splice","RemoveTagStockID","onClickDefaultTag","tagid","defaultListTagID","showSelectStock","cStock","CStock","b","changeDay","code","symbol","ni","list","seasonData","seasonlist","len","minNo","seasonno","lastItem","maxNo","GFunc","SeasonnoToBeginEnd","end","no","sItem","season","c","capital","es","esum","earning","corg","eorg","esumorg","ExrightEarning","si","pastitem","noBegin","predictData","predictSeasonData","predictSeasonDataFull","ypredict","x","er","ErForEarning","lr","SlrForEarning","B","r2","epre","predict","l","slopeR","lr2","lpre","endDay","exitem","factor","showAll","historyData","endIndex","lastdayno","dayno","lastDay","not","historyList","RestorePrice","ttm","CalculateHistoryPE","dayFrom","dayIndex","bsum","pricere","bonus","factore","SeasonnoFromDay","VStockInfo","CUqBase","computed","App","onLogined","start","CMiApp","appConfig","React","Component","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","StrictMode","document","getElementById","y","slope","intercept","endY","regress","score","n","xSum","ySum","xSquared","xY","numerator","ym","y2","chi2","rmsd","ySquared","yi2","yi","yiyi2","r","Math","sqrt","A","yx","log","exp","CBase","CUqApp","CSub","init","CAppBase","consts","uqBasedata","appIcon","miApiHost","miApiHostDebug","isDevelopment","process","VSiteHeader","src","logo","alt","style","height","width","renderSearchHeader","View","VSearchHeader","onSearch","key","size","renderSortCol","caption","sort","checked","defaultChecked","renderSortHeaders","role","aria-label","renderValue","value","valueType","vStr","_cn","cn","isNaN","toFixed","percent1","number","round","toString","numberToMarketValue","renderStockInfoRow","row","onClickName","pe","roe","divyield","order","total","ep","e3","zzl","funcz","p","calculateZZ3","dataArr","rows","map","w","VHome","setSortType","renderRow","index","rowContent","href","target","rel","stopPropagation","rowKey","openStockInfo","onSelected","clickRow","callOnSelected","openMarketPE","scroller","onPage","title","config","tagName","onAddStock","inverse","before","none","VSelectTag","onClickTag","VMarketPE","input","checkLimitShow","f","onLongShortFlag","head","pageContent","historyChart","chartHistory","labelList","peList","eList","numberToPrecision","chartdata1","labels","datasets","borderColor","backgroundColor","borderWidth","fill","yAxisID","options","scales","yAxes","display","position","gridLines","drawOnChartArea","onChange","CMarketPE","longshortFlag","dt","Date","getFullYear","getMonth","getDate","reverse","CHome","userTag","oldSortType","load","selectTag","onWarningConfg","cWarning","console","tagID","loadItems","setUserSortType","arr","slice","sortStocks","replace","renderSiteHeader","renderView","renderHome","tab","newC","stockID","pageStart","pageSize","yearlen","result","dataArray","JSON","parse","sl","calculateVN","exprice","predictpe","o","warnings","VAdmin","renderRootUnit","owner","tonvaUnit","vId","vName","nick","icon","onClickRootUnit","openPageElement","trueValue","falseValue","onItemChanged","itemSchema","newValue","preValue","trim","changeRootUnitName","changeRootUnitTonva","changeRootUnitX","VUser","rootUnits","onKeyDown","evt","hasError","keyCode","onNext","inputName","currentTarget","search","unitOwner","VUnit","userApi","fromKey","createElement","vError","onFocus","disabled","onCreate","createRootUnit","content","unitId","afterBack","back","VEditMe","props","userSetProp","saveLocalUser","vAdmin","showAdmin","VMe","onExit","showLogout","changePassword","meInfo","showEditMe","userSpan","String","substr","t","aboutRows","component","iconClass","text","version","logout","logOutRows","bk","values","CMe","uqs","Notes","GetSystemRole","QueryPager","GetRootUnits","first","CreateRootUnit","ChangeRootUnitProp","unit","prop","HttpChannel","hostUrl","apiToken","ui","timeout","startWait","endWait","url","reject","showError","error","post","params","keys","Object","k","buildOptions","method","innerFetch","body","stringify","resolve","buildError","err","channel","that","path","timeOutHandler","setTimeout","fetch","encodeURI","res","ok","clearTimeout","statusText","ct","headers","get","indexOf","json","retJson","catch","message","toLowerCase","startsWith","u","language","culture","Headers","append","lang","HttpChannelNavUI","onError","channelUIs","channelNoUIs","MiApiChannel","basePath","apiName","uqToken","showWaiting","token","channels","channelUI","getHttpChannel","callFetch","put","delete","MiApi","pbody","_","clone","proc","color","selected","cHome","cExporer","cMe","tabs","notify","onShown","TabCaptionComponent","tabsProps","VExplorer","onClickPredictAVG","avgs","priceDay","lastTradeDay","avg20","avg50","avg100","avg","openPredictAVG","blackList","labelId","fInDef","defaultList","onSelectItem","onClickItem","onConfig","avgHead","reload","avgStr","numberToFixString","irate","bmin","bmax","lmin","lmax","lr4","mcount","r210","VExplorerCfg","sortChage","newType","setStockSortType","selectChange","setStockSelectType","cfg","setRegressionConfig","findStockConfg","regression","CExplorer","oldSelectType","disposeAutorun","autorun","newSelectType","stockFind","selectType","queryName","blackID","blackListTagID","bMin","bMax","lMin","lMax","lastDayRet","CalculateValueAvg","VWarningConfig","onNewWarning","renderWarning","witem","warningTypeString","VNewWarning","newuiSchema","pickId","Templet","onSaveNewWarning","CWarning","loadWarnings","onSaveWarning","_cApp","VPredictHistory","avg20List","avg50List","avg100List","CPredictHistory","li","getsortFunc","sortType","userStock","saveConfig","selectAccount","accounts","accountName","isLogined","miHost","loadConfig","loadWarning","loadTags","loadAccounts","cStr","loadBlackList","loadDefaultList","checkDefaultTags","r1","br","blackid","AddBlackID","AddDefaultID","stockIDs","RemoveBlackID","RemoveDefaultID","vp","open","appName","tvs","uqNameMap","check","ttmLimit","checkShowLater","checkDefaultTag","headStr","dateHead","baseInfo","predictInfo","predictSeasonEarning","seasonEarning","capitalEarning","Number","isInteger","onSubmit","dayString","ref","defaultValue","fInList","percentToFixString","window","opener","priceList","ttmList","chart1","showLine","pointStyle","pointRadius","per","plr","chart2","predictChartFullInfo","chart3","predictChartROE","numberToString","SeasonnoToYearMonth","chartdataFull","parseFloat","toPrecision","capitalearning","year","VStockSelect","onClickStock","model","returnStock","customer","pageItems","onScrollBottom","allowEmptySearch","searchByKey","renderStock","PageStockItems","cs","firstSize","PageItems","returnCall","more","precision","iRate","e1","e2","r3","z","pow","floor","month","s","begin","calcuOne","count","sum"],"mappings":"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","file":"static/js/main.9343fbaa.chunk.js","sourcesContent":["import * as React from 'react';\r\nimport { observer } from 'mobx-react-lite';\r\nimport { VPage, Page, FA, List, Form, ItemSchema, StringSchema, UiInputItem, UiSchema, Context, IdSchema, UiIdItem, LMR } from 'tonva';\r\nimport { CStockInfo } from './CStockInfo';\r\nimport { defaultBlackListTagName, defaultTagName } from '../UqApp';\r\n\r\nexport class VTags extends VPage<CStockInfo> {\r\n  async open(param?: any) {\r\n    this.openPage(this.page);\r\n  }\r\n\r\n  private onSelect = (item: any, isSelected: boolean, anySelected: boolean) => {\r\n    this.controller.onClickSelectTag(item, isSelected);\r\n  }\r\n\r\n  private onEditTag = (tag:any, e:React.MouseEvent) => {\r\n    e.preventDefault();\r\n    this.controller.onEditTag(tag);\r\n  }\r\n\r\n  private renderTag = (tag: any) => {\r\n    let left = <div className=\"px-3 py-2 cursor-pointer\">{tag.name}</div>;\r\n    let fdTag = tag.name === defaultBlackListTagName || tag.name === defaultTagName;\r\n    let right = fdTag ? '' : <div className=\"px-3 py-2 cursor-pointer\" onClick={(e)=>this.onEditTag(tag, e)}>编辑</div>;\r\n    return <LMR className=\"mx-3 my-2\" left={left} right={right}>\r\n    </LMR>;\r\n  }\r\n\r\n  private page = observer(() => {\r\n    let { selectedTags } = this.controller;\r\n    let { tags } = this.controller.cApp;\r\n    let divNewTag = tags.length >= 10 ? '' :\r\n      <div className=\"px-3 py-2 cursor-pointer\" onClick={this.controller.onNewTag}><FA name=\"plus\" className=\"text-primary\" /> &nbsp; 新建分组</div>;\r\n    return <Page header=\"选择分组\" headerClassName=\"bg-primary\">\r\n      {divNewTag}\r\n      <List items={tags} item={{ onSelect: this.onSelect, render: this.renderTag }} selectedItems={selectedTags} />\r\n    </Page>;\r\n  })\r\n}\r\n\r\nconst schema: ItemSchema[] = [\r\n  { name: 'name', type: 'string', required: true, maxLength: 10 } as StringSchema,\r\n  { name: 'id', type: 'id' } as IdSchema,\r\n  { name: 'submit', type: 'submit', },\r\n];\r\nconst uiSchema: UiSchema = {\r\n  items: {\r\n    name: { widget: 'text', label: null, placeholder: '分组名称' } as UiInputItem,\r\n    id: { widget: 'id', visible: false } as UiIdItem,\r\n    submit: { widget: 'button', label: '保存', className: 'btn btn-primary' },\r\n  }\r\n};\r\n\r\nexport class VNewTag extends VPage<CStockInfo> {\r\n  async open(param?: any) {\r\n    this.openPage(this.page);\r\n  }\r\n\r\n  private onFormButtonClick = async (name: string, context: Context) => {\r\n    if (await this.controller.onSaveNewTag(context.data)) {\r\n      this.controller.closePage();\r\n    }\r\n  }\r\n\r\n  private page = () => {\r\n    return <Page header=\"新建分组\" headerClassName=\"bg-primary\">\r\n      <div className=\"px-3 py-3\">\r\n        <Form schema={schema}\r\n          uiSchema={uiSchema}\r\n          formData={undefined}\r\n          onButtonClick={this.onFormButtonClick}\r\n        />\r\n      </div>\r\n    </Page>;\r\n  }\r\n}\r\n\r\nexport class VEditTag extends VPage<CStockInfo> {\r\n  async open(param?: any) {\r\n    this.openPage(this.page, param);\r\n  }\r\n\r\n  private onFormButtonClick = async (name: string, context: Context) => {\r\n    if (await this.controller.onSaveTag(context.data)) {\r\n      this.controller.closePage();\r\n    }\r\n  }\r\n\r\n  private page = (param?: any) => {\r\n    let {id, name} = param;\r\n    let fData = {id:id, name:name};\r\n    return <Page header=\"编辑分组\" headerClassName=\"bg-primary\">\r\n      <div className=\"px-3 py-3\">\r\n        <Form schema={schema}\r\n          uiSchema={uiSchema}\r\n          formData={fData}\r\n          onButtonClick={this.onFormButtonClick}\r\n        />\r\n      </div>\r\n    </Page>;\r\n  }\r\n}\r\n","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport { observable, IObservableArray, computed } from 'mobx';\r\nimport { nav } from 'tonva';\r\nimport { CUqBase } from '../UqApp';\r\nimport { GFunc } from '../tool/GFunc';\r\nimport { VStockInfo } from './VStockInfo'\r\nimport { NStockInfo, StockPrice, StockEarning, StockRoe, StockCapitalearning, StockBonus, StockDivideInfo } from './StockInfoType';\r\nimport { VTags, VNewTag, VEditTag } from './VTags';\r\nimport { ErForEarning, SlrForEarning } from 'regression';\r\nimport { CStock } from 'stock/CStock';\r\n\r\nexport class CStockInfo extends CUqBase {\r\n  @observable baseItem: NStockInfo;\r\n  @observable protected loaded: boolean = false;\r\n\r\n  @observable price: StockPrice;\r\n  //@observable roe: StockRoe;\r\n  //@observable tags: any[] = undefined;\r\n  @observable stockTags: any[];\r\n  selectedTags: any[];\r\n\r\n  protected exrightForEarning: {day:number, factor:number}[] = [];\r\n  protected exrightInfo: {day:number, bonus:number, factor:number, factore:number}[] = [];\r\n  @observable seasonData:{season:number, c:number, e:number, esum:number, corg:number, eorg:number, esumorg:number}[] = [];\r\n  @observable predictSeasonData:{season:number, c:number, e:number, esum:number, corg:number, eorg:number, esumorg:number}[] = [];\r\n  @observable predictSeasonDataFull:{season:number, c:number, e:number, esum:number, corg:number, eorg:number, esumorg:number}[] = [];\r\n  @observable predictData: { e:number, b: number, r2: number, epre:number, l:number, lr2:number, lpre:number};\r\n  @observable ypredict: number[] = [];\r\n  @observable historyData:{day:number, price:number, ttm:number}[] =  [];\r\n  protected historyDataOrg:{day:number, price:number, dayno:number}[] = [];\r\n\r\n  //protected _earning: IObservableArray<StockEarning> = observable.array<StockEarning>([], { deep: true });\r\n  protected _capitalearning: IObservableArray<StockCapitalearning> = observable.array<StockCapitalearning>([], { deep: true });\r\n  protected _bonus: IObservableArray<StockBonus> = observable.array<StockBonus>([], { deep: true });\r\n  protected _divideInfo: IObservableArray<StockDivideInfo> = observable.array<StockDivideInfo>([], { deep: true });\r\n\r\n  // @computed get earning(): IObservableArray<StockEarning> {\r\n  //   if (this.loaded === false) return undefined;\r\n  //   return this._earning;\r\n  // }\r\n\r\n  @computed get capitalearning(): IObservableArray<StockCapitalearning> {\r\n    if (this.loaded === false) return undefined;\r\n    return this._capitalearning;\r\n  }\r\n\r\n  @computed get bonus(): IObservableArray<StockBonus> {\r\n    if (this.loaded === false) return undefined;\r\n    return this._bonus;\r\n  }\r\n\r\n  @computed get divideInfo(): IObservableArray<StockDivideInfo> {\r\n    if (this.loaded === false) return undefined;\r\n    return this._divideInfo;\r\n  }\r\n\r\n  loadData = () => {\r\n    this.loading();\r\n  }\r\n\r\n  loading = async () => {\r\n    if (!this.baseItem)\r\n      return;\r\n    let { id, day } = this.baseItem;\r\n    let rets = await Promise.all([\r\n      this.cApp.miApi.query('q_stockallinfo', [id, day]),\r\n      this.cApp.miApi.query('t_tagstock$query', [this.user.id, undefined, id]) //this.uqs.mi.TagStock.query({ user: nav.user.id, stock: id })\r\n    ]);\r\n    this.stockTags = rets[1];\r\n    let ret = rets[0];\r\n    if (Array.isArray(ret[0])) {\r\n      let arr1 = ret[1];\r\n      if (Array.isArray(arr1)) {\r\n        this.price = arr1[0];\r\n      }\r\n\r\n      if (this._capitalearning.length > 0) {\r\n        this._capitalearning.clear();\r\n      }\r\n      let arr2 = ret[2];\r\n      if (Array.isArray(arr2)) {\r\n        this._capitalearning.push(...arr2);\r\n      }\r\n\r\n      this._bonus.clear();\r\n      let arr3 = ret[3];\r\n      if (Array.isArray(arr3)) {\r\n        this._bonus.push(...arr3);\r\n      }\r\n\r\n      this._divideInfo.clear();\r\n      let arr4 = ret[4];\r\n      if (Array.isArray(arr4)) {\r\n        this._divideInfo.push(...arr4);\r\n      }\r\n\r\n      this.exrightForEarning = ret[5];\r\n      await this.loadTTMEarning(ret[6]);\r\n      this.exrightInfo = ret[7];\r\n\r\n      this.historyDataOrg = ret[8];\r\n      this.LoadHistoryData(false);\r\n    }\r\n\r\n    this.loaded = true;\r\n  }\r\n\r\n  protected async loadTTMEarning(list: {seasonno:number, capital:number, earning:number, es:number}[]) {\r\n    this.seasonData.splice(0);\r\n    let seasonlist: {[index:number]:{season:number, c:number, e:number, esum:number, corg:number, eorg:number, esumorg:number}} = {};\r\n    let len = list.length;\r\n    if (len <= 0)\r\n      return;\r\n    let minNo = list[len - 1].seasonno;\r\n    let lastItem = list[0];\r\n    let maxNo = lastItem.seasonno;\r\n\r\n    let {end} = GFunc.SeasonnoToBeginEnd(maxNo);\r\n    for (let item of list) {\r\n      let no = item.seasonno;\r\n      let sItem = {season:no, c: item.capital, e: item.es, esum: item.earning, corg: item.capital, eorg: item.es, esumorg: item.earning}\r\n      this.ExrightEarning(end, no, sItem);\r\n      seasonlist[no] = sItem;\r\n    }\r\n\r\n    let i = 0;\r\n    let esum = 0;\r\n    for (let seasonno = minNo; seasonno <= maxNo; ++seasonno, ++i) {\r\n      let si = seasonlist[seasonno];\r\n      if (si === undefined) {\r\n        continue;\r\n      }\r\n      esum += si.e;\r\n      if (i < 3) {\r\n        si.esum = undefined;\r\n      }\r\n      else {\r\n        si.esum = esum;\r\n        let pastitem = seasonlist[seasonno-3];\r\n        if (pastitem !== undefined) {\r\n          esum -= pastitem.e;\r\n        }\r\n      }\r\n      this.seasonData.splice(0,0, si);\r\n    }\r\n\r\n    let noBegin = maxNo - 19;\r\n    this.predictData = undefined;\r\n    this.predictSeasonData.splice(0);\r\n    this.predictSeasonDataFull.splice(0);\r\n    if (noBegin < minNo)\r\n      return;\r\n    noBegin += 3;\r\n    this.ypredict = [];\r\n    for (let x = noBegin; x <= maxNo; x += 4) {\r\n      let item = seasonlist[x];\r\n      if (item === undefined)\r\n        break;\r\n      this.predictSeasonData.splice(0, 0, item);\r\n      this.ypredict.push(item.esum);\r\n    }\r\n\r\n    for (let x = maxNo; x >= minNo; x -= 4) {\r\n      let item = seasonlist[x];\r\n      if (item === undefined)\r\n        break;\r\n      this.predictSeasonDataFull.push(item);\r\n    }\r\n    if (this.ypredict.length === 5) {\r\n      let er = new ErForEarning(this.ypredict);\r\n      let lr = new SlrForEarning(this.ypredict);\r\n      this.predictData = {e:this.ypredict[4], b: er.B, r2: er.r2, epre: er.predict(4), l: lr.slopeR, lr2: lr.r2, lpre: lr.predict(4)};\r\n    }\r\n    else {\r\n      this.predictSeasonData.splice(0);\r\n    }\r\n  }\r\n\r\n  protected ExrightEarning(endDay:number, season:number, item:{c:number, e:number, esum:number}) {\r\n    let {end} = GFunc.SeasonnoToBeginEnd(season);\r\n    for (let i = 0; i < this.exrightForEarning.length; ++i) {\r\n      let exitem = this.exrightForEarning[i];\r\n      let day = exitem.day;\r\n      if (day > endDay)\r\n        break;\r\n      else if (day < end)\r\n        continue;\r\n      else {\r\n        let factor = exitem.factor;\r\n        item.c = item.c * factor;\r\n        item.e = item.e * factor;\r\n        item.esum = item.esum * factor;\r\n      }\r\n    }\r\n  }\r\n\r\n  LoadHistoryData(showAll:boolean) {\r\n    let list = this.historyDataOrg;\r\n    let length = list.length;\r\n    if (length <= 10) {\r\n      this.historyData = [];\r\n      return;\r\n    }\r\n    if (!showAll) {\r\n      let day = this.baseItem.day;\r\n      if (day !== undefined) {\r\n        let i = length - 1;\r\n        for (; i >= 0; --i) {\r\n          let item = list[i];\r\n          if (item.day <= day) {\r\n            break;\r\n          }\r\n        }\r\n        length = i + 1;\r\n      }\r\n    }\r\n    let endIndex = length - 1;\r\n    let lastItem = list[endIndex];\r\n    let lastdayno = lastItem.dayno;\r\n    if (lastdayno === undefined) {\r\n      while (endIndex > 0) {\r\n        --endIndex;\r\n        lastItem = list[endIndex];\r\n        lastdayno = lastItem.dayno;\r\n        if (lastdayno !== undefined)\r\n          break;\r\n      }\r\n    }\r\n    let lastDay = lastItem.day;\r\n    let not = lastdayno % 5;\r\n    let historyList: any[] = [];\r\n    for (let i = 0; i <= endIndex; ++i) {\r\n      let {day, price, dayno} = list[i];\r\n      if ( dayno % 5 === not) {\r\n        historyList.push({day:day, price:this.RestorePrice(price, day, lastDay), ttm:this.CalculateHistoryPE(price, day)});\r\n      }\r\n    }\r\n    this.historyData = historyList;\r\n  }\r\n\r\n  RestorePrice(price:number, dayFrom:number, dayIndex:number) {\r\n    let bsum = 0;\r\n    let pricere = price;\r\n    if (dayFrom < dayIndex) {\r\n      for (let i = 0; i < this.exrightInfo.length; ++i) {\r\n        let {day, bonus, factor, factore} = this.exrightInfo[i];\r\n        if (day <= dayFrom)\r\n          continue;\r\n        if (day > dayIndex)\r\n          break;\r\n        pricere = pricere * factor;\r\n        bsum = (bsum + bonus) * factore;\r\n      }\r\n      pricere = pricere - bsum;\r\n    }\r\n    else {\r\n      for (let i = 0; i < this.exrightInfo.length; ++i) {\r\n        let {day, bonus, factor, factore} = this.exrightInfo[i];\r\n        if (day <= dayIndex)\r\n          continue;\r\n        if (day > dayFrom)\r\n          break;\r\n        pricere = pricere / factor;\r\n        bsum = bsum / factore + bonus;\r\n      }\r\n      pricere = pricere + bsum;\r\n    }\r\n    return pricere;\r\n  }\r\n\r\n  CalculateHistoryPE(price:number, day:number) {\r\n    let season = GFunc.SeasonnoFromDay(day);\r\n    let len = this.seasonData.length;\r\n    for (let i = 0; i < len; ++i) {\r\n      let item = this.seasonData[i];\r\n      if (item.season >= season) {\r\n        continue;\r\n      }\r\n\r\n      if (item.esumorg === undefined)\r\n        return undefined;\r\n\r\n      let {end} = GFunc.SeasonnoToBeginEnd(item.season);\r\n      let pricere = this.RestorePrice(price, day, end);\r\n      return pricere / item.esumorg;\r\n    }\r\n\r\n    return undefined;\r\n  }\r\n\r\n  async internalStart(param: any) {\r\n    this.baseItem = param as NStockInfo;\r\n    this.loadData();\r\n    this.openVPage(VStockInfo);\r\n  }\r\n\r\n  openMetaView = () => {\r\n  }\r\n\r\n  onSelectTag = async () => {\r\n    //await this.loadTags();\r\n    this.selectedTags = this.cApp.tags.filter(v => {\r\n      let i = this.stockTags.findIndex(st => st.tag === v.id);\r\n      return i >= 0;\r\n    });\r\n    //await this.loadTags();\r\n    this.openVPage(VTags);\r\n  }\r\n\r\n  onNewTag = () => {\r\n    this.openVPage(VNewTag);\r\n  }\r\n\r\n  onEditTag = (param: any) => {\r\n    this.openVPage(VEditTag, param);\r\n  }\r\n\r\n  onSaveNewTag = async (data: any) => {\r\n    let { name } = data;\r\n    //let param = { id: undefined, name: name };\r\n    let ret = await this.cApp.miApi.call('t_tag$save', [this.user.id, undefined, name]);\r\n    let { retId } = ret;\r\n    if (retId < 0) {\r\n      alert(name + ' 已经被使用了');\r\n      return false;\r\n    }\r\n    this.cApp.tags.push({ id: retId, name: name });\r\n    return true;\r\n  }\r\n\r\n  onSaveTag = async (data: any) => {\r\n    let { id, name } = data;\r\n    let param = { id: id, name: name };\r\n    let i = this.cApp.tags.findIndex(v => v.id !== id && v.name === name);\r\n    if (i >= 0) {\r\n      alert(name + ' 已经被使用了');\r\n      return false;\r\n    }\r\n    let ret = await this.cApp.miApi.call('t_tag$save', [this.user.id, undefined, name]);\r\n    let { retId } = ret;\r\n    if (retId === undefined || retId < 0) {\r\n      alert(name + ' 已经被使用了');\r\n      return false;\r\n    }\r\n    i = this.cApp.tags.findIndex(v => v.id === id);\r\n    if (i >= 0) {\r\n      this.cApp.tags[i].name = name;\r\n    }\r\n    return true;\r\n  }\r\n\r\n  onClickSelectTag = async (tag: any, isSelected: boolean) => {\r\n    let param = {\r\n      user: nav.user.id,\r\n      tag: tag.id,\r\n      arr1: [\r\n        { stock: this.baseItem.id }\r\n      ]\r\n    };\r\n    if (isSelected === true) {\r\n      let ret = await this.cApp.miApi.call('t_tagstock$add', [this.user.id, tag.id, this.baseItem.id]); //.uqs.mi.TagStock.add(param);\r\n      let newTag = {\r\n        tag: {\r\n          id: tag.id,\r\n        }\r\n      }\r\n      this.stockTags.push(newTag);\r\n      await this.cApp.AddTagStockID(tag.id, this.baseItem.id);\r\n    }\r\n    else {\r\n      let ret = await this.cApp.miApi.call('t_tagstock$del', [this.user.id, tag.id, this.baseItem.id]); // //await this.uqs.mi.TagStock.del(param);\r\n      let i = this.stockTags.findIndex(v => v.tag.id === tag.id);\r\n      this.stockTags.splice(i, 1);\r\n      await this.cApp.RemoveTagStockID(tag.id, this.baseItem.id);\r\n    }\r\n  }\r\n\r\n  onClickDefaultTag = async (isSelected: boolean) => {\r\n    let tagid = this.cApp.defaultListTagID;\r\n    if (isSelected === true) {\r\n      let ret = await this.cApp.miApi.call('t_tagstock$add', [this.user.id, tagid, this.baseItem.id]); //.uqs.mi.TagStock.add(param);\r\n      let newTag = {\r\n        tag: {\r\n          id: tagid,\r\n        }\r\n      }\r\n      this.stockTags.push(newTag);\r\n      await this.cApp.AddTagStockID(tagid, this.baseItem.id);\r\n    }\r\n    else {\r\n      let ret = await this.cApp.miApi.call('t_tagstock$del', [this.user.id, tagid, this.baseItem.id]); // //await this.uqs.mi.TagStock.del(param);\r\n      let i = this.stockTags.findIndex(v => v.tag.id === tagid);\r\n      this.stockTags.splice(i, 1);\r\n      await this.cApp.RemoveTagStockID(tagid, this.baseItem.id);\r\n    }\r\n  }\r\n\r\n  showSelectStock = async (day:number): Promise<any> => {\r\n    let cStock = new CStock(this.cApp);\r\n    let item = await cStock.call() as any;\r\n    let b = {...item}\r\n    b.day = day;\r\n    this.baseItem = b;\r\n    this.loaded = false;\r\n    await this.loading();\r\n  }\r\n\r\n  changeDay = async (day:number) => {\r\n    if (this.baseItem.day === day)\r\n      return;\r\n    let {id, name, code, symbol} = this.baseItem;\r\n    let ni = {id:id, name:name, code:code, symbol:symbol, day:day ===0 ? undefined : day};\r\n    this.baseItem = ni;\r\n    this.loaded = false;\r\n    await this.loading();\r\n  }\r\n}\r\n","import React from 'react';\r\nimport { NavView, start } from 'tonva';\r\n//import logo from './logo.svg';\r\nimport './App.css';\r\nimport { appConfig, CMiApp } from './UqApp';\r\n/*\r\nfunction App() {\r\n  return (\r\n    <div className=\"App\">\r\n      <header className=\"App-header\">\r\n        <img src={logo} className=\"App-logo\" alt=\"logo\" />\r\n        <p>\r\n          Edit <code>src/App.tsx</code> and save to reload.\r\n        </p>\r\n        <a\r\n          className=\"App-link\"\r\n          href=\"https://reactjs.org\"\r\n          target=\"_blank\"\r\n          rel=\"noopener noreferrer\"\r\n        >\r\n          Learn React\r\n        </a>\r\n      </header>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;\r\n*/\r\nclass App extends React.Component {\r\n  \r\n\tprivate onLogined = async () => {\r\n\t  await start(CMiApp, appConfig);\r\n\t}\r\n\tpublic render() {\r\n\t  return <NavView onLogined={this.onLogined} />\r\n\t}\r\n}\r\n\r\nexport default App;\r\n  ","import { ReportHandler } from 'web-vitals';\r\n\r\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\r\n  if (onPerfEntry && onPerfEntry instanceof Function) {\r\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\r\n      getCLS(onPerfEntry);\r\n      getFID(onPerfEntry);\r\n      getFCP(onPerfEntry);\r\n      getLCP(onPerfEntry);\r\n      getTTFB(onPerfEntry);\r\n    });\r\n  }\r\n};\r\n\r\nexport default reportWebVitals;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport 'bootstrap/dist/css/bootstrap.css';\r\nimport './index.css';\r\nimport App from './App';\r\nimport reportWebVitals from './reportWebVitals';\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n","export class SlrForEarning {\r\n  slope: number;\r\n  intercept: number;\r\n  y: number[];\r\n  slopeR: number;\r\n  endY: number;\r\n  r2: number;\r\n\r\n  constructor(y:number[]) {\r\n    this.y = y;\r\n    this.regress();\r\n    let score = this.score();\r\n    this.r2 = score.r2;\r\n  }\r\n\r\n  regress() {\r\n    const n = this.y.length;\r\n    let xSum = 0;\r\n    let ySum = 0;\r\n  \r\n    let xSquared = 0;\r\n    let xY = 0;\r\n  \r\n    for (let x = 0; x < n; ++x) {\r\n      xSum += x;\r\n      ySum += this.y[x];\r\n      xSquared += x * x;\r\n      xY += x * this.y[x];\r\n    }\r\n  \r\n    const numerator = n * xY - xSum * ySum;\r\n    this.slope = numerator / (n * xSquared - xSum * xSum);\r\n    this.intercept = (1 / n) * ySum - this.slope * (1 / n) * xSum;\r\n\r\n    let ym = this.slope > 0 ? this.predict(n-2) : this.predict(1);\r\n    this.slopeR = ym < 0.01 ? undefined : this.slope / ym;\r\n  }\r\n\r\n  score() {\r\n    const n = this.y.length;\r\n    const y2 = new Array(n);\r\n    for (let i = 0; i < n; i++) {\r\n      y2[i] = this.predict(i);\r\n    }\r\n\r\n    let xSum = 0;\r\n    let ySum = 0;\r\n    let chi2 = 0;\r\n    let rmsd = 0;\r\n    let xSquared = 0;\r\n    let ySquared = 0;\r\n    let xY = 0;\r\n    for (let i = 0; i < n; i++) {\r\n      let yi2 = y2[i];\r\n      xSum += yi2;\r\n      let yi = this.y[i];\r\n      ySum += yi;\r\n      xSquared += yi2 * yi2;\r\n      ySquared += yi * yi;\r\n      xY += yi2 * yi;\r\n      let yiyi2 = yi - yi2;\r\n      if (yi !== 0) {\r\n        chi2 += (yiyi2 * yiyi2) / yi;\r\n      }\r\n      rmsd += yiyi2 * yiyi2;\r\n    }\r\n\r\n    const r =\r\n      (n * xY - xSum * ySum) /\r\n      Math.sqrt((n * xSquared - xSum * xSum) * (n * ySquared - ySum * ySum));\r\n\r\n    return {\r\n      r: r,\r\n      r2: r * r,\r\n      chi2: chi2,\r\n      rmsd: Math.sqrt(rmsd / n)\r\n    };\r\n  }\r\n\r\n\r\n  predict(x:number) {\r\n    return this.slope * x + this.intercept;\r\n  }\r\n\r\n  computeX(y:number) {\r\n    return (y - this.intercept) / this.slope;\r\n  }\r\n}\r\n","export class ErForEarning {\r\n  A:number;\r\n  B:number;\r\n  y: number[];\r\n  r2: number;\r\n\r\n  constructor(y:number[]) {\r\n    this.y = y;\r\n    this.regress();\r\n    let score = this.score();\r\n    this.r2 = score.r2;\r\n  }\r\n\r\n  regress() {\r\n    const n = this.y.length;\r\n    let xSum = 0;\r\n    let ySum = 0;\r\n  \r\n    let xSquared = 0;\r\n    let xY = 0;\r\n  \r\n    for (let x = 0; x < n; ++x) {\r\n      xSum += x;\r\n      let yx = Math.log(this.y[x]);\r\n      ySum += yx;\r\n      xSquared += x * x;\r\n      xY += x * yx;\r\n    }\r\n  \r\n    const numerator = n * xY - xSum * ySum;\r\n    let slope = numerator / (n * xSquared - xSum * xSum);\r\n    let intercept = (1 / n) * ySum - slope * (1 / n) * xSum;\r\n    this.A = Math.exp(intercept);\r\n    this.B = slope;\r\n  }\r\n\r\n  score() {\r\n    const n = this.y.length;\r\n    const y2 = new Array(n);\r\n    for (let i = 0; i < n; i++) {\r\n      y2[i] = this.predict(i);\r\n    }\r\n\r\n    let xSum = 0;\r\n    let ySum = 0;\r\n    let chi2 = 0;\r\n    let rmsd = 0;\r\n    let xSquared = 0;\r\n    let ySquared = 0;\r\n    let xY = 0;\r\n    for (let i = 0; i < n; i++) {\r\n      let yi2 = y2[i];\r\n      xSum += yi2;\r\n      let yi = this.y[i];\r\n      ySum += yi;\r\n      xSquared += yi2 * yi2;\r\n      ySquared += yi * yi;\r\n      xY += yi2 * yi;\r\n      let yiyi2 = yi - yi2;\r\n      if (yi !== 0) {\r\n        chi2 += (yiyi2 * yiyi2) / yi;\r\n      }\r\n      rmsd += yiyi2 * yiyi2;\r\n    }\r\n\r\n    const r =\r\n      (n * xY - xSum * ySum) /\r\n      Math.sqrt((n * xSquared - xSum * xSum) * (n * ySquared - ySum * ySum));\r\n\r\n    return {\r\n      r: r,\r\n      r2: r * r,\r\n      chi2: chi2,\r\n      rmsd: Math.sqrt(rmsd / n)\r\n    };\r\n  }\r\n\r\n  predict(x:number) {\r\n    return this.A * Math.exp(x * this.B);\r\n  }\r\n}\r\n","//=== UqApp builder created on Mon Feb 15 2021 23:34:19 GMT-0500 (GMT-05:00) ===//\r\nimport { CSub, CBase, CAppBase, IConstructor } from 'tonva';\r\n//import { UQs } from './uqs';\r\n//import { CApp } from './CApp';\r\n\r\nexport abstract class CUqBase extends CBase {\r\n}\r\n\r\nexport abstract class CUqSub extends CSub<any> {\r\n}\r\n\r\nexport abstract class CUqApp extends CAppBase {\r\n\tprotected newC<T extends CUqBase>(type: IConstructor<T>): T {\r\n\t\tlet c = new type(this);\r\n\t\tc.init();\r\n\t\treturn c;\r\n\t}\r\n}\r\n","export const consts = {\r\n    uqBasedata: \"bruce/mi\",\r\n    appIcon: 'https://tv.jkchemical.com/imgs/Bear-icon.png',\r\n    miApiHost: 'https://note.jjol.cn/',\r\n    miApiHostDebug: 'http://localhost:6010/',\r\n    isDevelopment: process.env.NODE_ENV === 'development',\r\n}","export default __webpack_public_path__ + \"static/media/logo.2d27ead7.svg\";","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport * as React from 'react';\r\nimport { View, nav } from 'tonva';\r\nimport { LMR, FA, SearchBox } from 'tonva';\r\nimport logo from '../images/logo.svg';\r\nimport { CHome } from './CHome';\r\n\r\nexport class VSiteHeader extends View<CHome> {\r\n    render() {\r\n        let currentSalesRegion = <FA name=\"globe\" />\r\n        let login = <div>\r\n            登录\r\n        </div>\r\n        let left = <img className=\"m-1\" src={logo} alt=\"logo\" style={{height: \"3rem\", width: \"3rem\"}} />;\r\n        //let cart = this.controller.cApp.cCart.renderCartLabel();\r\n        let right = undefined;\r\n        /*\r\n        <div className=\"d-flex flex-row mr-1 align-items-center\">\r\n            {currentSalesRegion} &nbsp;\r\n            <button onClick={()=>nav.start()}>Try</button>\r\n        </div>;*/\r\n        return <LMR\r\n            className=\"mb-3 align-items-center bg-white\"\r\n            left={left} right={right}>\r\n            <div className=\"\">\r\n                {this.controller.renderSearchHeader('md')}\r\n            </div>\r\n        </LMR>\r\n    }\r\n}","import * as React from 'react';\r\nimport { View } from 'tonva';\r\nimport { CHome } from './CHome';\r\nimport { SearchBox } from 'tonva';\r\n\r\nexport class VSearchHeader extends View<CHome> {\r\n\r\n    private onSearch = async (key: string) => {\r\n        // let { cProduct } = this.controller.cApp;\r\n        // cProduct.start(key);\r\n    }\r\n\r\n    render(param: any) {\r\n        return <SearchBox className=\"px-1 w-100\" \r\n            size={param}\r\n            onSearch={this.onSearch} \r\n            placeholder=\"功能...\" />\r\n    }\r\n}","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport * as React from 'react';\r\nimport { FA, LMR } from 'tonva';\r\nimport { NStockInfo } from '../stockinfo';\r\nimport {percent0, percent1, number, numberToMarketValue, calculateZZ3} from '../tool';\r\n\r\nfunction renderSortCol(type:string, caption:string, sort: (sortType:string) => void, checked:boolean = false) {\r\n\treturn <label className=\"btn btn-outline-info mb-0\">\r\n\t\t<input type=\"radio\" className=\"btn-sm btn-check mr-1\"\r\n\t\t\tname=\"btnradio\" defaultChecked={checked}\r\n\t\t\tonClick={() => sort(type)} />\r\n\t\t{caption}\r\n\t</label>\r\n}\r\n\r\nexport function renderSortHeaders(sort: (sortType:string) => void) {\r\n\treturn <div className=\"my-1 justify-content-end mr-3\">\r\n\t\t<div className=\"btn-group\" role=\"group\" aria-label=\"Basic radio toggle button group\">\r\n\t\t\t{renderSortCol('tagv', '米息率', sort, true)}\r\n\t\t\t{renderSortCol('tagpe', 'TTM', sort)}\r\n\t\t\t{renderSortCol('tagdp', '股息率', sort)}\r\n\t\t</div>\r\n\t</div>;\r\n}\r\n\r\nfunction renderValue(caption:string, value:number, valueType:'p0'|'p1'|'n1'|'n2'|'yi'):JSX.Element {\r\n\tconst _cn = 'px-2 mb-2 text-right '; \r\n\tlet cn = _cn + 'c5';\r\n\tlet cnYI = _cn + 'c5'\r\n\tlet vStr:string;\r\n\tswitch (valueType) {\r\n\t\tcase 'p0': vStr = percent0(value); break;\r\n\t\tcase 'p1': vStr = percent1(value); break;\r\n\t\tcase 'n1': vStr = number(value, 1); break;\r\n\t\tcase 'n2': vStr = number(value, 2); break;\r\n\t\tcase 'yi': \r\n\t\t\tvStr = numberToMarketValue(value);\r\n\t\t\tcn = cnYI;\r\n\t\t\tbreak;\r\n\t}\r\n\treturn <div key={caption} className={cn}>\r\n\t\t<span className=\"text-muted small\">{caption}</span><br />\r\n\t\t{vStr}\r\n\t</div>;\r\n}\r\n\r\nexport function renderStockInfoRow(row: NStockInfo, onClickName: (row:NStockInfo) => void, right:JSX.Element):JSX.Element {\r\n  \tlet { id, name, code, pe, roe, price, divyield, v, order, symbol, l, e, ep, e3, total } = row;\r\n  \tlet zzl = calculateZZ3((row as any).dataArr);\r\n  \tlet left = <div className=\"ml-3 cursor-pointer\" onClick={()=>onClickName(row)}>\r\n\t\t<span className=\"text-primary\">{name}</span>\r\n\t\t&nbsp; \r\n\t\t<span className=\"text-info\">{code}</span>\r\n\t  \t&nbsp;\r\n\t\t<span className=\"small ml-5\">{order}</span>\r\n  \t</div>;\r\n\tlet rows:[string,number,'p0'|'p1'|'n1'|'n2'|'yi'][] = [\r\n\t\t['米息率', v, 'n1'],\r\n\t\t['TTM', pe, 'n1'],\r\n\t\t['股息率', divyield*100, 'n1'],\r\n\t\t['价格', price, 'n2'],\r\n\t\t['ROE', roe*100, 'n1'],\r\n\t\t['增1', zzl[0], 'p0'],\r\n\t\t['增2', zzl[1], 'p0'],\r\n\t\t['增3', zzl[2], 'p0'],\r\n\t\t['增4', zzl[3], 'p0'],\r\n\t\t['预增', l, 'p0'],\r\n\t\t['市值', total*price, 'yi'],\r\n  \t];\r\n  \treturn <div className=\"d-block\">\r\n\t\t<LMR className=\"px-1 py-1\" left={left} right = {right} />\r\n\t\t<div className=\"d-flex flex-wrap\" >\r\n\t\t\t{rows.map(v => renderValue(v[0], v[1], v[2]))}\r\n\t  \t</div>\r\n  \t</div>;\r\n}\r\n","export function numberToFixString(n: number, w = 2) {\r\n    return n === undefined ? '' : n.toFixed(w);\r\n}\r\n\r\nexport function number(n: number, w=2) {\r\n\treturn n === undefined ? '' : n.toFixed(w);\r\n}\r\n\r\nexport function numberToMarketValue(n: number) {\r\n\treturn n === undefined || isNaN(n) ? '' : Math.round(n/10000).toString(); // + '亿';\r\n}\r\n\r\nexport function numberToString(n: number, precision = 2) {\r\n\treturn n === undefined ? '' : n.toPrecision(precision);\r\n}\r\n\r\nexport function numberToPrecision(n: number, precision = 4) {\r\n\treturn n === undefined ? undefined : Number.parseFloat(n.toPrecision(precision));\r\n}\r\n\r\nexport function percentToFixString(n: number) {\r\n\treturn n === undefined || isNaN(n) ? '' : (n * 100).toFixed(2) + '%';\r\n}\r\n\r\nexport function percent0(n: number) {\r\n\treturn n === undefined || isNaN(n) ? '' : (n * 100).toFixed(0) + '%';\r\n}\r\nexport function percent1(n: number) {\r\n\treturn n === undefined || isNaN(n) ? '' : (n * 100).toFixed(1) + '%';\r\n}\r\n\r\nexport function warningTypeString(t: string) {\r\n\tswitch (t) {\r\n\t\tcase 'gt': return '大于';\r\n\t\tcase 'lt': return '小于';\r\n\t\tdefault: return t;\r\n\t}\r\n}\r\n\r\nexport function predictCutRatio(r2:number) {\r\n\treturn r2 * 2 - r2 * r2;\r\n}\r\n\r\nexport function evaluatePricePrice(iRate:number, e1:number, e2:number, e3:number) {\r\n\tlet r = 1 + iRate;\r\n\tlet r2 = r * r;\r\n\tlet r3 = r2 * r;\r\n\treturn (e1/r + e2 /r2 + e3 / r3 + e3 / iRate / r3) / 2;\r\n}\r\n\r\nexport function calculateV(z:number, divyield:number, pe:number) {\r\n\tif (pe === undefined || isNaN(pe)) {\r\n\t\treturn undefined;\r\n\t}\r\n\r\n\tlet r = 0;\r\n\tif (z !== undefined) {\r\n\t\tif (z > 0.25) {\r\n\t\tz = 0.25;\r\n\t\t}\r\n\t\tr += z * 100;\r\n\t}\r\n\tif (divyield !== undefined) {\r\n\t\tr += divyield * 100;\r\n\t}\r\n\treturn r / pe;\r\n}\r\n\r\nexport function calculateVN(z:number, e:number, bonus:number, price:number) {\r\n\tif (price === undefined || isNaN(price) || e === undefined || isNaN(e)) {\r\n\t\treturn undefined;\r\n\t}\r\n\r\n\tlet r = 0;\r\n\tif (z !== undefined && e > 0) {\r\n\t\tif (z > 0.25) {\r\n\t\tz = 0.24 + Math.pow((z-0.24)*100, 0.6667) / 100;\r\n\t\t}\r\n\t\tz = 1 + z;\r\n\t\tz = z * z * z - 1;\r\n\t\tr += z * e * 100;\r\n\t}\r\n\tif (bonus !== undefined && !isNaN(bonus)) {\r\n\t\tr += bonus * 100;\r\n\t}\r\n\treturn r / price;\r\n}\r\n\r\nexport function calculateZZ3(data:number[]) {\r\n\tlet ret:number[] = [undefined, undefined, undefined, undefined] ;\r\n\tif (data === undefined)\r\n\t\treturn ret;\r\n\tlet len = data.length;\r\n\tif (len < 5)\r\n\t\treturn ret;\r\n\r\n\tlet funcz = (n:number, p:number) => {\r\n\t\tif (p <= 0 || n <= 0)\r\n\t\treturn undefined;\r\n\t\treturn ((n / p) - 1);\r\n\t}\r\n\tfor (let i = 0; i < 4; ++i) {\r\n\t\tret[i] = funcz(data[i+1], data[i]);\r\n\t}\r\n\treturn ret;\r\n}\r\n\r\n//export function caption = (value:string) => <span className=\"text-muted small\">{value}</span>;\r\n\r\nexport function MonthnoFromDay(day:number) {\r\n\tlet year = Math.floor(day/10000);\r\n\tlet month = Math.floor((day%10000)/100) - 1;\r\n\treturn (year-1995)*12+month;\r\n}\r\n\r\nexport function SeasonnoFromDay(day:number) {\r\n\tlet year = Math.floor(day/10000);\r\n\tlet month = Math.floor((day%10000)/100) - 1;\r\n\tlet season = Math.floor(month / 3);\r\n\treturn (year-1995)*4 + season;\r\n}\r\n\r\nexport function SeasonnoFromYearMonth(year:number, month:number) {\r\n\tlet season = Math.floor((month-1) / 3);\r\n\treturn (year-1995)*4 + season;\r\n}\r\n\r\nexport function SeasonnoToYearMonth(no: number) {\r\n\tlet year = Math.floor(no / 4) + 1995;\r\n\tlet month = (Math.floor(no % 4) + 1) * 3;\r\n\treturn year * 100 + month;\r\n}\r\n\r\nexport function SeasonnoToBeginEnd(season:number) {\r\n\tlet year = (1995 + Math.floor(season / 4)) * 10000;\r\n\tlet s = season % 4;\r\n\tif (s === 0) {\r\n\t\treturn {begin: year + 101, end: year + 331};\r\n\t} \r\n\tif (s === 1) {\r\n\t\treturn {begin: year + 401, end: year + 630};\r\n\t}\r\n\tif (s === 2) {\r\n\t\treturn {begin: year + 701, end: year + 930};\r\n\t}\r\n\treturn {begin: year + 1001, end: year + 1231};\r\n}\r\n\r\nexport function CalculatePredictAvg(arr: {predictpe:number}[]) {\r\n\tlet ret : {avg20:number, avg50:number, avg100:number} = {avg20:undefined, avg50:undefined, avg100:undefined};\r\n\r\n\tlet length = arr.length;\r\n\tlet calcuOne = (count:number) : number => {\r\n\t\tlet endIndex = count;\r\n\t\tif (endIndex > length)\r\n\t\tendIndex = length;\r\n\t\tif (endIndex >= 10) {\r\n\t\tlet sum = 0;\r\n\t\tfor (let i = 3; i < endIndex; ++i) {\r\n\t\t\tsum += arr[i].predictpe\r\n\t\t}\r\n\t\treturn sum / (endIndex - 3);\r\n\t\t}\r\n\t\telse {\r\n\t\treturn undefined;\r\n\t\t}\r\n\t}\r\n\r\n\tret.avg20 = calcuOne(20);\r\n\tret.avg50 = calcuOne(50);\r\n\tret.avg100 = calcuOne(100);\r\n\treturn ret;\r\n}\r\n\r\nexport function CalculateValueAvg(arr: {v:number}[]) {\r\n\tlet ret : {avg20:number, avg50:number, avg100:number, avg:number} = {avg20:undefined, avg50:undefined, avg100:undefined, avg:undefined};\r\n\r\n\tlet length = arr.length;\r\n\tlet calcuOne = (count:number) : number => {\r\n\t\tlet endIndex = count;\r\n\t\tif (count === 0 || endIndex > length)\r\n\t\tendIndex = length;\r\n\t\tif (endIndex >= 10) {\r\n\t\tlet sum = 0;\r\n\t\tfor (let i = 3; i < endIndex; ++i) {\r\n\t\t\tsum += arr[i].v;\r\n\t\t}\r\n\t\treturn sum / (endIndex - 3);\r\n\t\t}\r\n\t\telse {\r\n\t\treturn undefined;\r\n\t\t}\r\n\t}\r\n\r\n\tret.avg20 = calcuOne(20);\r\n\tret.avg50 = calcuOne(50);\r\n\tret.avg100 = calcuOne(100);\r\n\tret.avg = calcuOne(0);\r\n\treturn ret;\r\n}\r\n","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport * as React from 'react';\r\nimport { observer } from 'mobx-react';\r\nimport { VPage, Page, View, List, LMR, FA, Scroller } from 'tonva';\r\nimport { NStockInfo } from '../stockinfo';\r\nimport { CHome } from './CHome';\r\nimport { renderSortHeaders, renderStockInfoRow } from '../tool';\r\n\r\nexport class VHome extends VPage<CHome> {\r\n\r\n/*\r\n  render(param: any): JSX.Element {\r\n    return <this.page />\r\n  }\r\n\r\n  private page = observer(() => {\r\n    let { openMetaView, onPage } = this.controller;\r\n    // let viewMetaButton = <></>;\r\n    // if (this.controller.isLogined) {\r\n    //   viewMetaButton = <button type=\"button\" className=\"btn w-100\" onClick={openMetaView}>view</button>\r\n    // }\r\n\tlet right = ;\r\n\r\n    return <Page header=\"首页\" right={right} onScrollBottom={onPage}\r\n      headerClassName='bg-primary py-1 px-3'>      \r\n      <this.content />\r\n    </Page>;\r\n  })\r\n*/\r\n  header() {return '首页'}\r\n  right() {\r\n\treturn <button className=\"btn btn-sm btn-info\"\r\n\t\tonClick={()=>{this.controller.openMarketPE()}}>\r\n\t\t市场平均PE\r\n\t</button>;\r\n  }\r\n\r\n  protected onPageScrollBottom(scroller: Scroller): Promise<void> {\r\n\tthis.controller.onPage();\r\n\treturn;\r\n  }\r\n\r\n  private setSortType = (type:string) => {\r\n    this.controller.setSortType(type);\r\n  }\r\n\r\n  content() {\r\n\t  return React.createElement(observer(() => {\r\n      let title = this.controller.cApp.config.tagName;\r\n      let { items } = this.controller;\r\n      let { onSelectTag, onAddStock } = this.controller;\r\n      let right = <div className=\"d-flex\">\r\n        <div className=\"btn cursor-pointer\" onClick={onAddStock}><FA name=\"plus\" inverse={false} /></div>\r\n        <div className=\"btn cursor-pointer ml-2\" onClick={onSelectTag}><FA name=\"bars\" inverse={false} /></div>\r\n      </div>;\r\n      let left = <div className=\"align-self-center\">{title}</div>\r\n      return <div>\r\n      <LMR className=\"px-3 py-1\" left={left} right={right}></LMR>\r\n      <List header={renderSortHeaders(this.setSortType)}\r\n        items={items}\r\n        item={{ render: this.renderRow, key: this.rowKey }}\r\n        before={'搜索'}\r\n        none={'----'}\r\n      />\r\n      </div>;\r\n    }));\r\n  }\r\n\r\n  renderRow = (item: any, index: number): JSX.Element => <this.rowContent {...item} />;\r\n  protected rowContent = (row: any): JSX.Element => {\r\n    let { symbol } = row as NStockInfo;\r\n    let right = <div className=\"d-flex\">\r\n        <a className=\"px-3 text-info\" href={`https://finance.sina.com.cn/realstock/company/${symbol}/nc.shtml`} target=\"_blank\" rel=\"noopener noreferrer\" onClick={(e)=>{e.stopPropagation();}}>新浪财经</a>\r\n      </div>;\r\n\treturn renderStockInfoRow(row, this.onClickName, right);\r\n  }\r\n\r\n  private rowKey = (item: any) => {\r\n    let { id } = item;\r\n    return id;\r\n  }\r\n\r\n  protected onClickName = (item: NStockInfo) => {\r\n    this.controller.openStockInfo(item);\r\n  }\r\n\r\n  protected onSelected = async (item: any): Promise<void> => {\r\n    let a = 0;\r\n  }\r\n\r\n  private callOnSelected(item: any) {\r\n    if (this.onSelected === undefined) {\r\n      alert('onSelect is undefined');\r\n      return;\r\n    }\r\n    this.onSelected(item);\r\n  }\r\n  clickRow = (item: any) => {\r\n    this.callOnSelected(item);\r\n  }\r\n}","import * as React from 'react';\r\nimport { observer } from 'mobx-react-lite';\r\nimport { VPage, Page, List } from 'tonva';\r\nimport { CHome } from './CHome';\r\n\r\nexport class VSelectTag extends VPage<CHome> {\r\n    async open(param?: any) {\r\n        this.openPage(this.page);\r\n    }\r\n\r\n    private renderTag = (tag:any) => {\r\n        return <div className=\"px-3 py-2 cursor-pointer\">{tag.name}</div>;\r\n    }\r\n\r\n    private page = observer(() => {\r\n        let {tags} = this.controller.cApp;\r\n        let { onClickTag } = this.controller;\r\n        return <Page header=\"选择分组\" headerClassName=\"bg-primary\">\r\n            <List items={tags} item={{onClick:onClickTag, render:this.renderTag}} />\r\n        </Page>;\r\n    })\r\n}\r\n","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport * as React from 'react';\r\nimport classNames from 'classnames';\r\nimport { VPage, Page, View, List, LMR, left0, FA } from 'tonva';\r\nimport { observable } from 'mobx';\r\nimport { observer } from 'mobx-react';\r\nimport RC2 from 'react-chartjs2'\r\nimport { GFunc } from '../tool/GFunc';\r\nimport {CMarketPE } from './CMarketPE'\r\n\r\nexport class VMarketPE extends VPage<CMarketPE> {\r\n  private input: HTMLInputElement;\r\n  private key: string = undefined;\r\n\r\n  async open(param?: any) {\r\n    this.openPage(this.page);\r\n  }\r\n\r\n  render(param: any): JSX.Element {\r\n    return <this.page />\r\n  }\r\n\r\n  checkLimitShow = (e)=> {\r\n    let check = e.target.checked as boolean;\r\n    let f = check ? 1:0;\r\n    this.controller.onLongShortFlag(f);\r\n  }\r\n\r\n  private page = observer(() => {\r\n  let head = <div >{''}</div>\r\n    return <Page header={head}\r\n      headerClassName='bg-primary'>\r\n      <this.pageContent />\r\n    </Page>;\r\n  })\r\n\r\n  private pageContent = observer(() => {\r\n    return <>\r\n      <this.historyChart />\r\n    </>\r\n  });\r\n\r\n  protected historyChart = observer(() => {\r\n    let {historyData} = this.controller;\r\n    if (historyData === undefined) \r\n      return <></>;\r\n    let chartHistory = <></>;\r\n    let labelList:any[] = [];\r\n    let peList:number[] = [];\r\n    let eList:number[] = [];\r\n    for (let item of historyData) {\r\n      let {day, pe, e} = item;\r\n      labelList.push(day);\r\n      peList.push(GFunc.numberToPrecision(pe, 4));\r\n      eList.push(e);\r\n    }\r\n    let chartdata1 = {\r\n      labels: labelList,\r\n      datasets: [\r\n        {\r\n          label: 'PE',\r\n          data: peList,\r\n          borderColor:'blue',\r\n          backgroundColor:'skyBlue',\r\n          borderWidth: 1,\r\n          fill: false,\r\n          yAxisID: 'y-axis-1',\r\n        },\r\n        {\r\n          label: 'e',\r\n          data: eList,\r\n          borderColor:'red',\r\n          backgroundColor:'pink',\r\n          borderWidth: 1,\r\n          fill: false,\r\n          yAxisID: 'y-axis-2',\r\n        }\r\n      ]\r\n    };\r\n    let options = {\r\n      scales:{\r\n        yAxes: [{\r\n          type: 'linear',\r\n          display: true,\r\n          position: 'right',\r\n          id: 'y-axis-1',\r\n        }, {\r\n          type: 'linear',\r\n          display: true,\r\n          position: 'left',\r\n          id: 'y-axis-2',\r\n          gridLines: {\r\n              drawOnChartArea: false\r\n          }\r\n        }],    \r\n      }\r\n    }\r\n    chartHistory = <RC2 data={chartdata1} type='line' options={options} />;\r\n    let right = <></>;\r\n    right = <label className=\"px-3\"> <input type=\"checkbox\" name=\"selectType\" defaultChecked={false}\r\n    onChange={this.checkLimitShow} />长期</label>;\r\n    return <><LMR className=\"px-3 py-2 bg-white\" left={'市场PE历史走势'} right={right}></LMR>\r\n      <div className=\"px-3\" style={{width:'95%'}}>{chartHistory}</div>\r\n    </>;\r\n  });\r\n\r\n\r\n}","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport { observable } from 'mobx';\r\nimport { CUqBase } from '../UqApp';\r\nimport { VMarketPE } from './VMarketPE';\r\n\r\nexport class CMarketPE extends CUqBase {\r\n    @observable historyData:{day:number, pe:number, e:number}[] =  [];\r\n    private longshortFlag:number = 0;\r\n\r\n    async internalStart(param: any) {\r\n        this.loadData();\r\n        this.openVPage(VMarketPE as any);\r\n    }\r\n\r\n    loadData = async () => {\r\n        let dt = new Date();\r\n        let param = [dt.getFullYear()*10000+(dt.getMonth()+1)*100+dt.getDate(), 750, this.longshortFlag];\r\n        let rets = await this.cApp.miApi.query('q_marketpe', param) as {day:number, pe:number, e:number}[];\r\n        this.historyData = rets.reverse();\r\n    }\r\n\r\n    onLongShortFlag(f:number) {\r\n        if (f === this.longshortFlag)\r\n            return;\r\n        this.longshortFlag = f;\r\n        this.loadData();\r\n    }\r\n}","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport * as React from 'react';\r\nimport { observable, IObservableArray, autorun } from 'mobx';\r\nimport { ErForEarning, SlrForEarning } from 'regression';\r\nimport { UserTag } from '../types';\r\nimport { CUqBase } from '../UqApp';\r\nimport { CStockInfo, NStockInfo } from '../stockinfo';\r\nimport { VSiteHeader } from './VSiteHeader';\r\nimport { VSearchHeader } from './VSearchHeader';\r\nimport { VHome } from './VHome';\r\nimport { VSelectTag } from './VSelectTag';\r\nimport { GFunc } from 'tool/GFunc';\r\nimport { CMarketPE } from './CMarketPE';\r\nimport { CStock } from 'stock';\r\n\r\nexport class CHome extends CUqBase {\r\n  //PageItems: HomePageItems = new HomePageItems(this);\r\n  items: IObservableArray<any> = observable.array<any>([], { deep: true });\r\n  userTag: UserTag;\r\n  protected oldSortType: string;\r\n  @observable warnings: any[] = [];\r\n\r\n  /*\r\n  disposeAutorun = autorun(async () => {\r\n    let needLoad = false;\r\n    let oldID = this.userTag && this.userTag.tagID;\r\n    this.userTag = { tagName: this.cApp.config.tagName, tagID: this.cApp.tagID };\r\n    if (oldID !== this.userTag.tagID) {\r\n      needLoad = true;\r\n    }\r\n\r\n    let newSortType = this.cApp.config.userStock.sortType;\r\n    if (this.oldSortType === undefined) {\r\n      this.oldSortType = newSortType;\r\n    }\r\n    else if (this.oldSortType !== newSortType) {\r\n      this.oldSortType = newSortType;\r\n      needLoad = true;\r\n    }\r\n\r\n    if (needLoad) {\r\n      await this.load();\r\n    }\r\n  });\r\n  */\r\n\r\n  public AddTagStockID(tagid: number, stockID: number) {\r\n    if (this.userTag && this.userTag.tagID === tagid) {\r\n      this.load();\r\n    }\r\n  }\r\n\r\n  public RemoveTagStockID(tagid: number, stockID: number) {\r\n    if (this.userTag && this.userTag.tagID === tagid) {\r\n      //this.PageItems.RemoveStock(stockID);\r\n      let i = this.items.findIndex(v=>{return v.id === stockID})\r\n     if (i >= 0) {\r\n       this.items.splice(i, 1);\r\n     }\r\n    }\r\n  }\r\n\r\n\r\n  onSelectTag = async () => {\r\n    this.openVPage(VSelectTag);\r\n  }\r\n\r\n  onAddStock = async () => {\r\n    let cStock = new CStock(this.cApp);\r\n    let r = await cStock.call() as {id:number};\r\n\r\n    if (r !== undefined) {\r\n      let id = r.id;\r\n      if (id > 0) {\r\n        let tagid = this.cApp.defaultListTagID;\r\n        await this.cApp.miApi.call('t_tagstock$add', [this.user.id, tagid, id]);\r\n        await this.cApp.AddTagStockID(tagid, id);\r\n        await this.load();\r\n      }\r\n    }\r\n  }\r\n\r\n  onClickTag = async (item:any) => {\r\n    await this.cApp.selectTag(item);\r\n    this.closePage();\r\n  }\r\n\r\n  onPage = async () => {\r\n    //this.PageItems.more();\r\n  }\r\n\r\n  onWarningConfg = () => {\r\n    this.cApp.cWarning.onWarningConfg();\r\n  }\r\n\r\n\r\n  // async searchMain(key: any) {\r\n  //   if (key !== undefined) await this.PageItems.first(key);\r\n  // }\r\n\r\n  //作为tabs中的首页，internalStart不会被调用\r\n  async internalStart(param: any) {\r\n  }\r\n\r\n  load = async () => {\r\n    console.log('cHome load Begin')\r\n    let tagID = this.cApp.tagID;\r\n    if (tagID > 0) {\r\n      await this.loadItems();\r\n    }\r\n    console.log('cHome load End')\r\n  }\r\n\r\n  async loadItems() {\r\n    let queryName = 'taguser';\r\n\r\n    let query = {\r\n      name: queryName,\r\n      pageStart: 0,\r\n      pageSize: 1000,\r\n      user: this.user.id,\r\n      tag: this.cApp.tagID,\r\n      yearlen: 1,\r\n    };\r\n    let result = await this.cApp.miApi.process(query, []);\r\n    if (Array.isArray(result) === false) {\r\n      return;\r\n    };\r\n    let arr = result as {id:number, order:number, data?:string, v?:number, e:number, e3:number, ep:number, price:number, exprice:number, divyield:number, r2:number, lr2:number, predictpe?:number, dataArr?:number[]}[];\r\n    for (let item of arr) {\r\n      let dataArray = JSON.parse(item.data) as number[];\r\n      item.dataArr = dataArray;\r\n      let sl = new SlrForEarning(dataArray);\r\n      item.ep = (sl.predict(4) + item.e) / 2;\r\n      item.e3 = sl.predict(7);\r\n      item.v = GFunc.calculateVN(sl.slopeR, item.ep, item.divyield * item.price, item.exprice);\r\n      item.predictpe = item.price / item.e3;\r\n    }\r\n    this.cApp.sortStocks(arr);\r\n    let o = 1;\r\n    for (let item of arr) {\r\n      item.order = o;\r\n      ++o;\r\n    }\r\n    this.items.clear();\r\n    this.items.push(...arr);\r\n  }\r\n\r\n  setSortType = (type:string) => {\r\n    this.cApp.setUserSortType(type);\r\n    let arr = this.items.slice();\r\n    this.cApp.sortStocks(arr);\r\n\r\n    this.items.replace(arr);\r\n  }\r\n\r\n  async loadWarning() {\r\n    let r = await this.cApp.miApi.query('q_warnings', [this.cApp.user.id]);\r\n    if (r !== undefined && Array.isArray(r)) {\r\n      this.warnings = r;\r\n    }\r\n    else {\r\n      if (this.warnings.length > 0) {\r\n        this.warnings = [];\r\n      }\r\n    }\r\n  }\r\n\r\n  renderSiteHeader = () => {\r\n    return this.renderView(VSiteHeader);\r\n  }\r\n\r\n  renderSearchHeader = (size?: string) => {\r\n    return this.renderView(VSearchHeader, size);\r\n  }\r\n\r\n\r\n  renderHome = () => {\r\n    console.log('cHome renderHome')\r\n    return this.renderView(VHome);\r\n  }\r\n\r\n  openMetaView = () => {\r\n  }\r\n\r\n  tab = () => <this.renderHome />;\r\n\r\n  openStockInfo = (item: NStockInfo) => {\r\n    let cStockInfo = this.newC(CStockInfo);\r\n    cStockInfo.start(item);\r\n  }\r\n\r\n  openMarketPE = () => {\r\n    let cm = this.newC(CMarketPE);\r\n    cm.start();\r\n  }\r\n}","import { observable } from 'mobx';\r\nimport { observer } from 'mobx-react';\r\nimport React from 'react';\r\nimport { VPage, userApi, User, Image, Page, List, UserView, \r\n\tEdit, ItemSchema, StringSchema, IntSchema, UiSchema, UiTextItem, UiNumberItem, BoolSchema, UiCheckItem } from \"tonva\";\r\nimport { CMe, RootUnitItem } from \"./CMe\";\r\n\r\nexport class VAdmin extends VPage<CMe> {\r\n\theader() {return '管理员'}\r\n\tcontent() {\r\n\t\treturn <div>\r\n\t\t\t<div className=\"px-3 py-3 bg-white border-bottom\">\r\n\t\t\t\t<div><b className=\"text-info\">为用户创建机构</b></div>\r\n\t\t\t\t<div>\r\n\t\t\t\t\t给指定用户创建机构。机构下面的部门和成员，由机构所有者创建。\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"my-2\">\r\n\t\t\t\t\t<button className=\"btn btn-primary\" onClick={()=>this.openVPage(VUser)}>创建</button>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<List items={this.controller.rootUnits} item={{render: this.renderRootUnit, onClick: this.onClickRootUnit}} />\r\n\t\t</div>;\r\n\t}\r\n\r\n\tprivate renderRootUnit = (item: RootUnitItem, index: number) => {\r\n\t\tlet {id, owner, name, tonvaUnit, x} = item;\r\n\t\tlet renderUser = (user:User) => {\r\n\t\t\tlet {name, nick, icon} = user;\r\n\t\t\treturn <>\r\n\t\t\t\t<Image className=\"w-1-5c h-1-5c mr-2\" src={icon || '.user-o'} />\r\n\t\t\t\t{nick || name}\r\n\t\t\t</>\r\n\t\t}\r\n\t\tlet vId = <small className=\"text-muted\">ID={id}</small>;\r\n\t\tlet vName = (x !== 0)? \r\n\t\t\t<del>{name} {vId}</del>\r\n\t\t\t:\r\n\t\t\t<><b>{name}</b> {vId}</>;\r\n\t\treturn <div className={'px-3 py-2 align-items-center '}>\r\n\t\t\t<div className=\"mr-3\">{vName}</div>\r\n\t\t\t<div className=\"small text-muted d-flex align-items-center\"><UserView user={owner as number} render={renderUser} /></div>\r\n\t\t\t{tonvaUnit && <div className=\"ml-auto small text-muted\">tonva={tonvaUnit}</div>}\r\n\t\t</div>;\r\n\t}\r\n\r\n\tprivate onClickRootUnit = (item: RootUnitItem) => {\r\n\t\tlet {name} = item;\r\n\t\tlet schema: ItemSchema[] = [\r\n\t\t\t{ name: 'name', type: 'string' } as StringSchema,\r\n\t\t\t{ name: 'tonvaUnit', type: 'integer' } as IntSchema,\r\n\t\t\t{ name: 'x', type: 'boolean' } as BoolSchema,\r\n\t\t];\r\n\t\tlet uiSchema: UiSchema = {\r\n\t\t\titems: {\r\n\t\t\t\tname: { widget: 'text', label: '机构名称' } as UiTextItem,\r\n\t\t\t\ttonvaUnit: { widget: 'number', label: 'Tonva Unit' } as UiNumberItem,\r\n\t\t\t\tx: {widget: 'checkbox', label: '停用', trueValue: 1, falseValue: 0} as UiCheckItem,\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.openPageElement(<Page header={name}>\r\n            <Edit schema={schema} uiSchema={uiSchema}\r\n                data={item}\r\n                onItemChanged={async (itemSchema: ItemSchema, newValue: any, preValue: any) => {\r\n\t\t\t\t\tawait this.onItemChanged(item, itemSchema, newValue, preValue);\r\n\t\t\t\t}} />\r\n\t\t</Page>);\r\n\t}\r\n\r\n\tprivate onItemChanged = async (item: RootUnitItem, itemSchema: ItemSchema, newValue: any, preValue: any) => {\r\n\t\tswitch (itemSchema.name) {\r\n\t\t\tcase 'name':\r\n\t\t\t\tlet name = newValue.trim();\r\n\t\t\t\tif (name === preValue.trim()) break;\r\n\t\t\t\tawait this.controller.changeRootUnitName(item, name);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'tonvaUnit':\r\n\t\t\t\tawait this.controller.changeRootUnitTonva(item, newValue);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'x':\r\n\t\t\t\tawait this.controller.changeRootUnitX(item, newValue);\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nclass VUser extends VPage<CMe> {\r\n\t@observable private hasError = false;\r\n\t@observable private user:{id:number, name:string, nick:string, icon:string};\r\n\t@observable private inputName: string;\r\n\r\n\theader() {return '机构所有者'}\r\n\tcontent() {\r\n\t\treturn React.createElement(observer(() => {\r\n\t\t\tlet vError:any;\r\n\t\t\tif (this.hasError===true)\r\n\t\t\t\tvError = <div className=\"my-3 text-danger\">用户不存在！</div>;\r\n\t\t\treturn <div className=\"m-3\">\r\n\t\t\t\t<div>\r\n\t\t\t\t\t<input type=\"text\" className=\"form-control\"  maxLength={100}\r\n\t\t\t\t\t\tplaceholder=\"用户\"\r\n\t\t\t\t\t\tonFocus={()=>this.hasError = false}\r\n\t\t\t\t\t\tonKeyDown={this.onKeyDown}\r\n\t\t\t\t\t\tonChange={this.onChange}/>\r\n\t\t\t\t</div>\r\n\t\t\t\t{vError}\r\n\t\t\t\t<div className=\"my-2\">\r\n\t\t\t\t\t<button className=\"btn btn-primary\" disabled={this.inputName?.trim().length===0}\r\n\t\t\t\t\t\tonClick={this.onNext}>下一步</button>\r\n\t\t\t\t</div>\r\n\t\t\t</div>;\r\n\t\t}));\r\n\t}\r\n\r\n\tprivate onKeyDown = async (evt: React.KeyboardEvent<HTMLInputElement>) => {\r\n\t\tthis.hasError = false;\r\n\t\tif (evt.keyCode === 13) {\r\n\t\t\tawait this.onNext();\r\n\t\t}\r\n\t}\r\n\r\n\tprivate onChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\r\n\t\tthis.inputName = evt.currentTarget.value;\r\n\t}\r\n\r\n\tprivate onNext = async () => {\r\n\t\tawait this.search(this.inputName.trim());\r\n\t\tif (this.hasError === false) {\r\n\t\t\tthis.controller.unitOwner = this.user as User;\r\n\t\t\tthis.openVPage(VUnit);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate search = async (key:string) => {\r\n\t\tlet ret = await userApi.fromKey(key);\r\n\t\tif (!ret) {\r\n\t\t\tthis.hasError = true;\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t// if (this.controller.isMe(ret.id)) {\r\n\t\t//\treturn;\r\n\t\t//}\r\n\t\tthis.user = ret;\r\n\t}\r\n}\r\n\r\nclass VUnit extends VPage<CMe> {\r\n\t@observable private input: string;\r\n\r\n\theader() {return '新建机构'}\r\n\tcontent() {\r\n\t\treturn React.createElement(observer(() => {\r\n\t\t\tlet {unitOwner} = this.controller;\r\n\t\t\tlet {icon, name, nick} = unitOwner;\r\n\t\t\treturn <div className=\"m-3\">\r\n\t\t\t\t<div className=\"my-2\">所有者: <Image className=\"w-2c h-2c\" src={icon} /> {nick ?? name} </div>\r\n\t\t\t\t<div>\r\n\t\t\t\t\t<input type=\"text\" className=\"form-control\" maxLength={100}\r\n\t\t\t\t\t\tplaceholder=\"机构名称\" onChange={this.onChange} onKeyDown={this.onKeyDown}/>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"my-2\">\r\n\t\t\t\t\t<button className=\"btn btn-primary\" disabled={this.input?.trim().length===0}\r\n\t\t\t\t\t\tonClick={this.onCreate}>创建机构</button>\r\n\t\t\t\t</div>\r\n\t\t\t</div>;\r\n\t\t}));\r\n\t}\r\n\r\n\tprivate onChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\r\n\t\tthis.input = evt.currentTarget.value;\r\n\t}\r\n\r\n\tprivate onKeyDown = async (evt: React.KeyboardEvent<HTMLInputElement>) => {\r\n\t\tif (evt.keyCode === 13) {\r\n\t\t\tawait this.onCreate();\r\n\t\t}\r\n\t}\r\n\r\n\tprivate onCreate = async () => {\r\n\t\tlet unitId = await this.controller.createRootUnit({\r\n\t\t\tname: this.input.trim(),  \r\n\t\t\tcontent: undefined,\r\n\t\t\towner: this.controller.user.id\r\n\t\t});\r\n\t\tlet header:string = '错误', cn:string = 'text-danger', content:string;\r\n\t\tswitch (unitId) {\r\n\t\t\tdefault:\r\n\t\t\t\theader = '成功';\r\n\t\t\t\tcn = 'text-success';\r\n\t\t\t\tcontent = '机构创建成功！';\r\n\t\t\t\tbreak;\r\n\t\t\tcase -1:\r\n\t\t\t\tcontent = '无权创建机构';\r\n\t\t\t\tbreak;\r\n\t\t\tcase -2:\r\n\t\t\t\tcontent = '机构名称已经被使用了';\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\tthis.openPageElement(<Page header={header} afterBack={()=>this.closePage(3)} back=\"close\">\r\n\t\t\t<div className={'m-3 ' +  cn}>{content}</div>\r\n\t\t</Page>)\r\n\t}\r\n}\r\n","import * as React from 'react';\r\nimport { observable } from 'mobx';\r\nimport {\r\n    userApi, ItemSchema, StringSchema, ImageSchema, UiTextItem, UiImageItem, nav, Page,\r\n    Edit, UiSchema, VPage\r\n} from 'tonva';\r\nimport { CMe } from './CMe';\r\n\r\nexport class VEditMe extends VPage<CMe>{\r\n\r\n    async open(param: any) {\r\n        this.openPage(this.page);\r\n    }\r\n\r\n    private schema: ItemSchema[] = [\r\n        { name: 'nick', type: 'string' } as StringSchema,\r\n        { name: 'icon', type: 'image' } as ImageSchema,\r\n    ];\r\n    private uiSchema: UiSchema = {\r\n        items: {\r\n            nick: { widget: 'text', label: '别名', placeholder: '好的别名更方便记忆' } as UiTextItem,\r\n            icon: { widget: 'image', label: '头像' } as UiImageItem,\r\n        }\r\n    }\r\n    @observable private data: any;\r\n\r\n    constructor(props: any) {\r\n        super(props);\r\n        let { nick, icon } = nav.user;\r\n        this.data = {\r\n            nick: nick,\r\n            icon: icon,\r\n        };\r\n    }\r\n\r\n    private onItemChanged = async (itemSchema: ItemSchema, newValue: any, preValue: any) => {\r\n        let { name } = itemSchema;\r\n        await userApi.userSetProp(name, newValue);\r\n        this.data[name] = newValue;\r\n        nav.user.name = newValue;\r\n        nav.saveLocalUser();\r\n    }\r\n\r\n    private page = () => {\r\n\t\tlet { schema, uiSchema, data, onItemChanged } = this;\r\n\t\tlet vAdmin: any;\r\n\t\t\r\n\t\tlet { role } = this.controller;\r\n\t\tif ((role & 2) === 2) {\r\n\t\t\tvAdmin = <div className=\"px-3 py-2 cursor-pointer bg-white border-bottom\" onClick={this.controller.showAdmin}>管理员</div>;\r\n\t\t}\r\n\r\n        return <Page header=\"个人信息\">\r\n            <Edit schema={schema} uiSchema={uiSchema}\r\n                data={data}\r\n                onItemChanged={onItemChanged} />\r\n\t\t\t{vAdmin}\r\n        </Page>;\r\n    }\r\n}\r\n\r\nexport const webUserSchema: ItemSchema[] = [\r\n    { name: 'firstName', type: 'string', required: true } as StringSchema,\r\n    { name: 'gender', type: 'string' } as StringSchema,\r\n    { name: 'salutation', type: 'string' } as StringSchema,\r\n    { name: 'organizationName', type: 'string', required: true } as StringSchema,\r\n    { name: 'departmentName', type: 'string' } as StringSchema,\r\n];\r\n\r\n","import React from 'react';\r\nimport { observer } from 'mobx-react';\r\nimport { Image, VPage, nav, IconText, PropGrid, LMR, FA, Prop } from 'tonva';\r\nimport { CMe } from './CMe';\r\nimport { appConfig } from '../UqApp';\r\n\r\nexport class VMe extends VPage<CMe> {\r\n\theader() {return this.t('me')}\r\n\r\n\tcontent() {\r\n        const { user } = nav;\r\n        let aboutRows: Prop[] = [\r\n            '',\r\n            {\r\n                type: 'component',\r\n                component: <div className=\"w-100 d-flex justify-content-between\">\r\n                    <IconText iconClass=\"text-info mr-2\" icon=\"smile-o\" text={this.t('aboutTheApp')} />\r\n                    <div className=\"py-2 small\">V{appConfig.version}</div>\r\n                </div>,\r\n            }\r\n        ];\r\n\r\n        let rows: Prop[];\r\n        if (user === undefined) {\r\n            rows = aboutRows;\r\n            rows.push(\r\n                {\r\n                    type: 'component',\r\n                    component: <button className=\"btn btn-success w-100 my-2\" onClick={() => nav.logout()}>\r\n                        <FA name=\"sign-out\" size=\"lg\" /> {this.t('pleaseLogin')}\r\n                    </button>\r\n                },\r\n            );\r\n        }\r\n        else {\r\n            let logOutRows: Prop[] = [\r\n                '',\r\n                {\r\n                    type: 'component',\r\n                    bk: '',\r\n                    component: <button className=\"btn btn-danger w-100\" onClick={this.onExit}>\r\n                        <FA name=\"sign-out\" size=\"lg\" /> {this.t('logout')}\r\n                </button>\r\n                },\r\n            ];\r\n\r\n            rows = [\r\n                '',\r\n                {\r\n                    type: 'component',\r\n                    component: <this.meInfo />\r\n                },\r\n                '',\r\n                {\r\n                    type: 'component',\r\n                    component: <IconText iconClass=\"text-info mr-2\" icon=\"key\" text={this.t('changePassword')} />,\r\n                    onClick: this.changePassword\r\n                },\r\n            ]\r\n            rows.push(...aboutRows, ...logOutRows);\r\n        }\r\n        return <PropGrid rows={[...rows]} values={{}} />;\r\n\t}\r\n\r\n\tprivate onExit = () => {\r\n        nav.showLogout();\r\n    }\r\n\r\n    private changePassword = async () => {\r\n        await nav.changePassword();\r\n    }\r\n\r\n    private meInfo = observer(() => {\r\n        let { user } = nav;\r\n        if (user === undefined) return null;\r\n        let { id, name, nick, icon } = user;\r\n        return <LMR className=\"py-2 cursor-pointer w-100\"\r\n            left={<Image className=\"w-3c h-3c mr-3\" src={icon || '.user-o'} />}\r\n            right={<FA className=\"align-self-end\" name=\"angle-right\" />}\r\n            onClick={this.controller.showEditMe}>\r\n            <div>\r\n                <div>{userSpan(name, nick)}</div>\r\n                <div className=\"small\"><span className=\"text-muted\">ID:</span> {id > 10000 ? id : String(id + 10000).substr(1)}</div>\r\n            </div>\r\n        </LMR>;\r\n    });\r\n}\r\n\r\nfunction userSpan(name: string, nick: string): JSX.Element {\r\n    return nick ?\r\n        <><b>{nick} &nbsp; <small className=\"muted\">{name}</small></b></>\r\n        : <b>{name}</b>\r\n}\r\n","import { QueryPager, User } from \"tonva\";\r\nimport { CUqBase } from \"../UqApp\";\r\nimport { VAdmin } from \"./VAdmin\";\r\nimport { VEditMe } from \"./VEditMe\";\r\nimport { VMe } from \"./VMe\";\r\n\r\nexport interface RootUnitItem {\r\n\tid: number;\t\t\t\t\t// root unit id\r\n\towner: any;\r\n\tname: string;\t\t\t\t// 唯一\r\n\tcontent: string;\r\n\ttonvaUnit: number;\t\t\t// 跟tonva机构对应的值\r\n\tx: number;\r\n}\r\n\r\nexport class CMe extends CUqBase {\r\n\trole: number;\r\n\tunitOwner: User;\r\n\trootUnits: QueryPager<any>;\r\n\r\n    protected async internalStart() {\r\n\t}\r\n\r\n\ttab = () => this.renderView(VMe);\r\n\r\n\tshowEditMe = async () => {\r\n\t\tlet result = await this.uqs.Notes.GetSystemRole.query({});\r\n\t\tthis.role = result.ret[0]?.role;\r\n\t\tthis.openVPage(VEditMe);\r\n\t}\r\n\r\n\tshowAdmin = async () => {\r\n\t\tthis.rootUnits = new QueryPager<any>(this.uqs.Notes.GetRootUnits, undefined, undefined, true);\r\n\t\tthis.rootUnits.first({});\r\n\t\tthis.openVPage(VAdmin);\r\n\t}\r\n\r\n\tasync createRootUnit(param: {name:string; content:string; owner:number}): Promise<number> {\r\n\t\tlet result = await this.uqs.Notes.CreateRootUnit.submit(param);\r\n\t\treturn result.id;\r\n\t}\r\n\r\n\tasync changeRootUnitName(item:RootUnitItem, name:string) {\r\n\t\tawait this.uqs.Notes.ChangeRootUnitProp.submit({unit:item.id, prop:'name', value: name})\r\n\t\titem.name = name;\r\n\t}\r\n\r\n\tasync changeRootUnitTonva(item:RootUnitItem, tonvaUnit:any) {\r\n\t\tawait this.uqs.Notes.ChangeRootUnitProp.submit({unit:item.id, prop:'tonvaUnit', value: tonvaUnit})\r\n\t\titem.tonvaUnit = tonvaUnit;\r\n\t}\r\n\r\n\tasync changeRootUnitX(item:RootUnitItem, x:number) {\r\n\t\tawait this.uqs.Notes.ChangeRootUnitProp.submit({unit:item.id, prop:'x', value: x as any})\r\n\t\titem.x = x;\r\n\t}\r\n}\r\n","import {FetchError} from './fetchError';\r\nimport {HttpChannelUI} from './httpChannelUI';\r\nimport {nav} from 'tonva';\r\nimport { consts } from '../UqApp';\r\n\r\nexport async function httpGet(url:string, params?:any):Promise<any> {\r\n    let channel = new HttpChannel(url, undefined, undefined);\r\n    let ret = await channel.get('', params);\r\n    return ret;\r\n}\r\n\r\nexport async function httpPost(url:string, params?:any):Promise<any> {\r\n    let channel = new HttpChannel(url, undefined, undefined);\r\n    let ret = await channel.post('', params);\r\n    return ret;\r\n}\r\n\r\nexport class HttpChannel {\r\n    private hostUrl: string;\r\n    private apiToken: string;\r\n    private ui?: HttpChannelUI;\r\n    private timeout: number;\r\n\r\n    constructor(hostUrl: string, apiToken:string, ui?: HttpChannelUI) {\r\n        this.hostUrl = hostUrl;\r\n        this.apiToken = apiToken;\r\n        this.ui = ui;\r\n        this.timeout = consts.isDevelopment === true? 500000:20000;\r\n    }\r\n\r\n    private startWait = () => {\r\n        if (this.ui !== undefined) this.ui.startWait();\r\n    }\r\n\r\n    private endWait = (url?:string, reject?:(reason?:any)=>void) => {\r\n        if (this.ui !== undefined) this.ui.endWait();\r\n        if (reject !== undefined) reject('访问webapi超时 ' + url);\r\n    }\r\n\r\n    private showError = async (error:FetchError) => {\r\n        if (this.ui !== undefined) await this.ui.showError(error);\r\n    }\r\n\r\n    used() {\r\n        this.post('', {});\r\n    }\r\n\r\n    async get(url: string, params: any = undefined): Promise<any> {\r\n        if (params) {\r\n            let keys = Object.keys(params);\r\n            if (keys.length > 0) {\r\n                let c = '?';\r\n                for (let k of keys) {\r\n                    let v = params[k];\r\n                    if (v === undefined) continue;\r\n                    url += c + k + '=' + params[k];\r\n                    c = '&';\r\n                }\r\n            }\r\n        }\r\n        let options = this.buildOptions();\r\n        options.method = 'GET';\r\n        return await this.innerFetch(url, options);\r\n    }\r\n\r\n    async post(url: string, params: any): Promise<any> {\r\n        let options = this.buildOptions();\r\n        options.method = 'POST';\r\n        options.body = JSON.stringify(params);\r\n        return await this.innerFetch(url, options);\r\n    }\r\n\r\n    async put(url: string, params: any): Promise<any> {\r\n        let options = this.buildOptions();\r\n        options.method = 'PUT';\r\n        options.body = JSON.stringify(params);\r\n        return await this.innerFetch(url, options);\r\n    }\r\n\r\n    async delete(url: string, params: any): Promise<any> {\r\n        let options = this.buildOptions();\r\n        options.method = 'DELETE';\r\n        options.body = JSON.stringify(params);\r\n        return await this.innerFetch(url, options);\r\n    }\r\n    async fetch(url: string, options: any, resolve:(value?:any)=>any, reject:(reason?:any)=>void):Promise<void> {\r\n        let that = this;\r\n        this.startWait();\r\n        let path = url;\r\n        function buildError(err: string) {\r\n            return {\r\n                channel: that,\r\n                url: path,\r\n                options: options,\r\n                resolve: resolve,\r\n                reject: reject,\r\n                error: err,\r\n            }\r\n        }\r\n        try {\r\n            console.log('%s %s', options.method, path);\r\n            let timeOutHandler = setTimeout(() => that.endWait(url, reject), this.timeout);\r\n            let res = await fetch(encodeURI(path), options);\r\n            if (res.ok === false) {\r\n                clearTimeout(timeOutHandler);\r\n                that.endWait();\r\n                console.log('call error %s', res.statusText);\r\n                throw res.statusText;\r\n            }\r\n            let ct = res.headers.get('content-type');\r\n            if (ct && ct.indexOf('json')>=0) {\r\n                return res.json().then(async retJson => {\r\n                    clearTimeout(timeOutHandler);\r\n                    that.endWait();\r\n                    if (retJson.ok === true) {\r\n                        return resolve(retJson.res);\r\n                    }\r\n                    if (retJson.error === undefined) {\r\n                        await that.showError(buildError('not valid tonva json'));\r\n                    }\r\n                    else {\r\n                        await that.showError(buildError(retJson.error));\r\n                        reject(retJson.error);\r\n                    }\r\n                    //throw retJson.error;\r\n                }).catch(async error => {\r\n                    await that.showError(buildError(error.message));\r\n                });\r\n            }\r\n            else {\r\n                let text = await res.text();\r\n                clearTimeout(timeOutHandler);\r\n                that.endWait();\r\n                resolve(text);\r\n            }\r\n        }\r\n        catch(error) {\r\n            if (typeof error === 'string') {\r\n                if (error.toLowerCase().startsWith('unauthorized') === true) {\r\n                    nav.logout();\r\n                    return;\r\n                }\r\n            }\r\n            await this.showError(buildError(error.message));\r\n        };\r\n    }\r\n\r\n    private async innerFetch(url: string, options: any): Promise<any> {\r\n        let u = this.hostUrl + url;\r\n        return await new Promise<any>(async (resolve, reject) => {\r\n            await this.fetch(u, options, resolve, reject);\r\n        });\r\n    }\r\n\r\n    async callFetch(url:string, method:string, body:any):Promise<any> {\r\n        let options = this.buildOptions();\r\n        options.method = method;\r\n        options.body = body;\r\n        return await new Promise<any>(async (resolve, reject) => {\r\n            await this.fetch(url, options, resolve, reject);\r\n        });\r\n    }\r\n\r\n    private buildOptions(): any {\r\n        let {language, culture} = nav;\r\n        let headers = new Headers();\r\n        //headers.append('Access-Control-Allow-Origin', '*');\r\n        headers.append('Content-Type', 'application/json;charset=UTF-8');\r\n        let lang = language;\r\n        if (culture) lang += '-' + culture;\r\n        headers.append('Accept-Language', lang);\r\n        if (this.apiToken) { \r\n            headers.append('Authorization', this.apiToken); \r\n        }\r\n        let options = {\r\n            headers: headers,\r\n            // cache: 'no-cache',\r\n        };\r\n        return options;\r\n    }\r\n}\r\n","import {nav} from 'tonva';\r\n\r\nexport interface HttpChannelUI {\r\n    startWait():void;\r\n    endWait():void;\r\n    showError(error:any):Promise<void>;\r\n}\r\n\r\nexport class HttpChannelNavUI implements HttpChannelUI {\r\n    startWait() {\r\n        nav.startWait();\r\n    }\r\n    endWait() {\r\n        nav.endWait();\r\n    }\r\n    async showError(error:any):Promise<void> {\r\n        nav.endWait();\r\n        /*\r\n        if (error.name === 'SyntaxError') {\r\n            error = {\r\n                name: error.name,\r\n                message: error.message,\r\n            }\r\n        }*/\r\n        await nav.onError(error);\r\n    }\r\n}\r\n\r\n","//import {isDevelopment} from '../local';\r\nimport {HttpChannel} from './httpChannel';\r\n\r\nexport async function refetchApi(channel:HttpChannel, url, options, resolve, reject) {\r\n    await channel.fetch(url, options, resolve, reject);\r\n}\r\n\r\nexport abstract class ApiBase {\r\n    protected token: string;\r\n    protected path: string;\r\n    protected showWaiting: boolean;\r\n\r\n    constructor(path: string, showWaiting: boolean) {\r\n        this.path = path || '';\r\n        this.showWaiting = showWaiting;\r\n    }\r\n\r\n    protected abstract getHttpChannel(): Promise<HttpChannel>;\r\n\r\n    public async call(url:string, method:string, body:any):Promise<any> {\r\n        let channel = await this.getHttpChannel();\r\n        return await channel.callFetch(url, method, body);\r\n    }\r\n\r\n    public async get(path:string, params:any=undefined): Promise<any> {\r\n        let channel = await this.getHttpChannel();\r\n        return await channel.get(this.path + path, params);\r\n    }\r\n\r\n    public async post(path:string, params:any): Promise<any> {\r\n        let channel = await this.getHttpChannel();\r\n        return await channel.post(this.path + path, params);\r\n    }\r\n\r\n    public async put(path:string, params:any): Promise<any> {\r\n        let channel = await this.getHttpChannel();\r\n        return await channel.put(this.path + path, params);\r\n    }\r\n\r\n    public async delete(path:string, params:any): Promise<any> {\r\n        let channel = await this.getHttpChannel();\r\n        return await channel.delete(this.path + path, params);\r\n    }\r\n}\r\n","import _ from 'lodash';\r\nimport { HttpChannel } from './httpChannel';\r\nimport { HttpChannelNavUI } from './httpChannelUI';\r\nimport { ApiBase } from './apiBase';\r\n\r\nlet channelUIs: { [name: string]: HttpChannel } = {};\r\nlet channelNoUIs: { [name: string]: HttpChannel } = {};\r\n\r\nclass MiApiChannel extends ApiBase {\r\n  private apiName: string;\r\n  url: string;\r\n\r\n  constructor(url: string, basePath: string, apiName: string, uqToken: string, showWaiting?: boolean) {\r\n    super(basePath, showWaiting);\r\n    this.showWaiting = showWaiting;\r\n    this.apiName = apiName;\r\n    this.token = uqToken;\r\n    this.url = url;\r\n  }\r\n\r\n  protected async getHttpChannel(): Promise<HttpChannel> {\r\n    let channels: { [name: string]: HttpChannel };\r\n    let channelUI: HttpChannelNavUI;\r\n    if (this.showWaiting === true || this.showWaiting === undefined) {\r\n      channels = channelUIs;\r\n      channelUI = new HttpChannelNavUI();\r\n    }\r\n    else {\r\n      channels = channelNoUIs;\r\n    }\r\n    let channel = channels[this.apiName];\r\n    if (channel !== undefined) return channel;\r\n    channel = new HttpChannel(this.url, this.token, channelUI);\r\n    return channels[this.apiName] = channel;\r\n  }\r\n}\r\n\r\nexport class MiApi {\r\n  private channel: MiApiChannel;\r\n\r\n  constructor(url: string, basePath: string, apiName: string, uqToken: string, showWaiting?: boolean) {\r\n    this.channel = new MiApiChannel(url, basePath, apiName, uqToken, showWaiting);\r\n  }\r\n\r\n  async call(name: string, params: any[]): Promise<any> {\r\n    let pbody = { call: name, params: params };\r\n    return await this.channel.post('sql/call', pbody);\r\n  }\r\n\r\n  async query(name: string, params: any[]): Promise<any> {\r\n    let pbody = { call: name, params: params };\r\n    return await this.channel.post('sql/call', pbody);\r\n  }\r\n\r\n  async page(name: string, params: any[], pageStart: number, pageSize: number): Promise<any> {\r\n    let p: any[];\r\n    switch (typeof params) {\r\n      case 'undefined': p = []; break;\r\n      default: p = _.clone(params); break;\r\n    }\r\n    p.push(pageStart);\r\n    p.push(pageSize);\r\n    let pbody = { call: name, params: p };\r\n    return await this.channel.post('sql/call', pbody);\r\n  }\r\n\r\n  async process(proc: any, params: any[]): Promise<any> {\r\n    let pbody = { proc: proc, params: params };\r\n    return await this.channel.post('sql/query', pbody);\r\n  }\r\n}\r\n","import * as React from 'react';\r\nimport { VPage, TabCaptionComponent, Page, TabProp } from 'tonva';\r\nimport { CMiApp } from '../UqApp';\r\n\r\nconst color = (selected: boolean) => selected === true ? 'text-primary' : 'text-muted';\r\n\r\nexport class VHome extends VPage<CMiApp> {\r\n\tasync open(param?: any) {\r\n\t\tthis.openPage(this.render);\r\n\t}\r\n\trender = (param?: any): JSX.Element => {\r\n\t\tlet { cHome, cExporer, cMe } = this.controller;\r\n\t\tlet tabs: TabProp[] = [\r\n\t\t\t{ \r\n\t\t\t\tname: 'home', label: '首页', icon: 'home', content: cHome.tab, \r\n\t\t\t\tnotify: undefined, \r\n\t\t\t\t//load: cHome.load, \r\n\t\t\t\tonShown: cHome.load,\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tname: 'explorer', label: '选股', icon: 'search', content: cExporer.tab, load: cExporer.load \r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tname: 'me', label: '我的', icon: 'user', content: cMe.tab, onShown: undefined\r\n\t\t\t}\r\n\t\t].map(v => {\r\n\t\t\tlet { name, label, icon, content, notify, load, onShown } = v;\r\n\t\t\treturn {\r\n\t\t\t\tname,\r\n\t\t\t\tcaption: (selected: boolean) => TabCaptionComponent(label, icon, color(selected)),\r\n\t\t\t\tcontent,\r\n\t\t\t\tnotify,\r\n\t\t\t\tload,\r\n\t\t\t\tonShown,\r\n\t\t\t};\r\n\t\t});\r\n\t\treturn <Page header={false} tabsProps={{tabs}} />\r\n\t}\r\n}\r\n","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport * as React from 'react';\r\nimport { View, nav } from 'tonva';\r\nimport { LMR, FA, SearchBox } from 'tonva';\r\nimport logo from '../images/logo.svg';\r\nimport { CExplorer } from './CExplorer';\r\n\r\nexport class VSiteHeader extends View<CExplorer> {\r\n    render() {\r\n        let currentSalesRegion = <FA name=\"globe\" />\r\n        let login = <div>\r\n            登录\r\n        </div>\r\n        let left = <img className=\"m-1\" src={logo} alt=\"logo\" style={{height: \"3rem\", width: \"3rem\"}} />;\r\n        //let cart = this.controller.cApp.cCart.renderCartLabel();\r\n        let right = undefined;\r\n        /*\r\n        <div className=\"d-flex flex-row mr-1 align-items-center\">\r\n            {currentSalesRegion} &nbsp;\r\n            <button onClick={()=>nav.start()}>Try</button>\r\n        </div>;*/\r\n        return <LMR\r\n            className=\"mb-3 align-items-center bg-white\"\r\n            left={left} right={right}>\r\n            <div className=\"\">\r\n                {this.controller.renderSiteHeader()}\r\n            </div>\r\n        </LMR>\r\n    }\r\n}","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport * as React from 'react';\r\nimport { observer } from 'mobx-react';\r\nimport { VPage, List, LMR, FA, Scroller } from 'tonva';\r\nimport { NStockInfo } from '../stockinfo';\r\nimport { GFunc } from '../tool/GFunc';\r\nimport { CExplorer } from './CExplorer';\r\nimport { PredictHistoryParam } from 'predicthistory/CPredictHistory';\r\nimport { renderSortHeaders, renderStockInfoRow } from '../tool';\r\n\r\nexport class VExplorer extends VPage<CExplorer> {\r\n/*\r\n  render(param: any): JSX.Element {\r\n    return <this.page />\r\n  }\r\n\r\n  private page = observer(() => {\r\n    let { openMetaView, onPage } = this.controller;\r\n    let viewMetaButton = <></>;\r\n    if (this.controller.isLogined) {\r\n      viewMetaButton = <button type=\"button\" className=\"btn w-100\" onClick={openMetaView}>view</button>\r\n    }\r\n    let { onConfig, reload } = this.controller;\r\n    let right = <div className=\"btn align-self-center cursor-pointer \" onClick={onConfig}><FA name=\"cog\" size=\"lg\" inverse={true} /></div>\r\n    return <Page header=\"股票发现\"  onScrollBottom={onPage} right={right}\r\n      headerClassName='bg-primary py-1 px-3'>\r\n      \r\n      <this.content />\r\n    </Page>;\r\n  })\r\n*/\r\n  header() {return '股票发现'}\r\n  protected onPageScrollBottom(scroller: Scroller): Promise<void> {\r\n\tthis.controller.onPage();\r\n\treturn;\r\n  }\r\n\r\n  right() {\r\n    let { onConfig } = this.controller;\r\n\treturn <div className=\"btn align-self-center cursor-pointer \" onClick={onConfig}><FA name=\"cog\" size=\"lg\" inverse={true} /></div>\r\n  }\r\n\r\n  private onClickPredictAVG = () => {\r\n    let {avgs, lastTradeDay} = this.controller;\r\n    let param: PredictHistoryParam = {\r\n      day:undefined,\r\n      priceDay:lastTradeDay,\r\n      avg20:avgs.avg20,\r\n      avg50:avgs.avg50,\r\n      avg100:avgs.avg100,\r\n      avg:avgs.avg,\r\n    }\r\n    this.controller.cApp.openPredictAVG(param);\r\n  }\r\n\r\n  content() {\r\n\t  return React.createElement(observer(() => {\r\n      let {items, avgs, reload} = this.controller;\r\n      let avgHead: JSX.Element;\r\n      let right = <div>\r\n      <div className=\"btn cursor-pointer py-3\" onClick={reload}>刷新</div>\r\n      </div>\r\n      if (avgs.avg20 !== undefined || avgs.avg50 !== undefined || avgs.avg100 !== undefined) {\r\n      let avgStr = ' top20 : ' + GFunc.numberToFixString(avgs.avg20) \r\n        + '  -  top50 : ' + GFunc.numberToFixString(avgs.avg50)\r\n        + '  -  top100 : ' + GFunc.numberToFixString(avgs.avg100)\r\n        + '  -  all : ' + GFunc.numberToFixString(avgs.avg)\r\n        + '  ...查看历史走势';\r\n      avgHead = <LMR right={right}><div className=\"px-3 cursor-pointer\" onClick={this.onClickPredictAVG}>{GFunc.caption('价值指数均值')}{avgStr}</div></LMR>\r\n      }\r\n      else {\r\n      avgHead = <LMR right={right}></LMR>\r\n      }\r\n      \r\n      return <>\r\n      {avgHead}\r\n      <List header={renderSortHeaders(this.setSortType)}\r\n        items={items}\r\n        item={{ render: this.renderRow, key: this.rowKey }}\r\n        before={'选股'}\r\n      />\r\n      </>\r\n    }));\r\n  }\r\n\r\n  renderRow = (item: any, index: number): JSX.Element => <this.rowContent {...item} />;\r\n  protected rowContent = (row: any): JSX.Element => {\r\n    let blackList = this.controller.cApp.blackList;\r\n    let fInBlack = blackList.findIndex(v=>v===id);\r\n    if (fInBlack >= 0) return null;\r\n\r\n    let { id, symbol } = row as NStockInfo;\r\n    let labelId = 'vexl_' + id;\r\n\tlet defList = this.controller.cApp.defaultList;\r\n\tlet fInDef = defList.findIndex(v=>v===id);\r\n\tlet right = <div className=\"d-flex\">\r\n\t\t<label className=\"px-2\">\r\n\t\t\t<input className=\"mr-1\" type=\"checkbox\" value=\"\" id={labelId}\r\n\t\t\tdefaultChecked={fInDef >= 0}\r\n\t\t\tonChange={e => this.onSelect(row, e.target.checked)}/>\r\n\t\t\t<small className=\"text-muted\">自选</small>\r\n\t\t</label>\r\n\t\t<a className=\"px-3 text-info\" \r\n\t\t\thref={`https://finance.sina.com.cn/realstock/company/${symbol}/nc.shtml`} \r\n\t\t\ttarget=\"_blank\" \r\n\t\t\trel=\"noopener noreferrer\" onClick={(e)=>{e.stopPropagation();}}>新浪财经</a>\r\n\t</div>;\r\n\treturn renderStockInfoRow(row, this.onClickName, right);\r\n  };\r\n\r\n  private rowKey = (item: any) => {\r\n    if (item.item !== undefined) {\r\n      return item.item.id;\r\n    }\r\n    let { id } = item;\r\n    return id;\r\n  }\r\n\r\n  private setSortType = (type:string) => {\r\n    this.controller.setSortType(type);\r\n  }\r\n\r\n  protected onClickName = (item: NStockInfo) => {\r\n    this.controller.openStockInfo(item);\r\n  }\r\n\r\n  protected onSelect = async (item: any, isSelected:boolean): Promise<void> => {\r\n    this.controller.onSelectItem(item, isSelected);\r\n  }\r\n\r\n  protected onClickItem = async (item: any): Promise<void> => {\r\n    this.controller.openStockInfo(item);\r\n  }\r\n}","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport * as React from 'react';\r\nimport { observer } from 'mobx-react';\r\nimport { VPage, Page, FA, List, Form, ItemSchema, StringSchema, UiInputItem, UiSchema, Context, IdSchema, UiIdItem, LMR, UiSelect, UiTextItem } from 'tonva';\r\nimport { CExplorer } from './CExplorer';\r\n\r\nconst schema: ItemSchema[] = [\r\n  { name: 'irate', type: 'number', required: true},\r\n  { name: 'bmin', type: 'number', required: true},\r\n  { name: 'bmax', type: 'number', required: true},\r\n  { name: 'r2', type: 'number', required: true},\r\n  { name: 'lmin', type: 'number', required: true},\r\n  { name: 'lmax', type: 'number', required: true},\r\n  { name: 'lr2', type: 'number', required: true},\r\n  { name: 'mcount', type: 'integer', required: true},\r\n  { name: 'lr4', type: 'number', required: true},\r\n  { name: 'r210', type: 'number', required: true},\r\n  { name: 'submit', type: 'submit', },\r\n];\r\n\r\nconst uiSchema: UiSchema = {\r\n  items: {\r\n    irate: { widget: 'number', label: '无风险收益率', placeholder: '0.04'} as UiInputItem,\r\n    bmin: { widget: 'number', label: '指数回归最小值', placeholder: '0.00'} as UiInputItem,\r\n    bmax: { widget: 'number', label: '指数回归最大值', placeholder: '0.00'} as UiInputItem,\r\n    r2: { widget: 'number', label: '指数回归R2', placeholder: '0.00'} as UiInputItem,\r\n    lmin: { widget: 'number', label: '线性回归最小值', placeholder: '0.00'} as UiInputItem,\r\n    lmax: { widget: 'number', label: '线性回归最大值', placeholder: '0.00'} as UiInputItem,\r\n    lr2: { widget: 'number', label: '线性回归R2', placeholder: '0.00'} as UiInputItem,\r\n    lr4: { widget: 'number', label: '末年与前4年均值最大比值', placeholder: '0.00'} as UiInputItem,\r\n    mcount: { widget: 'number', label: '5年内单季亏损最多允许出现次数', placeholder: '0.00'} as UiInputItem,\r\n    r210: { widget: 'number', label: '十年回归R2', placeholder: '0.00'} as UiInputItem,\r\n    submit: { widget: 'button', label: '保存', className: 'btn btn-primary' },\r\n  }\r\n};\r\n\r\n\r\nexport class VExplorerCfg extends VPage<CExplorer> {\r\n  async open(param?: any) {\r\n    this.openPage(this.page);\r\n  }\r\n\r\n  sortChage = (e)=> {\r\n    let newType = e.target.value;\r\n\r\n    this.controller.cApp.setStockSortType(newType);\r\n  }\r\n\r\n  selectChange = (e)=> {\r\n    let newType = e.target.value;\r\n\r\n    this.controller.cApp.setStockSelectType(newType);\r\n  }\r\n\r\n  onChange = (e) => {\r\n    let {name, value} = e.target;\r\n  }\r\n\r\n  private onFormButtonClick = async (name: string, context: Context) => {\r\n    //await this.controller.onSaveNewWarning(context.data);\r\n    let {bmin, bmax, r2, lmin, lmax, lr2, mcount, lr4, r210, irate} = context.data;\r\n    let cfg = {bmin:bmin, bmax:bmax, r2:r2, lmin:lmin, lmax:lmax, lr2:lr2, mcount:mcount, lr4:lr4, r210:r210, irate:irate};\r\n    await this.controller.cApp.setRegressionConfig(cfg);\r\n    this.controller.closePage();\r\n  }\r\n\r\n\r\n  private page = observer(() => {\r\n    let scfg = this.controller.cApp.findStockConfg;\r\n    //let findType = scfg.sortType;\r\n    // let selectType = scfg.selectType;\r\n    // if (selectType === undefined) {\r\n    //   selectType = 'all';\r\n    // }\r\n    let fData = this.controller.cApp.config.regression;\r\n    if (fData.irate === undefined)\r\n      fData.irate = 0.04;\r\n\r\n    return <Page header=\"选股设置\" headerClassName=\"bg-primary\">\r\n      {/* <div className=\"px-3 py-2\">方法</div>\r\n      <div className=\"px-3 py-2 d-flex flex-wrap\">\r\n        <label className=\"px-3 c8\"> <input type=\"radio\" name=\"selectType\" value=\"all\" checked={selectType===\"all\"}\r\n          onChange={this.selectChange} />预期PE</label><br />\r\n        <label className=\"px-3 c8\"> <input type=\"radio\" name=\"selectType\" value=\"value\" checked={selectType===\"value\"}\r\n          onChange={this.selectChange} />价值指数</label><br />\r\n      </div> */}\r\n      <div className=\"px-3 py-2\">回归参数</div>\r\n      <Form schema={schema}\r\n          uiSchema={uiSchema}\r\n          formData={fData}\r\n          onButtonClick={this.onFormButtonClick}\r\n        />\r\n    </Page>;\r\n  })\r\n}\r\n","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport { observable, IObservableArray, computed } from 'mobx';\r\nimport * as React from 'react';\r\nimport { autorun } from 'mobx';\r\nimport { ErForEarning, SlrForEarning } from 'regression';\r\nimport { CUqBase } from '../UqApp';\r\nimport { CStockInfo, NStockInfo } from '../stockinfo';\r\nimport { VSiteHeader } from './VSiteHeader';\r\nimport { VExplorer } from './VExplorer';\r\nimport { VExplorerCfg } from './VExplorerCfg';\r\nimport { GFunc } from 'tool/GFunc';\r\n\r\nexport class CExplorer extends CUqBase {\r\n  items: IObservableArray<any> = observable.array<any>([], { deep: true });\r\n  @observable avgs : {avg20?:number, avg50?:number, avg100?:number, avg?:number} = {};\r\n  lastTradeDay: number;\r\n  protected oldSelectType: string;\r\n  selectedItems: any[] = [];\r\n\r\n  disposeAutorun = autorun(async () => {\r\n    let newSelectType = this.cApp.config.stockFind.selectType;\r\n    if (newSelectType === this.oldSelectType)\r\n      return;\r\n    if (this.oldSelectType === undefined) {\r\n      this.oldSelectType = newSelectType;\r\n      return;\r\n    }\r\n    this.oldSelectType = newSelectType;\r\n    await this.load();\r\n  });\r\n\r\n  onPage = async () => {\r\n    //this.PageItems.more();\r\n  }\r\n\r\n  onConfig = async () => {\r\n    this.openVPage(VExplorerCfg);\r\n  }\r\n\r\n  async internalStart(param: any) {\r\n  }\r\n\r\n  reload = async () => {\r\n    await this.load();\r\n  }\r\n\r\n  load = async () => {\r\n    this.selectedItems = [];\r\n    await this.loadItems();\r\n  }\r\n\r\n  async loadItems() {\r\n    let queryName = 'all';\r\n    //let sName = this.cApp.config.stockFind.selectType;\r\n    let {bmin, bmax, r2, lmin, lmax, lr2, mcount, lr4, r210, irate} = this.cApp.config.regression;\r\n    //if (sName !== undefined)\r\n    //  queryName = sName;\r\n    let query = {\r\n      name: queryName,\r\n      pageStart: 0,\r\n      pageSize: 3000,\r\n      user: this.user.id,\r\n      blackID:this.cApp.blackListTagID,\r\n      bMin: bmin,\r\n      bMax: bmax,\r\n      r2: r2,\r\n      lMin: lmin,\r\n      lMax: lmax,\r\n      lr2: lr2,\r\n      mcount: mcount,\r\n      lr4: lr4,\r\n      r210: r210,\r\n    };\r\n    let rets = await Promise.all([\r\n\t\tthis.cApp.miApi.process(query, []),\r\n        this.cApp.miApi.call('q_getlasttradeday', [])\r\n    ]);\r\n    let lastDayRet = rets[1] as {day:number}[];\r\n    if (Array.isArray(lastDayRet) && lastDayRet.length > 0) {\r\n      this.lastTradeDay = lastDayRet[0].day;\r\n    }\r\n    else {\r\n      this.lastTradeDay = undefined;\r\n    }\r\n    let result = rets[0];\r\n    if (Array.isArray(result) === false) {\r\n      return;\r\n    };\r\n    let arr = result as {id:number, data?:string, v:number, pe:number, e:number, ep:number, price:number, exprice:number, divyield:number, r2:number, lr2:number, e3:number, predictpe:number, order:number, ma:number, dataArr?:number[]}[];\r\n    for (let item of arr) {\r\n      let dataArray = JSON.parse(item.data) as number[];\r\n      item.dataArr = dataArray;\r\n      let sl = new SlrForEarning(dataArray);\r\n      //let ep = GFunc.evaluatePricePrice(irate, sl.predict(5), sl.predict(6), sl.predict(7));\r\n      item.ep = (sl.predict(4) + item.e) / 2;\r\n      item.v = GFunc.calculateVN(sl.slopeR, item.ep, item.divyield * item.price, item.exprice);\r\n      item.e3 = sl.predict(7);\r\n    }\r\n    if (queryName === 'all') {\r\n      this.cApp.sortStocks(arr);\r\n      this.avgs = GFunc.CalculateValueAvg(arr);\r\n    }\r\n    else {\r\n      this.avgs = {};\r\n    }\r\n    this.items.clear();\r\n    this.items.push(...arr);\r\n  }\r\n\r\n  onSelectItem = async (item:any, isSelected:boolean) => {\r\n    let tagid = this.cApp.defaultListTagID;\r\n    if (isSelected === true) {\r\n      await this.cApp.miApi.call('t_tagstock$add', [this.user.id, tagid, item.id]);\r\n      await this.cApp.AddTagStockID(tagid, item.id);\r\n    }\r\n    else {\r\n      await this.cApp.miApi.call('t_tagstock$del', [this.user.id, tagid, item.id]);\r\n      await this.cApp.RemoveTagStockID(tagid, item.id);\r\n    }\r\n  }\r\n\r\n  setSortType = (type:string) => {\r\n    this.cApp.setUserSortType(type);\r\n    let arr = this.items.slice();\r\n    this.cApp.sortStocks(arr);\r\n\r\n    this.items.replace(arr);\r\n  }\r\n\r\n  renderSiteHeader = () => {\r\n    return this.renderView(VSiteHeader);\r\n  }\r\n\r\n  renderHome = () => {\r\n    return this.renderView(VExplorer);\r\n  }\r\n\r\n\r\n  openMetaView = () => {\r\n  }\r\n\r\n  tab = () => <this.renderHome />;\r\n\r\n  openStockInfo = (item: NStockInfo) => {\r\n    let cStockInfo = this.newC(CStockInfo);\r\n    cStockInfo.start(item);\r\n  }\r\n}","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport * as React from 'react';\r\nimport { observer } from 'mobx-react-lite';\r\nimport { VPage, Page, FA, List, Form, ItemSchema, StringSchema, UiInputItem, UiSchema, Context, IdSchema, UiIdItem, LMR, UiSelect, UiTextItem } from 'tonva';\r\nimport { CWarning } from './CWarning';\r\nimport { GFunc } from 'tool/GFunc';\r\n\r\nexport class VWarningConfig extends VPage<CWarning> {\r\n  async open(param?: any) {\r\n    this.openPage(this.page);\r\n  }\r\n\r\n  private onSelect = (item: any, isSelected: boolean, anySelected: boolean) => {\r\n    //this.controller.onTaged(item, isSelected);\r\n  }\r\n\r\n  private page = observer(() => {\r\n    let { warnings } = this.controller;\r\n    let divNewTag = warnings.length >= 100 ? '' :\r\n      <div className=\"px-3 py-2 cursor-pointer\" onClick={this.controller.onNewWarning}><FA name=\"plus\" className=\"text-primary\" /> &nbsp; 新建预警</div>;\r\n    return <Page header=\"预警\" headerClassName=\"bg-primary\">\r\n      {divNewTag}\r\n      <List items={warnings} \r\n        item={{ render: this.renderWarning }} \r\n        none={'--'} />\r\n    </Page>;\r\n  })\r\n\r\n  private renderWarning = (witem: any) => {\r\n    let {name, code, type, price} = witem;\r\n    let left = <div className=\"px-3 cursor-pointer\">\r\n      {name}\r\n      <small className=\" mx-3\" >{code}</small></div>;\r\n    return <LMR className=\"mx-3 my-2\" left={left} >\r\n      <div className=\"d-flex flex-wrap\">\r\n        <div className=\"px-3 c6\">{GFunc.warningTypeString(type)}</div>\r\n        <div className=\"px-3 c6\">{GFunc.numberToFixString(price)}</div>\r\n      </div>\r\n    </LMR>;\r\n  }\r\n}\r\n\r\nconst schema: ItemSchema[] = [\r\n  { name: 'id', type: 'id' } as IdSchema,\r\n  { name: 'type', type: 'string', required: true, maxLength: 2 } as StringSchema,\r\n  { name: 'price', type: 'number', required: true},\r\n  { name: 'submit', type: 'submit', },\r\n];\r\n\r\nconst uiSchema: UiSchema = {\r\n  items: {\r\n    id: { widget: 'id',\r\n      label: '股票',\r\n      visible: true} as UiIdItem,\r\n    type: { widget: 'select', label: '类型', \r\n    list: [{value:'gt', title:'大于'}, {value:'lt', title:'小于'}] } as UiSelect,\r\n    price: { widget: 'text', label: '价格', placeholder: '0.00'} as UiTextItem,\r\n    submit: { widget: 'button', label: '保存', className: 'btn btn-primary' },\r\n  }\r\n};\r\n\r\nexport class VNewWarning extends VPage<CWarning> {\r\n  async open(param?: any) {\r\n    this.openPage(this.page);\r\n  }\r\n\r\n  private newuiSchema: UiSchema = {\r\n    items: {\r\n      id: { widget: 'id',\r\n        label: '股票',\r\n        visible: true,\r\n        placeholder: <small className=\"text-muted\">请选择股票</small>,\r\n        pickId: async (context: Context, name: string, value: number) => {\r\n          return await this.controller.showSelectStock(context, name, value)\r\n        },\r\n        Templet: (item: any) => {\r\n          let { name, code } = item;\r\n          if (!item) return <small className=\"text-muted\">请选择股票</small>;\r\n          return <div>\r\n              {name}\r\n              <small className=\" mx-3\" >{code}</small>\r\n          </div>;\r\n        }\r\n      } as UiIdItem,\r\n      type: { widget: 'select', label: '类型', \r\n      list: [{value:'gt', title:'大于'}, {value:'lt', title:'小于'}] } as UiSelect,\r\n      price: { widget: 'text', label: '价格', placeholder: '0.00'} as UiTextItem,\r\n      submit: { widget: 'button', label: '保存', className: 'btn btn-primary' },\r\n    }\r\n  };\r\n  \r\n  private onFormButtonClick = async (name: string, context: Context) => {\r\n    await this.controller.onSaveNewWarning(context.data);\r\n  }\r\n\r\n  private page = () => {\r\n    let fData = {type:'lt'};\r\n    return <Page header=\"新建预警\" headerClassName=\"bg-primary\">\r\n      <div className=\"px-3 py-3\">\r\n        <Form schema={schema}\r\n          uiSchema={this.newuiSchema}\r\n          formData={fData}\r\n          onButtonClick={this.onFormButtonClick}\r\n        />\r\n      </div>\r\n    </Page>;\r\n  }\r\n}\r\n\r\nexport class VEditWarning extends VPage<CWarning> {\r\n  async open(param?: any) {\r\n    this.openPage(this.page, param);\r\n  }\r\n\r\n  private onFormButtonClick = async (name: string, context: Context) => {\r\n    await this.controller.onSaveWarning(context.data);\r\n  }\r\n\r\n  private page = (param?: any) => {\r\n    let {id, type, price} = param;\r\n    let fData = {id:id, type:type, price:price};\r\n    return <Page header=\"编辑预警\" headerClassName=\"bg-primary\">\r\n      <div className=\"px-3 py-3\">\r\n        <Form schema={schema}\r\n          uiSchema={uiSchema}\r\n          formData={fData}\r\n          onButtonClick={this.onFormButtonClick}\r\n        />\r\n      </div>\r\n    </Page>;\r\n  }\r\n}\r\n","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport { Context } from 'tonva';\r\nimport { observable } from 'mobx';\r\nimport { CMiApp, CUqBase } from '../UqApp';\r\nimport { CStock } from '../stock';\r\nimport { VWarningConfig, VNewWarning } from './VWarningConfig';\r\n\r\nexport class CWarning extends CUqBase {\r\n  get cApp(): CMiApp { return this._cApp as CMiApp };\r\n  @observable warnings:any[] = [];\r\n\r\n  async internalStart(param: any) {\r\n    let a = 1;\r\n  }\r\n\r\n  async loadWarnings() {\r\n    let r = await this.cApp.miApi.call('t_stockwarning$all', [this.user.id]);//await this.uqs.mi.StockWarningAll.query(undefined);\r\n    let ret = r as any[];\r\n    this.warnings = ret;\r\n  }\r\n\r\n  onNewWarning = () => {\r\n    this.openVPage(VNewWarning);\r\n  }\r\n\r\n  onWarningConfg = async () => {\r\n    await this.loadWarnings();\r\n    this.openVPage(VWarningConfig);\r\n  }\r\n\r\n  onSaveNewWarning = async (data: any) => {\r\n    let { id, type, price } = data;\r\n    // let param = {\r\n    //   user: this.cApp.user.id,\r\n    //   stock: id,\r\n    //   arr1: [\r\n    //     { type: type, price: price }\r\n    //   ]};\r\n    //let ret = await this.uqs.mi.StockWarning.add(param);\r\n    await this.cApp.miApi.call('t_stockwarning$add', [this.cApp.user.id, id.id, type, price]);\r\n    this.closePage();\r\n  }\r\n\r\n  onSaveWarning = async (data: any) => {\r\n\r\n  }\r\n\r\n  showSelectStock = async (context: Context, name: string, value: number): Promise<any> => {\r\n    let cStock = new CStock(this.cApp);\r\n    return await cStock.call();\r\n  }\r\n}","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport * as React from 'react';\r\nimport { observer } from 'mobx-react';\r\nimport RC2 from 'react-chartjs2'\r\nimport { VPage, Page, View, List, LMR, FA } from 'tonva';\r\nimport { CPredictHistory } from './CPredictHistory';\r\n\r\nexport class VPredictHistory extends VPage<CPredictHistory> {\r\n  async open(param?: any) {\r\n    this.openPage(this.page);\r\n  }\r\n\r\n  render(param: any): JSX.Element {\r\n    return <this.page />\r\n  }\r\n\r\n  private page = observer(() => {\r\n    return <Page header=\"预期收益比均值历史\">\r\n      <this.pageContent />\r\n    </Page>;\r\n  })\r\n\r\n  private pageContent = observer(() => {\r\n    return <>\r\n    <this.historyChart />\r\n    </>\r\n  });\r\n\r\n  protected historyChart = observer(() => {\r\n    let {items} = this.controller;\r\n    if (items === undefined) \r\n      return <></>;\r\n    let chartHistory = <></>;\r\n    let labelList:any[] = [];\r\n    let avg20List:number[] = [];\r\n    let avg50List:number[] = [];\r\n    let avg100List:number[] = [];\r\n    for (let item of items) {\r\n      let {day, avg20, avg50, avg100} = item;\r\n      labelList.push(day);\r\n      avg20List.push(avg20);\r\n      avg50List.push(avg50);\r\n      avg100List.push(avg100);\r\n    }\r\n    let chartdata1 = {\r\n      labels: labelList,\r\n      datasets: [\r\n        {\r\n          label: 'avg20',\r\n          data: avg20List,\r\n          borderColor:'blue',\r\n          backgroundColor:'skyBlue',\r\n          borderWidth: 1,\r\n          fill: false,\r\n          yAxisID: 'y-axis-1',\r\n        },\r\n        {\r\n          label: 'avg50',\r\n          data: avg50List,\r\n          borderColor:'red',\r\n          backgroundColor:'pink',\r\n          borderWidth: 1,\r\n          fill: false,\r\n          yAxisID: 'y-axis-1',\r\n        },\r\n        {\r\n          label: 'avg100',\r\n          data: avg100List,\r\n          borderColor:'DarkGreen',\r\n          backgroundColor:'green',\r\n          borderWidth: 1,\r\n          fill: false,\r\n          yAxisID: 'y-axis-1',\r\n        },\r\n      ]\r\n    };\r\n    let options = {\r\n      scales:{\r\n        yAxes: [{\r\n            type: 'linear',\r\n            display: true,\r\n            position: 'right',\r\n            id: 'y-axis-1',\r\n        }],       \r\n      }\r\n    }\r\n\r\n    chartHistory = <RC2 data={chartdata1} type='line' options={options}/>;\r\n    return <><LMR className=\"px-3 py-2 bg-white\" left={'历史走势'}></LMR>\r\n      <div className=\"px-3\" style={{width:'95%'}}>{chartHistory}</div>\r\n    </>;\r\n  });\r\n\r\n}","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport { observable, IObservableArray } from 'mobx';\r\nimport { CUqBase } from '../UqApp';\r\nimport { VPredictHistory } from './VPredictHistory'\r\n\r\nexport interface PredictHistoryParam {\r\n  day?:number,\r\n  priceDay?:number,\r\n  avg20?:number,\r\n  avg50?:number,\r\n  avg100?:number,\r\n  avg?:number,\r\n}\r\n\r\ninterface PredictItem {\r\n  day:number, \r\n  avg20:number, \r\n  avg50:number,\r\n  avg100:number,\r\n  avg?:number\r\n}\r\n\r\nexport class CPredictHistory extends CUqBase {\r\n  items: IObservableArray<PredictItem> = observable.array<PredictItem>([], { deep: true });\r\n  day: number;\r\n  protected lastItem: PredictItem;\r\n\r\n  async internalStart(param: any) {\r\n    let p = param as PredictHistoryParam;\r\n    if (p !== undefined) {\r\n      this.day = p.day;\r\n      if (p.priceDay !== undefined) {\r\n        this.lastItem = {day:p.priceDay, avg20:p.avg20, avg50:p.avg50, avg100:p.avg100};\r\n      }\r\n      else {\r\n        this.lastItem = undefined;\r\n      }\r\n    }\r\n    else {\r\n      this.day = undefined;\r\n      this.lastItem = undefined;\r\n    }\r\n    await this.load();\r\n    this.openVPage(VPredictHistory as any);\r\n  }\r\n\r\n  async load() {\r\n    let ret = await this.cApp.miApi.call('t_toppredictavg$query', [this.day]) as PredictItem[];\r\n    this.items.clear();\r\n    if (!Array.isArray(ret))\r\n      return;\r\n    this.items.push(...ret);\r\n    if (this.lastItem !== undefined) {\r\n      let li = {...this.lastItem};\r\n      this.items.push(li);\r\n    }\r\n  }\r\n\r\n}","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport { observable, computed } from 'mobx';\r\nimport { Controller, VPage } from 'tonva';\r\nimport { CHome } from '../home';\r\nimport { CMe } from '../me';\r\nimport { consts } from './consts';\r\nimport { MiApi } from '../net';\r\nimport { VHome } from '../ui';\r\nimport { CExplorer } from '../explorer';\r\nimport { MiConfigs, StockFindConfig, IdName, RegressionConfig } from '../types';\r\nimport { CWarning } from '../warning';\r\nimport { CPredictHistory } from '../predicthistory';\r\nimport { CUqApp } from './CBase';\r\n\r\nexport const defaultTagName = '自选股';\r\nexport const defaultBlackListTagName = '黑名单';\r\n\r\nexport class CMiApp extends CUqApp {\r\n  cExporer: CExplorer;\r\n  cHome: CHome;\r\n  cWarning: CWarning;\r\n  cMe: CMe;\r\n  miApi: MiApi;\r\n  @observable config: MiConfigs = { \r\n    tagName: defaultTagName, \r\n    stockFind: { sortType:'pe' },\r\n    userStock: { sortType:'tagpe'},\r\n    regression: {bmin:0, bmax:0.5, r2:0.7, lmin:0.01, lmax:0.5, lr2:0.7, mcount:2, lr4: 3, r210:0.6, irate:0.04}\r\n  };\r\n  @observable tags: IdName[] = undefined;\r\n  @observable blackList: any[] = [];\r\n  @observable defaultList: any[] = [];\r\n  @observable accounts: IdName[] = undefined;\r\n\r\n  @computed get tagID(): number {\r\n    if (this.tags !== undefined) {\r\n      let name = this.config.tagName;\r\n      let i = this.tags.findIndex(v => v.name === name);\r\n      if (i >= 0) {\r\n        return this.tags[i].id as number;\r\n      }\r\n    }\r\n    return -1;\r\n  }\r\n\r\n  @computed get accountID(): number {\r\n    let name = this.config.accountName;\r\n    if (name !== undefined && this.accounts !== undefined) {\r\n      let i = this.accounts.findIndex(v => v.name === name);\r\n      if (i >= 0) {\r\n        return this.accounts[i].id as number;\r\n      }\r\n    }\r\n    return -1;\r\n  }\r\n\r\n  get findStockConfg(): StockFindConfig {\r\n    return this.config.stockFind;\r\n  }\r\n\r\n  @computed get blackListTagID(): number {\r\n    if (this.tags !== undefined) {\r\n      let name = this.config.tagName;\r\n      let i = this.tags.findIndex(v => v.name === defaultBlackListTagName);\r\n      if (i >= 0) {\r\n        return this.tags[i].id as number;\r\n      }\r\n    }\r\n    return -1;\r\n  }\r\n\r\n  @computed get defaultListTagID(): number {\r\n    if (this.tags !== undefined) {\r\n      let name = this.config.tagName;\r\n      let i = this.tags.findIndex(v => v.name === defaultTagName);\r\n      if (i >= 0) {\r\n        return this.tags[i].id as number;\r\n      }\r\n    }\r\n    return -1;\r\n  }\r\n\r\n  protected async internalStart() {\r\n    if (this.isLogined) {\r\n    }\r\n\r\n    let token = this.user.token;\r\n\r\n    //let miHost = consts.isDevelopment ? consts.miApiHostDebug : consts.miApiHost;\r\n\tlet miHost = consts.miApiHost;\r\n    this.miApi = new MiApi(miHost, 'fsjs/', 'miapi', token, false);\r\n    this.cExporer = this.newC(CExplorer);\r\n    this.cHome = this.newC(CHome);\r\n\tthis.cMe = this.newC(CMe);\r\n    this.cWarning = this.newC(CWarning);\r\n\r\n    //some test code\r\n    //let params = [];\r\n    //let ret = await this.miApi.page('q_stocksquery', params, 0, 100);\r\n    let env = process.env;\r\n    //\r\n    await this.loadConfig();\r\n    await this.cHome.loadWarning();\r\n\tawait this.cHome.load();\r\n    this.openVPage(VHome);\r\n  }\r\n\r\n  async saveConfig() {\r\n    let v = JSON.stringify(this.config);\r\n    await this.miApi.call('t_usersettings$save', [this.user.id, 'config', v]);\r\n  }\r\n\r\n  protected async loadConfig() {\r\n    let rets = await Promise.all([this.miApi.query('t_usersettings$query', [this.user.id, 'config']),\r\n        this.loadTags(),\r\n        this.loadAccounts()]);\r\n    let r = rets[0];\r\n    if (r !== undefined) {\r\n      let ret = r;\r\n      if (ret !== undefined && ret.length > 0) {\r\n        let cStr = ret[0].value;\r\n        let c = JSON.parse(cStr);\r\n        if (this.tags !== undefined) {\r\n          let name = c.tagName;\r\n          let i = this.tags.findIndex(v => v.name === name);\r\n          if (i < 0 && this.tags.length > 0) {\r\n            i = this.tags.findIndex(v => v.name === defaultTagName);\r\n            if (i >= 0) {\r\n              c.tagName = defaultTagName;\r\n            }\r\n            else {\r\n              c.tagName = this.tags[0].name;\r\n            }\r\n          }\r\n        }\r\n        this.config = c;\r\n      }\r\n    }\r\n    if (this.config.stockFind === undefined) {\r\n      this.config.stockFind = { sortType: 'pe' };\r\n    }\r\n    else {\r\n      switch (this.config.stockFind.selectType) {\r\n        case 'all': break;\r\n        case 'peroe': break;\r\n        case 'pe': break;\r\n        case 'dp': break;\r\n        default:\r\n          this.config.stockFind.selectType = 'all';\r\n          break;\r\n      }\r\n    }\r\n    if (this.config.userStock === undefined) {\r\n      this.config.userStock = { sortType: 'tagpe' };\r\n    }\r\n    if (this.config.regression === undefined) {\r\n      this.config.regression = {bmin:0, bmax:0.5, r2:0.7, lmin:0.01, lmax:0.5, lr2:0.7, mcount:2, lr4: 3, r210:0.6, irate:0.04};\r\n    }\r\n    else {\r\n      if (this.config.regression.r210 === undefined) {\r\n        this.config.regression.r210 = 0.6;\r\n      }\r\n      if (this.config.regression.irate === undefined) {\r\n        this.config.regression.irate = 0.04;\r\n      }\r\n    }\r\n    await this.loadBlackList();\r\n    await this.loadDefaultList();\r\n  }\r\n\r\n  getsortFunc = () => {\r\n    let sortType = this.config.userStock.sortType;\r\n    if (sortType === 'tagpe') {\r\n      return (a, b) => {\r\n        return a.pe - b.pe;\r\n      }\r\n    }\r\n    else if (sortType === 'tagdp') {\r\n      return (a, b) => {\r\n        return b.divyield - a.divyield;\r\n      }\r\n    }\r\n    else {\r\n      return (a, b) => {\r\n        return b.v - a.v;\r\n      }\r\n    }\r\n  }\r\n\r\n  sortStocks = (arr:any[]) => {\r\n    arr.sort(this.getsortFunc());\r\n    let o = 1;\r\n    for (let item of arr) {\r\n      item.order = o;\r\n      ++o;\r\n    }\r\n  }\r\n\r\n\r\n  setStockSortType = async (type:string)=> {\r\n    if (this.config.stockFind.sortType === type)\r\n      return;\r\n    this.config.stockFind.sortType = type;\r\n    await this.saveConfig();\r\n  }\r\n\r\n  setStockSelectType = async (type:string) => {\r\n    if (this.config.stockFind.selectType === type)\r\n      return;\r\n    this.config.stockFind.selectType = type;\r\n    await this.saveConfig();\r\n  }\r\n\r\n  setUserSortType = async (type:string)=> {\r\n    if (this.config.userStock.sortType === type)\r\n      return;\r\n    this.config.userStock.sortType = type;\r\n    await this.saveConfig();\r\n  }\r\n\r\n  selectTag = async (item:any) => {\r\n    let {name, id} = item as {name:string, id:number};\r\n    let i = this.tags.findIndex(v => v.name === name);\r\n    if (i >= 0) {\r\n      this.config.tagName = name;\r\n      this.saveConfig();\r\n    }\r\n  }\r\n\r\n  selectAccount = async (item:any) => {\r\n    let {name, id} = item as {name:string, id:number};\r\n    let i = this.accounts.findIndex(v => v.name === name);\r\n    if (i >= 0) {\r\n      this.config.accountName = name;\r\n      this.saveConfig();\r\n    }\r\n  }\r\n\r\n  setRegressionConfig = async (cfg: RegressionConfig) => {\r\n    this.config.regression = cfg;\r\n    await this.saveConfig();\r\n  }\r\n\r\n  protected async loadTags(): Promise<void> {\r\n    if (this.tags === undefined) {\r\n      let r = await this.miApi.query('t_tag$all', [this.user.id]);\r\n      let ret = r as any[];\r\n      let bc = await this.checkDefaultTags(ret);\r\n      if (bc) {\r\n        r = await this.miApi.query('t_tag$all', [this.user.id]);\r\n        ret = r as any[];\r\n      }\r\n      let r1 = [];\r\n      let i = ret.findIndex(v=>v.name === defaultTagName);\r\n      if (i >= 0) {\r\n        r1.push(ret[i]);\r\n        ret.splice(i, 1);\r\n      }\r\n      i = ret.findIndex(v=> v.name === defaultBlackListTagName);\r\n      if (i >= 0) {\r\n        r1.push(ret[i]);\r\n        ret.splice(i, 1);\r\n      }\r\n      r1.push(...ret);\r\n      this.tags = r1;\r\n    }\r\n  }\r\n\r\n  protected async checkDefaultTags(list:any[]): Promise<boolean> {\r\n    let br = false;\r\n    if (list === undefined) {\r\n      await this.miApi.call('t_tag$save', [this.user.id, undefined, defaultTagName]);\r\n      await this.miApi.call('t_tag$save', [this.user.id, undefined, defaultBlackListTagName]);\r\n      br = true;\r\n    }\r\n    else {\r\n      let param;\r\n      let i = list.findIndex(v => v.name === defaultTagName);\r\n      if (i < 0) {\r\n        await this.miApi.call('t_tag$save', [this.user.id, undefined, defaultTagName]);\r\n        br = true;\r\n      }\r\n      i = list.findIndex(v => v.name === defaultBlackListTagName);\r\n      if (i < 0) {\r\n        await this.miApi.call('t_tag$save', [this.user.id, undefined, defaultBlackListTagName]);\r\n        br = true;\r\n      }\r\n    }\r\n\r\n    return br;\r\n  }\r\n\r\n  protected async loadAccounts(): Promise<void> {\r\n    let r = await this.miApi.query('t_allaccounts', [this.user.id]);\r\n    if (Array.isArray(r)) {\r\n      this.accounts = r;\r\n    }\r\n  }\r\n\r\n  protected async loadBlackList(): Promise<void> {\r\n    let blackid = this.blackListTagID;\r\n    if (blackid <= 0) {\r\n      this.blackList = [];\r\n      return;\r\n    }\r\n\r\n    let param = { user:this.user.id, tag:blackid};\r\n    try {\r\n      let ret = await this.miApi.call('t_tagstock$query', [this.user.id, blackid, undefined]);//await this.uqs.mi.TagStock.query(param);\r\n      let r = ret.map(item=> {\r\n        return item.stock;\r\n      });\r\n      this.blackList = r;\r\n    }\r\n    catch (error) {\r\n      let e = error;\r\n    }\r\n  }\r\n\r\n  protected async loadDefaultList(): Promise<void> {\r\n    let id = this.defaultListTagID;\r\n    if (id <= 0) {\r\n      this.defaultList = [];\r\n      return;\r\n    }\r\n\r\n    let param = { user:this.user.id, tag:id};\r\n    try {\r\n      let ret = await this.miApi.call('t_tagstock$query', [this.user.id, id, undefined]);//await this.uqs.mi.TagStock.query(param);\r\n      let r = ret.map(item=> {\r\n        return item.stock;\r\n      });\r\n      this.defaultList = r;\r\n    }\r\n    catch (error) {\r\n      let e = error;\r\n    }\r\n  }\r\n\r\n  async AddTagStockID(tagid: number, stockID: number) {\r\n    if (tagid === this.blackListTagID) {\r\n      this.AddBlackID(stockID);\r\n    }\r\n    else if (tagid === this.defaultListTagID) {\r\n      this.AddDefaultID(stockID);\r\n    }\r\n  }\r\n\r\n  async AddTagStockIDs(tagid: number, stockIDs: number[]) {\r\n    if (tagid === this.blackListTagID) {\r\n      stockIDs.map(v=>this.AddBlackID(v));\r\n    }\r\n    else if (tagid === this.defaultListTagID) {\r\n      stockIDs.map(v=>this.AddDefaultID(v));\r\n    }\r\n  }\r\n\r\n  async RemoveTagStockID(tagid: number, stockID: number) {\r\n    if (tagid === this.blackListTagID) {\r\n      this.RemoveBlackID(stockID);\r\n    }\r\n    else if (tagid === this.defaultListTagID) {\r\n      this.RemoveDefaultID(stockID);\r\n    }\r\n    this.cHome.RemoveTagStockID(tagid, stockID);\r\n  }\r\n\r\n  protected AddBlackID(id:number) {\r\n    let i = this.blackList.findIndex(v=> v===id);\r\n    if (i < 0) {\r\n      this.blackList.push(id);\r\n    }\r\n  }\r\n\r\n  protected RemoveBlackID(id:number) {\r\n    let i = this.blackList.findIndex(v=> v===id);\r\n    if (i >= 0) {\r\n      this.blackList.splice(i, 1);\r\n    }\r\n  }\r\n\r\n  protected AddDefaultID(id:number) {\r\n    let i = this.defaultList.findIndex(v=> v===id);\r\n    if (i < 0) {\r\n      this.defaultList.push(id);\r\n    }\r\n  }\r\n\r\n  protected RemoveDefaultID(id:number) {\r\n    let i = this.defaultList.findIndex(v=> v===id);\r\n    if (i >= 0) {\r\n      this.defaultList.splice(i, 1);\r\n    }\r\n  }\r\n/*\r\n  newC<T extends CUqBase>(type: IConstructor<T>): T {\r\n    return new type(this);\r\n  }\r\n*/\r\n  public async showOneVPage(vp: new (coordinator: Controller) => VPage<Controller>, param?: any): Promise<void> {\r\n    await (new vp(this)).open(param);\r\n  }\r\n\r\n  protected onDispose() {\r\n  }\r\n\r\n  openPredictAVG(param:any) {\r\n    let pc = this.newC(CPredictHistory);\r\n    pc.start(param);\r\n  }\r\n}\r\n","import { AppConfig } from \"tonva\";\r\n\r\nexport const appConfig:AppConfig = {\r\n\tappName: 'bruce/mifen',\r\n\tversion: '1.01',\r\n\ttvs: undefined, //TVs;\r\n\tuqNameMap: {}\r\n};\r\n","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport * as React from 'react';\r\nimport classNames from 'classnames';\r\nimport { VPage, Page, View, List, LMR, left0, FA } from 'tonva';\r\nimport { observable } from 'mobx';\r\nimport { observer } from 'mobx-react';\r\nimport RC2 from 'react-chartjs2'\r\nimport { GFunc } from '../tool/GFunc';\r\nimport { CStockInfo } from './CStockInfo'\r\nimport { NStockInfo, StockCapitalearning, StockBonus } from './StockInfoType';\r\nimport { ErForEarning, SlrForEarning } from 'regression';\r\n\r\nexport class VStockInfo extends VPage<CStockInfo> {\r\n  private input: HTMLInputElement;\r\n  private key: string = undefined;\r\n\r\n  async open(param?: any) {\r\n    this.openPage(this.page);\r\n  }\r\n\r\n  @observable protected ttmLimit:boolean = false;\r\n\r\n  render(param: any): JSX.Element {\r\n    return <this.page />\r\n  }\r\n\r\n  checkLimitShow = (e)=> {\r\n    let check = e.target.checked as boolean;\r\n    this.ttmLimit = check;\r\n  }\r\n\r\n  checkShowLater = (e)=> {\r\n    let check = e.target.checked as boolean;\r\n    this.controller.LoadHistoryData(check);\r\n  }\r\n\r\n  checkDefaultTag = (e)=> {\r\n    let check = e.target.checked as boolean;\r\n    this.controller.onClickDefaultTag(check);\r\n  }\r\n\r\n  private page = observer(() => {\r\n    let { openMetaView, baseItem, onSelectTag, stockTags, isLogined } = this.controller;\r\n    let { name, code, day } = baseItem;\r\n    let viewMetaButton = <></>;\r\n    if (isLogined) {\r\n      viewMetaButton = <button type=\"button\" className=\"btn w-100\" onClick={openMetaView}>view</button>\r\n    }\r\n    let right = stockTags && <button \r\n\t\tclassName=\"btn btn-sm mr-2 btn-outline-success bg-light align-self-center\"\r\n\t\tonClick={onSelectTag}>\r\n      {stockTags.length === 0? '加自选' : '设分组'}\r\n      </button>;\r\n    let headStr = name + ' ' + code;\r\n    if (day !== undefined) {\r\n      headStr += ' - ' + day;\r\n    }\r\n  let head = <div onClick={()=>this.controller.showSelectStock(day)}>{headStr}</div>\r\n    return <Page header={head} right={right}\r\n      headerClassName='bg-primary'>\r\n      <this.pageContent />\r\n    </Page>;\r\n  })\r\n\r\n  private pageContent = observer(() => {\r\n    return <>\r\n      <this.dateHead />\r\n      <this.baseInfo />\r\n      <this.historyChart />\r\n      <this.predictInfo />\r\n      <this.predictSeasonEarning />\r\n      <this.seasonEarning />\r\n      <this.capitalEarning />\r\n      <this.bonus />\r\n    </>\r\n  });\r\n\r\n  private onChange = (evt: React.ChangeEvent<any>) => {\r\n    let v = evt.target.value;\r\n    let n = Number(v);\r\n    if (isNaN(n) === true || !Number.isInteger(n)) {\r\n      if (this.input) {\r\n        this.input.value = this.key;\r\n      }\r\n      return;\r\n    }\r\n    this.key = evt.target.value;\r\n    if (this.key !== undefined) {\r\n        this.key = this.key.trim();\r\n        if (this.key === '') this.key = undefined;\r\n    }\r\n  }\r\n\r\n  private onSubmit = async (evt: React.FormEvent<any>) => {\r\n    evt.preventDefault();\r\n    if (this.key === undefined) this.key = '';\r\n    let n = Number(this.key);\r\n    if (!isNaN(n) && Number.isInteger((n))) {\r\n      if (n ===0 || (n >= 20000101 && n < 30000101)) {\r\n        await this.controller.changeDay(n);\r\n      }\r\n    }\r\n  }\r\n\r\n\r\n  private dateHead = () => {\r\n    let {day} = this.controller.baseItem;\r\n    let dayString = day === undefined || isNaN(day) ? '' : day.toString();\r\n    return <div className=\"px-3 py-2\">\r\n\t\t<form className=\"w-100\" onSubmit={this.onSubmit} >\r\n\t\t\t<div className=\"input-group input-group-sm\">\r\n\t\t\t\t<label className=\"input-group-addon mr-2 mb-0 align-self-center\">{'日期'}</label>\r\n\t\t\t\t<input ref={v=>this.input=v} onChange={this.onChange}\r\n\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\tname=\"key\"\r\n\t\t\t\t\t\tdefaultValue={dayString}\r\n\t\t\t\t\t\tclassName=\"form-control border-primary px-2\"\r\n\t\t\t\t\t\tplaceholder={'yyyymmdd'}\r\n\t\t\t\t\t\tmaxLength={8} />\r\n\t\t\t\t<div className=\"input-group-append\">\r\n\t\t\t\t\t\t<button className=\"btn btn-primary px-2\"\r\n\t\t\t\t\t\t\ttype=\"submit\">\r\n\t\t\t\t\t\t\t<i className='fa fa-search' />\r\n\t\t\t\t\t\t\t<i className=\"fa\"/>\r\n\t\t\t\t\t\t\t{'跳转'}\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</form>\r\n\t</div>;\r\n  }\r\n\r\n\r\n  private baseInfo = observer(() => {\r\n    let {baseItem} = this.controller;\r\n    let { id, name, code, symbol, pe, roe, price, order, divyield, e, capital, bonus } = baseItem;\r\n\r\n    let list = this.controller.cApp.defaultList;\r\n    let fInList = list.findIndex(v=>v===id) >= 0;\r\n    let right = <label className=\"align-self-center px-3\"> <input type=\"checkbox\" name=\"checkDefaultList\" defaultChecked={fInList}\r\n      onChange={this.checkDefaultTag} />自选股</label>;\r\n    return <LMR className=\"bg-white\" right={right}> <div className=\"px-3 py-2\" >\r\n      <div className=\"d-flex flex-wrap\">\r\n        <div className=\"px-3 c8\">{GFunc.caption('TTM')}{GFunc.numberToFixString(pe)}</div>\r\n        <div className=\"px-3 c8\">{GFunc.caption('股息率')}{GFunc.percentToFixString(divyield)}</div>\r\n        <div className=\"px-3 c8\">{GFunc.caption('ROE')}{GFunc.percentToFixString(roe)}</div>\r\n        <div className=\"px-3 c8\">{GFunc.caption('价格')}{GFunc.numberToFixString(price)}</div>\r\n        <a className=\"px-3 text-info\" href={`https://finance.sina.com.cn/realstock/company/${symbol}/nc.shtml`} target=\"_blank\" rel=\"noopener noreferrer\" onClick={(e) =>{e.stopPropagation() }}>新浪财经</a>\r\n      </div>    \r\n    </div>\r\n    </LMR>;\r\n  });\r\n\r\n  protected onClickName = async (item: NStockInfo) => {\r\n    let { symbol } = item;\r\n    let url = `http://finance.sina.com.cn/realstock/company/${symbol}/nc.shtml`;\r\n    let w = window.open(url, '');\r\n    w.opener = undefined;\r\n  }\r\n\r\n  protected historyChart = observer(() => {\r\n    let {historyData, baseItem} = this.controller;\r\n    if (historyData === undefined) \r\n      return <></>;\r\n    let chartHistory = <></>;\r\n    let labelList:any[] = [];\r\n    let priceList:number[] = [];\r\n    let ttmList:number[] = [];\r\n    for (let item of historyData) {\r\n      let {day, price, ttm} = item;\r\n      labelList.push(day);\r\n      priceList.push(GFunc.numberToPrecision(price, 4));\r\n      if (ttm <= 0) \r\n        ttmList.push(undefined);\r\n      else {\r\n        if (this.ttmLimit && ttm >= 35) {\r\n          ttmList.push(35);\r\n        }\r\n        else {\r\n          ttmList.push(GFunc.numberToPrecision(ttm, 4));\r\n        }\r\n      }\r\n    }\r\n    let chartdata1 = {\r\n      labels: labelList,\r\n      datasets: [\r\n        {\r\n          label: '价格',\r\n          data: priceList,\r\n          borderColor:'blue',\r\n          backgroundColor:'skyBlue',\r\n          borderWidth: 1,\r\n          fill: false,\r\n          yAxisID: 'y-axis-1',\r\n        },\r\n        {\r\n          label: 'TTM',\r\n          data: ttmList,\r\n          borderColor:'red',\r\n          backgroundColor:'pink',\r\n          borderWidth: 1,\r\n          fill: false,\r\n          yAxisID: 'y-axis-2',\r\n        }\r\n      ]\r\n    };\r\n    let options = {\r\n      scales:{\r\n        yAxes: [{\r\n            type: 'linear',\r\n            display: true,\r\n            position: 'left',\r\n            id: 'y-axis-1',\r\n        }, {\r\n            type: 'linear',\r\n            display: true,\r\n            position: 'right',\r\n            id: 'y-axis-2',\r\n            gridLines: {\r\n                drawOnChartArea: false\r\n            }\r\n        }],       \r\n      }\r\n    }\r\n    chartHistory = <RC2 data={chartdata1} type='line' options={options} />;\r\n    let right = <></>;\r\n    if (baseItem.day !== undefined) {\r\n      right = <><label className=\"px-3\"> <input type=\"checkbox\" name=\"showLater\" defaultChecked={false}\r\n            onChange={this.checkShowLater} />显示后面数据</label>\r\n          <label className=\"px-3\"> <input type=\"checkbox\" name=\"selectType\" defaultChecked={this.ttmLimit}\r\n          onChange={this.checkLimitShow} />限制TTM显示范围</label>\r\n        </>;\r\n\r\n    }\r\n    else {\r\n      right = <label className=\"px-3\"> <input type=\"checkbox\" name=\"selectType\" defaultChecked={this.ttmLimit}\r\n        onChange={this.checkLimitShow} />限制TTM显示范围</label>;\r\n    }\r\n    return <><LMR className=\"px-3 py-2 bg-white\" left={'历史走势'} right={right}></LMR>\r\n      <div className=\"px-3\" style={{width:'95%'}}>{chartHistory}</div>\r\n    </>;\r\n  });\r\n\r\n  protected predictInfo = observer(() => {\r\n    let {predictData, ypredict} = this.controller;\r\n    if (predictData === undefined) \r\n      return <></>;\r\n    let { e, b, r2, epre, l, lr2, lpre } = predictData;\r\n    let chart1 = <></>;\r\n    if (ypredict.length === 5) {\r\n      let er = new ErForEarning(ypredict);\r\n      let chartdata1 = {\r\n        labels: ['0', '1', '2', '3', '4'],\r\n        datasets: [\r\n          {\r\n            label: '原值',\r\n            data: ypredict.map(v=>GFunc.numberToPrecision(v)),\r\n            borderColor:'black',\r\n            backgroundColor:'skyBlue',\r\n            showLine: false,\r\n            pointStyle: \"crossRot\",\r\n            borderWidth: 1,\r\n            pointRadius: 5,\r\n            fill: false,\r\n          } as any\r\n        ]\r\n      };\r\n      if (!(isNaN(er.B) || isNaN(er.A))) {\r\n        let per:number[] = [];\r\n        for (let i = 0; i < 5; ++i) {\r\n          per.push(GFunc.numberToPrecision(er.predict(i), 4));\r\n        }\r\n        chartdata1.datasets.push(\r\n          {\r\n            label: '指数回归',\r\n            data: per,\r\n            borderColor:'red',\r\n            backgroundColor:'pink',\r\n            borderWidth: 1,\r\n            fill: false,\r\n        });\r\n      }\r\n      let lr = new SlrForEarning(ypredict);\r\n      if (!(isNaN(lr.slope) || isNaN(lr.intercept))) {\r\n        let plr:number[] = [];\r\n        for (let i = 0; i < 5; ++i) {\r\n          plr.push(GFunc.numberToPrecision(lr.predict(i), 4));\r\n        }\r\n        chartdata1.datasets.push(\r\n          {\r\n            label: '线性回归',\r\n            data: plr,\r\n            borderColor:'blue',\r\n            backgroundColor:'pink',\r\n            borderWidth: 1,\r\n            fill: false,\r\n        });\r\n      }\r\n      chart1 = <RC2 data={chartdata1} type='line' />;\r\n    }\r\n    let chart2 = this.predictChartFullInfo();\r\n    let chart3 = this.predictChartROE();\r\n    return <><div className=\"px-3 py-2 bg-white\">指数回归预测</div>\r\n      <div className=\"d-flex flex-wrap\">\r\n        <div className=\"px-3 c12\">{GFunc.caption('e')}{GFunc.numberToString(e, 4)}</div>\r\n        <div className=\"px-3 c12\">{GFunc.caption('指数b')}{GFunc.numberToString(b, 4)}</div>\r\n        <div className=\"px-3 c12\">{GFunc.caption('r2')}{GFunc.numberToString(r2, 4)}</div>\r\n        <div className=\"px-3 c12\">{GFunc.caption('e预测')}{GFunc.numberToString(epre)}</div>\r\n      </div>\r\n      <div className=\"px-3 py-2 bg-white\">线性回归预测</div>\r\n      <div className=\"d-flex flex-wrap\">\r\n      <div className=\"px-3 c12\">{GFunc.caption('e')}{GFunc.numberToString(e, 4)}</div>\r\n        <div className=\"px-3 c12\">{GFunc.caption('增长率')}{GFunc.numberToString(l, 4)}</div>\r\n        <div className=\"px-3 c12\">{GFunc.caption('r2')}{GFunc.numberToString(lr2, 4)}</div>\r\n        <div className=\"px-3 c12\">{GFunc.caption('e预测')}{GFunc.numberToString(lpre)}</div>\r\n      </div>\r\n      <div className=\"d-flex\">\r\n        <div className=\"px-2\" style={{width:'50%'}}>{chart1}</div>\r\n        <div className=\"px-2\" style={{width:'50%'}}>{chart2}</div>\r\n      </div>\r\n      <div className=\"d-flex\">\r\n        <div className=\"px-2\" style={{width:'50%'}}>{chart3}</div>\r\n      </div>\r\n    </>;\r\n  });\r\n\r\n  protected predictChartFullInfo = () => {\r\n    let { predictSeasonDataFull } = this.controller;\r\n    let len = predictSeasonDataFull.length;\r\n    if (len <= 0)\r\n      return <></>;\r\n    let label = [];\r\n    let y:number[] = [];\r\n    for (let i = len - 1; i >= 0; --i) {\r\n      let item = predictSeasonDataFull[i];\r\n      if (item.esum === undefined)\r\n        continue;\r\n      label.push(GFunc.SeasonnoToYearMonth(item.season));\r\n      y.push(item.esum);\r\n    }\r\n\r\n    let er = new ErForEarning(y);\r\n    let chartdataFull = {\r\n      labels: label,\r\n      datasets: [\r\n        {\r\n          label: '原值',\r\n          data: y.map(v=>GFunc.numberToPrecision(v)),\r\n          borderColor:'black',\r\n          backgroundColor:'skyBlue',\r\n          showLine: false,\r\n          pointStyle: \"crossRot\",\r\n          borderWidth: 1,\r\n          pointRadius: 5,\r\n          fill: false,\r\n        } as any\r\n      ]\r\n    };\r\n    if (!(isNaN(er.B) || isNaN(er.A))) {\r\n      let per:number[] = [];\r\n      for (let i = 0; i < len; ++i) {\r\n        per.push(GFunc.numberToPrecision(er.predict(i), 4));\r\n      }\r\n      chartdataFull.datasets.push(\r\n        {\r\n          label: '指数 R2:' + GFunc.numberToString(er.r2, 4),\r\n          data: per,\r\n          borderColor:'red',\r\n          backgroundColor:'pink',\r\n          borderWidth: 1,\r\n          fill: false,\r\n      });\r\n    }\r\n    let lr = new SlrForEarning(y);\r\n    if (!(isNaN(lr.slope) || isNaN(lr.intercept))) {\r\n      let plr:number[] = [];\r\n      for (let i = 0; i < len; ++i) {\r\n        plr.push(GFunc.numberToPrecision(lr.predict(i), 4));\r\n      }\r\n      chartdataFull.datasets.push(\r\n        {\r\n          label: '线性 R2:' + GFunc.numberToString(lr.r2, 4),\r\n          data: plr,\r\n          borderColor:'blue',\r\n          backgroundColor:'pink',\r\n          borderWidth: 1,\r\n          fill: false,\r\n      });\r\n    }\r\n    return <RC2 data={chartdataFull} type='line' />;\r\n  };\r\n\r\n  protected predictChartROE = () => {\r\n    let { predictSeasonDataFull } = this.controller;\r\n    let len = predictSeasonDataFull.length;\r\n    if (len <= 0)\r\n      return <></>;\r\n    let label = [];\r\n    let y:number[] = [];\r\n    for (let i = len - 1; i >= 0; --i) {\r\n      let item = predictSeasonDataFull[i];\r\n      if (item.esum === undefined)\r\n        continue;\r\n      label.push(GFunc.SeasonnoToYearMonth(item.season));\r\n      y.push(item.esumorg / item.corg);\r\n    }\r\n\r\n    let chartdataFull = {\r\n      labels: label,\r\n      datasets: [\r\n        {\r\n          label: 'ROE原值',\r\n          data: y.map(v=>GFunc.numberToPrecision(v)),\r\n          borderColor:'black',\r\n          backgroundColor:'skyBlue',\r\n          showLine: false,\r\n          pointStyle: \"crossRot\",\r\n          borderWidth: 1,\r\n          pointRadius: 5,\r\n          fill: false,\r\n        } as any\r\n      ]\r\n    };\r\n    let lr = new SlrForEarning(y);\r\n    if (!(isNaN(lr.slope) || isNaN(lr.intercept))) {\r\n      let plr:number[] = [];\r\n      for (let i = 0; i < len; ++i) {\r\n        plr.push(Number.parseFloat(lr.predict(i).toPrecision(4)));\r\n      }\r\n      chartdataFull.datasets.push(\r\n        {\r\n          label: '线性 R2:' + GFunc.numberToString(lr.r2, 4),\r\n          data: plr,\r\n          borderColor:'blue',\r\n          backgroundColor:'pink',\r\n          borderWidth: 1,\r\n          fill: false,\r\n      });\r\n    }\r\n    return <RC2 data={chartdataFull} type='line' />;\r\n  };\r\n\r\n  private predictSeasonEarning = observer(() => {\r\n    let items = this.controller.predictSeasonData;\r\n    let header = <div className=\"px-3\">\r\n      <div className=\"px-3 c6\">年月</div>\r\n      <div className=\"px-3 c6 text-right\">股本</div>\r\n      <div className=\"px-3 c6 text-right\">季收益</div>\r\n      <div className=\"px-3 c6 text-right\">年收益</div>\r\n      <div className=\"px-3 c6 text-right\">ROE</div>\r\n      <div className=\"px-3 c6 text-right\">股本o</div>\r\n      <div className=\"px-3 c6 text-right\">季收益o</div>\r\n      <div className=\"px-3 c6 text-right\">年收益o</div>\r\n    </div>;\r\n    return <>\r\n      <div className=\"px-3 py-1\">历年股本收益-用于回归计算</div>\r\n      <List header={header} loading=\"...\"\r\n        items={items}\r\n        item={{\r\n          render: (row: {season:number, c:number, e:number, esum:number, corg:number, eorg:number, esumorg:number}) => {\r\n            let {season, c, e, esum, corg, eorg, esumorg} = row;\r\n            let ym = GFunc.SeasonnoToYearMonth(season);\r\n            let a = 0;\r\n            return <div className=\"px-3 py-2 d-flex flex-wrap\">\r\n              <div className=\"px-3 c6\">{ym.toString()}</div>\r\n              <div className=\"px-3 c6 text-right\">{GFunc.numberToFixString(c)}</div>\r\n              <div className=\"px-3 c6 text-right\">{GFunc.numberToFixString(e)}</div>\r\n              <div className=\"px-3 c6 text-right\">{GFunc.numberToFixString(esum)}</div>\r\n              <div className=\"px-3 c6 text-right\">{GFunc.percentToFixString(esum/c)}</div>\r\n              <div className=\"px-3 c6 text-right\">{GFunc.numberToFixString(corg)}</div>\r\n              <div className=\"px-3 c6 text-right\">{GFunc.numberToFixString(eorg)}</div>\r\n              <div className=\"px-3 c6 text-right\">{GFunc.numberToFixString(esumorg)}</div>\r\n            </div>\r\n          }\r\n        }}\r\n      />\r\n    </>\r\n  });\r\n\r\n\r\n  private seasonEarning = observer(() => {\r\n    let items = this.controller.seasonData;\r\n    let header = <div className=\"px-3\">\r\n      <div className=\"px-3 c6\">年月</div>\r\n      <div className=\"px-3 c6 text-right\">股本</div>\r\n      <div className=\"px-3 c6 text-right\">季收益</div>\r\n      <div className=\"px-3 c6 text-right\">年收益</div>\r\n      <div className=\"px-3 c6 text-right\">ROE</div>\r\n      <div className=\"px-3 c6 text-right\">股本o</div>\r\n      <div className=\"px-3 c6 text-right\">季收益o</div>\r\n      <div className=\"px-3 c6 text-right\">年收益o</div>\r\n    </div>;\r\n    return <>\r\n      <div className=\"px-3 py-1\">历年股本收益</div>\r\n      <List header={header} loading=\"...\"\r\n        items={items}\r\n        item={{\r\n          render: (row: {season:number, c:number, e:number, esum:number, corg:number, eorg:number, esumorg:number}) => {\r\n            let {season, c, e, esum, corg, eorg, esumorg} = row;\r\n            let ym = GFunc.SeasonnoToYearMonth(season);\r\n            let a = 0;\r\n            return <div className=\"px-3 py-2 d-flex flex-wrap\">\r\n              <div className=\"px-3 c6\">{ym.toString()}</div>\r\n              <div className=\"px-3 c6 text-right\">{GFunc.numberToFixString(c)}</div>\r\n              <div className=\"px-3 c6 text-right\">{GFunc.numberToFixString(e)}</div>\r\n              <div className=\"px-3 c6 text-right\">{GFunc.numberToFixString(esum)}</div>\r\n              <div className=\"px-3 c6 text-right\">{GFunc.percentToFixString(esum/c)}</div>\r\n              <div className=\"px-3 c6 text-right\">{GFunc.numberToFixString(corg)}</div>\r\n              <div className=\"px-3 c6 text-right\">{GFunc.numberToFixString(eorg)}</div>\r\n              <div className=\"px-3 c6 text-right\">{GFunc.numberToFixString(esumorg)}</div>\r\n            </div>\r\n          }\r\n        }}\r\n      />\r\n    </>\r\n  });\r\n\r\n\r\n  private capitalEarning = observer(() => {\r\n    let items = this.controller.capitalearning;\r\n    let header = <div className=\"px-3\">\r\n      <div className=\"px-3 c6\">年</div>\r\n      <div className=\"px-3 c6 text-right\">股本</div>\r\n      <div className=\"px-3 c6 text-right\">收益</div>\r\n      <div className=\"px-3 c6 text-right\">ROE</div>\r\n    </div>;\r\n    return <>\r\n      <div className=\"px-3 py-1\">历年股本收益</div>\r\n      <List header={header} loading=\"...\"\r\n        items={items}\r\n        item={{\r\n          render: (row: StockCapitalearning) => {\r\n            let {capital, earning} = row;\r\n            return <div className=\"px-3 py-2 d-flex flex-wrap\">\r\n              <div className=\"px-3 c6\">{row.year}</div>\r\n              <div className=\"px-3 c6 text-right\"> {capital.toFixed(2)}</div>\r\n              <div className=\"px-3 c6 text-right\"> {earning.toFixed(2)}</div>\r\n              <div className=\"px-3 c6 text-right\"> {(earning/capital*100).toFixed(1)}%</div>\r\n            </div>\r\n          }\r\n        }}\r\n      />\r\n    </>\r\n  });\r\n\r\n  private bonus = observer(() => {\r\n    let items = this.controller.bonus;\r\n    let header = <div className=\"px-3\">\r\n      <div className=\"px-3 c8\">日期</div>\r\n      <div className=\"px-3 c6 text-right\">分红</div>\r\n    </div>;\r\n    return <>\r\n      <div className=\"px-3 py-1\">历年分红</div>\r\n      <List header={header} loading=\"...\"\r\n        items={items}\r\n        item={{\r\n          render: (row: StockBonus) => {\r\n            return <div className=\"px-3 py-2 d-flex flex-wrap\">\r\n              <div className=\"px-3 c8\">{row.day}</div>\r\n              <div className=\"px-3 c6 text-right\"> {row.bonus.toFixed(2)}</div>\r\n            </div>\r\n          }\r\n        }}\r\n      />\r\n    </>\r\n  });\r\n}","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport * as React from 'react';\r\nimport { observer } from 'mobx-react-lite';\r\nimport { VPage, Page, List, LMR, SearchBox } from 'tonva';\r\nimport { CStock } from './CStock'\r\n\r\nexport class VStockSelect extends VPage<CStock> {\r\n  async open(item: any) {\r\n      this.openPage(this.page, item);\r\n  }\r\n\r\n  private renderStock(stock: any, index: number) {\r\n      let { name, code } = stock;\r\n      return <LMR className=\"px-3 py-2 \" >\r\n          <div className=\"font-weight-bold\"></div>\r\n          <div>{name + ' ' + code}</div>\r\n      </LMR >\r\n  }\r\n\r\n  private onClickStock = async (model: any) => {\r\n      await this.controller.returnStock(model);\r\n      this.closePage();\r\n  }\r\n\r\n  private page = observer((customer: any) => {\r\n      let { pageItems, onPage } = this.controller;\r\n      let none = <div className=\"my-3 mx-2 text-warning\">请搜索股票！</div>;\r\n      return <Page header=\"选择股票\" headerClassName='bg-primary' onScrollBottom={onPage}>\r\n          <SearchBox className=\"px-1 w-100  mt-2 mr-2\"\r\n              size='md'\r\n              allowEmptySearch={true}\r\n              onSearch={(key: string) => this.controller.searchByKey(key)}\r\n              placeholder=\"搜索股票\" />\r\n          <List before={''} none={none} items={pageItems} item={{ render: this.renderStock, onClick: this.onClickStock }} />\r\n      </Page>\r\n  })\r\n}","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport { observable } from 'mobx';\r\nimport { PageItems } from 'tonva';\r\nimport { CUqBase } from '../UqApp';\r\nimport { VStockSelect } from './VSelectStock';\r\n\r\nclass PageStockItems<T> extends PageItems<T> {\r\n  cStock: CStock;\r\n\r\n  constructor(cs: CStock) {\r\n      super(true);\r\n      this.cStock = cs;\r\n      this.firstSize = this.pageSize = 30;\r\n  }\r\n\r\n  protected async loadResults(param: any, pageStart: any, pageSize: number): Promise<{\r\n\t[name: string]: any[];\r\n\t}> {\r\n      if (pageStart === undefined) pageStart = 0;\r\n      let p = ['%' + param.key + '%'];\r\n      try {\r\n        let ret = await this.cStock.cApp.miApi.page('q_stocks$page', p, pageStart, pageSize);\r\n        return ret;\r\n      }\r\n      catch (error) {\r\n        let e = error;\r\n        return undefined;\r\n      }\r\n  }\r\n\r\n  protected setPageStart(item: any): any {\r\n      this.pageStart = item === undefined ? 0 : item.id;\r\n  }\r\n}\r\n\r\nexport class CStock extends CUqBase {\r\n  @observable pageItems: PageStockItems<any> = new PageStockItems<any>(this);\r\n\r\n  //get cApp(): CMiApp { return this._cApp as CMiApp };\r\n\r\n  async internalStart(param: any) {\r\n    this.openVPage(VStockSelect);\r\n}\r\n\r\n  searchByKey = async (key: string) => {\r\n    this.pageItems = new PageStockItems<any>(this);\r\n    this.pageItems.first({ key: key });\r\n  }\r\n\r\n  //给调用页面返回id\r\n  returnStock = async (item: any): Promise<any> => {\r\n    this.returnCall(item);\r\n  }\r\n\r\n  onPage = async () => {\r\n    await this.pageItems.more();\r\n  }\r\n}","export * from './StockInfoType';\r\nexport { CStockInfo } from './CStockInfo';\r\nexport { VStockInfo } from './VStockInfo';","import * as React from 'react';\r\n\r\nexport class GFunc {\r\n  public static numberToFixString(n: number, w = 2) {\r\n    return n === undefined ? '' : n.toFixed(w);\r\n  }\r\n  public static number(n: number, w=2) {\r\n    return n === undefined ? '' : n.toFixed(w);\r\n  }\r\n\r\n  public static numberToMarketValue(n: number) {\r\n    return n === undefined || isNaN(n) ? '' : Math.round(n/10000).toString(); // + '亿';\r\n  }\r\n\r\n  public static numberToString(n: number, precision = 2) {\r\n    return n === undefined ? '' : n.toPrecision(precision);\r\n  }\r\n\r\n  public static numberToPrecision(n: number, precision = 4) {\r\n    return n === undefined ? undefined : Number.parseFloat(n.toPrecision(precision));\r\n  }\r\n\r\n  public static percentToFixString(n: number) {\r\n    return n === undefined || isNaN(n) ? '' : (n * 100).toFixed(2) + '%';\r\n  }\r\n\r\n  public static percent0(n: number) {\r\n    return n === undefined || isNaN(n) ? '' : (n * 100).toFixed(0) + '%';\r\n  }\r\n  public static percent1(n: number) {\r\n    return n === undefined || isNaN(n) ? '' : (n * 100).toFixed(1) + '%';\r\n  }\r\n\r\n  public static warningTypeString(t: string) {\r\n    switch (t) {\r\n      case 'gt': return '大于';\r\n      case 'lt': return '小于';\r\n      default: return t;\r\n    }\r\n  }\r\n\r\n  public static predictCutRatio(r2:number) {\r\n    return r2 * 2 - r2 * r2;\r\n  }\r\n\r\n  public static evaluatePricePrice(iRate:number, e1:number, e2:number, e3:number) {\r\n    let r = 1 + iRate;\r\n    let r2 = r * r;\r\n    let r3 = r2 * r;\r\n    return (e1/r + e2 /r2 + e3 / r3 + e3 / iRate / r3) / 2;\r\n  }\r\n\r\n  public static calculateV(z:number, divyield:number, pe:number) {\r\n    if (pe === undefined || isNaN(pe)) {\r\n      return undefined;\r\n    }\r\n\r\n    let r = 0;\r\n    if (z !== undefined) {\r\n      if (z > 0.25) {\r\n        z = 0.25;\r\n      }\r\n      r += z * 100;\r\n    }\r\n    if (divyield !== undefined) {\r\n      r += divyield * 100;\r\n    }\r\n    return r / pe;\r\n  }\r\n\r\n  public static calculateVN(z:number, e:number, bonus:number, price:number) {\r\n    if (price === undefined || isNaN(price) || e === undefined || isNaN(e)) {\r\n      return undefined;\r\n    }\r\n\r\n    let r = 0;\r\n    if (z !== undefined && e > 0) {\r\n      if (z > 0.25) {\r\n        z = 0.24 + Math.pow((z-0.24)*100, 0.6667) / 100;\r\n      }\r\n      z = 1 + z;\r\n      z = z * z * z - 1;\r\n      r += z * e * 100;\r\n    }\r\n    if (bonus !== undefined && !isNaN(bonus)) {\r\n      r += bonus * 100;\r\n    }\r\n    return r / price;\r\n  }\r\n\r\n  public static calculateZZ3(data:number[]) {\r\n    let ret:number[] = [undefined, undefined, undefined, undefined] ;\r\n    if (data === undefined)\r\n      return ret;\r\n    let len = data.length;\r\n    if (len < 5)\r\n      return ret;\r\n    \r\n    let funcz = (n:number, p:number) => {\r\n      if (p <= 0 || n <= 0)\r\n        return undefined;\r\n      return ((n / p) - 1);\r\n    }\r\n    for (let i = 0; i < 4; ++i) {\r\n      ret[i] = funcz(data[i+1], data[i]);\r\n    }\r\n    return ret;\r\n  }\r\n\r\n  public static caption = (value:string) => <span className=\"text-muted small\">{value}</span>;\r\n\r\n  public static MonthnoFromDay(day:number) {\r\n    let year = Math.floor(day/10000);\r\n    let month = Math.floor((day%10000)/100) - 1;\r\n    return (year-1995)*12+month;\r\n  }\r\n  \r\n  public static SeasonnoFromDay(day:number) {\r\n    let year = Math.floor(day/10000);\r\n    let month = Math.floor((day%10000)/100) - 1;\r\n    let season = Math.floor(month / 3);\r\n    return (year-1995)*4 + season;\r\n  }\r\n  \r\n  public static SeasonnoFromYearMonth(year:number, month:number) {\r\n    let season = Math.floor((month-1) / 3);\r\n    return (year-1995)*4 + season;\r\n  }\r\n\r\n  public static SeasonnoToYearMonth(no: number) {\r\n    let year = Math.floor(no / 4) + 1995;\r\n    let month = (Math.floor(no % 4) + 1) * 3;\r\n    return year * 100 + month;\r\n  }\r\n  \r\n  public static SeasonnoToBeginEnd(season:number) {\r\n    let year = (1995 + Math.floor(season / 4)) * 10000;\r\n    let s = season % 4;\r\n    if (s === 0) {\r\n      return {begin: year + 101, end: year + 331};\r\n    } \r\n    else if (s === 1) {\r\n      return {begin: year + 401, end: year + 630};\r\n    }\r\n    else if (s === 2) {\r\n      return {begin: year + 701, end: year + 930};\r\n    }\r\n    return {begin: year + 1001, end: year + 1231};\r\n  }\r\n\r\n  public static CalculatePredictAvg(arr: {predictpe:number}[]) {\r\n    let ret : {avg20:number, avg50:number, avg100:number} = {avg20:undefined, avg50:undefined, avg100:undefined};\r\n\r\n    let length = arr.length;\r\n    let calcuOne = (count:number) : number => {\r\n      let endIndex = count;\r\n      if (endIndex > length)\r\n        endIndex = length;\r\n      if (endIndex >= 10) {\r\n        let sum = 0;\r\n        for (let i = 3; i < endIndex; ++i) {\r\n          sum += arr[i].predictpe\r\n        }\r\n        return sum / (endIndex - 3);\r\n      }\r\n      else {\r\n        return undefined;\r\n      }\r\n    }\r\n\r\n    ret.avg20 = calcuOne(20);\r\n    ret.avg50 = calcuOne(50);\r\n    ret.avg100 = calcuOne(100);\r\n    return ret;\r\n  }\r\n\r\n  public static CalculateValueAvg(arr: {v:number}[]) {\r\n    let ret : {avg20:number, avg50:number, avg100:number, avg:number} = {avg20:undefined, avg50:undefined, avg100:undefined, avg:undefined};\r\n\r\n    let length = arr.length;\r\n    let calcuOne = (count:number) : number => {\r\n      let endIndex = count;\r\n      if (count === 0 || endIndex > length)\r\n        endIndex = length;\r\n      if (endIndex >= 10) {\r\n        let sum = 0;\r\n        for (let i = 3; i < endIndex; ++i) {\r\n          sum += arr[i].v;\r\n        }\r\n        return sum / (endIndex - 3);\r\n      }\r\n      else {\r\n        return undefined;\r\n      }\r\n    }\r\n\r\n    ret.avg20 = calcuOne(20);\r\n    ret.avg50 = calcuOne(50);\r\n    ret.avg100 = calcuOne(100);\r\n    ret.avg = calcuOne(0);\r\n    return ret;\r\n  }\r\n}\r\n"],"sourceRoot":""}