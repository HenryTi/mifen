{"version":3,"sources":["tonva-react/index.ts","tonva-react/tool/left0.ts","tonva-react/tool/local.ts","tonva-react/tool/getObjPropIgnoreCase.ts","tonva-react/tool/caseString.ts","tonva-react/components/index.ts","tool/GFunc.tsx","tonva-react/components/nav.tsx","tonva-react/net/netToken.ts","tonva-react/components/fetchErrorView.tsx","tonva-react/components/reloadPage.tsx","tonva-react/uq/build/tools.ts","tonva-react/net/guestApi.ts","tonva-react/net/caller.ts","tonva-react/components/page/page.tsx","tool/render.tsx","tool/func.ts","tool/renderGroup.tsx","consts.ts","tonva-uqui/list/ListPage.tsx","tonva-uqui/list/CList.ts","tonva-uqui/list/MidList.ts","tonva-uqui/index.ts","tonva-react/vm/controller.tsx","tonva-react/vm/view.tsx","tonva-react/vm/vpage.tsx","tonva-react/uq/entity.ts","tonva-react/components/edit/itemEdit.tsx","tonva-react/res/formRes.ts","tonva-react/res/listRes.ts","tonva-react/uq/caller.ts","tonva-uqui/tools/pageItems.ts","tonva-uqui/tools/timeSpan.ts","tonva-uqui/tools/parts.tsx","tonva-uqui/base/index.ts","tonva-react/net/httpChannel.ts","tonva-react/net/httpChannelUI.ts","tonva-react/net/uqApi.ts","tonva-uqui/form/VFormView.tsx","tonva-uqui/form/CFormView.ts","tonva-uqui/form/VFormPage.tsx","tonva-uqui/form/CFormPage.ts","tonva-uqui/form/VDialog.tsx","tonva-uqui/form/CFormDialog.ts","tonva-uqui/form/FormUI.ts","tonva-react/uq/query.ts","tonva-uqui/select/CIDSelect.ts","tonva-uqui/select/parts.tsx","tonva-uqui/select/CIXSelect.ts","tonva-uqui/select/createPickId.ts","tonva-react/tool/uid.ts","tonva-react/net/appBridge.ts","tonva-react/net/wsChannel.ts","tonva-react/components/image.tsx","regression/SlrForEarning.ts","regression/ErForEarning.ts","tonva-react/tool/user.ts","tonva-react/net/host.ts","tonva-react/components/page/scrollView.tsx","tonva-react/res/res.ts","tonva-react/uq/action.ts","tonva-react/components/simple/LMR.tsx","tonva-react/components/simple/Badge.tsx","tonva-react/components/simple/FA.tsx","tonva-react/components/simple/IconText.tsx","store/index.ts","tonva-react/tool/localDb.ts","tonva-react/uq/tuid/reactBoxId.tsx","tonva-react/components/loading.tsx","tonva-react/tool/env.ts","tonva-react/components/login.tsx","tonva-react/uq/index.ts","tonva-react/uq/tuid/index.ts","tonva-react/uq/ID.ts","store/sortStocks.ts","uq-app/CBase.ts","uq-app/bug/tester/test-times-change.ts","uq-app/bug/tester/index.ts","uq-app/bug/tester/test1.ts","uq-app/bug/tester/test2.ts","uq-app/bug/tester/test3.ts","uq-app/bug/tester/test4.ts","uq-app/bug/VBug.tsx","uq-app/bug/VConsole.tsx","uq-app/bug/CBug.ts","uq-app/res/index.ts","uq-app/res/zh.ts","uq-app/res/en.ts","uq-app/VMain.tsx","uq-app/test-uqui/VTest.tsx","uq-app/test-uqui/CTest.tsx","uq-app/uqs/BruceYuMi/$Piecewise.ui.tsx","uq-app/uqs/BruceYuMi/Market.ui.tsx","uq-app/uqs/BruceYuMi/Transaction.ui.tsx","uq-app/uqs/BruceYuMi/Group.ui.tsx","uq-app/uqs/BruceYuMi/Account.ui.tsx","uq-app/uqs/BruceYuMi/Holding.ui.tsx","uq-app/uqs/BruceYuMi/$PiecewiseDetail.ui.tsx","uq-app/uqs/BruceYuMi/Stock.ui.tsx","uq-app/uqs/BruceYuMi/StockValue.ui.tsx","uq-app/uqs/BruceYuMi/AccountValue.ui.tsx","uq-app/uqs/BruceYuMi/Portfolio.ui.tsx","uq-app/uqs/BruceYuMi/UserBlockStock.ui.tsx","uq-app/uqs/BruceYuMi/UserAccount.ui.tsx","uq-app/uqs/BruceYuMi/UserGroup.ui.tsx","uq-app/uqs/BruceYuMi/UserAllStock.ui.tsx","uq-app/uqs/BruceYuMi/AccountHolding.ui.tsx","uq-app/uqs/BruceYuMi/GroupStock.ui.tsx","uq-app/uqs/BruceYuMi/BruceYuMi.ts","uq-app/uqs/index.ts","uq-app/uqs/BruceYuMi/index.ts","me/VEditMe.tsx","uq-app/appConfig.ts","me/VFaq.tsx","me/VAbout.tsx","me/VMe.tsx","me/CMe.ts","images/logo.svg","explorer/VSiteHeader.tsx","explorer/VExplorer.tsx","explorer/VExplorerCfg.tsx","explorer/explore.ts","explorer/CExplorer.tsx","warning/VWarningConfig.tsx","warning/CWarning.tsx","predicthistory/VPredictHistory.tsx","predicthistory/CPredictHistory.tsx","net/httpChannel.ts","net/httpChannelUI.ts","net/apiBase.ts","net/miApi.ts","net/miNet.ts","home/VHome.tsx","home/account/VAccount.tsx","home/account/VForm.tsx","home/account/VAccounts.tsx","home/account/CAccount.ts","home/group/VGroups.tsx","home/group/CGroup.ts","home/VStockList.tsx","home/CHome.ts","find/stockPageItems.ts","find/VFind.tsx","find/VSetting.tsx","find/VStocksPage.tsx","find/CFind.ts","common/VBlockStock.tsx","common/VKeepStock.tsx","common/VPinStock.tsx","common/VStockInGroup.tsx","common/VStockLink.tsx","common/CCommon.ts","uq-app/CApp.ts","uq-app/App.tsx","tonva-uqui/ID/VEdit.tsx","tonva-uqui/ID/VView.tsx","tonva-uqui/ID/res/index.ts","tonva-uqui/ID/res/zh.ts","tonva-uqui/ID/res/en.ts","tonva-uqui/ID/CID.ts","tonva-uqui/ID/MidIDList.ts","tonva-uqui/ID/MidID.ts","tonva-react/net/apiBase.ts","tonva-react/uq/uqsMan.ts","store/holdingStock.ts","tonva-uqui/IX/CIXList.ts","tonva-uqui/IX/CIX.ts","tonva-uqui/IX/CIXEdit.ts","tonva-react/components/edit/imageItemEdit.tsx","tonva-react/tool/rules.ts","tonva-react/tool/pageItems.ts","tonva-react/tool/62.ts","tonva-react/net/messageHub.ts","tonva-react/components/navigo.ts","tonva-react/components/page/pageHeader.tsx","tonva-react/components/page/tabs.tsx","tonva-react/components/resUploader.tsx","tonva-react/uq/uqMan.ts","tonva-react/uq/sheet.ts","tonva-react/uq/book.ts","tonva-react/uq/history.ts","tonva-react/uq/map.ts","tonva-react/uq/pending.ts","tonva-react/uq/enum.ts","uq-app/uqs/BzHelloTonva/index.ts","stockinfo/VStockInfo.tsx","store/stockGroups.ts","store/stockGroup.ts","store/miAccount.ts","store/miGroup.ts","tonva-react/app/centerApi.ts","tonva-react/app/vMain.tsx","tonva-react/app/CAppBase.ts","tonva-react/app/start.ts","tonva-react/app/CBase.ts","tonva-react/uq/tag/tagView.tsx","tonva-react/uq/tag/tag.ts","uq-app/uqs/BzHelloTonva/Customer.ui.tsx","stockinfo/index.ts","selectStock/VSelectStock.tsx","selectStock/CSelectStock.tsx","tonva-react/uq/build/fieldItem.ts","tonva-react/auth/VLogout.tsx","tonva-react/auth/VLogin.tsx","tonva-react/auth/VChangePassword.tsx","tonva-react/auth/CLogin.tsx","tonva-react/img/logo.svg","tonva-react/auth/tools.tsx","tonva-react/components/page/index.ts","tonva-react/components/schema/index.ts","tonva-react/components/dropDownActions/index.tsx","tonva-react/components/easyDate/index.tsx","tonva-react/components/media.tsx","tonva-react/components/searchBox.tsx","tonva-react/components/userIcon.tsx","tonva-react/components/ax/index.tsx","tonva-react/components/autoHideTips.tsx","tonva-react/uq/tuid/tuidsCache.ts","tonva-react/ui/index.ts","tonva-uqui/base/Mid.ts","tonva-react/components/form/rules/index.ts","tonva-react/components/form/widgets/widget.tsx","tonva-react/components/form/widgets/textWidget.tsx","tonva-react/components/form/widgets/textareaWidget.tsx","tonva-react/components/form/widgets/passwordWidget.tsx","tonva-react/components/form/widgets/numberWidget.tsx","tonva-react/components/form/widgets/updownWidget.tsx","tonva-react/components/form/widgets/dateWidget.tsx","tonva-react/components/form/widgets/checkBoxWidget.tsx","tonva-react/components/form/widgets/selectWidget.tsx","tonva-react/components/form/widgets/radioWidget.tsx","tonva-react/components/form/widgets/rangeWidget.tsx","tonva-react/components/form/widgets/idWidget.tsx","tonva-react/components/form/widgets/unknown.tsx","tonva-react/components/form/widgets/buttonWidget.tsx","tonva-react/components/form/context.tsx","tonva-react/components/form/widgets/arrComponent.tsx","tonva-react/components/form/widgets/imageWidget.tsx","tonva-react/components/form/widgets/tagWidget.tsx","tonva-react/components/form/widgets/factory.tsx","tonva-react/components/form/form.tsx","tonva-react/components/form/field.tsx","tonva-react/components/edit/stringItemEdit.tsx","tonva-react/components/edit/radioItemEdit.tsx","tonva-react/components/edit/selectItemEdit.tsx","tonva-react/components/edit/idItemEdit.tsx","tonva-react/components/edit/tagItemEdit.tsx","tonva-react/components/edit/textAreaItemEdit.tsx","tonva-react/components/edit/checkBoxItemEdit.tsx","tonva-react/components/edit/rangeItemEdit.tsx","tonva-react/components/edit/numberItemEdit.tsx","tonva-react/components/edit/edit.tsx","tonva-uqui/IDX/MidIDXList.ts","tonva-uqui/IDX/res/index.ts","tonva-uqui/IDX/res/zh.ts","tonva-uqui/IDX/res/en.ts","tonva-uqui/IDX/VEdit.tsx","tonva-uqui/IDX/VHistory.tsx","tonva-uqui/IDX/VView.tsx","tonva-uqui/IDX/CIDX.ts","tonva-uqui/IDX/MidIDX.ts","tonva-uqui/tag/MidTag.ts","tonva-uqui/tag/select/VSelect.tsx","tonva-uqui/tag/select/CSelect.ts","tonva-uqui/tag/parts.tsx","tonva-uqui/tag/CIDTagList.ts","tonva-uqui/tag/VTags.tsx","tonva-uqui/tag/CTagIDList.ts","tonva-uqui/sheet/MidSheet.ts","tonva-uqui/sheet/CSheet.ts","tonva-uqui/sheet/VSheetEdit.tsx","tonva-uqui/sheet/CSheetNew.ts","tonva-uqui/sheet/VSheetView.tsx","tonva-uqui/roles/VRoles.tsx","tonva-uqui/roles/roleAdmin/VAddUser.tsx","tonva-uqui/roles/roleAdmin/VRoleAdmin.tsx","tonva-uqui/roles/roleAdmin/CRoleAdmin.ts","tonva-uqui/roles/CRoles.ts","store/accounts.ts","store/miAccounts.ts","store/miGroups.ts","store/market.tsx","store/store.ts","tonva-react/components/list/base.tsx","tonva-react/components/list/clickable.tsx","tonva-react/components/list/static.tsx","tonva-react/components/list/selectable.tsx","tonva-react/components/list/index.tsx","tonva-react/components/propGrid/row.tsx","tonva-react/components/propGrid/propView.tsx","tonva-react/components/propGrid/PropGrid.tsx","tonva-react/auth/meInfo.tsx","stockinfo/VTags.tsx","stockinfo/CStockInfo.tsx","tonva-react/uq/tuid/idCache.ts","tonva-react/uq/tuid/tuid.ts","tonva-react/uq/build/buildTsUqFolder.ts","tonva-react/uq/build/buildUQ.ts","uq-app/uqs/BzHelloTonva/OrderMaster.ui.tsx","uq-app/uqs/BzHelloTonva/OrderDetail.ui.tsx","uq-app/uqs/BzHelloTonva/Tag.ui.tsx","uq-app/uqs/BzHelloTonva/Staff.ui.tsx","uq-app/uqs/BzHelloTonva/$Piecewise.ui.tsx","uq-app/uqs/BzHelloTonva/$PiecewiseDetail.ui.tsx","uq-app/uqs/BzHelloTonva/Achieve.ui.tsx","uq-app/uqs/BzHelloTonva/Hours.ui.tsx","uq-app/uqs/BzHelloTonva/CustomerTag.ui.tsx","uq-app/uqs/BzHelloTonva/UserStaff.ui.tsx","reportWebVitals.ts","index.tsx"],"names":["left0","num","fix","undefined","r","toString","len","length","substr","LocalData","user","env","localDb","child","guest","unit","_user","_guest","_unit","this","get","set","forEach","d","remove","getObjPropIgnoreCase","obj","prop","keys","Object","toLowerCase","key","capitalCase","s","split","map","v","firstCharUppercase","join","camelCase","parts","c","charCodeAt","ACode","ZCode","String","fromCharCode","firstCharLowercase","i","aCode","zCode","GFunc","n","w","toFixed","isNaN","Math","round","precision","toPrecision","Number","parseFloat","t","r2","iRate","e1","e2","e3","r3","z","divyield","pe","e","bonus","price","pow","ev","data","ret","funcz","p","day","floor","year","month","no","season","begin","end","arr","avg20","avg50","avg100","avg","calcuOne","count","endIndex","sum","caption","value","className","logMark","netToken","userId","token","setCenterToken","WSChannel","FetchErrorView","reApi","a","props","clearError","channel","url","options","resolve","reject","refetchApi","close","errContent","error","err","push","style","wordWrap","type","onClick","React","SystemNotifyPage","message","header","ReloadPage","timerHandler","reload","clearInterval","nav","seconds","state","setInterval","setState","title","msg","ConfirmReloadPage","back","confirm","isMobile","RegExp","test","navigator","userAgent","logs","stackKey","notSupportedBrowsers","NavView","stack","waitCount","waitTimeHandler","upgradeUq","start","isHistoryBack","navBack","tick","Date","now","console","log","window","self","top","postMessage","confirmClose","pop","fetchError","browser","notSupportedBrowser","findIndex","wait","addEventListener","init","setTimeout","clearTimeout","unauthorized","showLogin","uq","version","show","view","disposer","clear","removeCeased","history","pushState","ceased","refresh","item","dispose","level","backLevel","popAndDispose","find","elWait","elError","testing","left","zIndex","name","index","visibility","position","navView","wsHost","local","navigo","navSettings","language","culture","resUrl","hashParam","centerHost","arrs","windowOnError","event","source","lineno","colno","windowOnUnhandledRejection","reason","windowOnClick","windowOnMouseMove","x","y","windowOnScroll","forceDevelopment","reloadUser","curUser","id","logined","logout","navLogin","params","navLogout","showLogout","navRegister","showRegister","navForget","showForget","navPageRoutes","doneSysRoutes","sysRoutes","isWebNav","backIcon","closeIcon","pageWebNav","onChangeLogin","showPrivacyPage","privacy","getPrivacyContent","privacyPage","htmlString","content","__html","dangerouslySetInnerHTML","createLogin","login","waiting","Promise","race","serviceWorker","ready","registration","unregister","document","location","plus","webview","webView","resetAll","ok","showReloadPage","localStorage","lang","resOptions","district","g","messageHub","dispatch","unitJsonPath","fetch","unitRes","json","res","el","getElementById","innerText","loadUnitJson","innerHTML","JSON","parse","process","isDevelopment","getPredefinedUnitName","unitName","guestApi","unitFromName","unitId","settings","htmlTitle","html0","getElementsByTagName","getAttribute","oem","origin","pathname","endsWith","host","ws","resHost","resUrlFromHost","setCenterUrl","Error","setGuest","onerror","onunhandledrejection","onfocus","onselectstart","oncontextmenu","startWait","userPassword","userName","password","userApi","pwd","logindUser","notLogined","endWait","Navigo","historyAPIUpdateMethod","on","navigate","navPage","queryStr","routeFromNavPage","internalOnNavRoutes","_","merge","navOns","route","absolute","alert","showPage","isUserLogin","onLogined","roles","me","icon","nick","callback","logoutApis","stringify","saveLocalUser","showAppView","internalLogined","defaultTop","loginTop","withBack","getLogin","logoutClear","showChangePassword","onError","showUpgradeUq","replace","topKey","popTo","ceaseTop","regConfirmClose","confirmBox","date","getTime","toTimeString","step","href","indexOf","text","parser","DOMParser","htmlDoc","parseFromString","elHtml","newVersion","observable","red","lastBuildTime","saveSrcTsFileIfNotExists","context","fileName","suffix","saveTsFileIfNotExists","uqTsSrcPath","saveTsFile","srcFile","tsFile","fs","existsSync","renameSync","writeFileSync","overrideTsFile","path","tsFilePath","buildTsHeader","entityName","getNameFromUq","uqMan","devPart","uqPart","config","dev","alias","devName","uqOwner","uqName","decodeGuestToken","CenterApiBase","Caller","_params","method","Page","observer","tabsView","tabsProps","TabsView","webNav","right","headerClassName","afterBack","inWebNav","pageHeaderProps","center","rph","renderPageHeader","footer","elFooter","errorInfo","onScroll","onScrollTop","onScrollBottom","children","renderHeader","renderFooter","renderSortCol","radioName","sortMethod","sort","defaultSort","defaultChecked","renderSortHeaders","role","aria-label","renderValue","valueType","vStr","_cn","cn","percent0","percent1","number","numberToMarketValue","renderStockInfoRow","row","onClickName","inputSelect","inputSelectSpan","code","roe","order","symbol","l","pshares","zzl","calculateZZ3","dataArr","rows","log2","renderStockRow","stock","earning","divident","miRate","volumn","ttm","inc1","inc2","inc3","inc4","preInc","$market","nFormat","Intl","NumberFormat","maximumSignificantDigits","formatNumber","format","renderStockUrl","market","target","rel","stopPropagation","renderGroup","IDRender","consts","uqBasedata","appIcon","miApiHost","miApiHostDebug","defaultGroupName","defaultBlackListGroupName","ListPage","listPageProps","renderPage","pageItems","itemClick","renderItem","renderItemContainer","bottom","render","onPageScroll","scroller","onPageScrollTop","onPageScrollBottom","items","CList","midList","selectedItem","setRes","onItemClick","renderRight","first","firstParam","page","openPage","returnCall","onRightClick","listRight","Controller","MidList","createPageItems","Mid","MidIDListBase","IDListPageItems","pageStart","pageSize","loadPageItems","_items","itemId","newItem","unshift","runInAction","assign","ListPageItems","str","internalT","label","isDev","receiveHandlerId","unregisterReceiveHandler","onDispose","onMessageReceive","onMessage","_resolve_$","topPageKey","beforeInit","getPageWebNav","afterInit","$lang","$district","timeZone","vp","param","open","replaceOpen","onEvent","registerReceiveHandler","beforeStart","internalStart","afterStart","onClosePage","go","yes","classNames","closePage","buttons","View","controller","isMe","vm","vCall","imageClassName","textClassName","renderUser","src","replacePage","backPage","ceasePage","popToTopPage","VPage","retOnClosePage","_onClosePage","openPageElement","replacePageElement","ln","chars","codeBackSlash","codeN","codeT","codeB","codeF","codeV","codeR","codes","codeBN","codeBT","codeBB","codeBF","codeBV","codeBR","Entity","typeId","jName","schema","ver","sys","cache","uqApi","fields","arrFields","returns","face","fieldMaps","localMap","f","loadEntitySchema","buildSchema","loadValues","setSchema","buildFieldsTuid","setJName","buildFieldTuid","buildArrFieldsTuid","fieldName","arrName","entities","fn","getTuid","an","fieldArr","tuid","result","buildFieldsParams","arrResult","pa","rowResult","field","val","buildDateTimeParam","getFullYear","getMonth","getDate","_tuid","getIdFromObj","dt","toISOString","packRow","arrData","packArr","ch","substring","escape","values","boxId","unpackRow","unpackArr","ch0","fLen","to","reverseNT","p0","vals","ItemEdit","edit","itemSchema","uiItem","_itemSchema","_uiItem","newValue","isChanged","makeObservable","internalEnd","divValue","labelHide","templet","Templet","widget","list","rules","nv","Array","isArray","verifyRule","rule","formRes","required","integer","min","max","zh","listRes","none","EntityCaller","entity","tries","_entity","loadSchema","innerRequest","xcall","innerCall","jsonResult","$uq","$modify","pullModify","xresult","retry","uqVersion","en","rebuildSchema","buildEntities","ActionCaller","QueryQueryCaller","unpackReturns","buildParams","QueryPageCaller","pageLoader","$page","PageItems","HistoryPageItems","far","near","TimeSpan","firstNear","dayValues","days","getDayArray","dv","setMinutes","getMinutes","getTimezoneOffset","span","DaySpan","WeekSpan","MonthSpan","YearSpan","_labels","setHours","toLocaleDateString","enWeek","zhWeek","firstDay","lastDay","getDay","setDate","initFromDate","setMonth","methodsWithBody","HttpChannel","hostUrl","apiToken","ui","timeout","showError","post","urlPrefix","caller","buildOptions","headers","h","encodeURI","body","innerFetch","k","innerFetchResult","buildError","ex","retErr","that","timeOutHandler","statusText","ct","then","retJson","retError","catch","startsWith","buildHeaders","CenterHttpChannel","u","isBridged","bridgeCenterApi","UqHttpChannel","HttpChannelNavUI","channelUIs","channelNoUIs","channels","logoutUqTokens","UqApi","basePath","showWaiting","buildAppUq","channelUI","uqToken","getUqToken","trim","theUser","ApiBase","UnitxApi","buildChannel","centerAppApi","CenterAppApi","unitxUq","db","urlTest","realUrl","getUrlOrTest","centerChannel","centerChannelUI","centerToken","loginedUserId","uqTokensName","uqTokenApi","un","localCache","nowTick","clone","uqParams","callCenterapi","call","appOwner","appName","uqs","decodeUserToken","account","verify","VFormView","onSubmit","submit","uiSchema","fieldLabelSize","formData","onButtonClick","CFormView","formUI","submitCaption","buildItemSchema","buildUISchema","ID","noField","NO","readOnly","defaultValue","uiField","isKey","fieldItem","uiButton","pickId","uiNumber","placeholder","VFormPage","renderForm","CFormPage","openVPage","VDialog","CFormDialog","FormUI","fieldCustoms","fieldCustom","idField","createPickId","proxy","fieldNames","splice","onChanged","onChanging","UqQuery","more","startField","isPaged","size","array","deep","pageCaller","request","queryCaller","query","table","Query","CIDSelect","midIDSelectList","MidIDSelectList","onChange","renderSelectItem","evt","onSelectChange","currentTarget","checked","$in","IDX","CIXSelect","MidIXSelectList","IX","IDinIX","mid","cIDSelect","CIDSelectInPickId","isSelected","ALPHABET","uid","rtn","charAt","random","uqTokens","parent","subFrameStarted","subWin","setSubAppWindow","hash","hidden","hideFrameBack","initSubWin","onReceiveAppApiMessage","apiName","onAppApiReturn","action","uqTokenActions","onReceive","callCenterApiFromMessage","bridgeCenterApiReturn","at","opener","brideCenterApis","callId","from","directCall","bca","subAppWindow","postWsToSubApp","win","WsBase","wsBaseSeed","wsBaseId","WebSocket","onopen","onmessage","wsMessage","onclose","receive","netThis","connect","send","Image","altImage","alt","SlrForEarning","slope","intercept","slopeR","endY","regress","score","xSum","ySum","xSquared","xY","numerator","ym","predict","y2","chi2","rmsd","ySquared","yi2","yi","yiyi2","sqrt","ErForEarning","A","B","yx","exp","jwtDecode","uqDebugHost","hosts","centerhost","reshost","uqhost","unitxhost","httpArr","urlFromHost","isAbsoluteUrl","centerUrlFromHost","centerWsFromHost","https","fetchOptions","mode","tryLocal","getCenterHost","getResHost","promises","hostArr","fetchUrl","debugHostUrl","localCheck","all","results","j","hostValue","includes","debugHost","testProd","getUrlOrDebug","urlDebug","fetchLocalCheck","Scroller","scrollTo","scrollTop","offsetHeight","scrollTimeGap","ScrollViewBase","bottomTime","topTime","div","refDiv","onResize","removeEventListener","sh","scrollHeight","direct","Children","_$scroll","eachChild","Component","ScrollView","ref","WebNavScrollView","vHeader","vFooter","navHeader","navRawHeader","navFooter","navRawFooter","resLang","languages","toUpperCase","setResOptions","resGlobal","setGlobalRes","Action","ActionSubmitCaller","SubmitReturnsCaller","SubmitConvertCaller","pack","LMR","b","badge","color","badgeAlign","badgeVertical","cursor","FA","spin","fixWidth","border","pull","pulse","rotate","flip","inverse","IconText","iconClass","textClass","__ls","getItem","setItem","removeItem","LocalCache","removeLocal","Local","caches","locals","keyForGet","keyForSet","sk","LocalArr","LocalMap","keyForRemove","removeAll","ks","saveIndex","ls","TuidContent","tuidName","uqStringify","ReactBoxId","isUndefined","valueFromId","boxName","assureBox","tuidValue","nullUI","ttv","divObj","bi","logContent","boxIdContent","Loading","pl","search","decode","decodeURIComponent","match","exec","sUnit","tc","tt","from62","parseInt","isInteger","initEnv","detectBrowser","tag","ms","args","global","handle","documentMode","importCLogin","CLogin","importCRegister","CRegister","CForget","IDXEntity","sortStocks","sortType","getsortFunc","o","CUqBase","CBase","CUqApp","CSub","CAppBase","testTimesChange","discription","debugItems","VBug","openDebugPage","VConsole","divBottom","autoScrollEnd","autoScroll","lastScrollTop","timeHandler","html","range","createRange","selectNode","objToHtml","createContextualFragment","appendChild","startAutoScrollToBottom","currentItem","scrollIntoView","pauseAutoScrollToBottom","arrToHtml","indent","objToString","indentVal","objToLine","CBug","tab","renderView","load","m","getUqRoles","$zh","home","relation","discover","debug","changePassword","aboutTheApp","pleaseLogin","backend","myAll","myBlack","$en","VMain","cHome","cFind","cMe","tabs","notify","onShown","selected","TabCaptionComponent","VTester","click","uiItems","CTester","BzHelloTonva","MidID","Customer","cID","CID","midTag","MidTag","CustomerTag","Tag","midIDTagList","MidIDTagList","cIDTagList","CIDTagList","cTagIDList","CTagIDList","Staff","cStaff","MidIDX","Hours","cHours","CIDX","prev","quantity","getValue","isNumber","setValue","sheetUI","master","OrderMaster","customer","detail","OrderDetail","product","amount","MidSheet","cSheetNew","CSheetNew","mul","offset","asc","currency","holding","Group","Name","resRaw","sec","rawId","miValue","pvolumn","dvRate","smoothness","mi","cash","ix","EnumGroupType","setUI","BruceYuMi","$Piecewise","Market","Transaction","Account","Holding","$PiecewiseDetail","Stock","StockValue","AccountValue","Portfolio","UserBlockStock","UserAccount","UserGroup","UserAllStock","AccountHolding","GroupStock","VEditMe","onItemChanged","preValue","userSetProp","onExit","gridRows","component","bk","appConfig","app","noUnit","tvs","VFaq","VAbout","VMe","meInfo","showEditMe","userSpan","faq","about","aboutRows","CMe","unitOwner","rootUnits","VSiteHeader","logo","height","width","renderSiteHeader","VExplorer","renderRow","rowContent","store","cApp","labelId","isMySelect","isMyAll","middle","onSelect","rowKey","openStockInfo","onSelectItem","onClickItem","onPage","onConfig","explore","setSortType","avgs","avgStr","numberToFixString","before","irate","bmin","bmax","lmin","lmax","lr2","lr4","mcount","r210","VExplorerCfg","sortChage","newType","setStockSortType","selectChange","setStockSelectType","onFormButtonClick","cfg","setRegressionConfig","findStockConfg","fData","regression","Explore","lastTradeDay","selectedItems","loadItems","userStock","queryName","loadExportItems","rets","lastDayRet","dataArray","eshares","capital","bshares","calculateVS","CalculateValueAvg","addTagStock","removeTagStock","setUserSortType","CExplorer","onItemSelected","onItemUnselected","renderHome","openMetaView","newC","CStockInfo","onClickPredictAVG","priceDay","openPredictAVG","VWarningConfig","anySelected","warnings","divNewTag","onNewWarning","renderWarning","witem","warningTypeString","maxLength","visible","VNewWarning","newuiSchema","showSelectStock","onSaveNewWarning","CWarning","onWarningConfg","loadWarnings","miNet","t_stockwarning$add","onSaveWarning","cStock","CSelectStock","t_stockwarning$all","VPredictHistory","pageContent","historyChart","chartHistory","labelList","avg20List","avg50List","avg100List","chartdata1","labels","datasets","borderColor","backgroundColor","borderWidth","fill","yAxisID","scales","yAxes","display","CPredictHistory","lastItem","t_toppredictavg$query","li","Headers","append","MiApiChannel","getHttpChannel","callFetch","put","delete","MiApi","pbody","proc","MiNet","miApi","miHost","baseURI","tagId","baseId","VHome","createElement","cAccount","cGroup","showStocksAll","showStocksBlock","stocksMyAll","stocksMyBlock","myAllCaption","myBlockCaption","renderAccounts","renderGroups","renderSpec","cCommon","actions","manageAccounts","manageGroups","VAccount","renderHolding","showHolding","showBuy","showSell","stockObj","miAccount","holdings","holdings0","showCashIn","showCashOut","showCashAdjust","holdingStocks","containerClass","showCashInit","dec","VForm","valueLabel","onCheckValue","disabled","onFormSubmit","holdingStock","beforeRender","onEnter","fieldLabelAlign","renderStock","VStock","VBuy","checkCash","VBuyNew","renderStockPick","createPickStockId","submitBuyNew","VBuyExist","submitBuy","VSell","submitSell","VCash","VCashInit","submitCashInit","VCashIn","submitCashIn","VCashOut","submitCashOut","VCashAdjust","submitCashAdjust","VAccounts","onClickAccount","showAccount","renderAccount","miAccounts","accounts","CAccount","miGroup","stocks","listCaption","showStock","stockId","buyNewHolding","buyHolding","sellHolding","cashInit","cashIn","cashOut","cashAdjust","yumi","pagePickId","loadStock","VGroups","group","groups","miGroups","showMiGroup","CGroup","openStocksList","setStocksList","onStockClick","VStockList","$order","CHome","loadMyBlock","am","bm","StockPageItems","firstSize","searchStock","VFind","showSetting","showA","showHK","showSH","showSZ","showAll","renderButton","onSearch","VSetting","changeSmooth","smooth","htmlFor","VStocksPage","pinStock","renderPinStock","openStock","pageStocks","onClickStock","CFind","searchOrder","loadSmooth","$orderSwitch","VBlockStock","isMyBlock","toggleBlock","VKeepStock","VPinStock","setStockToGroup","removeMyAll","toggleMyAll","VStockInGroup","setGroup","inGroup","buildInGroup","VStockLink","mn","CCommon","addStockToGroup","removeStockFromGroup","IDUI","hiden","mId","MidIXID","listHeader","itemHeader","addMyAll","gaps","CApp","cBug","cUI","cExporer","cWarning","timer","gapIndex","callTick","$poked","poke","Store","App","setSettings","VEdit","editHeader","cFormView","VView","midID","onItemEdit","V","new","midIDList","valueChanged","saveID","onItemView","onItemNew","setNO","createFormView","createMidIDList","cList","createCList","itemProps","update","MidIDList","listPageItems","MidIXIDList","_uiSchema","_props","Acts","buildGridProps","ActIX","UQsMan","uqMans","collection","buildTVs","uqDataArr","uqConfigs","retErrors","setTuidImportsLocal","uqConfig","owner","uqLower","_uqs","buildUQs","uqTVs","lj","uqsData","promiseInits","uqData","uqFullName","UqMan","lower","loadEntities","uqKey","getUqKey","createProxy","Proxy","receiver","showReload","tuidArr","isImport","setInner","tuidImport","fromName","iName","setFrom","loadUqs","tonvaAppName","uqsMan","UQsManApp","localData","uqAppData","loadAppUqs","buildUqs","getRoles","appUqs","HoldingStock","holdingId","setQuantity","CIXList","midIXList","MidIXList","MidIX","CIX","midIX","idList","CIXEdit","cIXList","onListRightClick","cSelect","idItem","ImageItemEdit","resId","onSaved","mobileRegex","emailRegex","itemObservable","loading","beforeLoad","loaded","allLoaded","topDiv","bottomDiv","isFirst","pageItemAction","itemConverter","scrollToTop","scrollToBottom","appendPosition","sortOrder","changing","computed","divId","getPageId","loadResults","pageList","reset","isAsc","endItem","scrollToEnd","pushItem","startId","pid","setLoaded","onLoad","setPageStart","onLoaded","reverse","digits","c0","c9","Z","NaN","handlerSeed","anyHandlers","msgHandlers","handler","seed","args0","handlerId","$type","useHash","root","_routes","_useHash","_hash","_paused","_destroyed","_lastRouteResolved","_notFoundHandler","_defaultHandler","_usePushState","_genericHooks","_historyUpdateMethod","timout","_onLocationChange","isPushStateAvailable","_cLoc","_listen","updatePageLinks","_getRoot","_historyUpdate","arg0","arg1","hooks","orderedRoutes","compareUrlDepth","uses","_add","reduce","current","GETParameters","extractGETParameters","onlyURL","getOnlyURL","already","matched","manageHooks","_callLeave","isHashedRoot","slice","_findLinks","link","hasListenerAttached","ctrlKey","metaKey","tagName","getLinkPath","preventDefault","status","pause","destroy","as","replaceState","cLocRoot","isHashChangeAPIAvailable","cached","check","cleanUrl","querySelectorAll","lastRouteResolved","leave","names","paramNames","regexp","PARAMETER_REGEXP","full","dots","REPLACE_VARIABLE_REGEXP","WILDCARD_REGEXP","REPLACE_WILDCARD","FOLLOWED_BY_SLASH_REGEXP","MATCH_REGEXP_FLAGS","urlA","urlB","getUrlDepth","routes","replaceDynamicURLParts","clean","regExpResultToParams","filter","findMatchedRoutes","colonExp","routeExp","fallbackURL","matched0","cleanGETParam","exHooks","shouldRoute","after","onBack","vBack","debugLogout","rightView","Tab","contentBuilder","_content","tabBg","sep","selectedTab","tabArr","tabClick","shown","bsCur","bsTab","tabPosition","borderStyle","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius","notifyCircle","displayNone","pageHeader","pageFooter","tabBack","ResUploader","fileInput","upload","buildFormData","onFilesChange","files","maxSize","FormData","file","multiple","formatSize","pointLength","units","shift","xlargeSize","mediumSize","ImageUploader","imgBaseSize","imageTypes","resUploader","desImgWidth","desImgHeight","desImgSize","srcImgWidth","srcImgHeight","enableUploadButton","srcImage","desImage","fileError","uploaded","onFileChange","pos","lastIndexOf","reader","FileReader","readAsDataURL","onload","setSize","compress","img","scale","canvas","ctx","getContext","anw","createAttribute","nodeValue","anh","setAttributeNode","drawImage","base64","toDataURL","blob","convertBase64UrlToBlob","showOrgImage","maxWidth","urlData","mime","bstr","atob","u8arr","Uint8Array","Blob","levelDiv","padding","fileSize","uploading","AudioUploader","audioTypes","createBoxId","enums","queries","ids","idxs","ixs","sheets","books","maps","histories","pendings","tags","tuidsCache","localEntities","localModifyMax","tuids","createBoxIdFromTVs","allRoles","actionArr","queryArr","idArr","idxArr","ixArr","enumArr","sheetArr","bookArr","mapArr","historyArr","pendingArr","tagArr","apiParam","tv","prototype","retArr","retActs","ActDetail","detail2","detail3","postParam","toScalars","IDNO","IDDetailGet","IDXToString","KeyID","IX1","IXr","KeyIX","IDLog","IDSum","IDxID","ID2","IDTree","TuidsCache","centerApi","sheet","access","buildTuids","buildAccess","newTuid","allSchemas","fromType","fromObj","defer","cacheTuids","enm","UqEnum","setEntity","TuidImport","TuidInner","book","Book","Map","History","pending","Pending","Sheet","lName","idEntity","idx","newID","newIDX","newIX","newAction","newQuery","newBook","newMap","newHistory","newSheet","newPending","newTag","newEnum","buildSheet","build","mainFields","buildTuidBox","ownerField","buildTuidDivBox","modifyMax","lk","states","ops","op","SaveCaller","SaveDirectCaller","flow","ActionDirectCaller","brief","unpackSheet","flows","GetSheetCaller","getArchive","unpack","SheetArchiveCaller","SheetArchivesCaller","StateSheetsCaller","PageStateItems","StateSheetCountCaller","UserSheetsCaller","MySheetsCaller","SheetCaller","resVerify","getStateSheets","queryApiName","BookQueryCaller","schemaFrom","actionSchema","querySchema","AddCaller","DelCaller","AllCaller","PageCaller","qc","QueryCaller","MapCaller","getCaller","MapAddCaller","add","MapDelCaller","MapAllCaller","MapPageCaller","MapQueryCaller","Achieve","UserStaff","VStockInfo","input","checkLimitShow","ttmLimit","checkShowLater","checkDefaultTag","onClickDefaultTag","baseItem","isLogined","onSelectTag","stockTags","headStr","head","baseInfo","dateHead","predictInfo","predictSeasonEarning","seasonEarning","capitalEarning","changeDay","dayString","renderStockLink","renderBlockStock","urlweek","urlmonth","predictData","ypredict","epre","lpre","chart1","er","numberToPrecision","showLine","pointStyle","pointRadius","per","lr","plr","chart2","predictChartFullInfo","chart3","predictChartROE","numberToString","predictSeasonDataFull","esum","SeasonnoToYearMonth","chartdataFull","esumorg","corg","predictSeasonData","eorg","percentToFixString","seasonData","capitalearning","StockGroups","defaultGroup","blackGroup","groupFromName","groupName","st","exists","t_tag$all","checkDefaultTags","r1","StockGroup","br","t_tag$save","groupId","yearlen","t_tagstock$add","t_tagstock$del","MiAccount","noneStocks","stockFromId","loadMyAll","saveHolding","hs","orgHs","holdingQuantity","bookHolding","recalc","accountValue","accountHolding","portfolio","transaction","sumMi","sumMarket","sumDivident","act","cashAct","MiGroup","stockCount","loadGroupStocks","VErrorsPage","errors","VStartError","onNavRoutes","afterBuiltUQs","resolveRoute","userFromId","userRoles","getUqUserRoles","setUqRoles","isRole","_cApp","wn","getWebNav","_owner","ownerWNs","own","radioStyle","TagView","nameFromId","namesFromIds","renderRadio","renderCheck","wrapClassName","inputs","inputName","onInputChange","coll","_view","lines","line","ext","firstName","lastName","VStockSelect","model","returnStock","searchByKey","allowEmptySearch","PageStockItems","q_stocks$page","buildFieldItem","$FieldItemType","fieldItemType","VLogout","onLogout","VLogin","onLogin","username","form","sender","getSender","tonvaTop","requiredFlag","privacyEntry","VChangePassword","orgPassword","newPassword","newPassword1","setError","userLogined","vPage","getVChangePassword","senders","regex","DropdownActions","menu","button","handleDocumentClick","dropdownOpen","contains","toggle","isRight","itemIconClass","itemCaptionClass","hasIcon","some","data-toggle","aria-expanded","captionClass","aria-hidden","onTouchStart","timeRes","md","ymd","yesterday","today","tomorrow","renderDate","vDate","withTime","always","nDate","_date","nowYear","hour","getHours","minute","appendTime","dPart","hm","EasyTime","SearchBox","initKey","inputSize","inputClassName","onFocus","buttonText","userCache","loader","UserView","noneImage","idProp","useUser","use","Ax","axProps","aClassName","naClassName","openSysPage","cacheTimer","loadIds","clearCacheTimer","cacheIds","tuidCached","innerPullModify","tuidLists","queueModify","queue","modify","modifyIds","importSelect","setIDUi","noFieldItem","Rule","RuleCustom","func","defy","RulePredefined","RuleRequired","RuleNum","minMsg","maxMsg","template","checkMore","RuleInt","Widget","fieldProps","_ui","contextErrors","isChanging","changeValue","container","inNode","FieldContainer","renderBody","hasError","getUiItem","buildRules","removeErrorWidget","addErrorWidget","initData","fromElement","allowChange","setDataValue","setElementValue","fieldClass","FieldClass","elDiscription","discriptionClassName","uiLabel","errorList","TextWidget","inputType","hasFocus","onKeyDown","internalOnKeyDown","keyCode","blur","onBlur","checkRules","checkContextRules","clearErrors","renderTemplet","renderErrors","TextAreaWidget","PasswordWidget","UrlWidget","EmailWidget","NumberWidget","UpdownWidget","returnValue","isValidKey","DateWidget","DateTimeWidget","TimeWidget","MonthWidget","CheckBoxWidget","trueValue","falseValue","SelectWidget","select","option","RadioWidget","isRow","RangeWidget","IdWidget","clearContextError","Unknown","dataType","uiType","dataTypes","ButtonWidget","observerRender","widgetType","ButtonClass","Context","subContexts","widgets","errorWidgets","arrRowContexts","itemName","getDisabled","setDisabled","getReadOnly","setReadOnly","getVisible","setVisible","buttonName","ew","checkFieldRules","rowContext","setContextError","clearWidgetsErrors","checkHasError","clearContextErrors","rowKeySeed","RowContext","parentContext","arrSchema","uiArr","itemSchemas","FormContext","ContextContainer","ArrComponent","selectable","deletable","restorable","getArrRowContexts","onDeleted","onRestored","arrLabel","ArrContainer","RowContainer","RowSeperator","formSelectable","formDeletable","formRestorable","arrSelectable","arrDeletable","arrRestorable","ac","rc","rs","typeofTemplet","factory","selectCheck","deleteIcon","$isSelected","$source","isDeleted","$isDeleted","editContainer","Provider","ImageWidget","imageSrc","TagWidget","stringWidget","widgetFactories","string","textarea","datetime","time","email","updown","checkbox","image","checkboxes","radio","tagSingle","valuesView","renderRadios","tagMulti","defaultArr","def","renderChecks","typeWidget","getItemSchema","getTypeWidget","widgetFactory","WidgetClass","Form","formContext","Container","watch","calcSelectOrDelete","DefaultContainer","DefaultFieldContainer","labelView","cnAlign","fieldCol","DefaultFieldClass","DefaultButtonClass","DefaultRes","autorun","initDataItem","arrItem","arrItems","arrDict","arrItemOperated","formArrVal","beforeShow","renderContent","contextType","StringItemEdit","verifyValue","onSave","inputOptions","element","RadioItemEdit","SelectItemEdit","IdItemEdit","TagItemEdit","renderInputs","TagSingleItemEdit","TagMultiItemEdit","TextAreaItemEdit","CheckBoxItemEdit","RangeItemEdit","NumberItemEdit","Edit","defaultSepClassName","defaultRowContainerClassName","topBorder","bottomBorder","rowContainerClassName","rowClick","itemEdit","editInRow","stopEdit","topBorderClassName","bottomBorderClassName","sepClassName","ie","createItemEdit","divLabel","requireFlag","MidIDXList","week","midIDX","renderStringProp","renderNumberProp","spanValues","VEditNumberField","dateInput","timeInput","onValueChange","valueAsDate","dateTicks","valueAsNumber","timeTicks","saveFieldValue","vDateTime","defDate","VHistory","historyItems","spans","graphOptions","maintainAspectRatio","currentIndex","timeSpan","prevTimeSpan","nextTimeSpan","toJS","curProp","moveStep","spanStep","canNext","borderBottomStyle","borderBottomColor","onFieldHistory","sv","onFieldClick","setTimeSpan","setCurrentField","historyPageItems","loadSum","next","historyLoader","midIDXList","create","sums","loadDayValues","getDayValues","loadFieldSum","exFields","$time","retSum","valueFields","typeArr","typeColl","buildTagTypes","tree","sub","VSelect","tagGroups","itemTags","midType","checks","tagGroup","renderType","onTagSelectChanged","CSelect","defaultRenderTags","renderTags","renderItemTags","itemTagsColl","acts","addTag","delTag","ItemTagsListPageItems","ret2","itemTagsList","tagItem","$xid","object","typeIndex","VTags","allTags","checkInputs","showID","MidTagIDList","cShowTagIDList","CShowTagIDList","details","CSheet","midSheet","serial","editDetail","detailFormUI","uiForm","hideField","cForm","save","VSheetEdit","onDetailClick","renderDetail","saveSheet","masterUI","cDialog","VRoles","onRoleAdmin","showRoleAdmin","onAccountant","onManager","roleItems","$","accountant","manager","renderRoleItem","VContent","VAddUser","newUser","VRoleAdmin","userRole","rightIcon","roleCaptions","ixOfUsers","vUser","restoreUser","deleteUser","vCap","onRoleChange","ixUserBind","VItem","VUserRoles","MeItem","meRoles","iRole","setUserRole","CRoleAdmin","myRolesChanged","roleCaptionMap","ixName","getIX","id2Name","getID","cIXEdit","getAllRoleUsers","allUserRoles","rolesBool","meId","ur","setUserRoles","fireMyRolesChanged","newRoles","roleNames","userFromKey","buildRolesText","deleteUserRoles","Accounts","MiAccounts","accountName","MiGroups","calcGroupStockCount","groupIXs","groupStock","userAllStock","addStock","removeStock","marketElements","myAllColl","markets","stockGroups","stockFind","saveConfig","selectType","selectTag","selectAccount","setCurrentAccount","shallow","buildStockValues","SearchStock","StockUsing","accountsFromIds","groupsFromIds","gs","gStockId","loadMarkets","loadGroupIXs","nGroup","t_usersettings$save","t_usersettings$query","cStr","group0","blackID","bMin","bMax","lMin","lMax","q_getlasttradeday","ListBase","Clickable","Static","Selectable","inputItems","buildItems","itemsArray","isItemSelected","compare","retItems","comp","selectItem","si","obItem","flex","marginBottom","listenArraySplice","isObservableArray","observe","change","removedCount","added","_added","checkAll","List","listBase","buildBase","prevProps","prevState","isEqual","forceUpdate","selectAll","unselectAll","waitingMore","tabIndex","isLoading","staticRow","PropRow","PropBorder","borderTop","PropGap","valueAlignStart","valueAlignCenter","valueAlignEnd","LabeledPropRow","gridProps","_prop","col","labelFixLeft","renderLabel","renderProp","align","vAlign","alignValue","renderPropBody","renderPropContent","StringPropRow","NumberPropRow","ListPropRow","borderBottom","ComponentPropRow","PropView","buildRows","isGap","setValues","PropGrid","propView","onClickSelectTag","onEditTag","renderTag","selectedTags","onNewTag","VNewTag","onSaveNewTag","VEditTag","onSaveTag","exrightForEarning","exrightInfo","_capitalearning","_bonus","_divideInfo","initLoad","q_stockallinfo","t_tagstock$query","arr1","arr3","barr","派息","loadTTMEarning","getSelected","retId","groupFromId","ni","seasonlist","minNo","seasonno","lastShares","shares","maxNo","sItem","es","yearmonth","GetSeasonnoYearMonth","ci","noBegin","endDay","SeasonnoToBeginEnd","exitem","factor","dayFrom","dayIndex","bsum","pricere","factore","SeasonnoFromDay","RestorePrice","IdCache","tuidLocal","localArr","waitingIds","tuidInner","initLocalArr","has","moveToHead","_id","useId","tuidValues","cacheIdValues","unpackTuidIds","cacheValue","cacheTuidFieldValues","loadTuidIdsOrLocal","localedValues","loadingIds","netIds","loadTuidIds","netRet","IdDivCache","divName","Tuid","noCache","typeName","idName","unique","TuidBox","id1","idValue","divs","cacheFields","idCache","tuidDiv","TuidDiv","resetCache","assureObj","IdsCaller","GetCaller","cacheFieldsInValue","arrValues","$create","$update","stampOnMain","unpackTuidIdsOfFields","SavePropCaller","searchArr","SearchCaller","LoadArrCaller","SaveArrCaller","ArrPosCaller","TuidNoCaller","TuidCaller","$id","transParams","arrParams","arrValue","buildDateParam","bid","hasDiv","loadMain","saveProp","loadArr","saveArr","posArr","TuidBoxDiv","buildTsUqFolder","uqsFolder","uqAlias","uqFolder","mkdirSync","tsUq","buildUQ","saveTsIndexAndRender","imports","sets","cName","tsUI","buildFields","tsFieldArr","buildFieldArr","replaceTsFileFields","tsImportFieldItemsBegin","tsImportFieldItemsEnd","replaceTsFileString","tsIndex","buildIDFields","buildIDXFields","buildIXFields","ts","buildIDFieldArr","buildIDXFieldArr","buildIXFieldArr","readFileSync","startStr","lBrace","rBrace","fieldsText","buildFieldsText","fieldItemReplaceProps","oldText","setFieldOldProp","buildFieldText","fieldStart","fieldText","eval","tsImport","appendArr","tsBuild","tsLen","uqEntityInterface","buildEnumInterface","buildTuidInterface","buildActionInterface","buildSheetInterface","buildQueryInterface","buildBookInterface","buildMapInterface","buildHistoryInterface","buildPendingInterface","buildTagInterface","buildIDInterface","buildIDXInterface","buildIDXActParamInterface","buildIXInterface","sName","buildActsInterface","uqBlock","buildTuid","buildAction","buildBook","buildQuery","buildMap","buildHistory","buildPending","buildTag","buildID","buildIDX","buildIX","buildInterface","entityCode","isInID","buildField","fieldTypeMap","sysFields","q","repeat","buildArrs","af","buildReturns","retName","schemaKeys","others","hasTrack","hasMemo","exField","track","memo","$owner","renderCustomer","saleAmount","deliver","onsite","offsite","break","sick","over","noTimeLog","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","StrictMode"],"mappings":"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","file":"static/js/main.a325b03d.chunk.js","sourcesContent":["export * from './tool';\r\nexport * from './net';\r\nexport * from './components';\r\nexport * from './auth';\r\nexport * from './uq';\r\nexport * from './app';\r\nexport * from './vm';\r\nexport * from './res';\r\nexport * from './ui';\r\n","\r\nconst zero = '00000000000000';\r\nexport function left0(num:number, fix:number) {\r\n    if (num === undefined) return '';\r\n    let r = num.toString();\r\n    let len = fix - r.length;\r\n    if (len <= 0) return r;\r\n    return zero.substr(0, len) + r;\r\n}\r\n","import { env } from './env';\r\n\r\nexport class LocalData {\r\n    user = env.localDb.child('user');\r\n    guest = env.localDb.child('guest');\r\n    unit = env.localDb.child('unit');\r\n\r\n    private _user:string;\r\n    private _guest:string;\r\n    private _unit:string;\r\n    readToMemory() {\r\n        this._user = this.user.get();\r\n        this._guest = this.guest.get();\r\n        this._unit = this.unit.get();\r\n    }\r\n    saveToLocalStorage() {\r\n        this.user.set(this._user);\r\n        this.guest.set(this._guest);\r\n        this.unit.set(this._unit);\r\n    }\r\n\r\n    logoutClear() {\r\n        [\r\n            this.user,\r\n            this.unit,\r\n        ].forEach(d => d.remove());\r\n    }\r\n}\r\n","export function getObjPropIgnoreCase(obj:any, prop:string):any {\r\n\tif (!obj) return;\r\n\tif (!prop) return;\r\n\tlet keys = Object.keys(obj);\r\n\tprop = prop.toLowerCase();\r\n\tfor (let key of keys) {\r\n\t\tif (key.toLowerCase() === prop) return obj[key];\r\n\t}\r\n\treturn;\r\n}\r\n","export function capitalCase(s:string):string {\r\n\tlet parts = s.split(/[-._]/);\r\n\treturn parts.map(v => firstCharUppercase(v)).join('');\r\n}\r\n\r\nexport function camelCase(s:string):string {\r\n\tlet parts = s.split(/[-._]/);\r\n\tlet len = parts.length;\r\n\tparts[0] = firstCharLowercase(parts[0]);\r\n\tfor (let i=1; i<len; i++) {\r\n\t\tparts[1] = firstCharUppercase(parts[1]);\r\n\t}\r\n\treturn parts.join('');\r\n}\r\n\r\nconst aCode = 'a'.charCodeAt(0);\r\nconst zCode = 'z'.charCodeAt(0);\r\nfunction firstCharUppercase(s:string) {\r\n\tif (!s) return '';\r\n\tlet c = s.charCodeAt(0);\r\n\tif (c >= aCode && c <= zCode) {\r\n\t\treturn String.fromCharCode(c - 0x20) + s.substr(1);\r\n\t}\r\n\treturn s;\r\n}\r\nconst ACode = 'A'.charCodeAt(0);\r\nconst ZCode = 'Z'.charCodeAt(0);\r\nfunction firstCharLowercase(s:string) {\r\n\tif (!s) return '';\r\n\tlet c = s.charCodeAt(0);\r\n\tif (c >= ACode && c <= ZCode) {\r\n\t\treturn String.fromCharCode(c + 0x20) + s.substr(1);\r\n\t}\r\n\treturn s;\r\n}\r\n","export * from './navigo';\r\nexport * from './nav';\r\nexport * from './page';\r\nexport * from './schema';\r\nexport * from './form';\r\nexport * from './edit';\r\nexport * from './loading';\r\nexport * from './image';\r\nexport * from './resUploader';\r\nexport * from '../tool/rules';\r\nexport * from './list';\r\nexport * from './dropDownActions';\r\nexport * from './easyDate';\r\nexport * from './propGrid';\r\nexport * from './simple';\r\nexport * from './media';\r\nexport * from './searchBox';\r\nexport * from './userIcon';\r\nexport * from './ax';\r\nexport * from './autoHideTips';\r\nexport * from './login';","import * as React from 'react';\r\n\r\nexport class GFunc {\r\n    public static numberToFixString(n: number, w = 2) {\r\n        return n === undefined ? '' : n.toFixed(w);\r\n    }\r\n    public static number(n: number, w = 2) {\r\n        return n === undefined ? '' : n.toFixed(w);\r\n    }\r\n\r\n    public static numberToMarketValue(n: number) {\r\n        return n === undefined || isNaN(n) ? '' : Math.round(n / 10000).toString(); // + '亿';\r\n    }\r\n\r\n    public static numberToString(n: number, precision = 2) {\r\n        return n === undefined ? '' : n.toPrecision(precision);\r\n    }\r\n\r\n    public static numberToPrecision(n: number, precision = 4) {\r\n        return n === undefined ? undefined : Number.parseFloat(n.toPrecision(precision));\r\n    }\r\n\r\n    public static percentToFixString(n: number) {\r\n        return n === undefined || isNaN(n) ? '' : (n * 100).toFixed(2) + '%';\r\n    }\r\n\r\n    public static percent0(n: number) {\r\n        return n === undefined || isNaN(n) ? '' : (n * 100).toFixed(0) + '%';\r\n    }\r\n    public static percent1(n: number) {\r\n        return n === undefined || isNaN(n) ? '' : (n * 100).toFixed(1) + '%';\r\n    }\r\n\r\n    public static warningTypeString(t: string) {\r\n        switch (t) {\r\n            case 'gt': return '大于';\r\n            case 'lt': return '小于';\r\n            default: return t;\r\n        }\r\n    }\r\n\r\n    public static predictCutRatio(r2: number) {\r\n        return r2 * 2 - r2 * r2;\r\n    }\r\n\r\n    public static evaluatePricePrice(iRate: number, e1: number, e2: number, e3: number) {\r\n        let r = 1 + iRate;\r\n        let r2 = r * r;\r\n        let r3 = r2 * r;\r\n        return (e1 / r + e2 / r2 + e3 / r3 + e3 / iRate / r3) / 2;\r\n    }\r\n\r\n    public static calculateV(z: number, divyield: number, pe: number) {\r\n        if (pe === undefined || isNaN(pe)) {\r\n            return undefined;\r\n        }\r\n\r\n        let r = 0;\r\n        if (z !== undefined) {\r\n            if (z > 0.25) {\r\n                z = 0.25;\r\n            }\r\n            r += z * 100;\r\n        }\r\n        if (divyield !== undefined) {\r\n            r += divyield * 100;\r\n        }\r\n        return r / pe;\r\n    }\r\n\r\n    public static calculateVN(z: number, e: number, bonus: number, price: number) {\r\n        if (price === undefined || isNaN(price) || e === undefined || isNaN(e)) {\r\n            return undefined;\r\n        }\r\n\r\n        let r = 0;\r\n        if (z !== undefined && e > 0) {\r\n            if (z > 0.25) {\r\n                z = 0.24 + Math.pow((z - 0.24) * 100, 0.6667) / 100;\r\n            }\r\n            z = 1 + z;\r\n            z = z * z * z - 1;\r\n            r += z * e * 100;\r\n        }\r\n        if (bonus !== undefined && !isNaN(bonus)) {\r\n            r += bonus * 100;\r\n        }\r\n        return r / price;\r\n    }\r\n\r\n    public static calculateVS(ev: number, bonus: number, price: number) {\r\n        if (price === undefined || isNaN(price)) {\r\n            return undefined;\r\n        }\r\n\r\n        if (ev === undefined || isNaN(ev)) {\r\n            if (bonus === undefined || isNaN(bonus)) {\r\n                return undefined;\r\n            }\r\n            else {\r\n                return bonus * 100 / price;\r\n            }\r\n        }\r\n        else {\r\n            if (bonus === undefined || isNaN(bonus)) {\r\n                return ev * 100 / price;\r\n            }\r\n            else {\r\n                return (bonus + ev) * 100 / price;\r\n            }\r\n        }\r\n    }\r\n\r\n    public static calculateZZ3(data: number[]) {\r\n        let ret: number[] = [undefined, undefined, undefined, undefined];\r\n        if (data === undefined)\r\n            return ret;\r\n        let len = data.length;\r\n        if (len < 5)\r\n            return ret;\r\n\r\n        let funcz = (n: number, p: number) => {\r\n            if (p <= 0 || n <= 0)\r\n                return undefined;\r\n            return ((n / p) - 1);\r\n        }\r\n        for (let i = 0; i < 4; ++i) {\r\n            ret[i] = funcz(data[i + 1], data[i]);\r\n        }\r\n        return ret;\r\n    }\r\n\r\n    public static caption = (value: string) => <span className=\"text-muted small\">{value}</span>;\r\n\r\n    public static MonthnoFromDay(day: number) {\r\n        let year = Math.floor(day / 10000);\r\n        let month = Math.floor((day % 10000) / 100) - 1;\r\n        return (year - 1995) * 12 + month;\r\n    }\r\n\r\n    public static SeasonnoFromDay(day: number) {\r\n        let year = Math.floor(day / 10000);\r\n        let month = Math.floor((day % 10000) / 100) - 1;\r\n        let season = Math.floor(month / 3);\r\n        return (year - 1995) * 4 + season;\r\n    }\r\n\r\n    public static SeasonnoFromYearMonth(year: number, month: number) {\r\n        let season = Math.floor((month - 1) / 3);\r\n        return (year - 1995) * 4 + season;\r\n    }\r\n\r\n    public static SeasonnoToYearMonth(no: number) {\r\n        let year = Math.floor(no / 4) + 1995;\r\n        let month = (Math.floor(no % 4) + 1) * 3;\r\n        return year * 100 + month;\r\n    }\r\n\r\n    public static GetSeasonnoYearMonth(no: number) {\r\n        let year = Math.floor(no / 4) + 1995;\r\n        let month = (Math.floor(no % 4) + 1) * 3;\r\n        return {year: year, month: month};\r\n    }\r\n\r\n    public static SeasonnoToBeginEnd(season: number) {\r\n        let year = (1995 + Math.floor(season / 4)) * 10000;\r\n        let s = season % 4;\r\n        if (s === 0) {\r\n            return { begin: year + 101, end: year + 331 };\r\n        }\r\n        else if (s === 1) {\r\n            return { begin: year + 401, end: year + 630 };\r\n        }\r\n        else if (s === 2) {\r\n            return { begin: year + 701, end: year + 930 };\r\n        }\r\n        return { begin: year + 1001, end: year + 1231 };\r\n    }\r\n\r\n    public static CalculateValueAvg(arr: { v: number }[]) {\r\n        let ret: { avg20: number, avg50: number, avg100: number, avg: number } = { avg20: undefined, avg50: undefined, avg100: undefined, avg: undefined };\r\n\r\n        let length = arr.length;\r\n        let calcuOne = (count: number): number => {\r\n            let endIndex = count;\r\n            if (count === 0 || endIndex > length)\r\n                endIndex = length;\r\n            if (endIndex >= 10) {\r\n                let sum = 0;\r\n                for (let i = 3; i < endIndex; ++i) {\r\n                    sum += arr[i].v;\r\n                }\r\n                return sum / (endIndex - 3);\r\n            }\r\n            else {\r\n                return undefined;\r\n            }\r\n        }\r\n\r\n        ret.avg20 = calcuOne(20);\r\n        ret.avg50 = calcuOne(50);\r\n        ret.avg100 = calcuOne(100);\r\n        ret.avg = calcuOne(0);\r\n        return ret;\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport {observable} from 'mobx';\r\nimport _ from 'lodash';\r\nimport {User, Guest/*, UserInNav*/} from '../tool/user';\r\nimport {Page} from './page/page';\r\nimport {netToken} from '../net/netToken';\r\nimport FetchErrorView, { SystemNotifyPage } from './fetchErrorView';\r\nimport {FetchError} from '../net/fetchError';\r\nimport {LocalData, env} from '../tool';\r\nimport {guestApi, logoutApis, setCenterUrl, setCenterToken, host, resUrlFromHost, messageHub} from '../net';\r\nimport { resOptions } from '../res/res';\r\nimport { Loading } from './loading';\r\nimport { Navigo, RouteFunc, Hooks, NamedRoute } from './navigo';\r\n\r\nimport 'font-awesome/css/font-awesome.min.css';\r\nimport '../css/va-form.css';\r\nimport '../css/va.css';\r\nimport '../css/animation.css';\r\nimport { FA } from './simple';\r\nimport { userApi } from '../net';\r\nimport { ReloadPage, ConfirmReloadPage } from './reloadPage';\r\nimport { PageWebNav } from './page';\r\nimport { createLogin, Login, showForget, showRegister } from './login';\r\n//import { createLogin } from '../auth/createLogin';\r\n\r\nconst regEx = new RegExp('Android|webOS|iPhone|iPad|' +\r\n    'BlackBerry|Windows Phone|'  +\r\n    'Opera Mini|IEMobile|Mobile' , \r\n    'i');\r\nconst isMobile = regEx.test(navigator.userAgent);\r\n\r\nlet logMark: number;\r\nconst logs:string[] = [];\r\nexport type NavPage = (params:any) => Promise<void>;\r\n\r\nexport interface Props\r\n{\r\n    onLogined: (isUserLogin?:boolean)=>Promise<void>;\r\n    notLogined?: ()=>Promise<void>;\r\n\tuserPassword?: () => Promise<{user:string; password:string}>;\r\n};\r\nlet stackKey = 1;\r\nexport interface StackItem {\r\n    key: number;\r\n    view: JSX.Element;\r\n    ceased: boolean;\r\n    confirmClose?: ()=>Promise<boolean>;\r\n    disposer?: ()=>void;\r\n}\r\nexport interface NavViewState {\r\n\tnotSupportedBrowser: boolean;\r\n    stack: StackItem[];\r\n    wait: 0|1|2;\r\n    fetchError: FetchError\r\n}\r\n\r\nconst notSupportedBrowsers = ['IE'];\r\n\r\nexport class NavView extends React.Component<Props, NavViewState> {\r\n    private stack: StackItem[];\r\n    private waitCount: number = 0;\r\n    private waitTimeHandler?: NodeJS.Timer;\r\n\r\n    constructor(props:Props) {\r\n        super(props);\r\n        this.stack = [];\r\n\t\tlet {browser} = env;\r\n\t\tlet notSupportedBrowser = notSupportedBrowsers.findIndex(v => v === browser) >= 0;\r\n        this.state = {\r\n\t\t\tnotSupportedBrowser,\r\n            stack: this.stack,\r\n            wait: 0,\r\n            fetchError: undefined\r\n        };\r\n        nav.set(this);\r\n    }\r\n    async componentDidMount()\r\n    {\r\n\t\tif (this.state.notSupportedBrowser === true) return;\r\n\t\twindow.addEventListener('popstate', this.navBack);\r\n\t\tawait nav.init();\r\n        await nav.start();\r\n    }\r\n\r\n    get level(): number {\r\n        return this.stack.length;\r\n    }\r\n\r\n    startWait() {\r\n        if (this.waitCount === 0) {\r\n            this.setState({wait: 1});\r\n            this.waitTimeHandler = env.setTimeout(\r\n                'NavView.startWait',\r\n                () => {\r\n                    this.waitTimeHandler = undefined;\r\n                    this.setState({wait: 2});\r\n                },\r\n                1000) as NodeJS.Timer;\r\n        }\r\n        ++this.waitCount;\r\n        this.setState({\r\n            fetchError: undefined,\r\n        });\r\n    }\r\n\r\n    endWait() {\r\n        env.setTimeout(\r\n            undefined, //'NavView.endWait',\r\n            () => {\r\n            /*\r\n            this.setState({\r\n                fetchError: undefined,\r\n            });*/\r\n            --this.waitCount;\r\n            if (this.waitCount === 0) {\r\n                if (this.waitTimeHandler !== undefined) {\r\n                    env.clearTimeout(this.waitTimeHandler);\r\n                    this.waitTimeHandler = undefined;\r\n                }\r\n                this.setState({wait: 0});\r\n            }\r\n        },100);\r\n    }\r\n\r\n    async onError(fetchError: FetchError)\r\n    {\r\n        let err = fetchError.error;\r\n        if (err !== undefined) {\r\n            if (err.unauthorized === true) {\r\n\t\t\t\tawait nav.showLogin(undefined);\r\n\t\t\t\t//nav.navigateToLogin();\r\n                return;\r\n            }\r\n            switch (err.type) {\r\n                case 'unauthorized':\r\n                    await nav.showLogin(undefined);\r\n\t\t\t\t\t//nav.navigateToLogin();\r\n                    return;\r\n                case 'sheet-processing':\r\n                    nav.push(<SystemNotifyPage message=\"单据正在处理中。请重新操作！\" />);\r\n                    return;\r\n            }\r\n        }\r\n        this.setState({\r\n            fetchError,\r\n        });\r\n    }\r\n\r\n    private upgradeUq = () => {\r\n        nav.start();\r\n    }\r\n\r\n    async showUpgradeUq(uq:string, version:number):Promise<void> {\r\n        this.show(<Page header={false}>\r\n            <div>\r\n                UQ升级了，请点击按钮升级 <br />\r\n                <small className=\"text-muted\">{uq} ver-{version}</small>\r\n                <button className=\"btn btn-primary\" onClick={this.upgradeUq}>升级</button>\r\n            </div>\r\n        </Page>)\r\n    }\r\n\r\n    show(view: JSX.Element, disposer?: ()=>void): number {\r\n        this.clear();\r\n        return this.push(view, disposer);\r\n    }\r\n\r\n    push(view: JSX.Element, disposer?: ()=>void): number {\r\n        this.removeCeased();\r\n        if (this.stack.length > 0) {\r\n            window.history.pushState('forward', null, null);\r\n        }\r\n        let key = stackKey++;\r\n        this.stack.push({\r\n            key: key,\r\n            view: view, \r\n            ceased: false,\r\n            disposer: disposer\r\n        });\r\n        this.refresh();\r\n        //console.log('push: %s pages', this.stack.length);\r\n        return key;\r\n    }\r\n\r\n    replace(view: JSX.Element, disposer?: ()=>void): number {\r\n        let item:StackItem = undefined;\r\n        let stack = this.stack;\r\n        if (stack.length > 0) {\r\n            item = stack.pop();\r\n            //this.popAndDispose();\r\n        }\r\n        let key = stackKey++;\r\n        this.stack.push({\r\n            key: key, \r\n            view: view, \r\n            ceased: false,\r\n            disposer: disposer\r\n        });\r\n        if (item !== undefined) this.dispose(item.disposer);\r\n        this.refresh();\r\n        //console.log('replace: %s pages', this.stack.length);\r\n        return key;\r\n    }\r\n\r\n    ceaseTop(level:number = 1) {\r\n        let p = this.stack.length - 1;\r\n        for (let i=0; i<level; i++, p--) {\r\n            if (p < 0) break;\r\n            let item = this.stack[p];\r\n            item.ceased = true;\r\n        }\r\n    }\r\n\r\n    pop(level:number = 1) {\r\n        let stack = this.stack;\r\n        let len = stack.length;\r\n        //console.log('pop start: %s pages level=%s', len, level);\r\n        if (level <= 0 || len <= 1) return;\r\n        if (len < level) level = len;\r\n        let backLevel = 0;\r\n        for (let i = 0; i < level; i++) {\r\n            if (stack.length === 0) break;\r\n            //stack.pop();\r\n            this.popAndDispose();\r\n            ++backLevel;\r\n        }\r\n        if (backLevel >= len) backLevel--;\r\n        this.refresh();\r\n        if (this.isHistoryBack !== true) {\r\n            //window.removeEventListener('popstate', this.navBack);\r\n            //window.history.back(backLevel);\r\n            //window.addEventListener('popstate', this.navBack);\r\n        }\r\n        //console.log('pop: %s pages', stack.length);\r\n    }\r\n\r\n    popTo(key: number) {\r\n        if (key === undefined) return;\r\n        if (this.stack.find(v => v.key === key) === undefined) return;\r\n        while (this.stack.length >0) {\r\n            let len = this.stack.length;\r\n            let top = this.stack[len-1];\r\n            if (top.key === key) break;\r\n            this.pop();\r\n        }\r\n    }\r\n\r\n    topKey():number {\r\n        let len = this.stack.length;\r\n        if (len === 0) return undefined;\r\n        return this.stack[len-1].key;\r\n    }\r\n\r\n    removeCeased() {\r\n        for (;;) {\r\n            let p=this.stack.length-1;\r\n            if (p < 0) break;\r\n            let top = this.stack[p];\r\n            if (top.ceased === false) break;\r\n            let item = this.stack.pop();\r\n            let {disposer} = item;\r\n            this.dispose(disposer);\r\n        }\r\n        this.refresh();\r\n    }\r\n\r\n    private popAndDispose() {\r\n        this.removeCeased();\r\n        let item = this.stack.pop();\r\n\t\tif (item === undefined) return;\r\n\t\t//if (nav.isRouting) {\r\n\t\t//\twindow.history.back();\r\n\t\t//}\r\n        let {disposer} = item;\r\n        this.dispose(disposer);\r\n        this.removeCeased();\r\n        return item;\r\n    }\r\n\r\n    private dispose(disposer:()=>void) {\r\n        if (disposer === undefined) return;\r\n        let item = this.stack.find(v => v.disposer === disposer);\r\n        if (item === undefined) disposer();\r\n    }\r\n\r\n    clear() {\r\n        let len = this.stack.length;\r\n        while (this.stack.length > 0) this.popAndDispose();\r\n        //this.refresh();\r\n        if (len > 1) {\r\n            //window.removeEventListener('popstate', this.navBack);\r\n            //window.history.back(len-1);\r\n            //window.addEventListener('popstate', this.navBack);\r\n        }\r\n    }\r\n\r\n    regConfirmClose(confirmClose:()=>Promise<boolean>) {\r\n        let stack = this.stack;\r\n        let len = stack.length;\r\n        if (len === 0) return;\r\n        let top = stack[len-1];\r\n        top.confirmClose = confirmClose;\r\n    }\r\n\r\n    private isHistoryBack:boolean = false;\r\n    navBack = () => {\r\n        //nav.log('backbutton pressed - nav level: ' + this.stack.length);\r\n        let tick = Date.now();\r\n        this.isHistoryBack = true;\r\n        this.back(true);\r\n        this.isHistoryBack = false;\r\n        console.log(`///\\\\\\\\ ${Date.now()-tick}ms backbutton pressed - nav level: ${this.stack.length}`);\r\n    }\r\n\r\n    back = async (confirm:boolean = true) => {\r\n        let stack = this.stack;\r\n        let len = stack.length;\r\n        if (len === 0) return;\r\n        if (len === 1) {\r\n            if (window.self !== window.top) {\r\n                window.top.postMessage({type:'pop-app'}, '*');\r\n            }\r\n            return;\r\n        }\r\n        let top = stack[len-1];\r\n        if (confirm===true && top.confirmClose) {\r\n            if (await top.confirmClose()===true) this.pop();\r\n        }\r\n        else {\r\n            this.pop();\r\n        }\r\n    }\r\n\r\n    confirmBox(message?:string): boolean {\r\n        return window.confirm(message);\r\n    }\r\n    clearError = () => {\r\n        this.setState({fetchError: undefined});\r\n    }\r\n    render() {\r\n        const {notSupportedBrowser, wait, fetchError} = this.state;\r\n\t\tif (notSupportedBrowser === true) {\r\n\t\t\treturn <div className=\"p-3 text-danger\">\r\n\t\t\t\t{env.browser} not supported !\r\n\t\t\t</div>;\r\n\t\t}\r\n        let {stack} = this.state;\r\n        let top = stack.length - 1;\r\n        let elWait = null, elError = null;\r\n        switch (wait) {\r\n            case 1:\r\n                elWait = <div className=\"va-wait va-wait1\">\r\n                </div>;\r\n                break;\r\n            case 2:\r\n                elWait = <div className=\"va-wait va-wait2\">\r\n                    <Loading />\r\n                </div>;\r\n                break;\r\n        }\r\n        if (fetchError) {\r\n            elError = <FetchErrorView clearError={this.clearError} {...fetchError} />;\r\n\t\t\t++top;\r\n\t\t}\r\n        let test = nav.testing===true && \r\n\t\t\t<span className=\"cursor-pointer position-fixed\" style={{top:0,left:'0.2rem',zIndex:90001}}>\r\n                <FA className=\"text-warning\" name=\"info-circle\" />\r\n\t\t\t</span>;\r\n        return <>\r\n\t\t\t{stack.map((item, index) => {\r\n\t\t\t\tlet {key, view} = item;\r\n\t\t\t\treturn <div key={key} style={index<top? {visibility: 'hidden', position: 'absolute'}:undefined}>\r\n\t\t\t\t\t{view}\r\n\t\t\t\t</div>\r\n\t\t\t})}\r\n\t\t\t{elWait}\r\n\t\t\t{elError}\r\n\t\t\t{test}\r\n\t\t</>;\r\n    }\r\n\r\n    private refresh() {\r\n        this.setState({stack: this.stack });\r\n    }\r\n}\r\n\r\nexport interface NavSettings {\r\n    oem?: string;\r\n    loginTop?: JSX.Element;\r\n    privacy?: string;\r\n\thtmlTitle?: string;\r\n}\r\n\r\nexport class Nav {\r\n    private navView:NavView;\r\n    //private ws: WsBase;\r\n\tprivate wsHost: string;\r\n    private local: LocalData = new LocalData();\r\n\tprivate navigo: Navigo;\r\n\t//isRouting: boolean = false;\r\n\tnavSettings: NavSettings;\r\n    @observable user: User/*InNav*/ = undefined;\r\n    testing: boolean;\r\n    language: string;\r\n    culture: string;\r\n    resUrl: string;\r\n\r\n    constructor() {\r\n        let {lang, district} = resOptions;\r\n        this.language = lang;\r\n        this.culture = district;\r\n\t\tthis.testing = false;\r\n    }\r\n\r\n    get guest(): number {\r\n        let guest = this.local.guest;\r\n        if (guest === undefined) return 0;\r\n        let g = guest.get();\r\n        if (g === undefined) return 0;\r\n        return g.guest;\r\n    }\r\n\r\n    set(navView:NavView) {\r\n        //this.logo = logo;\r\n        this.navView = navView;\r\n\t}\r\n\t/*\r\n    registerReceiveHandler(handler: (message:any)=>Promise<void>):number {\r\n        //if (this.ws === undefined) return;\r\n        return messageHub.onReceiveAny(handler);\r\n    }\r\n\r\n    unregisterReceiveHandler(handlerId:number) {\r\n        //if (this.ws === undefined) return;\r\n        if (handlerId === undefined) return;\r\n        messageHub.endReceive(handlerId);\r\n    }\r\n\t*/\r\n    async onReceive(msg:any) {\r\n        //if (this.ws === undefined) return;\r\n        await messageHub.dispatch(msg);\r\n    }\r\n\r\n\tprivate async loadUnitJson() {\r\n\t\ttry {\r\n\t\t\tlet unitJsonPath = this.unitJsonPath();\r\n\t\t\tlet unitRes = await fetch(unitJsonPath, {});\r\n\t\t\tlet res = await unitRes.json();\r\n\t\t\treturn res.unit;\r\n\t\t}\r\n\t\tcatch (err1) {\r\n\t\t\tthis.local.unit.remove();\r\n\t\t\treturn;\r\n\t\t}\r\n\t}\r\n\r\n    private async getPredefinedUnitName() {\t\t\r\n\t\tlet el = document.getElementById('unit');\r\n\t\tif (el) {\r\n\t\t\treturn el.innerText;\r\n\t\t}\r\n\t\tel = document.getElementById('unit.json');\r\n\t\tif (!el) {\r\n\t\t\treturn await this.loadUnitJson();\r\n\t\t}\r\n\t\ttry {\r\n            let json = el.innerHTML;\r\n            let res = JSON.parse(json);\r\n            return res.unit;\r\n        }\r\n        catch (err) {\r\n\t\t\treturn await this.loadUnitJson();\r\n        }\r\n    }\r\n\r\n    private async loadPredefinedUnit() {\r\n        let envUnit = process.env.REACT_APP_UNIT;\r\n        if (envUnit !== undefined) {\r\n            return Number(envUnit);\r\n        }\r\n        let unitName:string;\r\n        let unit = this.local.unit.get();\r\n        if (unit !== undefined) {\r\n            if (env.isDevelopment !== true) return unit.id;\r\n            unitName = await this.getPredefinedUnitName();\r\n            if (unitName === undefined) return;\r\n            if (unit.name === unitName) return unit.id;\r\n        }\r\n        else {\r\n            unitName = await this.getPredefinedUnitName();\r\n            if (unitName === undefined) return;\r\n        }\r\n        let unitId = await guestApi.unitFromName(unitName);\r\n        if (unitId !== undefined) {\r\n            this.local.unit.set({id: unitId, name: unitName});\r\n        }\r\n        return unitId;\r\n    }\r\n\r\n    setSettings(settings?: NavSettings) {\r\n        this.navSettings = settings;\r\n\t\tlet {htmlTitle} = settings;\r\n\t\tif (htmlTitle) {\r\n\t\t\tdocument.title = htmlTitle;\r\n\t\t}\r\n\t\tlet html = document.getElementsByTagName('html');\r\n\t\tlet html0 = html[0];\r\n\t\tif (html0) {\r\n\t\t\tlet version = html0?.getAttribute('data-version');\r\n\t\t\tif (version) {\r\n\t\t\t\t//appConfig.version = version;\r\n\t\t\t}\r\n\t\t}\t\t\r\n\t}\r\n\r\n    get oem():string {\r\n        return this.navSettings && this.navSettings.oem;\r\n    }\r\n\r\n    hashParam: string;\r\n    private centerHost: string;\r\n    private arrs = ['/test', '/test/'];\r\n    private unitJsonPath():string {\r\n        let {origin, pathname} = document.location;\r\n\t\tpathname = pathname.toLowerCase();\r\n        for (let item of this.arrs) {\r\n            if (pathname.endsWith(item) === true) {\r\n                pathname = pathname.substr(0, pathname.length - item.length);\r\n                break;\r\n            }\r\n        }\r\n        if (pathname.endsWith('/') === true || pathname.endsWith('\\\\') === true) {\r\n            pathname = pathname.substr(0, pathname.length-1);\r\n        }\r\n        return origin + pathname + '/unit.json';\r\n    }\r\n    private windowOnError = (event: Event | string, source?: string, lineno?: number, colno?: number, error?: Error) => {\r\n\t\tdebugger;\r\n        console.error('windowOnError');\r\n        console.error(error);\r\n    }\r\n    private windowOnUnhandledRejection = (ev: PromiseRejectionEvent) => {\r\n\t\tdebugger;\r\n        console.error('windowOnUnhandledRejection');\r\n        console.error(ev.reason);\r\n    }\r\n    private windowOnClick = (ev: MouseEvent) => {\r\n        console.error('windowOnClick');\r\n    }\r\n    private windowOnMouseMove = (ev: MouseEvent) => {\r\n        console.log('navigator.userAgent: ' + navigator.userAgent);\r\n        console.log('mouse move (%s, %s)', ev.x, ev.y);\r\n    }\r\n    private windowOnScroll = (ev: Event) => {\r\n        console.log('scroll event');\r\n\t}\r\n\r\n\tforceDevelopment:boolean;\r\n\t\r\n\tasync init() {\r\n\t\tthis.testing = env.testing;\r\n\t\tif (this.forceDevelopment === true) {\r\n\t\t\tenv.isDevelopment = true;\r\n\t\t}\r\n\t\tawait host.start(this.testing);\r\n\t\t/*\r\n\t\tlet hash = document.location.hash;\r\n\t\tif (hash !== undefined && hash.length > 0) {\r\n\t\t\tlet pos = getExHashPos();\r\n\t\t\tif (pos < 0) pos = undefined;\r\n\t\t\tthis.hashParam = hash.substring(1, pos);\r\n\t\t}\r\n\t\t*/\r\n\t\tlet {url, ws, resHost} = host;\r\n\t\tthis.centerHost = url;\r\n\t\tthis.resUrl = resUrlFromHost( resHost);\r\n\t\tthis.wsHost = ws;\r\n\t\tsetCenterUrl(url);\r\n\r\n\t\tlet guest:Guest = this.local.guest.get();\r\n\t\tif (guest === undefined) {\r\n\t\t\tguest = await guestApi.guest();\r\n\t\t}\r\n\t\tif (!guest) {\r\n\t\t\tdebugger;\r\n\t\t\tthrow Error('guest can not be undefined');\r\n\t\t}\r\n\t\tnav.setGuest(guest);\r\n\t}\r\n\r\n\treloadUser = () => {\r\n\t\tlet user: User = this.local.user.get();\r\n\t\tlet curUser = nav.user;\r\n\t\tconsole.log('window onfocus storage user', user, 'curUser', curUser);\r\n\t\tif (user === undefined && curUser === undefined) return;\r\n\t\tif (user && curUser && user.id === curUser.id) return;\r\n\t\tif (!user) nav.logout();\r\n\t\telse nav.logined(user)\r\n\t}\r\n\r\n    async start() {\r\n        try {\r\n\t\t\twindow.onerror = this.windowOnError;\r\n            window.onunhandledrejection = this.windowOnUnhandledRejection;\r\n\t\t\twindow.onfocus = this.reloadUser;\r\n            if (isMobile === true) {\r\n                document.onselectstart = function() {return false;}\r\n                document.oncontextmenu = function() {return false;}\r\n            }\r\n            //window.setInterval(()=>console.error('tick every 5 seconds'), 5000);\r\n\t\t\tnav.clear();\r\n\t\t\t//nav.onSysNavRoutes();\r\n\t\t\tthis.startWait();\r\n            \r\n            let user: User = this.local.user.get();\r\n            if (user === undefined) {\r\n                let {userPassword} = this.navView.props;\r\n\t\t\t\tif (userPassword) {\r\n\t\t\t\t\tlet ret = await userPassword();\r\n\t\t\t\t\tif (ret) {\r\n\t\t\t\t\t\tlet {user:userName, password} = ret;\r\n\t\t\t\t\t\tlet logindUser = await userApi.login({\r\n\t\t\t\t\t\t\tuser: userName,\r\n\t\t\t\t\t\t\tpwd: password,\r\n\t\t\t\t\t\t\tguest: nav.guest,\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tuser = logindUser;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (user === undefined) {\r\n\t\t\t\t\tlet {notLogined} = this.navView.props;\r\n\t\t\t\t\tif (notLogined !== undefined) {\r\n\t\t\t\t\t\tawait notLogined();\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tawait nav.showLogin(undefined);\r\n\t\t\t\t\t\t//nav.navigateToLogin();\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n            }\r\n\r\n            await nav.logined(user);\r\n        }\r\n        catch (err) {\r\n\t\t\tconsole.error(err);\r\n\t\t\tdebugger;\r\n        }\r\n        finally {\r\n            this.endWait();\r\n        }\r\n\t}\r\n\r\n\tresolveRoute() {\r\n\t\t//if (this.isRouting === false) return;\r\n\t\tif (this.navigo === undefined) return;\r\n\t\tthis.navigo.resolve();\r\n\t}\r\n\r\n\ton(routeFunc:RouteFunc, hooks?:Hooks):Navigo;\r\n\ton(url:string, routeFunc:RouteFunc, hooks?:Hooks):Navigo;\r\n\ton(regex:RegExp, routeFunc:RouteFunc, hooks?:Hooks):Navigo;\r\n\ton(options: {[url:string]: RouteFunc|NamedRoute}):Navigo;\r\n\ton(...args:any[]):Navigo {\r\n\t\tif (this.navigo === undefined) {\r\n\t\t\tthis.navigo = new Navigo();\r\n\t\t\tif (this.isWebNav !== true) this.navigo.historyAPIUpdateMethod('replaceState');\r\n\t\t}\r\n\t\treturn this.navigo.on(args[0], args[1], args[2]);\r\n\t}\r\n\r\n\tprivate navLogin:NavPage = async (params:any) => {\r\n\t\tnav.showLogin(async (user: User) => window.history.back(), false);\r\n\t}\r\n\r\n\tprivate navLogout:NavPage = async (params:any) => {\r\n\t\tnav.showLogout(async () => window.history.back());\r\n\t}\r\n\r\n\tprivate navRegister:NavPage = async (params:any) => {\r\n\t\tnav.showRegister();\r\n\t}\r\n\r\n\tprivate navForget:NavPage = async (params:any) => {\r\n\t\tnav.showForget();\r\n\t}\r\n\r\n\tnavigateToLogin() {\r\n\t\tnav.navigate('/login');\r\n\t}\r\n\r\n\topenSysPage(url: string):boolean {\r\n\t\tlet navPage: NavPage = this.sysRoutes[url];\r\n\t\tif (navPage === undefined) {\r\n\t\t\t//alert(url + ' is not defined in sysRoutes');\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tnavPage(undefined);\r\n\t\treturn true;\r\n\t}\r\n\r\n\tprivate navPageRoutes: {[url:string]: NavPage};\r\n\tprivate routeFromNavPage(navPage: NavPage) {\r\n\t\treturn (params: any, queryStr: any) => {\r\n\t\t\tif (navPage) {\r\n\t\t\t\tif (this.isWebNav) nav.clear();\r\n\t\t\t\tnavPage(params);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tonNavRoute(navPage: NavPage) {\r\n\t\tthis.on(this.routeFromNavPage(navPage));\r\n\t}\r\n\tprivate doneSysRoutes:boolean = false;\r\n\tprivate sysRoutes: { [route: string]: NavPage } = {\r\n\t\t'/login': this.navLogin,\r\n\t\t'/logout': this.navLogout,\r\n\t\t'/register': this.navRegister,\r\n\t\t'/forget': this.navForget,\r\n\t}\r\n\t/*\r\n\tonSysNavRoutes() {\r\n\t\tthis.onNavRoutes(this.sysRoutes);\r\n\t}\r\n\t*/\r\n\tonNavRoutes(navPageRoutes: {[url:string]: NavPage}) {\r\n\t\tif (this.doneSysRoutes === false) {\r\n\t\t\tthis.doneSysRoutes = true;\r\n\t\t\tthis.internalOnNavRoutes(this.sysRoutes);\r\n\t\t}\r\n\t\tthis.internalOnNavRoutes(navPageRoutes);\r\n\t}\r\n\r\n\tprivate internalOnNavRoutes(navPageRoutes: {[url:string]: NavPage}) {\r\n\t\tif (!navPageRoutes) return;\r\n\t\tthis.navPageRoutes = _.merge(this.navPageRoutes, navPageRoutes);\r\n\t\tlet navOns: { [route: string]: (params: any, queryStr: any) => void } = {};\r\n\t\tfor (let route in navPageRoutes) {\r\n\t\t\tlet navPage = navPageRoutes[route];\r\n\t\t\tnavOns[route] = this.routeFromNavPage(navPage);\r\n\t\t}\r\n\t\tthis.on(navOns);\r\n\t}\r\n\r\n\t/*\r\n\tget isWebNav():boolean { \r\n\t\tif (!this.navigo) return false;\r\n\t\treturn !isMobile;\r\n\t}\r\n\t*/\r\n\tisWebNav:boolean = false;\r\n\tbackIcon = <i className=\"fa fa-angle-left\" />;\r\n\tcloseIcon = <i className=\"fa fa-close\" />;\r\n\tsetIsWebNav() {\r\n\t\tthis.isWebNav = true;\r\n\t\tthis.backIcon = <i className=\"fa fa-arrow-left\" />;\r\n\t\tthis.closeIcon = <i className=\"fa fa-close\" />;\r\n\t}\r\n\r\n\tpageWebNav: PageWebNav;\r\n\r\n\tget isMobile():boolean {return isMobile;}\r\n\r\n\tnavigate(url:string, absolute?:boolean) {\r\n\t\tif (!this.navigo) {\r\n\t\t\talert('Is not in webnav state, cannot navigate to url \"' + url + '\"');\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (this.testing === true) {\r\n\t\t\turl += '#test';\r\n\t\t}\r\n\t\treturn this.navigo.navigate(url, absolute);\r\n\t}\r\n\r\n\tgo(showPage:()=>void, url:string, absolute?:boolean) {\r\n\t\tif (this.navigo !== undefined) {\r\n\t\t\tthis.navigate(url, absolute);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tshowPage();\r\n\t\t}\r\n\t}\r\n\r\n    async showAppView(isUserLogin?: boolean) {\r\n        let {onLogined} = this.navView.props;\r\n        if (onLogined === undefined) {\r\n            nav.push(<div>NavView has no prop onLogined</div>);\r\n            return;\r\n        }\r\n        nav.clear();\r\n        await onLogined(isUserLogin);\r\n    }\r\n\r\n    setGuest(guest: Guest) {\r\n        this.local.guest.set(guest);\r\n        netToken.set(0, guest.token);\r\n    }\r\n\r\n    saveLocalUser() {\r\n        this.local.user.set(this.user);\r\n    }\r\n\r\n\tsetUqRoles(uq:string, roles:string[]) {\r\n\t\tlet {roles:userRoles} = this.user;\r\n\t\tif (!userRoles) {\r\n\t\t\tthis.user.roles = {};\r\n\t\t}\r\n\t\tthis.user.roles[uq] = roles;\r\n\t\tthis.local.user.set(this.user);\r\n\t}\r\n\r\n    async loadMe() {\r\n        let me = await userApi.me();\r\n        this.user.icon = me.icon;\r\n        this.user.nick = me.nick;\r\n    }\r\n\r\n\tprivate async internalLogined(user: User, callback: (user:User)=>Promise<void>, isUserLogin:boolean) {\r\n        logoutApis();\r\n        console.log(\"logined: %s\", JSON.stringify(user));\r\n        this.user = user;\r\n        this.saveLocalUser();\r\n\t\tnetToken.set(user.id, user.token);\r\n\t\tnav.clear();\r\n\r\n        if (callback !== undefined) //this.loginCallbacks.has)\r\n            callback(user);\r\n            //this.loginCallbacks.call(user);\r\n        else if (this.isWebNav === true) {\r\n\t\t\tthis.navigate('/index');\r\n\t\t}\r\n\t\telse {\r\n            await this.showAppView(isUserLogin);\r\n        }\r\n\t\tawait this.onChangeLogin?.(this.user);\r\n\t}\r\n\r\n\tonChangeLogin: (user:User) => Promise<void>;\r\n\r\n\t// 缓冲登录\r\n    async logined(user: User, callback?: (user:User)=>Promise<void>) {\r\n\t\tawait this.internalLogined(user, callback, false);\r\n    }\r\n\r\n\t// 用户操作之后登录\r\n    async userLogined(user: User, callback?: (user:User)=>Promise<void>) {\r\n\t\tawait this.internalLogined(user, callback, true);\r\n    }\r\n\r\n    //wsConnect() {\r\n        //let ws:WSChannel = this.ws = new WSChannel(this.wsHost, this.user.token);\r\n        //ws.connect();\r\n    //}\r\n\r\n    loginTop(defaultTop:JSX.Element) {\r\n        return (this.navSettings && this.navSettings.loginTop) || defaultTop;\r\n    }\r\n\r\n    privacyEntry() {\r\n        if (!this.getPrivacyContent()) return;\r\n        return <div className=\"text-center\">\r\n            <button className=\"btn btn-sm btn-link\"\r\n                onClick={this.showPrivacyPage}>\r\n                <small className=\"text-muted\">隐私政策</small>\r\n            </button>\r\n        </div>;\r\n    }\r\n\r\n    private getPrivacyContent():string {\r\n        if (!this.navSettings) return;\r\n        let {privacy} = this.navSettings;\r\n        return privacy;\r\n    }\r\n\r\n    showPrivacyPage = () => {\r\n        let privacy = this.getPrivacyContent();\r\n        if (privacy) {\r\n            this.privacyPage(privacy);\r\n        }\r\n        else {\r\n            nav.push(<Page header=\"隐私政策\">\r\n                <div className=\"p-3\">AppConfig 中没有定义 privacy。可以定义为字符串，或者url。markdown格式</div>\r\n            </Page>);\r\n        }\r\n    }\r\n\r\n    private privacyPage = async (htmlString: string) => {\r\n        //let html = await this.getPrivacy(privacy);\r\n\t\t//let content = {__html: marked(html)};\r\n\t\tlet content = {__html: htmlString};\r\n        nav.push(<Page header=\"隐私政策\">\r\n            <div className=\"p-3\" dangerouslySetInnerHTML={content} />\r\n        </Page>);\r\n    }\r\n\r\n\tprivate createLogin = createLogin;\r\n\tsetCreateLogin(createLogin: ()=>Promise<Login>) {\r\n\t\tthis.createLogin = createLogin;\r\n\t}\r\n\r\n\tprivate login: Login;\r\n\tprivate async getLogin():Promise<Login> {\r\n\t\tif (this.login) return this.login;\r\n\t\treturn this.login = await this.createLogin();\r\n\t}\r\n\tasync showLogin(callback?: (user:User)=>Promise<void>, withBack?:boolean) {\r\n\t\tlet login = await this.getLogin();\r\n\t\tlogin.showLogin(callback, withBack);\r\n    }\r\n\r\n    async showLogout(callback?: ()=>Promise<void>) {\r\n\t\tlet login = await this.getLogin();\r\n\t\tlogin.showLogout(callback);\r\n\t}\r\n\t\r\n\tasync showRegister() {\r\n\t\tshowRegister();\r\n\t}\r\n\r\n\tasync showForget() {\r\n\t\tshowForget();\r\n\t}\r\n\r\n    async logout(callback?:()=>Promise<void>) { //notShowLogin?:boolean) {\r\n        //appInFrame.unit = undefined;\r\n        this.local.logoutClear();\r\n        this.user = undefined; //{} as User;\r\n        logoutApis();\r\n        let guest = this.local.guest.get();\r\n        setCenterToken(0, guest && guest.token);\r\n\t\t//this.ws = undefined;\r\n\t\tthis.clear();\r\n        if (callback === undefined)\r\n            await nav.start();\r\n        else\r\n            await callback();\r\n\t\tthis.onChangeLogin?.(undefined);\r\n\t}\r\n\r\n    async changePassword() {\r\n\t\tlet login = await this.getLogin();\r\n\t\tlogin.showChangePassword();\r\n    }\r\n\r\n    get level(): number {\r\n        return this.navView.level;\r\n    }\r\n    startWait() {\r\n        this.navView?.startWait();\r\n    }\r\n    endWait() {\r\n        this.navView?.endWait();\r\n    }\r\n    async onError(error: FetchError) {\r\n        await this.navView.onError(error);\r\n    }\r\n    async showUpgradeUq(uq:string, version:number):Promise<void> {\r\n        await this.navView.showUpgradeUq(uq, version);\r\n    }\r\n\r\n    show (view: JSX.Element, disposer?: ()=>void): void {\r\n        this.navView.show(view, disposer);\r\n    }\r\n    push(view: JSX.Element, disposer?: ()=>void): void {\r\n        this.navView.push(view, disposer);\r\n    }\r\n    replace(view: JSX.Element, disposer?: ()=>void): void {\r\n        this.navView.replace(view, disposer);\r\n    }\r\n    pop(level:number = 1) {\r\n        this.navView.pop(level);\r\n    }\r\n    topKey():number {\r\n        return this.navView.topKey();\r\n    }\r\n    popTo(key:number) {\r\n        this.navView.popTo(key);\r\n    }\r\n    clear() {\r\n        this.navView?.clear();\r\n    }\r\n    navBack() {\r\n        this.navView.navBack();\r\n    }\r\n    ceaseTop(level?:number) {\r\n        this.navView.ceaseTop(level);\r\n    }\r\n    removeCeased() {\r\n        this.navView.removeCeased();\r\n    }\r\n    async back(confirm:boolean = true) {\r\n        await this.navView.back(confirm);\r\n    }\r\n    regConfirmClose(confirmClose: ()=>Promise<boolean>) {\r\n        this.navView.regConfirmClose(confirmClose);\r\n    }\r\n    confirmBox(message?:string): boolean {\r\n        return this.navView.confirmBox(message);\r\n\t}\r\n\t/*\r\n    async navToApp(url: string, unitId: number, apiId?:number, sheetType?:number, sheetId?:number):Promise<void> {\r\n        return new Promise<void>((resolve, reject) => {\r\n            let sheet = this.centerHost.includes('http://localhost:') === true? 'sheet_debug':'sheet'\r\n            let uh = sheetId === undefined?\r\n                    appUrl(url, unitId) :\r\n                    appUrl(url, unitId, sheet, [apiId, sheetType, sheetId]);\r\n            console.log('navToApp: %s', JSON.stringify(uh));\r\n            nav.push(<article className='app-container'>\r\n                <span id={uh.hash} onClick={()=>this.back()}/>\r\n                    <i className=\"fa fa-arrow-left\" />\r\n                </span>\r\n                {\r\n                    // eslint-disable-next-line \r\n                    <iframe src={uh.url} title={String(sheetId)} />\r\n                }\r\n            </article>, \r\n            ()=> {\r\n                resolve();\r\n            });\r\n        });\r\n    }\r\n\r\n    navToSite(url: string) {\r\n        // show in new window\r\n        window.open(url);\r\n\t}\r\n\t*/\r\n\r\n    get logs() {return logs};\r\n    log(msg:string) {\r\n        logs.push(msg);\r\n    }\r\n    logMark() {\r\n        let date = new Date();\r\n        logMark = date.getTime();\r\n        logs.push('log-mark: ' + date.toTimeString());\r\n    }\r\n    logStep(step:string) {\r\n        logs.push(step + ': ' + (new Date().getTime() - logMark));\r\n    }\r\n\r\n    showReloadPage(msg: string) {\r\n        let seconds = -1;\r\n\t\tthis.push(<ReloadPage message={msg} seconds={seconds} />);\r\n\t\t/*\r\n\t\tif (seconds > 0) {\r\n\t\t\tenv.setTimeout(undefined, this.reload, seconds*1000);\r\n\t\t}\r\n\t\t*/\r\n    }\r\n\r\n    reload = async () => {\r\n        let waiting:Promise<void> = new Promise<void>((resolve, reject) => {\r\n            setTimeout(resolve, 100);\r\n        });\r\n\r\n        if ('serviceWorker' in navigator) {\r\n            let registration =await Promise.race([waiting, navigator.serviceWorker.ready]);\r\n            if (registration) registration.unregister();\r\n        }\r\n\t\twindow.document.location.reload();\r\n\t\t// dcloud hbuilder里面的app自动升级，需要清webview的缓存\r\n\t\tlet plus = (window as any).plus;\r\n\t\tif (plus) {\r\n\t\t\tlet webview = plus.webview;\r\n\t\t\tif (webview) {\r\n\t\t\t\tif (webview.reload) webview.reload(true);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tlet webView = plus.webView;\r\n\t\t\t\tif (webView) {\r\n\t\t\t\t\tif (webView.reload) webView.reload(true);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t//plus.webview.reload(true)\r\n\t\t}\r\n    }\r\n\r\n    resetAll = () => {\r\n        this.push(<ConfirmReloadPage confirm={(ok:boolean):Promise<void> => {\r\n            if (ok === true) {\r\n                this.showReloadPage('彻底升级');\r\n\t\t\t\tlocalStorage.clear();\r\n\t\t\t\t/*\r\n                this.local.readToMemory();\r\n                env.localDb.removeAll();\r\n\t\t\t\tthis.local.saveToLocalStorage();\r\n\t\t\t\t*/\r\n            }\r\n            else {\r\n                this.pop();\r\n            }\r\n            return;\r\n        }} />);\r\n    }\r\n\r\n    async checkVersion():Promise<string> {\r\n        let {href} = document.location;\r\n        href += (href.indexOf('?')>=0? '&':'?') + '_t_t_=' + new Date().getTime();\r\n        let ret = await fetch(href);\r\n        let r = await ret.text();\r\n        let parser = new DOMParser();\r\n        let htmlDoc = parser.parseFromString(r, 'text/html');\r\n        let elHtml = htmlDoc.getElementsByTagName('html');\r\n        let newVersion = elHtml[0].getAttribute('data-version');\r\n        return newVersion;\r\n    }\r\n}\r\nexport const nav: Nav = new Nav();\r\n\r\nexport class TonvaView extends NavView {\r\n\r\n}\r\n","\r\nimport {setCenterToken} from './uqApi';\r\nimport {WSChannel} from './wsChannel';\r\n\r\nexport const netToken = {\r\n    set(userId:number, token:string) {\r\n        setCenterToken(userId, token);\r\n        WSChannel.setCenterToken(token);\r\n    },\r\n    clear() {\r\n        setCenterToken(0, undefined);\r\n        WSChannel.setCenterToken(undefined);\r\n    }\r\n};\r\n","import * as React from 'react';\r\nimport {FetchError} from '../net/fetchError';\r\nimport { refetchApi } from '../net';\r\nimport { Page } from './page/page';\r\n\r\nexport interface FetchErrorProps extends FetchError {\r\n    clearError: ()=>void\r\n}\r\n\r\nexport default class FetchErrorView extends React.Component<FetchErrorProps, null> {\r\n    private reApi = async () => {\r\n        this.props.clearError();\r\n        const {channel, url, options, resolve, reject} = this.props;\r\n        await refetchApi(channel, url, options, resolve, reject);\r\n    }\r\n    private close = async () => {\r\n        this.props.clearError();\r\n    }\r\n    render() {\r\n        let {error, url} = this.props;\r\n        let errContent:any;\r\n        if (typeof error === 'object') {\r\n            let err = [];\r\n            for (let i in error) {\r\n                err.push(<li key={i}><label>{i}</label><div style={{wordWrap:\"break-word\"}}>{error[i]}</div></li>);\r\n            }\r\n            errContent = <ul>{err}</ul>;\r\n        }\r\n        else {\r\n            errContent = <div>{error}</div>;\r\n        }\r\n        return <div className=\"tv-page\">\r\n            <article>\r\n\t\t\t\t<main className=\"va-error p-3\">\r\n\t\t\t\t\t<div>网络出现问题</div>\r\n\t\t\t\t\t<div>点击重新访问</div>\r\n\t\t\t\t\t<div style={{wordWrap:\"break-word\"}}>url: {url}</div>\r\n\t\t\t\t\t{errContent}\r\n\t\t\t\t\t<div className=\"p-3 text-center\">\r\n\t\t\t\t\t<button className=\"btn btn-primary mr-3\" type='button' onClick={this.close}>关闭</button>\r\n\t\t\t\t\t\t<button className=\"btn btn-outline-primary\" type='button' onClick={this.reApi}>重试</button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</main>\r\n            </article>\r\n        </div>;\r\n    }\r\n}\r\n\r\nexport const SystemNotifyPage = ({message}:{message:string}):JSX.Element => {\r\n    return <Page header=\"系统提醒\">\r\n        <div className=\"px-3\">{message}</div>\r\n    </Page>;\r\n}","import * as React from 'react';\r\nimport { nav } from './nav';\r\nimport { Page } from './page/page';\r\n\r\ninterface Props {\r\n    message: string,\r\n    seconds: number\r\n}\r\n\r\ninterface State {\r\n    seconds: number\r\n}\r\n\r\nexport class ReloadPage extends React.Component<Props, State> {\r\n    private timerHandler:any;\r\n    constructor(props:Props) {\r\n\t\tsuper(props);\r\n\t\tlet {seconds} = props;\r\n\t\tif (seconds===undefined) return;\r\n        this.state = {seconds};\r\n\t\tif (seconds <= 0) return;\r\n        this.timerHandler = setInterval(() => {\r\n\t\t\tlet {seconds} = this.state;\r\n            seconds--;\r\n            if (seconds <= 0) {\r\n                this.reload();\r\n            }\r\n            else {\r\n                this.setState({seconds: seconds});\r\n            }\r\n        }, 1000);\r\n    }\r\n    private reload = () => {\r\n        clearInterval(this.timerHandler);\r\n        nav.reload();\r\n    }\r\n    render() {\r\n\t\tlet {seconds} = this.state;\r\n\t\tlet title:string, msg:string;\t\t\r\n\t\tif (seconds > 0) {\r\n\t\t\ttitle = '程序升级中...';\r\n\t\t\tmsg = this.state.seconds + '秒钟之后自动重启动';\r\n\t\t}\r\n\t\telse {\r\n\t\t\ttitle = '程序需要升级';\r\n\t\t\tmsg = '请点击下面按钮重启';\r\n\t\t}\r\n        return <Page header={false}>\r\n            <div className=\"text-center p-5\">\r\n                <div className=\"text-info py-5\">\r\n\t\t\t\t\t<span className=\"text-danger\">{title}</span>\r\n\t\t\t\t\t<br/>\r\n\t\t\t\t\t{msg}\r\n                    <br/>\r\n                    <span className=\"small text-muted\">{this.props.message}</span>\r\n                </div>\r\n                <button className=\"btn btn-danger\" onClick={this.reload}>立刻重启</button>\r\n            </div>\r\n        </Page>;\r\n    }\r\n}\r\n\r\ninterface ConfirmReloadPageProps {\r\n    confirm: (ok: boolean)=>Promise<void>;\r\n}\r\nexport const ConfirmReloadPage = (props: ConfirmReloadPageProps):JSX.Element => {\r\n    return <Page header=\"升级软件\" back=\"close\">\r\n        <div className=\"py-5 px-3 my-5 mx-2 border bg-white rounded\">\r\n            <div className=\"text-center text-info\">\r\n                升级将清除所有本机缓冲区内容，并从服务器重新安装程序！\r\n            </div>\r\n            <div className=\"text-center mt-5\">\r\n                <button className=\"btn btn-danger mr-3\" onClick={()=>props.confirm(true)}>确认升级</button>\r\n            </div>\r\n        </div>\r\n    </Page>;\r\n    // <button className=\"btn btn-outline-danger\" onClick={()=>props.confirm(false)}>暂不</button>\r\n}\r\n","import fs from 'fs';\r\nimport { capitalCase } from \"../../tool\";\r\nimport { UqMan } from \"../uqMan\";\r\nimport { BuildContext } from './context';\r\n\r\nexport const red = '\\x1b[41m%s\\x1b[0m';\r\nexport let lastBuildTime:number = 0;\r\n//export const uqTsSrcPath = 'src/UqApp';\r\n\r\nexport function saveSrcTsFileIfNotExists(context:BuildContext, fileName:string, suffix:string, content:string) {\r\n\tlet tsFilePath = `${context.uqTsSrcPath}/${fileName}.${suffix}`;\r\n\tsaveTsFileIfNotExists(tsFilePath, content);\r\n\t//if (fs.existsSync(tsFile) === true) return;\r\n\t//saveTsFile(fileName, content, suffix);\r\n}\r\nexport function saveTsFile(context:BuildContext, fileName:string, content:string, suffix:string = 'ts') {\r\n\tlet {uqTsSrcPath} = context;\r\n\tlet srcFile = `${uqTsSrcPath}/${fileName}.${suffix}.txt`;\r\n\tlet tsFile = `${uqTsSrcPath}/${fileName}.${suffix}`;\r\n\tif (!fs.existsSync(srcFile)) {\r\n\t\tif (fs.existsSync(tsFile)) {\r\n\t\t\tfs.renameSync(tsFile, srcFile);\r\n\t\t}\r\n\t}\r\n\tfs.writeFileSync(tsFile, content);\r\n\tlastBuildTime = Date.now();\r\n\tconsole.log(red, `${tsFile} is built`);\r\n}\r\nexport function overrideTsFile(path:string, content:string) {\r\n\t//let tsFile = `${path}/${fileName}.${suffix}`;\r\n\tfs.writeFileSync(path, content);\r\n\tlastBuildTime = Date.now();\r\n\tconsole.log(red, `${path} is built`);\r\n}\r\n//fileName:string, \r\n//, suffix:string = 'ts'\r\nexport function saveTsFileIfNotExists(tsFilePath:string, content:string) {\r\n\t//let tsFilePath = `${path}/${fileName}.${suffix}`;\r\n\tif (fs.existsSync(tsFilePath) === true) return;\r\n\toverrideTsFile(tsFilePath, content);\r\n}\r\n\r\n/*\r\nfunction createTsFile(path:string, fileName:string, content:string, suffix:string = 'ts') {\r\n\tlet tsFile = `${path}/${fileName}.${suffix}`;\r\n\tif (fs.existsSync(tsFile) === true) return;\r\n\tfs.writeFileSync(tsFile, content);\r\n\tlastBuildTime = Date.now();\r\n\tconsole.log(red, `${tsFile} is built`);\r\n}\r\n*/\r\nexport function buildTsHeader() {\r\n\treturn `//=== UqApp builder created on ${new Date()} ===//`;\r\n}\r\n\r\nexport function entityName(s:string):string {\r\n\treturn capitalCase(s);\r\n}\r\n\r\nexport function getNameFromUq(uqMan:UqMan):{devName:string; uqName:string} {\r\n\tlet {config} = uqMan;\r\n\tlet devPart:string, uqPart:string;\r\n\tif (config) {\r\n\t\tlet {dev, name, alias} = config;\r\n\t\tlet {name:devName, alias:devAlias} = dev;\r\n\t\tdevPart = devAlias || devName;\r\n\t\tuqPart = alias || name;\r\n\t}\r\n\telse {\r\n\t\tlet {uqOwner, uqName} = uqMan;\r\n\t\tdevPart = uqOwner;\r\n\t\tuqPart = uqName;\r\n\t}\r\n\treturn {\r\n\t\tdevName: capitalCase(devPart),\r\n\t\tuqName: capitalCase(uqPart),\r\n\t};\r\n}\r\n","import { decodeGuestToken } from '../tool/user';\r\nimport { CenterApiBase } from './uqApi';\r\n\r\nexport class GuestApi extends CenterApiBase {\r\n    async guest(): Promise<any> {\r\n        //let guest = nav.local.guest.get();\r\n        let ret = await this.get('', {});\r\n        switch (typeof ret) {\r\n            default: return;\r\n            case 'string': return decodeGuestToken(ret);\r\n            case 'object':\r\n                let guest = decodeGuestToken(ret.token);\r\n                return guest;\r\n        }\r\n    }\r\n\r\n    async unitFromName(unitName:string): Promise<number> {\r\n        let ret = await this.get(unitName);\r\n        return ret && ret.unit;\r\n    }\r\n}\r\n\r\nexport const guestApi = new GuestApi('tv/guest/', undefined);\r\n","export abstract class Caller<T> {\r\n    protected readonly _params: T;\r\n    constructor(params: T, waiting: boolean) {\r\n        this._params = params;\r\n        this.waiting = waiting;\r\n    }\r\n    protected get params():any {return this._params;}\r\n    buildParams():any {return this.params;}\r\n    method: string  = 'POST';\r\n    abstract get path(): string;\r\n    get headers(): {[header:string]: string} {return undefined}\r\n    waiting: boolean;\r\n}\r\n","import * as React from 'react';\r\nimport {observer} from 'mobx-react';\r\nimport {PageHeaderProps, renderPageHeader} from './pageHeader';\r\nimport { TabsProps, TabsView } from './tabs';\r\nimport { ScrollProps, ScrollView, PageWebNav, WebNavScrollView } from './scrollView';\r\nimport { nav } from '../nav';\r\n\r\nexport interface IVPage {\r\n\tcontent():JSX.Element;\r\n\theader():JSX.Element|string;\r\n\tfooter():JSX.Element;\r\n}\r\n\r\nexport interface PageProps extends ScrollProps {\r\n    back?: 'close' | 'back' | 'none';\r\n    header?: boolean | string | JSX.Element;\r\n    right?: JSX.Element;\r\n    footer?: JSX.Element;\r\n    logout?: boolean | (()=>Promise<void>);\r\n\theaderClassName?: string;\r\n\tclassName?: string;\r\n\tafterBack?: () => void;\r\n\ttabsProps?: TabsProps;\r\n\twebNav?: PageWebNav;\r\n}\r\n\r\n@observer\r\nexport class Page extends React.Component<PageProps> {\r\n\tprivate tabsView: TabsView;\r\n    constructor(props: PageProps) {\r\n\t\tsuper(props);\r\n\t\tlet {tabsProps} = props;\r\n\t\tif (tabsProps) {\r\n\t\t\tthis.tabsView = new TabsView(tabsProps);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate renderHeader(webNav?: PageWebNav) {\r\n\t\tconst {back, header, right, headerClassName, afterBack, logout} = this.props;\r\n\t\tif (header === false) return;\r\n\t\t//const {webNav} = this.props;\r\n\t\tlet inWebNav = false;\r\n\t\tlet pageHeaderProps:PageHeaderProps = {\r\n\t\t\tback,\r\n\t\t\tcenter: header as any,\r\n\t\t\tright,\r\n\t\t\tlogout,\r\n\t\t\tclassName: headerClassName,\r\n\t\t\tafterBack,\r\n\t\t};\r\n\t\tif (webNav !== undefined) {\r\n\t\t\tinWebNav = true;\r\n\t\t\tlet {renderPageHeader: rph} = webNav;\r\n\t\t\tif (rph) return rph(pageHeaderProps);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tinWebNav = false;\r\n\t\t}\r\n\t\treturn renderPageHeader(pageHeaderProps, inWebNav);\r\n\t\t/*\r\n\t\tlet pageHeader = header !== false && <PageHeader \r\n\t\t\tback={back} \r\n\t\t\tcenter={header as any}\r\n\t\t\tright={right}\r\n\t\t\tlogout={this.props.logout}\r\n\t\t\tclassName={headerClassName}\r\n\t\t\tafterBack={afterBack}\r\n\t\t\t/>;\r\n\t\treturn pageHeader;\r\n\t\t*/\r\n\t}\r\n\r\n\tprivate renderFooter(webNav?: PageWebNav) {\r\n\t\tconst {footer} = this.props;\r\n\t\tif (!footer) return;\r\n\t\tlet elFooter = <footer>{footer}</footer>;\r\n\t\tif (webNav) return elFooter;\r\n\t\treturn <>\r\n\t\t\t<section className=\"tv-page-footer\">{elFooter}</section>\r\n\t\t\t{elFooter}\r\n\t\t</>;\r\n\t}\r\n\r\n\tcomponentDidCatch(error: Error, errorInfo: React.ErrorInfo) {\r\n\t\t// You can also log the error to an error reporting service\r\n\t\t//logErrorToMyService(error, errorInfo);\r\n\t\tdebugger;\r\n\t}\r\n\t\r\n    render() {\r\n\t\tif (this.tabsView) {\r\n\t\t\treturn React.createElement(this.tabsView.content);\r\n\t\t}\r\n\t\tconst {onScroll, onScrollTop, onScrollBottom, children, className, webNav} = this.props;\r\n\t\tlet pageWebNav:PageWebNav;\r\n\t\tif (!webNav) {\r\n\t\t\tpageWebNav = nav.pageWebNav;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tpageWebNav = webNav;\r\n\t\t}\r\n\t\tlet content = <>\r\n\t\t\t{this.renderHeader(pageWebNav)}\r\n\t\t\t<main>{children}</main>\r\n\t\t\t{this.renderFooter(pageWebNav)}\r\n\t\t</>;\r\n\t\tif (pageWebNav) {\r\n\t\t\treturn <WebNavScrollView\r\n\t\t\t\tonScroll={onScroll}\r\n\t\t\t\tonScrollTop={onScrollTop}\r\n\t\t\t\tonScrollBottom={onScrollBottom}\r\n\t\t\t\tclassName={className}\r\n\t\t\t\twebNav={pageWebNav}\r\n\t\t\t>\r\n\t\t\t\t{content}\r\n\t\t\t</WebNavScrollView>;\r\n\t\t}\r\n\t\telse {\r\n\t\t\treturn <ScrollView\r\n\t\t\t\tonScroll={onScroll}\r\n\t\t\t\tonScrollTop={onScrollTop}\r\n\t\t\t\tonScrollBottom={onScrollBottom}\r\n\t\t\t\tclassName={className}\r\n\t\t\t>\r\n\t\t\t\t{content}\r\n\t\t\t</ScrollView>;\r\n\t\t}\r\n\t}\r\n}\r\n","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport { FA, LMR } from 'tonva-react';\r\nimport { Market, Stock, StockValue } from 'uq-app/uqs/BruceYuMi';\r\nimport { NStockInfo } from '../stockinfo';\r\nimport {percent0, percent1, number, numberToMarketValue, calculateZZ3} from '../tool';\r\n\r\nfunction renderSortCol(radioName:string, sortMethod:string, caption:string, \r\n\tsort: (sortMethod:string) => void, defaultSort:string) {\r\n\treturn <label className=\"btn btn-outline-info mb-0\">\r\n\t\t<input type=\"radio\" className=\"btn-sm btn-check mr-1\"\r\n\t\t\tname={radioName} defaultChecked={sortMethod === defaultSort}\r\n\t\t\tonClick={() => sort(sortMethod)} />\r\n\t\t{caption}\r\n\t</label>\r\n}\r\n\r\nexport function renderSortHeaders(radioName:string, defaultSort:string, sort: (sortMethod:string) => void) {\r\n\tif (!defaultSort) defaultSort = 'tagv';\r\n\treturn <div className=\"btn-group\" role=\"group\" aria-label=\"Basic radio toggle button group\">\r\n\t\t{renderSortCol(radioName, 'tagv', '米息分', sort, defaultSort)}\r\n\t\t{renderSortCol(radioName, 'tagpe', 'TTM', sort, defaultSort)}\r\n\t\t{renderSortCol(radioName, 'tagdp', '股息率', sort, defaultSort)}\r\n\t</div>;\r\n}\r\n\r\nfunction renderValue(caption:string, value:number, valueType:'p0'|'p1'|'n1'|'n2'|'yi'):JSX.Element {\r\n\tconst _cn = 'px-2 mb-1 text-right '; \r\n\tlet cn = _cn + 'c5';\r\n\tlet cnYI = _cn + 'c5'\r\n\tlet vStr:string;\r\n\tif (isNaN(value) === true) {\r\n\t\tvStr = '-'\r\n\t}\r\n\telse {\r\n\t\tswitch (valueType) {\r\n\t\t\tcase 'p0': vStr = percent0(value); break;\r\n\t\t\tcase 'p1': vStr = percent1(value); break;\r\n\t\t\tcase 'n1': vStr = number(value, 1); break;\r\n\t\t\tcase 'n2': vStr = number(value, 2); break;\r\n\t\t\tcase 'yi': \r\n\t\t\t\tvStr = numberToMarketValue(value);\r\n\t\t\t\tcn = cnYI;\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\treturn <div key={caption} className={cn}>\r\n\t\t<span className=\"text-muted small\">{caption}</span><br />\r\n\t\t{vStr}\r\n\t</div>;\r\n}\r\n\r\nexport function renderStockInfoRow(row: NStockInfo, onClickName: (row:NStockInfo) => void, inputSelect:JSX.Element, right:JSX.Element):JSX.Element {\r\n  \tlet { id, name, code, pe, roe, price, divyield, v, order, symbol, l, pshares } = row;\r\n  \tlet zzl = calculateZZ3((row as any).dataArr);\r\n  \tlet left = <div className=\"cursor-pointer\" onClick={()=>onClickName?.(row)}>\r\n\t\t<span className=\"text-primary\">{name}</span>\r\n\t\t&nbsp; \r\n\t\t<span className=\"text-info\">{symbol}</span>\r\n\t  \t&nbsp;\r\n\t\t<small className=\"small ml-1\"><span className=\"text-danger\">{order}</span></small>\r\n  \t</div>;\r\n\tlet rows:[string,number,'p0'|'p1'|'n1'|'n2'|'yi'][] = [\r\n\t\t['米息分', Math.log2(v), 'n1'],\r\n\t\t['米息率', v, 'n1'],\r\n\t\t['股息率', divyield*100, 'n1'],\r\n\t\t['TTM', pe, 'n1'],\r\n\t\t['价格', price, 'n2'],\r\n\t\t['ROE', roe*100, 'n1'],\r\n\t\t['预增', l, 'p0'],\r\n\t\t['现增', zzl[3], 'p0'],\r\n\t\t['增 1', zzl[2], 'p0'],\r\n\t\t['增 2', zzl[1], 'p0'],\r\n\t\t['增 3', zzl[0], 'p0'],\r\n\t\t['市值', pshares*price, 'yi'],\r\n  \t];\r\n\tlet inputSelectSpan:any;\r\n\tif (inputSelect) {\r\n\t\tinputSelectSpan = <span className=\"ml-4\">{inputSelect}</span>\r\n\t}\r\n  \treturn <div className=\"d-block border-top\">\r\n\t\t<LMR className=\"px-2 py-1 bg-light\" left={left} right = {right}>{inputSelectSpan}</LMR>\r\n\t\t<div className=\"d-flex flex-wrap p-1\" >\r\n\t\t\t{rows.map(v => renderValue(v[0], v[1], v[2]))}\r\n\t  \t</div>\r\n  \t</div>;\r\n}\r\n\r\nexport function renderStockRow(order: number, stock: Stock&StockValue, onClickName: (stock:Stock&StockValue) => void, inputSelect:JSX.Element, right:JSX.Element):JSX.Element {\r\n\tlet { id, name, code, earning, roe, price, divident, miRate, volumn, ttm, inc1, inc2, inc3, inc4, preInc } = stock;\r\n\tlet $market = (stock as any).$market;\r\n\tlet left = <div className=\"cursor-pointer flex-grow-1 align-self-center\" onClick={()=>onClickName(stock)}>\r\n\t\t<small className=\"mr-2 text-danger\">{order}</small>\r\n\t\t&nbsp; \r\n\t\t{$market?.el}\r\n\t\t&nbsp; \r\n\t\t<span className=\"text-primary\">{name}</span>\r\n\t\t&nbsp; \r\n\t\t<span className=\"text-info\">{code}</span>\r\n\t\t&nbsp;\r\n\t</div>;\r\n\tlet rows:[string,number,'p0'|'p1'|'n1'|'n2'|'yi'][] = [\r\n\t\t['米息分', Math.log2(miRate/100), 'n1'],\r\n\t\t['米息率', miRate/100, 'n1'],\r\n\t\t['TTM', ttm/100, 'n1'],\r\n\t\t['股息率', (divident as number), 'n1'],\r\n\t\t['价格', price as number, 'n2'],\r\n\t\t['ROE', roe as number, 'n1'],\r\n\t\t['预增', preInc as number/100, 'p0'],\r\n\t\t['现增', inc1 as number/100, 'p0'],\r\n\t\t['增 1', inc2 as number/100, 'p0'],\r\n\t\t['增 2', inc3 as number/100, 'p0'],\r\n\t\t['增 3', inc4 as number/100, 'p0'],\r\n\t\t['市值', volumn as number, 'yi'],\r\n\t];\r\n\treturn <div className=\"d-block border-top\">\r\n\t\t<div className=\"d-flex px-2 py-1 bg-light\">\r\n\t\t\t{left}\r\n\t\t\t{right}\r\n\t\t</div>\r\n\t\t<div className=\"d-flex flex-wrap p-1\" onClick={()=>onClickName(stock)}>\r\n\t\t\t{rows.map(v => renderValue(v[0], v[1], v[2]))}\r\n\t\t</div>\r\n\t</div>;\r\n}\r\n\r\nconst nFormat = new Intl.NumberFormat('zh-CN', { maximumSignificantDigits: 3 });\r\nexport function formatNumber(num: number): string {\r\n\treturn nFormat.format(num);\r\n}\r\n\r\nexport function renderStockUrl(row: NStockInfo) {\r\n    let { symbol, market, code } = row;\r\n    let url = market === 'HK' ? `https://xueqiu.com/S/${code}` : `https://finance.sina.com.cn/realstock/company/${symbol}/nc.shtml`;\r\n\treturn <a className=\"text-info\" href={url} target=\"_blank\" rel=\"noopener noreferrer\" onClick={(e)=>{e.stopPropagation();}}>\r\n\t\t<FA name=\"angle-double-right\" />\r\n\t</a>;\r\n}","export function numberToFixString(n: number, w = 2) {\r\n    return n === undefined ? '' : n.toFixed(w);\r\n}\r\n\r\nexport function number(n: number, w = 2) {\r\n    return n === undefined ? '' : n.toFixed(w);\r\n}\r\n\r\nexport function numberToMarketValue(n: number) {\r\n    return n === undefined || isNaN(n) ? '' : Math.round(n / 10000).toString(); // + '亿';\r\n}\r\n\r\nexport function numberToString(n: number, precision = 2) {\r\n    return n === undefined ? '' : n.toPrecision(precision);\r\n}\r\n\r\nexport function numberToPrecision(n: number, precision = 4) {\r\n    return n === undefined ? undefined : Number.parseFloat(n.toPrecision(precision));\r\n}\r\n\r\nexport function percentToFixString(n: number) {\r\n    return n === undefined || isNaN(n) ? '' : (n * 100).toFixed(2) + '%';\r\n}\r\n\r\nexport function percent0(n: number) {\r\n    return n === undefined || isNaN(n) ? '' : (n * 100).toFixed(0) + '%';\r\n}\r\nexport function percent1(n: number) {\r\n    return n === undefined || isNaN(n) ? '' : (n * 100).toFixed(1) + '%';\r\n}\r\n\r\nexport function warningTypeString(t: string) {\r\n    switch (t) {\r\n        case 'gt': return '大于';\r\n        case 'lt': return '小于';\r\n        default: return t;\r\n    }\r\n}\r\n\r\nexport function predictCutRatio(r2: number) {\r\n    return r2 * 2 - r2 * r2;\r\n}\r\n\r\nexport function evaluatePricePrice(iRate: number, e1: number, e2: number, e3: number) {\r\n    let r = 1 + iRate;\r\n    let r2 = r * r;\r\n    let r3 = r2 * r;\r\n    return (e1 / r + e2 / r2 + e3 / r3 + e3 / iRate / r3) / 2;\r\n}\r\n\r\nexport function calculateV(z: number, divyield: number, pe: number) {\r\n    if (pe === undefined || isNaN(pe)) {\r\n        return undefined;\r\n    }\r\n\r\n    let r = 0;\r\n    if (z !== undefined) {\r\n        if (z > 0.25) {\r\n            z = 0.25;\r\n        }\r\n        r += z * 100;\r\n    }\r\n    if (divyield !== undefined) {\r\n        r += divyield * 100;\r\n    }\r\n    return r / pe;\r\n}\r\n\r\nexport function calculateVN(z: number, e: number, bonus: number, price: number) {\r\n    if (price === undefined || isNaN(price) || e === undefined || isNaN(e)) {\r\n        return undefined;\r\n    }\r\n\r\n    let r = 0;\r\n    if (z !== undefined && e > 0) {\r\n        if (z > 0.25) {\r\n            z = 0.24 + Math.pow((z - 0.24) * 100, 0.6667) / 100;\r\n        }\r\n        z = 1 + z;\r\n        z = z * z * z - 1;\r\n        r += z * e * 100;\r\n    }\r\n    if (bonus !== undefined && !isNaN(bonus)) {\r\n        r += bonus * 100;\r\n    }\r\n    return r / price;\r\n}\r\n\r\nexport function calculateVS(ev: number, bonus: number, price: number) {\r\n    if (price === undefined || isNaN(price)) {\r\n        return undefined;\r\n    }\r\n\r\n    if (ev === undefined || isNaN(ev)) {\r\n        if (bonus === undefined || isNaN(bonus)) {\r\n            return undefined;\r\n        }\r\n        else {\r\n            return bonus * 100 / price;\r\n        }\r\n    }\r\n    else {\r\n        if (bonus === undefined || isNaN(bonus)) {\r\n            return ev * 100 / price;\r\n        }\r\n        else {\r\n            return (bonus + ev) * 100 / price;\r\n        }\r\n    }\r\n}\r\n\r\nexport function calculateZZ3(data: number[]) {\r\n    let ret: number[] = [undefined, undefined, undefined, undefined];\r\n    if (data === undefined)\r\n        return ret;\r\n    let len = data.length;\r\n    if (len < 5)\r\n        return ret;\r\n\r\n    let funcz = (n: number, p: number) => {\r\n        if (p <= 0 || n <= 0)\r\n            return undefined;\r\n        return ((n / p) - 1);\r\n    }\r\n    for (let i = 0; i < 4; ++i) {\r\n        ret[i] = funcz(data[i + 1], data[i]);\r\n    }\r\n    return ret;\r\n}\r\n\r\n//export function caption = (value:string) => <span className=\"text-muted small\">{value}</span>;\r\n\r\nexport function MonthnoFromDay(day: number) {\r\n    let year = Math.floor(day / 10000);\r\n    let month = Math.floor((day % 10000) / 100) - 1;\r\n    return (year - 1995) * 12 + month;\r\n}\r\n\r\nexport function SeasonnoFromDay(day: number) {\r\n    let year = Math.floor(day / 10000);\r\n    let month = Math.floor((day % 10000) / 100) - 1;\r\n    let season = Math.floor(month / 3);\r\n    return (year - 1995) * 4 + season;\r\n}\r\n\r\nexport function SeasonnoFromYearMonth(year: number, month: number) {\r\n    let season = Math.floor((month - 1) / 3);\r\n    return (year - 1995) * 4 + season;\r\n}\r\n\r\nexport function SeasonnoToYearMonth(no: number) {\r\n    let year = Math.floor(no / 4) + 1995;\r\n    let month = (Math.floor(no % 4) + 1) * 3;\r\n    return year * 100 + month;\r\n}\r\n\r\nexport function SeasonnoToBeginEnd(season: number) {\r\n    let year = (1995 + Math.floor(season / 4)) * 10000;\r\n    let s = season % 4;\r\n    if (s === 0) {\r\n        return { begin: year + 101, end: year + 331 };\r\n    }\r\n    if (s === 1) {\r\n        return { begin: year + 401, end: year + 630 };\r\n    }\r\n    if (s === 2) {\r\n        return { begin: year + 701, end: year + 930 };\r\n    }\r\n    return { begin: year + 1001, end: year + 1231 };\r\n}\r\n\r\nexport function CalculateValueAvg(arr: { v: number }[]) {\r\n    let ret: { avg20: number, avg50: number, avg100: number, avg: number } = { avg20: undefined, avg50: undefined, avg100: undefined, avg: undefined };\r\n\r\n    let length = arr.length;\r\n    let calcuOne = (count: number): number => {\r\n        let endIndex = count;\r\n        if (count === 0 || endIndex > length)\r\n            endIndex = length;\r\n        if (endIndex >= 10) {\r\n            let sum = 0;\r\n            for (let i = 3; i < endIndex; ++i) {\r\n                sum += arr[i].v;\r\n            }\r\n            return sum / (endIndex - 3);\r\n        }\r\n        else {\r\n            return undefined;\r\n        }\r\n    }\r\n\r\n    ret.avg20 = calcuOne(20);\r\n    ret.avg50 = calcuOne(50);\r\n    ret.avg100 = calcuOne(100);\r\n    ret.avg = calcuOne(0);\r\n    return ret;\r\n}\r\n","import { Group } from \"uq-app/uqs/BruceYuMi\";\r\n\r\nexport function renderGroup(item: Group, index:number, IDRender: (item: Group, index:number)=>JSX.Element) {\r\n\tlet cn:string = '';\r\n\treturn <span className={cn}>{IDRender(item, index)}</span>;\r\n}\r\n","export const consts = {\r\n    uqBasedata: \"bruce/mi\",\r\n    appIcon: 'https://tv.jkchemical.com/imgs/Bear-icon.png',\r\n    miApiHost: 'https://mi.jjol.cn/',\r\n    miApiHostDebug: 'http://localhost:6011/',\r\n    isDevelopment: process.env.NODE_ENV === 'development',\r\n}\r\n\r\nexport const defaultGroupName = '自选股';\r\nexport const defaultBlackListGroupName = '黑名单';\r\n","import { List, Page, PageItems, Scroller } from \"tonva-react\";\r\n\r\nexport interface ListPageProps {\r\n\tpageItems: PageItems<any>;\r\n\titemClick: (item:any) => any;\r\n\trenderItem?: (item:any, index:number) => JSX.Element;\r\n\trenderItemContainer?: (content:any) => JSX.Element;\r\n\tkey: (item:any) => number|string;\r\n\theader: JSX.Element | string;\r\n\tright?: JSX.Element;\r\n\tfooter?: JSX.Element;\r\n\ttop?: JSX.Element;\r\n\tbottom?: JSX.Element;\r\n\tback?: 'close' | 'back' | 'none';\r\n\tclassName?: string;\r\n\theaderClassName?: string;\r\n}\r\n\r\nexport class ListPage extends Page {\r\n\tprotected listPageProps: ListPageProps;\r\n\tconstructor(listPageProps: ListPageProps) {\r\n\t\tsuper({});\r\n\t\tthis.listPageProps = listPageProps;\r\n\t}\r\n\r\n\trender() {\r\n\t\treturn this.renderPage();\r\n\t}\r\n\r\n\tprivate renderPage():JSX.Element {\r\n\t\tlet {pageItems, itemClick, renderItem, renderItemContainer\r\n\t\t\t, key, header, footer, right\r\n\t\t\t, top, bottom, back, className, headerClassName} = this.listPageProps;\r\n\t\tif (!header) header = false as any;\r\n\t\tlet renderRow = (item:any, index:number) => {\r\n\t\t\treturn renderItemContainer(renderItem(item, index));\r\n\t\t}\r\n\t\tlet item = {\r\n\t\t\trender: renderRow,\r\n\t\t\tonClick: itemClick,\r\n\t\t\tkey,\r\n\t\t}\r\n\t\treturn <Page\r\n\t\t\theader={header} right={right} footer={footer}\r\n\t\t\tonScroll={(e:any)=>this.onPageScroll(e)}\r\n\t\t\tonScrollTop={(scroller: Scroller) => this.onPageScrollTop(scroller)}\r\n\t\t\tonScrollBottom={(scroller: Scroller) => this.onPageScrollBottom(scroller)}\r\n\t\t\tback={back}\r\n\t\t\theaderClassName={headerClassName}\r\n\t\t\tclassName={className}\r\n\t\t\tafterBack={()=>this.afterBack()}\r\n\t\t>\r\n\t\t\t{top}\r\n\t\t\t<List items={pageItems} item={item} />\r\n\t\t\t{bottom}\r\n\t\t</Page>;\r\n\t}\r\n\r\n\tprotected onPageScroll(e:any) {}\r\n\tprotected async onPageScrollTop(scroller: Scroller): Promise<boolean> {return false;}\r\n\tprotected async onPageScrollBottom(scroller: Scroller): Promise<void> {return;}\r\n\tprotected afterBack():void {}\r\n}\r\n","import { Controller } from \"tonva-react\";\r\nimport { renderItem, listRight, renderItemContainer } from \"../tools\";\r\nimport { ListPage, ListPageProps } from \"./ListPage\";\r\nimport { MidList } from \"./MidList\";\r\n\r\nexport class CList<T> extends Controller {\r\n\tprotected readonly midList: MidList<T>;\r\n\tprotected selectedItem: T;\r\n\tconstructor(midList: MidList<T>) {\r\n\t\tsuper();\r\n\t\tthis.setRes(midList.res);\r\n\t\tthis.midList = midList;\r\n\t}\r\n\r\n\tprotected async internalStart() {\r\n\t\tawait this.midList.init();\r\n\t\tlet pageItems = this.midList.pageItems;\r\n\t\tlet props:ListPageProps = {\r\n\t\t\theader: this.header,\r\n\t\t\tpageItems,\r\n\t\t\tkey: this.midList.key,\r\n\t\t\titemClick: (item:any) => this.onItemClick(item),\r\n\t\t\tright: this.renderRight(),\r\n\t\t\trenderItem: (item:any, index) => this.renderItem(item, index),\r\n\t\t\trenderItemContainer: (content:any) => this.renderItemContainer(content),\r\n\t\t};\r\n\t\tpageItems.first(this.firstParam);\r\n\t\tlet page = new ListPage(props);\r\n\t\tthis.openPage(page.render(), () => this.returnCall(this.selectedItem));\r\n\t}\r\n\r\n\tprotected get firstParam():any {return undefined;}\r\n\tprotected get header():string|JSX.Element {return this.midList.header ?? 'List'}\r\n\tprotected renderItemContainer(content:any):JSX.Element {\r\n\t\treturn renderItemContainer(content);\r\n\t}\r\n\tprotected onItemClick(item:any):void {\r\n\t\tthis.midList.onItemClick(item);\r\n\t}\r\n\r\n\tprotected renderRight():JSX.Element {\t\t\r\n\t\tlet {renderRight, onRightClick} = this.midList;\r\n\t\tif (!onRightClick) return null;\r\n\t\treturn (renderRight ?? listRight)(onRightClick);\r\n\t}\r\n\r\n\tprotected renderItem(item:any, index:number):JSX.Element {\r\n\t\treturn (this.midList.renderItem ?? renderItem)(item, index);\r\n\t}\r\n\r\n}\r\n","import { runInAction } from \"mobx\";\r\nimport { PageItems, Uq } from \"tonva-react\";\r\nimport { ListPageItems } from \"../tools\";\r\nimport { IDBase, Mid } from \"../base\";\r\n\r\nexport abstract class MidList<T> extends Mid {\r\n\treadonly pageItems: PageItems<T>;\r\n\tconstructor(uq:Uq, res?:any) {\r\n\t\tsuper(uq, res);\r\n\t\tthis.pageItems = this.createPageItems();\r\n\t}\r\n\r\n\tprotected abstract createPageItems():PageItems<T>;\r\n\tasync init():Promise<void> {}\r\n\tprotected abstract loadPageItems(pageStart:any, pageSize:number):Promise<T[]>;\r\n\tkey:((item:T) => number|string);\r\n\r\n\tonRightClick: ()=>any;\r\n\trenderItem: (item:T, index:number)=>JSX.Element;\r\n\tonItemClick: (item:T)=>any;\r\n\trenderRight: ()=>JSX.Element;\r\n\theader: string|JSX.Element;\r\n}\r\n\r\nexport abstract class MidIDListBase<T extends IDBase> extends MidList<T> {\r\n\tprotected get listPageItems(): IDListPageItems<T> {return this.pageItems as IDListPageItems<T>}\r\n\tkey:((item:T) => number|string) = item => {\r\n\t\treturn item.id;\r\n\t}\r\n\tcreatePageItems():PageItems<T> {\r\n\t\tlet loader = (pageStart:any, pageSize:number) => this.loadPageItems(pageStart, pageSize);\r\n\t\treturn new IDListPageItems<T>(loader);\r\n\t}\r\n}\r\n\r\nexport class IDListPageItems<T extends IDBase> extends ListPageItems<T> {\r\n\titemId(item:T):number {return item.id}\r\n\tnewItem(id:number, item:T):T {return {...item, id}}\r\n\r\n\tupdate(item:T): Promise<void> {\r\n\t\tlet id = item.id;\r\n\t\tlet ret = this._items.find(v => this.itemId(v) === id);\r\n\t\tif (ret === undefined) {\r\n\t\t\tlet data = this.newItem(id, item);\r\n\t\t\tthis._items.unshift(data);\r\n\t\t}\r\n\t\telse {\r\n\t\t\trunInAction(() => {\r\n\t\t\t\tObject.assign(ret, item);\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn;\r\n\t}\r\n}\r\n","export * from './base';\r\nexport * from './ID';\r\nexport * from './IDX';\r\nexport * from './IX';\r\nexport * from './sheet';\r\nexport * from './tag';\r\nexport * from './form';\r\nexport * from './roles';\r\nexport * from './select';","import _ from 'lodash';\r\nimport {nav, Page, PageHeaderProps, PageWebNav} from '../components';\r\nimport {resOptions, t} from '../res';\r\nimport { User, env } from '../tool';\r\nimport { VPage } from './vpage';\r\nimport { View } from './view';\r\nimport { messageHub } from '../net';\r\n\r\nexport interface ConfirmOptions {\r\n    caption?: string;\r\n    message: string | JSX.Element;\r\n    classNames?: string;\r\n    ok?: string;\r\n    yes?: string;\r\n    no?: string;\r\n}\r\n\r\nexport interface WebNav<C extends Controller> {\r\n\tVNavHeader?: new (controller: C) => View<C>;\r\n\tVNavRawHeader?: new (controller: C) => View<C>;\r\n\tVNavFooter?: new (controller: C) => View<C>;\r\n\tVNavRawFooter?: new (controller: C) => View<C>;\r\n\trenderPageHeader?: (props: PageHeaderProps) => JSX.Element;\r\n}\r\n\r\nexport abstract class Controller {\r\n\tprotected res: any = {};\r\n\tt = (str: string): string|JSX.Element => this.internalT(str) || str;\r\n    icon: string|JSX.Element;\r\n    label:string|JSX.Element;\r\n\treadonly isDev:boolean = env.isDevelopment;\r\n\tpageWebNav: PageWebNav;\r\n    get user():User {return nav.user}\r\n    get isLogined():boolean {\r\n        let {user} = nav;\r\n        if (user === undefined) return false;\r\n        return user.id > 0;\r\n    }\r\n\r\n\tprotected beforeInit() {}\r\n\tprotected afterInit() {}\r\n\r\n\tinit(...param: any[]) {\r\n\t\tthis.beforeInit();\r\n\t\tthis.pageWebNav = this.getPageWebNav();\r\n\t\tthis.afterInit();\r\n\t}\r\n\r\n\tinternalT(str:string):any {\r\n\t\treturn this.res?.[str] ?? t(str);\r\n\t}\r\n\r\n\tget webNav(): WebNav<any> {return undefined;}\r\n\r\n\tgetWebNav(): WebNav<any> {return this.webNav;}\r\n\r\n\tgetPageWebNav(): PageWebNav {return undefined;}\r\n\r\n\tget isWebNav(): boolean {return nav.isWebNav}\r\n\tnavigate(url:string) {\r\n\t\tnav.navigate(url);\r\n\t}\r\n\t\r\n\tsetRes(res: any) {\r\n\t\tif (res === undefined) return;\r\n\t\tlet {$lang, $district} = resOptions;\r\n\t\t_.merge(this.res, res);\r\n\t\tif ($lang !== undefined) {\r\n\t\t\tlet l = res[$lang];\r\n\t\t\tif (l !== undefined) {\r\n\t\t\t\t_.merge(this.res, l);\r\n\t\t\t\tlet d = l[$district];\r\n\t\t\t\tif (d !== undefined) {\r\n\t\t\t\t\t_.merge(this.res, d);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\t\t\r\n\t}\r\n\tgetRes():any {return this.res;}\r\n\r\n    private receiveHandlerId:number;\r\n    //private disposer:()=>void;\r\n\r\n    protected dispose = () => {\r\n        // message listener的清理\r\n\t\t//nav.unregisterReceiveHandler(this.receiveHandlerId);\r\n\t\tmessageHub.unregisterReceiveHandler(this.receiveHandlerId);\r\n        this.onDispose();\r\n    }\r\n\r\n    protected onDispose() {\r\n\t}\r\n\t\r\n\tget timeZone():number { return env.timeZone; }\r\n\r\n\tisMe(id:any):boolean {\r\n\t\tif (id === null) return false;\r\n\t\tlet {user} = this;\r\n\t\tlet userId = user.id;\r\n\t\tswitch (typeof id) {\r\n\t\t\tdefault: return false;\r\n\t\t\tcase 'string': return Number(id) === userId;\r\n\t\t\tcase 'number': return id === userId;\r\n\t\t\tcase 'object': return id.id === userId;\r\n\t\t}\r\n\t}\r\n\r\n    protected async openVPage<C extends Controller, P extends VPage<C>>(vp: new (controller: C)=>P, param?:any, afterBack?:(ret:any)=>void):Promise<P> {\r\n\t\tlet ret = new vp((this as any) as C);\r\n\t\tawait ret.open(param, afterBack);\r\n\t\treturn ret;\r\n    }\r\n\r\n    protected async replaceVPage<C extends Controller, P extends VPage<C>>(vp: new (controller: C)=>P, param?:any, afterBack?:(ret:any)=>void):Promise<P> {\r\n\t\tlet ret = new vp((this as any) as C);\r\n\t\tawait ret.replaceOpen(param, afterBack);\r\n\t\treturn ret;\r\n    }\r\n\r\n    protected renderView<C extends Controller, V extends View<C>>(view: new (controller: C)=>V, param?:any):JSX.Element {\r\n\t\tlet v = new view((this as any) as C);\r\n\t\treturn v.render(param);\r\n    }\r\n\r\n    async event(type:string, value:any) {\r\n        await this.onEvent(type, value);\r\n    }\r\n\r\n    protected async onEvent(type:string, value:any) {\r\n    }\r\n\r\n    protected msg(text:string) {\r\n        alert(text);\r\n    }\r\n    protected errorPage(header:string, err:any) {\r\n        this.openPage(<Page header=\"App error!\">\r\n            <pre>\r\n                {typeof err === 'string'? err : err.message}\r\n            </pre>\r\n        </Page>);\r\n    }\r\n\r\n    protected onMessage(message:any):Promise<void> {\r\n        return;\r\n    }\r\n\r\n    private onMessageReceive = async (message:any):Promise<void> => {\r\n        await this.onMessage(message);\r\n    }\r\n\r\n    protected async beforeStart():Promise<boolean> {\r\n        return true;\r\n\t}\r\n\tprotected async afterStart():Promise<void> {\r\n\t}\r\n    protected registerReceiveHandler() {\r\n        this.receiveHandlerId = messageHub.registerReceiveHandler(this.onMessageReceive);\r\n    }\r\n\r\n    protected abstract internalStart(param?:any, ...params:any[]):Promise<void>;\r\n    async start(param?:any, ...params:any[]):Promise<void> {\r\n\t\tthis.registerReceiveHandler();\r\n        let ret = await this.beforeStart();\r\n        if (ret === false) return;\r\n\t\tawait this.internalStart(param, ...params);\r\n\t\tawait this.afterStart();\r\n    }\r\n\r\n    get isCalling():boolean {return this._resolve_$ !== undefined}\r\n\r\n    private _resolve_$:((value:any) => void)[];\r\n    async call<T>(param?:any, ...params:any[]):Promise<T> {\r\n        if (this._resolve_$ === undefined) this._resolve_$ = [];\r\n        return new Promise<T> (async (resolve, reject) => {\r\n            this._resolve_$.push(resolve);\r\n            await this.start(param, ...params);\r\n        });\r\n    }\r\n\r\n    async vCall<C extends Controller>(vp: new (controller: C)=>VPage<C>, param?:any):Promise<any> {\r\n        if (this._resolve_$ === undefined) this._resolve_$ = [];\r\n        return new Promise<any> (async (resolve, reject) => {\r\n            this._resolve_$.push(resolve);\r\n            await (new vp(this as any)).open(param);\r\n        });\r\n    }\r\n\r\n    returnCall(value:any) {\r\n        if (this._resolve_$ === undefined) return;\r\n        let resolve = this._resolve_$.pop();\r\n        if (resolve === undefined) {\r\n            alert('the Controller call already returned, or not called');\r\n            return;\r\n        }\r\n        resolve(value);\r\n    }\r\n\r\n    openPage(page:JSX.Element, onClosePage?: (ret:any)=>void) {\r\n\t\tlet disposer: ()=>void;\r\n\t\tif (onClosePage !== undefined) {\r\n\t\t\tdisposer = () => {\r\n\t\t\t\t//if (this.disposer) this.disposer();\r\n\t\t\t\tonClosePage(undefined);\r\n\t\t\t}\r\n\t\t}\r\n\r\n        nav.push(page, disposer);\r\n        //this.disposer = undefined;\r\n    }\r\n\r\n    replacePage(page:JSX.Element, onClosePage?: ()=>void) {\r\n        nav.replace(page, onClosePage);\r\n        //this.disposer = undefined;\r\n    }\r\n\r\n    backPage() {\r\n        nav.back();\r\n    }\r\n\r\n    closePage(level?:number) {\r\n        nav.pop(level);\r\n    }\r\n\r\n    ceasePage(level?:number) {\r\n        nav.ceaseTop(level);\r\n\t}\r\n\t\r\n\tgo(showPage:()=>void, url:string, absolute?:boolean) {\r\n\t\tnav.go(showPage, url, absolute);\r\n\t}\r\n\r\n    removeCeased() {\r\n        nav.removeCeased();\r\n    }\r\n\r\n    regConfirmClose(confirmClose: ()=>Promise<boolean>) {\r\n        nav.regConfirmClose(confirmClose);\r\n\t}\r\n\r\n\tprivate topPageKey:any;\r\n\tprotected startAction() {\r\n\t\tthis.topPageKey = nav.topKey();\r\n    }\r\n    get TopKey() {\r\n        return this.topPageKey;\r\n    }\r\n    SetTopKey(key:any) {\r\n        this.topPageKey = key;\r\n    }\r\n\tpublic popToTopPage() {\r\n\t\tnav.popTo(this.topPageKey);\r\n\t}\r\n\r\n    async confirm(options: ConfirmOptions): Promise<'ok'|'yes'|'no'|undefined> {\r\n        return new Promise<'ok'|'yes'|'no'|undefined> (async (resolve, reject) => {\r\n            let {caption, message, ok, yes, no, classNames} = options;\r\n            let close = (res:'ok'|'yes'|'no'|undefined) => {\r\n                this.closePage();\r\n                resolve(res);\r\n            }\r\n            let buttons:any[] = [];\r\n            if (ok !== undefined) {\r\n                buttons.push(<button key=\"ok\" className=\"btn btn-primary mr-3\" onClick={()=>close('ok')}>{ok}</button>);\r\n            }\r\n            if (yes !== undefined) {\r\n                buttons.push(<button key=\"yes\" className=\"btn btn-success mr-3\" onClick={()=>close('yes')}>{yes}</button>);\r\n            }\r\n            if (no !== undefined) {\r\n                buttons.push(<button key=\"no\" className=\"btn btn-outline-danger mr-3\" onClick={()=>close('no')}>{no}</button>);\r\n            }\r\n            this.openPage(<Page header={caption || '请确认'} back=\"close\">\r\n                <div className={classNames || \"rounded bg-white m-5 p-3 border\"}>\r\n                    <div className=\"d-flex align-items-center justify-content-center\">\r\n                        {message}\r\n                    </div>\r\n                    <div className=\"mt-3 d-flex align-items-center justify-content-center\">\r\n                        {buttons}\r\n                    </div>\r\n                </div>\r\n            </Page>);\r\n            nav.regConfirmClose(async ():Promise<boolean> => {\r\n                resolve(undefined);\r\n                return true;\r\n            });\r\n        });\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport { Page, Image, UserView } from '../components';\r\nimport { env, User } from '../tool';\r\nimport { Controller } from './controller';\r\nimport { VPage } from './vpage';\r\n\r\nexport abstract class View<C extends Controller> {\r\n    protected controller: C;\r\n    protected readonly res: any;\r\n\tprotected readonly x: any;\r\n\tprotected readonly t: (str:string)=>any;\r\n\r\n    constructor(controller: C) {\r\n        this.controller = controller;\r\n\t\tthis.t = controller.t;\r\n    }\r\n\r\n\tprotected get isDev() {return  env.isDevelopment}\r\n\tget isWebNav(): boolean {return this.controller.isWebNav}\r\n\tnavigate(url:string) {this.controller.navigate(url)}\r\n\tprotected isMe(id:any) {return this.controller.isMe(id)}\r\n    abstract render(param?:any): JSX.Element;\r\n\r\n    protected renderVm(vm: new (controller: C)=>View<C>, param?:any) {\r\n        return (new vm(this.controller)).render(param);\r\n    }\r\n\r\n    protected async openVPage(vp: new (controller: C)=>VPage<C>, param?:any, afterBack?:()=>Promise<void>):Promise<void> {\r\n        await (new vp(this.controller)).open(param, afterBack);\r\n    }\r\n\r\n    protected async event(type:string, value?:any) {\r\n        await this.controller.event(type, value);\r\n\t}\r\n\t\r\n\tprotected go(showPage:()=>void, url:string, absolute?:boolean) {\r\n\t\tthis.controller.go(showPage, url, absolute);\r\n\t}\r\n\r\n    async vCall<C extends Controller>(vp: new (controller: C)=>VPage<C>, param?:any):Promise<any> {\r\n        return await this.controller.vCall(vp, param);\r\n    }\r\n\r\n    protected returnCall(value:any) {\r\n        this.controller.returnCall(value);\r\n    }\r\n\r\n\tprotected renderUser(user:any, imageClassName?:string, textClassName?:string) {\r\n\t\tlet renderUser = (user:User) => {\r\n\t\t\tlet {name, nick, icon} = user;\r\n\t\t\treturn <>\r\n\t\t\t\t<Image src={icon} className={imageClassName || 'w-1c h-1c mr-2'} />\r\n\t\t\t\t<span className={textClassName}>{nick || name}</span>\r\n\t\t\t</>;\r\n\t\t}\r\n\t\treturn <UserView user={user} render={renderUser} />\r\n\t}\r\n\r\n\tprotected renderUserText(user:any) {\r\n\t\tlet renderUser = (user:User) => {\r\n\t\t\tlet {name, nick} = user;\r\n\t\t\treturn <>{nick || name}</>;\r\n\t\t}\r\n\t\treturn <UserView user={user} render={renderUser} />\r\n\t}\r\n\r\n\tprotected renderMe(imageClassName?:string, textClassName?:string) {\r\n\t\tlet {user} = this.controller;\r\n\t\tif (!user) return;\r\n\t\treturn this.renderUser(user.id, imageClassName, textClassName);\r\n\t}\r\n\r\n    protected openPage(view: React.StatelessComponent<any>, param?:any, onClosePage?:(ret:any)=>void) {\r\n        let type = typeof param;\r\n        if (type === 'object' || type === 'undefined') {\r\n            this.controller.openPage(React.createElement(view, param), onClosePage);\r\n        }\r\n        else {\r\n            this.controller.openPage(<Page header=\"param type error\">\r\n                View.openPage param must be object, but here is {type}\r\n            </Page>, onClosePage);\r\n        }\r\n    }\r\n\r\n    protected replacePage(view: React.StatelessComponent<any>, param?:any) {\r\n        this.controller.replacePage(React.createElement(view, param));\r\n    }\r\n\r\n    protected openPageElement(page: JSX.Element, onClosePage?: ()=>void) {\r\n        this.controller.openPage(page, onClosePage);\r\n    }\r\n\r\n    protected replacePageElement(page: JSX.Element, onClosePage?: ()=>void) {\r\n        this.controller.replacePage(page, onClosePage);\r\n    }\r\n\r\n    protected backPage() {\r\n        this.controller.backPage();\r\n    }\r\n\r\n    protected closePage(level?:number) {\r\n        this.controller.closePage(level);\r\n    }\r\n\r\n    protected ceasePage(level?:number) {\r\n        this.controller.ceasePage(level);\r\n    }\r\n\r\n    protected removeCeased() {\r\n        this.controller.removeCeased();\r\n    }\r\n\r\n    protected regConfirmClose(confirmClose: ()=>Promise<boolean>) {\r\n        this.controller.regConfirmClose(confirmClose);\r\n\t}\r\n\r\n\tprotected popToTopPage() {\r\n\t\tthis.controller.popToTopPage();\r\n\t}\r\n}\r\n","import { Page, Scroller, TabsProps } from \"../components\";\r\nimport { View } from \"./view\";\r\nimport { Controller } from \"./controller\";\r\n\r\nexport abstract class VPage<C extends Controller> extends View<C> {\r\n\tprotected retOnClosePage: any;\r\n\r\n    open(param?:any, onClosePage?:(ret:any)=>void):Promise<void> {\r\n\t\tthis.init(param);\r\n\t\tlet _onClosePage: ()=>void;\r\n\t\tif (onClosePage !== undefined) _onClosePage = () => onClosePage(this.retOnClosePage);\r\n\t\tthis.openPageElement(this.renderPage(), _onClosePage);\r\n\t\treturn;\r\n\t}\r\n\r\n    replaceOpen(param?:any, onClosePage?:(ret:any)=>void):Promise<void> {\r\n\t\tthis.init(param);\r\n\t\tlet _onClosePage: ()=>void;\r\n\t\tif (onClosePage !== undefined) _onClosePage = () => onClosePage(this.retOnClosePage);\r\n\t\tthis.replacePageElement(this.renderPage(), _onClosePage);\r\n\t\treturn;\r\n\t}\r\n\r\n\trender(param?:any):JSX.Element {\r\n\t\tthis.init(param);\r\n\t\treturn this.renderPage();\r\n\t}\r\n\r\n\tinit(param?:any):void {return;}\r\n\r\n\theader():string|boolean|JSX.Element {return null;}\r\n\tright():JSX.Element {return null;}\r\n\tcontent():JSX.Element {return null;}\r\n\tfooter():JSX.Element {return null;}\r\n\tlogout(): boolean | (()=>Promise<void>) {return false;}\r\n\tprotected renderPage():JSX.Element {\r\n\t\tlet header = this.header();\r\n\t\tif (!header) header = false;\r\n\t\tlet logout = this.logout();\r\n\t\treturn <Page\r\n\t\t\theader={header} right={this.right()} footer={this.footer()}\r\n\t\t\tonScroll={(e:any)=>this.onPageScroll(e)}\r\n\t\t\tonScrollTop={(scroller: Scroller) => this.onPageScrollTop(scroller)}\r\n\t\t\tonScrollBottom={(scroller: Scroller) => this.onPageScrollBottom(scroller)}\r\n\t\t\tback={this.back}\r\n\t\t\theaderClassName={this.headerClassName}\r\n\t\t\tclassName={this.className}\r\n\t\t\tafterBack={()=>this.afterBack()}\r\n\t\t\ttabsProps={this.tabsProps}\r\n\t\t\tlogout={logout}\r\n\t\t\twebNav={this.controller.pageWebNav}\r\n\t\t>\r\n\t\t\t{this.content()}\r\n\t\t</Page>;\r\n\t}\r\n\r\n\tprotected onPageScroll(e:any) {}\r\n\tprotected async onPageScrollTop(scroller: Scroller): Promise<boolean> {return false;}\r\n\tprotected async onPageScrollBottom(scroller: Scroller): Promise<void> {return;}\r\n\tprotected afterBack():void {}\r\n\tprotected get back(): 'close' | 'back' | 'none' {return 'back'}\r\n\tprotected get headerClassName(): string {return null;}\r\n\tprotected get className(): string {return null;}\r\n\tprotected get tabsProps(): TabsProps {return null;}\r\n}\r\n","import { UqApi } from '../net';\r\nimport { LocalCache } from '../tool';\r\nimport { UqMan, Field, ArrFields, FieldMap } from './uqMan';\r\nimport { Tuid } from './tuid';\r\nimport { getObjPropIgnoreCase } from '../tool';\r\n\r\nconst tab = '\\t';\r\nconst ln = '\\n';\r\nconst chars = '\\\\ntbfvr';\r\nconst codeBackSlash = chars.charCodeAt(0);\r\nconst codeN = chars.charCodeAt(1);\r\nconst codeT = chars.charCodeAt(2);\r\nconst codeB = chars.charCodeAt(3);\r\nconst codeF = chars.charCodeAt(4);\r\nconst codeV = chars.charCodeAt(5);\r\nconst codeR = chars.charCodeAt(6);\r\n\r\nconst codes = '\\n\\t\\b\\f\\v\\r';\r\nconst codeBN = codes.charCodeAt(0);\r\nconst codeBT = codes.charCodeAt(1);\r\nconst codeBB = codes.charCodeAt(2);\r\nconst codeBF = codes.charCodeAt(3);\r\nconst codeBV = codes.charCodeAt(4);\r\nconst codeBR = codes.charCodeAt(5);\r\n\r\nexport abstract class Entity {\r\n    private jName: string;\r\n    schema: any;\r\n    ver: number = 0;\r\n    sys?: boolean;\r\n    readonly uq: UqMan;\r\n    readonly name: string;\r\n    readonly typeId: number;\r\n    readonly cache: LocalCache;\r\n    readonly uqApi: UqApi;\r\n    abstract get typeName(): string;\r\n    get sName():string {return this.jName || this.name}\r\n    fields: Field[];\r\n    arrFields: ArrFields[];\r\n    returns: ArrFields[];\r\n\r\n    constructor(uq:UqMan, name:string, typeId:number) {\r\n        this.uq = uq;\r\n        this.name = name;\r\n        this.typeId = typeId;\r\n        this.sys = this.name.indexOf('$') >= 0;\r\n        this.cache = this.uq.localMap.item(this.name); // new EntityCache(this);\r\n        this.uqApi = this.uq.uqApi;\r\n    }\r\n\r\n    public face: any;           // 对应字段的label, placeHolder等等的中文，或者语言的翻译\r\n\r\n    //getApiFrom() {return this.entities.uqApi;}\r\n\r\n    private fieldMaps: {[arr:string]: FieldMap} = {};\r\n    fieldMap(arr?:string): FieldMap {\r\n        if (arr === undefined) arr = '$';\r\n        let ret = this.fieldMaps[arr];\r\n        if (ret === undefined) {\r\n            let fields:Field[];\r\n            if (arr === '$') fields = this.fields;\r\n            else if (this.arrFields !== undefined) {\r\n                let arrFields = this.arrFields.find(v => v.name === arr);\r\n                if (arrFields !== undefined) fields = arrFields.fields;\r\n            }\r\n            else if (this.returns !== undefined) {\r\n                let arrFields = this.returns.find(v => v.name === arr);\r\n                if (arrFields !== undefined) fields = arrFields.fields;\r\n            }\r\n            if (fields === undefined) return {};\r\n            ret = {};\r\n            for (let f of fields) ret[f.name] = f;\r\n            this.fieldMaps[arr] = ret;\r\n        }\r\n        return ret;\r\n    }\r\n\r\n    public async loadSchema():Promise<void> {\r\n        if (this.schema !== undefined) return;\r\n        let schema = this.cache.get();\r\n        if (!schema) {\r\n            schema = await this.uq.loadEntitySchema(this.name);\r\n        }\r\n        //this.setSchema(schema);\r\n\t\t//this.buildFieldsTuid();\r\n\t\tthis.buildSchema(schema);\r\n\t\tawait this.loadValues();\r\n\t}\r\n\r\n\tbuildSchema(schema: any) {\r\n        this.setSchema(schema);\r\n\t\tthis.buildFieldsTuid();\r\n\t\t//await this.loadValues();\r\n\t}\r\n\t\r\n\tprotected async loadValues():Promise<any> {}\r\n\r\n    // 如果要在setSchema里面保存cache，必须先调用clearSchema\r\n    public clearSchema() {\r\n        this.schema = undefined;\r\n    }\r\n\r\n    public setSchema(schema:any) {\r\n        if (schema === undefined) return;\r\n        let {name, version} = schema;\r\n        this.ver = version || 0;\r\n\t\tthis.setJName(name);\r\n        this.cache.set(schema);\r\n\t\tthis.schema = schema;\r\n\t\tthis.buildFieldsTuid();\r\n\t}\r\n\t\r\n\tprotected setJName(name:string) {\r\n        if (name !== this.name) this.jName = name;\r\n\t}\r\n\r\n    public buildFieldsTuid() {\r\n        let {fields, arrs, returns} = this.schema;\r\n        this.uq.buildFieldTuid(this.fields = fields);\r\n        this.uq.buildArrFieldsTuid(this.arrFields = arrs, fields);\r\n        this.uq.buildArrFieldsTuid(this.returns = returns, fields);\r\n    }\r\n\r\n    schemaStringify():string {\r\n        return JSON.stringify(this.schema, (key:string, value:any) => {\r\n            if (key === '_tuid') return undefined;\r\n            return value;\r\n        }, 4);\r\n    }\r\n\r\n    tuidFromName(fieldName:string, arrName?:string):Tuid {\r\n        if (this.schema === undefined) return;\r\n        let {fields, arrs} = this.schema;\r\n        let entities = this.uq;\r\n        function getTuid(fn:string, fieldArr:Field[]) {\r\n            if (fieldArr === undefined) return;\r\n            let f = fieldArr.find(v => v.name === fn);\r\n            if (f === undefined) return;\r\n            return entities.getTuid(f.tuid);\r\n        }\r\n        let fn = fieldName.toLowerCase();\r\n        if (arrName === undefined) return getTuid(fn, fields);\r\n        if (arrs === undefined) return;\r\n        let an = arrName.toLowerCase();\r\n        let arr = (arrs as ArrFields[]).find(v => v.name === an);\r\n        if (arr === undefined) return;\r\n        return getTuid(fn, arr.fields);\r\n    }\r\n\r\n    buildParams(params:any):any {\r\n        let result:any = {};\r\n        let fields = this.fields;\r\n        if (fields !== undefined) this.buildFieldsParams(result, fields, params);\r\n        let arrs = this.arrFields;\r\n        if (arrs !== undefined) {\r\n            for (let arr of arrs) {\r\n                let {name, fields} = arr;\r\n                let paramsArr:any[] = params[name];\r\n                if (paramsArr === undefined) continue;\r\n                let arrResult:any[] = [];\r\n                result[name] = arrResult;\r\n                for (let pa of params) {\r\n                    let rowResult = {};\r\n                    this.buildFieldsParams(rowResult, fields, pa);\r\n                    arrResult.push(rowResult);\r\n                }\r\n            }\r\n        }\r\n        return result;\r\n    }\r\n\r\n    private buildFieldsParams(result:any, fields:Field[], params:any) {\r\n        for (let field of fields) {\r\n            let {name, type} = field;            \r\n            let d = params[name];\r\n            let val:any;\r\n            switch (type) {\r\n\t\t\t\tcase 'datetime':\r\n                \tval = this.buildDateTimeParam(d);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'date':\r\n\t\t\t\t\tif (d instanceof Date) {\r\n\t\t\t\t\t\tval = `${d.getFullYear()}-${d.getMonth()+1}-${d.getDate()}`;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tval = d;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tswitch (typeof d) {\r\n\t\t\t\t\t\tdefault: val = d; break;\r\n\t\t\t\t\t\tcase 'object':\r\n\t\t\t\t\t\t\tif (d instanceof Date) {\r\n\t\t\t\t\t\t\t\tval = d;\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tlet tuid = field._tuid;\r\n\t\t\t\t\t\t\tif (tuid === undefined) val = d.id;\r\n\t\t\t\t\t\t\telse val = tuid.getIdFromObj(d);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n            }\r\n            result[name] = val;\r\n        }\r\n    }\r\n\r\n    buildDateTimeParam(val:any) {\r\n        let dt: Date;\r\n        switch (typeof val) {\r\n            default: debugger; throw new Error('escape datetime field in pack data error: value=' + val);\r\n            case 'undefined': return undefined;\r\n            case 'object': dt = (val as Date); break;\r\n            case 'string':\r\n            case 'number': dt = new Date(val); break;\r\n        }\r\n        return Math.floor(dt.getTime()/1000);\r\n    }\r\n\r\n    buildDateParam(val:any) {\r\n        let dt: Date;\r\n        switch (typeof val) {\r\n            default: debugger; throw new Error('escape datetime field in pack data error: value=' + val);\r\n            case 'undefined': return '';\r\n            case 'string': return val;\r\n            case 'object': dt = (val as Date); break;\r\n            case 'number': dt = new Date(val); break;\r\n        }\r\n        let ret = dt.toISOString();\r\n        let p = ret.indexOf('T');\r\n        return p>0? ret.substr(0, p) : ret;\r\n    }\r\n\r\n    pack(data:any):string {\r\n        let ret:string[] = [];\r\n        let fields = this.fields;\r\n        if (fields !== undefined) this.packRow(ret, fields, data);\r\n        let arrs = this.arrFields; \r\n        if (arrs !== undefined) {\r\n            for (let arr of arrs) {\r\n\t\t\t\tlet {name, fields} = arr;\r\n\t\t\t\tlet arrData = getObjPropIgnoreCase(data, name);\r\n\t\t\t\t//if (!arrData) arrData = data[name.toLowerCase()];\r\n                this.packArr(ret, fields, arrData);\r\n            }\r\n        }\r\n        return ret.join('');\r\n    }\r\n\r\n    private escape(row:any, field:Field):any {\r\n        let d = row[field.name];\r\n        switch (field.type) {\r\n            case 'datetime':\r\n                return this.buildDateTimeParam(d);\r\n            default:\r\n                switch (typeof d) {\r\n                    default: return d;\r\n                    case 'object':\r\n                        let tuid = field._tuid;\r\n                        if (tuid === undefined) return d.id;\r\n                        return tuid.getIdFromObj(d);\r\n                    case 'string':\r\n                        let len = d.length;\r\n                        let r = '', p = 0;\r\n                        for (let i=0;i<len;i++) {\r\n                            let c:number = d.charCodeAt(i), ch:string;\r\n                            switch(c) {\r\n\t\t\t\t\t\t\t\tdefault: continue;\r\n\t\t\t\t\t\t\t\tcase codeBackSlash: ch = '\\\\\\\\'; break;\r\n                                case codeBT: ch = '\\\\t'; break;\r\n\t\t\t\t\t\t\t\tcase codeBN: ch = '\\\\n'; break;\r\n\t\t\t\t\t\t\t\tcase codeBF: ch = '\\\\f'; break;\r\n\t\t\t\t\t\t\t\tcase codeBV: ch = '\\\\v'; break;\r\n\t\t\t\t\t\t\t\tcase codeBB: ch = '\\\\b'; break;\r\n\t\t\t\t\t\t\t\tcase codeBR: ch = '\\\\r'; break;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tr += d.substring(p, i) + ch;\r\n\t\t\t\t\t\t\tp = i+1;\r\n                        }\r\n                        return r + d.substring(p);\r\n                    case 'undefined': return '';\r\n                }\r\n        }\r\n    }\r\n\r\n    private packRow(result:string[], fields:Field[], data:any) {\r\n        let len = fields.length;\r\n        if (len === 0) return;\r\n        let ret = '';\r\n        ret += this.escape(data, fields[0]);\r\n        for (let i=1;i<len;i++) {\r\n            let f = fields[i];\r\n            ret += tab + this.escape(data, f);\r\n        }\r\n        result.push(ret + ln);\r\n    }\r\n\r\n    private packArr(result:string[], fields:Field[], data:any[]) {\r\n        if (data !== undefined) {\r\n\t\t\tif (data.length === 0) {\r\n\t\t\t\tresult.push(ln);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tfor (let row of data) {\r\n\t\t\t\t\tthis.packRow(result, fields, row);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tresult.push(ln);\r\n\t\t}\r\n        result.push(ln);\r\n    }\r\n    protected cacheFieldsInValue(values:any, fields:Field[]) {\r\n        for (let f of fields as Field[]) {\r\n            let {name, _tuid} = f;\r\n            if (_tuid === undefined) continue;\r\n            let id = values[name];\r\n            //_tuid.useId(id);\r\n            values[name] = _tuid.boxId(id);\r\n        }\r\n    }\r\n\r\n    protected unpackTuidIdsOfFields(values:string[], fields: Field[]):any[] {\r\n        if (fields === undefined) return values as any[];\r\n        //if (this.fields === undefined) return values as any[];\r\n        let ret:any[] = []\r\n        for (let ln of values) {\r\n            if (!ln) continue;\r\n            let len = ln.length;\r\n            let p = 0;\r\n            while (p<len) {\r\n                let ch = ln.charCodeAt(p);\r\n                if (ch === 10) {\r\n                    ++p;\r\n                    break;\r\n                }\r\n                let row = {};\r\n                p = this.unpackRow(row, fields, ln, p);\r\n                ret.push(row);\r\n            }\r\n        }\r\n        return ret;\r\n    }\r\n\r\n    unpackSheet(data:string):any {\r\n        let ret = {} as any; //new this.newMain();\r\n        //if (schema === undefined || data === undefined) return;\r\n        let fields = this.fields;\r\n        let p = 0;\r\n        if (fields !== undefined) p = this.unpackRow(ret, fields, data, p);\r\n        let arrs = this.arrFields; //schema['arrs'];\r\n        if (arrs !== undefined) {\r\n            for (let arr of arrs) {\r\n                p = this.unpackArr(ret, arr, data, p);\r\n            }\r\n        }\r\n        return ret;\r\n    }\r\n\r\n\tunpackReturns(data:string, returns?:ArrFields[]):{[name:string]:any[]} {\r\n\t\tif (data === undefined) debugger;\r\n\t\tlet ret = {} as any;\r\n\t\tlet p = 0;\r\n\t\tlet arrs = returns || this.returns;\r\n\t\tif (arrs !== undefined) {\r\n\t\t\tfor (let arr of arrs) {\r\n\t\t\t\tp = this.unpackArr(ret, arr, data, p);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn ret;\r\n\t}\r\n\r\n    protected unpackRow(ret:any, fields:Field[], data:string, p:number):number {\r\n        let ch0 = 0, ch = 0, c = p, i = 0, len = data.length, fLen = fields.length;\r\n        for (;p<len;p++) {\r\n            ch0 = ch;\r\n            ch = data.charCodeAt(p);\r\n            if (ch === 9) {\r\n                let f = fields[i];\r\n                let {name} = f;\r\n                if (ch0 !== 8) {\r\n                    if (p>c) {\r\n                        let v = data.substring(c, p);\r\n                        ret[name] = this.to(ret, v, f);\r\n                    }\r\n                }\r\n                else {\r\n                    ret[name] = null;\r\n                }\r\n                c = p+1;\r\n                ++i;\r\n                if (i>=fLen) {\r\n                    p = data.indexOf('\\n', c);\r\n                    if (p >= 0) ++p;\r\n                    else p = len;\r\n                    return p;\r\n                }\r\n            }\r\n            else if (ch === 10) {\r\n                let f = fields[i];\r\n                let {name} = f;\r\n                if (ch0 !== 8) {\r\n                    if (p>c) {\r\n                        let v = data.substring(c, p);\r\n                        ret[name] = this.to(ret, v, f);\r\n                    }\r\n                }\r\n                else {\r\n                    ret[name] = null;\r\n                }\r\n                ++p;\r\n                ++i;\r\n                return p;\r\n            }\r\n        }\r\n        let f = fields[i];\r\n        let {name} = f;\r\n        if (ch0 !== 8) {\r\n            let v = data.substring(c);\r\n            ret[name] = this.to(ret, v, f);\r\n        }\r\n        return len;\r\n    }\r\n\r\n    private to(ret:any, v:string, f:Field):any {\r\n        switch (f.type) {\r\n\t\t\tdefault: return v;\r\n\t\t\tcase 'text':\r\n\t\t\tcase 'char':\r\n\t\t\t\treturn this.reverseNT(v);\r\n            case 'datetime':\r\n            case 'time':\r\n\t\t\tcase 'timestamp':\r\n                let n = Number(v);\r\n                let date = isNaN(n) === true? new Date(v) : new Date(n*1000);\r\n                return date;\r\n            case 'date':\r\n                let parts = v.split('-');\r\n                return new Date(Number(parts[0]), Number(parts[1])-1, Number(parts[2]));\r\n            case 'tinyint':\r\n            case 'smallint':\r\n            case 'int':\r\n            case 'bigint':\r\n            case 'dec':\r\n                return Number(v);\r\n            case 'id':\r\n                let id = Number(v);\r\n                let {_tuid} = f;\r\n                if (_tuid === undefined) return id;\r\n                return _tuid.boxId(id);\r\n        }\r\n\t}\r\n\t\r\n\tprivate reverseNT(text:string):string {\r\n\t\tif (text === undefined) return;\r\n\t\tif (text === null) return;\r\n\t\tlet len = text.length;\r\n\t\tlet r = '';\r\n\t\tlet p = 0;\r\n\t\tfor (let i=0; i<len; i++) {\r\n\t\t\tlet c = text.charCodeAt(i);\r\n\t\t\tif (c === codeBackSlash) {\r\n\t\t\t\tif (i===len-1) break;\r\n\t\t\t\tlet c1 = text.charCodeAt(i+1);\r\n\t\t\t\tlet ch:string;\r\n\t\t\t\tswitch (c1) {\r\n\t\t\t\t\tdefault: continue;\r\n\t\t\t\t\tcase codeBackSlash: ch = '\\\\'; break;\r\n\t\t\t\t\tcase codeN: ch = '\\n'; break;\r\n\t\t\t\t\tcase codeT: ch = '\\t'; break;\r\n\t\t\t\t\tcase codeB: ch = '\\b'; break;\r\n\t\t\t\t\tcase codeF: ch = '\\f'; break;\r\n\t\t\t\t\tcase codeV: ch = '\\v'; break;\r\n\t\t\t\t\tcase codeR: ch = '\\r'; break;\r\n\t\t\t\t}\r\n\t\t\t\tr += text.substring(p, i) + ch;\r\n\t\t\t\tp = i+2;\r\n\t\t\t\t++i;\r\n\t\t\t}\r\n\t\t}\r\n\t\tr += text.substring(p, len);\r\n\t\treturn r;\r\n\t}\r\n\r\n    private unpackArr(ret:any, arr:ArrFields, data:string, p:number):number {\r\n\t\tlet p0 = p;\r\n        let vals:any[] = [], len = data.length;\r\n        let {name, fields} = arr;\r\n        while (p<len) {\r\n            let ch = data.charCodeAt(p);\r\n            if (ch === 10) {\r\n\t\t\t\tif (p === p0) {\r\n\t\t\t\t\tch = data.charCodeAt(p);\r\n\t\t\t\t\tif (ch !== 10) {\r\n\t\t\t\t\t\tthrow new Error('upackArr: arr第一个字符是10，则必须紧跟一个10，表示整个arr的结束')\r\n\t\t\t\t\t}\r\n\t\t\t\t\t++p;\r\n\t\t\t\t}\r\n                ++p;\r\n                break;\r\n            }\r\n            let val = {} as any; //new creater();\r\n            vals.push(val);\r\n            p = this.unpackRow(val, fields, data, p);\r\n        }\r\n        ret[name] = vals;\r\n        return p;\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport { ItemSchema, UiItem, UiSelectBase } from '../schema';\r\nimport { nav } from '../nav';\r\nimport { makeObservable, observable } from 'mobx';\r\nimport { FieldRule } from '../form/rules';\r\nimport { Image } from '../image';\r\nimport { Edit } from './edit';\r\n\r\nexport abstract class ItemEdit {\r\n\tprotected edit: Edit;\r\n\tprotected name: string;\r\n\tprotected _itemSchema: ItemSchema;\r\n    get itemSchema(): ItemSchema {return this._itemSchema}\r\n    protected _uiItem:UiItem;\r\n    get uiItem():UiItem {return this._uiItem}\r\n    value: any;\r\n\tlabel: string|JSX.Element;\r\n\tget editInRow(): boolean {return false;}\r\n    protected newValue: any;\r\n\r\n    error: string = null;\r\n    isChanged: boolean = false;\r\n\r\n    constructor(edit:Edit, itemSchema: ItemSchema, uiItem:UiItem, label:string|JSX.Element, value: any) {\r\n\t\tmakeObservable(this, {\r\n\t\t\terror: observable,\r\n\t\t\tisChanged: observable,\r\n\t\t});\r\n\t\tthis.edit = edit;\r\n        this._itemSchema = itemSchema;\r\n        this._uiItem = uiItem\r\n        this.value = value;\r\n        let {name} = itemSchema;\r\n        this.name = name;\r\n        this.label = label;\r\n\t}\r\n\t\r\n\tinit() {\t\t\r\n\t}\r\n\r\n    async start():Promise<any> {\r\n        return await this.internalStart();\r\n    }\r\n\r\n    protected abstract internalStart():Promise<any>;\r\n\r\n    async end():Promise<any> {\r\n        await this.internalEnd()\r\n    }\r\n\r\n\trenderContent() {\r\n        let {name, type} = this._itemSchema;\r\n        let divValue:any;\r\n        let uiItem = this._uiItem;\r\n        let label:string|JSX.Element, labelHide:boolean;\r\n        if (uiItem === undefined) {\r\n            label = name;\r\n        }\r\n        else {\r\n\t\t\tlabel = uiItem.label;\r\n\t\t\tlabelHide = uiItem.labelHide;\r\n            let templet = uiItem.Templet;\r\n            if (templet !== undefined) {\r\n                if (typeof templet === 'function') {\r\n\t\t\t\t\tif (this.value !== undefined) divValue = templet(this.value);\r\n\t\t\t\t}\r\n                else {\r\n\t\t\t\t\tdivValue = {templet};\r\n\t\t\t\t}\r\n            }\r\n            else if (this.value !== undefined) {\r\n                switch (uiItem.widget) {\r\n                    case 'radio':\r\n                    case 'select':\r\n                        let {list} = uiItem as UiSelectBase;\r\n                        divValue = <b>{list.find(v => v.value === this.value).title}</b>;\r\n                        break;\r\n                    case 'id':\r\n                        divValue = <b>no templet for {name}={this.value}</b>\r\n                        break;\r\n                }\r\n            }\r\n        }\r\n        if (divValue === undefined) {\r\n            switch (type) {\r\n                default:\r\n                    divValue = this.value? \r\n\t\t\t\t\t\t<b>{this.value}</b> \r\n\t\t\t\t\t\t:\r\n\t\t\t\t\t\t<small className=\"text-muted\">[{labelHide===true? label:'无'}]</small>;\r\n                    break;\r\n                case 'image':\r\n                    divValue = <Image className=\"w-4c h-4c\" src={this.value} />;\r\n                    break;\r\n            }\r\n\t\t}\r\n\t\treturn divValue;\r\n\t}\r\n\r\n    protected async internalEnd():Promise<void> {nav.pop()}\r\n\r\n    protected verifyValue() {\r\n        if (this.uiItem === undefined) return;\r\n        let {rules} = this.uiItem;\r\n        if (rules === undefined) return;\r\n        let nv = this.newValue;\r\n        function verifyRule(rule:FieldRule, value: any):string {\r\n            let error = rule(nv);\r\n            if (error !== undefined) {\r\n                if (typeof error !== 'object')\r\n                    return error;\r\n                else\r\n                    return JSON.stringify(error);\r\n            }\r\n        }\r\n        if (Array.isArray(rules)) {\r\n            for (let rule of rules) {\r\n                let error = verifyRule(rule as FieldRule, nv);\r\n                if (error !== undefined) {\r\n                    this.error = error;\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            this.error = verifyRule(rules as FieldRule, nv);\r\n        }\r\n    }\r\n}\r\n","//import _ from 'lodash';\r\nimport { KeyValueRes, Res } from './res';\r\n\r\nexport interface FormRes extends KeyValueRes {\r\n    required: string;\r\n    number: string;\r\n    integer: string;\r\n    min: string;\r\n    max: string;\r\n}\r\n\r\n/*eslint no-template-curly-in-string: 0*/\r\nexport const formRes:Res<FormRes> = {\r\n    _: {\r\n        required: 'required',\r\n        number: 'not valid number',\r\n        integer: 'not valid integer',\r\n        min: 'min value is ${min}',\r\n        max: 'max value is ${max}',\r\n    },\r\n    zh: {\r\n        _: {\r\n            required: '必须填',\r\n            number: '需要数字',\r\n            integer: '需要整数',\r\n            min: '不能小于${min}',\r\n            max: '不能大于${max}',\r\n        }\r\n    },\r\n}\r\n","import { KeyValueRes, Res } from './res';\r\n\r\nexport interface ListRes extends KeyValueRes {\r\n    none: string;\r\n}\r\n\r\n/*eslint no-template-curly-in-string: 0*/\r\nexport const listRes:Res<ListRes> = {\r\n    _: {\r\n        none: '[none]',\r\n    },\r\n    zh: {\r\n        _: {\r\n            none: '[无]',\r\n        }\r\n    },\r\n}\r\n","//import _ from 'lodash';\r\nimport { Caller } from '../net';\r\nimport { Entity } from './entity';\r\nimport { Action } from './action';\r\nimport { Query } from './query';\r\n\r\ninterface UqResponseSchema {\r\n    uq: any;\r\n    entity: any;\r\n}\r\n\r\nexport abstract class EntityCaller<T> extends Caller<T> {\r\n    private tries: number;\r\n    protected _entity: Entity;\r\n\r\n    constructor(entity: Entity, params:T, waiting: boolean = true) {\r\n        super(params, waiting);\r\n        this.tries = 0;\r\n        this._entity = entity;\r\n    }\r\n\r\n    protected get entity(): Entity {return this._entity;}\r\n\r\n    //大多的entityCaller都不需要这个\r\n    //buildParams() {return this.entity.buildParams(this.params);}\r\n    \r\n    async request(): Promise<any> {\r\n        await this.entity.loadSchema();\r\n        let ret = await this.innerRequest();\r\n        return ret;\r\n    }\r\n\r\n    protected async innerCall(): Promise<any> {\r\n        return await this.entity.uqApi.xcall(this);\r\n    }\r\n\r\n    async innerRequest(): Promise<any> {\r\n        let jsonResult = await this.innerCall();\r\n        let {$uq, $modify, res} = jsonResult;\r\n        this.entity.uq.pullModify($modify);\r\n        if ($uq === undefined) {\r\n            //if (res === undefined) debugger;\r\n            let ret = this.xresult(res);\r\n            //if (ret === undefined) debugger;\r\n            return ret;\r\n        }\r\n        return await this.retry($uq);\r\n    }\r\n\r\n    xresult(res:any):any {return res}\r\n\r\n    get headers(): {[header:string]: string} {\r\n        let {ver, uq} = this.entity;\r\n        let {uqVersion} = uq;\r\n        return {\r\n            uq: `${uqVersion}`,\r\n            en: `${ver}`,\r\n        }\r\n    }\r\n\r\n    private async retry(schema: UqResponseSchema) {\r\n        ++this.tries;\r\n        if (this.tries > 5) throw new Error('can not get right uq response schema, 5 tries');\r\n        this.rebuildSchema(schema);\r\n        return await this.innerRequest();\r\n    }\r\n\r\n    private rebuildSchema(schema: UqResponseSchema) {\r\n        let {uq, entity} = schema;\r\n        if (uq !== undefined) {\r\n\t\t\tthis.entity.uq.buildEntities(uq);\r\n\t\t}\r\n        if (entity !== undefined) {\r\n\t\t\tthis.entity.setSchema(entity);\r\n\t\t}\r\n    }\r\n}\r\n\r\nexport abstract class ActionCaller extends EntityCaller<any> {\r\n    protected get entity(): Action {return this._entity as Action;}\r\n}\r\n\r\nexport class QueryQueryCaller extends EntityCaller<any> {\r\n    protected get entity(): Query {return this._entity as Query};\r\n    get path():string {return `query/${this.entity.name}`;}\r\n    xresult(res:any) {\r\n        let data = this.entity.unpackReturns(res);\r\n        return data;\r\n    }\r\n    buildParams() {return this.entity.buildParams(this.params);}\r\n}\r\n\r\nexport class QueryPageCaller extends EntityCaller<any> {\r\n    protected get params(): {pageStart:any; pageSize:number, params:any} {return this._params};\r\n\tprotected get entity(): Query {return this._entity as Query};\r\n\t//results: {[name:string]:any[]};\r\n\tget path():string {return `query-page/${this.entity.name}`;}\t\r\n    buildParams() {\r\n        let {pageStart, pageSize, params} = this.params;\r\n        let p:any;\r\n        if (params === undefined) {\r\n            p = {key: ''};\r\n        }\r\n        else {\r\n            p = this.entity.buildParams(params);\r\n        }\r\n        /*\r\n        switch (typeof params) {\r\n            case 'undefined': p = {key: ''}; break;\r\n            default: p = _.clone(params); break;\r\n        }\r\n        */\r\n        p['$pageStart'] = pageStart;\r\n        p['$pageSize'] = pageSize;\r\n        return p;\r\n    };\r\n    xresult(res:any): {[name:string]:any[]} {\r\n        let ret = this.entity.unpackReturns(res);\r\n\t\t//return this.results.$page;// as any[];\r\n\t\treturn ret;\r\n    }\r\n}\r\n","import { PageItems } from \"tonva-react\";\r\nimport { IDBase } from \"../base\";\r\n\r\nexport type IDItemsPageLoader<T> = (pageStart:any, pageSize:number) => Promise<T[]>;\r\nexport type HistoryPageLoader<T> = (id:number, field:string, far:number, near:number, pageStart:any, pageSize:number) => Promise<T[]>;\r\n\r\nexport abstract class ListPageItems<T> extends PageItems<T> {\r\n\tprivate pageLoader: IDItemsPageLoader<T>;\r\n\tconstructor(pageLoader: IDItemsPageLoader<T>) {\r\n\t\tsuper(true);\r\n\t\tthis.pageLoader = pageLoader;\r\n\t}\r\n\r\n\tasync loadResults(param:any, pageStart:any, pageSize:number): Promise<{[name:string]:any[]}> {\r\n\t\tlet ret = await this.pageLoader(pageStart, pageSize);\r\n\t\treturn {$page:ret};\r\n\t}\r\n\r\n\tabstract update(item: T): Promise<void>;\r\n}\r\n\r\nexport class HistoryPageItems<T extends IDBase> extends PageItems<T> {\r\n\tprivate pageLoader: HistoryPageLoader<T>;\r\n\tconstructor(pageLoader: HistoryPageLoader<T>) {\r\n\t\tsuper(true);\r\n\t\tthis.pageLoader = pageLoader;\r\n\t}\r\n\r\n\tasync loadResults(param:any, pageStart:any, pageSize:number): Promise<{[name:string]:any[]}> {\r\n\t\tlet {id, field, far, near} = param;\r\n\t\tlet ret = await this.pageLoader(id, field, far, near, pageStart, pageSize);\r\n\t\treturn {$page:ret};\r\n\t}\r\n\r\n\tupdate(item: T): Promise<void> {return;}\r\n}\r\n","import { env } from \"tonva-react\";\r\n\r\nexport abstract class TimeSpan {\r\n\tstatic create(span: 'day' | 'week' | 'month' | 'year'):TimeSpan {\r\n\t\tlet ret:TimeSpan;\r\n\t\tswitch (span) {\r\n\t\t\tcase 'day': ret = new DaySpan(); break;\r\n\t\t\tcase 'week': ret = new WeekSpan(); break;\r\n\t\t\tcase 'month': ret = new MonthSpan(); break;\r\n\t\t\tcase 'year': ret = new YearSpan(); break;\r\n\t\t}\r\n\t\treturn ret;\r\n\t}\r\n\tprotected firstNear: number;\r\n\tfar: number;\r\n\tnear: number;\r\n\ttype: string;\r\n\r\n\tabstract prev():void;\r\n\tabstract next():void;\r\n\tabstract get title():string;\r\n\tabstract get labels():string[];\r\n\tprotected abstract getDayArray(): Date[];\r\n\r\n\tget canNext():boolean {\r\n\t\treturn this.near < this.firstNear;\r\n\t}\r\n\tget canPrev():boolean {return true;}\r\n\r\n\tgetDayValues(dayValues:{t:string;v:number}[]): number[] {\r\n\t\tlet days = this.getDayArray();\r\n\t\tlet ret:number[] = [];\r\n\t\tlet i = 0;\r\n\t\tlet dv = dayValues[i++];\r\n\t\tfor (let day of days) {\r\n\t\t\tif (dv) {\r\n\t\t\t\tlet {t, v} = dv;\r\n\t\t\t\tlet d = new Date(t);\r\n\t\t\t\td.setMinutes(d.getMinutes() + d.getTimezoneOffset());\r\n\t\t\t\tif (d.getTime() === day.getTime()) {\r\n\t\t\t\t\tret.push(v);\r\n\t\t\t\t\tdv = dayValues[i++];\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tret.push(0);\r\n\t\t}\r\n\t\treturn ret;\r\n\t}\r\n}\r\n\r\nclass DaySpan extends TimeSpan {\r\n\tprivate date: Date;\r\n\tprivate readonly _labels:string[] = [];\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\tthis.type = 'day';\r\n\t\tthis.date = new Date();\r\n\t\tthis.date.setHours(0, 0, 0, 0);\r\n\t\tthis.far = this.date.getTime();\r\n\t\tthis.firstNear = this.near = this.far + 24 * 3600 * 1000;\r\n\t\tfor (let i=0; i<24; i++) this._labels.push(i + ':00');\r\n\t}\r\n\tprev():void {\r\n\t\tthis.far -= 24 * 3600 * 1000;\r\n\t\tthis.near -= 24 * 3600 * 1000;\r\n\t}\r\n\tnext():void {\r\n\t\tthis.far += 24 * 3600 * 1000;\r\n\t\tthis.near += 24 * 3600 * 1000;\r\n\t}\r\n\tget title():string {\r\n\t\treturn this.date.toLocaleDateString();\r\n\t}\r\n\tget labels():string[] {return this._labels}\r\n\tprotected getDayArray(): Date[] {return [this.date]};\r\n}\r\n\r\n\r\nconst enWeek = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'];\r\nconst zhWeek = ['一', '二', '三', '四', '五', '六', '日', ];\r\nclass WeekSpan extends TimeSpan {\r\n\tprivate firstDay: Date;\r\n\tprivate lastDay: Date;\r\n\tprivate readonly _labels:string[];\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\tthis.type = 'week';\r\n\t\tthis.firstDay = new Date();\r\n\t\tthis.firstDay.setHours(0, 0, 0, 0);\r\n\t\tlet day = this.firstDay.getDay() || 7; // Get current day number, converting Sun. to 7\r\n\t\tif (day !== 1) {                // Only manipulate the date if it isn't Mon.\r\n\t\t\tthis.firstDay.setHours(-24 * (day - 1));   // Set the hours to day number minus 1\r\n\t\t}\r\n\t\tthis.far = this.firstDay.getTime();\r\n\t\tthis.firstNear = this.near = this.far + 7 * 24 * 3600 * 1000;\r\n\t\tthis.lastDay = new Date();\r\n\t\tthis.lastDay.setDate(this.firstDay.getDate()+7);\r\n\t\tswitch (env.lang) {\r\n\t\t\tdefault:\r\n\t\t\tcase 'en': this._labels = enWeek; break;\r\n\t\t\tcase 'zh': this._labels = zhWeek; break;\r\n\t\t}\r\n\t}\r\n\tprev():void {\r\n\t\tthis.firstDay.setDate(this.firstDay.getDate()-7);\r\n\t\tthis.lastDay.setDate(this.lastDay.getDate()-7);\r\n\t\tthis.far -= 7 * 24 * 3600 * 1000;\r\n\t\tthis.near -= 7 * 24 * 3600 * 1000;\r\n\t}\r\n\tnext():void {\r\n\t\tthis.firstDay.setDate(this.firstDay.getDate()+7);\r\n\t\tthis.lastDay.setDate(this.lastDay.getDate()+7);\r\n\t\tthis.far += 7 * 24 * 3600 * 1000;\r\n\t\tthis.near += 7 * 24 * 3600 * 1000;\r\n\t}\r\n\tget title():string {\r\n\t\treturn this.firstDay.toLocaleDateString();\r\n\t}\r\n\tget labels():string[] {return this._labels}\r\n\tprotected getDayArray(): Date[] {\r\n\t\tlet d = new Date(this.firstDay);\r\n\t\tlet ret: Date[] = [this.firstDay];\r\n\t\tfor (;;) {\r\n\t\t\td.setDate(d.getDate() + 1);\r\n\t\t\tif (d >= this.lastDay) break;\r\n\t\t\tret.push(new Date(d));\r\n\t\t}\r\n\t\treturn ret;\r\n\t}\r\n}\r\n\r\nclass MonthSpan extends TimeSpan {\r\n\tprivate firstDay: Date;\r\n\tprivate lastDay: Date;\r\n\tprivate _labels:string[];\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\tthis.type = 'month';\r\n\t\tlet date = new Date();\r\n\t\tthis.initFromDate(date);\r\n\t\tthis.firstNear = this.near;\r\n\t}\r\n\tprivate initFromDate(date: Date) {\r\n\t\tlet year = date.getFullYear(), month = date.getMonth();\r\n\t\tthis.firstDay = new Date(year, month, 1);\r\n\t\tthis.lastDay = new Date(year, month + 1, 0);\r\n\t\tthis.far = this.firstDay.getTime();\r\n\t\tthis.near = new Date(year, month+1, 1).getTime();\r\n\t\tthis._labels = [];\r\n\t\tlet count = this.lastDay.getDate();\r\n\t\tfor (let i=1; i<=count; i++) this._labels.push(String(i));\r\n\t}\r\n\tprev():void {\r\n\t\tlet date = new Date(this.firstDay.setMonth(this.firstDay.getMonth() - 1));\r\n\t\tthis.initFromDate(date);\r\n\t}\r\n\tnext():void {\r\n\t\tlet date = new Date(this.firstDay.setMonth(this.firstDay.getMonth() + 1));\r\n\t\tthis.initFromDate(date);\r\n\t}\r\n\tget title():string {\r\n\t\treturn this.firstDay.toLocaleDateString();\r\n\t}\r\n\tget labels():string[] {return this._labels}\r\n\tprotected getDayArray(): Date[] {\r\n\t\tlet d = new Date(this.firstDay);\r\n\t\tlet ret: Date[] = [this.firstDay];\r\n\t\tfor (;;) {\r\n\t\t\td.setDate(d.getDate() + 1);\r\n\t\t\tif (d >= this.lastDay) break;\r\n\t\t\tret.push(new Date(d));\r\n\t\t}\r\n\t\treturn ret;\r\n\t}\r\n}\r\n\r\nclass YearSpan extends TimeSpan {\r\n\tprivate firstDay: Date;\r\n\tprivate lastDay: Date;\r\n\tprivate readonly _labels:string[] = [];\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\tthis.type = 'year';\r\n\t\tlet date = new Date();\r\n\t\tthis.initFromDate(date);\r\n\t\tthis.firstNear = this.near;\r\n\t\tfor (let i=0; i<=12; i++) this._labels.push(String(i));\r\n\t}\r\n\tprivate initFromDate(date: Date) {\r\n\t\tlet year = date.getFullYear(), month = 0;\r\n\t\tthis.firstDay = new Date(year, month, 1);\r\n\t\tthis.lastDay = new Date(year, month + 1, 0);\r\n\t\tthis.far = this.firstDay.getTime();\r\n\t\tthis.near = new Date(year, month+1, 1).getTime();\r\n\t}\r\n\tprev():void {\r\n\t\tlet date = new Date(this.firstDay.setMonth(this.firstDay.getMonth() - 1));\r\n\t\tthis.initFromDate(date);\r\n\t}\r\n\tnext():void {\r\n\t\tlet date = new Date(this.firstDay.setMonth(this.firstDay.getMonth() + 1));\r\n\t\tthis.initFromDate(date);\r\n\t}\r\n\tget title():string {\r\n\t\treturn this.firstDay.toLocaleDateString();\r\n\t}\r\n\tget labels():string[] {return this._labels}\r\n\tprotected getDayArray(): Date[] {\r\n\t\tlet d = new Date(this.firstDay);\r\n\t\tlet ret: Date[] = [this.firstDay];\r\n\t\tfor (;;) {\r\n\t\t\td.setDate(d.getDate() + 1);\r\n\t\t\tif (d >= this.lastDay) break;\r\n\t\t\tret.push(new Date(d));\r\n\t\t}\r\n\t\treturn ret;\r\n\t}\r\n}\r\n","import { FA } from \"tonva-react\";\r\n\r\nexport function listRight(onClick: () => any): JSX.Element {\r\n\treturn <button className=\"btn btn-sm btn-success mr-2\" onClick={onClick}>\r\n\t\t<FA name=\"plus\" />\r\n\t</button>\r\n}\r\n\r\nexport function renderItem(item:any, index:number) {\r\n\treturn <>{JSON.stringify(item)}</>;\r\n}\r\n\r\nexport function renderItemContainer(content:any) {\r\n\treturn <div className=\"px-3 py-2\">\r\n\t\t{content}\r\n\t</div>;\r\n}\r\n","export * from './Mid';\r\nexport * from './IDBase';\r\n","import {bridgeCenterApi, isBridged} from './appBridge';\r\nimport {FetchError} from './fetchError';\r\nimport {HttpChannelUI} from './httpChannelUI';\r\nimport {nav} from '../components/nav';\r\nimport { Caller } from './caller';\r\nimport { env } from '../tool';\r\n\r\n/*\r\nexport async function httpGet(url:string, params?:any):Promise<any> {\r\n    let channel = new HttpChannel(false, url, undefined, undefined);\r\n    let ret = await channel.get('', params);\r\n    return ret;\r\n}\r\n\r\nexport async function httpPost(url:string, params?:any):Promise<any> {\r\n    let channel = new HttpChannel(false, url, undefined, undefined);\r\n    let ret = await channel.post('', params);\r\n    return ret;\r\n}\r\n*/\r\n\r\nconst methodsWithBody = ['POST', 'PUT'];\r\n\r\nexport abstract class HttpChannel {\r\n    private timeout: number;\r\n    protected ui?: HttpChannelUI;\r\n    protected hostUrl: string;\r\n    protected apiToken: string;\r\n\r\n    constructor(hostUrl: string, apiToken:string, ui?: HttpChannelUI) {\r\n        this.hostUrl = hostUrl;\r\n        this.apiToken = apiToken;\r\n        this.ui = ui;\r\n        this.timeout = env.isDevelopment === true? 500000:50000;\r\n    }\r\n\r\n    private startWait = (waiting: boolean) => {\r\n        if (waiting === true) {\r\n            if (this.ui !== undefined) this.ui.startWait();\r\n        }\r\n    }\r\n\r\n    private endWait = (url?:string, reject?:(reason?:any)=>void) => {\r\n        if (this.ui !== undefined) this.ui.endWait();\r\n        if (reject !== undefined) reject('访问webapi超时 ' + url);\r\n    }\r\n\r\n    private showError = async (error:FetchError) => {\r\n        if (this.ui !== undefined) await this.ui.showError(error);\r\n    }\r\n\r\n    used() {\r\n        this.post('', {});\r\n    }\r\n\r\n    async xcall(urlPrefix:string, caller:Caller<any>): Promise<void> {\r\n        let options = this.buildOptions();\r\n        let {headers, path, method} = caller;\r\n        if (headers !== undefined) {\r\n            let h = options.headers;\r\n            for (let i in headers) {\r\n\t\t\t\t//h.append(i, encodeURI(headers[i]));\r\n\t\t\t\th[i] = encodeURI(headers[i]);\r\n            }\r\n        }\r\n        options.method = method;\r\n        let p = caller.buildParams();\r\n        if (methodsWithBody.indexOf(method) >= 0 && p !== undefined) {\r\n            options.body = JSON.stringify(p)\r\n        }\r\n        return await this.innerFetch(urlPrefix + path, options, caller.waiting);\r\n    }\r\n\r\n    private async innerFetchResult(url: string, options: any, waiting: boolean): Promise<any> {\r\n        let ret = await this.innerFetch(url, options, waiting);\r\n        return ret.res;\r\n    }\r\n\r\n    async get(url: string, params: any = undefined, waiting?: boolean): Promise<any> {\r\n        if (params) {\r\n            let keys = Object.keys(params);\r\n            if (keys.length > 0) {\r\n                let c = '?';\r\n                for (let k of keys) {\r\n                    let v = params[k];\r\n                    if (v === undefined) continue;\r\n                    url += c + k + '=' + params[k];\r\n                    c = '&';\r\n                }\r\n            }\r\n        }\r\n        let options = this.buildOptions();\r\n        options.method = 'GET';\r\n        return await this.innerFetchResult(url, options, waiting);\r\n    }\r\n\r\n    async post(url: string, params: any, waiting?: boolean): Promise<any> {\r\n        let options = this.buildOptions();\r\n        options.method = 'POST';\r\n        options.body = JSON.stringify(params);\r\n        return await this.innerFetchResult(url, options, waiting);\r\n    }\r\n\r\n    async put(url: string, params: any, waiting?: boolean): Promise<any> {\r\n        let options = this.buildOptions();\r\n        options.method = 'PUT';\r\n        options.body = JSON.stringify(params);\r\n        return await this.innerFetchResult(url, options, waiting);\r\n    }\r\n\r\n    async delete(url: string, params: any, waiting?: boolean): Promise<any> {\r\n        let options = this.buildOptions();\r\n        options.method = 'DELETE';\r\n        options.body = JSON.stringify(params);\r\n        return await this.innerFetchResult(url, options, waiting);\r\n    }\r\n    async fetch(url: string, options: any, waiting: boolean, resolve:(value?:any)=>any, reject:(reason?:any)=>void):Promise<void> {\r\n        let that = this;\r\n        this.startWait(waiting);\r\n        let path = url;\r\n        function buildError(err: any, ex?: string) {\r\n            switch (typeof err) {\r\n                case 'string':\r\n                    if (ex !== undefined) err += ' ' + ex;\r\n                    break;\r\n                case 'object':\r\n                    let keys = Object.keys(err);\r\n                    let retErr:any = {\r\n                        ex: ex,\r\n                    };\r\n                    for (let key of keys) {\r\n                        retErr[key] = err[key];\r\n                    }\r\n                    err = retErr;\r\n                    break;\r\n            }\r\n            return {\r\n                channel: that,\r\n                url: path,\r\n                options: options,\r\n                resolve: resolve,\r\n                reject: reject,\r\n                error: err,\r\n            }\r\n        }\r\n        try {\r\n            console.log('%s-%s %s', options.method, path, options.body || '');\r\n            let now = Date.now();\r\n            let timeOutHandler = env.setTimeout(\r\n                undefined, //'httpChannel.fetch',\r\n                () => {\r\n                    that.endWait(url + ' timeout endWait: ' + (Date.now() - now) + 'ms', reject);\r\n                },\r\n                this.timeout);\r\n            let res = await fetch(encodeURI(path), options);\r\n            if (res.ok === false) {\r\n                env.clearTimeout(timeOutHandler);\r\n                console.log('ok false endWait');       \r\n                that.endWait();\r\n                console.log('call error %s', res.statusText);\r\n                throw res.statusText;\r\n            }\r\n            let ct = res.headers.get('content-type');\r\n            if (ct && ct.indexOf('json')>=0) {\r\n                return res.json().then(async retJson => {\r\n                    env.clearTimeout(timeOutHandler);\r\n                    that.endWait();\r\n                    if (retJson.ok === true) {\r\n                        if (typeof retJson !== 'object') {\r\n                            debugger;\r\n                        }\r\n                        else if (Array.isArray(retJson) === true) {\r\n                            debugger;\r\n                        }\r\n                        return resolve(retJson);\r\n                    }\r\n                    let retError = retJson.error;\r\n                    if (retError === undefined) {\r\n                        await that.showError(buildError('not valid tonva json'));\r\n                    }\r\n                    else {\r\n                        await that.showError(buildError(retError, 'retJson.error'));\r\n                        reject(retError);\r\n                    }\r\n                }).catch(async error => {\r\n                    await that.showError(buildError(error, 'catch res.json()'));\r\n                });\r\n            }\r\n            else {\r\n                let text = await res.text();\r\n                env.clearTimeout(timeOutHandler);\r\n                console.log('text endWait');\r\n                that.endWait();\r\n                resolve(text);\r\n            }\r\n        }\r\n        catch(error) {\r\n            this.endWait(url, reject);\r\n            if (typeof error === 'string') {\r\n                let err = error.toLowerCase();\r\n                if (err.startsWith('unauthorized') === true || err.startsWith('$roles') === true) {\r\n                    nav.logout();\r\n                    return;\r\n                }\r\n            }\r\n            console.error('fecth error (no nav.showError): ' + url);\r\n        };\r\n    }\r\n\r\n    protected abstract innerFetch(url: string, options: any, waiting: boolean): Promise<any>;\r\n\r\n    async callFetch(url:string, method:string, body:any):Promise<any> {\r\n        let options = this.buildOptions();\r\n        options.method = method;\r\n        options.body = body;\r\n        return await new Promise<any>(async (resolve, reject) => {\r\n            await this.fetch(url, options, true, resolve, reject);\r\n        });\r\n    }\r\n\r\n    //private buildOptions(): {method:string; headers:Headers; body:any} {\r\n\t\tprivate buildOptions(): {method:string; headers:{[name:string]: string}; body:any} {\r\n        let headers = this.buildHeaders();\r\n        let options = {\r\n            headers: headers,\r\n            method: undefined as any,\r\n            body: undefined as any,\r\n            // cache: 'no-cache',\r\n        };\r\n        return options;\r\n    }\r\n\r\n\t/*\r\n    protected buildHeaders():Headers {\r\n        let {language, culture} = nav;\r\n        let headers = new Headers();\r\n        //headers.append('Access-Control-Allow-Origin', '*');\r\n        headers.append('Content-Type', 'application/json;charset=UTF-8');\r\n        let lang = language;\r\n        if (culture) lang += '-' + culture;\r\n        headers.append('Accept-Language', lang);\r\n        if (this.apiToken) { \r\n            headers.append('Authorization', this.apiToken); \r\n        }\r\n        return headers;\r\n\t}\r\n\t*/\r\n\tprotected buildHeaders():{[name:string]: string} { \r\n        let {language, culture} = nav;\r\n        let headers:{[name:string]: string} = {}; //new Headers();\r\n        //headers.append('Access-Control-Allow-Origin', '*');\r\n\t\t//headers.append('Content-Type', 'application/json;charset=UTF-8');\r\n\t\theaders['Content-Type'] = 'application/json;charset=UTF-8';\r\n        let lang = language;\r\n        if (culture) lang += '-' + culture;\r\n\t\t//headers.append('Accept-Language', lang);\r\n\t\theaders['Accept-Language'] = lang;\r\n        if (this.apiToken) { \r\n\t\t\t//headers.append('Authorization', this.apiToken); \r\n\t\t\theaders['Authorization'] = this.apiToken;\r\n        }\r\n        return headers;\r\n\t}\r\n}\r\n\r\nexport class CenterHttpChannel extends HttpChannel {\r\n    protected async innerFetch(url: string, options: any, waiting: boolean): Promise<any> {\r\n        let u = this.hostUrl + url;\r\n        if (this.apiToken === undefined && isBridged())\r\n            return await bridgeCenterApi(u, options.method, options.body);\r\n        return await new Promise<any>(async (resolve, reject) => {\r\n            await this.fetch(u, options, waiting, resolve, reject);\r\n        });\r\n    }\r\n}\r\n\r\nexport class UqHttpChannel extends HttpChannel {\r\n    protected async innerFetch(url: string, options: any, waiting: boolean): Promise<any> {\r\n        let u = this.hostUrl + url;\r\n        return await new Promise<any>(async (resolve, reject) => {\r\n            await this.fetch(u, options, waiting, resolve, reject);\r\n        });\r\n    }\r\n}\r\n","import {nav} from '../components/nav';\r\nimport {FetchError} from './fetchError';\r\n\r\nexport interface HttpChannelUI {\r\n    startWait():void;\r\n    endWait():void;\r\n    showError(error:FetchError):Promise<void>;\r\n    showUpgradeUq(uq:string, version:number):Promise<void>;\r\n}\r\n\r\nexport class HttpChannelNavUI implements HttpChannelUI {\r\n    startWait() {\r\n        nav.startWait();\r\n    }\r\n    endWait() {\r\n        nav.endWait();\r\n    }\r\n    async showError(error:FetchError):Promise<void> {\r\n        nav.endWait();\r\n        /*\r\n        if (error.name === 'SyntaxError') {\r\n            error = {\r\n                name: error.name,\r\n                message: error.message,\r\n            }\r\n        }*/\r\n        await nav.onError(error);\r\n    }\r\n    async showUpgradeUq(uq:string, version:number):Promise<void> {\r\n        await nav.showUpgradeUq(uq, version);\r\n    }\r\n}\r\n\r\n","import _ from 'lodash';\r\nimport {HttpChannel, CenterHttpChannel, UqHttpChannel} from './httpChannel';\r\nimport {HttpChannelNavUI} from './httpChannelUI';\r\nimport {getUqToken, logoutUqTokens, buildAppUq} from './appBridge';\r\nimport {ApiBase} from './apiBase';\r\nimport { host } from './host';\r\nimport { LocalMap, env } from '../tool';\r\nimport {decodeUserToken} from '../tool/user';\r\n\r\ninterface PromiseValue<T> {\r\n\tresolve: (value?: T | PromiseLike<T>) => void;\r\n\treject: (reason?: any) => void;\r\n}\r\nlet channelUIs:{[name:string]: HttpChannel|(PromiseValue<any>[])} = {};\r\nlet channelNoUIs:{[name:string]: HttpChannel|(PromiseValue<any>[])} = {};\r\n\r\nexport function logoutApis() {\r\n    channelUIs = {};\r\n    channelNoUIs = {};\r\n    logoutUnitxApis();\r\n    logoutUqTokens();\r\n}\r\n\r\ninterface UqLocal {\r\n    user: number;\r\n    unit: number;\r\n    value: any;\r\n    tick?: number;\r\n    isNet?: boolean;\r\n}\r\n\r\nexport class UqApi extends ApiBase {\r\n    //private access:string[];\r\n    //appOwner:string;\r\n    //appName:string;\r\n    uqOwner: string;\r\n    uqName: string;\r\n    uq: string;\r\n\r\n    constructor(basePath:string, /*appOwner:string, appName:string, */uqOwner:string, uqName:string/*, access:string[]*/, showWaiting?: boolean) {\r\n        super(basePath, showWaiting);\r\n        //this.appOwner = appOwner;\r\n        //this.appName = appName;\r\n        if (uqName) {\r\n            this.uqOwner = uqOwner;\r\n            this.uqName = uqName;\r\n            this.uq = uqOwner + '/' + uqName;\r\n        }\r\n        //this.access = access;\r\n        this.showWaiting = showWaiting;\r\n    }\r\n\r\n    //setUqVersion(uqVersion:number) {this.uqVersion = undefined}\r\n\r\n    async init() {\r\n        await buildAppUq(this.uq, this.uqOwner, this.uqName);\r\n    }\r\n\r\n    protected async getHttpChannel(): Promise<HttpChannel> {\r\n        let channels: {[name:string]: HttpChannel|(PromiseValue<any>[])};\r\n        let channelUI: HttpChannelNavUI;\r\n        if (this.showWaiting === true || this.showWaiting === undefined) {\r\n            channels = channelUIs;\r\n            channelUI = new HttpChannelNavUI();\r\n        }\r\n        else {\r\n            channels = channelNoUIs;\r\n        }\r\n        let channel = channels[this.uq];\r\n\t\tif (channel !== undefined) {\r\n\t\t\tif (Array.isArray(channel) === false) return channel as HttpChannel;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tchannel = channels[this.uq] = [];\r\n\t\t}\r\n\t\tlet arr = channel as PromiseValue<any>[];\r\n\t\treturn new Promise(async (resolve, reject) => {\r\n\t\t\tarr.push({resolve, reject});\r\n\t\t\tif (arr.length !== 1) return;\r\n\t\t\tlet uqToken = getUqToken(this.uq); //, this.uqOwner, this.uqName);\r\n\t\t\tif (!uqToken) {\r\n\t\t\t\t//debugger;\r\n\t\t\t\tawait this.init();\r\n\t\t\t\tuqToken = getUqToken(this.uq);\r\n\t\t\t}\r\n\t\t\tlet {url, token} = uqToken;\r\n\t\t\tthis.token = token;\r\n\t\t\tchannel = new UqHttpChannel(url, token, channelUI);\r\n\t\t\tchannels[this.uq] = channel;\r\n\t\t\tfor (let pv of arr) {\r\n\t\t\t\tpv.resolve(channel);\r\n\t\t\t}\r\n\r\n\t\t});\r\n    }\r\n\r\n    /*async update():Promise<string> {\r\n        return await this.get('update');\r\n    }*/\r\n\r\n    /*\r\n    async __loadAccess():Promise<any> {\r\n        let acc = this.access === undefined?\r\n            '' :\r\n            this.access.join('|');\r\n        let ret = await this.get('access', {acc:acc});\r\n        return ret;\r\n    }\r\n    */\r\n    async loadEntities():Promise<any> {\r\n        //return await localUqs.loadAccess(this);\r\n        //let acc = this.access === undefined?\r\n        //    '' :\r\n        //    this.access.join('|');\r\n\t\t//let ret = await this.get('access', {acc:acc});\r\n\t\tlet ret = await this.get('entities');\r\n        return ret;\r\n\t}\r\n\tasync getRoles():Promise<string[]> {\r\n\t\tlet ret = await this.get('get-roles',);\r\n\t\tif (!ret) return null;\r\n\t\tlet parts:string[] = (ret as string).split('|');\r\n\t\tlet s:string[] = [];\r\n\t\tfor (let p of parts) {\r\n\t\t\tp = p.trim();\r\n\t\t\tif (!p) continue;\r\n\t\t\ts.push(p);\r\n\t\t}\r\n\t\tif (s.length === 0) return null;\r\n\t\treturn s;\r\n\t}\r\n\tasync getAllRoleUsers():Promise<{user:number, admin:number, roles:string}[]> {\r\n\t\tlet ret = await this.get('get-all-role-users');\r\n\t\treturn ret;\r\n\t}\r\n\tasync setUserRoles(theUser:number, roles:string):Promise<void> {\r\n\t\tawait this.post('set-user-roles', {theUser, roles});\r\n\t}\r\n\tasync deleteUserRoles(theUser:number):Promise<void> {\r\n\t\tawait this.get('delete-user-roles', {theUser});\r\n\t}\r\n\r\n\tasync allSchemas(): Promise<any> {\r\n\t\treturn await this.get('all-schemas');\r\n\t}\r\n\r\n    async schema(name:string):Promise<any> {\r\n        return await this.get('schema/' + name);\r\n    }\r\n\r\n    async queueModify(start:number, page:number, entities:string) {\r\n        return await this.post('queue-modify', {start:start, page:page, entities:entities});\r\n    }\r\n}\r\n\r\nlet channels:{[unitId:number]: HttpChannel} = {};\r\n\r\nexport function logoutUnitxApis() {\r\n    channels = {};\r\n}\r\n\r\nexport class UnitxApi extends UqApi {\r\n    private unitId:number;\r\n    constructor(unitId:number) {\r\n        super('tv/', /*undefined, undefined, */undefined, undefined/*, undefined*/, true);\r\n        this.unitId = unitId;\r\n    }\r\n\r\n    protected async getHttpChannel(): Promise<HttpChannel> {\r\n        let channel = channels[this.unitId];\r\n        if (channel !== undefined) return channel;\r\n        return channels[this.unitId] = await this.buildChannel();\r\n    }\r\n\r\n    private async buildChannel():Promise<HttpChannel> {\r\n        let channelUI = new HttpChannelNavUI();\r\n        let centerAppApi = new CenterAppApi('tv/', undefined);\r\n        let ret = await centerAppApi.unitxUq(this.unitId);\r\n        let {token, db, url, urlTest} = ret;\r\n        let realUrl = host.getUrlOrTest(db, url, urlTest);\r\n        this.token = token;\r\n        return new UqHttpChannel(realUrl, token, channelUI);\r\n    }\r\n}\r\n\r\nlet centerHost:string;\r\n\r\nexport function setCenterUrl(url:string) {\r\n    console.log('setCenterUrl %s', url);\r\n    centerHost = url;\r\n    //centerToken = undefined;\r\n    centerChannel = undefined;\r\n    centerChannelUI = undefined;\r\n}\r\n\r\nexport let centerToken:string|undefined = undefined;\r\n\r\nlet loginedUserId:number = 0;\r\nexport function setCenterToken(userId:number, t?:string) {\r\n    loginedUserId = userId;\r\n    centerToken = t;\r\n    console.log('setCenterToken %s', t);\r\n    centerChannel = undefined;\r\n    centerChannelUI = undefined;\r\n}\r\n\r\nlet centerChannelUI:HttpChannel;\r\nlet centerChannel:HttpChannel;\r\nfunction getCenterChannelUI():HttpChannel {\r\n    if (centerChannelUI !== undefined) return centerChannelUI;\r\n    return centerChannelUI = new CenterHttpChannel(centerHost, centerToken, new HttpChannelNavUI());\r\n}\r\nfunction getCenterChannel():HttpChannel {\r\n    if (centerChannel !== undefined) return centerChannel;\r\n    return centerChannel = new CenterHttpChannel(centerHost, centerToken);\r\n}\r\n\r\nexport abstract class CenterApiBase extends ApiBase {\r\n    protected async getHttpChannel(): Promise<HttpChannel> {\r\n        return (this.showWaiting === true || this.showWaiting === undefined)?\r\n            getCenterChannelUI():\r\n            getCenterChannel();\r\n    }\r\n}\r\n\r\nconst uqTokensName = 'uqTokens';\r\nexport class UqTokenApi extends CenterApiBase {\r\n    private localMap: LocalMap = env.localDb.map(uqTokensName);\r\n\r\n    async uq(params: {unit:number, uqOwner:string, uqName:string}):Promise<any> {\r\n        let {uqOwner, uqName} = params;\r\n        let un = uqOwner+'/'+uqName;\r\n        let localCache = this.localMap.child(un);\r\n        try {\r\n            let uqToken:UqLocal = localCache.get();\r\n            if (uqToken !== undefined) {\r\n                let {unit, user} = uqToken;\r\n                if (unit !== params.unit || user !== loginedUserId) {\r\n                    localCache.remove();\r\n                    uqToken = undefined;\r\n                }\r\n            }\r\n            let nowTick = Math.floor(Date.now() / 1000);\r\n            if (uqToken !== undefined) {\r\n                let {tick, value} = uqToken;\r\n                if (value !== undefined && (nowTick - tick) < 24*3600) {\r\n                    return _.clone(value);\r\n                }\r\n            }\r\n            let uqParams:any = _.clone(params);\r\n            uqParams.testing = host.testing;\r\n            let ret = await this.get('uq-token', uqParams);\r\n            if (ret === undefined) {\r\n                let {unit, uqOwner, uqName} = params;\r\n                let err = `center get app-uq(unit=${unit}, '${uqOwner}/${uqName}') - not exists or no unit-service`;\r\n                throw err;\r\n            }\r\n\r\n            uqToken = {\r\n                unit: params.unit,\r\n                user: loginedUserId,\r\n                tick: nowTick,\r\n                value: ret,\r\n            }\r\n            localCache.set(uqToken);\r\n            return _.clone(ret);\r\n        }\r\n        catch (err) {\r\n            localCache.remove();\r\n            throw err;\r\n        }\r\n    }\r\n}\r\n\r\nexport const uqTokenApi = new UqTokenApi('tv/tie/', undefined);\r\n\r\nexport class CallCenterApi extends CenterApiBase {\r\n    directCall(url:string, method:string, body:any):Promise<any> {\r\n        return this.call(url, method, body);\r\n    }\r\n}\r\nexport const callCenterapi = new CallCenterApi('', undefined);\r\n\r\nexport interface UqAppData {\r\n    appName: string;\r\n    appOwner: string;\r\n    id: number;\r\n    version: string;        // AppUI version\r\n    uqs: UqData[];\r\n}\r\n\r\nexport interface UqData {\r\n    id: number;\r\n    uqOwner: string;\r\n    uqName: string;\r\n    access: string;\r\n    newVersion: boolean;\r\n}\r\n\r\nexport interface UqServiceData {\r\n    id: number;\r\n    db: string;\r\n    url: string;\r\n    urlTest: string;\r\n    token: string;\r\n}\r\n\r\n//const appUqsName = 'appUqs';\r\n\r\nexport class CenterAppApi extends CenterApiBase {\r\n    async appUqs(appOwner:string, appName:string):Promise<UqAppData> {\r\n        let ret:UqAppData = await this.get('tie/app-uqs', {appOwner, appName});\r\n        return ret;\r\n    }\r\n    async uqs(uqs: {owner:string; name:string; version:string}[]):Promise<UqData[]> {\r\n        return await this.post('tie/pure-uqs', uqs);\r\n    }\r\n    async unitxUq(unit:number):Promise<UqServiceData> {\r\n        return await this.get('tie/unitx-uq', {unit:unit});\r\n    }\r\n    async changePassword(param: {orgPassword:string, newPassword:string}) {\r\n        return await this.post('tie/change-password', param);\r\n    }\r\n}\r\n\r\nexport interface RegisterParameter {\r\n    nick:string, \r\n    user:string, \r\n    pwd:string,\r\n    country:number, \r\n    mobile:number, \r\n    mobileCountry:number,\r\n    email:string,\r\n    verify:string,\r\n};\r\n\r\nexport class UserApi extends CenterApiBase {\r\n    async login(params: {user: string, pwd: string, guest: number}): Promise<any> {\r\n        //(params as any).device = nav.local.device.get();\r\n        let ret = await this.get('user/login', params);\r\n        switch (typeof ret) {\r\n            default: return;\r\n            case 'string': return decodeUserToken(ret);\r\n            case 'object':\r\n                let token = ret.token;\r\n                let user = decodeUserToken(token);\r\n                let {nick, icon} = ret;\r\n                if (nick) user.nick = nick;\r\n                if (icon) user.icon = icon;\r\n                return user;\r\n        }\r\n        // !== undefined) return decodeToken(token);\r\n    }\r\n    async register(params: RegisterParameter): Promise<any>\r\n    {\r\n        return await this.post('user/register', params);\r\n    }\r\n\r\n    async sendVerify(account:string, type:'mobile'|'email', oem:string) {\r\n        return await this.post('user/set-verify', {account:account, type:type, oem:oem});\r\n    }\r\n\r\n    async checkVerify(account:string, verify:string) {\r\n        return await this.post('user/check-verify', {account:account, verify:verify});\r\n    }\r\n\r\n    async isExists(account:string) {\r\n        return await this.get('user/is-exists', {account:account});\r\n    }\r\n\r\n    async resetPassword(account:string, password:string, verify:string, type:'mobile'|'email'):Promise<any[]> {\r\n        return await this.post('user/reset-password', {account:account, password, verify, type});\r\n    }\r\n    \r\n    async userSetProp(prop:string, value:any) {\r\n        await this.post('tie/user-set-prop', {prop:prop, value:value});\r\n    }\r\n\r\n    async me():Promise<any> {\r\n        return await this.get('tie/me');\r\n    }\r\n\r\n    async user(id:number): Promise<any> {\r\n        return await this.get('tie/user', {id:id});\r\n\t}\r\n\t\r\n\tasync fromKey(key:string): Promise<{id:number, name:string, nick:string, icon:string}> {\r\n\t\treturn await this.get('tie/user-from-key', {key});\r\n\t}\r\n}\r\n\r\nexport const userApi = new UserApi('tv/', undefined);\r\n","import { Context, Form, View } from \"tonva-react\";\r\nimport { CFormView } from \"./CFormView\";\r\n\r\nexport class VFormView<C extends CFormView<any>> extends View<C> {\r\n\trender(param: any) {\r\n\t\tlet {schema, uiSchema} = this.controller;\r\n\t\treturn <Form fieldLabelSize={2} formData={param}\r\n\t\t\tschema={schema}\r\n\t\t\tuiSchema={uiSchema}\r\n\t\t\tonButtonClick={this.onSubmit} />\r\n\t}\r\n\r\n\tprivate onSubmit = async (name:string, context: Context) => {\r\n\t\tthis.controller.submit(name, context);\r\n\t}\r\n}","import { ButtonSchema, Context, Controller, FieldItem, FieldItems, FieldItemString, ID, Schema, UI, UiButton, UiIdItem, UiNumberItem, UiSchema } from \"tonva-react\";\r\nimport { FormUI } from \"./FormUI\";\r\nimport { VFormView } from \"./VFormView\";\r\n\r\nexport class CFormView<T> extends Controller {\r\n\tprotected readonly ui: UI;\r\n\tschema: Schema;\r\n\tuiSchema: UiSchema;\r\n\tlabel: string|JSX.Element;\r\n\tsubmitCaption: string|JSX.Element;\r\n\tonSubmit: (name:string, context: Context) => Promise<void>;\r\n\r\n\tconstructor(formUI: FormUI) {\r\n\t\tsuper();\r\n\t\tlet {label, fieldArr, fields, submitCaption, t} = formUI;\r\n\t\tthis.t = t;\r\n\t\tthis.schema = this.buildItemSchema(fieldArr);\r\n\t\tthis.uiSchema = this.buildUISchema(fields);\r\n\t\tthis.label = t(label);\r\n\t\tthis.submitCaption = t(submitCaption);\r\n\t}\r\n\r\n\tprotected async internalStart() {\r\n\t}\r\n\r\n\tasync setNO(ID: ID, fieldName:string = 'no') {\r\n\t\tlet field = this.schema.find(v => v.name === fieldName);\r\n\t\tif (!field) return;\r\n\t\tif (field.type !== 'string') return;\r\n\t\tlet noField = field as FieldItemString;\r\n\t\tlet no = await ID.NO();\r\n\t\tnoField.readOnly = true;\r\n\t\tnoField.defaultValue = no;\r\n\t\tlet uiField = this.uiSchema.items[fieldName];\r\n\t\tif (uiField) {\r\n\t\t\tuiField.readOnly = true;\r\n\t\t\tuiField.defaultValue = no;\r\n\t\t}\r\n\t}\r\n\r\n\tsubmit(name:string, context: Context) {\r\n\t\tthis.onSubmit?.(name, context);\r\n\t}\r\n\r\n\tprotected buildItemSchema(fieldArr: FieldItems): Schema {\r\n\t\tlet ret:Schema = [];\r\n\t\tfor (let f of fieldArr) {\r\n\t\t\tlet {type, isKey} = f;\r\n\t\t\tlet required = isKey; // (keys as any[]).findIndex(v => v.name === name) >= 0;\r\n\t\t\tlet fieldItem = {\r\n\t\t\t\t...f,\r\n\t\t\t\trequired,\r\n\t\t\t};\r\n\t\t\tswitch (type) {\r\n\t\t\t\tdefault: ret.push(fieldItem); break;\r\n\t\t\t}\r\n\t\t}\r\n\t\tret.push({\r\n\t\t\tname: 'submit',\r\n\t\t\ttype: 'submit',\r\n\t\t} as ButtonSchema);\r\n\t\treturn ret;\r\n\t}\r\n\r\n\tprotected buildUISchema(fields: {[name:string]:FieldItem}):UiSchema {\r\n\t\tlet items = {...fields as any};\r\n\t\tlet uiButton: UiButton = {\r\n\t\t\tlabel: this.submitCaption ?? '提交',\r\n\t\t\tclassName: 'btn btn-primary',\r\n\t\t\twidget: 'button',\r\n\t\t};\r\n\t\titems['submit'] = uiButton;\r\n\t\tfor (let i in fields) {\r\n\t\t\tlet field = fields[i];\r\n\t\t\tlet {type} = field;\r\n\t\t\tif (type === 'id') {\r\n\t\t\t\tlet uiId = field as UiIdItem;\r\n\t\t\t\tlet {pickId} = uiId;\r\n\t\t\t\tif (pickId === undefined) {\r\n\t\t\t\t\tlet uiNumber = field as UiNumberItem;\r\n\t\t\t\t\tuiNumber.widget = 'number';\r\n\t\t\t\t\tuiNumber.placeholder = 'ID number, only on debugging';\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tlet ret = {items};\r\n\t\treturn ret;\r\n\t}\r\n\r\n\trenderForm(item:T):JSX.Element {\r\n\t\tlet v = new VFormView(this);\r\n\t\treturn v.render(item);\r\n\t}\r\n}\r\n","import { VPage } from \"tonva-react\";\r\nimport { CFormPage } from \"./CFormPage\";\r\n\r\nexport class VFormPage<C extends CFormPage<any>> extends VPage<C> {\r\n\theader() {return this.controller.label}\r\n\tprotected get back(): 'close' | 'back' | 'none' {\r\n\t\treturn 'close';\r\n\t}\r\n\t\r\n\tcontent() {\r\n\t\t/*let {param, schema, uiSchema} = this.controller;\r\n\t\treturn <div className=\"p-3\">\r\n\t\t\t<Form fieldLabelSize={2} formData={param}\r\n\t\t\t\tschema={schema}\r\n\t\t\t\tuiSchema={uiSchema}\r\n\t\t\t\tonButtonClick={this.onSubmit} />\r\n\t\t</div>*/\r\n\t\treturn <div className=\"p-3\">\r\n\t\t\t{this.controller.renderForm(this.controller.item)}\r\n\t\t</div>;\r\n\t}\r\n\t/*\r\n\tprivate onSubmit = async (name:string, context: Context) => {\r\n\t\tthis.controller.submit(context.data);\r\n\t}\r\n\t*/\r\n}\r\n","import { CFormView } from \"./CFormView\";\r\nimport { FormUI } from \"./FormUI\";\r\nimport { VFormPage } from \"./VFormPage\";\r\n\r\nexport class CFormPage<T> extends CFormView<T> {\r\n\titem: T;\r\n\tconstructor(formUI: FormUI, item: T) {\r\n\t\tsuper(formUI);\r\n\t\tthis.item = item;\r\n\t}\r\n\r\n\tprotected async internalStart() {\r\n\t\tthis.openVPage<any, any>(VFormPage);\r\n\t}\r\n}\r\n","import { CFormDialog } from \"./CFormDialog\";\r\nimport { VFormPage } from \"./VFormPage\";\r\n\r\nexport class VDialog extends VFormPage<CFormDialog<any>> {\r\n\tprotected afterBack():void {\r\n\t\tthis.controller.close();\r\n\t}\r\n}\r\n","import { CFormPage } from \"./CFormPage\";\r\nimport { VDialog } from \"./VDialog\";\r\n\r\nexport class CFormDialog<T> extends CFormPage<T> {\r\n\tprotected async internalStart() {\r\n\t\tthis.openVPage(VDialog)\r\n\t}\r\n\r\n\tclose() {\r\n\t\tthis.returnCall(null);\r\n\t}\r\n\r\n\tsubmit(data:any) {\r\n\t\tlet item: any;\r\n\t\tif (!this.item) item = this.item;\r\n\t\telse item = {};\r\n\t\tObject.assign(item, data);\r\n\t\tthis.returnCall(item);\r\n\t\tthis.closePage();\r\n\t}\r\n}\r\n","import { ChangedHandler, ChangingHandler, FieldCustoms, FieldItem, FieldItemId, FieldItemString, ID, PickId, TFunc, UI } from \"tonva-react\";\r\nimport { createPickId } from '../select';\r\n\r\nexport class FormUI {\r\n\tlabel: string|JSX.Element;\r\n\treadonly fieldArr: FieldItem[];\r\n\treadonly fields: {[name:string]: FieldItem};\r\n\tsubmitCaption: string;\r\n\tt: TFunc;\r\n\r\n\tconstructor(ui: UI, fieldCustoms:FieldCustoms, t?: TFunc) {\r\n\t\tthis.t = t ?? ((str:string|JSX.Element) => str);\r\n\t\tlet {label, fieldArr, fields} = ui;\r\n\t\tthis.label = label;\r\n\t\tthis.fieldArr = [];\r\n\t\tthis.fields = {};\r\n\t\tfor (let i in fields) {\r\n\t\t\tlet field = fields[i];\r\n\t\t\tlet fieldCustom = fieldCustoms?.[i];\r\n\t\t\tlet index = fieldArr.findIndex(v => v === field);\r\n\t\t\tlet f:FieldItem;\r\n\t\t\tif (fieldCustom) {\r\n\t\t\t\tlet label = this.t(fieldCustom.label ?? field.label);\r\n\t\t\t\tf = {...field, ...fieldCustom, label};\r\n\t\t\t\tlet {ID} = field;\r\n\t\t\t\tif (ID) {\r\n\t\t\t\t\tlet idField = f as FieldItemId;\r\n\t\t\t\t\tidField.widget = 'id';\r\n\t\t\t\t\tidField.pickId = createPickId(ID.uq.proxy, ID);\r\n\t\t\t\t\t(idField as any).Templet = ID.render;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tlet label = this.t(field.label);\r\n\t\t\t\tf = {...field, label};\r\n\t\t\t}\r\n\t\t\tthis.fields[i] = f;\r\n\t\t\tthis.fieldArr[index] = f;\r\n\t\t}\r\n\t\t/*\r\n\t\tif (fieldCustoms) {\r\n\t\t\tfor (let i in fieldCustoms) {\r\n\t\t\t\tlet field = fieldCustoms[i];\r\n\t\t\t\tlet {ID} = field;\r\n\t\t\t\tif (ID) {\r\n\t\t\t\t\tthis.setIDUi(i, createPickId(ID.uq.proxy, ID), ID.render);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t*/\r\n\t}\r\n\r\n\tsetIDUi(fieldName:string, pickId: PickId, render: (values:any) => JSX.Element) {\r\n\t\tlet field = this.fields[fieldName];\r\n\t\tif (field === undefined) {\r\n\t\t\talert(`${fieldName} not defined in UI`);\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (field.type !== 'id') {\r\n\t\t\talert(`${fieldName} is not id UI`);\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tlet idField = field as FieldItemId;\r\n\t\tidField.widget = 'id';\r\n\t\tidField.pickId = pickId;\r\n\t\t(idField as any).Templet = render;\r\n\t}\r\n\r\n\tasync setNO(ID:ID, fieldName:string = 'no'):Promise<void> {\r\n\t\tlet field = this.fields[fieldName];\r\n\t\tif (!field) return;\r\n\t\tif (field.type !== 'string') return;\r\n\t\tlet noField = field as FieldItemString;\r\n\t\tnoField.readOnly = true;\r\n\t\tlet no = await ID.NO();\r\n\t\tnoField.defaultValue = no;\r\n\t}\r\n\r\n\thideField(...fieldNames:string[]) {\r\n\t\tfor (let fieldName of fieldNames) {\r\n\t\t\tlet index = this.fieldArr.findIndex(v => v.name === fieldName);\r\n\t\t\tif (index >= 0) this.fieldArr.splice(index, 1);\r\n\t\t}\r\n\t}\r\n\r\n\tsetFieldChanged(fieldName: string, onChanged: ChangedHandler) {\r\n\t\tlet field = this.fields[fieldName];\r\n\t\tif (field) field.onChanged = onChanged;\r\n\t}\r\n\r\n\tsetFieldChanging(fieldName: string, onChanging: ChangingHandler) {\r\n\t\tlet field = this.fields[fieldName];\r\n\t\tif (field) field.onChanging = onChanging;\r\n\t}\r\n}\r\n","import _ from 'lodash';\r\nimport {observable, IObservableArray} from 'mobx';\r\nimport { PageItems } from '../tool';\r\nimport {Field, ArrFields} from './uqMan';\r\nimport {Entity} from './entity';\r\nimport { QueryQueryCaller, QueryPageCaller } from './caller';\r\n\r\nexport type QueryPageApi = (name:string, pageStart:any, pageSize:number, params:any) => Promise<string>;\r\n\r\nexport class QueryPager<T extends any> extends PageItems<T> {\r\n\tprivate query: Query;\r\n\tprivate $page: any;\r\n\tprotected idFieldName: any;\r\n    constructor(query: Query, pageSize?: number, firstSize?: number, itemObservable?:boolean) {\r\n        super(itemObservable);\r\n        this.query = query;\r\n        if (pageSize !== undefined) this.pageSize = pageSize;\r\n\t\tif (firstSize !== undefined) this.firstSize = firstSize;\r\n\t}\r\n\r\n\tsetReverse() {\r\n\t\tthis.appendPosition = 'head';\r\n\t}\r\n\r\n    protected async onLoad() {\r\n\t\tif (this.$page) return;\r\n        let {schema} = this.query;\r\n        if (schema === undefined) {\r\n\t\t\tawait this.query.loadSchema();\r\n\t\t\tschema = this.query.schema;\r\n\t\t}\r\n\t\tif (schema === undefined) return;\r\n\t\tlet $page = this.$page = (schema.returns as any[]).find(v => v.name === '$page');\r\n\t\tif ($page === undefined) return;\r\n\t\tthis.sortOrder = $page.order;\r\n\t\tlet fields = $page.fields;\r\n\t\tif (fields !== undefined) {\r\n\t\t\tlet field = fields[0];\r\n\t\t\tif (field) this.idFieldName = field.name;\r\n\t\t}\r\n    }\r\n\r\n    protected async loadResults(param:any, pageStart:number, pageSize:number):Promise<{[name:string]:any[]}> {\r\n\t\tlet ret = await this.query.page(param, pageStart, pageSize);\r\n\t\treturn ret;\r\n\t}\r\n\tprotected getPageId(item:T) {\r\n\t\tif (item === undefined) return;\r\n\t\tif (typeof item === 'number') return item;\r\n\t\tlet start = (item as any)[this.idFieldName];\r\n\t\tif (start === null) return;\r\n\t\tif (start === undefined) return;\r\n\t\tif (typeof start === 'object') {\r\n\t\t\tlet id = start.id;\r\n\t\t\tif (id !== undefined) return id;\r\n\t\t}\r\n\t\treturn start;\r\n\t}\r\n\tasync refreshItems(item:T) {\r\n\t\tlet index = this._items.indexOf(item);\r\n\t\tif (index < 0) return;\r\n\t\tlet startIndex:number;\r\n\t\tif (this.appendPosition === 'tail') {\r\n\t\t\tstartIndex = index - 1;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tstartIndex = index + 1;\r\n\t\t}\r\n\t\tlet pageStart = this.getPageId(this._items[startIndex]);\r\n\t\tlet pageSize = 1;\r\n        let ret = await this.load(\r\n\t\t\tthis.param, \r\n\t\t\tpageStart,\r\n\t\t\tpageSize);\r\n\t\tlet len = ret.length;\r\n\t\tif (len === 0) {\r\n\t\t\tthis._items.splice(index, 1);\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tfor (let i=0; i<len; i++) {\r\n\t\t\tlet newItem = ret[i];\r\n\t\t\tif (!newItem) continue;\r\n\t\t\tlet newId = newItem[this.idFieldName];\r\n\t\t\tif (newId === undefined || newId === null) continue;\r\n\t\t\tif (typeof newId === 'object') newId = newId.id;\r\n\t\t\tlet oldItem = this._items.find(v => {\r\n\t\t\t\tlet oldId = (v as any)[this.idFieldName];\r\n\t\t\t\tif (oldId === undefined || oldId === null) return false;\r\n\t\t\t\tif (typeof oldId === 'object') oldId = oldId.id;\r\n\t\t\t\treturn oldId = newId;\r\n\t\t\t});\r\n\t\t\tif (oldItem) {\r\n\t\t\t\t_.merge(oldItem, newItem);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport class UqQuery<P, R> extends Entity {\r\n    get typeName(): string { return 'query';}\r\n    private pageStart: any;\r\n    private pageSize:number;\r\n    private params:any;\r\n    private more: boolean;\r\n    private startField: Field;\r\n    list:IObservableArray; // = observable.array([], {deep: false});\r\n    returns: ArrFields[];\r\n\tisPaged: boolean;\r\n\t\r\n\t/*\r\n\tconstructor(uq:UqMan, name:string, typeId:number) {\r\n\t\tsuper(uq, name, typeId);\r\n\t\tmakeObservable(this, {\r\n\t\t\tlist: observable,\r\n\t\t})\r\n\t}\r\n\t*/\r\n\r\n    setSchema(schema:any) {\r\n        super.setSchema(schema);\r\n        let {returns} = schema;\r\n        //this.returns = returns;\r\n        this.isPaged = returns && (returns as any[]).find(v => v.name === '$page') !== undefined;\r\n    }\r\n\r\n    resetPage(size:number, params:any) {\r\n        this.pageStart = undefined;\r\n        this.pageSize = size;\r\n        this.params = params;\r\n        this.more = false;\r\n        this.list = undefined;\r\n    }\r\n    get hasMore() {return this.more;}\r\n    async loadPage():Promise<void> {\r\n        if (this.pageSize === undefined) {\r\n            throw new Error('call resetPage(size:number, params:any) first');\r\n        }\r\n        let pageStart:any;\r\n        if (this.pageStart !== undefined) {\r\n            switch (this.startField.type) {\r\n                default: pageStart = this.pageStart; break;\r\n                case 'date':\r\n                case 'time':\r\n                case 'datetime': pageStart = (this.pageStart as Date).getTime(); break;\r\n            }\r\n        }\r\n\t\tlet ret = await this.page(this.params, pageStart, this.pageSize+1);\r\n\t\tlet page = (ret as any).$page;\r\n        /*\r\n        await this.loadSchema();\r\n        let res = await this.tvApi.page(this.name, pageStart, this.pageSize+1, this.params);\r\n        let data = await this.unpackReturns(res);\r\n        let page = data['$page'] as any[];\r\n        */\r\n        this.list = observable.array([], {deep: false});\r\n        if (page !== undefined) {\r\n            if (page.length > this.pageSize) {\r\n                this.more = true;\r\n                page.pop();\r\n                let ret = this.returns.find(r => r.name === '$page');\r\n                this.startField = ret.fields[0];\r\n                this.pageStart = page[page.length-1][this.startField.name];\r\n            }\r\n            else {\r\n                this.more = false;\r\n            }\r\n            this.list.push(...page);\r\n        }\r\n        //this.loaded = true;\r\n    }\r\n\r\n    protected pageCaller(params: any, showWaiting: boolean = true): QueryPageCaller {\r\n        return new QueryPageCaller(this, params, showWaiting);\r\n    }\r\n\r\n    async page(params:P, pageStart:any, pageSize:number, showWaiting: boolean = true):Promise<R> {\r\n        let p = {pageStart, pageSize, params};\r\n        let res = await this.pageCaller(p, showWaiting).request();\r\n        return res;\r\n    }\r\n    protected queryCaller(params: P, showWaiting: boolean = true): QueryQueryCaller {\r\n        return new QueryQueryCaller(this, params, showWaiting);\r\n    }\r\n    async query(params:P, showWaiting:boolean = true):Promise<R> {\r\n        let res = await this.queryCaller(params, showWaiting).request();\r\n        return res;\r\n    }\r\n    async table(params:P, showWaiting:boolean = true): Promise<any[]> {\r\n        let ret = await this.query(params, showWaiting);\r\n        for (let i in ret) {\r\n            return (ret as any)[i];\r\n        }\r\n    }\r\n    async obj(params:P, showWaiting:boolean = true):Promise<any> {\r\n        let ret = await this.table(params, showWaiting);\r\n        if (ret.length > 0) return ret[0];\r\n    }\r\n    async scalar(params:P, showWaiting:boolean = true):Promise<any> {\r\n        let ret = await this.obj(params, showWaiting);\r\n        for (let i in ret) return ret[i];\r\n    }\r\n}\r\n\r\nexport class Query extends UqQuery<any, any> {\r\n}\r\n","import { ID, Uq } from \"tonva-react\";\r\nimport { IDBase } from \"../base/IDBase\";\r\nimport { CList, IDListPageItems, MidList } from \"../list\";\r\nimport { renderSelectItem } from \"./parts\";\r\n\r\nexport class CIDSelect<T extends IDBase, P extends MidIDSelectList<T>> extends CList<T> {\r\n\tmidIDSelectList: P;\r\n\tconstructor(midIDSelectList: P) {\r\n\t\tsuper(midIDSelectList);\r\n\t\tthis.setRes(midIDSelectList.res);\r\n\t\tthis.midIDSelectList = midIDSelectList;\r\n\t}\r\n\r\n\tprotected createMidList(): MidList<T> {\r\n\t\treturn new MidIDSelectList(this.midIDSelectList.uq, this.midIDSelectList.ID);\r\n\t}\r\n\r\n\tprotected onItemClick(item:any):void {\r\n\t\treturn; //this.props.onItemClick(item);\r\n\t}\r\n\r\n\tprotected renderRight():JSX.Element {\r\n\t\treturn null;\r\n\t}\r\n\r\n\tprotected renderItem(item:any, index:number):JSX.Element {\r\n\t\tlet onChange = (evt:React.ChangeEvent<HTMLInputElement>) => {\r\n\t\t\tlet {onSelectChange} = this.midIDSelectList;\r\n\t\t\tonSelectChange?.(item, evt.currentTarget.checked);\r\n\t\t}\r\n\t\tlet {renderItem, ID} = this.midIDSelectList;\r\n\t\tlet content = (renderItem ?? ID.render)(item, index);\r\n\t\tlet {$in} = item;\r\n\t\treturn renderSelectItem(onChange, content, $in===1);\r\n\t}\r\n}\r\n\r\nexport class MidIDSelectList<T extends IDBase> extends MidList<T> {\r\n\treadonly ID:ID;\r\n\tonSelectChange: (item:T, isSelected:boolean)=>any;\r\n\r\n\tconstructor(uq:Uq, ID:ID) {\r\n\t\tsuper(uq);\r\n\t\tthis.ID = ID;\r\n\t}\r\n\r\n\tasync init() {\r\n\t\tawait this.ID.loadSchema();\r\n\t}\r\n\tkey:((item:T) => number|string) = item => item.id;\r\n\r\n\tprotected createPageItems() {\r\n\t\tlet listPageItems = new IDListPageItems<T>(\r\n\t\t\t(pageStart:any, pageSize:number) => this.loadPageItems(pageStart, pageSize)\r\n\t\t);\r\n\t\treturn listPageItems;\r\n\t}\r\n\r\n\tprotected async loadPageItems(pageStart:any, pageSize:number):Promise<T[]> {\r\n\t\tlet ret = await this.uq.ID<T>({\r\n\t\t\tIDX: this.ID,\r\n\t\t\tid: undefined,\r\n\t\t\tpage: {start:pageStart, size:pageSize},\r\n\t\t});\r\n\t\treturn ret;\r\n\t}\r\n}\r\n","export function renderSelectItem(\r\n\tonChange:(evt:React.ChangeEvent<HTMLInputElement>)=>void, \r\n\tcontent:any,\r\n\tdefaultChecked:boolean):JSX.Element {\r\n\treturn <label className=\"mx-3 my-2 d-flex mb-0\">\r\n\t\t<input type=\"checkbox\" onChange={onChange} className=\"mr-3\" defaultChecked={defaultChecked} />\r\n\t\t{content}\r\n\t</label>;\r\n}","import { ID, IX, Uq } from \"tonva-react\";\r\nimport { IDListPageItems } from \"../list\";\r\nimport { IXBase } from \"../base\";\r\nimport { CIDSelect, MidIDSelectList } from \"./CIDSelect\";\r\n\r\nexport class CIXSelect<T extends IXBase> extends CIDSelect<T, MidIXSelectList<T>> {\r\n}\r\n\r\nexport class MidIXSelectList<T extends IXBase> extends MidIDSelectList<T> {\r\n\treadonly IX:IX;\r\n\treadonly id:number;\r\n\tconstructor(uq:Uq, ID:ID, IX:IX, id:number) {\r\n\t\tsuper(uq, ID);\r\n\t\tthis.IX = IX;\r\n\t\tthis.id = id;\r\n\t}\r\n\r\n\tasync init() {\r\n\t\tawait super.init();\r\n\t\tawait this.IX.loadSchema();\r\n\t}\r\n\r\n\tkey:((item:T) => number|string) = item => item.id;\r\n\r\n\tprotected createPageItems() {\r\n\t\tlet listPageItems = new IDListPageItems<T>(\r\n\t\t\t(pageStart:any, pageSize:number) => this.loadPageItems(pageStart, pageSize)\r\n\t\t);\r\n\t\treturn listPageItems;\r\n\t}\r\n\r\n\tprotected async loadPageItems(pageStart:any, pageSize:number):Promise<T[]> {\r\n\t\tlet ret = await this.uq.IDinIX<T>({\r\n\t\t\tID: this.ID,\r\n\t\t\tIX: this.IX,\r\n\t\t\tid: this.id,\r\n\t\t\tpage: {start:pageStart, size:pageSize},\r\n\t\t});\r\n\t\treturn ret as any[];\r\n\t}\r\n}\r\n","import { Context, ID, PickId, Uq } from \"tonva-react\";\r\nimport { CIDSelect,MidIDSelectList } from \"./CIDSelect\";\r\n\r\nexport function createPickId(uq: Uq, ID: ID): PickId {\r\n\tasync function pickId(context:Context, name: string, value: number):Promise<any> {\r\n\t\tlet mid: MidIDSelectList<any> = new MidIDSelectList(uq, ID);\r\n\t\tlet cIDSelect = new CIDSelectInPickId(mid);\r\n\t\tlet ret = await cIDSelect.call<any>();\r\n\t\treturn ret;\r\n\t}\r\n\treturn pickId;\r\n}\r\n\r\nexport class CIDSelectInPickId extends CIDSelect<any, MidIDSelectList<any>> {\r\n\tconstructor(mid: MidIDSelectList<any>) {\r\n\t\tsuper(mid);\r\n\t\tmid.onSelectChange = this.onSelectChange;\r\n\t}\r\n\r\n\tprivate onSelectChange = (item:any, isSelected:boolean) => {\r\n\t\tthis.selectedItem = item;\r\n\t\tthis.closePage();\r\n\t\t// closePage时，returnCall已经被调用了\r\n\t\t// this.returnCall(item);\r\n\t}\r\n}\r\n","const ALPHABET = '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ';\r\nconst ID_LENGTH = 8;\r\n\r\nexport function uid():string {\r\n    let len = ALPHABET.length;\r\n    let rtn = '';\r\n    for (let i = 0; i < ID_LENGTH; i++) {\r\n        rtn += ALPHABET.charAt(Math.floor(Math.random() * len));\r\n    }\r\n    return rtn;\r\n}\r\n","import _ from 'lodash';\r\nimport {nav} from '../components';\r\nimport {uid} from '../tool/uid';\r\nimport {uqTokenApi, callCenterapi, centerToken, setCenterToken} from './uqApi';\r\nimport {setSubAppWindow} from './wsChannel';\r\nimport { host } from './host';\r\nimport { env } from '../tool';\r\n\r\nexport interface UqToken {\r\n    name: string;\r\n    db: string;\r\n    url: string;\r\n    token: string;\r\n}\r\nconst uqTokens:{[uqName:string]: UqToken}  = {};\r\nexport function logoutUqTokens() {\r\n    for (let i in uqTokens) {\r\n        uqTokens[i] = undefined;\r\n    }\r\n}\r\n/*\r\nexport interface AppInFrame {\r\n    hash: string;\r\n    //unit: number;       // unit id\r\n    page?: string;\r\n    param?: string[];\r\n    predefinedUnit?: number;  // 比如像Cart这样的应用，直接让用户访问的，就需要在unit.json里面定义unitName\r\n}\r\nconst appsInFrame:{[key:string]:AppInFrame} = {};\r\n*/\r\n/*\r\nclass AppInFrameClass implements AppInFrame {\r\n    hash: string;\r\n    private _unit: number;\r\n    get unit(): number {return this._unit;}       // unit id\r\n    set unit(val:number) { this._unit=val;}\r\n    page?: string;\r\n    param?: string[];\r\n}\r\n\r\nexport let appInFrame:AppInFrame = new AppInFrameClass();\r\n*/\r\n/* {\r\n    hash: undefined,\r\n    get unit():number {return } undefined, //debugUnitId,\r\n    page: undefined;\r\n    param: undefined,\r\n}*/\r\n\r\nexport function isBridged():boolean {\r\n    return window.self !== window.parent;\r\n}\r\n\r\nwindow.addEventListener('message', async function(evt) {\r\n    var message = evt.data;\r\n\tif (!message) return;\r\n    switch (message.type) {\r\n        case 'sub-frame-started':\r\n            subFrameStarted(evt);\r\n            break;\r\n        case 'ws':\r\n            //wsBridge.receive(message.msg);\r\n            await nav.onReceive(message.msg);\r\n            break;\r\n        case 'init-sub-win':\r\n            await initSubWin(message);\r\n            break;\r\n        case 'pop-app':\r\n            window.console.log('///\\\\\\\\\\\\ pop-app');\r\n            nav.navBack();\r\n            break;\r\n        case 'center-api':\r\n            await callCenterApiFromMessage(evt.source as Window, message);\r\n            break;\r\n        case 'center-api-return':\r\n            bridgeCenterApiReturn(message);\r\n            break;\r\n        case 'app-api':\r\n            let ret = await onReceiveAppApiMessage(message.hash, message.apiName);\r\n            (evt.source as Window).postMessage({\r\n                type: 'app-api-return', \r\n                apiName: message.apiName,\r\n                db: ret.db,\r\n                url: ret.url,\r\n                token: ret.token} as any, \"*\");\r\n            break;\r\n        case 'app-api-return':\r\n            console.log(\"app-api-return: %s\", JSON.stringify(message));\r\n            console.log('await onAppApiReturn(message);');\r\n            await onAppApiReturn(message);\r\n            break;\r\n        default:\r\n\t\t\tif ((message.source as string)?.startsWith('react-devtools') === true) break;\r\n            window.console.log('message: %s', JSON.stringify(message));\r\n            break;\r\n    }\r\n});\r\n\r\nfunction subFrameStarted(evt:any) {\r\n    var message = evt.data;\r\n    let subWin = evt.source as Window;\r\n    setSubAppWindow(subWin);\r\n    hideFrameBack(message.hash);\r\n    let msg:any = _.clone(nav.user);\r\n    msg.type = 'init-sub-win';\r\n    subWin.postMessage(msg, '*');\r\n}\r\nfunction hideFrameBack(hash:string) {\r\n    let el = document.getElementById(hash);\r\n    if (el !== undefined) el.hidden = true;\r\n}\r\nasync function initSubWin(message:any) {\r\n    console.log('initSubWin: set nav.user', message);\r\n    let user = nav.user = message; // message.user;\r\n    setCenterToken(user.id, user.token);\r\n    await nav.showAppView();\r\n}\r\nasync function onReceiveAppApiMessage(hash: string, apiName: string): Promise<UqToken> {\r\n    //let appInFrame = appsInFrame[hash];\r\n    //if (appInFrame === undefined) return {name:apiName, db:undefined, url:undefined, token:undefined};\r\n    //let unit = getUnit();\r\n    //let {unit, predefinedUnit} = appInFrame;\r\n\t//unit = unit || predefinedUnit;\r\n\tlet {unit} = env;\r\n    if (!unit) {\r\n        console.error('no unit defined in unit.json or in index.html, or not logined in', unit);\r\n    }\r\n    let parts = apiName.split('/');\r\n    let param = {unit: unit, uqOwner: parts[0], uqName: parts[1], appOwner: parts[2], appName:parts[3]};\r\n    console.log('uqTokenApi.uq onReceiveAppApiMessage', param);\r\n    let ret = await uqTokenApi.uq(param);\r\n    let {db, url, token} = ret;\r\n    return {name: apiName, db:db, url: url, token: token};\r\n}\r\n\r\nasync function onAppApiReturn(message:any) {\r\n    let {apiName, db, url, urlTest, token} = message;\r\n    let action = uqTokenActions[apiName];\r\n    if (action === undefined) {\r\n        throw new Error('error app api return');\r\n        //return;\r\n    }\r\n    let realUrl = host.getUrlOrTest(db, url, urlTest);\r\n    console.log('onAppApiReturn(message:any): url=' + url + ', real=' + realUrl);\r\n    //action.url = realUrl;\r\n    //action.token = token;\r\n    action.resolve({\r\n        name: apiName,\r\n        db: db,\r\n        url: realUrl,\r\n        token: token,\r\n    } as UqToken);\r\n}\r\n/*\r\nexport function setAppInFrame(appHash: string):AppInFrame {\r\n    if (appHash) {\r\n        let parts = appHash.split('-');\r\n        let len = parts.length;\r\n        if (len > 0) {\r\n            let p = 1;\r\n            appInFrame.hash = parts[p++];\r\n            if (len>0) appInFrame.unit = Number(parts[p++]);\r\n            if (len>1) appInFrame.page = parts[p++];\r\n            if (len>2) appInFrame.param = parts.slice(p++);\r\n        }\r\n    }\r\n    return appInFrame;\r\n}\r\n\r\nexport function getExHashPos():number {\r\n    let hash = document.location.hash;\r\n    if (hash !== undefined && hash.length > 0) {\r\n        let pos = hash.lastIndexOf('#tv-');\r\n        if (pos < 0) pos = hash.lastIndexOf('#tvdebug-');\r\n        return pos;\r\n    }\r\n    return -1;\r\n}\r\n\r\nexport function getExHash():string {\r\n    let pos = getExHashPos();\r\n    if (pos < 0) return undefined;\r\n    return document.location.hash.substring(pos);\r\n}\r\n*/\r\n/*\r\nexport function appUrl(url: string, unitId: number, page?:string, param?:any[]):{url:string; hash:string} {\r\n    let u:string;\r\n    for (;;) {\r\n        u = uid();\r\n        let a = appsInFrame[u];\r\n        if (a === undefined) {\r\n            appsInFrame[u] = {hash:u, unit:unitId};\r\n            break;\r\n        }\r\n    }\r\n    url += '#tv-' + u + '-' + unitId;\r\n    if (page !== undefined) {\r\n        url += '-' + page;\r\n        if (param !== undefined) {\r\n            for (let i=0; i<param.length; i++) {\r\n                url += '-' + param[i];\r\n            }\r\n        }\r\n    }\r\n    return {url: url, hash: u};\r\n}\r\n*/\r\n/*\r\nfunction getUnit():number {\r\n\tlet {unit, predefinedUnit} = appInFrame;\r\n    let realUnit = unit || predefinedUnit;\r\n    if (realUnit === undefined) {\r\n        throw new Error('no unit defined in unit.json or not logined in');\r\n\t}\r\n    return realUnit;\r\n}\r\n*/\r\ninterface UqTokenAction {\r\n    resolve: (value?: UqToken | PromiseLike<UqToken>) => void;\r\n    reject: (reason?: any) => void;\r\n}\r\nconst uqTokenActions:{[uq:string]: UqTokenAction} = {};\r\nexport async function buildAppUq(uq:string, uqOwner:string, uqName:string):Promise<void> {\r\n    if (!isBridged()) {\r\n\t\t//let unit = getUnit();\r\n\t\tlet {unit} = env;\r\n        let uqToken = await uqTokenApi.uq({unit,  uqOwner, uqName});\r\n        if (uqToken.token === undefined) uqToken.token = centerToken;\r\n        let {db, url, urlTest} = uqToken;\r\n        let realUrl = host.getUrlOrTest(db, url, urlTest);\r\n        console.log('realUrl: %s', realUrl);\r\n        uqToken.url = realUrl;\r\n        uqTokens[uq] = uqToken;\r\n        return uqToken;\r\n    }\r\n    //console.log(\"**** before buildAppUq ****\", appInFrame);\r\n    let bp = uqTokenActions[uq];\r\n    if (bp !== undefined) return;\r\n    return new Promise<void>((resolve, reject) => {\r\n        uqTokenActions[uq] = {\r\n            resolve: async (at:any) => {\r\n                let {db, url, token} = await at;\r\n                uqTokens[uq] = {\r\n                    name: uq,\r\n                    db: db,\r\n                    url: url,\r\n                    token: token,\r\n                };\r\n                uqTokenActions[uq] = undefined;\r\n                //console.log(\"**** after buildAppUq ****\", appInFrame);\r\n                resolve();\r\n            },\r\n            reject: reject,\r\n        };\r\n        (window.opener || window.parent).postMessage({\r\n            type: 'app-api',\r\n            apiName: uq,\r\n            //hash: appInFrame.hash,\r\n        }, \"*\");\r\n    });\r\n}\r\n\r\nexport function getUqToken(uq:string):UqToken {\r\n    let uts = uqTokens;\r\n    return uts[uq];\r\n}\r\n\r\ninterface BridgeCenterApi {\r\n    id: string;\r\n    resolve: (value?:any)=>any;\r\n    reject: (reason?:any)=>void;\r\n}\r\nconst brideCenterApis:{[id:string]: BridgeCenterApi} = {};\r\nexport async function bridgeCenterApi(url:string, method:string, body:any):Promise<any> {\r\n    console.log('bridgeCenterApi: url=%s, method=%s', url, method);\r\n    return await new Promise<any>(async (resolve, reject) => {\r\n        let callId:string;\r\n        for (;;) {\r\n            callId = uid();\r\n            let bca = brideCenterApis[callId];\r\n            if (bca === undefined) {\r\n                brideCenterApis[callId] = {\r\n                    id: callId,\r\n                    resolve: resolve,\r\n                    reject: reject,\r\n                }\r\n                break;\r\n            }\r\n        }\r\n        (window.opener || window.parent).postMessage({\r\n            type: 'center-api',\r\n            callId: callId,\r\n            url: url,\r\n            method: method,\r\n            body: body\r\n        }, '*');\r\n    });\r\n}\r\n\r\nasync function callCenterApiFromMessage(from:Window, message:any):Promise<void> {\r\n    let {callId, url, method, body} = message;\r\n    let result = await callCenterapi.directCall(url, method, body);\r\n    from.postMessage({\r\n        type: 'center-api-return',\r\n        callId: callId,\r\n        result: result,\r\n    }, '*');\r\n}\r\n\r\nfunction bridgeCenterApiReturn(message:any) {\r\n    let {callId, result} = message;\r\n    let bca = brideCenterApis[callId];\r\n    if (bca === undefined) return;\r\n    brideCenterApis[callId] = undefined;\r\n    bca.resolve(result);\r\n}\r\n","import { messageHub } from \"./messageHub\";\r\n\r\nlet subAppWindow:Window;\r\nfunction postWsToSubApp(msg:any) {\r\n    if (subAppWindow === undefined) return;\r\n    subAppWindow.postMessage({\r\n        type: 'ws',\r\n        msg: msg\r\n    }, '*');\r\n}\r\n\r\nexport function setSubAppWindow(win:Window) {\r\n    subAppWindow = win;\r\n}\r\n\r\nexport function postWsToTop(msg:any) {\r\n    window.top.postMessage({\r\n        type: 'ws',\r\n        msg: msg\r\n    }, '*');\r\n}\r\n\r\nexport abstract class WsBase {\r\n\tprivate messageHub = messageHub;\r\n\t/*\r\n    wsBaseId:string;\r\n    private handlerSeed = 1;\r\n    private anyHandlers:{[id:number]:(msg:any)=>Promise<void>} = {};\r\n\tprivate msgHandlers:{[id:number]:{type:string, handler:(msg:any)=>Promise<void>}} = {};\r\n\t*/\r\n\t/*\r\n    onWsReceiveAny(handler:(msg:any)=>Promise<void>):number {\r\n        let seed = this.handlerSeed++;\r\n        this.anyHandlers[seed] = handler;\r\n        return seed;\r\n    }\r\n    onWsReceive(type:string, handler:(msg:any)=>Promise<void>):number {\r\n        let seed = this.handlerSeed++;\r\n        this.msgHandlers[seed] = {type:type, handler: handler};\r\n        return seed;\r\n    }\r\n    endWsReceive(handlerId:number) {\r\n        delete this.anyHandlers[handlerId];\r\n        delete this.msgHandlers[handlerId];\r\n\t}\r\n\t*/\r\n    async receive(msg:any) {\r\n\t\tthis.messageHub.dispatch(msg);\r\n\t\t/*\r\n        let {$type} = msg;\r\n        for (let i in this.anyHandlers) {\r\n            await this.anyHandlers[i](msg);\r\n        }\r\n        for (let i in this.msgHandlers) {\r\n            let {type, handler} = this.msgHandlers[i];\r\n            if (type !== $type) continue;\r\n            await handler(msg);\r\n\t\t}\r\n\t\t*/\r\n    }\r\n}\r\n\r\nlet wsBaseSeed = 1;\r\nexport class WsBridge extends WsBase {\r\n    wsBaseId:string = 'WsBridge seed ' + wsBaseSeed++;\r\n}\r\n\r\nexport const wsBridge = new WsBridge();\r\n\r\nexport class WSChannel extends WsBase {\r\n    wsBaseId:string = 'WSChannel seed ' + wsBaseSeed++;\r\n    static centerToken:string;\r\n    private wsHost: string;\r\n    private token: string;\r\n    private ws: WebSocket;\r\n\r\n    constructor(wsHost: string, token: string) {\r\n        super();\r\n        this.wsHost = wsHost;\r\n        this.token = token;\r\n    }\r\n\r\n    static setCenterToken(token?: string) {\r\n        WSChannel.centerToken = token;\r\n    }\r\n    \r\n    connect():Promise<void> {\r\n        //this.wsHost = wsHost;\r\n        //this.token = token || WSChannel.centerToken;\r\n        if (this.ws !== undefined) return;\r\n        let that = this;\r\n        return new Promise((resolve, reject) => {\r\n            let ws = new WebSocket(this.wsHost, this.token || WSChannel.centerToken);\r\n            console.log('connect webSocket %s', this.wsHost);\r\n            ws.onopen = (ev) => {\r\n                console.log('webSocket connected %s', this.wsHost);\r\n                that.ws = ws;\r\n                resolve();\r\n            };\r\n            ws.onerror = (ev) => {\r\n                reject('webSocket can\\'t open!');\r\n            };\r\n            ws.onmessage = async (msg) => await that.wsMessage(msg);\r\n            ws.onclose = (ev) => {\r\n                that.ws = undefined;\r\n                console.log('webSocket closed!');\r\n            }\r\n        });\r\n    }\r\n    close() {\r\n        if (this.ws !== undefined) {\r\n            this.ws.close();\r\n            this.ws = undefined;\r\n        }\r\n    }\r\n    private async wsMessage(event:any):Promise<void> {\r\n        try {\r\n            console.log('websocket message: %s', event.data);\r\n            let msg = JSON.parse(event.data);\r\n            postWsToSubApp(msg);\r\n            await this.receive(msg);\r\n        }\r\n        catch (err) {\r\n            console.log('ws msg error: ', err);\r\n        }\r\n    }\r\n    sendWs(msg:any) {\r\n        let netThis = this;\r\n        this.connect().then(() => {\r\n            netThis.ws.send(msg);\r\n        });\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport classNames from 'classnames';\r\nimport { nav } from './nav';\r\n\r\nexport interface ImageProps {\r\n    src: string;\r\n    className?: string;\r\n    style?: React.CSSProperties;\r\n    altImage?: string;\r\n}\r\n\r\n// src = .src, 表示fontawesome Icon\r\nexport function Image(props: ImageProps) {\r\n\tlet {className, style, src, altImage} = props;\r\n\tlet icon:string;\r\n    if (src) {\r\n\t\tif (src.indexOf('.') !== 0) {\r\n\t\t\tif (src.startsWith(':') === true) {\r\n\t\t\t\tsrc = nav.resUrl + src.substr(1);\r\n\t\t\t}\r\n\t\t\treturn <img src={src} className={className} alt=\"img\"\r\n\t\t\t\tstyle={style}\r\n\t\t\t\tonError={evt=>{\r\n\t\t\t\t\tif (altImage) evt.currentTarget.src=altImage;\r\n\t\t\t\t\telse evt.currentTarget.src = 'https://tv.jkchemical.com/imgs/0001.png';\r\n\t\t\t\t}} />;\r\n\t\t}\r\n\t\ticon = src.substr(1);\r\n\t}\r\n\telse {\r\n\t\ticon = 'file-o'\r\n\t}\r\n\treturn <span className={classNames(className, 'image-none')} style={style}>\r\n\t\t<i className={'fa fa-' + icon} />\r\n\t</span>;\r\n}\r\n","export class SlrForEarning {\r\n  slope: number;\r\n  intercept: number;\r\n  y: number[];\r\n  slopeR: number;\r\n  endY: number;\r\n  r2: number;\r\n\r\n  constructor(y:number[]) {\r\n    this.y = y;\r\n    this.regress();\r\n    let score = this.score();\r\n    this.r2 = score.r2;\r\n  }\r\n\r\n  regress() {\r\n    const n = this.y.length;\r\n    let xSum = 0;\r\n    let ySum = 0;\r\n  \r\n    let xSquared = 0;\r\n    let xY = 0;\r\n  \r\n    for (let x = 0; x < n; ++x) {\r\n      xSum += x;\r\n      ySum += this.y[x];\r\n      xSquared += x * x;\r\n      xY += x * this.y[x];\r\n    }\r\n  \r\n    const numerator = n * xY - xSum * ySum;\r\n    this.slope = numerator / (n * xSquared - xSum * xSum);\r\n    this.intercept = (1 / n) * ySum - this.slope * (1 / n) * xSum;\r\n\r\n    let ym = this.slope > 0 ? this.predict(n-2) : this.predict(1);\r\n    this.slopeR = ym < 0.01 ? undefined : this.slope / ym;\r\n  }\r\n\r\n  score() {\r\n    const n = this.y.length;\r\n    const y2 = new Array(n);\r\n    for (let i = 0; i < n; i++) {\r\n      y2[i] = this.predict(i);\r\n    }\r\n\r\n    let xSum = 0;\r\n    let ySum = 0;\r\n    let chi2 = 0;\r\n    let rmsd = 0;\r\n    let xSquared = 0;\r\n    let ySquared = 0;\r\n    let xY = 0;\r\n    for (let i = 0; i < n; i++) {\r\n      let yi2 = y2[i];\r\n      xSum += yi2;\r\n      let yi = this.y[i];\r\n      ySum += yi;\r\n      xSquared += yi2 * yi2;\r\n      ySquared += yi * yi;\r\n      xY += yi2 * yi;\r\n      let yiyi2 = yi - yi2;\r\n      if (yi !== 0) {\r\n        chi2 += (yiyi2 * yiyi2) / yi;\r\n      }\r\n      rmsd += yiyi2 * yiyi2;\r\n    }\r\n\r\n    const r =\r\n      (n * xY - xSum * ySum) /\r\n      Math.sqrt((n * xSquared - xSum * xSum) * (n * ySquared - ySum * ySum));\r\n\r\n    return {\r\n      r: r,\r\n      r2: r * r,\r\n      chi2: chi2,\r\n      rmsd: Math.sqrt(rmsd / n)\r\n    };\r\n  }\r\n\r\n\r\n  predict(x:number) {\r\n    return this.slope * x + this.intercept;\r\n  }\r\n\r\n  computeX(y:number) {\r\n    return (y - this.intercept) / this.slope;\r\n  }\r\n}\r\n","export class ErForEarning {\r\n  A:number;\r\n  B:number;\r\n  y: number[];\r\n  r2: number;\r\n\r\n  constructor(y:number[]) {\r\n    this.y = y;\r\n    this.regress();\r\n    let score = this.score();\r\n    this.r2 = score.r2;\r\n  }\r\n\r\n  regress() {\r\n    const n = this.y.length;\r\n    let xSum = 0;\r\n    let ySum = 0;\r\n  \r\n    let xSquared = 0;\r\n    let xY = 0;\r\n  \r\n    for (let x = 0; x < n; ++x) {\r\n      xSum += x;\r\n      let yx = Math.log(this.y[x]);\r\n      ySum += yx;\r\n      xSquared += x * x;\r\n      xY += x * yx;\r\n    }\r\n  \r\n    const numerator = n * xY - xSum * ySum;\r\n    let slope = numerator / (n * xSquared - xSum * xSum);\r\n    let intercept = (1 / n) * ySum - slope * (1 / n) * xSum;\r\n    this.A = Math.exp(intercept);\r\n    this.B = slope;\r\n  }\r\n\r\n  score() {\r\n    const n = this.y.length;\r\n    const y2 = new Array(n);\r\n    for (let i = 0; i < n; i++) {\r\n      y2[i] = this.predict(i);\r\n    }\r\n\r\n    let xSum = 0;\r\n    let ySum = 0;\r\n    let chi2 = 0;\r\n    let rmsd = 0;\r\n    let xSquared = 0;\r\n    let ySquared = 0;\r\n    let xY = 0;\r\n    for (let i = 0; i < n; i++) {\r\n      let yi2 = y2[i];\r\n      xSum += yi2;\r\n      let yi = this.y[i];\r\n      ySum += yi;\r\n      xSquared += yi2 * yi2;\r\n      ySquared += yi * yi;\r\n      xY += yi2 * yi;\r\n      let yiyi2 = yi - yi2;\r\n      if (yi !== 0) {\r\n        chi2 += (yiyi2 * yiyi2) / yi;\r\n      }\r\n      rmsd += yiyi2 * yiyi2;\r\n    }\r\n\r\n    const r =\r\n      (n * xY - xSum * ySum) /\r\n      Math.sqrt((n * xSquared - xSum * xSum) * (n * ySquared - ySum * ySum));\r\n\r\n    return {\r\n      r: r,\r\n      r2: r * r,\r\n      chi2: chi2,\r\n      rmsd: Math.sqrt(rmsd / n)\r\n    };\r\n  }\r\n\r\n  predict(x:number) {\r\n    return this.A * Math.exp(x * this.B);\r\n  }\r\n}\r\n","import jwtDecode from 'jwt-decode';\r\n\r\nexport interface Unit {\r\n    id: number;\r\n    name: string;\r\n}\r\n\r\nexport interface Guest {\r\n    id: number;             // id = 0\r\n    guest: number;\r\n    token: string;\r\n}\r\n\r\nexport interface User extends Guest {\r\n    id: number;\r\n    name: string;\r\n    nick?: string;\r\n\ticon?: string;\r\n\troles?: {[uq:string]: string[]}\r\n}\r\n\r\nexport function decodeUserToken(token: string): User {\r\n    let ret:any = jwtDecode(token);\r\n    let user: User = {\r\n        id: ret.id,\r\n        name: ret.name,\r\n        guest: ret.guest,\r\n        token: token,\r\n    };\r\n    return user;\r\n}\r\n\r\nexport function decodeGuestToken(token: string): Guest {\r\n    let ret:any = jwtDecode(token);\r\n    let guest: Guest = {\r\n        id: 0,\r\n        guest: ret.guest,\r\n        token: token,\r\n    };\r\n    return guest;\r\n}\r\n","import { env } from '../tool';\r\n\r\nconst centerHost = process.env['REACT_APP_CENTER_HOST'];\r\nconst centerDebugHost = 'localhost:3000'; //'192.168.86.64';\r\nconst resHost = process.env['REACT_APP_RES_HOST'] || centerHost;\r\nconst resDebugHost = 'localhost:3015'; //'192.168.86.63';\r\nconst uqDebugHost = 'localhost:3015'; //'192.168.86.63';\r\nconst uqDebugBuilderHost = 'localhost:3009';\r\ninterface HostValue {\r\n    value: string;\r\n\tlocal: boolean;\r\n}\r\nconst hosts:{[name:string]:HostValue} = {\r\n    centerhost: {\r\n        value: process.env['REACT_APP_CENTER_DEBUG_HOST'] || centerDebugHost, \r\n\t\tlocal: false,\r\n    },\r\n    reshost: {\r\n        value: process.env['REACT_APP_RES_DEBUG_HOST'] || resDebugHost,\r\n\t\tlocal: false,\r\n    },\r\n    uqhost: {\r\n        value: process.env['REACT_APP_UQ_DEBUG_HOST'] || uqDebugHost, \r\n\t\tlocal: false,\r\n    },\r\n    unitxhost: {\r\n        value: process.env['REACT_APP_UQ_DEBUG_HOST'] || uqDebugHost, \r\n\t\tlocal: false,\r\n    },\r\n    \"uq-build\": {\r\n        value: process.env['REACT_APP_UQ_DEBUG_BUILDER_HOST'] || uqDebugBuilderHost, \r\n\t\tlocal: false,\r\n    }\r\n}\r\n\r\nconst httpArr = ['https://', 'http://'];\r\nfunction isAbsoluteUrl(url:string):boolean {\r\n    for (let str of httpArr) {\r\n        if (url.startsWith(str) === true) return true;\r\n    }\r\n    return false;\r\n}\r\n\r\nfunction urlFromHost(host:string):string {\r\n    if (isAbsoluteUrl(host) === true) {\r\n        if (host.endsWith('/')) return host;\r\n        return host + '/';\r\n    }\r\n    return `http://${host}/`;\r\n}\r\n\r\nfunction centerUrlFromHost(host:string):string {\r\n    return urlFromHost(host);\r\n}\r\nfunction centerWsFromHost(host:string) {\r\n    let https = 'https://';\r\n    if (host.startsWith(https) === true) {\r\n        host = host.substr(https.length);\r\n        if (host.endsWith('/') === true) host = host.substr(0, host.length-1);\r\n        return 'wss://' + host + '/tv/';\r\n    }\r\n    return `ws://${host}/tv/`\r\n}\r\nexport function resUrlFromHost(host:string) {\r\n\tif (!host) return;\r\n    let url = urlFromHost(host);\r\n    return url + 'res/';\r\n}\r\n\r\nconst fetchOptions = {\r\n    method: \"GET\",\r\n    mode: \"no-cors\", // no-cors, cors, *same-origin\r\n    headers: {\r\n        \"Content-Type\": \"text/plain\"\r\n    },\r\n};\r\n\r\nclass Host {\r\n    testing: boolean;\r\n    url: string;\r\n    ws: string;\r\n    resHost: string;\r\n\r\n    async start(testing:boolean) {\r\n\t\tif (!centerHost) debugger;\r\n        this.testing = testing;\r\n        if (env.isDevelopment === true) {\r\n            await this.tryLocal();\r\n        }\r\n        let host = this.getCenterHost();\r\n        this.url = centerUrlFromHost(host);\r\n        this.ws = centerWsFromHost(host);\r\n\t\tthis.resHost = this.getResHost();\r\n    }\r\n\r\n    private debugHostUrl(host:string) {return `http://${host}/hello`}\r\n    private async tryLocal() {\r\n        let promises:PromiseLike<any>[] = [];\r\n        let hostArr:string[] = [];\r\n        for (let i in hosts) {\r\n            let hostValue = hosts[i];\r\n            let {value} = hostValue;\r\n            if (hostArr.findIndex(v => v === value) < 0) hostArr.push(value);\r\n        }\r\n\r\n        for (let host of hostArr) {\r\n            let fetchUrl = this.debugHostUrl(host);\r\n            promises.push(localCheck(fetchUrl));\r\n        }\r\n        let results = await Promise.all(promises);\r\n        let len = hostArr.length;\r\n        for (let i=0; i<len; i++) {\r\n            let local = results[i];\r\n            let host = hostArr[i];\r\n            for (let j in hosts) {\r\n                let hostValue = hosts[j];\r\n                if (hostValue.value === host) {\r\n                    hostValue.local = local;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    private getCenterHost():string {\r\n        let {value, local} = hosts.centerhost;\r\n        let hash = document.location.hash;\r\n        if (hash.includes('sheet_debug') === true) {\r\n            return value;\r\n        }\r\n        if (env.isDevelopment === true) {\r\n            if (local === true) return value;\r\n        }\r\n        return centerHost;\r\n    }\r\n\r\n    private getResHost():string {\r\n        let {value, local} = hosts.reshost;\r\n        let hash = document.location.hash;\r\n        if (hash.includes('sheet_debug') === true) {\r\n            return value;\r\n        }\r\n        if (env.isDevelopment === true) {\r\n            if (local === true) return value;\r\n        }\r\n        return resHost;\r\n    }\r\n\r\n    getUrlOrDebug(url:string, debugHost:string = 'uqhost'):string {\r\n        if (env.isDevelopment === false) return url;\r\n        let host = hosts[debugHost];\r\n        if (host === undefined) return url;\r\n        let {value, local} = host;\r\n        if (local === false) return url;\r\n        return `http://${value}/`;\r\n    }\r\n    getUrlOrTest(db:string, url:string, urlTest:string):string {\r\n\t\tif (!urlTest) {\r\n\t\t\turlTest = url;\r\n\t\t\tif (!urlTest) {\r\n\t\t\t\tconsole.error('no server set for ' + db);\r\n\t\t\t\tdebugger;\t\t\t\t\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if (!url) {\r\n\t\t\turl = urlTest;\r\n\t\t}\r\n\t\tlet testProd:string;\r\n        if (this.testing === true) {\r\n\t\t\tif (urlTest !== '-') url = urlTest;\r\n\t\t\ttestProd = 'test';\r\n        }\r\n        else {\r\n\t\t\ttestProd = 'prod';\r\n        }\r\n\t\turl = this.getUrlOrDebug(url);\r\n\t\tif (url.endsWith('/') === false) {\r\n\t\t\turl += '/';\r\n\t\t}\r\n        return `${url}uq/${testProd}/${db}/`;\r\n    }\r\n\r\n    async localCheck(urlDebug: string):Promise<boolean> {\r\n        return await localCheck(urlDebug);\r\n    }\r\n}\r\n\r\nexport const host:Host = new Host();\r\n\r\n// 因为测试的都是局域网服务器，甚至本机服务器，所以一秒足够了\r\n// 网上找了上面的fetch timeout代码。\r\n// 尽管timeout了，fetch仍然继续，没有cancel\r\n\r\n// 实际上，一秒钟不够。web服务器会自动停。重启的时候，可能会比较长时间。也许两秒甚至更多。\r\n//const timeout = 2000;\r\nconst timeout = 2000;\r\n\r\nfunction fetchLocalCheck(url:string):Promise<any> {\r\n    return new Promise((resolve, reject) => {\r\n      fetch(url, fetchOptions as any)\r\n      .then(v => {\r\n          v.text().then(resolve).catch(reject);\r\n      })\r\n      .catch(reject);\r\n      const e = new Error(\"Connection timed out\");\r\n      env.setTimeout('fetchLocalCheck', reject, timeout, e);\r\n    });\r\n}\r\n\r\nasync function localCheck(url:string):Promise<boolean> {\r\n    try {\r\n\t\tawait fetchLocalCheck(url);\r\n        return true;\r\n    }\r\n    catch (err) {\r\n        return false;\r\n    }\r\n}\r\n\r\n/*\r\nexport interface IUqForChannel {\r\n    uq: string;\r\n    uqVersion: number;\r\n}\r\n*/","import React from 'react';\r\nimport { PageHeaderProps } from './pageHeader';\r\n\r\nconst scrollAfter = 20; // 20ms之后，scroll执行\r\nexport class Scroller {\r\n    private el: HTMLBaseElement;\r\n    constructor(el: HTMLBaseElement) {\r\n        this.el = el;\r\n    }\r\n\r\n    scrollToTop():void {\r\n        setTimeout(() => this.el.scrollTo(0, 0), scrollAfter);\r\n    }\r\n    scrollToBottom():void {\r\n        setTimeout(() => this.el.scrollTo(0, this.el.scrollTop + this.el.offsetHeight), scrollAfter);\r\n    }\r\n}\r\n\r\nexport interface ScrollProps {\r\n    onScroll?: (e:any) => void;\r\n    onScrollTop?: (scroller: Scroller) => Promise<boolean>;\r\n\tonScrollBottom?: (scroller: Scroller) => Promise<void>;\r\n\tclassName?: string;\r\n}\r\ninterface ScrollViewProps extends ScrollProps {\r\n\tclassName?: string;\r\n\tstyle?: React.CSSProperties;\r\n}\r\nconst scrollTimeGap = 100;\r\nabstract class ScrollViewBase<T extends ScrollViewProps> extends React.Component<T, null> {\r\n    private bottomTime:number = 0;\r\n\tprivate topTime:number = 0;\r\n\tprivate div: HTMLDivElement;\r\n\r\n\tprotected refDiv = (div:HTMLDivElement) => {\r\n\t\tif (!div) {\r\n\t\t\tif (this.div) {\r\n\t\t\t\tthis.div.removeEventListener('resize', this.onResize)\r\n\t\t\t}\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tthis.div = div;\r\n\t\tthis.div.addEventListener('resize', this.onResize);\r\n\t}\r\n\r\n\tprivate onResize = (ev:UIEvent) => {\r\n\t\tconsole.error('div resize');\r\n\t};\r\n\r\n    protected onScroll = async (e:any) => {\r\n        let {onScroll, onScrollTop, onScrollBottom} = this.props;\r\n        if (onScroll) onScroll(e);\r\n        let el = e.target as HTMLBaseElement;\r\n        let scroller = new Scroller(el);\r\n        if (el.scrollTop < 30) {\r\n            if (onScrollTop !== undefined) {\r\n                let topTime = new Date().getTime();\r\n                if (topTime-this.topTime > scrollTimeGap) {\r\n                    this.topTime = topTime;\r\n\t\t\t\t\tonScrollTop(scroller).then(ret => {\r\n\t\t\t\t\t\t // has more\r\n\t\t\t\t\t\tif (ret === true) {\r\n\t\t\t\t\t\t\tlet sh = el.scrollHeight;\r\n\t\t\t\t\t\t\tlet top = 200;\r\n\t\t\t\t\t\t\tif (top > sh) top = sh;\r\n\t\t\t\t\t\t\tel.scrollTop = top;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n                }\r\n            }\r\n        }\r\n        if (el.scrollTop + el.offsetHeight > el.scrollHeight - 30) {\r\n            //this.eachChild(this, 'bottom');\r\n            if (onScrollBottom !== undefined) {\r\n                let bottomTime = new Date().getTime();\r\n                if (bottomTime - this.bottomTime > scrollTimeGap) {\r\n                    this.bottomTime = bottomTime;\r\n                    onScrollBottom(scroller);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    private eachChild(c:any, direct:'top'|'bottom') {\r\n        let { props } = c;\r\n        if (props === undefined)\r\n            return;\r\n        let { children } = props;\r\n        if (children === undefined)\r\n            return;\r\n        React.Children.forEach(children, (child, index) => {\r\n            let {_$scroll} = child as any;\r\n            if (_$scroll) _$scroll(direct);\r\n            console.log(child.toString());\r\n            this.eachChild(child, direct);\r\n        });\r\n\t}\r\n}\r\n\r\nexport class ScrollView extends ScrollViewBase<ScrollViewProps> {\r\n    render() {\r\n\t\tlet {className, style} = this.props;\r\n\t\treturn <div ref={this.refDiv} className=\"tv-page\"\r\n\t\t\tonScroll={this.onScroll} style={style}>\r\n\t\t\t<article className={className}>\r\n\t\t\t\t{this.props.children}\r\n\t\t\t</article>\r\n\t\t</div>;\r\n    }\r\n}\r\n\r\nexport interface PageWebNav {\r\n\tnavHeader?: JSX.Element; \r\n\tnavRawHeader?: JSX.Element; \r\n\tnavFooter?: JSX.Element; \r\n\tnavRawFooter?: JSX.Element; \r\n\trenderPageHeader?: (props:PageHeaderProps)=>JSX.Element;\r\n}\r\ninterface WebNavScrollViewProps extends ScrollViewProps {\r\n\twebNav: PageWebNav;\r\n}\r\n\r\nexport class WebNavScrollView extends ScrollViewBase<WebNavScrollViewProps> {\r\n    render() {\r\n\t\tlet {className, style, webNav} = this.props;\r\n\t\tlet {navHeader, navRawHeader, navFooter, navRawFooter} = webNav;\r\n\t\tlet vHeader:any, vFooter:any;\r\n\t\tif (navRawHeader) vHeader = navRawHeader;\r\n\t\telse if (navHeader) vHeader = <header><main>{navHeader}</main></header>\r\n\t\tif (navRawFooter) vFooter = navRawFooter;\r\n\t\telse if (navFooter) vFooter = <footer><main>{navFooter}</main></footer>\r\n\r\n\t\treturn <div ref={this.refDiv} className=\"tv-page-webnav\"\r\n\t\t\tonScroll={this.onScroll} style={style}>\r\n\t\t\t{vHeader}\r\n\t\t\t<article className={className}>\r\n\t\t\t\t{this.props.children}\r\n\t\t\t</article>\r\n\t\t\t{vFooter}\r\n\t\t</div>;\r\n    }\r\n}\r\n","import _ from 'lodash';\r\n\r\nexport interface KeyValueRes {\r\n    [key:string]: any;\r\n}\r\n\r\nexport interface Res<T extends KeyValueRes> {\r\n    [lang:string]: T | {[district:string]: T};\r\n}\r\n\r\nexport const resOptions:{\r\n\tlang: string;\r\n\t$lang: string;\r\n\tdistrict: string;\r\n\t$district: string;\r\n} = {\r\n\tlang: undefined,\r\n\t$lang: undefined,\r\n\tdistrict: undefined,\r\n\t$district: undefined,\r\n}\r\n\r\nexport function setResOptions(lang:string, district:string) {\r\n\tresOptions.lang = lang;\r\n\tresOptions.$lang = '$' + lang;\r\n    resOptions.district = district;\r\n    resOptions.$district = '$' + district;\r\n}\r\n\r\n(function() {\r\n    let lang: string, district: string;\r\n    let language = (navigator.languages && navigator.languages[0])  // Chrome / Firefox\r\n        || navigator.language; // ||   // All browsers\r\n    //navigator.userLanguage; // IE <= 10\r\n    if (!language) {\r\n        lang = 'zh';\r\n        district = 'CN';\r\n    }\r\n    else {\r\n        let parts = language.split('-');\r\n        lang = parts[0];\r\n        if (parts.length > 1) district = parts[1].toUpperCase();\r\n    }\r\n    setResOptions(lang, district);\r\n}());\r\n\r\nexport function resLang<T extends KeyValueRes>(res:Res<T>):T {\r\n    let {lang, district} = resOptions;\r\n    let ret:T = {} as T;\r\n    if (res === undefined) return ret;\r\n    _.merge(ret, res._);\r\n    let l = res[lang];\r\n    if (l === undefined) return ret;\r\n    _.merge(ret, l._);\r\n    let d = l[district];\r\n    if (d === undefined) return ret;\r\n    _.merge(ret, d);\r\n    let {entity} = ret;\r\n    if (entity !== undefined) {\r\n        for (let i in entity) {\r\n            entity[i.toLowerCase()] = entity[i];\r\n        }\r\n    }\r\n    return ret;\r\n}\r\n\r\nconst resGlobal:any = {};\r\nexport function setRes(target: any, res: any):(str:string)=>any {\r\n\tif (res === undefined) return;\r\n\tlet {$lang, $district} = resOptions;\r\n\t_.merge(target, res);\r\n\tif ($lang !== undefined) {\r\n\t\tlet l = res[$lang];\r\n\t\tif (l !== undefined) {\r\n\t\t\t_.merge(target, l);\r\n\t\t\tlet d = l[$district];\r\n\t\t\tif (d !== undefined) {\r\n\t\t\t\t_.merge(target, d);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn function(str:string) {\r\n\t\treturn target[str] || str;\r\n\t}\r\n}\r\nexport function setGlobalRes(res: any) {\r\n\tsetRes(resGlobal, res);\r\n}\r\nexport function t(str:string):string|JSX.Element {\r\n\treturn resGlobal[str] || str;\r\n}\r\nexport type TFunc = (str:string|JSX.Element) => string|JSX.Element;\r\n","import { Entity } from './entity';\r\nimport { ActionCaller } from './caller';\r\n\r\nexport class UqAction<P, R> extends Entity {\r\n    get typeName(): string { return 'action';}\r\n    async submit(data:P, waiting: boolean = true) {\r\n\t\tlet caller = new ActionSubmitCaller(this, data)\r\n\t\tlet ret = await caller.request();\r\n\t\treturn ret;\r\n    }\r\n    async submitReturns(data:P):Promise<R> {\r\n       return await new SubmitReturnsCaller(this, data).request();\r\n    }\r\n    async submitConvert(data:P) {\r\n        return await new SubmitConvertCaller(this, data).request();\r\n    }\r\n}\r\n\r\nexport class Action extends UqAction<any, any> {\r\n}\r\n\r\nexport class ActionSubmitCaller extends ActionCaller {\r\n    get path():string {return 'action/' + this.entity.name;}\r\n    buildParams():any {\r\n\t\treturn {data: this.entity.pack(this.params)}\r\n\t}\r\n}\r\n\r\nclass SubmitReturnsCaller extends ActionSubmitCaller {\r\n    get path():string {return 'action/' + this.entity.name + '/returns';}\r\n    xresult(res:any):any {\r\n        let {returns} = this.entity;\r\n        let len = returns.length;\r\n        let ret:{[r:string]:any[]} = {};\r\n        for (let i=0; i<len; i++) {\r\n            let retSchema = returns[i];\r\n            ret[retSchema.name] = res[i];\r\n        }\r\n        return ret;\r\n    }\r\n}\r\n\r\nclass SubmitConvertCaller extends ActionSubmitCaller {\r\n    get path():string {return 'action-convert/' + this.entity.name;}\r\n    buildParams():any {\r\n        return {\r\n            data: this.params\r\n        };\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport {observer} from 'mobx-react';\r\nimport classNames from 'classnames';\r\nimport '../../css/va-lmr.css';\r\n\r\nexport interface LMRProps {\r\n    className?: string | string[];\r\n    left?: string|JSX.Element;\r\n    right?: string|JSX.Element;\r\n    onClick?: ()=>void;\r\n}\r\n\r\n@observer\r\nexport class LMR extends React.Component<LMRProps> {\r\n    render() {\r\n        let {className, left, children, right, onClick} = this.props;\r\n        let l, r;\r\n        if (left !== undefined) l = <header>{left}</header>;\r\n        if (right !== undefined) r = <footer>{right}</footer>;\r\n        let cursor;\r\n        if (onClick !== undefined) cursor = 'cursor-pointer';\r\n        return <div className={classNames('va-lmr', className, cursor)} onClick={onClick}>\r\n            {l}\r\n            <div>{children}</div>\r\n            {r}\r\n        </div>;\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport {observer} from 'mobx-react';\r\nimport classNames from 'classnames';\r\nimport '../../css/va-badge.css';\r\n\r\nexport interface BadgeProps {\r\n    className?: string;\r\n    badge?: string|number;\r\n    size?: 'xs' | 'sm' | 'lg';\r\n    color?: 'secondary'|'success'|'danger'|'primary'|'info'|'warning';\r\n    badgeAlign?: 'left'|'center'|'right';\r\n    badgeVertical?: 'top'|'middle'|'bottom';\r\n}\r\n\r\n@observer\r\nexport class Badge extends React.Component<BadgeProps> {\r\n    render() {\r\n        let {className, badge, size, color, badgeAlign, badgeVertical, children} = this.props;\r\n        let cn = classNames(\r\n            className,\r\n            'va-badge',\r\n            size && 'va-badge-'+size,\r\n            'va-badge-' + (color||'secondary'),\r\n            badgeAlign && 'va-badg-'+badgeAlign,\r\n            badgeVertical && 'va-badg-'+badgeVertical,\r\n        );\r\n        let b;\r\n        if (badge) b = <b>{badge}</b>;\r\n        return <div className={cn}>\r\n            {children}\r\n            {b}\r\n        </div>;\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport classNames from 'classnames';\r\n\r\nexport interface FAProps {\r\n    name: string;\r\n    className?: string;\r\n    size?: 'lg'|'2x'|'3x'|'4x'|'5x';\r\n    spin?: boolean;\r\n    fixWidth?: boolean;\r\n    border?: boolean;\r\n    pull?: 'left'|'right';\r\n    pulse?: boolean;\r\n    rotate?: 90|180|270;\r\n    flip?: 'horizontal'|'vertical';\r\n    inverse?: boolean;\r\n}\r\n\r\nexport class FA extends React.Component<FAProps> {\r\n    render() {\r\n        let {name, className, size, spin, fixWidth, border, pull, pulse, rotate, flip, inverse} = this.props;\r\n        let cn = classNames(className, 'fa',\r\n            name && ('fa-' + name),\r\n            size && 'fa-'+size,\r\n            fixWidth && 'fa-fw',\r\n            border && 'fa-border',\r\n            pull && 'fa-pull-' + pull,\r\n            spin && 'fa-spin',\r\n            pulse && 'fa-pulse',\r\n            rotate && 'fa-rotate-' + rotate,\r\n            flip && 'fa-flip-' + flip,\r\n            inverse && 'fa-inverse',\r\n        );\r\n        return <i className={cn} />\r\n    }\r\n}\r\n\r\nexport interface StackedFAProps {\r\n    className?: string;\r\n    size?: 'lg',\r\n}\r\nexport class StackedFA extends React.Component<StackedFAProps> {\r\n    render() {\r\n        let {className, size, children} = this.props;\r\n        let cn = classNames(\r\n            'fa-stack',\r\n            className,\r\n            size && 'fa-' + size);\r\n        return <span className={cn}>\r\n            {children}\r\n        </span>;\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport {FA} from './FA';\r\n\r\nexport interface IconTextProps {\r\n    icon: string;\r\n    iconClass?: string;\r\n    text: string | JSX.Element;\r\n    textClass?: string;\r\n}\r\n\r\nexport class IconText extends React.Component<IconTextProps> {\r\n    render() {\r\n        let {icon, iconClass, text, textClass} = this.props;\r\n        return <div className=\"py-2\">\r\n            <FA className={iconClass} name={icon} fixWidth={true} />\r\n            <span className={textClass}>{text}</span>\r\n        </div>;\r\n    }\r\n}\r\n","export * from './types';\r\nexport * from './store';\r\nexport * from './sortStocks';\r\nexport * from './stockGroup';\r\nexport * from './stockGroups';\r\nexport * from './miAccount';\r\nexport * from './miGroup';\r\nexport * from './holdingStock';","import _ from 'lodash';\r\n\r\nclass _LocalStorage {\r\n    getItem(key:string) {\r\n        return localStorage.getItem(key)\r\n    }\r\n    setItem(key:string, value:string) {\r\n        localStorage.setItem(key, value);\r\n    }\r\n    removeItem(key:string) {\r\n        localStorage.removeItem(key);\r\n    }\r\n}\r\n\r\nconst __ls = new _LocalStorage(); // new Ls;\r\n\r\nexport class LocalCache {\r\n    private readonly local: Local;\r\n    //private value: T;\r\n    readonly key: string|number;\r\n\r\n    constructor(local:Local, key:string|number) {\r\n        this.local = local;\r\n        this.key = key;\r\n    }\r\n    get():any {\r\n        try {\r\n            // 下面缓冲的内容不能有，可能会被修改，造成circular引用\r\n            //if (this.value !== undefined) return this.value;\r\n            let text = this.local.getItem(this.key);\r\n            if (text === null) return;\r\n            if (text === undefined) return undefined;\r\n            //return this.value = \r\n            return JSON.parse(text);\r\n        }\r\n        catch (err) {\r\n            this.local.removeItem(this.key);\r\n            return;\r\n        }\r\n    }\r\n    set(value:any) {\r\n\t\tlet t = JSON.stringify(value, (key, value) => {\r\n\t\t\tif (key !== '_tuid') return value;\r\n\t\t});\r\n\t\tthis.local.setItem(this.key, t);\r\n    }\r\n    remove(local?:Local) {\r\n        if (local === undefined) {\r\n            this.local.removeItem(this.key);\r\n        }\r\n        else {\r\n            this.local.removeLocal(local);\r\n        }\r\n    }\r\n    child(key:string|number):LocalCache {\r\n        return this.local.child(key);\r\n    }\r\n    arr(key:string|number):LocalArr {\r\n        return this.local.arr(key);\r\n    }\r\n    map(key:string|number):LocalMap {\r\n        return this.local.map(key);\r\n    }\r\n}\r\n\r\nabstract class Local {\r\n    private readonly caches: {[key:string]:LocalCache};\r\n    private readonly locals: {[key:string]:Local};\r\n    protected readonly name: string;\r\n    constructor(name: string) {\r\n        this.name = name;\r\n        this.caches = {};\r\n        this.locals = {};\r\n    }\r\n\r\n    protected abstract keyForGet(key:string|number):string;\r\n    protected abstract keyForSet(key:string|number):string;\r\n    protected abstract keyForRemove(key:string|number):string;\r\n    abstract removeAll():void;\r\n    getItem(key:string|number):string {\r\n        let k = this.keyForGet(key);\r\n        if (k === undefined) return;\r\n        return __ls.getItem(k);\r\n    }\r\n    setItem(key:string|number, value: string):void {\r\n        let k = this.keyForSet(key);\r\n        __ls.setItem(k, value);\r\n    }\r\n    removeItem(key:string|number):void {\r\n        let k = this.keyForSet(key);\r\n        if (k === undefined) return;\r\n        localStorage.removeItem(k);\r\n    }\r\n    arr(key:string|number):LocalArr {\r\n        let sk = String(key);\r\n        let arr = this.locals[sk] as LocalArr;\r\n        if (arr === undefined) {\r\n            let k = this.keyForSet(key);\r\n            this.locals[sk] = arr = new LocalArr(k);\r\n        }\r\n        return arr;\r\n    }\r\n    map(key:string|number):LocalMap {\r\n        let sk = String(key);\r\n        let map = this.locals[sk] as LocalMap;\r\n        if (map === undefined) {\r\n            let k = this.keyForSet(key);\r\n            this.locals[sk] = map = new LocalMap(k);\r\n        }\r\n        return map;\r\n    }\r\n    removeLocal(local:Local) {\r\n        let sk = local.name;\r\n        let k = this.keyForRemove(sk);\r\n        if (k === undefined) return;\r\n        let arr = this.locals[sk];\r\n        if (arr === undefined) arr = new LocalArr(k);\r\n        else this.locals[sk] = undefined;\r\n        arr.removeAll();\r\n    }\r\n    child(key:string|number):LocalCache {\r\n        let ks = String(key);\r\n        let ret = this.caches[ks];\r\n        if (ret !== undefined) return ret;\r\n        return this.caches[ks] =ret = new LocalCache(this, key);\r\n    }\r\n}\r\n\r\nconst maxArrSize = 500;\r\nexport class LocalArr extends Local {\r\n    private readonly index: number[];\r\n    constructor(name: string) {\r\n        super(name);\r\n        let index = __ls.getItem(this.name);\r\n        this.index = index === null? [] : index.split('\\n').map(v => Number(v));\r\n    }\r\n    private saveIndex() {\r\n        __ls.setItem(this.name, this.index.join('\\n'));\r\n    }\r\n    protected keyForGet(key:number):string {\r\n        let i = _.indexOf(this.index, key);\r\n        if (i < 0) return undefined;\r\n        return `${this.name}.${key}`;\r\n    }\r\n    protected keyForSet(key:number):string {\r\n        let i = _.indexOf(this.index, key);\r\n        if (i<0) {\r\n            this.index.unshift(key);\r\n            if (this.index.length > maxArrSize) this.index.pop();\r\n        }\r\n        else {\r\n            this.index.splice(i, 1);\r\n            this.index.unshift(key)\r\n        }\r\n        this.saveIndex();\r\n        return `${this.name}.${key}`;\r\n    }\r\n    protected keyForRemove(key:number):string {\r\n        let i = _.indexOf(this.index, key);\r\n        if (i<0) return;\r\n        this.index.splice(i, 1);\r\n        this.saveIndex();\r\n        return `${this.name}.${key}`;\r\n    }\r\n    removeAll():void {\r\n        for (let i of this.index) {\r\n            __ls.removeItem(`${this.name}.${i}`);\r\n        }\r\n        __ls.removeItem(this.name);\r\n        this.index.splice(0);\r\n    }\r\n    item(index:number):LocalCache {\r\n        return this.child(index);\r\n    }\r\n}\r\n\r\nexport class LocalMap extends Local {\r\n    private readonly index: {[key:string]:number};\r\n    private max: number;\r\n    constructor(name: string) {\r\n        super(name);\r\n        this.max = 0;\r\n        this.index = {};\r\n        let index = __ls.getItem(this.name);\r\n        if (index !== null) {\r\n            let ls = index.split('\\n');\r\n            ls.forEach(l => {\r\n                let p = l.indexOf('\\t');\r\n                if (p<0) return;\r\n                let key = l.substr(0, p);\r\n                let i = Number(l.substr(p+1));\r\n                if (isNaN(i) === true) return;\r\n                this.index[key] = i;\r\n                if (i>this.max) this.max = i;\r\n            });\r\n        }\r\n    }\r\n    private saveIndex() {\r\n        let ls:string[] = [];\r\n        for (let k in this.index) {\r\n            let v = this.index[k];\r\n            if (v === undefined) continue;\r\n            ls.push(`${k}\\t${v}`);\r\n        }\r\n        __ls.setItem(this.name, ls.join('\\n'));\r\n    }\r\n    protected keyForGet(key:number):string {\r\n        let i = this.index[key];\r\n        if (i === undefined) return undefined;\r\n        return `${this.name}.${i}`;\r\n    }\r\n    protected keyForSet(key:number):string {\r\n        let i = this.index[key];\r\n        if (i === undefined) {\r\n            ++this.max;\r\n            i = this.max;\r\n            this.index[key] = i;\r\n            this.saveIndex();\r\n        }\r\n        return `${this.name}.${i}`;\r\n    }\r\n    protected keyForRemove(key:string|number):string {\r\n        let i = this.index[key];\r\n        if (i===undefined) return;\r\n        this.index[key] = undefined;\r\n        this.saveIndex();\r\n        return `${this.name}.${i}`;\r\n    }\r\n    removeAll():void {\r\n        for (let i in this.index) {\r\n            __ls.removeItem(`${this.name}.${this.index[i]}`);\r\n            this.index[i] = undefined;\r\n        }\r\n        __ls.removeItem(this.name);\r\n        this.max = 0;\r\n    }\r\n    item(key:string):LocalCache {\r\n        return this.child(key);\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport { BoxId } from './boxId';\r\nimport { Tuid } from './tuid';\r\nimport { observer } from 'mobx-react';\r\n\r\nconst TuidContent = (tuidName:string, values:any, x?:any) => {\r\n    return <>{tuidName}: {uqStringify(values)}</>;\r\n};\r\n\r\nexport function uqStringify(values: any): string {\r\n    let s = '{';\r\n    if (values === undefined) return 'undefined';\r\n    for (let i in values) {\r\n        let v = values[i];\r\n        s += i + ': ';\r\n        if (v === undefined) {\r\n            s += 'undefined';\r\n        }\r\n        else if (v === null) {\r\n            s += 'null';\r\n        }\r\n        else {\r\n            switch (typeof v) {\r\n                default:\r\n                    s += v;\r\n                    break;\r\n                case 'function':\r\n                    s += 'function';\r\n                    break;\r\n                case 'object':\r\n                    s += '{obj}';\r\n                    break;\r\n            }\r\n        }\r\n        s += ', ';\r\n    }\r\n    return s + '}';\r\n}\r\n\r\nexport class ReactBoxId implements BoxId {\r\n    readonly id: number;\r\n    protected tuid: Tuid;\r\n    protected ui: (values:any) => JSX.Element;\r\n    readonly isUndefined:boolean;\r\n    constructor(id: number, tuid: Tuid, ui: (values:any) => JSX.Element) {\r\n        this.id = Number(id);\r\n        this.tuid = tuid;\r\n        this.ui = ui;\r\n        this.isUndefined = (this.tuid === undefined);\r\n    }\r\n\r\n    get obj():any {\r\n        return this.tuid.valueFromId(this.id);\r\n    }\r\n\r\n    equ(id:BoxId|number): boolean {\r\n        if (id === undefined || id === null) return false;\r\n        if (typeof id === 'object') return this.id === id.id;\r\n        return this.id === id;\r\n    }\r\n\r\n    render(ui:TvTemplet, x:any):JSX.Element {\r\n        if (this.id === undefined || this.id === null || isNaN(this.id) === true) return;\r\n        let boxName = this.boxName; // this.tuid.name;\r\n        let val = this.obj; // this.tuid.valueFromId(this.id);\r\n        if (this.isUndefined === true) {\r\n            if (ui !== undefined) return ui(val, x);\r\n            return TuidContent(boxName, val, x);\r\n        }\r\n        switch (typeof val) {\r\n            case 'undefined':\r\n                return <span className=\"text-black-50\">{boxName} undefined</span>;\r\n            case 'number':\r\n                return <span className=\"text-light\">{boxName} {this.id}</span>;\r\n        }\r\n        if (ui === undefined) {\r\n            ui = this.ui;\r\n        }\r\n        if (ui !== undefined) {\r\n            if (typeof ui !== 'function') {\r\n                ui = (ui as any).content;\r\n            }\r\n            if (ui !== undefined) {\r\n                let ret = ui(val/*, this.tuidUR.res*/);\r\n                if (ret !== undefined) return ret;\r\n                return <span className=\"text-danger\">{boxName} {this.id}</span>;\r\n            }\r\n        }\r\n\r\n        return TuidContent(boxName, val);\r\n    }\r\n\r\n    get boxName():string {return this.tuid.name}\r\n    // ui(): TvTemplet {return this.tuid.ui}\r\n    // res(): any {return this.tuid.res}\r\n\r\n    async assure(): Promise<BoxId> {\r\n        await this.tuid.assureBox(this.id);\r\n        return this;\r\n    }\r\n}\r\n\r\nfunction boxIdContent(bi: number|BoxId, ui:TvTemplet, x:any) {\r\n    let logContent:any;\r\n    let boxId:ReactBoxId = bi as ReactBoxId;\r\n    switch(typeof bi) {\r\n        case 'undefined': logContent = <>boxId undefined</>; break;\r\n        case 'number': logContent = <>id:{bi}</>; break;\r\n        default:\r\n            if (typeof boxId.render !== 'function') {\r\n                if (ui === undefined) {\r\n                    logContent = TuidContent(boxId.boxName, bi, x);\r\n                }\r\n                else {\r\n                    return ui(bi, x);\r\n                }\r\n            }\r\n            break;\r\n    }\r\n    if (logContent !== undefined) {\r\n        return <del className=\"text-danger\">{logContent}</del>;\r\n    }\r\n    return boxId.render(ui, x);\r\n}\r\n\r\nexport type TvTemplet = (values?:any, x?:any) => JSX.Element;\r\n\r\ninterface Props {\r\n    tuidValue: number|BoxId, \r\n    ui?: TvTemplet,\r\n    x?: any,\r\n    nullUI?: ()=>JSX.Element\r\n}\r\n\r\nconst Tv = observer(({tuidValue, ui, x, nullUI}:Props) => {\r\n    if (tuidValue === undefined) {\r\n        if (nullUI === undefined) return <small className=\"text-muted\">[无]</small>;\r\n        return nullUI();\r\n    }\r\n    if (tuidValue === null) {\r\n        if (nullUI === undefined) return <>[null]</>;\r\n        return nullUI();\r\n    }\r\n    let ttv = typeof tuidValue;\r\n    switch (ttv) {\r\n        default:\r\n            if (ui === undefined)\r\n                return <>{ttv}-{tuidValue}</>;\r\n            else {\r\n                let ret = ui(tuidValue, x);\r\n                if (ret !== undefined) return ret;\r\n                return <>{tuidValue}</>;\r\n            }\r\n        case 'object':\r\n            let divObj = boxIdContent(tuidValue, ui, x);\r\n            if (divObj !== undefined) return divObj;\r\n            return nullUI === undefined? <>id null</>: nullUI();\r\n        case 'number':\r\n            return <>id...{tuidValue}</>;\r\n    }\r\n});\r\n\r\nexport const tv = (tuidValue:number|BoxId, ui?:TvTemplet, x?:any, nullUI?:()=>JSX.Element):JSX.Element => {\r\n    return <Tv tuidValue={tuidValue} ui={ui} x={x} nullUI={nullUI} />;\r\n};\r\n","import * as React from 'react';\r\n\r\nexport function Loading() {\r\n    return <div className=\"d-flex h-100 align-items-center justify-content-center\">\r\n        <i className=\"fa fa-spinner fa-spin fa-2x fa-fw text-info\" />\r\n    </div>;\r\n}\r\n","import { from62 } from './62';\r\nimport { LocalMap } from './localDb';\r\n\r\nexport const env = (function () {\r\n\tlet {unit, testing, params, lang, district, timeZone} = initEnv();\r\n    return {\r\n\t\tunit,\r\n\t\ttesting,\r\n\t\tparams,\r\n\t\tlang, \r\n\t\tdistrict,\r\n\t\ttimeZone,\r\n\t\tbrowser: detectBrowser(), \r\n        isDevelopment: process.env.NODE_ENV === 'development',\r\n        localDb: new LocalMap(testing===true? '$$':'$'),\r\n        setTimeout: (tag:string, callback: (...args: any[]) => void, ms: number, ...args: any[]):NodeJS.Timer => {\r\n            return global.setTimeout(callback, ms, ...args);\r\n        },\r\n        clearTimeout: (handle:NodeJS.Timer):void => {\r\n            global.clearTimeout(handle);\r\n        },\r\n        setInterval: (callback: (...args: any[]) => void, ms: number, ...args: any[]): NodeJS.Timer => {\r\n            return global.setInterval(callback, ms, ...args);\r\n        },\r\n        clearInterval: (handle:NodeJS.Timer):void => {\r\n            global.clearInterval(handle);\r\n        }\r\n    }\r\n}());\r\n\r\nfunction initEnv(): {\r\n\tunit: number; \r\n\ttesting: boolean; \r\n\tparams: {[key:string]: string}; \r\n\tlang: string; \r\n\tdistrict: string;\r\n\ttimeZone: number;}\r\n{\r\n\tlet pl     = /\\+/g,  // Regex for replacing addition symbol with a space\r\n        search = /([^&=]+)=?([^&]*)/g,\r\n        decode = function (s:any) { return decodeURIComponent(s.replace(pl, \" \")); },\r\n        query  = window.location.search.substring(1);\r\n    let params:{[key:string]:string} = {};\r\n    for (;;) {\r\n\t   let match = search.exec(query);\r\n\t   if (!match) break;\r\n       params[decode(match[1])] = decode(match[2]);\t\r\n\t}\r\n\r\n\tlet testing:boolean; // = isTesting();\r\n\tlet unit:number;\r\n\r\n\tlet sUnit = params['u'] || params['unit'];\r\n\tif (sUnit) {\r\n\t\tlet p = sUnit.indexOf('-');\t\t\r\n\t\tif (p>=0) {\r\n\t\t\tlet tc = sUnit.charCodeAt(p+1);\r\n\t\t\tconst tt = 'tT';\r\n\t\t\ttesting = tc === tt.charCodeAt(0) || tc === tt.charCodeAt(1);\r\n\t\t\tsUnit = sUnit.substr(0, p);\r\n\t\t}\r\n\t\telse {\r\n\t\t\ttesting = false;\r\n\t\t}\r\n\t\tif (sUnit[0] === '0') {\r\n\t\t\tunit = Number(sUnit);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tunit = from62(sUnit);\r\n\t\t}\r\n\t\tif (isNaN(unit) === true) unit = undefined;\r\n\t}\r\n\telse {\r\n\t\t// 下面都是为了兼容以前的操作。\r\n\t\t// 整个url上，只要有test作为独立的字符串出现，就是testing\r\n\t\ttesting = /(\\btest\\b)/i.test(document.location.href);\r\n\t\tlet unitName:string;\r\n\t\tlet el = document.getElementById('unit');\r\n\t\tif (el) {\r\n\t\t\tunitName = el.innerText;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tel = document.getElementById('unit.json');\r\n\t\t\tif (el) {\r\n\t\t\t\tlet json = el.innerHTML;\r\n\t\t\t\tif (json) {\r\n\t\t\t\t\tlet res = JSON.parse(json);\r\n\t\t\t\t\tunitName = res?.unit;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (!unitName) {\r\n\t\t\tunitName = process.env.REACT_APP_UNIT;\r\n\t\t}\r\n\r\n\t\tif (unitName) {\r\n\t\t\tunit = Number.parseInt(unitName);\r\n\t\t\tif (Number.isInteger(unit) === false) {\r\n\t\t\t\tif (unitName === '百灵威') {\r\n\t\t\t\t\tunit = 24;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (!unit) unit = 0;\r\n\t}\r\n    let lang: string, district: string;\r\n    let language = (navigator.languages && navigator.languages[0])  // Chrome / Firefox\r\n        || navigator.language; // ||   // All browsers\r\n    //navigator.userLanguage; // IE <= 10\r\n    if (!language) {\r\n        lang = 'zh';\r\n        district = 'CN';\r\n    }\r\n    else {\r\n        let parts = language.split('-');\r\n        lang = parts[0];\r\n        if (parts.length > 1) district = parts[1].toUpperCase();\r\n    }\r\n\tlet timeZone = -new Date().getTimezoneOffset() / 60;\r\n\treturn {unit, testing, params, lang, district, timeZone};\r\n}\r\n\r\nfunction detectBrowser() { \r\n    if((navigator.userAgent.indexOf(\"Opera\") || navigator.userAgent.indexOf('OPR')) >= 0 )\r\n        return 'Opera';\r\n\tif(navigator.userAgent.indexOf(\"Chrome\") >= 0 )\r\n        return 'Chrome';\r\n\tif(navigator.userAgent.indexOf(\"Safari\") >= 0)\r\n        return 'Safari';\r\n\tif(navigator.userAgent.indexOf(\"Firefox\") >= 0 )\r\n        return 'Firefox';\r\n\tif((navigator.userAgent.indexOf(\"MSIE\") >= 0 ) || (!!(document as any).documentMode === true ))\r\n        return 'IE'; //crap\r\n    return 'Unknown';\r\n}\r\n","import { User } from '../tool';\r\n\r\nexport interface Login {\r\n\tshowLogin(callback?: (user:User)=>Promise<void>, withBack?:boolean):void;\r\n\tshowLogout(callback?: ()=>Promise<void>):void\r\n\t//showRegister():void\r\n\t//showForget():void\r\n\tshowChangePassword():void\r\n}\r\n\r\nexport async function createLogin():Promise<Login> {\r\n\tlet importCLogin = await import('../auth/CLogin');\r\n\treturn new importCLogin.CLogin();\r\n}\r\n\r\nexport async function showRegister():Promise<void> {\r\n\tlet importCRegister = await import('../auth/register/CRegister');\r\n\tlet c = new importCRegister.CRegister();\r\n\tc.start();\r\n}\r\n\r\nexport async function showForget():Promise<void> {\r\n\tlet importCRegister = await import('../auth/register/CRegister');\r\n\tlet c = new importCRegister.CForget();\r\n\tc.start();\r\n}\r\n","export * from './uqMan';\r\nexport * from './entity';\r\nexport * from './action';\r\nexport * from './query';\r\nexport * from './sheet';\r\nexport * from './tuid';\r\nexport * from './book';\r\nexport * from './map';\r\nexport * from './history';\r\nexport * from './pending';\r\nexport * from './uqsMan';\r\nexport * from './tag/tag';\r\nexport * from './enum';\r\nexport * from './build';\r\nexport * from './ID';\r\n","\r\nexport * from './boxId';\r\nexport * from './tuid';\r\nexport { TuidsCache } from './tuidsCache';\r\nexport { tv, ReactBoxId, uqStringify } from './reactBoxId';","import { TFunc } from \"../res\";\r\nimport { Entity } from \"./entity\";\r\nimport { Render, UI } from '../ui';\r\n\r\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\nexport abstract class IDXEntity<M> extends Entity {\r\n\treadonly ui: UI;\r\n\treadonly render: Render<M>;\r\n\treadonly t: TFunc;\r\n}\r\n\r\nexport class UqID<M> extends IDXEntity<M> {\r\n\tget typeName() {return 'id'}\r\n\tasync NO(): Promise<string> {\r\n\t\tlet ret = await this.uqApi.post('id-no', {ID:this.name});\r\n\t\treturn ret;\r\n\t};\r\n}\r\n\r\nexport class ID extends UqID<any> {\t\r\n}\r\n\r\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\nexport class UqIDX<M> extends IDXEntity<M> {\r\n\tget typeName() {return 'idx'}\r\n}\r\n\r\nexport class IDX extends UqIDX<any> {\r\n}\r\n\r\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\nexport class UqIX<M> extends IDXEntity<M> {\r\n\tget typeName() {return 'ix'}\r\n}\r\n\r\nexport class IX extends UqIX<any> {\r\n}\r\n\r\n/* eslint-enable no-unused-vars */\r\n","function getsortFunc(sortType:string) {\r\n\tswitch (sortType) {\r\n\t\tcase 'tagpe':\r\n\t\t\treturn (a:any, b:any) => a.pe - b.pe;\r\n\t\tcase 'tagdp': \r\n\t\t\treturn (a:any, b:any) => b.divyield - a.divyield;\r\n\t\tdefault:\r\n\t\t\treturn (a:any, b:any) => b.v - a.v;\r\n\t}\r\n}\r\n\r\nexport function sortStocks(sortType:string, arr:any[]) {\r\n\tarr.sort(getsortFunc(sortType));\r\n\tlet o = 1;\r\n\tfor (let item of arr) {\r\n\t\titem.order = o;\r\n\t\t++o;\r\n\t}\r\n}\r\n","//=== UqApp builder created on Tue Mar 23 2021 11:33:56 GMT-0400 (GMT-04:00) ===//\r\nimport { CSub, CBase, CAppBase, IConstructor } from 'tonva-react';\r\nimport { UQs } from './uqs';\r\nimport { CApp } from './CApp';\r\n\r\nexport abstract class CUqBase extends CBase<CApp, UQs> {\r\n}\r\n\r\nexport abstract class CUqSub<A extends CAppBase<U>, U, T extends CBase<A,U>> extends CSub<A, U, T> {\r\n}\r\n\r\nexport abstract class CUqApp extends CAppBase<UQs> {\r\n\tprotected newC<T extends CUqBase>(type: IConstructor<T>): T {\r\n\t\tlet c = new type(this);\r\n\t\tc.init();\r\n\t\treturn c;\r\n\t}\r\n}\r\n","import { UQs } from \"uq-app\";\r\nimport { Log } from \"../Logger\";\r\n\r\nexport const testTimesChange = {\r\n\tname: 'TimesChange', \r\n\tdiscription: 'Test Times Change hours', \r\n\ttest: async (log: Log, uqs: UQs):Promise<void> => {\r\n\t\t/*\r\n\t\tlet tc = uqs.BzTimesChange;\r\n\t\tlet ret = await tc.IDActs({\r\n\t\t\tstaff: [\r\n\t\t\t\t{id: undefined, no: '101', firstName: 'Song', lastName: 'Sha'}\r\n\t\t\t]\r\n\t\t});\r\n\t\tlog(ret);\r\n\t\tlet id = 13369344;\r\n\t\tlet r1 = await tc.IDActs({\r\n\t\t\thours: [\r\n\t\t\t\t{id, onsite:{value: 3, time: new Date(2021, 0, 1)}}\r\n\t\t\t]\r\n\t\t});\r\n\t\tlog(r1);\r\n\r\n\t\tlet month = await tc.IDLog({\r\n\t\t\tIDX: tc.Hours,\r\n\t\t\tfield: 'onsite',\r\n\t\t\tid,\r\n\t\t\tlog: 'month',\r\n\t\t\ttimeZone: -5,\r\n\t\t\tpage: {\r\n\t\t\t\tstart: undefined,\r\n\t\t\t\tend: new Date(2021,0,1).getTime(),\r\n\t\t\t\tsize: 10,\r\n\t\t\t}\r\n\t\t});\r\n\t\tlog(month);\r\n\r\n\t\tlet sum = await tc.IDSum({\r\n\t\t\tIDX: tc.Hours,\r\n\t\t\tfield: ['onsite'],\r\n\t\t\tid: [id],\r\n\t\t\tfar: undefined,\r\n\t\t\tnear: new Date().getTime(),\r\n\t\t});\r\n\t\tlog(sum);\r\n\t\t*/\r\n\t}\r\n}\r\n","import { DebugItem } from \"../CBug\";\r\nimport { testTimesChange } from \"./test-times-change\";\r\nimport { testItem1 } from \"./test1\";\r\nimport { testItem2 } from \"./test2\";\r\nimport { testItem3 } from \"./test3\";\r\nimport { testItem4 } from \"./test4\";\r\n\r\nexport const debugItems: DebugItem[] = [\r\n\ttestItem1,\r\n\ttestItem2,\r\n\ttestItem3,\r\n\ttestItem4,\r\n\ttestTimesChange,\r\n];\r\n","import { DebugItem } from \"../CBug\";\r\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\nimport { UQs } from \"uq-app\";\r\nimport { Log } from \"../Logger\";\r\n\r\n//BzTest, BzHelloTonva, BzCustomerPayment, \r\n\r\nexport const testItem1:DebugItem = {\r\n\tname: 'HelloTonva.GetProductStock',\r\n\tdiscription: '{product: 1}',\r\n\ttest: async ( log: Log, uqs: UQs):Promise<void> => {\r\n\t\t/*\r\n\t\tlet a = await uqs.BzTest.ID({\r\n\t\t\tIDX: uqs.BzTest.X1,\r\n\t\t\tid: 7077888,\r\n\t\t});\r\n\t\tfor (let item of a) {\r\n\t\t\tlog(item);\r\n\t\t}\r\n\r\n\t\tlet e = await uqs.BzTest.IDActs({\r\n\t\t\ttag: [\r\n\t\t\t\t{id: undefined, type: 'a', name: 'b'},\r\n\t\t\t\t{id: undefined, type: 'a', name: 'c'},\r\n\t\t\t\t{id: undefined, type: 'd', name: 'c'},\r\n\t\t\t],\r\n\t\t\tx1: [\r\n\t\t\t\t{id: undefined, a1: 1, a2: 3, a3:5, n5: 7},\r\n\t\t\t\t{id: undefined, a1: 1, a2: 7, a3:51, n5: 71},\r\n\t\t\t],\r\n\t\t\tassign1: [\r\n\t\t\t\t{ix: 3, id: 5, val: 3},\r\n\t\t\t\t{ix: 3, id: 6, val: 30},\r\n\t\t\t],\r\n\t\t\tiBook1: [\r\n\t\t\t\t{id: 7, f1: 3.5, f2: 7.2, b: 'bbbb', c: 1},\r\n\t\t\t\t{id: 8, f1: 3.5, f2: 7.2, b: 'bbbbc', c: 2},\r\n\t\t\t],\r\n\t\t});\r\n\t\tlog(e);\r\n\r\n\t\tlet b = await uqs.BzTest.IDDetail<BzTest.OrderMaster, BzTest.OrderDetail>\r\n\t\t({\r\n\t\t\tmaster: {\r\n\t\t\t\tID: uqs.BzTest.OrderMaster,\r\n\t\t\t\tvalue: {customer: 1 },\r\n\t\t\t},\r\n\t\t\tdetail: {\r\n\t\t\t\tID: uqs.BzTest.OrderDetail,\r\n\t\t\t\tvalues: [\r\n\t\t\t\t\t{product:11, price:2.0, quantity:3.0, amount:6.0},\r\n\t\t\t\t\t{product:12, price:2.0, quantity:5.0, amount:10.0},\r\n\t\t\t\t]\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tlog(b);\r\n\r\n\t\tlet c = await uqs.BzTest.IDDetailGet<BzTest.OrderMaster, BzTest.OrderDetail>({\r\n\t\t\tid: 8716325,\r\n\t\t\tmaster: uqs.BzTest.OrderMaster,\r\n\t\t\tdetail: uqs.BzTest.OrderDetail,\r\n\t\t});\r\n\r\n\t\tfor (let ci of c) {\r\n\t\t\tlog(ci);\r\n\t\t}\r\n\r\n\t\t//let u: BzHelloTonva.Return$pokedRet;\r\n\t\t//u.poke = 1;\r\n\t\t// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n\t\tlet f = BzCustomerPayment.EnumCustomerAction.confirm;\r\n\r\n\t\tlet ret = await uqs.BzHelloTonva.GetProductStock.query({product: 1});\r\n\t\tlog(ret);\r\n\t\t*/\r\n\t\tlog('test1');\r\n\t\tlog('test1');\r\n\t\tlog('test1');\r\n\t\tlog('test1');\r\n\t\tlog('test1');\r\n\t\tlog('test1');\r\n\t\tlog('test1');\r\n\t\tlog('test1');\r\n\t}\r\n}","import { UQs } from \"uq-app\";\r\nimport { Log } from \"../Logger\";\r\n\r\nexport const testItem2 = {\r\n\tname: '第二测试', \r\n\tdiscription: 'second test', \r\n\ttest: async (log: Log, uqs: UQs):Promise<void> => {\r\n\t\t/*\r\n\t\tlet ret = await uqs.BzHelloTonva.TestArr.submitReturns({rows: [\r\n\t\t\t{a: 1, b: 2}, \r\n\t\t\t{a: 3, b: 4}, \r\n\t\t]});\r\n\t\tlog(ret);\r\n\t\tlog('test2 - ddd ');\r\n\t\tlog('test2 - ddd ');\r\n\t\tlog('test2 - ddd ');\r\n\t\tlog('test2 - ddd ');\r\n\t\tlog('test2 - ddd ');\r\n\t\tlog('test2 - ddd ');\r\n\t\tlog('test2 - ddd ');\r\n\t\tlog('test2 - ddd ');\r\n\t\t*/\r\n\t}\r\n}\r\n","import { UQs } from \"uq-app\";\r\nimport { Log } from \"../Logger\";\r\n\r\nexport const testItem3 = {\r\n\tname: '第三测试', \r\n\tdiscription: 'third test', \r\n\ttest: async (log: Log, uqs: UQs):Promise<void> => {\r\n\t\t/*\r\n\t\tlet a = await uqs.BzTest.IDLog({\r\n\t\t\tIDX: uqs.BzTest.IBook1,\r\n\t\t\tfield: 'f2',\r\n\t\t\tid: 7,\r\n\t\t\tlog: 'each',\r\n\t\t\tpage: {start:undefined, size: 50},\r\n\t\t});\r\n\t\tlog(a);\r\n\r\n\t\tlet b = await uqs.BzTest.KeyID({\r\n\t\t\tID: uqs.BzTest.X1,\r\n\t\t\tkey: {a1: 1, a2: undefined},\r\n\t\t});\r\n\t\tlog(b);\r\n\r\n\t\tlet c = await uqs.BzTest.IX({\r\n\t\t\tIX: uqs.BzTest.Assign1,\r\n\t\t\tid: 3,\r\n\t\t});\r\n\t\tlog(c);\r\n\r\n\t\tlet d = await uqs.BzTest.KeyIX({\r\n\t\t\tID: uqs.BzTest.X1,\r\n\t\t\tkey: {a1: 1, a2: undefined},\r\n\t\t\tIX: uqs.BzTest.Assign1,\r\n\t\t});\r\n\t\tlog(d);\r\n\r\n\t\tlet e = await uqs.BzTest.IDActs({\r\n\t\t\tiBook1: [\r\n\t\t\t\t{id: -7, f1: 3.5, f2: 7.2, b: 'bbbb', c: 1},\r\n\t\t\t]\r\n\t\t});\r\n\t\tlog(e);\r\n\r\n\t\tlet ret = await uqs.BzHelloTonva.TestArr.submitReturns({rows: [\r\n\t\t\t{a: 1, b: 2}, \r\n\t\t\t{a: 3, b: 4}, \r\n\t\t]});\r\n\t\tlog(ret);\r\n\t\tlog('test2 - ddd ');\r\n\t\tlog('test2 - ddd ');\r\n\t\tlog('test2 - ddd ');\r\n\t\tlog('test2 - ddd ');\r\n\t\tlog('test2 - ddd ');\r\n\t\tlog('test2 - ddd ');\r\n\t\tlog('test2 - ddd ');\r\n\t\tlog('test2 - ddd ');\r\n\t\t*/\r\n\t}\r\n}\r\n","import { UQs } from \"uq-app\";\r\nimport { Log } from \"../Logger\";\r\n\r\nexport const testItem4 = {\r\n\tname: 'Tag测试', \r\n\tdiscription: 'Tag Test', \r\n\ttest: async (log: Log, uqs: UQs):Promise<void> => {\r\n\t\t/*\r\n\t\tlet ret = await uqs.BzTest.IX({\r\n\t\t\tIX: uqs.BzTest.CustomerTag,\r\n\t\t\tid: 1,\r\n\t\t\tIDX: [uqs.BzTest.Tag],\r\n\t\t\tpage: undefined,\r\n\t\t});\r\n\t\tlog(ret);\r\n\t\t*/\r\n\t}\r\n}\r\n","import { FA, LMR, VPage } from \"tonva-react\";\r\nimport { CBug, DebugItem } from \"./CBug\";\r\n\r\nexport class VBug extends VPage<CBug> {\r\n\theader() {\r\n\t\treturn <div className=\"px-3\">\r\n\t\t\tDebug\r\n\t\t\t<small className=\"text-muted\"> - 本页仅调试状态可见</small>\r\n\t\t</div>\r\n\t}\r\n\tcontent() {\r\n        return <div>\r\n\t\t\t<div>\r\n\t\t\t\t{this.controller.debugItems.map(this.renderItem)}\r\n\t\t\t</div>\r\n\t\t\t<div className=\"px-3 py-2\">\r\n\t\t\t\t<button className=\"btn btn-primary\" onClick={this.controller.test}>test</button>\r\n\t\t\t</div>\r\n\t\t</div>;\r\n\t}\r\n\r\n\tprivate renderItem = (item:DebugItem, index:number):JSX.Element => {\r\n\t\tlet {name, discription} = item;\r\n\t\tlet right = <FA name=\"angle-right\" />;\r\n\t\treturn <LMR key={index} className=\"px-3 py-2 cursor-pointer mt-1 bg-white\"\r\n\t\t\tonClick={() => this.controller.openDebugPage(item)}\r\n\t\t\tright={right}>\r\n\t\t\t<div>{name} <small className=\"text-muted\">{discription}</small></div>\r\n\t\t</LMR>;\r\n\t}\r\n}","import { VPage } from \"tonva-react\";\r\nimport { CBug } from \"./CBug\";\r\n\r\nexport class VConsole extends VPage<CBug> {\r\n\tprivate div: HTMLDivElement;\r\n\tprivate divBottom: HTMLDivElement;\r\n\tinit() {\r\n\t\tthis.startAutoScrollToBottom();\r\n\t}\r\n\theader() {\r\n\t\treturn this.controller.currentItem.name;\r\n\t}\r\n\tcontent() {\r\n\t\tlet {currentItem} = this.controller;\r\n\t\tlet {name, discription} = currentItem;\r\n\t\treturn <div>\r\n\t\t\t<div className=\"p-3\">\r\n\t\t\t<div><b>{name}</b></div>\r\n\t\t\t<div>{discription}</div>\r\n\t\t\t</div>\r\n\t\t\t<div ref={t => this.div = t} className=\"p-3 border-top border-primary bg-light\" />\r\n\t\t\t<div ref={t => this.divBottom = t} />\r\n\t\t</div>;\r\n\t}\r\n\r\n\tprivate autoScrollEnd:boolean = false;\r\n\tprivate autoScroll = true;\r\n    private lastScrollTop = 0;\r\n    private timeHandler:any;\r\n    private startAutoScrollToBottom() {\r\n\t\tif (this.autoScrollEnd === true) return;\r\n\t\tthis.autoScroll = true;\r\n\t\tif (this.timeHandler !== undefined) return;\r\n        this.timeHandler = setInterval(() => {\r\n\t\t\tif (this.autoScroll === false) return;\r\n            this.divBottom?.scrollIntoView();\r\n        }, 100);\r\n    }\r\n    private endAutoScrollToBottom() {\r\n        setTimeout(() => {\r\n\t\t\tthis.autoScroll = false;\r\n\t\t\tthis.autoScrollEnd = true;\r\n\t\t\tif (this.timeHandler === undefined) return;\r\n\t\t\tclearInterval(this.timeHandler);\r\n\t\t\tthis.timeHandler = undefined;\r\n\t\t}, 300);\r\n\t}\r\n\tprivate pauseAutoScrollToBottom() {\r\n\t\tthis.autoScroll = false;\r\n\t}\r\n\tprotected onPageScroll(e:any) {\r\n        let el = e.target as HTMLBaseElement;\r\n        let {scrollTop, scrollHeight, offsetHeight} = el;\r\n        if (scrollTop <= this.lastScrollTop) {\r\n            this.pauseAutoScrollToBottom();\r\n        }\r\n        else if (scrollTop + offsetHeight > scrollHeight - 30) {\r\n            this.startAutoScrollToBottom();\r\n        }\r\n\r\n        this.lastScrollTop = scrollTop;\r\n\t}\r\n\r\n\tlog = (message?: any):void => {\r\n\t\tconst range = document.createRange();\r\n\t\trange.selectNode(this.div);\r\n\t\tlet html:string;\r\n\t\tif (!message) {\r\n\t\t\thtml = '<div>&nbsp;</div>';\r\n\t\t}\r\n\t\telse if (typeof message === 'object') {\r\n\t\t\thtml = this.objToHtml(message);\r\n\t\t}\r\n\t\telse {\r\n\t\t\thtml = '<div>' + message + '</div>';\r\n\t\t}\r\n\t\tconst child = range.createContextualFragment(html);\r\n\t\tthis.div.appendChild(child);\r\n\t}\r\n\r\n\tprivate objToHtml(obj: any) {\r\n\t\tif (obj === null) return '<div>null</div>';\r\n\t\tif (obj === undefined) return '<div>undefined</div>';\r\n\t\tif (Array.isArray(obj) === true) {\r\n\t\t\treturn this.arrToHtml(0, obj);\r\n\t\t}\r\n\t\tlet ret = '<div>{</div>';\r\n\t\tfor (let i in obj) {\r\n\t\t\tret += this.indent(1) + i + ': ';\r\n\t\t\tlet v = obj[i];\r\n\t\t\tif (Array.isArray(v) === true) {\r\n\t\t\t\tret += this.arrToHtml(1, v);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tret += this.objToString(v);\r\n\t\t\t}\r\n\t\t}\r\n\t\tret += '<div>}</div>';\r\n\t\treturn ret;\r\n\t}\r\n\r\n\tprivate indent(n:number) {\r\n\t\tif (!n) return '';\r\n\t\tlet ret = '';\r\n\t\tn = n*2;\r\n\t\tfor (let i=0; i<n; i++) ret += '&emsp;';\r\n\t\treturn ret;\r\n\t}\r\n\r\n\tprivate objToString(obj: any) {\r\n\t\tif (obj === null) {\r\n\t\t\treturn 'null';\r\n\t\t}\r\n\t\tif (Array.isArray(obj) === true) {\r\n\t\t\treturn 'array[' + obj.length + ']';\r\n\t\t}\r\n\t\tswitch (typeof obj) {\r\n\t\tdefault: return obj.toString();\r\n\t\tcase 'undefined': return 'undefined';\r\n\t\tcase 'object':\r\n\t\t\tif (obj.tuid === undefined) {\r\n\t\t\t\treturn 'obj';\r\n\t\t\t}\r\n\t\t\treturn obj.id;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate objToLine(indent:number, obj:any) {\r\n\t\tlet first = true;\r\n\t\tlet ret = '<div>' + this.indent(indent) + '{ ';\r\n\t\tfor (let i in obj) {\r\n\t\t\tif (first === false) {\r\n\t\t\t\tret += ', ';\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tfirst = false;\r\n\t\t\t}\r\n\t\t\tret += i + ':' + this.objToString(obj[i]);\r\n\t\t}\r\n\t\tret += ' }</div>';\r\n\t\treturn ret;\r\n\t}\r\n\r\n\tprivate indentVal(indent:number, val:any):string {\r\n\t\treturn '<div>' + this.indent(indent) + val + '</div>'\r\n\t}\r\n\tprivate arrToHtml(indent:number, arr:any[]) {\r\n\t\tlet ret = '<div>' + this.indent(indent) + '[</div>';\r\n\t\tfor (let item of arr) {\r\n\t\t\tlet t:string|number;\r\n\t\t\tswitch (typeof item) {\r\n\t\t\t\tdefault: t = this.indentVal(indent+1, item); break;\r\n\t\t\t\tcase 'object': t = this.objToLine(indent+1, item); break;\r\n\t\t\t\tcase 'string': t = this.indentVal(indent+1, `'${item}'`); break;\r\n\t\t\t}\r\n\t\t\tret += t;\r\n\t\t}\r\n\t\tret += '<div>' + this.indent(indent) + ']</div>';\r\n\t\treturn ret;\r\n\t}\r\n}\r\n","import { CUqBase, UQs } from \"uq-app\";\r\nimport { Log } from \"./Logger\";\r\nimport { debugItems } from \"./tester\";\r\nimport { VBug } from \"./VBug\";\r\nimport { VConsole } from \"./VConsole\";\r\n\r\nexport interface DebugItem {\r\n\tname: string;\r\n\tdiscription?: string;\r\n\ttest: (log:Log, uqs: UQs) => Promise<void>;\r\n}\r\n\r\nexport class CBug extends CUqBase {\r\n\tdebugItems = [...debugItems];\r\n\tcurrentItem: DebugItem;\r\n\r\n\tprotected async internalStart() {\r\n\t\tthis.openVPage(VBug);\r\n\t}\r\n\r\n\ttab = () => this.renderView(VBug);\r\n\r\n\tload = async () => {\r\n\r\n\t}\r\n\r\n\topenDebugPage = async (item:DebugItem) => {\r\n\t\tthis.currentItem = item;\r\n\t\tlet console = await this.openVPage(VConsole);\r\n\t\tlet {test} = item;\r\n\t\tlet start = new Date();\r\n\t\tconsole.log(`=== test start at ${start} ===`);\r\n\t\tconsole.log();\r\n\t\tawait test(console.log, this.uqs);\r\n\t\tlet span = Date.now() - start.getTime();\r\n\t\tlet ms = (1000 + (span % 1000)).toString().substr(1);\r\n\t\tlet s = Math.floor(span / 1000);\r\n\t\tlet m = Math.floor(s / 60);\r\n\t\tlet t = '';\r\n\t\tif (m > 0) t += ms + '\\'';\r\n\t\tt += s + '\"' + ms;\r\n\t\tconsole.log();\r\n\t\tconsole.log(`=== test end: ${t} ===`);\r\n\t}\r\n\r\n\ttest = async () => {\r\n\t\tlet uqName = 'BizDev/hello-tonva';\r\n\t\tlet roles = await this.getUqRoles(uqName);\r\n\t\talert(roles);\r\n\t}\r\n}\r\n","import { zh } from \"./zh\";\r\nimport { en } from \"./en\";\r\n\r\nexport const res = {\r\n\t$zh: zh,\r\n\t$en: en,\r\n}\r\n","export const zh = {\r\n\thome: '首页',\r\n\trelation: '关系',\r\n\tdiscover: '发现',\r\n\ttest: '测试',\r\n\tdebug: 'Debug',\r\n\tme: '我',\r\n\r\n\tchangePassword: '修改密码',\r\n\taboutTheApp: '关于本APP',\r\n\tlogout: '退出登录',\r\n\tpleaseLogin: '登录',\r\n\r\n\tcontent: '内容',\r\n\tbackend: '后台管理',\r\n\r\n\tmyAll: '自选股',\r\n\tmyBlack: '黑名单',\r\n}\r\n","export const en = {\r\n\thome: 'Home',\r\n\trelation: 'Relation',\r\n\tdiscover: 'Discover',\r\n\ttest: 'Test',\r\n\tdebug: 'Debug',\r\n\tme: 'Me',\r\n\r\n\tchangePassword: 'Change password',\r\n\taboutTheApp: 'About the APP',\r\n\tlogout: 'Logout',\r\n\tpleaseLogin: 'Login',\r\n\r\n\tcontent: 'Content',\r\n\tbackend: 'Backend Management',\r\n\r\n\tmyAll: 'All My Stock',\r\n\tmyBlack: 'Block List',\r\n}\r\n","//=== UqApp builder created on Tue Jan 05 2021 18:41:24 GMT-0500 (GMT-05:00) ===//\r\nimport { VPage, TabProp, TabCaptionComponent, TabsProps } from 'tonva-react';\r\nimport { CApp } from './CApp';\r\n\r\nconst color = (selected: boolean) => selected === true ? 'text-primary' : 'text-muted';\r\n/*\r\nfunction caption(label:string|JSX.Element, icon:string) {\r\n\treturn (selected: boolean) => TabCaptionComponent(label, icon, color(selected));\r\n}\r\n*/\r\nexport class VMain extends VPage<CApp> {\r\n\theader() {return false;}\r\n\r\n\tprotected get tabsProps(): TabsProps {\r\n\t\t/*\r\n\t\tlet { cHome, cBug, cMe, cUI } = this.controller;\r\n\t\tlet tabs: TabProp[] = [\r\n\t\t\t{name: 'home', caption: caption(t('home'), 'home'), content: cHome.tab},\r\n\t\t\t{name: 'me', caption: caption(t('me'), 'user-o'), content: cMe.tab, load: cMe.load},\r\n\t\t];\r\n\t\tif (this.isDev === true) {\r\n\t\t\ttabs.push({\r\n\t\t\t\tname: 'UI', caption: caption(t('UI'), 'television'), content: cUI.tab\r\n\t\t\t});\r\n\t\t\ttabs.push({\r\n\t\t\t\tname: 'debug', caption: caption(t('debug'), 'bug'), content: cBug.tab, onShown: cBug.load\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn {tabs};\r\n\t\t*/\r\n\t\tlet { cHome, cFind, cMe } = this.controller;\r\n\t\tlet tabs: TabProp[] = [\r\n\t\t\t/*{ \r\n\t\t\t\tname: 'home', label: '首页', icon: 'home', content: cHome.tab, \r\n\t\t\t\tnotify: undefined, \r\n\t\t\t\tload: cHome.load, \r\n\t\t\t\tonShown: cHome.load,\r\n\t\t\t},*/\r\n\t\t\t{\r\n\t\t\t\tname: 'home', label: '首页', icon: 'money', \r\n\t\t\t\tnotify: undefined,\r\n\t\t\t\tcontent: cHome.tab, //load: cGroup.load, onShow: cGroup.load,\r\n\t\t\t},\r\n\t\t\t/*{\r\n\t\t\t\tname: 'explorer', label: '持仓', icon: 'money', content: cHolding.tab, // load: cHolding.load \r\n\t\t\t},*/\r\n\t\t\t{\r\n\t\t\t\tname: 'find', label: '发现', icon: 'search', content: cFind.tab, load: cFind.load\r\n\t\t\t},\r\n\t\t\t/*\r\n\t\t\t{\r\n\t\t\t\tname: 'explorer', label: '选股', icon: 'search', content: cExporer.tab, load: cExporer.load\r\n\t\t\t},*/\r\n\t\t\t{\r\n\t\t\t\tname: 'me', label: '我的', icon: 'user', content: cMe.tab, onShown: undefined\r\n\t\t\t}\r\n\t\t].map(v => {\r\n\t\t\tlet { name, label, icon, content, notify, load, onShown } = v;\r\n\t\t\treturn {\r\n\t\t\t\tname,\r\n\t\t\t\tcaption: (selected: boolean) => TabCaptionComponent(label, icon, color(selected)),\r\n\t\t\t\tcontent,\r\n\t\t\t\tnotify,\r\n\t\t\t\tload,\r\n\t\t\t\tonShown,\r\n\t\t\t};\r\n\t\t});\r\n\t\treturn {tabs};\r\n\t}\r\n\r\n\t/*\r\n\tprotected get webNav(): PageWebNav {\r\n\t\treturn {\r\n\t\t\tnavHeader: <div>webNav header</div>, \r\n\t\t\tnavFooter: <div>webNav footer</div>,\r\n\t\t};\r\n\t}\r\n\t*/\r\n}\r\n","import { FA, LMR, VPage } from \"tonva-react\";\r\nimport { CTester, UIItem } from \"./CTest\";\r\n\r\nexport class VTester extends VPage<CTester> {\r\n\theader() {\r\n\t\treturn <div className=\"px-3\">\r\n\t\t\tUI\r\n\t\t\t<small className=\"text-muted\"> - 本页仅调试状态可见</small>\r\n\t\t</div>\r\n\t}\r\n\tcontent() {\r\n        return <div>\r\n\t\t\t<div>\r\n\t\t\t\t{this.controller.uiItems.map(this.renderItem)}\r\n\t\t\t</div>\r\n\t\t</div>;\r\n\t}\r\n\r\n\tprivate renderItem = (item:UIItem, index:number):JSX.Element => {\r\n\t\tlet {name, discription, click} = item;\r\n\t\tlet right = <FA name=\"angle-right\" />;\r\n\t\treturn <LMR key={index} className=\"px-3 py-2 cursor-pointer mt-1 bg-white\"\r\n\t\t\tonClick={click}\r\n\t\t\tright={right}>\r\n\t\t\t<div>{name} <small className=\"text-muted\">{discription}</small></div>\r\n\t\t</LMR>;\r\n\t}\r\n}\r\n","import { CBase, Context } from \"tonva-react\";\r\nimport { CID, MidID, CIDX, MidIDX, MidTag, CIDTagList, CTagIDList\r\n\t, SheetUI, MidIDTagList, CSheetNew, MidSheet } from \"tonva-uqui\";\r\nimport { CApp, UQs } from \"uq-app\";\r\nimport { OrderDetail, OrderMaster } from \"uq-app/uqs/BzHelloTonva\";\r\nimport { VTester } from \"./VTest\";\r\nimport { isNumber } from \"lodash\";\r\n\r\nexport interface UIItem {\r\n\tname: string;\r\n\tdiscription?: string;\r\n\tclick: () => Promise<void>;\r\n}\r\n\r\nexport class CTester extends CBase<CApp,UQs> {\r\n\treadonly uiItems:UIItem[] = [\r\n\t\t{\r\n\t\t\tname: 'customer',\r\n\t\t\tdiscription: '客户信息',\r\n\t\t\tclick: async () => {\r\n\t\t\t\tlet uq = this.uqs.BzHelloTonva;\r\n\t\t\t\tlet mid = new MidID(uq, {ID:uq.Customer});\r\n\t\t\t\tlet cID = new CID(mid);\r\n\t\t\t\tawait cID.start();\r\n\t\t\t}\r\n\t\t},\r\n\t\t{\r\n\t\t\tname: 'tag',\r\n\t\t\tdiscription: '客户标签',\r\n\t\t\tclick: async () => {\r\n\t\t\t\tlet uq = this.uqs.BzHelloTonva;\r\n\t\t\t\tlet midTag = new MidTag(uq, uq.Customer, uq.CustomerTag, uq.Tag, 'customer');\r\n\t\t\t\tlet midIDTagList = new MidIDTagList(midTag);\r\n\t\t\t\tlet cIDTagList = new CIDTagList(midIDTagList);\r\n\t\t\t\tawait cIDTagList.start();\r\n\t\t\t}\r\n\t\t},\r\n\t\t{\r\n\t\t\tname: 'tagCustomer',\r\n\t\t\tdiscription: '标签客户',\r\n\t\t\tclick: async () => {\r\n\t\t\t\tlet uq = this.uqs.BzHelloTonva;\r\n\t\t\t\tlet midTag = new MidTag(uq, uq.Customer, uq.CustomerTag, uq.Tag, 'customer');\r\n\t\t\t\tlet cTagIDList = new CTagIDList(midTag);\r\n\t\t\t\tawait cTagIDList.start();\r\n\t\t\t}\r\n\t\t},\r\n\t\t{\r\n\t\t\tname: 'staff',\r\n\t\t\tdiscription: 'TimeChange Staff',\r\n\t\t\tclick: async () => {\r\n\t\t\t\tlet uq = this.uqs.BzHelloTonva;\r\n\t\t\t\tlet mid = new MidID(uq, {ID:uq.Staff});\r\n\t\t\t\tlet cStaff = new CID(mid);\r\n\t\t\t\tcStaff.renderItem = (item:any, index:number): JSX.Element => {\r\n\t\t\t\t\treturn <div className=\"\">{uq.Staff.render(item)}</div>\r\n\t\t\t\t};\r\n\t\t\t\tawait cStaff.start();\r\n\t\t\t}\r\n\t\t},\r\n\t\t{\r\n\t\t\tname: 'hours',\r\n\t\t\tdiscription: 'TimeChange Hours',\r\n\t\t\tclick: async () => {\r\n\t\t\t\tlet uq = this.uqs.BzHelloTonva;\r\n\t\t\t\tlet mid = new MidIDX(uq, uq.Hours, uq.Staff, this.timeZone);\r\n\t\t\t\tlet cHours = new CIDX(mid);\r\n\t\t\t\tawait cHours.start();\r\n\t\t\t}\r\n\t\t},\r\n\t\t{\r\n\t\t\tname: 'sheet-order',\r\n\t\t\tdiscription: 'Sheet Order Hello Tonva',\r\n\t\t\tclick: async () => {\r\n\t\t\t\tlet uq = this.uqs.BzHelloTonva;\r\n\t\t\t\tlet onChanged = async (context:Context, value:any, prev:any) => {\r\n\t\t\t\t\tlet quantity = context.getValue('quantity');\r\n\t\t\t\t\tlet price = context.getValue('price');\r\n\t\t\t\t\tif (isNumber(quantity) && isNumber(value)) {\r\n\t\t\t\t\t\tcontext.setValue('amount', (price*quantity).toFixed(2));\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tlet sheetUI:SheetUI = {\r\n\t\t\t\t\tmaster: {\r\n\t\t\t\t\t\tID: uq.OrderMaster,\r\n\t\t\t\t\t\tfieldCustoms: {\r\n\t\t\t\t\t\t\tcustomer: {ID: uq.Customer},\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tdetail: {\r\n\t\t\t\t\t\tID: uq.OrderDetail,\r\n\t\t\t\t\t\tfieldCustoms: {\r\n\t\t\t\t\t\t\tproduct: { ID: uq.Customer },\r\n\t\t\t\t\t\t\tprice: { onChanged },\r\n\t\t\t\t\t\t\tquantity: { onChanged },\r\n\t\t\t\t\t\t\tamount: { readOnly: true, }\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tlet mid = new MidSheet<OrderMaster, OrderDetail>(uq, sheetUI, this.res);\r\n\t\t\t\tlet cSheetNew = new CSheetNew(mid);\r\n\t\t\t\tawait cSheetNew.start();\r\n\t\t\t}\r\n\t\t},\r\n\t];\r\n\r\n\tprotected async internalStart() {\r\n\t\tthis.openVPage(VTester);\r\n\t}\r\n\r\n\ttab = () => this.renderView(VTester);\r\n}\r\n","import { Res, UI } from \"tonva-react\";\r\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\nimport { FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-react\";\r\nimport { $Piecewise } from \"./BruceYuMi\";\r\n\r\n/*--fields--*/\r\nconst fields = {\r\n\tid: {\r\n\t\t\"name\": \"id\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": false,\r\n\t\t\"label\": \"Id\"\r\n\t} as FieldItemId,\r\n\tname: {\r\n\t\t\"name\": \"name\",\r\n\t\t\"isKey\": true,\r\n\t\t\"label\": \"Name\"\r\n\t} as undefined,\r\n\tmul: {\r\n\t\t\"name\": \"mul\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Mul\"\r\n\t} as FieldItemInt,\r\n\tdiv: {\r\n\t\t\"name\": \"div\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Div\"\r\n\t} as FieldItemInt,\r\n\toffset: {\r\n\t\t\"name\": \"offset\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Offset\"\r\n\t} as FieldItemInt,\r\n\tasc: {\r\n\t\t\"name\": \"asc\",\r\n\t\t\"isKey\": false,\r\n\t\t\"label\": \"Asc\"\r\n\t} as undefined,\r\n};\r\n/*==fields==*/\r\n\r\nexport const fieldArr: FieldItem[] = [\r\n\tfields.name, fields.mul, fields.div, fields.offset, fields.asc, \r\n];\r\n\r\nexport const ui: UI = {\r\n\tlabel: \"$Piecewise\",\r\n\tfieldArr,\r\n\tfields,\r\n};\r\n\r\nexport const res: Res<any> = {\r\n\tzh: {\r\n\t},\r\n\ten: {\r\n\t}\r\n};\r\n\r\nexport function render(item: $Piecewise):JSX.Element {\r\n\treturn <>{JSON.stringify(item)}</>;\r\n};\r\n","import { Res, UI } from \"tonva-react\";\r\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\nimport { FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-react\";\r\nimport { Market } from \"./BruceYuMi\";\r\n\r\n/*--fields--*/\r\nconst fields = {\r\n\tid: {\r\n\t\t\"name\": \"id\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": false,\r\n\t\t\"label\": \"Id\"\r\n\t} as FieldItemId,\r\n\tname: {\r\n\t\t\"name\": \"name\",\r\n\t\t\"type\": \"string\",\r\n\t\t\"isKey\": true,\r\n\t\t\"widget\": \"string\",\r\n\t\t\"label\": \"Name\"\r\n\t} as FieldItemString,\r\n\tcurrency: {\r\n\t\t\"name\": \"currency\",\r\n\t\t\"type\": \"string\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"string\",\r\n\t\t\"label\": \"Currency\"\r\n\t} as FieldItemString,\r\n};\r\n/*==fields==*/\r\n\r\nexport const fieldArr: FieldItem[] = [\r\n\tfields.name, fields.currency, \r\n];\r\n\r\nexport const ui: UI = {\r\n\tlabel: \"Market\",\r\n\tfieldArr,\r\n\tfields,\r\n};\r\n\r\nexport const res: Res<any> = {\r\n\tzh: {\r\n\t},\r\n\ten: {\r\n\t}\r\n};\r\n\r\nexport function render(item: Market):JSX.Element {\r\n\treturn <>{JSON.stringify(item)}</>;\r\n};\r\n","import { Res, UI } from \"tonva-react\";\r\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\nimport { FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-react\";\r\nimport { Transaction } from \"./BruceYuMi\";\r\n\r\n/*--fields--*/\r\nconst fields = {\r\n\tid: {\r\n\t\t\"name\": \"id\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": false,\r\n\t\t\"label\": \"Id\"\r\n\t} as FieldItemId,\r\n\tholding: {\r\n\t\t\"name\": \"holding\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": true,\r\n\t\t\"label\": \"Holding\"\r\n\t} as FieldItemId,\r\n\ttick: {\r\n\t\t\"name\": \"tick\",\r\n\t\t\"isKey\": true,\r\n\t\t\"label\": \"Tick\"\r\n\t} as undefined,\r\n\tprice: {\r\n\t\t\"name\": \"price\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Price\"\r\n\t} as FieldItemInt,\r\n\tquantity: {\r\n\t\t\"name\": \"quantity\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Quantity\"\r\n\t} as FieldItemInt,\r\n\tamount: {\r\n\t\t\"name\": \"amount\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Amount\"\r\n\t} as FieldItemInt,\r\n};\r\n/*==fields==*/\r\n\r\nexport const fieldArr: FieldItem[] = [\r\n\tfields.holding, fields.tick, fields.price, fields.quantity, fields.amount, \r\n];\r\n\r\nexport const ui: UI = {\r\n\tlabel: \"Transaction\",\r\n\tfieldArr,\r\n\tfields,\r\n};\r\n\r\nexport const res: Res<any> = {\r\n\tzh: {\r\n\t},\r\n\ten: {\r\n\t}\r\n};\r\n\r\nexport function render(item: Transaction):JSX.Element {\r\n\treturn <>{JSON.stringify(item)}</>;\r\n};\r\n","import { Res, setRes, TFunc, UI } from \"tonva-react\";\r\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\nimport { FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-react\";\r\nimport { Group } from \"./BruceYuMi\";\r\n\r\n/*--fields--*/\r\nconst fields = {\r\n\tid: {\r\n\t\t\"name\": \"id\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": false,\r\n\t\t\"label\": \"Id\"\r\n\t} as FieldItemId,\r\n\tno: {\r\n\t\t\"name\": \"no\",\r\n\t\t\"type\": \"string\",\r\n\t\t\"isKey\": true,\r\n\t\t\"widget\": \"string\",\r\n\t\t\"label\": \"No\"\r\n\t} as FieldItemString,\r\n\tname: {\r\n\t\t\"name\": \"name\",\r\n\t\t\"type\": \"string\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"string\",\r\n\t\t\"label\": \"Name\"\r\n\t} as FieldItemString,\r\n\ttype: {\r\n\t\t\"name\": \"type\",\r\n\t\t\"isKey\": false,\r\n\t\t\"label\": \"Type\"\r\n\t} as undefined,\r\n};\r\n/*==fields==*/\r\n\r\nconst fieldArr: FieldItem[] = [\r\n\tfields.no, fields.name, fields.type, \r\n];\r\n\r\nconst resRaw: Res<any> = {\r\n\t$zh: {\r\n\t\tGroup: '股票组',\r\n\t\tName: '组名',\r\n\t},\r\n\t$en: {\r\n\t}\r\n};\r\n\r\nconst res: any = {};\r\nsetRes(res, resRaw);\r\n\r\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\r\n\treturn res[str as string] ?? str;\r\n}\r\n\r\nexport function render(item: Group):JSX.Element {\r\n\tlet {name} = item;\r\n\treturn <>{t(name)}</>;\r\n};\r\n\r\nexport const ui: UI = {\r\n\tlabel: t(\"Group\"),\r\n\tfieldArr,\r\n\tfields,\r\n};\r\n","import { Res, setRes, TFunc, UI } from \"tonva-react\";\r\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\nimport { FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-react\";\r\nimport { Account } from \"./BruceYuMi\";\r\n\r\n/*--fields--*/\r\nconst fields = {\r\n\tid: {\r\n\t\t\"name\": \"id\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": false,\r\n\t\t\"label\": \"Id\"\r\n\t} as FieldItemId,\r\n\tno: {\r\n\t\t\"name\": \"no\",\r\n\t\t\"type\": \"string\",\r\n\t\t\"isKey\": true,\r\n\t\t\"widget\": \"string\",\r\n\t\t\"label\": \"No\"\r\n\t} as FieldItemString,\r\n\tname: {\r\n\t\t\"name\": \"name\",\r\n\t\t\"type\": \"string\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"string\",\r\n\t\t\"label\": \"Name\"\r\n\t} as FieldItemString,\r\n};\r\n/*==fields==*/\r\n\r\nexport const fieldArr: FieldItem[] = [\r\n\tfields.no, fields.name, \r\n];\r\n\r\nexport const ui: UI = {\r\n\tlabel: \"Account\",\r\n\tfieldArr,\r\n\tfields,\r\n};\r\n\r\nexport const resRaw: Res<any> = {\r\n\tzh: {\r\n\t},\r\n\ten: {\r\n\t}\r\n};\r\n\r\nconst res: any = {};\r\nsetRes(res, resRaw);\r\n\r\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\r\n\treturn res[str as string] ?? str;\r\n}\r\n\r\nexport function render(item: Account):JSX.Element {\r\n\tlet {name} = item;\r\n\treturn <>{t(name)}</>;\r\n};\r\n","import { Res, setRes, TFunc, UI } from \"tonva-react\";\r\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\nimport { FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-react\";\r\nimport { Holding } from \"./BruceYuMi\";\r\n\r\n/*--fields--*/\r\nconst fields = {\r\n\tid: {\r\n\t\t\"name\": \"id\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": false,\r\n\t\t\"label\": \"Id\"\r\n\t} as FieldItemId,\r\n\taccount: {\r\n\t\t\"name\": \"account\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": true,\r\n\t\t\"label\": \"Account\"\r\n\t} as FieldItemId,\r\n\tstock: {\r\n\t\t\"name\": \"stock\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": true,\r\n\t\t\"label\": \"Stock\"\r\n\t} as FieldItemId,\r\n\torder: {\r\n\t\t\"name\": \"order\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Order\"\r\n\t} as FieldItemInt,\r\n};\r\n/*==fields==*/\r\n\r\nconst fieldArr: FieldItem[] = [\r\n];\r\n\r\nexport const ui: UI = {\r\n\tlabel: \"Holding\",\r\n\tfieldArr,\r\n\tfields,\r\n};\r\n\r\nconst resRaw: Res<any> = {\r\n\tzh: {\r\n\t},\r\n\ten: {\r\n\t}\r\n};\r\nconst res: any = {};\r\nsetRes(res, resRaw);\r\n\r\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\r\n\treturn res[str as string] ?? str;\r\n}\r\n\r\nexport function render(item: Holding):JSX.Element {\r\n\treturn <>{JSON.stringify(item)}</>;\r\n};\r\n","import { Res, UI } from \"tonva-react\";\r\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\nimport { FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-react\";\r\nimport { $PiecewiseDetail } from \"./BruceYuMi\";\r\n\r\n/*--fields--*/\r\nconst fields = {\r\n\tid: {\r\n\t\t\"name\": \"id\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": false,\r\n\t\t\"label\": \"Id\"\r\n\t} as FieldItemId,\r\n\tparent: {\r\n\t\t\"name\": \"parent\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": true,\r\n\t\t\"label\": \"Parent\"\r\n\t} as FieldItemId,\r\n\trow: {\r\n\t\t\"name\": \"row\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": true,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Row\"\r\n\t} as FieldItemInt,\r\n\tsec: {\r\n\t\t\"name\": \"sec\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Sec\"\r\n\t} as FieldItemInt,\r\n\tvalue: {\r\n\t\t\"name\": \"value\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Value\"\r\n\t} as FieldItemInt,\r\n};\r\n/*==fields==*/\r\n\r\nexport const fieldArr: FieldItem[] = [\r\n\tfields.parent, fields.row, fields.sec, fields.value, \r\n];\r\n\r\nexport const ui: UI = {\r\n\tlabel: \"$PiecewiseDetail\",\r\n\tfieldArr,\r\n\tfields,\r\n};\r\n\r\nexport const res: Res<any> = {\r\n\tzh: {\r\n\t},\r\n\ten: {\r\n\t}\r\n};\r\n\r\nexport function render(item: $PiecewiseDetail):JSX.Element {\r\n\treturn <>{JSON.stringify(item)}</>;\r\n};\r\n","import { Res, UI } from \"tonva-react\";\r\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\nimport { FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-react\";\r\nimport { Stock } from \"./BruceYuMi\";\r\n\r\n/*--fields--*/\r\nconst fields = {\r\n\tid: {\r\n\t\t\"name\": \"id\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": false,\r\n\t\t\"label\": \"Id\"\r\n\t} as FieldItemId,\r\n\tmarket: {\r\n\t\t\"name\": \"market\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": true,\r\n\t\t\"label\": \"Market\"\r\n\t} as FieldItemId,\r\n\tcode: {\r\n\t\t\"name\": \"code\",\r\n\t\t\"type\": \"string\",\r\n\t\t\"isKey\": true,\r\n\t\t\"widget\": \"string\",\r\n\t\t\"label\": \"Code\"\r\n\t} as FieldItemString,\r\n\tname: {\r\n\t\t\"name\": \"name\",\r\n\t\t\"type\": \"string\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"string\",\r\n\t\t\"label\": \"Name\"\r\n\t} as FieldItemString,\r\n\tsearch: {\r\n\t\t\"name\": \"search\",\r\n\t\t\"type\": \"string\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"string\",\r\n\t\t\"label\": \"Search\"\r\n\t} as FieldItemString,\r\n\trawId: {\r\n\t\t\"name\": \"rawId\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": false,\r\n\t\t\"label\": \"RawId\"\r\n\t} as FieldItemId,\r\n};\r\n/*==fields==*/\r\n\r\nexport const fieldArr: FieldItem[] = [\r\n\tfields.market, fields.code, fields.name, fields.search, fields.rawId, \r\n];\r\n\r\nexport const ui: UI = {\r\n\tlabel: \"Stock\",\r\n\tfieldArr,\r\n\tfields,\r\n};\r\n\r\nexport const res: Res<any> = {\r\n\tzh: {\r\n\t},\r\n\ten: {\r\n\t}\r\n};\r\n\r\nexport function render(item: Stock):JSX.Element {\r\n\treturn <>{JSON.stringify(item)}</>;\r\n};\r\n","import { Res, UI } from \"tonva-react\";\r\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\nimport { FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-react\";\r\nimport { StockValue } from \"./BruceYuMi\";\r\n\r\n/*--fields--*/\r\nconst fields = {\r\n\tid: {\r\n\t\t\"name\": \"id\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": false,\r\n\t\t\"label\": \"Id\"\r\n\t} as FieldItemId,\r\n\tmiValue: {\r\n\t\t\"name\": \"miValue\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"MiValue\"\r\n\t} as FieldItemInt,\r\n\tearning: {\r\n\t\t\"name\": \"earning\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Earning\"\r\n\t} as FieldItemInt,\r\n\tdivident: {\r\n\t\t\"name\": \"divident\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Divident\"\r\n\t} as FieldItemInt,\r\n\tprice: {\r\n\t\t\"name\": \"price\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Price\"\r\n\t} as FieldItemInt,\r\n\tpvolumn: {\r\n\t\t\"name\": \"pvolumn\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Pvolumn\"\r\n\t} as FieldItemInt,\r\n\troe: {\r\n\t\t\"name\": \"roe\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Roe\"\r\n\t} as FieldItemInt,\r\n\tmiRate: {\r\n\t\t\"name\": \"miRate\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"MiRate\"\r\n\t} as FieldItemInt,\r\n\tdvRate: {\r\n\t\t\"name\": \"dvRate\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"DvRate\"\r\n\t} as FieldItemInt,\r\n\tttm: {\r\n\t\t\"name\": \"ttm\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Ttm\"\r\n\t} as FieldItemInt,\r\n\tinc1: {\r\n\t\t\"name\": \"inc1\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Inc1\"\r\n\t} as FieldItemInt,\r\n\tinc2: {\r\n\t\t\"name\": \"inc2\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Inc2\"\r\n\t} as FieldItemInt,\r\n\tinc3: {\r\n\t\t\"name\": \"inc3\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Inc3\"\r\n\t} as FieldItemInt,\r\n\tinc4: {\r\n\t\t\"name\": \"inc4\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Inc4\"\r\n\t} as FieldItemInt,\r\n\tpreInc: {\r\n\t\t\"name\": \"preInc\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"PreInc\"\r\n\t} as FieldItemInt,\r\n\tvolumn: {\r\n\t\t\"name\": \"volumn\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Volumn\"\r\n\t} as FieldItemInt,\r\n\tsmoothness: {\r\n\t\t\"name\": \"smoothness\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Smoothness\"\r\n\t} as FieldItemInt,\r\n\tdate: {\r\n\t\t\"name\": \"date\",\r\n\t\t\"isKey\": false,\r\n\t\t\"label\": \"Date\"\r\n\t} as undefined,\r\n};\r\n/*==fields==*/\r\n\r\nexport const fieldArr: FieldItem[] = [\r\n\tfields.miValue, fields.earning, fields.divident, fields.price, fields.pvolumn, fields.roe, fields.miRate, fields.dvRate, fields.ttm, fields.inc1, fields.inc2, fields.inc3, fields.inc4, fields.preInc, fields.volumn, fields.smoothness, fields.date, \r\n];\r\n\r\nexport const ui: UI = {\r\n\tlabel: \"StockValue\",\r\n\tfieldArr,\r\n\tfields,\r\n};\r\n\r\nexport const res: Res<any> = {\r\n\tzh: {\r\n\t},\r\n\ten: {\r\n\t}\r\n};\r\n\r\nexport function render(item: StockValue):JSX.Element {\r\n\treturn <>{JSON.stringify(item)}</>;\r\n};\r\n","import { Res, UI } from \"tonva-react\";\r\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\nimport { FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-react\";\r\nimport { AccountValue } from \"./BruceYuMi\";\r\n\r\n/*--fields--*/\r\nconst fields = {\r\n\tid: {\r\n\t\t\"name\": \"id\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": false,\r\n\t\t\"label\": \"Id\"\r\n\t} as FieldItemId,\r\n\tmi: {\r\n\t\t\"name\": \"mi\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Mi\"\r\n\t} as FieldItemInt,\r\n\tmarket: {\r\n\t\t\"name\": \"market\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Market\"\r\n\t} as FieldItemInt,\r\n\tcount: {\r\n\t\t\"name\": \"count\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Count\"\r\n\t} as FieldItemInt,\r\n\tcash: {\r\n\t\t\"name\": \"cash\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Cash\"\r\n\t} as FieldItemInt,\r\n};\r\n/*==fields==*/\r\n\r\nexport const fieldArr: FieldItem[] = [\r\n\tfields.mi, fields.market, fields.count, fields.cash, \r\n];\r\n\r\nexport const ui: UI = {\r\n\tlabel: \"AccountValue\",\r\n\tfieldArr,\r\n\tfields,\r\n};\r\n\r\nexport const res: Res<any> = {\r\n\tzh: {\r\n\t},\r\n\ten: {\r\n\t}\r\n};\r\n\r\nexport function render(item: AccountValue):JSX.Element {\r\n\treturn <>{JSON.stringify(item)}</>;\r\n};\r\n","import { Res, UI } from \"tonva-react\";\r\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\nimport { FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-react\";\r\nimport { Portfolio } from \"./BruceYuMi\";\r\n\r\n/*--fields--*/\r\nconst fields = {\r\n\tid: {\r\n\t\t\"name\": \"id\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": false,\r\n\t\t\"label\": \"Id\"\r\n\t} as FieldItemId,\r\n\tquantity: {\r\n\t\t\"name\": \"quantity\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Quantity\"\r\n\t} as FieldItemInt,\r\n};\r\n/*==fields==*/\r\n\r\nexport const fieldArr: FieldItem[] = [\r\n\tfields.quantity, \r\n];\r\n\r\nexport const ui: UI = {\r\n\tlabel: \"Portfolio\",\r\n\tfieldArr,\r\n\tfields,\r\n};\r\n\r\nexport const res: Res<any> = {\r\n\tzh: {\r\n\t},\r\n\ten: {\r\n\t}\r\n};\r\n\r\nexport function render(item: Portfolio):JSX.Element {\r\n\treturn <>{JSON.stringify(item)}</>;\r\n};\r\n","import { Res, setRes, TFunc, UI } from \"tonva-react\";\r\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\nimport { FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-react\";\r\nimport { UserBlockStock } from \"./BruceYuMi\";\r\n\r\n/*--fields--*/\r\nconst fields = {\r\n\tix: {\r\n\t\t\"name\": \"ix\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": false,\r\n\t\t\"label\": \"Ix\"\r\n\t} as FieldItemId,\r\n\tid: {\r\n\t\t\"name\": \"id\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": false,\r\n\t\t\"label\": \"Id\"\r\n\t} as FieldItemId,\r\n};\r\n/*==fields==*/\r\n\r\nconst fieldArr: FieldItem[] = [\r\n];\r\n\r\nexport const ui: UI = {\r\n\tlabel: \"UserBlockStock\",\r\n\tfieldArr,\r\n\tfields,\r\n};\r\n\r\nconst resRaw: Res<any> = {\r\n\tzh: {\r\n\t},\r\n\ten: {\r\n\t}\r\n};\r\nconst res: any = {};\r\nsetRes(res, resRaw);\r\n\r\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\r\n\treturn res[str as string] ?? str;\r\n}\r\n\r\nexport function render(item: UserBlockStock):JSX.Element {\r\n\treturn <>{JSON.stringify(item)}</>;\r\n};\r\n","import { Res, UI } from \"tonva-react\";\r\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\nimport { FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-react\";\r\nimport { UserAccount } from \"./BruceYuMi\";\r\n\r\n/*--fields--*/\r\nconst fields = {\r\n\tix: {\r\n\t\t\"name\": \"ix\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": false,\r\n\t\t\"label\": \"Ix\"\r\n\t} as FieldItemId,\r\n\tid: {\r\n\t\t\"name\": \"id\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": false,\r\n\t\t\"label\": \"Id\"\r\n\t} as FieldItemId,\r\n};\r\n/*==fields==*/\r\n\r\nexport const fieldArr: FieldItem[] = [\r\n\t\r\n];\r\n\r\nexport const ui: UI = {\r\n\tlabel: \"UserAccount\",\r\n\tfieldArr,\r\n\tfields,\r\n};\r\n\r\nexport const res: Res<any> = {\r\n\tzh: {\r\n\t},\r\n\ten: {\r\n\t}\r\n};\r\n\r\nexport function render(item: UserAccount):JSX.Element {\r\n\treturn <>{JSON.stringify(item)}</>;\r\n};\r\n","import { Res, UI } from \"tonva-react\";\r\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\nimport { FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-react\";\r\nimport { UserGroup } from \"./BruceYuMi\";\r\n\r\n/*--fields--*/\r\nconst fields = {\r\n\tix: {\r\n\t\t\"name\": \"ix\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": false,\r\n\t\t\"label\": \"Ix\"\r\n\t} as FieldItemId,\r\n\tid: {\r\n\t\t\"name\": \"id\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": false,\r\n\t\t\"label\": \"Id\"\r\n\t} as FieldItemId,\r\n};\r\n/*==fields==*/\r\n\r\nexport const fieldArr: FieldItem[] = [\r\n\t\r\n];\r\n\r\nexport const ui: UI = {\r\n\tlabel: \"UserGroup\",\r\n\tfieldArr,\r\n\tfields,\r\n};\r\n\r\nexport const res: Res<any> = {\r\n\tzh: {\r\n\t},\r\n\ten: {\r\n\t}\r\n};\r\n\r\nexport function render(item: UserGroup):JSX.Element {\r\n\treturn <>{JSON.stringify(item)}</>;\r\n};\r\n","import { Res, setRes, TFunc, UI } from \"tonva-react\";\r\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\nimport { FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-react\";\r\nimport { UserAllStock } from \"./BruceYuMi\";\r\n\r\n/*--fields--*/\r\nconst fields = {\r\n\tix: {\r\n\t\t\"name\": \"ix\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": false,\r\n\t\t\"label\": \"Ix\"\r\n\t} as FieldItemId,\r\n\tid: {\r\n\t\t\"name\": \"id\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": false,\r\n\t\t\"label\": \"Id\"\r\n\t} as FieldItemId,\r\n};\r\n/*==fields==*/\r\n\r\nconst fieldArr: FieldItem[] = [\r\n];\r\n\r\nexport const ui: UI = {\r\n\tlabel: \"UserAllStock\",\r\n\tfieldArr,\r\n\tfields,\r\n};\r\n\r\nconst resRaw: Res<any> = {\r\n\tzh: {\r\n\t},\r\n\ten: {\r\n\t}\r\n};\r\nconst res: any = {};\r\nsetRes(res, resRaw);\r\n\r\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\r\n\treturn res[str as string] ?? str;\r\n}\r\n\r\nexport function render(item: UserAllStock):JSX.Element {\r\n\treturn <>{JSON.stringify(item)}</>;\r\n};\r\n","import { Res, setRes, TFunc, UI } from \"tonva-react\";\r\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\nimport { FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-react\";\r\nimport { AccountHolding } from \"./BruceYuMi\";\r\n\r\n/*--fields--*/\r\nconst fields = {\r\n\tix: {\r\n\t\t\"name\": \"ix\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": false,\r\n\t\t\"label\": \"Ix\"\r\n\t} as FieldItemId,\r\n\tid: {\r\n\t\t\"name\": \"id\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": false,\r\n\t\t\"label\": \"Id\"\r\n\t} as FieldItemId,\r\n};\r\n/*==fields==*/\r\n\r\nconst fieldArr: FieldItem[] = [\r\n];\r\n\r\nexport const ui: UI = {\r\n\tlabel: \"AccountHolding\",\r\n\tfieldArr,\r\n\tfields,\r\n};\r\n\r\nconst resRaw: Res<any> = {\r\n\tzh: {\r\n\t},\r\n\ten: {\r\n\t}\r\n};\r\nconst res: any = {};\r\nsetRes(res, resRaw);\r\n\r\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\r\n\treturn res[str as string] ?? str;\r\n}\r\n\r\nexport function render(item: AccountHolding):JSX.Element {\r\n\treturn <>{JSON.stringify(item)}</>;\r\n};\r\n","import { Res, UI } from \"tonva-react\";\r\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\nimport { FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-react\";\r\nimport { GroupStock } from \"./BruceYuMi\";\r\n\r\n/*--fields--*/\r\nconst fields = {\r\n\tix: {\r\n\t\t\"name\": \"ix\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": false,\r\n\t\t\"label\": \"Ix\"\r\n\t} as FieldItemId,\r\n\tid: {\r\n\t\t\"name\": \"id\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": false,\r\n\t\t\"label\": \"Id\"\r\n\t} as FieldItemId,\r\n\torder: {\r\n\t\t\"name\": \"order\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Order\"\r\n\t} as FieldItemInt,\r\n};\r\n/*==fields==*/\r\n\r\nexport const fieldArr: FieldItem[] = [\r\n\tfields.order, \r\n];\r\n\r\nexport const ui: UI = {\r\n\tlabel: \"GroupStock\",\r\n\tfieldArr,\r\n\tfields,\r\n};\r\n\r\nexport const res: Res<any> = {\r\n\tzh: {\r\n\t},\r\n\ten: {\r\n\t}\r\n};\r\n\r\nexport function render(item: GroupStock):JSX.Element {\r\n\treturn <>{JSON.stringify(item)}</>;\r\n};\r\n","//=== UqApp builder created on Tue Mar 23 2021 11:34:08 GMT-0400 (GMT-04:00) ===//\r\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\nimport { IDXValue, Uq, UqTuid, UqAction, UqQuery, UqID, UqIDX, UqIX } from \"tonva-react\";\r\n\r\n\r\n//===============================\r\n//======= UQ bruce/yumi ========\r\n//===============================\r\n\r\nexport enum EnumGroupType {\r\n\tnormal = 0,\r\n\tblack = -1,\r\n\tall = 1\r\n}\r\n\r\nexport interface Tuid$user {\r\n\tname: string;\r\n\tnick: string;\r\n\ticon: string;\r\n\tassigned: string;\r\n\tpoke: number;\r\n}\r\n\r\nexport interface Tuid$sheet {\r\n\tno: string;\r\n\tuser: number;\r\n\tdate: any;\r\n\tsheet: number;\r\n\tversion: number;\r\n\tflow: number;\r\n\tapp: number;\r\n\tstate: number;\r\n\tdiscription: string;\r\n\tdata: string;\r\n\tprocessing: number;\r\n}\r\n\r\nexport interface ParamWriteStock {\r\n\tstocks: {\r\n\t\tmarket: string;\r\n\t\tcode: string;\r\n\t\tname: string;\r\n\t\trawId: number;\r\n\t\tmiValue: number;\r\n\t\tearning: number;\r\n\t\tdivident: number;\r\n\t\troe: number;\r\n\t\tinc1: number;\r\n\t\tinc2: number;\r\n\t\tinc3: number;\r\n\t\tinc4: number;\r\n\t\tpreInc: number;\r\n\t\tvolumn: number;\r\n\t\tsmoothness: number;\r\n\t}[];\r\n\r\n}\r\ninterface ResultWriteStock {\r\n}\r\n\r\nexport interface ParamWritePrice {\r\n\tprices: {\r\n\t\tmarket: string;\r\n\t\tcode: string;\r\n\t\tname: string;\r\n\t\trawId: number;\r\n\t\tprice: number;\r\n\t\tpvolumn: number;\r\n\t\tdate: number;\r\n\t}[];\r\n\r\n}\r\ninterface ResultWritePrice {\r\n}\r\n\r\nexport interface Param$poked {\r\n}\r\ninterface Return$pokedRet {\r\n\tpoke: number;\r\n}\r\ninterface Result$poked {\r\n\tret: Return$pokedRet[];\r\n}\r\n\r\nexport interface ParamSearchStock {\r\n\t$orderSwitch: string;\r\n\tkey: string;\r\n\tmarket: string;\r\n\tsmooth: number;\r\n}\r\ninterface ReturnSearchStock$page {\r\n\tid: number;\r\n\tmarket: number;\r\n\tcode: string;\r\n\tname: string;\r\n\trawId: number;\r\n\tmiValue: number;\r\n\tearning: number;\r\n\tdivident: number;\r\n\tprice: number;\r\n\troe: number;\r\n\tmiRate: number;\r\n\tdvRate: number;\r\n\tttm: number;\r\n\tinc1: number;\r\n\tinc2: number;\r\n\tinc3: number;\r\n\tinc4: number;\r\n\tpreInc: number;\r\n\tvolumn: number;\r\n\tsmoothness: number;\r\n}\r\ninterface ResultSearchStock {\r\n\t$page: ReturnSearchStock$page[];\r\n}\r\n\r\nexport interface ParamStockUsing {\r\n\tstock: number;\r\n}\r\ninterface ReturnStockUsingAccounts {\r\n\taccount: number;\r\n}\r\ninterface ReturnStockUsingGroups {\r\n\tgroup: number;\r\n}\r\ninterface ResultStockUsing {\r\n\taccounts: ReturnStockUsingAccounts[];\r\n\tgroups: ReturnStockUsingGroups[];\r\n}\r\n\r\nexport interface $Piecewise {\r\n\tid?: number;\r\n\tname: string;\r\n\tmul: number;\r\n\tdiv: number;\r\n\toffset: number;\r\n\tasc: number;\r\n}\r\n\r\nexport interface Market {\r\n\tid?: number;\r\n\tname: string;\r\n\tcurrency: string;\r\n}\r\n\r\nexport interface Transaction {\r\n\tid?: number;\r\n\tholding: number;\r\n\ttick: any;\r\n\tprice: number;\r\n\tquantity: number;\r\n\tamount: number;\r\n}\r\n\r\nexport interface Group {\r\n\tid?: number;\r\n\tno?: string;\r\n\tname: string;\r\n\ttype: any;\r\n}\r\n\r\nexport interface Account {\r\n\tid?: number;\r\n\tno?: string;\r\n\tname: string;\r\n}\r\n\r\nexport interface Holding {\r\n\tid?: number;\r\n\taccount: number;\r\n\tstock: number;\r\n\torder: number;\r\n}\r\n\r\nexport interface $PiecewiseDetail {\r\n\tid?: number;\r\n\tparent: number;\r\n\trow?: number;\r\n\tsec: number;\r\n\tvalue: number;\r\n}\r\n\r\nexport interface Stock {\r\n\tid?: number;\r\n\tmarket: number;\r\n\tcode: string;\r\n\tname: string;\r\n\tsearch: string;\r\n\trawId: number;\r\n}\r\n\r\nexport interface StockValue {\r\n\tid: number;\r\n\tmiValue?: number;\r\n\tearning?: number;\r\n\tdivident?: number;\r\n\tprice?: number;\r\n\tpvolumn?: number;\r\n\troe?: number;\r\n\tmiRate?: number;\r\n\tdvRate?: number;\r\n\tttm?: number;\r\n\tinc1?: number;\r\n\tinc2?: number;\r\n\tinc3?: number;\r\n\tinc4?: number;\r\n\tpreInc?: number;\r\n\tvolumn?: number;\r\n\tsmoothness?: number;\r\n\tdate?: any;\r\n}\r\n\r\nexport interface AccountValue {\r\n\tid: number;\r\n\tmi?: number;\r\n\tmarket?: number;\r\n\tcount?: number;\r\n\tcash?: number;\r\n\t$track?: number;\r\n}\r\n\r\nexport interface Portfolio {\r\n\tid: number;\r\n\tquantity?: number;\r\n\t$track?: number;\r\n}\r\n\r\nexport interface ActParamStockValue {\r\n\tid: number|IDXValue;\r\n\tmiValue?: number|IDXValue;\r\n\tearning?: number|IDXValue;\r\n\tdivident?: number|IDXValue;\r\n\tprice?: number|IDXValue;\r\n\tpvolumn?: number|IDXValue;\r\n\troe?: number|IDXValue;\r\n\tmiRate?: number|IDXValue;\r\n\tdvRate?: number|IDXValue;\r\n\tttm?: number|IDXValue;\r\n\tinc1?: number|IDXValue;\r\n\tinc2?: number|IDXValue;\r\n\tinc3?: number|IDXValue;\r\n\tinc4?: number|IDXValue;\r\n\tpreInc?: number|IDXValue;\r\n\tvolumn?: number|IDXValue;\r\n\tsmoothness?: number|IDXValue;\r\n\tdate?: any|IDXValue;\r\n}\r\n\r\nexport interface ActParamAccountValue {\r\n\tid: number|IDXValue;\r\n\tmi?: number|IDXValue;\r\n\tmarket?: number|IDXValue;\r\n\tcount?: number|IDXValue;\r\n\tcash?: number|IDXValue;\r\n\t$track?: number;\r\n}\r\n\r\nexport interface ActParamPortfolio {\r\n\tid: number|IDXValue;\r\n\tquantity?: number|IDXValue;\r\n\t$track?: number;\r\n}\r\n\r\nexport interface UserBlockStock {\r\n\tix: number;\r\n\tid: number;\r\n}\r\n\r\nexport interface UserAccount {\r\n\tix: number;\r\n\tid: number;\r\n}\r\n\r\nexport interface UserGroup {\r\n\tix: number;\r\n\tid: number;\r\n}\r\n\r\nexport interface UserAllStock {\r\n\tix: number;\r\n\tid: number;\r\n}\r\n\r\nexport interface AccountHolding {\r\n\tix: number;\r\n\tid: number;\r\n}\r\n\r\nexport interface GroupStock {\r\n\tix: number;\r\n\tid: number;\r\n\torder: number;\r\n}\r\n\r\nexport interface ParamActs {\r\n\t$Piecewise?: $Piecewise[];\r\n\tmarket?: Market[];\r\n\ttransaction?: Transaction[];\r\n\tgroup?: Group[];\r\n\taccount?: Account[];\r\n\tholding?: Holding[];\r\n\t$PiecewiseDetail?: $PiecewiseDetail[];\r\n\tstock?: Stock[];\r\n\tstockValue?: ActParamStockValue[];\r\n\taccountValue?: ActParamAccountValue[];\r\n\tportfolio?: ActParamPortfolio[];\r\n\tuserBlockStock?: UserBlockStock[];\r\n\tuserAccount?: UserAccount[];\r\n\tuserGroup?: UserGroup[];\r\n\tuserAllStock?: UserAllStock[];\r\n\taccountHolding?: AccountHolding[];\r\n\tgroupStock?: GroupStock[];\r\n}\r\n\r\n\r\nexport interface UqExt extends Uq {\r\n\tActs(param:ParamActs): Promise<any>;\r\n\r\n\t$user: UqTuid<Tuid$user>;\r\n\t$sheet: UqTuid<Tuid$sheet>;\r\n\tWriteStock: UqAction<ParamWriteStock, ResultWriteStock>;\r\n\tWritePrice: UqAction<ParamWritePrice, ResultWritePrice>;\r\n\t$poked: UqQuery<Param$poked, Result$poked>;\r\n\tSearchStock: UqQuery<ParamSearchStock, ResultSearchStock>;\r\n\tStockUsing: UqQuery<ParamStockUsing, ResultStockUsing>;\r\n\t$Piecewise: UqID<any>;\r\n\tMarket: UqID<any>;\r\n\tTransaction: UqID<any>;\r\n\tGroup: UqID<any>;\r\n\tAccount: UqID<any>;\r\n\tHolding: UqID<any>;\r\n\t$PiecewiseDetail: UqID<any>;\r\n\tStock: UqID<any>;\r\n\tStockValue: UqIDX<any>;\r\n\tAccountValue: UqIDX<any>;\r\n\tPortfolio: UqIDX<any>;\r\n\tUserBlockStock: UqIX<any>;\r\n\tUserAccount: UqIX<any>;\r\n\tUserGroup: UqIX<any>;\r\n\tUserAllStock: UqIX<any>;\r\n\tAccountHolding: UqIX<any>;\r\n\tGroupStock: UqIX<any>;\r\n}\r\n","//=== UqApp builder created on Tue Mar 23 2021 11:34:08 GMT-0400 (GMT-04:00) ===//\r\nimport * as BzHelloTonva from './BzHelloTonva';\r\nimport * as BruceYuMi from './BruceYuMi';\r\n\r\nexport interface UQs {\r\n\tBzHelloTonva: BzHelloTonva.UqExt;\r\n\tBruceYuMi: BruceYuMi.UqExt;\r\n}\r\n\r\nexport * as BzHelloTonva from './BzHelloTonva';\r\nexport * as BruceYuMi from './BruceYuMi';\r\n\r\nexport function setUI(uqs:UQs) {\r\n\tBzHelloTonva.setUI(uqs.BzHelloTonva);\r\n\tBruceYuMi.setUI(uqs.BruceYuMi);\r\n}\r\n","import { UqExt as Uq } from './BruceYuMi';\r\nimport * as $Piecewise from './$Piecewise.ui';\r\nimport * as Market from './Market.ui';\r\nimport * as Transaction from './Transaction.ui';\r\nimport * as Group from './Group.ui';\r\nimport * as Account from './Account.ui';\r\nimport * as Holding from './Holding.ui';\r\nimport * as $PiecewiseDetail from './$PiecewiseDetail.ui';\r\nimport * as Stock from './Stock.ui';\r\nimport * as StockValue from './StockValue.ui';\r\nimport * as AccountValue from './AccountValue.ui';\r\nimport * as Portfolio from './Portfolio.ui';\r\nimport * as UserBlockStock from './UserBlockStock.ui';\r\nimport * as UserAccount from './UserAccount.ui';\r\nimport * as UserGroup from './UserGroup.ui';\r\nimport * as UserAllStock from './UserAllStock.ui';\r\nimport * as AccountHolding from './AccountHolding.ui';\r\nimport * as GroupStock from './GroupStock.ui';\r\n\r\nexport function setUI(uq: Uq) {\r\n\tObject.assign(uq.$Piecewise, $Piecewise);\r\n\tObject.assign(uq.Market, Market);\r\n\tObject.assign(uq.Transaction, Transaction);\r\n\tObject.assign(uq.Group, Group);\r\n\tObject.assign(uq.Account, Account);\r\n\tObject.assign(uq.Holding, Holding);\r\n\tObject.assign(uq.$PiecewiseDetail, $PiecewiseDetail);\r\n\tObject.assign(uq.Stock, Stock);\r\n\tObject.assign(uq.StockValue, StockValue);\r\n\tObject.assign(uq.AccountValue, AccountValue);\r\n\tObject.assign(uq.Portfolio, Portfolio);\r\n\tObject.assign(uq.UserBlockStock, UserBlockStock);\r\n\tObject.assign(uq.UserAccount, UserAccount);\r\n\tObject.assign(uq.UserGroup, UserGroup);\r\n\tObject.assign(uq.UserAllStock, UserAllStock);\r\n\tObject.assign(uq.AccountHolding, AccountHolding);\r\n\tObject.assign(uq.GroupStock, GroupStock);\r\n}\r\nexport * from './BruceYuMi';\r\n","import * as React from 'react';\r\nimport { observable } from 'mobx';\r\nimport {\r\n    userApi, ItemSchema, StringSchema, ImageSchema, UiTextItem, UiImageItem, nav, Page,\r\n    Edit, UiSchema, VPage, Prop, FA, IconText, PropGrid\r\n} from 'tonva-react';\r\nimport { CMe } from './CMe';\r\n\r\nexport class VEditMe extends VPage<CMe>{\r\n\r\n    async open(param: any) {\r\n        this.openPage(this.page);\r\n    }\r\n\r\n    private schema: ItemSchema[] = [\r\n        { name: 'nick', type: 'string' } as StringSchema,\r\n        { name: 'icon', type: 'image' } as ImageSchema,\r\n    ];\r\n    private uiSchema: UiSchema = {\r\n        items: {\r\n            nick: { widget: 'text', label: '别名', placeholder: '好的别名更方便记忆' } as UiTextItem,\r\n            icon: { widget: 'image', label: '头像' } as UiImageItem,\r\n        }\r\n    }\r\n    @observable private data: any;\r\n\r\n    constructor(props: any) {\r\n        super(props);\r\n        let { nick, icon } = nav.user;\r\n        this.data = {\r\n            nick: nick,\r\n            icon: icon,\r\n        };\r\n    }\r\n\r\n    private onItemChanged = async (itemSchema: ItemSchema, newValue: any, preValue: any) => {\r\n        let { name } = itemSchema;\r\n        await userApi.userSetProp(name, newValue);\r\n        this.data[name] = newValue;\r\n        nav.user.name = newValue;\r\n        nav.saveLocalUser();\r\n    }\r\n\r\n\tprivate onExit = () => {\r\n        nav.showLogout();\r\n    }\r\n\r\n\tprivate changePassword = async () => {\r\n        await nav.changePassword();\r\n    }\r\n\r\n    private page = () => {\r\n\t\tlet { schema, uiSchema, data, onItemChanged } = this;\r\n\t\tlet gridRows: Prop[] = [\r\n\t\t\t'',\r\n\t\t\t{\r\n\t\t\t\ttype: 'component',\r\n\t\t\t\tcomponent: <IconText iconClass=\"text-info mr-2\" icon=\"key\" text={this.t('changePassword')} />,\r\n\t\t\t\tonClick: this.changePassword\r\n\t\t\t},\r\n\t\t\t'',\r\n\t\t\t'',\r\n\t\t\t{\r\n\t\t\t\ttype: 'component',\r\n\t\t\t\tbk: '',\r\n\t\t\t\tcomponent: <div className=\"w-100 text-center\">\r\n\t\t\t\t\t<button className=\"btn btn-danger w-100 w-max-20c\" onClick={this.onExit}>\r\n\t\t\t\t\t\t<FA name=\"sign-out\" size=\"lg\" /> {this.t('logout')}\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</div>\r\n\t\t\t},\r\n\t\t];\r\n\r\n\r\n\t\t/*\r\n\t\tlet vAdmin: any;\r\n\t\t\r\n\t\tlet { role } = this.controller;\r\n\t\tif ((role & 2) === 2) {\r\n\t\t\tvAdmin = <div className=\"px-3 py-2 cursor-pointer bg-white border-bottom\" onClick={this.controller.showAdmin}>管理员</div>;\r\n\t\t}\r\n\t\t{vAdmin}\r\n\t\t*/\r\n        return <Page header=\"个人信息\">\r\n            <Edit schema={schema} uiSchema={uiSchema}\r\n                data={data}\r\n                onItemChanged={onItemChanged} />\r\n\t\t\t<PropGrid rows={gridRows} values={{}} />\r\n        </Page>;\r\n    }\r\n}\r\n\r\nexport const webUserSchema: ItemSchema[] = [\r\n    { name: 'firstName', type: 'string', required: true } as StringSchema,\r\n    { name: 'gender', type: 'string' } as StringSchema,\r\n    { name: 'salutation', type: 'string' } as StringSchema,\r\n    { name: 'organizationName', type: 'string', required: true } as StringSchema,\r\n    { name: 'departmentName', type: 'string' } as StringSchema,\r\n];\r\n\r\n","//=== UqApp builder created on Tue Jan 12 2021 23:14:51 GMT-0500 (GMT-05:00) ===//\r\nimport { AppConfig, DevConfig } from \"tonva-react\";\r\n\r\nconst bz: DevConfig = {\r\n\tname: 'bizdev',\r\n\talias: 'bz',\r\n}\r\n\r\nconst bruce: DevConfig = {\r\n\tname: 'bruce',\r\n\talias: undefined,\r\n}\r\n\r\nexport const appConfig: AppConfig = {\r\n\tversion: '0.1.0',\r\n\tapp: undefined,\r\n\tuqs: [\r\n\t\t{\r\n\t\t\tdev: bz,\r\n\t\t\tname: 'hello-tonva',\r\n\t\t\talias: 'HelloTonva',\r\n\t\t\tversion: '0.1.0',\r\n\t\t},\r\n\t\t{\r\n\t\t\tdev: bruce,\r\n\t\t\tname: 'yumi',\r\n\t\t\talias: 'YuMi',\r\n\t\t\tversion: '0.1.0',\r\n\t\t},\r\n\t],\r\n\tnoUnit: true,\r\n    tvs: {},\r\n\toem: undefined,\r\n\thtmlTitle: '鱼米乡 - 私享投资圈',\r\n};\r\n","import { VPage } from \"tonva-react\";\r\nimport { CMe } from \"./CMe\";\r\n\r\nexport class VFaq extends VPage<CMe> {\r\n\theader() {return '基本概念'}\r\n\tcontent() {\r\n\t\treturn <ul>\r\n\t\t\t<li className=\"my-3\">\r\n\t\t\t\t<div className=\"my-2\">基本公理</div>\r\n\t\t\t\t<ul className=\"px-3 text-info\">\r\n\t\t\t\t\t<li><span className=\"mr-3\">公理1: </span>进步是社会的必然</li>\r\n\t\t\t\t\t<li><span className=\"mr-3\">公理2: </span>信任是经济的基石</li>\r\n\t\t\t\t\t<li><span className=\"mr-3\">公理3: </span>价值是价格的准心</li>\r\n\t\t\t\t\t<li><span className=\"mr-3\">公理4: </span>发展是企业的基因</li>\r\n\t\t\t\t</ul>\r\n\t\t\t</li>\r\n\t\t\t<li className=\"my-3\">\r\n\t\t\t\t<div className=\"my-2\">米投定律</div>\r\n\t\t\t\t<ul className=\"px-3 text-info\">\r\n\t\t\t\t\t<li><span className=\"mr-3\">定律1: </span>投资无风险</li>\r\n\t\t\t\t</ul>\r\n\t\t\t</li>\r\n\t\t\t<li className=\"my-3\">\r\n\t\t\t\t<div className=\"my-2\">米投原则</div>\r\n\t\t\t\t<ul className=\"px-3 text-info\">\r\n\t\t\t\t\t<li><span className=\"mr-3\">原则1: </span>低估</li>\r\n\t\t\t\t\t<li><span className=\"mr-3\">原则2: </span>分散</li>\r\n\t\t\t\t\t<li><span className=\"mr-3\">原则3: </span>不深研</li>\r\n\t\t\t\t</ul>\r\n\t\t\t</li>\r\n\t\t\t<li className=\"my-3\">\r\n\t\t\t\t<div className=\"my-2\">米息定义</div>\r\n\t\t\t\t<ul className=\"px-3 text-info\">\r\n\t\t\t\t\t<li><span className=\"mr-3\">定义1: </span>米息 = 增息 + 股息</li>\r\n\t\t\t\t\t<li><span className=\"mr-3\">定义2: </span>增息 = 企业未来三年利润增长值</li>\r\n\t\t\t\t\t<li><span className=\"mr-3\">定义3: </span>米息率 = 米息 / 股价</li>\r\n\t\t\t\t\t<li><span className=\"mr-3\">定义4: </span>米息率大一倍，米息分加1</li>\r\n\t\t\t\t\t<li><span className=\"mr-3\">定义5: </span>PE = 股价 / 利润</li>\r\n\t\t\t\t</ul>\r\n\t\t\t</li>\r\n\t\t</ul>\r\n\t}\r\n}","import { VPage } from \"tonva-react\";\r\nimport { appConfig } from \"../uq-app/appConfig\";\r\nimport { CMe } from \"./CMe\";\r\n\r\nexport class VAbout extends VPage<CMe> {\r\n\theader() {return '关于APP';}\r\n\tcontent() {\r\n\t\treturn <div className=\"py-5 px-3 my-3 w-max-30c mx-auto bg-white\">\r\n\t\t\t<div className=\"text-center mb-5 position-relative\">\r\n\t\t\t\t<small className=\"text-muted position-absolute\"\r\n\t\t\t\t\tstyle={{right:'0', top:'-2.8rem'}}>\r\n\t\t\t\t\t版本: {appConfig.version}\r\n\t\t\t\t</small>\r\n\t\t\t\t<i className=\"text-danger position-absolute top-0 start-0 fa fa-fire fa-2x\" \r\n\t\t\t\t\tstyle={{left:'2rem', top:'0.5rem'}} />\r\n\t\t\t\t<b className=\"text-danger h5 mb-0\">\r\n\t\t\t\t\t<span className=\"text-primary\">鱼</span>\r\n\t\t\t\t\t<b className=\"mx-1\">米</b>\r\n\t\t\t\t\t<span className=\"text-success\">乡</span>\r\n\t\t\t\t</b>\r\n\t\t\t\t<br/>\r\n\t\t\t\t<small className=\"text-info\">私享投资圈</small>\r\n\t\t\t</div>\r\n\t\t\t<ul>\r\n\t\t\t\t<li>跟家人和好友一起分享投资思考。</li>\r\n\t\t\t\t<li>世界级投资大师年化收益率11%。</li>\r\n\t\t\t\t<li>全球最大的成长经济体GDP增长率高于5%。</li>\r\n\t\t\t\t<li>以10%为基础，期待<b className=\"text-danger mx-1\">15%以上</b>的高水平。</li>\r\n\t\t\t</ul>\r\n\t\t\t<div className=\"mt-5 text-center\">\r\n\t\t\t\t<small className=\"text-muted mr-2\">by</small>\r\n\t\t\t\t同花投顾\r\n\t\t\t</div>\r\n\t\t</div>;\r\n\t}\r\n}\r\n","import React from 'react';\r\nimport { observer } from 'mobx-react';\r\nimport { Image, VPage, nav, IconText, PropGrid, LMR, FA, Prop } from 'tonva-react';\r\nimport { CMe } from './CMe';\r\nimport { appConfig } from \"../uq-app/appConfig\";\r\nimport { VFaq } from './VFaq';\r\nimport { VAbout } from './VAbout';\r\n\r\nexport class VMe extends VPage<CMe> {\r\n\theader() {return this.t('me')}\r\n\r\n\tcontent() {\r\n        const { user } = nav;\r\n        let aboutRows: Prop[] = [\r\n            '',\r\n            {\r\n                type: 'component',\r\n                component: <LMR className=\"w-100\" onClick={this.faq}\r\n\t\t\t\t\tright={<FA className=\"align-self-center\" name=\"angle-right\" />}>\r\n                    <IconText iconClass=\"text-info mr-2\" icon=\"comments-o\" text={this.t('基本概念')} />                    \r\n                </LMR>,\r\n            },\r\n            {\r\n                type: 'component',\r\n                component: <LMR className=\"w-100\" onClick={this.about}\r\n\t\t\t\t\tright={<FA className=\"align-self-center\" name=\"angle-right\" />}>\r\n                    <IconText iconClass=\"text-info mr-2\" \r\n\t\t\t\t\t\ticon=\"smile-o\" \r\n\t\t\t\t\t\ttext={<>{this.t('aboutTheApp')} <small>版本 {appConfig.version}</small></>} />                    \r\n                </LMR>,\r\n            },\r\n        ];\r\n\r\n        let rows: Prop[];\r\n        if (user === undefined) {\r\n            rows = aboutRows;\r\n            rows.push(\r\n                {\r\n                    type: 'component',\r\n                    component: <button className=\"btn btn-success w-100 my-2\" onClick={() => nav.logout()}>\r\n                        <FA name=\"sign-out\" size=\"lg\" /> {this.t('pleaseLogin')}\r\n                    </button>\r\n                },\r\n            );\r\n        }\r\n        else {\r\n            let logOutRows: Prop[] = [\r\n            ];\r\n\r\n            rows = [\r\n                '',\r\n                {\r\n                    type: 'component',\r\n                    component: <this.meInfo />\r\n                },\r\n            ]\r\n            rows.push(...aboutRows, ...logOutRows);\r\n        }\r\n        return <PropGrid rows={[...rows]} values={{}} />;\r\n\t}\r\n\r\n\tprivate meInfo = observer(() => {\r\n        let { user } = nav;\r\n        if (user === undefined) return null;\r\n        let { id, name, nick, icon } = user;\r\n        return <LMR className=\"py-2 cursor-pointer w-100\"\r\n            left={<Image className=\"w-3c h-3c mr-3\" src={icon || '.user-o'} />}\r\n            right={<FA className=\"align-self-end\" name=\"angle-right\" />}\r\n            onClick={this.controller.showEditMe}>\r\n            <div>\r\n                <div>{userSpan(name, nick)}</div>\r\n                <div className=\"small\"><span className=\"text-muted\">ID:</span> {id > 10000 ? id : String(id + 10000).substr(1)}</div>\r\n            </div>\r\n        </LMR>;\r\n    });\r\n\r\n\tprivate faq = () => {\r\n\t\tthis.openVPage(VFaq);\r\n\t}\r\n\r\n\tprivate about = () => {\r\n\t\tthis.openVPage(VAbout);\r\n\t}\r\n}\r\n\r\nfunction userSpan(name: string, nick: string): JSX.Element {\r\n    return nick ?\r\n        <><b>{nick} &nbsp; <small className=\"muted\">{name}</small></b></>\r\n        : <b>{name}</b>\r\n}\r\n","import { QueryPager, User } from \"tonva-react\";\r\nimport { CUqBase } from \"../uq-app\";\r\nimport { VEditMe } from \"./VEditMe\";\r\nimport { VMe } from \"./VMe\";\r\n//import { VAdmin } from \"./VAdmin\";\r\n\r\nexport interface RootUnitItem {\r\n\tid: number;\t\t\t\t\t// root unit id\r\n\towner: any;\r\n\tname: string;\t\t\t\t// 唯一\r\n\tcontent: string;\r\n\ttonvaUnit: number;\t\t\t// 跟tonva机构对应的值\r\n\tx: number;\r\n}\r\n\r\nexport class CMe extends CUqBase {\r\n\trole: number;\r\n\tunitOwner: User;\r\n\trootUnits: QueryPager<any>;\r\n\r\n    protected async internalStart() {\r\n\t}\r\n\r\n\ttab = () => this.renderView(VMe);\r\n\r\n\tshowEditMe = async () => {\r\n\t\t//let result = await this.uqs.Notes.GetSystemRole.query({});\r\n\t\tthis.role = undefined; // result.ret[0]?.role;\r\n\t\tthis.openVPage(VEditMe);\r\n\t}\r\n\t/*\r\n\tshowAdmin = async () => {\r\n\t\tthis.rootUnits = new QueryPager<any>(this.uqs.Notes.GetRootUnits, undefined, undefined, true);\r\n\t\tthis.rootUnits.first({});\r\n\t\tthis.openVPage(VAdmin);\r\n\t}\r\n\r\n\tasync createRootUnit(param: {name:string; content:string; owner:number}): Promise<number> {\r\n\t\tlet result = await this.uqs.Notes.CreateRootUnit.submit(param);\r\n\t\treturn result.id;\r\n\t}\r\n\r\n\tasync changeRootUnitName(item:RootUnitItem, name:string) {\r\n\t\tawait this.uqs.Notes.ChangeRootUnitProp.submit({unit:item.id, prop:'name', value: name})\r\n\t\titem.name = name;\r\n\t}\r\n\r\n\tasync changeRootUnitTonva(item:RootUnitItem, tonvaUnit:any) {\r\n\t\tawait this.uqs.Notes.ChangeRootUnitProp.submit({unit:item.id, prop:'tonvaUnit', value: tonvaUnit})\r\n\t\titem.tonvaUnit = tonvaUnit;\r\n\t}\r\n\r\n\tasync changeRootUnitX(item:RootUnitItem, x:number) {\r\n\t\tawait this.uqs.Notes.ChangeRootUnitProp.submit({unit:item.id, prop:'x', value: x as any})\r\n\t\titem.x = x;\r\n\t}\r\n\t*/\r\n}\r\n","export default __webpack_public_path__ + \"static/media/logo.2d27ead7.svg\";","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport { LMR, View } from 'tonva-react';\r\nimport logo from '../images/logo.svg';\r\nimport { CExplorer } from './CExplorer';\r\n\r\nexport class VSiteHeader extends View<CExplorer> {\r\n    render() {\r\n        let left = <img className=\"m-1\" src={logo} alt=\"logo\" style={{height: \"3rem\", width: \"3rem\"}} />;\r\n        let right = undefined;\r\n        return <LMR\r\n            className=\"mb-3 align-items-center bg-white\"\r\n            left={left} right={right}>\r\n            <div className=\"\">\r\n                {this.controller.renderSiteHeader()}\r\n            </div>\r\n        </LMR>\r\n    }\r\n}","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport * as React from 'react';\r\nimport { observer } from 'mobx-react';\r\nimport { VPage, List, LMR, FA, Scroller } from 'tonva-react';\r\nimport { NStockInfo } from '../stockinfo';\r\nimport { GFunc } from '../tool/GFunc';\r\nimport { CExplorer } from './CExplorer';\r\nimport { renderSortHeaders, renderStockInfoRow, renderStockUrl } from '../tool';\r\n\r\nexport class VExplorer extends VPage<CExplorer> {\r\n\theader() {return '股票发现'}\r\n\tprotected onPageScrollBottom(scroller: Scroller): Promise<void> {\r\n\t\tthis.controller.onPage();\r\n\t\treturn;\r\n\t}\r\n\r\n\tright() {\r\n\t\tlet { onConfig } = this.controller;\r\n\t\treturn <div className=\"btn align-self-center cursor-pointer \" onClick={onConfig}><FA name=\"cog\" size=\"lg\" inverse={true} /></div>\r\n\t}\r\n\r\n\tcontent() {\r\n\t\treturn React.createElement(observer(() => {\r\n\t\t\tlet {explore, load, setSortType} = this.controller;\r\n\t\t\tlet {items, avgs, sortType } = explore;\r\n\r\n\t\t\tlet left: any;\r\n\t\t\tlet right = <div className=\"btn btn-link cursor-pointer py-1\" onClick={load}>刷新</div>;\r\n\t\t\t/*if (avgs.avg20 !== undefined || avgs.avg50 !== undefined || avgs.avg100 !== undefined) {\r\n\t\t\t\tlet avgStr = ` top20 : ${GFunc.numberToFixString(avgs.avg20)} \r\n  -  top50 : ${GFunc.numberToFixString(avgs.avg50)}\r\n  -  top100 : ${GFunc.numberToFixString(avgs.avg100)}\r\n  -  all : ${GFunc.numberToFixString(avgs.avg)}\r\n  ...查看历史走势`;\r\n\t\t\t\tleft = <div className=\"px-3 cursor-pointer align-self-center\"\r\n\t\t\t\t\tonClick={this.controller.onClickPredictAVG}>\r\n\t\t\t\t\t\t{GFunc.caption('价值指数均值')}{avgStr}\r\n\t\t\t\t\t</div>;\r\n\t\t\t}*/\r\n\t\t\tif (avgs.avg !== undefined) {\r\n\t\t\t\tlet avgStr = ` : ${GFunc.numberToFixString(Math.log(avgs.avg), 1)}`;\r\n\t\t\t\tleft = <div className=\"px-3 cursor-pointer align-self-center\">\r\n\t\t\t\t\t\t{GFunc.caption('米息分均值')}{avgStr}\r\n\t\t\t\t\t</div>;\r\n\t\t\t}\t\t\t\r\n\t\t\treturn <>\r\n\t\t\t\t<LMR left={left} right={right} />\r\n\t\t\t\t<div className=\"d-flex justify-content-end mr-2 my-1\">\r\n\t\t\t\t\t{renderSortHeaders('radioHome', sortType, setSortType)}\r\n\t\t\t\t</div>\r\n\t\t\t\t<List items={items}\r\n\t\t\t\t\titem={{ render: this.renderRow, key: this.rowKey }}\r\n\t\t\t\t\tbefore={'选股'}\r\n\t\t\t\t/>\r\n\t\t\t</>\r\n\t\t}));\r\n\t}\r\n\r\n\trenderRow = (item: any, index: number): JSX.Element => {\r\n\t\treturn this.rowContent(item);\r\n\t} \r\n\tprotected rowContent = (row: any): JSX.Element => {\r\n\t\tlet {store} = this.controller.cApp;\r\n\t\tlet { id, symbol } = row as NStockInfo;\r\n\t\t//if (store.isMyBlack(id) === true) return null;\r\n\t\tlet labelId = 'vexl_' + id;\r\n\t\tlet isMySelect = store.isMyAll(undefined); // defList.findIndex(v=>v===id);\r\n\t\tlet middle = <label className=\"mb-0 cursor-pointer\">\r\n\t\t\t<input className=\"mr-1\" type=\"checkbox\" value=\"\" id={labelId}\r\n\t\t\tdefaultChecked={isMySelect}\r\n\t\t\tonChange={e => this.onSelect(row, e.target.checked)}/>\r\n\t\t\t<small className=\"text-muted\">自选</small>\r\n\t\t</label>;\r\n\r\n\t\tlet right = <div className=\"d-flex\">\r\n\t\t\t{renderStockUrl(row)}\r\n\t\t</div>;\r\n\t\treturn renderStockInfoRow(row, this.onClickName, middle, right);\r\n\t};\r\n\r\n\tprivate rowKey = (item: any) => {\r\n\t\tif (item.item !== undefined) {\r\n\t\t\treturn item.item.id;\r\n\t\t}\r\n\t\tlet { id } = item;\r\n\t\treturn id;\r\n\t}\r\n\r\n\tprotected onClickName = (item: NStockInfo) => {\r\n\t\tthis.controller.openStockInfo(item);\r\n\t}\r\n\r\n\tprotected onSelect = async (item: any, isSelected:boolean): Promise<void> => {\r\n\t\tthis.controller.onSelectItem(item, isSelected);\r\n\t}\r\n\r\n\tprotected onClickItem = async (item: any): Promise<void> => {\r\n\t\tthis.controller.openStockInfo(item);\r\n\t}\r\n}","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport * as React from 'react';\r\nimport { observer } from 'mobx-react';\r\nimport { VPage, Page, FA, List, Form, ItemSchema, StringSchema, UiInputItem, UiSchema, Context, IdSchema, UiIdItem, LMR, UiSelect, UiTextItem } from 'tonva-react';\r\nimport { CExplorer } from './CExplorer';\r\n\r\nconst schema: ItemSchema[] = [\r\n  { name: 'irate', type: 'number', required: true},\r\n  { name: 'bmin', type: 'number', required: true},\r\n  { name: 'bmax', type: 'number', required: true},\r\n  { name: 'r2', type: 'number', required: true},\r\n  { name: 'lmin', type: 'number', required: true},\r\n  { name: 'lmax', type: 'number', required: true},\r\n  { name: 'lr2', type: 'number', required: true},\r\n  { name: 'mcount', type: 'integer', required: true},\r\n  { name: 'lr4', type: 'number', required: true},\r\n  { name: 'r210', type: 'number', required: true},\r\n  { name: 'submit', type: 'submit', },\r\n];\r\n\r\nconst uiSchema: UiSchema = {\r\n  items: {\r\n    irate: { widget: 'number', label: '无风险收益率', placeholder: '0.04'} as UiInputItem,\r\n    bmin: { widget: 'number', label: '指数回归最小值', placeholder: '0.00'} as UiInputItem,\r\n    bmax: { widget: 'number', label: '指数回归最大值', placeholder: '0.00'} as UiInputItem,\r\n    r2: { widget: 'number', label: '指数回归R2', placeholder: '0.00'} as UiInputItem,\r\n    lmin: { widget: 'number', label: '线性回归最小值', placeholder: '0.00'} as UiInputItem,\r\n    lmax: { widget: 'number', label: '线性回归最大值', placeholder: '0.00'} as UiInputItem,\r\n    lr2: { widget: 'number', label: '线性回归R2', placeholder: '0.00'} as UiInputItem,\r\n    lr4: { widget: 'number', label: '末年与前4年均值最大比值', placeholder: '0.00'} as UiInputItem,\r\n    mcount: { widget: 'number', label: '5年内单季亏损最多允许出现次数', placeholder: '0.00'} as UiInputItem,\r\n    r210: { widget: 'number', label: '十年回归R2', placeholder: '0.00'} as UiInputItem,\r\n    submit: { widget: 'button', label: '保存', className: 'btn btn-primary' },\r\n  }\r\n};\r\n\r\n\r\nexport class VExplorerCfg extends VPage<CExplorer> {\r\n  async open(param?: any) {\r\n    this.openPage(this.page);\r\n  }\r\n\r\n  sortChage = (e:any)=> {\r\n    let newType = e.target.value;\r\n\r\n    this.controller.cApp.store.setStockSortType(newType);\r\n  }\r\n\r\n  selectChange = (e:any)=> {\r\n    let newType = e.target.value;\r\n\r\n    this.controller.cApp.store.setStockSelectType(newType);\r\n  }\r\n\r\n  onChange = (e:any) => {\r\n    let {name, value} = e.target;\r\n  }\r\n\r\n  private onFormButtonClick = async (name: string, context: Context) => {\r\n    //await this.controller.onSaveNewWarning(context.data);\r\n    let {bmin, bmax, r2, lmin, lmax, lr2, mcount, lr4, r210, irate} = context.data;\r\n    let cfg = {bmin:bmin, bmax:bmax, r2:r2, lmin:lmin, lmax:lmax, lr2:lr2, mcount:mcount, lr4:lr4, r210:r210, irate:irate};\r\n    await this.controller.cApp.store.setRegressionConfig(cfg);\r\n    this.controller.closePage();\r\n  }\r\n\r\n\r\n  private page = observer(() => {\r\n    let scfg = this.controller.cApp.store.findStockConfg;\r\n    //let findType = scfg.sortType;\r\n    // let selectType = scfg.selectType;\r\n    // if (selectType === undefined) {\r\n    //   selectType = 'all';\r\n    // }\r\n    let fData = this.controller.cApp.store.config.regression;\r\n    if (fData.irate === undefined)\r\n      fData.irate = 0.04;\r\n\r\n    return <Page header=\"选股设置\" headerClassName=\"bg-primary\">\r\n      {/* <div className=\"px-3 py-2\">方法</div>\r\n      <div className=\"px-3 py-2 d-flex flex-wrap\">\r\n        <label className=\"px-3 c8\"> <input type=\"radio\" name=\"selectType\" value=\"all\" checked={selectType===\"all\"}\r\n          onChange={this.selectChange} />预期PE</label><br />\r\n        <label className=\"px-3 c8\"> <input type=\"radio\" name=\"selectType\" value=\"value\" checked={selectType===\"value\"}\r\n          onChange={this.selectChange} />价值指数</label><br />\r\n      </div> */}\r\n      <div className=\"px-3 py-2\">回归参数</div>\r\n      <Form schema={schema}\r\n          uiSchema={uiSchema}\r\n          formData={fData}\r\n          onButtonClick={this.onFormButtonClick}\r\n        />\r\n    </Page>;\r\n  })\r\n}\r\n","import { makeObservable, observable, runInAction } from \"mobx\";\r\nimport { GFunc } from \"../tool\";\r\nimport { Store, sortStocks, Stock } from \"../store\";\r\n\r\ninterface Avg {\r\n\tavg20?: number;\r\n\tavg50?: number;\r\n\tavg100?: number;\r\n\tavg?: number;\r\n}\r\n\r\nexport class Explore {\r\n\tprivate store: Store;\r\n\titems: any[]; // = observable.array<any>([], { deep: true });\r\n\tavgs: Avg = {};\r\n\tlastTradeDay: number;\r\n\tsortType: string;\r\n\tselectedItems: any[] = [];\r\n  \r\n\tconstructor(store: Store) {\r\n\t\tthis.store = store;\r\n\t\tmakeObservable(this, {\r\n\t\t\tavgs: observable,\r\n\t\t\titems: observable,\r\n\t\t\tsortType: observable,\r\n\t\t});\r\n\t}\r\n\t\r\n\tload = async () => {\r\n\t\tthis.selectedItems = [];\r\n\t\tlet items = await this.loadItems();\r\n\t\trunInAction(() => {\r\n\t\t\tthis.sortType = this.store.config.userStock.sortType;\r\n\t\t\tsortStocks(this.sortType, items);\r\n\t\t\tif (!this.items) {\r\n\t\t\t\tthis.items = items;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tthis.items.splice(0, this.items.length, items);\r\n\t\t\t}\t\r\n\t\t});\r\n\t}\r\n\r\n\tprivate async loadItems():Promise<any[]> {\r\n\t\tlet queryName = 'all';\r\n\t\tlet rets = await this.store.loadExportItems(queryName);\r\n\t\tlet lastDayRet = rets[1] as {day:number}[];\r\n\t\tif (Array.isArray(lastDayRet) && lastDayRet.length > 0) {\r\n\t\t\tthis.lastTradeDay = lastDayRet[0].day;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.lastTradeDay = undefined;\r\n\t\t}\r\n\t\tlet result = rets[0];\r\n\t\tif (Array.isArray(result) === false) {\r\n\t\t\treturn;\r\n\t\t};\r\n\t\tlet arr: Stock[] = result;\r\n\t\tfor (let item of arr) {\r\n            let data = item.data;\r\n\t\t\tlet dataArray = data ===undefined ? [] : JSON.parse(item.data) as number[];\r\n\t\t\titem.dataArr = dataArray;\r\n            let e = item.e * item.eshares;\r\n            let p = item.price * item.pshares;\r\n            let c = item.capital * item.eshares;\r\n            let b = item.bonus * item.bshares;\r\n\t\t\titem.v = GFunc.calculateVS(item.ev * item.eshares, b, p);\r\n            item.pe = p / e;\r\n            item.roe = e / c;\r\n            item.divyield = b / p;\r\n\t\t}\r\n\t\trunInAction(() => {\r\n\t\t\tif (queryName === 'all') {\r\n\t\t\t\tthis.avgs = GFunc.CalculateValueAvg(arr as  {v:number}[]);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tthis.avgs = {};\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn arr;\r\n\t}\r\n\r\n\tasync onItemSelected(item:any) {\r\n\t\tthis.store.addTagStock(item);\r\n\t}\r\n\r\n\tasync onItemUnselected(item:any) {\r\n\t\tthis.store.removeTagStock(item);\r\n\t}\r\n\r\n\tsetSortType(type:string) {\r\n\t\trunInAction(() => {\r\n\t\t\tsortStocks(type, this.items);\r\n\t\t\tthis.store.setUserSortType(type);\t\r\n\t\t});\r\n\t}\r\n}\r\n","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport { CApp, CUqBase } from \"../uq-app\";\r\nimport { CStockInfo, NStockInfo } from '../stockinfo';\r\nimport { VSiteHeader } from './VSiteHeader';\r\nimport { VExplorer } from './VExplorer';\r\nimport { VExplorerCfg } from './VExplorerCfg';\r\nimport { PredictHistoryParam } from 'predicthistory/CPredictHistory';\r\nimport { Explore } from './explore';\r\n\r\nexport class CExplorer extends CUqBase {\r\n\texplore: Explore;\r\n\r\n\tconstructor(cApp: CApp) {\r\n\t\tsuper(cApp);\r\n\t\tlet {store} = cApp;\r\n\t\tthis.explore = new Explore(store);\r\n\t}\r\n\r\n\tload = async () => {\r\n\t\tthis.explore.load();\r\n\t}\r\n\r\n\tonPage = async () => {\r\n\t\t//this.PageItems.more();\r\n\t}\r\n\r\n\tonConfig = async () => {\r\n\t\tthis.openVPage(VExplorerCfg);\r\n\t}\r\n\r\n\tasync internalStart(param: any) {\r\n\t}\r\n\r\n\tonSelectItem = async (item:any, isSelected:boolean) => {\r\n\t\tif (isSelected === true) {\r\n\t\t\tthis.explore.onItemSelected(item);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.explore.onItemUnselected(item);\r\n\t\t}\r\n\t}\r\n\r\n\tsetSortType = (type:string) => this.explore.setSortType(type);\r\n\r\n\trenderSiteHeader = () => {\r\n\t\treturn this.renderView(VSiteHeader);\r\n\t}\r\n\r\n\trenderHome = () => {\r\n\t\treturn this.renderView(VExplorer);\r\n\t}\r\n\r\n\r\n\topenMetaView = () => {}\r\n\r\n\ttab = () => this.renderHome();\r\n\r\n\topenStockInfo = (item: NStockInfo) => {\r\n\t\tlet cStockInfo = this.newC(CStockInfo);\r\n\t\tcStockInfo.start(item);\r\n\t}\r\n\r\n\tonClickPredictAVG = () => {\r\n\t\tlet {avgs, lastTradeDay} = this.explore;\r\n\t\tlet param: PredictHistoryParam = {\r\n\t\t  day:undefined,\r\n\t\t  priceDay:lastTradeDay,\r\n\t\t  avg20:avgs.avg20,\r\n\t\t  avg50:avgs.avg50,\r\n\t\t  avg100:avgs.avg100,\r\n\t\t  avg:avgs.avg,\r\n\t\t}\r\n\t\tthis.cApp.openPredictAVG(param);\r\n\t}\r\n}\r\n","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport * as React from 'react';\r\nimport { observer } from 'mobx-react-lite';\r\nimport { VPage, Page, FA, List, Form, ItemSchema, StringSchema, UiInputItem, UiSchema, Context, IdSchema, UiIdItem, LMR, UiSelect, UiTextItem } from 'tonva-react';\r\nimport { CWarning } from './CWarning';\r\nimport { GFunc } from 'tool/GFunc';\r\n\r\nexport class VWarningConfig extends VPage<CWarning> {\r\n  async open(param?: any) {\r\n    this.openPage(this.page);\r\n  }\r\n\r\n  private onSelect = (item: any, isSelected: boolean, anySelected: boolean) => {\r\n    //this.controller.onTaged(item, isSelected);\r\n  }\r\n\r\n  private page = observer(() => {\r\n    let { warnings } = this.controller;\r\n    let divNewTag = warnings.length >= 100 ? '' :\r\n      <div className=\"px-3 py-2 cursor-pointer\" onClick={this.controller.onNewWarning}><FA name=\"plus\" className=\"text-primary\" /> &nbsp; 新建预警</div>;\r\n    return <Page header=\"预警\" headerClassName=\"bg-primary\">\r\n      {divNewTag}\r\n      <List items={warnings} \r\n        item={{ render: this.renderWarning }} \r\n        none={'--'} />\r\n    </Page>;\r\n  })\r\n\r\n  private renderWarning = (witem: any) => {\r\n    let {name, code, type, price} = witem;\r\n    let left = <div className=\"px-3 cursor-pointer\">\r\n      {name}\r\n      <small className=\" mx-3\" >{code}</small></div>;\r\n    return <LMR className=\"mx-3 my-2\" left={left} >\r\n      <div className=\"d-flex flex-wrap\">\r\n        <div className=\"px-3 c6\">{GFunc.warningTypeString(type)}</div>\r\n        <div className=\"px-3 c6\">{GFunc.numberToFixString(price)}</div>\r\n      </div>\r\n    </LMR>;\r\n  }\r\n}\r\n\r\nconst schema: ItemSchema[] = [\r\n  { name: 'id', type: 'id' } as IdSchema,\r\n  { name: 'type', type: 'string', required: true, maxLength: 2 } as StringSchema,\r\n  { name: 'price', type: 'number', required: true},\r\n  { name: 'submit', type: 'submit', },\r\n];\r\n\r\nconst uiSchema: UiSchema = {\r\n  items: {\r\n    id: { widget: 'id',\r\n      label: '股票',\r\n      visible: true} as UiIdItem,\r\n    type: { widget: 'select', label: '类型', \r\n    list: [{value:'gt', title:'大于'}, {value:'lt', title:'小于'}] } as UiSelect,\r\n    price: { widget: 'text', label: '价格', placeholder: '0.00'} as UiTextItem,\r\n    submit: { widget: 'button', label: '保存', className: 'btn btn-primary' },\r\n  }\r\n};\r\n\r\nexport class VNewWarning extends VPage<CWarning> {\r\n  async open(param?: any) {\r\n    this.openPage(this.page);\r\n  }\r\n\r\n  private newuiSchema: UiSchema = {\r\n    items: {\r\n      id: { widget: 'id',\r\n        label: '股票',\r\n        visible: true,\r\n        placeholder: <small className=\"text-muted\">请选择股票</small>,\r\n        pickId: async (context: Context, name: string, value: number) => {\r\n          return await this.controller.showSelectStock(context, name, value)\r\n        },\r\n        Templet: (item: any) => {\r\n          let { name, code } = item;\r\n          if (!item) return <small className=\"text-muted\">请选择股票</small>;\r\n          return <div>\r\n              {name}\r\n              <small className=\" mx-3\" >{code}</small>\r\n          </div>;\r\n        }\r\n      } as UiIdItem,\r\n      type: { widget: 'select', label: '类型', \r\n      list: [{value:'gt', title:'大于'}, {value:'lt', title:'小于'}] } as UiSelect,\r\n      price: { widget: 'text', label: '价格', placeholder: '0.00'} as UiTextItem,\r\n      submit: { widget: 'button', label: '保存', className: 'btn btn-primary' },\r\n    }\r\n  };\r\n  \r\n  private onFormButtonClick = async (name: string, context: Context) => {\r\n    await this.controller.onSaveNewWarning(context.data);\r\n  }\r\n\r\n  private page = () => {\r\n    let fData = {type:'lt'};\r\n    return <Page header=\"新建预警\" headerClassName=\"bg-primary\">\r\n      <div className=\"px-3 py-3\">\r\n        <Form schema={schema}\r\n          uiSchema={this.newuiSchema}\r\n          formData={fData}\r\n          onButtonClick={this.onFormButtonClick}\r\n        />\r\n      </div>\r\n    </Page>;\r\n  }\r\n}\r\n\r\nexport class VEditWarning extends VPage<CWarning> {\r\n  async open(param?: any) {\r\n    this.openPage(this.page, param);\r\n  }\r\n\r\n  private onFormButtonClick = async (name: string, context: Context) => {\r\n    await this.controller.onSaveWarning(context.data);\r\n  }\r\n\r\n  private page = (param?: any) => {\r\n    let {id, type, price} = param;\r\n    let fData = {id:id, type:type, price:price};\r\n    return <Page header=\"编辑预警\" headerClassName=\"bg-primary\">\r\n      <div className=\"px-3 py-3\">\r\n        <Form schema={schema}\r\n          uiSchema={uiSchema}\r\n          formData={fData}\r\n          onButtonClick={this.onFormButtonClick}\r\n        />\r\n      </div>\r\n    </Page>;\r\n  }\r\n}\r\n","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport { Context } from 'tonva-react';\r\nimport { observable } from 'mobx';\r\nimport { CUqBase } from \"../uq-app\";\r\nimport { CSelectStock } from '../selectStock';\r\nimport { VWarningConfig, VNewWarning } from './VWarningConfig';\r\n\r\nexport class CWarning extends CUqBase {\r\n\t//get cApp(): CApp { return this._cApp as CApp };\r\n\t@observable warnings:any[] = [];\r\n\r\n\tasync internalStart(param: any) {\r\n\t\tlet a = 1;\r\n\t}\r\n\r\n\tasync loadWarnings() {\r\n\t\t//let r = await this.cApp.store.miApi.call('t_stockwarning$all', [this.user.id]);//await this.uqs.mi.StockWarningAll.query(undefined);\r\n\t\tlet r = await this.cApp.miNet.t_stockwarning$all();\r\n\t\tlet ret = r as any[];\r\n\t\tthis.warnings = ret;\r\n\t}\r\n\r\n\tonNewWarning = () => {\r\n\t\tthis.openVPage(VNewWarning);\r\n\t}\r\n\r\n\tonWarningConfg = async () => {\r\n\t\tawait this.loadWarnings();\r\n\t\tthis.openVPage(VWarningConfig);\r\n\t}\r\n\r\n\tonSaveNewWarning = async (data: any) => {\r\n\t\tlet { id, type, price } = data;\r\n\t\t// let param = {\r\n\t\t//   user: this.cApp.user.id,\r\n\t\t//   stock: id,\r\n\t\t//   arr1: [\r\n\t\t//     { type: type, price: price }\r\n\t\t//   ]};\r\n\t\t//let ret = await this.uqs.mi.StockWarning.add(param);\r\n\t\t//await this.cApp.store.miApi.call('t_stockwarning$add', [this.cApp.user.id, id.id, type, price]);\r\n\t\tawait this.cApp.miNet.t_stockwarning$add(id.id, type, price);\r\n\t\tthis.closePage();\r\n\t}\r\n\r\n\tonSaveWarning = async (data: any) => {\r\n\r\n\t}\r\n\r\n\tshowSelectStock = async (context: Context, name: string, value: number): Promise<any> => {\r\n\t\tlet cStock = new CSelectStock(this.cApp);\r\n\t\treturn await cStock.call();\r\n\t}\r\n}","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport * as React from 'react';\r\nimport { observer } from 'mobx-react';\r\nimport RC2 from 'react-chartjs-2'\r\nimport { VPage, Page, View, List, LMR, FA } from 'tonva-react';\r\nimport { CPredictHistory } from './CPredictHistory';\r\n\r\nexport class VPredictHistory extends VPage<CPredictHistory> {\r\n  async open(param?: any) {\r\n    this.openPage(this.page);\r\n  }\r\n\r\n  render(param: any): JSX.Element {\r\n    return <this.page />\r\n  }\r\n\r\n  private page = observer(() => {\r\n    return <Page header=\"预期收益比均值历史\">\r\n      <this.pageContent />\r\n    </Page>;\r\n  })\r\n\r\n  private pageContent = observer(() => {\r\n    return <>\r\n    <this.historyChart />\r\n    </>\r\n  });\r\n\r\n  protected historyChart = observer(() => {\r\n    let {items} = this.controller;\r\n    if (items === undefined) \r\n      return <></>;\r\n    let chartHistory = <></>;\r\n    let labelList:any[] = [];\r\n    let avg20List:number[] = [];\r\n    let avg50List:number[] = [];\r\n    let avg100List:number[] = [];\r\n    for (let item of items) {\r\n      let {day, avg20, avg50, avg100} = item;\r\n      labelList.push(day);\r\n      avg20List.push(avg20);\r\n      avg50List.push(avg50);\r\n      avg100List.push(avg100);\r\n    }\r\n    let chartdata1 = {\r\n      labels: labelList,\r\n      datasets: [\r\n        {\r\n          label: 'avg20',\r\n          data: avg20List,\r\n          borderColor:'blue',\r\n          backgroundColor:'skyBlue',\r\n          borderWidth: 1,\r\n          fill: false,\r\n          yAxisID: 'y-axis-1',\r\n        },\r\n        {\r\n          label: 'avg50',\r\n          data: avg50List,\r\n          borderColor:'red',\r\n          backgroundColor:'pink',\r\n          borderWidth: 1,\r\n          fill: false,\r\n          yAxisID: 'y-axis-1',\r\n        },\r\n        {\r\n          label: 'avg100',\r\n          data: avg100List,\r\n          borderColor:'DarkGreen',\r\n          backgroundColor:'green',\r\n          borderWidth: 1,\r\n          fill: false,\r\n          yAxisID: 'y-axis-1',\r\n        },\r\n      ]\r\n    };\r\n    let options = {\r\n      scales:{\r\n        yAxes: [{\r\n            type: 'linear',\r\n            display: true,\r\n            position: 'right',\r\n            id: 'y-axis-1',\r\n        }],       \r\n      }\r\n    }\r\n\r\n    chartHistory = <RC2 data={chartdata1} type='line' options={options}/>;\r\n    return <><LMR className=\"px-3 py-2 bg-white\" left={'历史走势'}></LMR>\r\n      <div className=\"px-3\" style={{width:'95%'}}>{chartHistory}</div>\r\n    </>;\r\n  });\r\n\r\n}","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport { observable, IObservableArray } from 'mobx';\r\nimport { CUqBase } from \"../uq-app\";\r\nimport { VPredictHistory } from './VPredictHistory'\r\n\r\nexport interface PredictHistoryParam {\r\n\tday?:number,\r\n\tpriceDay?:number,\r\n\tavg20?:number,\r\n\tavg50?:number,\r\n\tavg100?:number,\r\n\tavg?:number,\r\n}\r\n\r\ninterface PredictItem {\r\n\tday:number, \r\n\tavg20:number, \r\n\tavg50:number,\r\n\tavg100:number,\r\n\tavg?:number\r\n}\r\n\r\nexport class CPredictHistory extends CUqBase {\r\n\titems: IObservableArray<PredictItem> = observable.array<PredictItem>([], { deep: true });\r\n\tday: number;\r\n\tprotected lastItem: PredictItem;\r\n\r\n\tasync internalStart(param: any) {\r\n\t\tlet p = param as PredictHistoryParam;\r\n\t\tif (p !== undefined) {\r\n\t\tthis.day = p.day;\r\n\t\tif (p.priceDay !== undefined) {\r\n\t\t\tthis.lastItem = {day:p.priceDay, avg20:p.avg20, avg50:p.avg50, avg100:p.avg100};\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.lastItem = undefined;\r\n\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\tthis.day = undefined;\r\n\t\tthis.lastItem = undefined;\r\n\t\t}\r\n\t\tawait this.load();\r\n\t\tthis.openVPage(VPredictHistory as any);\r\n\t}\r\n\r\n\tasync load() {\r\n\t\t//let ret = await this.cApp.store.miApi.call('t_toppredictavg$query', [this.day]) as PredictItem[];\r\n\t\tlet ret:PredictItem[] = await this.cApp.miNet.t_toppredictavg$query(this.day);\r\n\t\tthis.items.clear();\r\n\t\tif (!Array.isArray(ret))\r\n\t\treturn;\r\n\t\tthis.items.push(...ret);\r\n\t\tif (this.lastItem !== undefined) {\r\n\t\tlet li = {...this.lastItem};\r\n\t\tthis.items.push(li);\r\n\t\t}\r\n\t}\r\n}","import {FetchError} from './fetchError';\r\nimport {HttpChannelUI} from './httpChannelUI';\r\nimport {nav} from 'tonva-react';\r\nimport { consts } from '../consts';\r\n\r\nexport async function httpGet(url:string, params?:any):Promise<any> {\r\n    let channel = new HttpChannel(url, undefined, undefined);\r\n    let ret = await channel.get('', params);\r\n    return ret;\r\n}\r\n\r\nexport async function httpPost(url:string, params?:any):Promise<any> {\r\n    let channel = new HttpChannel(url, undefined, undefined);\r\n    let ret = await channel.post('', params);\r\n    return ret;\r\n}\r\n\r\nexport class HttpChannel {\r\n    private hostUrl: string;\r\n    private apiToken: string;\r\n    private ui?: HttpChannelUI;\r\n    private timeout: number;\r\n\r\n    constructor(hostUrl: string, apiToken:string, ui?: HttpChannelUI) {\r\n        this.hostUrl = hostUrl;\r\n        this.apiToken = apiToken;\r\n        this.ui = ui;\r\n        this.timeout = consts.isDevelopment === true? 500000:20000;\r\n    }\r\n\r\n    private startWait = () => {\r\n        if (this.ui !== undefined) this.ui.startWait();\r\n    }\r\n\r\n    private endWait = (url?:string, reject?:(reason?:any)=>void) => {\r\n        if (this.ui !== undefined) this.ui.endWait();\r\n        if (reject !== undefined) reject('访问webapi超时 ' + url);\r\n    }\r\n\r\n    private showError = async (error:FetchError) => {\r\n        if (this.ui !== undefined) await this.ui.showError(error);\r\n    }\r\n\r\n    used() {\r\n        this.post('', {});\r\n    }\r\n\r\n    async get(url: string, params: any = undefined): Promise<any> {\r\n        if (params) {\r\n            let keys = Object.keys(params);\r\n            if (keys.length > 0) {\r\n                let c = '?';\r\n                for (let k of keys) {\r\n                    let v = params[k];\r\n                    if (v === undefined) continue;\r\n                    url += c + k + '=' + params[k];\r\n                    c = '&';\r\n                }\r\n            }\r\n        }\r\n        let options = this.buildOptions();\r\n        options.method = 'GET';\r\n        return await this.innerFetch(url, options);\r\n    }\r\n\r\n    async post(url: string, params: any): Promise<any> {\r\n        let options = this.buildOptions();\r\n        options.method = 'POST';\r\n        options.body = JSON.stringify(params);\r\n        return await this.innerFetch(url, options);\r\n    }\r\n\r\n    async put(url: string, params: any): Promise<any> {\r\n        let options = this.buildOptions();\r\n        options.method = 'PUT';\r\n        options.body = JSON.stringify(params);\r\n        return await this.innerFetch(url, options);\r\n    }\r\n\r\n    async delete(url: string, params: any): Promise<any> {\r\n        let options = this.buildOptions();\r\n        options.method = 'DELETE';\r\n        options.body = JSON.stringify(params);\r\n        return await this.innerFetch(url, options);\r\n    }\r\n    async fetch(url: string, options: any, resolve:(value?:any)=>any, reject:(reason?:any)=>void):Promise<void> {\r\n        let that = this;\r\n        this.startWait();\r\n        let path = url;\r\n        function buildError(err: string) {\r\n            return {\r\n                channel: that,\r\n                url: path,\r\n                options: options,\r\n                resolve: resolve,\r\n                reject: reject,\r\n                error: err,\r\n            }\r\n        }\r\n        try {\r\n            console.log('%s %s', options.method, path);\r\n            let timeOutHandler = setTimeout(() => that.endWait(url, reject), this.timeout);\r\n            let res = await fetch(encodeURI(path), options);\r\n            if (res.ok === false) {\r\n                clearTimeout(timeOutHandler);\r\n                that.endWait();\r\n                console.log('call error %s', res.statusText);\r\n                throw res.statusText;\r\n            }\r\n            let ct = res.headers.get('content-type');\r\n            if (ct && ct.indexOf('json')>=0) {\r\n                return res.json().then(async retJson => {\r\n                    clearTimeout(timeOutHandler);\r\n                    that.endWait();\r\n                    if (retJson.ok === true) {\r\n                        return resolve(retJson.res);\r\n                    }\r\n                    if (retJson.error === undefined) {\r\n                        await that.showError(buildError('not valid tonva json'));\r\n                    }\r\n                    else {\r\n                        await that.showError(buildError(retJson.error));\r\n                        reject(retJson.error);\r\n                    }\r\n                    //throw retJson.error;\r\n                }).catch(async error => {\r\n                    await that.showError(buildError(error.message));\r\n                });\r\n            }\r\n            else {\r\n                let text = await res.text();\r\n                clearTimeout(timeOutHandler);\r\n                that.endWait();\r\n                resolve(text);\r\n            }\r\n        }\r\n        catch(error) {\r\n            if (typeof error === 'string') {\r\n                if (error.toLowerCase().startsWith('unauthorized') === true) {\r\n                    nav.logout();\r\n                    return;\r\n                }\r\n            }\r\n            await this.showError(buildError(error.message));\r\n        };\r\n    }\r\n\r\n    private async innerFetch(url: string, options: any): Promise<any> {\r\n        let u = this.hostUrl + url;\r\n        return await new Promise<any>(async (resolve, reject) => {\r\n            await this.fetch(u, options, resolve, reject);\r\n        });\r\n    }\r\n\r\n    async callFetch(url:string, method:string, body:any):Promise<any> {\r\n        let options = this.buildOptions();\r\n        options.method = method;\r\n        options.body = body;\r\n        return await new Promise<any>(async (resolve, reject) => {\r\n            await this.fetch(url, options, resolve, reject);\r\n        });\r\n    }\r\n\r\n    private buildOptions(): any {\r\n        let {language, culture} = nav;\r\n        let headers = new Headers();\r\n        //headers.append('Access-Control-Allow-Origin', '*');\r\n        headers.append('Content-Type', 'application/json;charset=UTF-8');\r\n        let lang = language;\r\n        if (culture) lang += '-' + culture;\r\n        headers.append('Accept-Language', lang);\r\n        if (this.apiToken) { \r\n            headers.append('Authorization', this.apiToken); \r\n        }\r\n        let options = {\r\n            headers: headers,\r\n            // cache: 'no-cache',\r\n        };\r\n        return options;\r\n    }\r\n}\r\n","import {nav} from 'tonva-react';\r\n\r\nexport interface HttpChannelUI {\r\n    startWait():void;\r\n    endWait():void;\r\n    showError(error:any):Promise<void>;\r\n}\r\n\r\nexport class HttpChannelNavUI implements HttpChannelUI {\r\n    startWait() {\r\n        nav.startWait();\r\n    }\r\n    endWait() {\r\n        nav.endWait();\r\n    }\r\n    async showError(error:any):Promise<void> {\r\n        nav.endWait();\r\n        /*\r\n        if (error.name === 'SyntaxError') {\r\n            error = {\r\n                name: error.name,\r\n                message: error.message,\r\n            }\r\n        }*/\r\n        await nav.onError(error);\r\n    }\r\n}\r\n\r\n","//import {isDevelopment} from '../local';\r\nimport {HttpChannel} from './httpChannel';\r\n\r\nexport async function refetchApi(channel:HttpChannel, url:any, options:any, resolve:any, reject:any) {\r\n    await channel.fetch(url, options, resolve, reject);\r\n}\r\n\r\nexport abstract class ApiBase {\r\n    protected token: string;\r\n    protected path: string;\r\n    protected showWaiting: boolean;\r\n\r\n    constructor(path: string, showWaiting: boolean) {\r\n        this.path = path || '';\r\n        this.showWaiting = showWaiting;\r\n    }\r\n\r\n    protected abstract getHttpChannel(): Promise<HttpChannel>;\r\n\r\n    public async call(url:string, method:string, body:any):Promise<any> {\r\n        let channel = await this.getHttpChannel();\r\n        return await channel.callFetch(url, method, body);\r\n    }\r\n\r\n    public async get(path:string, params:any=undefined): Promise<any> {\r\n        let channel = await this.getHttpChannel();\r\n        return await channel.get(this.path + path, params);\r\n    }\r\n\r\n    public async post(path:string, params:any): Promise<any> {\r\n        let channel = await this.getHttpChannel();\r\n        return await channel.post(this.path + path, params);\r\n    }\r\n\r\n    public async put(path:string, params:any): Promise<any> {\r\n        let channel = await this.getHttpChannel();\r\n        return await channel.put(this.path + path, params);\r\n    }\r\n\r\n    public async delete(path:string, params:any): Promise<any> {\r\n        let channel = await this.getHttpChannel();\r\n        return await channel.delete(this.path + path, params);\r\n    }\r\n}\r\n","import _ from 'lodash';\r\nimport { HttpChannel } from './httpChannel';\r\nimport { HttpChannelNavUI } from './httpChannelUI';\r\nimport { ApiBase } from './apiBase';\r\n\r\nlet channelUIs: { [name: string]: HttpChannel } = {};\r\nlet channelNoUIs: { [name: string]: HttpChannel } = {};\r\n\r\nclass MiApiChannel extends ApiBase {\r\n\tprivate apiName: string;\r\n\turl: string;\r\n\r\n\tconstructor(url: string, basePath: string, apiName: string, uqToken: string, showWaiting?: boolean) {\r\n\t\tsuper(basePath, showWaiting);\r\n\t\tthis.showWaiting = showWaiting;\r\n\t\tthis.apiName = apiName;\r\n\t\tthis.token = uqToken;\r\n\t\tthis.url = url;\r\n\t}\r\n\r\n\tprotected async getHttpChannel(): Promise<HttpChannel> {\r\n\t\tlet channels: { [name: string]: HttpChannel };\r\n\t\tlet channelUI: HttpChannelNavUI;\r\n\t\tif (this.showWaiting === true || this.showWaiting === undefined) {\r\n\t\t\tchannels = channelUIs;\r\n\t\t\tchannelUI = new HttpChannelNavUI();\r\n\t\t}\r\n\t\telse {\r\n\t\t\tchannels = channelNoUIs;\r\n\t\t}\r\n\t\tlet channel = channels[this.apiName];\r\n\t\tif (channel !== undefined) return channel;\r\n\t\tchannel = new HttpChannel(this.url, this.token, channelUI);\r\n\t\treturn channels[this.apiName] = channel;\r\n\t}\r\n}\r\n\r\nexport class MiApi {\r\n\tprivate channel: MiApiChannel;\r\n\r\n\tconstructor(url: string, basePath: string, apiName: string, uqToken: string, showWaiting?: boolean) {\r\n\t\tthis.channel = new MiApiChannel(url, basePath, apiName, uqToken, showWaiting);\r\n\t}\r\n\r\n\tasync call(name: string, params: any[]): Promise<any> {\r\n\t\tlet pbody = { call: name, params: params };\r\n\t\treturn await this.channel.post('sql/call', pbody);\r\n\t}\r\n\r\n\tasync query(name: string, params: any[]): Promise<any> {\r\n\t\tlet pbody = { call: name, params: params };\r\n\t\treturn await this.channel.post('sql/call', pbody);\r\n\t}\r\n\r\n\tasync page(name: string, params: any[], pageStart: number, pageSize: number): Promise<any> {\r\n\t\tlet p: any[];\r\n\t\tswitch (typeof params) {\r\n\t\t\tcase 'undefined': p = []; break;\r\n\t\t\tdefault: p = _.clone(params); break;\r\n\t\t}\r\n\t\tp.push(pageStart);\r\n\t\tp.push(pageSize);\r\n\t\tlet pbody = { call: name, params: p };\r\n\t\treturn await this.channel.post('sql/call', pbody);\r\n\t}\r\n\r\n\tasync process(proc: any, params: any[]): Promise<any> {\r\n\t\tlet pbody = { proc: proc, params: params };\r\n\t\treturn await this.channel.post('sql/query', pbody);\r\n\t}\r\n}\r\n","import { consts } from \"consts\";\r\nimport { User } from \"tonva-react\";\r\nimport { MiApi } from \"./miApi\";\r\n\r\nexport class MiNet {\r\n\tprivate miApi: MiApi;\r\n\tprivate user: User;\r\n\r\n\tconstructor(user: User) {\r\n\t\tlet miHost = consts.miApiHost;\r\n\t\tif (document.baseURI.indexOf('localmiserver') > 0) {\r\n\t\t\tmiHost = consts.miApiHostDebug;\r\n\t\t}\r\n\t\tthis.user = user;\r\n\t\tthis.miApi = new MiApi(miHost, 'miscan/', 'miapi', user.token, false);\r\n\t}\r\n\r\n\tget userId():number {return this.user.id;}\r\n\r\n\tasync process(proc:any, params:any[]) {\r\n\t\treturn await this.miApi.process(proc, params);\r\n\t}\r\n\r\n\tasync q_marketpe(param:any):Promise<{day:number, pe:number, e:number}[]> {\r\n\t\tlet rets = await this.miApi.query('q_marketpe', param) as {day:number, pe:number, e:number}[];\r\n\t\treturn rets;\r\n\t}\r\n\r\n\tasync t_toppredictavg$query(day:any):Promise<any[]> {\r\n\t\tlet ret = await this.miApi.call('t_toppredictavg$query', [day]);\r\n\t\treturn ret;\r\n\t}\r\n\r\n\tasync q_stocks$page(p:any, pageStart:any, pageSize:any):Promise<any> {\r\n\t\tlet ret = await this.miApi.page('q_stocks$page', p, pageStart, pageSize);\r\n\t\treturn ret;\r\n\t}\r\n\r\n\tasync q_stockallinfo(id:any, day:any) {\r\n\t\treturn this.miApi.query('q_stockallinfo', [id, day]);\r\n\t}\r\n\r\n\tasync t_tagstock$query(tagId:any, id:any) {\r\n\t\treturn this.miApi.query('t_tagstock$query', [this.user.id, tagId, id]) //this.uqs.mi.TagStock.query({ user: nav.user.id, stock: id })\r\n\t}\r\n\r\n\tasync t_tag$all() {\r\n\t\treturn await this.miApi.query('t_tag$all', [this.user.id]);\r\n\t}\r\n\r\n\tasync t_tag$save(name:string) {\r\n\t\treturn await this.miApi.call('t_tag$save', [this.user.id, undefined, name]);\r\n\t}\r\n\r\n\tasync t_tagstock$add(tagId:any, baseId:any) {\r\n\t\treturn await this.miApi.call('t_tagstock$add', [this.user.id, tagId, baseId]); //.uqs.mi.TagStock.add(param);\r\n\t}\r\n\r\n\tasync t_tagstock$del(tagId:any, baseId:any) {\r\n\t\treturn await this.miApi.call('t_tagstock$del', [this.user.id, tagId, baseId]); // //await this.uqs.mi.TagStock.del(param);\r\n\t}\r\n\r\n\tasync t_stockwarning$all() {\r\n\t\treturn await this.miApi.call('t_stockwarning$all', [this.user.id]);//await this.uqs.mi.StockWarningAll.query(undefined);\r\n\t}\r\n\r\n\tasync t_stockwarning$add(id:any, type:any, price:any) {\r\n\t\treturn await this.miApi.call('t_stockwarning$add', [this.user.id, id, type, price]);\r\n\t}\r\n\r\n\tasync t_usersettings$save(v:string) {\r\n\t\treturn await this.miApi.call('t_usersettings$save', [this.user.id, 'config', v]);\r\n\t}\r\n\r\n\tasync t_usersettings$query() {\r\n\t\treturn await this.miApi.query('t_usersettings$query', [this.user.id, 'config']);\r\n\t}\r\n\r\n\t// async t_allaccounts() {\r\n\t// \treturn await this.miApi.query('t_allaccounts', [this.user.id]);\r\n\t// }\r\n\r\n\tasync q_getlasttradeday() {\r\n\t\treturn await this.miApi.call('q_getlasttradeday', []);\r\n\t}\r\n}\r\n","import React from \"react\";\r\nimport { observer } from \"mobx-react\";\r\nimport { DropdownAction, DropdownActions, FA, LMR, VPage } from \"tonva-react\";\r\nimport { CHome } from \"./CHome\";\r\n\r\nexport class VHome extends VPage<CHome> {\r\n\theader() { return '首页'; }\r\n\tcontent() {\r\n\t\treturn React.createElement(observer(() => {\r\n\t\t\tlet {cApp, cAccount, cGroup, showStocksAll, showStocksBlock} = this.controller;\r\n\t\t\tlet {stocksMyAll, stocksMyBlock, myAllCaption, myBlockCaption} = cApp.store;\r\n\t\t\treturn <div className=\"pb-3\">\r\n\t\t\t\t{cAccount.renderAccounts()}\r\n\t\t\t\t{cGroup.renderGroups()}\r\n\t\t\t\t{this.renderSpec(stocksMyAll?.length, myAllCaption, 'home', 'text-primary', showStocksAll)}\r\n\t\t\t\t{this.renderSpec(stocksMyBlock?.length, <>\r\n\t\t\t\t\t\t<span className=\"mr-3\">{myBlockCaption}</span>\r\n\t\t\t\t\t\t<small className=\"text-muted\">选股时不列出</small>\r\n\t\t\t\t\t</>,\r\n\t\t\t\t\t'ban', 'text-black', showStocksBlock)}\r\n\t\t\t</div>;\r\n\t\t}));\r\n\t}\r\n\r\n\tright() {\r\n\t\treturn React.createElement(observer(() => {\r\n\t\t\tlet {cCommon} = this.controller.cApp;\r\n\t\t\tlet actions: DropdownAction[] = [\r\n\t\t\t\t{\r\n\t\t\t\t\tcaption: '管理持仓账户',\r\n\t\t\t\t\taction: cCommon.manageAccounts,\r\n\t\t\t\t\ticon: 'money',\r\n\t\t\t\t},\r\n\t\t\t\tundefined,\r\n\t\t\t\t{\r\n\t\t\t\t\tcaption: '管理股票分组',\r\n\t\t\t\t\taction: cCommon.manageGroups,\r\n\t\t\t\t\ticon: 'object-group',\r\n\t\t\t\t},\r\n\t\t\t];\r\n\t\t\treturn <DropdownActions actions={actions} icon=\"bars\" className=\"mr-2 text-white bg-transparent border-0\" />;\r\n\t\t}));\r\n\t}\r\n\r\n\tprivate renderSpec(count:number, text:string|JSX.Element, icon:string, color:string, click:()=>void) {\r\n\t\tlet right = count > 0 && <small className=\"align-self-center mx-3 text-muted\">{count}</small>;\r\n\t\tlet cn = \"align-self-center ml-3 \" + color;\r\n\t\treturn <div className=\"mt-2 bg-white cursor-pointer\" onClick={click}>\r\n\t\t\t<LMR left={<FA name={icon} className={cn} size=\"lg\" fixWidth={true} />} right={right}>\r\n\t\t\t\t<div className=\"px-3 py-2\">{text}</div>\r\n\t\t\t</LMR>\r\n\t\t</div>\r\n\t}\r\n}\r\n","import { observer } from \"mobx-react\";\r\nimport React from \"react\";\r\nimport { DropdownAction, DropdownActions, FA, List, LMR, VPage } from \"tonva-react\";\r\nimport { formatNumber } from \"tool\";\r\nimport { HoldingStock } from \"../../store\";\r\nimport { CAccount } from \"./CAccount\";\r\n\r\nexport class VAccount extends VPage<CAccount> {\r\n\theader() {return this.controller.miAccount.name}\r\n\tcontent() {\r\n\t\treturn React.createElement(observer(() => {\r\n\t\t\tfunction renderValue(caption:string, value:number) {\r\n\t\t\t\treturn <div className=\"m-1 border rounded w-min-5c px-1 py-2\">\r\n\t\t\t\t\t<small className=\"text-muted\">{caption}</small>\r\n\t\t\t\t\t<div>{formatNumber(value??0)}</div>\r\n\t\t\t\t</div>;\r\n\t\t\t}\r\n\t\t\tlet renderCash = (value:number) => {\r\n\t\t\t\tlet caption = '现金';\r\n\t\t\t\tif (typeof value === 'number') return renderValue(caption, value);\r\n\t\t\t\treturn <div className=\"m-1 border rounded w-min-5c px-1 py-2\">\r\n\t\t\t\t\t<small className=\"text-muted\">{caption}</small>\r\n\t\t\t\t\t<div className=\"text-danger small\">无期初</div>\r\n\t\t\t\t</div>;\r\n\t\t\t}\r\n\t\t\tlet {miAccount, showBuy, showCashIn, showCashOut, showCashAdjust} = this.controller;\r\n\t\t\tlet {no, name, mi, market, cash, holdingStocks} = miAccount;\r\n\r\n\t\t\tlet holdings:HoldingStock[], holdings0:HoldingStock[];\r\n\t\t\tif (holdingStocks) {\r\n\t\t\t\tholdings = [];\r\n\t\t\t\tholdings0 = [];\r\n\t\t\t\tlet len = holdingStocks.length;\r\n\t\t\t\tfor (let i=0; i<len; i++) {\r\n\t\t\t\t\tlet holding = holdingStocks[i];\r\n\t\t\t\t\tif (holding.quantity === 0) holdings0.push(holding);\r\n\t\t\t\t\telse holdings.push(holding);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tlet actions: DropdownAction[] = [\r\n\t\t\t\t{ caption: '调入资金', action: showCashIn, icon: 'sign-in' },\r\n\t\t\t\t{ caption: '调出资金', action: showCashOut, icon: 'sign-out' },\r\n\t\t\t\t{ caption: '调整资金', action: showCashAdjust, icon: 'adjust' },\r\n\t\t\t];\r\n\t\t\treturn <div className=\"pb-3\">\r\n\t\t\t\t<div className=\"mb-3 px-3 py-2 bg-white\">\r\n\t\t\t\t\t<LMR right={<small className=\"text-muted\">组合编号: {no}</small>}>\r\n\t\t\t\t\t\t{name}\r\n\t\t\t\t\t</LMR>\r\n\t\t\t\t\t<div className=\"my-3 text-center d-flex justify-content-center flex-wrap\">\r\n\t\t\t\t\t\t{renderValue('米值', mi as number)}\r\n\t\t\t\t\t\t{renderValue('市值', market as number)}\r\n\t\t\t\t\t\t{renderCash(cash as number)}\r\n\t\t\t\t\t\t{typeof cash === 'number' && renderValue('总值', (market as number) + (cash as number))}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div className=\"mb-3 mx-3 d-flex\">\r\n\t\t\t\t\t<button className=\"btn btn-outline-primary mr-3\" onClick={() => showBuy()}>买股</button>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttypeof cash === 'number'?\r\n\t\t\t\t\t\t\t<DropdownActions className=\"btn btn-outline-warning\"\r\n\t\t\t\t\t\t\t\tcontainerClass=\"ml-auto\"\r\n\t\t\t\t\t\t\t\tactions={actions} icon=\"money\" content=\"资金\" />\r\n\t\t\t\t\t\t\t:\r\n\t\t\t\t\t\t\t<button className=\"btn btn-outline-info ml-auto\" onClick={this.controller.showCashInit}>\r\n\t\t\t\t\t\t\t\t<FA name=\"cog\" className=\"small text-info\" /> 设置期初资金\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t}\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div className=\"small text-muted px-3 py-1\">持仓明细</div>\r\n\t\t\t\t<List items={holdings}\r\n\t\t\t\t\titem={{render: this.renderHolding}} />\r\n\t\t\t\t{\r\n\t\t\t\t\tholdings0 && holdings0.length > 0 && <>\r\n\t\t\t\t\t\t<div className=\"small text-muted px-3 py-1 mt-3\">0持仓股票</div>\r\n\t\t\t\t\t\t<List items={holdings0}\r\n\t\t\t\t\t\t\titem={{render: this.renderHolding}} />\r\n\t\t\t\t\t</>\r\n\t\t\t\t}\r\n\t\t\t</div>;\r\n\t\t}));\r\n\t}\r\n\r\n\tprivate renderHolding = (holding: HoldingStock, index: number) => {\r\n\t\tlet {showHolding, showBuy, showSell} = this.controller;\r\n\t\tlet {stockObj, quantity, mi, market} = holding;\r\n\t\tlet {name, code} = stockObj;\r\n\t\treturn <div className=\"px-3 py-2\">\r\n\t\t\t<div className=\"d-flex cursor-pointer flex-grow-1\"\r\n\t\t\t\t onClick={() => showHolding(holding)}>\r\n\t\t\t\t<div className=\"mr-auto w-min-4c\">\r\n\t\t\t\t\t<div className=\"small text-muted\">{code}</div>\r\n\t\t\t\t\t<b>{name}</b> \r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"d-flex flex-sm-row flex-wrap justify-content-end\">\r\n\t\t\t\t\t{this.renderValue('股数', quantity)}\r\n\t\t\t\t\t{this.renderValue('米值', mi)}\r\n\t\t\t\t\t{this.renderValue('市值', market)}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<div className=\"flex-column flex-sm-row ml-3 ml-sm-5 d-flex w-min-3-5c\">\r\n\t\t\t\t<button className=\"btn btn-sm btn-outline-info mb-2 mb-sm-0\"\r\n\t\t\t\t\tonClick={() => showBuy(holding)}>加买</button>\r\n\t\t\t\t<button className=\"ml-0 ml-sm-2 btn btn-sm btn-outline-info\"\r\n\t\t\t\t\tonClick={() => showSell(holding)}>卖出</button>\r\n\t\t\t</div>\r\n\t\t</div>;\r\n\t}\r\n\r\n\tprivate renderValue(caption:string, value: number, dec: number = 0) {\r\n\t\treturn <div className=\"text-right ml-3 ml-sm-5 w-min-3c\">\r\n\t\t\t<div className=\"small text-muted\">{caption}</div>\r\n\t\t\t<div>{value?.toFixed(dec)}</div>\r\n\t\t</div>;\r\n\t}\r\n}\r\n","import { IntSchema, ButtonSchema, UiNumberItem, UiButton, Form, Schema, VPage, UiSchema, Context, NumSchema, IdSchema, UiIdItem } from \"tonva-react\";\r\nimport { formatNumber } from \"tool\";\r\nimport { Stock } from \"uq-app/uqs/BruceYuMi\";\r\nimport { CAccount } from \"./CAccount\";\r\n\r\nabstract class VForm extends VPage<CAccount> {\r\n\tprotected get back(): 'close' | 'back' | 'none' {return 'close'}\r\n\tprotected onCheckValue(value:any): string[] | string {\r\n\t\treturn;\r\n    }\r\n\r\n\tprotected get valueLabel(): string {return '股票数量'}\r\n\tprotected get placeholder(): string {return '股票数量'}\r\n\r\n\tprotected schema: Schema = [\r\n\t\t{ name: 'value', type: 'integer', min: 0, required: true } as IntSchema,\r\n\t\t{ name: 'submit', type: 'submit'} as ButtonSchema,\r\n\t];\r\n\r\n\tprotected uiSchema: UiSchema = {\r\n\t\titems: {\r\n\t\t\tvalue: {\r\n\t\t\t\twidget: 'number',\r\n\t\t\t\tmin: 0,\r\n\t\t\t\tstep: 1,\r\n\t\t\t\tlabel: this.valueLabel,\r\n\t\t\t\tplaceholder: this.placeholder,\r\n\t\t\t\trules: (value:any) => this.onCheckValue(value),\r\n\t\t\t} as UiNumberItem,\r\n\t\t\tsubmit: {\r\n\t\t\t\twidget: 'button', className: 'btn btn-primary w-25', label: '提交', disabled: true,\r\n\t\t\t} as UiButton,\r\n\t\t}\r\n\t}\r\n\r\n\tprotected renderStock(): JSX.Element {\r\n\t\tlet {holdingStock} = this.controller;\r\n\t\tif (!holdingStock) return null;\r\n\t\tlet {stockObj, quantity} = holdingStock;\r\n\t\tlet {name, code, miValue, price} = stockObj;\r\n\t\treturn <div className=\"py-2\">\r\n\t\t\t<div className=\"mr-auto px-3 mb-2\">\r\n\t\t\t\t<b>{name}</b> <span className=\"ml-2 small text-muted\">{code}</span>\r\n\t\t\t</div>\r\n\t\t\t<div className=\"d-flex my-2 py-2 border-top border-bottom justify-content-center text-center bg-white\">\r\n\t\t\t\t{this.renderValue('股数', quantity)}\r\n\t\t\t\t{this.renderValue('米值', quantity * miValue, 2)}\r\n\t\t\t\t{this.renderValue('市值', quantity * (price as number), 2)}\r\n\t\t\t</div>\r\n\t\t</div>;\r\n\t}\r\n\r\n\tprivate renderValue(caption:string, value: number, dec: number = 0) {\r\n\t\treturn <div className=\"mx-1 border rounded w-min-5c px-1 py-2\">\r\n\t\t\t<small className=\"text-muted\">{caption}</small>\r\n\t\t\t<div>{formatNumber(value??0)}</div>\r\n\t\t</div>;\r\n\t}\r\n\r\n\tprotected beforeRender() {}\r\n\r\n\tprotected renderForm(): JSX.Element {\r\n\t\tthis.beforeRender();\r\n\t\treturn <Form className=\"mx-3\"\r\n\t\t\tonButtonClick={this.onFormSubmit}\r\n\t\t\tonEnter={this.onFormSubmit}\r\n\t\t\tfieldLabelSize={3}\r\n\t\t\tfieldLabelAlign='right'\r\n\t\t\tschema={this.schema}\r\n\t\t\tuiSchema={this.uiSchema} />;\r\n\t}\r\n\r\n\tprivate onFormSubmit = async (name:string, context: Context):Promise<void> => {\r\n\t\tawait this.onSubmit(context.data);\r\n\t\tthis.closePage();\r\n\t}\r\n\r\n\tprotected abstract onSubmit(data:any): Promise<void>;\r\n\r\n\tcontent() {\r\n\t\treturn <div className=\"my-3\">\r\n\t\t\t{this.renderStock()}\r\n\t\t\t{this.renderForm()}\r\n\t\t</div>;\r\n\t}\r\n}\r\n\r\nabstract class VStock extends VForm {\r\n\tprotected beforeRender() {\r\n\t\tsuper.beforeRender();\r\n\t\tthis.schema.unshift(\r\n\t\t\t{ name: 'price', type: 'number', min: 0, required: true } as NumSchema,\r\n\t\t);\r\n\t\tthis.uiSchema.items['price'] = {\r\n\t\t\twidget: 'number',\r\n\t\t\tmin: 0,\r\n\t\t\tstep: 1,\r\n\t\t\tlabel: '价格',\r\n\t\t\tplaceholder: '股票价格',\r\n\t\t\tdefaultValue: this.controller.holdingStock?.stockObj.price\r\n\t\t\t//rules: (value:any) => this.onCheckValue(value),\r\n\t\t} as UiNumberItem;\r\n\t}\r\n}\r\n\r\nabstract class VBuy extends VStock {\r\n\tprotected beforeRender() {\r\n\t\tsuper.beforeRender();\r\n\t\tthis.uiSchema.rules = [this.checkCash];\r\n\t}\r\n\tprotected checkCash = (context:Context): string[] | string => {\r\n\t\tlet {holdingStock, miAccount} = this.controller;\r\n\t\tlet {cash} = miAccount;\r\n\t\tif (typeof cash !== 'number') return;\r\n\t\tlet {stockObj} = holdingStock;\r\n\t\tlet quantity = context.data.quantity;\r\n\t\tlet {price} = stockObj;\r\n\t\tif ((quantity as number) * (price as number) > (cash as number))\r\n\t\t\treturn `超过账户资金余额，无法买入`;\r\n    }\r\n}\r\n\r\nexport class VBuyNew extends VBuy {\r\n\theader() {return '新买股票'}\r\n\tprotected beforeRender() {\r\n\t\tsuper.beforeRender();\r\n\t\tthis.schema.unshift(\r\n\t\t\t{ name: 'stock', type: 'id', required: true } as IdSchema,\r\n\t\t);\r\n\t\tthis.uiSchema.items['stock'] = {\r\n\t\t\twidget: 'id',\r\n\t\t\tlabel: '股票',\r\n\t\t\tpickId: this.controller.createPickStockId(),\r\n\t\t\tplaceholder: '请选择股票',\r\n\t\t\tTemplet: this.renderStockPick,\r\n\t\t} as UiIdItem;\r\n\t}\r\n\r\n\tprivate renderStockPick = (values: Stock):JSX.Element => {\r\n\t\tlet {name, code} = values;\r\n\t\treturn <>{name} <small className=\"text-muted\">{code}</small></>;\r\n\t}\r\n\r\n\tprotected async onSubmit(data:any): Promise<void> {\r\n\t\tlet {stock, price, value} = data;\r\n\t\tawait this.controller.submitBuyNew(stock.id, price, value);\r\n\t}\r\n}\r\n\r\nexport class VBuyExist extends VBuy {\r\n\theader() {return '加买股票'}\r\n\tprotected get placeholder(): string {return '加买数量'}\r\n\r\n\tprotected async onSubmit(data:any): Promise<void> {\r\n\t\tlet {price, value} = data;\r\n\t\tawait this.controller.submitBuy(price, value);\r\n\t}\r\n}\r\n\r\nexport class VSell extends VStock {\r\n\theader() {return '卖出股票'}\r\n\tprotected get placeholder(): string {return '卖出数量'}\r\n\tprotected onCheckValue(value:any): string[] | string {\r\n\t\tlet {holdingStock} = this.controller;\r\n\t\tlet {quantity} = holdingStock;\r\n\t\tif (value > quantity)\r\n\t\t\treturn `现有持股${quantity}，卖出数量超出`;\r\n    }\r\n\r\n\tprotected async onSubmit(data:any): Promise<void> {\r\n\t\tlet {price, value} = data;\r\n\t\tawait this.controller.submitSell(price, value);\r\n\t}\r\n}\r\n\r\nabstract class VCash extends VForm {\r\n\tprotected get valueLabel(): string {return '资金数量'}\r\n\tprotected renderStock(): JSX.Element {return null}\r\n}\r\n\r\nexport class VCashInit extends VCash {\r\n\theader() {return '期初资金'}\r\n\tprotected get placeholder(): string {return '期初金额'}\r\n\tprotected async onSubmit(data:any): Promise<void> {\r\n\t\tlet {value} = data;\r\n\t\tawait this.controller.submitCashInit(value);\r\n\t}\r\n}\r\n\r\nexport class VCashIn extends VCash {\r\n\theader() {return '调入资金'}\r\n\tprotected get placeholder(): string {return '调入金额'}\r\n\tprotected async onSubmit(data:any): Promise<void> {\r\n\t\tlet {value} = data;\r\n\t\tawait this.controller.submitCashIn(value);\r\n\t}\r\n}\r\n\r\nexport class VCashOut extends VCash {\r\n\theader() {return '调出资金'}\r\n\tprotected get placeholder(): string {return '调出金额'}\r\n\tprotected onCheckValue(value:any): string[] | string {\r\n\t\tlet {cash} = this.controller.miAccount; \r\n\t\tif (value > cash)\r\n\t\t\treturn `调出金额不能超过总现金${cash}`;\r\n    }\r\n\tprotected async onSubmit(data:any): Promise<void> {\r\n\t\tlet {value} = data;\r\n\t\tawait this.controller.submitCashOut(value);\r\n\t}\r\n}\r\n\r\nexport class VCashAdjust extends VCash {\r\n\theader() {return '调整资金'}\r\n\tprotected beforeRender() {\r\n\t\t(this.schema[0] as IntSchema).min = undefined;\r\n\t}\r\n\tprotected get placeholder(): string {return '调整金额'}\r\n\tprotected onCheckValue(value:any): string[] | string {\r\n\t\tlet {cash} = this.controller.miAccount; \r\n\t\tif (value < 0 && -value > cash)\r\n\t\t\treturn `负向调整金额不能超过总现金${cash}`;\r\n    }\r\n\tprotected async onSubmit(data:any): Promise<void> {\r\n\t\tlet {value} = data;\r\n\t\tawait this.controller.submitCashAdjust(value);\r\n\t}\r\n}\r\n","import { observer } from \"mobx-react\";\r\nimport React from \"react\";\r\nimport { MiAccount } from \"store\";\r\nimport { FA, List, LMR, View } from \"tonva-react\";\r\nimport { formatNumber } from \"tool\";\r\nimport { Account, AccountValue } from \"uq-app/uqs/BruceYuMi\";\r\nimport { CAccount } from \"./CAccount\";\r\n\r\nexport class VAccounts extends View<CAccount> {\r\n\trender():JSX.Element {\r\n\t\treturn React.createElement(observer(() => {\r\n\t\t\tlet {cApp} = this.controller;\r\n\t\t\tlet {miAccounts} = cApp.store;\r\n\t\t\tlet listHeader = (caption:string) => <div className=\"small text-muted pt-2 pb-1 px-3\">{caption}</div>;\r\n\t\t\treturn <>\r\n\t\t\t\t{listHeader('持仓')}\r\n\t\t\t\t<List items={miAccounts.accounts} item={{render: this.renderAccount, onClick: this.onClickAccount}} />\r\n\t\t\t</>;\r\n\t\t}));\r\n\t}\r\n\r\n\tprivate onClickAccount = (item: MiAccount) => {\r\n\t\tthis.controller.showAccount(item);\r\n\t}\r\n\r\n\tprivate renderAccount = (item:Account&AccountValue, index:number):JSX.Element => {\r\n\t\tfunction renderValue(caption:string, value:number) {\r\n\t\t\treturn <span className=\"mr-3\">\r\n\t\t\t\t<small className=\"text-muted\">{caption}: </small>\r\n\t\t\t\t{formatNumber(value??0)}\r\n\t\t\t</span>;\r\n\t\t}\r\n\t\tlet {name, mi, market, count} = item;\r\n\t\tlet left = <FA name=\"money\" className=\"text-warning align-self-start mt-3 ml-3\" size=\"lg\" fixWidth={true} />;\r\n\t\tlet right = <div className=\"px-2 d-flex align-items-center\">\r\n\t\t\t<FA className=\"align-\" name=\"angle-right\" />\r\n\t\t</div>;\r\n\t\treturn <LMR left={left} right={right}>\r\n\t\t\t<div className=\"px-3 py-2 bg-white d-block\">\r\n\t\t\t{\r\n\t\t\t\tcount > 0?\r\n\t\t\t\t\t<>\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t{name}\r\n\t\t\t\t\t\t\t<small className=\"ml-3 text-danger\">{count}</small>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className=\"mt-2\">\r\n\t\t\t\t\t\t\t{renderValue('总米值', mi as number)}\r\n\t\t\t\t\t\t\t{renderValue('总市值', market as number)}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</>\r\n\t\t\t\t\t:\r\n\t\t\t\t\t<>\r\n\t\t\t\t\t\t<div className=\"pb-2\">\r\n\t\t\t\t\t\t\t{name}\r\n\t\t\t\t\t\t\t<small className=\"ml-3 text-muted mb-2\">空仓</small>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</>\r\n\t\t\t}\r\n\t\t\t</div>\r\n\t\t</LMR>;\r\n\t}\r\n}\r\n","import { IObservableArray, makeObservable, observable } from \"mobx\";\r\nimport { createPickId } from \"tonva-uqui\";\r\nimport { MiAccount, MiGroup, HoldingStock } from \"../../store\";\r\nimport { Stock, StockValue } from \"uq-app/uqs/BruceYuMi\";\r\nimport { CApp, CUqBase } from \"../../uq-app\";\r\nimport { VAccount } from \"./VAccount\";\r\nimport { VBuyExist, VBuyNew, VCashAdjust, VCashInit, VCashIn, VCashOut, VSell } from \"./VForm\";\r\nimport { CHome } from \"../CHome\";\r\nimport { VAccounts } from \"./VAccounts\";\r\nimport { PickId, Context } from \"tonva-react\";\r\n\r\nexport class CAccount extends CUqBase {\r\n\tprivate cHome: CHome;\r\n\tmiGroup: MiGroup = null;\r\n\tstocks: IObservableArray<Stock & StockValue>;\r\n\tstock: Stock & StockValue;\r\n\tmiAccount: MiAccount = null;\r\n\tholdingStock: HoldingStock;\r\n\tlistCaption: string;\r\n\r\n\tconstructor(cApp: CApp, cHome: CHome) {\r\n\t\tsuper(cApp);\r\n\t\tmakeObservable(this, {\r\n\t\t\tmiGroup: observable,\r\n\t\t\tmiAccount: observable,\r\n\t\t\tstocks: observable,\r\n\t\t});\r\n\t\tthis.cHome = cHome;\r\n\t}\r\n\r\n\tasync internalStart(param: any) {\r\n\t}\r\n\r\n\trenderAccounts() {\r\n\t\treturn this.renderView(VAccounts);\r\n\t}\r\n\r\n\tshowAccount = async (item: MiAccount) => {\r\n\t\tthis.miAccount = item;\r\n\t\tthis.openVPage(VAccount);\r\n\t\tawait item.loadItems();\r\n\t};\r\n\t\r\n\tshowHolding = async (item: HoldingStock) => {\r\n\t\tlet stock = item.stockObj;\r\n\t\tthis.cApp.cCommon.showStock(stock);\r\n\t}\r\n\r\n\tcreatePickStockId() {\r\n\t\tlet yumi = this.uqs.BruceYuMi;\r\n\t\tlet pagePickId = createPickId(yumi, yumi.Stock);\r\n\t\tlet ret:PickId = async (context:Context, name: string, value: number) => {\r\n\t\t\tlet v = await pagePickId(context, name, value);\r\n\t\t\tlet stock = await this.cApp.store.loadStock(v.id);\r\n\t\t\tthis.stock = stock;\r\n\t\t\tcontext.setValue('price', String(stock.price));\r\n\t\t\treturn stock;\r\n\t\t}\r\n\t\treturn ret;\r\n\t}\r\n\r\n\tshowBuy = async (item?: HoldingStock) => {\r\n\t\tif (item) {\r\n\t\t\tthis.holdingStock = item;\r\n\t\t\tthis.openVPage(VBuyExist);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.holdingStock = undefined;\r\n\t\t\tthis.openVPage(VBuyNew);\r\n\t\t}\r\n\t}\r\n\r\n\tsubmitBuyNew = async (stockId: number, price:number, quantity:number) => {\r\n\t\tawait this.miAccount.buyNewHolding(stockId, price, quantity);\r\n\t}\r\n\r\n\tsubmitBuy = async (price:number, quantity:number) => {\r\n\t\tawait this.miAccount.buyHolding(this.holdingStock.stock, price, quantity);\r\n\t}\r\n\r\n\tshowSell = async (item: HoldingStock) => {\r\n\t\tthis.holdingStock = item;\r\n\t\tthis.openVPage(VSell);\r\n\t}\r\n\r\n\tsubmitSell = async (price:number, quantity:number) => {\r\n\t\tawait this.miAccount.sellHolding(this.holdingStock.stock, price, quantity);\r\n\t}\r\n\t\r\n\tshowCashInit = async () => {\r\n\t\tthis.openVPage(VCashInit);\r\n\t}\r\n\r\n\tsubmitCashInit = async (value:number) => {\r\n\t\tawait this.miAccount.cashInit(value);\r\n\t}\r\n\r\n\tshowCashIn = async () => {\r\n\t\tthis.openVPage(VCashIn);\r\n\t}\r\n\r\n\tsubmitCashIn = async (value:number) => {\r\n\t\tawait this.miAccount.cashIn(value);\r\n\t}\r\n\t\r\n\tshowCashOut = async () => {\r\n\t\tthis.openVPage(VCashOut);\r\n\t}\r\n\r\n\tsubmitCashOut = async (value:number) => {\t\t\r\n\t\tawait this.miAccount.cashOut(value);\r\n\t}\r\n\t\r\n\tshowCashAdjust = async () => {\r\n\t\tthis.openVPage(VCashAdjust);\r\n\t}\r\n\r\n\tsubmitCashAdjust = async (value:number) => {\r\n\t\tawait this.miAccount.cashAdjust(value);\r\n\t}\r\n}\r\n","import React from \"react\";\r\nimport { observer } from \"mobx-react\";\r\nimport { FA, List, LMR, View } from \"tonva-react\";\r\nimport { CGroup } from \"./CGroup\";\r\nimport { MiGroup } from \"store/miGroup\";\r\n\r\nexport class VGroups extends View<CGroup> {\r\n\trender():JSX.Element {\r\n\t\treturn React.createElement(observer(() => {\r\n\t\t\tlet {cApp} = this.controller;\r\n\t\t\tlet {miGroups} = cApp.store;\r\n\t\t\tlet {groups } = miGroups;\r\n\t\t\tlet listHeader = (caption:string) => <div className=\"small text-muted pt-2 pb-1 px-3\">{caption}</div>;\r\n\t\t\treturn <>\r\n\t\t\t\t{listHeader('分组')}\r\n\t\t\t\t<List items={groups} item={{render: this.renderGroup, onClick:this.controller.showMiGroup}} className=\"mb-3\" />\r\n\t\t\t</>;\r\n\t\t}));\r\n\t}\r\n\r\n\tprivate renderGroup = (group:MiGroup, index: number):JSX.Element => {\r\n\t\tlet {name, count} = group;\r\n\t\tlet left = <FA name=\"list-alt\" className=\"text-info align-self-center ml-3\" size=\"lg\" fixWidth={true} />;\r\n\t\tlet right = count > 0 && <small className=\"align-self-center mx-3 text-muted\">{count}</small>;\r\n\t\treturn <LMR left={left} right={right}>\r\n\t\t\t<div className=\"px-3 py-2\">{name}</div>\r\n\t\t</LMR>;\r\n\t}\r\n}\r\n","import { IObservableArray, makeObservable, observable } from \"mobx\";\r\nimport { MiAccount, MiGroup, HoldingStock } from \"../../store\";\r\nimport { Stock, StockValue } from \"uq-app/uqs/BruceYuMi\";\r\nimport { CApp, CUqBase } from \"../../uq-app\";\r\nimport { VGroups } from \"./VGroups\";\r\nimport { CHome } from \"home/CHome\";\r\n\r\nexport class CGroup extends CUqBase {\r\n\tprivate readonly cHome: CHome;\r\n\tmiGroup: MiGroup = null;\r\n\tstocks: IObservableArray<Stock & StockValue>;\r\n\tmiAccount: MiAccount = null;\r\n\tholdingStock: HoldingStock;\r\n\tlistCaption: string;\r\n\r\n\tconstructor(cApp: CApp, cHome: CHome) {\r\n\t\tsuper(cApp);\r\n\t\tmakeObservable(this, {\r\n\t\t\tmiGroup: observable,\r\n\t\t\tmiAccount: observable,\r\n\t\t\tstocks: observable,\r\n\t\t});\r\n\t\tthis.cHome = cHome;\r\n\t}\r\n\r\n\tasync internalStart(param: any) {\r\n\t}\r\n\r\n\trenderGroups() {return this.renderView(VGroups);}\r\n\r\n\tshowMiGroup = async (miGroup: MiGroup) => {\r\n\t\tthis.cHome.openStocksList(miGroup.name);\r\n\t\tawait miGroup.loadItems();\r\n\t\tthis.cHome.setStocksList(miGroup.stocks);\r\n\t}\r\n\r\n\tonStockClick = async (stock: Stock) => {\r\n\t\tthis.cApp.cCommon.showStock(stock);\r\n\t}\r\n}\r\n","import React from \"react\";\r\nimport { observer } from \"mobx-react\";\r\nimport { DropdownAction, DropdownActions, List, VPage } from \"tonva-react\";\r\nimport { Stock, StockValue } from \"uq-app/uqs/BruceYuMi\";\r\nimport { renderStockRow } from \"tool\";\r\nimport { CHome } from \"./CHome\";\r\n\r\nexport class VStockList extends VPage<CHome> {\r\n\theader() {\r\n\t\treturn this.controller.listCaption;\r\n\t}\r\n\tcontent() {\r\n\t\treturn React.createElement(observer(() => {\r\n\t\t\tlet {stocks, onStockClick} = this.controller;\r\n\t\t\treturn <div>\r\n\t\t\t\t<List items={stocks} item={{onClick: onStockClick, render: this.renderStock}} />\r\n\t\t\t</div>;\r\n\t\t}));\r\n\t}\r\n\r\n\tprivate onClickName = (stock:Stock) => {\r\n\r\n\t}\r\n\r\n\tprivate renderStock = (stock:Stock & StockValue, index:number) => {\r\n\t\tlet inputSelect = <>select</>;\r\n\t\tlet right = <>right</>;\r\n\t\tlet {$order} = stock as unknown as any;\r\n\t\treturn renderStockRow($order, stock as Stock & StockValue, this.onClickName, inputSelect, right);\r\n\t}\r\n\r\n\tright() {\r\n\t\treturn React.createElement(observer(() => {\r\n\t\t\tlet actions: DropdownAction[] = [\r\n\t\t\t\t{\r\n\t\t\t\t\tcaption: '管理自选组',\r\n\t\t\t\t\taction: this.controller.cApp.cCommon.manageGroups,\r\n\t\t\t\t\ticon: 'object-group',\r\n\t\t\t\t},\r\n\t\t\t];\r\n\t\t\treturn <DropdownActions actions={actions} icon=\"bars\" className=\"mr-2 text-white bg-transparent border-0\" />;\r\n\t\t}));\r\n\t}\r\n}","import { IObservableArray, makeObservable, observable, runInAction } from \"mobx\";\r\nimport { CApp, CUqBase } from \"uq-app\";\r\nimport { Stock, StockValue } from \"uq-app/uqs/BruceYuMi\";\r\nimport { VHome } from \"./VHome\";\r\nimport { CAccount } from \"./account\";\r\nimport { CGroup } from \"./group\";\r\nimport { VStockList } from \"./VStockList\";\r\n\r\nexport class CHome extends CUqBase {\r\n\treadonly cAccount: CAccount;\r\n\treadonly cGroup: CGroup;\r\n\tstocks: IObservableArray<Stock & StockValue> = null;\r\n\tlistCaption: string = null;\r\n\r\n\tconstructor(cApp: CApp) {\r\n\t\tsuper(cApp);\r\n\t\tmakeObservable(this, {\r\n\t\t\tstocks: observable.ref,\r\n\t\t\tlistCaption: observable,\r\n\t\t});\r\n\t\tthis.cAccount = new CAccount(this.cApp, this);\r\n\t\tthis.cGroup = new CGroup(this.cApp, this);\r\n\t}\r\n\r\n\tprotected async internalStart(param: any) {\r\n\t\tthis.openVPage(VHome);\r\n\t}\r\n\r\n\ttab = () => {\r\n\t\treturn this.renderView(VHome);\r\n\t}\r\n\r\n\topenStocksList(caption: string) {\r\n\t\trunInAction(() => {\r\n\t\t\tthis.listCaption = caption;\r\n\t\t\tthis.stocks = undefined;\r\n\t\t\tthis.openVPage(VStockList);\t\r\n\t\t});\r\n\t}\r\n\r\n\tsetStocksList(stocks: IObservableArray<Stock&StockValue>) {\r\n\t\trunInAction(() => {\r\n\t\t\tthis.stocks = stocks.sort((a, b) => {\r\n\t\t\t\tlet am = a.miRate;\r\n\t\t\t\tlet bm = b.miRate;\r\n\t\t\t\tif (am < bm) return 1;\r\n\t\t\t\tif (am > bm) return -1;\r\n\t\t\t\treturn 0;\r\n\t\t\t});\r\n\t\t\tlet len = this.stocks.length;\r\n\t\t\tfor (let i=0; i<len; i++) (this.stocks[i] as any).$order = i+1;\r\n\t\t})\r\n\t}\r\n\r\n\tshowStocksAll = async () => {\r\n\t\tlet {store} = this.cApp;\r\n\t\tthis.openStocksList(store.myAllCaption);\r\n\t\tthis.setStocksList(store.stocksMyAll);\r\n\t}\r\n\r\n\tshowStocksBlock = async () => {\r\n\t\tlet {store} = this.cApp;\r\n\t\tthis.openStocksList(store.myBlockCaption);\r\n\t\tawait this.cApp.store.loadMyBlock();\r\n\t\tthis.setStocksList(store.stocksMyBlock);\r\n\t}\r\n\r\n\tonStockClick = async (stock: Stock) => {\r\n\t\tthis.cApp.cCommon.showStock(stock);\r\n\t}\r\n}\r\n","import { Store } from \"store\";\r\nimport { PageItems } from \"tonva-react\";\r\nimport { Stock, StockValue } from \"uq-app/uqs/BruceYuMi\";\r\n\r\nexport class StockPageItems extends PageItems<Stock & StockValue> {\r\n\tprivate store: Store;\r\n\r\n\tconstructor(store: Store) {\r\n\t\tsuper(false);\r\n\t\tthis.store = store;\r\n\t\tthis.firstSize = 50;\r\n\t\tthis.pageSize = 20;\r\n\t}\r\n\t\r\n\tprotected getPageId(item:Stock):any {\r\n\t\treturn (item as unknown as any)?.$order;\r\n\t}\r\n\r\n\tprotected async loadResults (param:any, pageStart:any, pageSize:number):Promise<{[name:string]:any[]}> {\r\n\t\tlet ret = await this.store.searchStock(param, pageStart, pageSize);\r\n\t\treturn ret as any;\r\n\t}\r\n}\r\n","import { FA, SearchBox, VPage } from \"tonva-react\";\r\nimport { CFind } from \"./CFind\";\r\n\r\nexport class VFind extends VPage<CFind> {\r\n\theader() {return '发现'}\r\n\tright() {\r\n\t\treturn <div className=\"text-white p-2 cursor-pointer\" onClick={this.controller.showSetting}>\r\n\t\t\t<FA name=\"cog\" />\r\n\t\t</div>\r\n\t}\r\n\tcontent() {\r\n\t\tlet {showA, showHK, showSH, showSZ, showAll} = this.controller;\r\n\t\tlet renderButton = (caption:string, onClick:()=>void) => <button className=\"btn btn-outline-info mr-3 mb-3\" onClick={onClick}>{caption}</button>;\r\n\t\treturn <div className=\"p-3\">\r\n\t\t\t<SearchBox className=\"mb-3\" onSearch={this.controller.onSearch} placeholder=\"股票代码，名称\" />\r\n\t\t\t<div className=\"d-flex flex-wrap\">\r\n\t\t\t\t{renderButton('A股', showA)}\r\n\t\t\t\t{renderButton('港股', showHK)}\r\n\t\t\t\t{renderButton('沪A', showSH)}\r\n\t\t\t\t{renderButton('深A', showSZ)}\r\n\t\t\t\t{renderButton('全部', showAll)}\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t}\r\n}\r\n","import { VPage } from \"tonva-react\";\r\nimport { CFind } from \"./CFind\";\r\n\r\nexport class VSetting extends VPage<CFind> {\r\n\theader() {\r\n\t\treturn '选项设置';\r\n\t}\r\n\tcontent() {\r\n\t\tlet v = 10-this.controller.smooth;\r\n\t\treturn <div className=\"p-3\">\r\n\t\t\t<div className=\"mb-3 row\">\r\n\t\t\t\t<label className=\"col-sm-3 col-form-label\" htmlFor=\"find-setting-range\">业绩稳定</label>\r\n    \t\t\t<div className=\"col-sm-9\">\r\n\t\t\t\t\t<div className=\"d-flex align-items-center\">\r\n\t\t\t\t\t\t<span className=\"small mr-3\">稳定</span>\r\n\t\t\t\t\t\t<input className=\"form-range w-100 my-3\" type=\"range\" \r\n\t\t\t\t\t\t\tmin=\"0\" max=\"10\" step=\"1\" \r\n\t\t\t\t\t\t\tname=\"find-setting-range\"\r\n\t\t\t\t\t\t\tid=\"find-setting-range\" \r\n\t\t\t\t\t\t\tdefaultValue={v}\r\n\t\t\t\t\t\t\tonChange={this.onChange} />\r\n\t\t\t\t\t\t<span className=\"small ml-3\">全部</span>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"text-center mb-2\">\r\n\t\t\t\t\t\t<output id=\"find-setting-range-value\" htmlFor=\"find-setting-range\">{v}</output>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"text-muted\">波动值0，屏蔽大多数。波动值10，则不屏蔽</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t    </div>\r\n\t}\r\n\r\n\tprivate onChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n\t\tlet {value} = e.currentTarget\r\n\t\tthis.controller.changeSmooth(10-Number(value));\r\n\t\tlet output: HTMLOutputElement = document.getElementById('find-setting-range-value') as HTMLOutputElement;\r\n\t\toutput.value = value;\r\n\t}\r\n}","import { observer } from \"mobx-react\";\r\nimport React from \"react\";\r\nimport { List, Scroller, VPage } from \"tonva-react\";\r\nimport { renderStockRow } from \"tool\";\r\nimport { Stock, StockValue } from \"uq-app/uqs/BruceYuMi\";\r\nimport { CFind } from \"./CFind\";\r\n\r\nexport class VStocksPage extends VPage<CFind> {\r\n\theader() {return React.createElement(observer(() => <span className=\"\">{this.controller.header}</span>))}\r\n\tcontent() {\r\n\t\tlet { pageStocks, onClickStock } = this.controller;\r\n\t\treturn <List items={pageStocks} item={{render: this.renderStock, onClick: onClickStock}} />\r\n\t}\r\n\tprivate renderStock = (stock: Stock & StockValue): JSX.Element => {\r\n\t/*\r\n\t\tlet isSelected = this.controller.isMySelect(stock);\r\n\t\tlet setStock = isSelected === true? \r\n\t\t\t<DropdownActions actions={[\r\n\t\t\t\t{\r\n\t\t\t\t\tcaption: '修改分组',\r\n\t\t\t\t\taction: () => this.controller.setStockToGroup(stock),\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tcaption: '删除自选',\r\n\t\t\t\t\taction: () => this.controller.removeMySelect(stock),\r\n\t\t\t\t},\r\n\t\t\t\tundefined,\r\n\t\t\t\t{\r\n\t\t\t\t\tcaption: '取消操作',\r\n\t\t\t\t\taction: () => {},\r\n\t\t\t\t}\r\n\t\t\t]} icon=\"cog\" content=\"设自选\" className=\"cursor-pointer dropdown-toggle btn btn-sm btn-outline-info\" />\r\n\t\t\t:\r\n\t\t\t<button className=\"btn btn-sm btn-outline-primary\" \r\n\t\t\t\tonClick={() => this.controller.selectStock(stock)}>\r\n\t\t\t\t<FA name=\"plus-square-o\" className=\"small\" /> 加自选\r\n\t\t\t</button>;\r\n\t\t*/\r\n\t\tlet pinStock = this.controller.cApp.cCommon.renderPinStock(stock);\r\n\t\tlet {$order} = stock as any;\r\n\t\treturn renderStockRow($order, stock, this.onClickName, undefined, pinStock);\r\n\t}\r\n\r\n\tprivate onClickName = (stock: Stock & StockValue) => {\r\n\t\tthis.controller.cApp.openStock(stock);\r\n\t}\r\n\r\n\tprotected async onPageScrollBottom(scroller: Scroller): Promise<void> {\r\n\t\tawait this.controller.pageStocks.more();\r\n\t}\r\n}\r\n/*\r\n<button className=\"btn btn-sm btn-outline-primary\" \r\nonClick={() => this.controller.selectStock(stock)}>\r\n<FA name=\"cog\" className=\"text-warning small\" /> 设自选\r\n</button>\r\n*/","import { makeObservable, observable } from \"mobx\";\r\nimport { CApp, CUqBase } from \"uq-app\";\r\nimport { Stock, StockValue } from \"uq-app/uqs/BruceYuMi\";\r\nimport { StockPageItems } from \"./stockPageItems\";\r\nimport { VFind } from \"./VFind\";\r\nimport { VSetting } from \"./VSetting\";\r\nimport { VStocksPage } from \"./VStocksPage\";\r\n\r\ntype SearchOrder = 'miRateDesc' | 'miRateAsc' | 'dvRateDesc' | 'dvRateAsc' | 'roeDesc' | 'roeAsc';\r\nconst defaultSmooth = 0;\r\n\r\nexport class CFind extends  CUqBase {\r\n\theader: string = null;\r\n\tpageStocks: StockPageItems = null;\r\n\tsearchOrder: SearchOrder = 'miRateDesc';\r\n\tsmooth: number;\r\n\r\n\tconstructor(cApp: CApp) {\r\n\t\tsuper(cApp);\r\n\t\tmakeObservable(this, {\r\n\t\t\theader: observable,\r\n\t\t\t//miAccount: observable,\r\n\t\t});\r\n\t\tthis.loadSmooth();\r\n\t}\r\n\r\n\ttab = () => {\r\n\t\treturn this.renderView(VFind);\r\n\t}\r\n\r\n\tasync internalStart(param: any) {\r\n\t\tthis.openVPage(VFind);\r\n\t}\r\n\r\n\tloadSmooth() {\r\n\t\tlet t = localStorage.getItem('smooth');\r\n\t\tif (!t) this.smooth = defaultSmooth;\r\n\t\telse {\r\n\t\t\ttry {\r\n\t\t\t\tthis.smooth = Number.parseInt(t);\r\n\t\t\t}\r\n\t\t\tcatch {\r\n\t\t\t\tthis.smooth = defaultSmooth;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tchangeSmooth(value: number) {\r\n\t\tthis.smooth = value;\r\n\t\tlocalStorage.setItem('smooth', String(value));\r\n\t}\r\n\r\n\tload = async() => {}\r\n\t\r\n\tprivate async searchStock(header: string, market?:string[], key?:string) {\r\n\t\tthis.header = header ;\r\n\t\tthis.pageStocks = new StockPageItems(this.cApp.store);\r\n\t\tawait this.pageStocks.first({\r\n\t\t\tkey, \r\n\t\t\tmarket: market?.join('\\n'),\r\n\t\t\t$orderSwitch: this.searchOrder,\r\n\t\t\tsmooth: this.smooth,\r\n\t\t});\r\n\t\tthis.openVPage(VStocksPage);\r\n\t}\r\n\r\n\tonSearch = async (key:string) => {\r\n\t\tawait this.searchStock('搜索 - ' + key, ['sh', 'sz', 'hk'], key);\r\n\t}\r\n\r\n\tshowA = async () => {\r\n\t\tawait this.searchStock('A股', ['sh', 'sz']);\r\n\t}\r\n\tshowHK = async () => {\r\n\t\tawait this.searchStock('港股', ['hk']);\r\n\t}\r\n\tshowSH = async () => {\r\n\t\tawait this.searchStock('沪股', ['sh']);\r\n\t}\r\n\tshowSZ = async () => {\r\n\t\tawait this.searchStock('深股', ['sz']);\r\n\t}\r\n\tshowAll = async () => {\r\n\t\tawait this.searchStock('全部股票', ['sh', 'sz', 'hk']);\r\n\t}\r\n\r\n\tonClickStock = (stock: Stock & StockValue) => {\r\n\r\n\t}\r\n\r\n\tshowSetting = () => {\r\n\t\tthis.openVPage(VSetting);\r\n\t}\r\n}\r\n","import { observer } from \"mobx-react\";\r\nimport React from \"react\";\r\nimport { View } from \"tonva-react\";\r\nimport { Stock, StockValue } from \"uq-app/uqs/BruceYuMi\";\r\nimport { CCommon } from \"./CCommon\";\r\n\r\nexport class VBlockStock extends View<CCommon> {\r\n\trender(stock: Stock & StockValue):JSX.Element {\r\n\t\treturn React.createElement(observer(() => {\r\n\t\t\tlet isBlock = this.controller.isMyBlock(stock);\r\n\t\t\tlet cn:string, content:string;\r\n\t\t\tif (isBlock === true) {\r\n\t\t\t\tcontent = '取消拉黑';\r\n\t\t\t\tcn = 'btn-outline-danger';\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tcontent = '拉黑';\r\n\t\t\t\tcn = 'btn-outline-secondary';\r\n\t\t\t}\r\n\t\t\treturn <button className={'btn btn-sm ' + cn}\r\n\t\t\t\tonClick={() => this.controller.toggleBlock(stock)}>\r\n\t\t\t\t{content}\r\n\t\t\t</button>;\r\n\t\t}));\r\n\t}\r\n}\r\n","import { MiAccount, MiGroup } from \"store\";\r\nimport { FA, VPage } from \"tonva-react\";\r\nimport { Stock } from \"uq-app/uqs/BruceYuMi\";\r\nimport { CCommon } from \"./CCommon\";\r\n\r\nexport class VKeepStock extends VPage<CCommon> {\r\n\tprivate param: {stock: Stock; miAccounts: MiAccount[]; miGroups: MiGroup[]};\r\n\tinit(param: any) {\r\n\t\tthis.param = param;\r\n\t}\r\n\theader() {return '删除选股'}\r\n\tcontent() {\r\n\t\tlet {stock, miAccounts, miGroups} = this.param;\r\n\t\treturn <div className=\"py-3\">\r\n\t\t\t<div className=\"bg-white px-3 py-2 text-info\">\r\n\t\t\t\t<FA name=\"exclamation-circle\" className=\"mr-3 text-danger\" />\r\n\t\t\t\t<b className=\"text-primary\">{stock.name}</b> 无法从自选股删除\r\n\t\t\t</div>\r\n\t\t\t{\r\n\t\t\t\tmiAccounts.length > 0 && <>\r\n\t\t\t\t\t<div className=\"small px-3 mt-3 mb-1\">持仓</div>\r\n\t\t\t\t\t<div className=\"p-3 bg-white\">\r\n\t\t\t\t\t\t{miAccounts.map((v, index) => <span key={index} className=\"mr-3\">{v.name}</span>)}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</>\r\n\t\t\t}\r\n\t\t\t{\r\n\t\t\t\tmiGroups.length > 0 && <>\r\n\t\t\t\t\t<div className=\"small px-3 mt-3 mb-1\">分组</div>\r\n\t\t\t\t\t<div className=\"p-3 bg-white\">\r\n\t\t\t\t\t\t{miGroups.map((v, index) => <span key={index} className=\"mr-3\">{v.name}</span>)}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</>\r\n\t\t\t}\r\n\t\t</div>\r\n\t}\r\n}","import { observer } from \"mobx-react\";\r\nimport React from \"react\";\r\nimport { DropdownActions, FA, View } from \"tonva-react\";\r\nimport { Stock, StockValue } from \"uq-app/uqs/BruceYuMi\";\r\nimport { CCommon } from \"./CCommon\";\r\n\r\nexport class VPinStock extends View<CCommon> {\r\n\trender(stock: Stock & StockValue):JSX.Element {\r\n\t\treturn React.createElement(observer(() => {\r\n\t\t\tlet isSelected = this.controller.isMyAll(stock);\r\n\t\t\tif (isSelected === true) {\r\n\t\t\t\treturn <DropdownActions actions={[\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tcaption: '修改分组',\r\n\t\t\t\t\t\taction: () => this.controller.setStockToGroup(stock),\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tcaption: '删除自选',\r\n\t\t\t\t\t\taction: () => this.controller.removeMyAll(stock),\r\n\t\t\t\t\t},\r\n\t\t\t\t\tundefined,\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tcaption: '取消操作',\r\n\t\t\t\t\t\taction: () => {},\r\n\t\t\t\t\t}\r\n\t\t\t\t]} icon=\"cog\" content=\"设自选\" className=\"cursor-pointer dropdown-toggle btn btn-sm btn-outline-info\" />\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\treturn <button className=\"btn btn-sm btn-outline-primary\" \r\n\t\t\t\t\tonClick={() => this.controller.toggleMyAll(stock)}>\r\n\t\t\t\t\t<FA name=\"plus-square-o\" className=\"small\" /> 加自选\r\n\t\t\t\t</button>;\r\n\t\t\t}\t\r\n\t\t}));\r\n\t}\r\n}\r\n","import { observer } from \"mobx-react\";\r\nimport React from \"react\";\r\nimport { VPage } from \"tonva-react\";\r\nimport { CCommon } from \"./CCommon\";\r\n\r\nexport class VStockInGroup extends VPage<CCommon> {\r\n\theader() {return '设置分组'}\r\n\tright() {\r\n\t\treturn <button className=\"btn btn-sm btn-info mr-2\" onClick={this.controller.manageGroups}>管理分组</button>;\r\n\t}\r\n\tcontent() {\r\n\t\treturn React.createElement(observer(() => {\r\n\t\t\tlet {stock, cApp, setGroup} = this.controller;\r\n\t\t\tif (!stock) return <div>no stock, can set group</div>;\r\n\t\t\tlet {id:stockId, name, code} = stock;\r\n\t\t\tlet {store} = cApp;\r\n\t\t\tlet {miGroups} = store;\r\n\t\t\tlet {groups} = miGroups;\r\n\t\t\tlet inGroup = store.buildInGroup(stockId);\r\n\t\t\treturn <div>\r\n\t\t\t\t<div className=\"p-3\">\r\n\t\t\t\t\t<b>{name}</b> \r\n\t\t\t\t\t<span className=\"ml-3\">{code}</span>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"d-flex flex-wrap py-1 border-top border-bottom\">\r\n\t\t\t\t\t{groups.map(v => {\r\n\t\t\t\t\t\tlet {id, name} = v;\r\n\t\t\t\t\t\treturn <label key={id} className=\"mb-0 w-8c px-3 py-2\">\r\n\t\t\t\t\t\t\t<input className=\"mr-1\" \r\n\t\t\t\t\t\t\t\ttype=\"checkbox\" \r\n\t\t\t\t\t\t\t\tdefaultChecked={inGroup[id]}\r\n\t\t\t\t\t\t\t\tonChange={evt => setGroup(evt.currentTarget.checked, v)} />\r\n\t\t\t\t\t\t\t{name}\r\n\t\t\t\t\t\t</label>;\r\n\t\t\t\t\t})}\r\n\t\t\t\t</div>\r\n\t\t\t</div>;\r\n\t\t}));\r\n\t}\r\n}","import { View } from \"tonva-react\";\r\nimport { Stock, StockValue } from \"uq-app/uqs/BruceYuMi\";\r\nimport { CCommon } from \"./CCommon\";\r\n\r\nexport class VStockLink extends View<CCommon> {\r\n\trender(stock: Stock & StockValue):JSX.Element {\r\n\t\tlet {code} = stock;\r\n\t\tlet $market = (stock as any).$market;\r\n\t\tlet mn = $market.name;\r\n\t\tlet symbol = mn + code;\r\n\t\tlet url:string, title:string;\r\n\t\tswitch (mn) {\r\n\t\t\tcase 'hk':\r\n\t\t\t\turl = `https://xueqiu.com/S/${code}`;\r\n\t\t\t\ttitle = '雪球';\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\turl = `https://finance.sina.com.cn/realstock/company/${symbol}/nc.shtml`;\r\n\t\t\t\ttitle = '新浪财经';\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\treturn <a className=\"btn btn-link d-sm-inline d-none\" href={url} target=\"_blank\" rel=\"noreferrer\">\r\n\t\t\t{title}\r\n\t\t</a>;\r\n\t}\r\n}\r\n","import { MiGroup } from \"store\";\r\nimport { IDUI } from \"tonva-react\";\r\nimport { CID, MidIXID } from \"tonva-uqui\";\r\nimport { renderGroup } from \"tool\";\r\nimport { CUqBase } from \"uq-app\";\r\nimport { Group, Stock, StockValue } from \"uq-app/uqs/BruceYuMi\";\r\nimport { VBlockStock } from \"./VBlockStock\";\r\nimport { VKeepStock } from \"./VKeepStock\";\r\nimport { VPinStock } from \"./VPinStock\";\r\nimport { VStockInGroup } from \"./VStockInGroup\";\r\nimport { VStockLink } from \"./VStockLink\";\r\n\r\nexport class CCommon extends CUqBase {\r\n\tstock: Stock & StockValue;\r\n\t\r\n\tprotected async internalStart(param: any) {\r\n\t}\r\n\r\n\tisMyAll(stock: Stock & StockValue):boolean {\r\n\t\treturn this.cApp.store.isMyAll(stock);\r\n\t}\r\n\r\n\tasync addMyAll(stock: Stock & StockValue) {\r\n\t\tawait this.cApp.store.addMyAll(stock);\r\n\t}\r\n\r\n\tasync removeMyAll(stock: Stock & StockValue) {\r\n\t\tlet ret = await this.cApp.store.removeMyAll(stock);\r\n\t\tif (ret) {\r\n\t\t\t(ret as any).stock = stock;\r\n\t\t\tthis.openVPage(VKeepStock, ret);\r\n\t\t}\r\n\t}\r\n\r\n\ttoggleMyAll(stock: Stock & StockValue) {\r\n\t\tif (this.isMyAll(stock)) {\r\n\t\t\tthis.removeMyAll(stock);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.addMyAll(stock);\r\n\t\t}\r\n\t}\r\n\r\n\tisMyBlock(stock: Stock & StockValue):boolean {\r\n\t\treturn this.cApp.store.isMyBlock(stock);\r\n\t}\r\n\r\n\ttoggleBlock = async (stock: Stock & StockValue) => {\r\n\t\tlet {store} = this.cApp;\r\n\t\t// block 操作之前，确保载入。还有显示之前，确保载入\r\n\t\tawait store.toggleBlock(stock);\r\n\t}\r\n\r\n\tsetStockToGroup = (stock: Stock&StockValue) => {\r\n\t\tthis.stock = stock;\r\n\t\tthis.openVPage(VStockInGroup);\r\n\t}\r\n\r\n\tsetGroup = async (checked:boolean, group: MiGroup) => {\r\n\t\tlet {miGroups} = this.cApp.store;\r\n\t\tif (checked === true) {\r\n\t\t\tawait miGroups.addStockToGroup(this.stock, group);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tawait miGroups.removeStockFromGroup(this.stock, group);\r\n\t\t}\r\n\t}\r\n\r\n\trenderPinStock(stock: Stock & StockValue) {\r\n\t\tif (!stock) return null;\r\n\t\treturn this.renderView(VPinStock, stock);\r\n\t}\r\n\r\n\trenderBlockStock(stock: Stock & StockValue) {\r\n\t\tif (!stock) return null;\r\n\t\treturn this.renderView(VBlockStock, stock);\r\n\t}\r\n\r\n\tshowStock = async (stock: Stock) => {\r\n\t\tlet {name, code, market, rawId} = stock;\r\n\t\trawId = 1;\r\n\t\tlet date = new Date();\r\n\t\tlet year = date.getFullYear();\r\n\t\tlet month = date.getMonth() + 1;\r\n\t\tlet dt = date.getDate();\r\n\t\tthis.cApp.showStock({\r\n\t\t\tid: rawId, \r\n\t\t\tname,\r\n\t\t\tcode,\r\n\t\t\tsymbol: market,\r\n\t\t\tday: year*10000 + month*100 + dt,\r\n\t\t\tstock\r\n\t\t} as any);\r\n\t}\r\n\r\n\tmanageGroups = async () => {\r\n\t\tlet uq = this.uqs.BruceYuMi;\r\n\t\tlet IDUI: IDUI = {\r\n\t\t\tID: uq.Group,\r\n\t\t\tfieldCustoms: {\r\n\t\t\t\tno: {hiden: true},\r\n\t\t\t\ttype: {hiden: true, defaultValue: '0'}\r\n\t\t\t},\r\n\t\t\tt: this.t,\r\n\t\t}\r\n\t\tlet mId = new MidIXID<Group>(uq, IDUI, uq.UserGroup);\r\n\t\tmId.listHeader = '管理股票分组';\r\n\t\tmId.itemHeader = '股票分组';\r\n\t\tlet cID = new CID(mId);\r\n\t\tlet {renderItem, onItemClick} = cID;\r\n\t\tcID.renderItem = (item: Group, index:number) => renderGroup(item, index, renderItem);\r\n\t\tcID.onItemClick = (item: Group):void => onItemClick(item);\r\n\t\tlet changed = await cID.call();\r\n\t\tif (changed === true) {\r\n\t\t\tawait this.cApp.store.miGroups.load();\r\n\t\t}\r\n\t}\r\n\r\n\tmanageAccounts = async () => {\r\n\t\tlet uq = this.uqs.BruceYuMi;\r\n\t\tlet IDUI:IDUI = {\r\n\t\t\tID: uq.Account,\r\n\t\t\tfieldCustoms: {\r\n\t\t\t\tno: {hiden: true},\r\n\t\t\t},\r\n\t\t\tt: this.t,\r\n\t\t}\r\n\t\tlet mId = new MidIXID(uq, IDUI, uq.UserAccount);\r\n\t\tmId.listHeader = '管理持仓账号';\r\n\t\tmId.itemHeader = '持仓账号';\r\n\t\tlet cID = new CID(mId);\r\n\t\tlet changed = await cID.call();\r\n\t\tif (changed === true) {\r\n\t\t\tawait this.cApp.store.miAccounts.load();\r\n\t\t}\r\n\t}\r\n\r\n\trenderStockLink(stock:Stock) {\r\n\t\treturn this.renderView(VStockLink, stock);\r\n\t}\r\n}\r\n","//import { CHome } from \"./home\";\r\n//import { CMe } from \"./me\";\r\nimport { CBug } from \"./bug\";\r\nimport { CUqApp } from \"./CBase\";\r\nimport { res } from \"./res\";\r\nimport { VMain } from \"./VMain\";\r\nimport { CTester } from \"./test-uqui\";\r\nimport { setUI } from \"./uqs\";\r\n//import { CHome } from '../home';\r\nimport { CMe } from '../me';\r\nimport { CExplorer } from '../explorer';\r\nimport { CWarning } from '../warning';\r\nimport { CPredictHistory } from '../predicthistory';\r\n//import { CUqApp } from './CBase';\r\n//import { res } from './res';\r\n//import { CHolding } from 'holding';\r\n//import { VMain } from './VMain';\r\nimport { Store } from 'store';\r\nimport { MiNet } from '../net';\r\nimport { CHome } from '../home';\r\nimport { CStockInfo, NStockInfo } from \"stockinfo\";\r\nimport { CFind } from \"find\";\r\nimport { Stock, StockValue } from \"./uqs/BruceYuMi\";\r\nimport { CCommon } from \"../common\";\r\n\r\nconst gaps = [10, 3,3,3,3,3,5,5,5,5,5,5,5,5,10,10,10,10,15,15,15,30,30,60];\r\n\r\nexport class CApp extends CUqApp {\r\n\t//cHome: CHome;\r\n\tcBug: CBug;\r\n\tcMe: CMe;\r\n\tcUI: CTester;\r\n\t//cGroup: CGroup;\r\n\tcHome: CHome;\r\n\tcFind: CFind;\r\n\tcExporer: CExplorer;\r\n\tcWarning: CWarning;\r\n\tcCommon: CCommon;\r\n\tmiNet: MiNet;\r\n\tstore: Store;\r\n\r\n\tprotected async internalStart(isUserLogin: boolean) {\r\n\t\tthis.setRes(res);\r\n\t\tsetUI(this.uqs);\r\n\t\t/*\r\n\t\tthis.cHome = this.newC(CHome);\r\n\t\tthis.cBug = this.newC(CBug);\r\n\t\tthis.cMe = this.newC(CMe);\r\n\t\tthis.cUI = this.newC(CTester) as CTester;\r\n\t\tthis.cHome.load();\r\n\t\t*/\r\n\t\tthis.miNet = new MiNet(this.user);\r\n\t\tthis.store = new Store(this.miNet, this.uqs);\r\n\t\tawait this.store.load();\r\n\t\t\r\n\t\t//this.cHome = this.newC(CHome);\r\n\t\tthis.cExporer = this.newC(CExplorer);\r\n\t\tthis.cHome = this.newC(CHome);\r\n\t\tthis.cFind = this.newC(CFind);\r\n\t\tthis.cMe = this.newC(CMe);\r\n\t\tthis.cWarning = this.newC(CWarning);\r\n\t\tthis.cCommon = this.newC(CCommon);\r\n\t\tif (this.isDev === true) {\r\n\t\t\tthis.cBug = this.newC(CBug);\r\n\t\t\tthis.cUI = this.newC(CTester) as CTester;\r\n\t\t}\r\n\r\n\t\tthis.openVPage(VMain, undefined, this.dispose);\r\n\t\t// 加上下面一句，可以实现主动页面刷新\r\n\t\t// this.timer = setInterval(this.callTick, 1000);\r\n\t\t// uq 里面加入这一句，会让相应的$Poked查询返回poke=1：\r\n\t\t// TUID [$User] ID (member) SET poke=1;\r\n\t}\r\n\r\n\topenPredictAVG(param:any) {\r\n\t\tlet pc = this.newC(CPredictHistory);\r\n\t\tpc.start(param);\r\n\t}\r\n\r\n\tprivate timer:any;\r\n\tprotected onDispose() {\r\n\t\tclearInterval(this.timer);\r\n\t\tthis.timer = undefined;\r\n\t}\r\n\r\n\tprivate tick = 0;\r\n\tprivate gapIndex = 0;\r\n\tprivate callTick = async () => {\r\n\t\ttry {\r\n\t\t\tif (!this.user) return;\r\n\t\t\t++this.tick;\r\n\t\t\tif (this.tick<gaps[this.gapIndex]) return;\r\n\t\t\t//console.error('tick ', new Date());\r\n\t\t\tthis.tick = 0;\r\n\t\t\tif (this.gapIndex < gaps.length - 1) ++this.gapIndex;\r\n\t\t\tlet ret = await this.uqs.BzHelloTonva.$poked.query(undefined, false);\r\n\t\t\tlet v = ret.ret[0];\r\n\t\t\tif (v === undefined) return;\r\n\t\t\tif (!v.poke) return;\r\n\t\t\tthis.gapIndex = 1;\r\n\r\n\t\t\t// 数据服务器提醒客户端刷新，下面代码重新调入的数据\r\n\t\t\t//this.cHome.refresh();\r\n\t\t}\r\n\t\tcatch {\r\n\t\t}\r\n\t}\r\n\r\n\tshowStock = async (item: NStockInfo) => {\r\n\t\tawait this.store.loadMyBlock();\r\n\t\tlet cStockInfo = this.newC(CStockInfo);\r\n\t\tcStockInfo.start(item);\r\n\t}\r\n\r\n\topenStock = (stock: Stock & StockValue) => {\r\n\t\tlet {name, code, market, rawId} = stock;\r\n\t\trawId = 1;\r\n\t\tlet date = new Date();\r\n\t\tlet year = date.getFullYear();\r\n\t\tlet month = date.getMonth() + 1;\r\n\t\tlet dt = date.getDate();\r\n\t\tthis.showStock({\r\n\t\t\tid: rawId, \r\n\t\t\tname,\r\n\t\t\tcode,\r\n\t\t\tsymbol: market,\r\n\t\t\tday: year*10000 + month*100 + dt,\r\n\t\t\tstock\r\n\t\t} as any);\r\n\t}\r\n}\r\n","//=== UqApp builder created on Wed Mar 10 2021 16:02:48 GMT-0500 (GMT-05:00) ===//\r\nimport { NavView, start, nav } from 'tonva-react';\r\nimport { CApp } from './CApp';\r\nimport { appConfig } from './appConfig';\r\n\r\nexport const App: React.FC = () => {\r\n\tnav.setSettings(appConfig);\r\n\tconst onLogined = async (isUserLogin?:boolean) => {\r\n\t\tawait start(CApp, appConfig, isUserLogin);\r\n\t}\r\n\treturn <NavView onLogined={onLogined} />;\r\n}\r\n\r\n","import { VPage } from \"tonva-react\";\r\nimport { CID } from \"./CID\";\r\n\r\nexport class VEdit extends VPage<CID<any>> {\r\n\theader() {return  this.controller.editHeader}\r\n\tcontent() {\r\n\t\tlet {cFormView, item} = this.controller;\r\n\t\t//let {itemSchema, uiSchema} = midID;\r\n\t\treturn <div className=\"p-3\">\r\n\t\t\t{cFormView.renderForm(item)}\r\n\t\t</div>;\r\n\t\t/*\r\n\t\t\t<Form fieldLabelSize={2} formData={item}\r\n\t\t\tschema={itemSchema}\r\n\t\t\tuiSchema={uiSchema}\r\n\t\t\tonButtonClick={this.onSubmit} />\r\n\t\t*/\r\n\t}\r\n}\r\n","import { observer } from \"mobx-react\";\r\nimport { FA, PropGrid, VPage } from \"tonva-react\";\r\nimport { CID } from \"./CID\";\r\n\r\nexport class VView extends VPage<CID<any>> {\r\n\theader() {return this.controller.midID.itemHeader}\r\n\tright() {\r\n\t\treturn <button\r\n\t\t\tclassName=\"btn btn-sm btn-primary mr-2\" \r\n\t\t\tonClick={() => this.controller.onItemEdit()}>\r\n\t\t\t<FA name=\"pencil-square-o\" />\r\n\t\t</button>;\r\n\t}\r\n\tcontent() {\r\n\t\tlet V = observer(() => {\r\n\t\t\tlet {item, midID} = this.controller;\r\n\t\t\tlet {props} = midID;\r\n\t\t\treturn <div className=\"py-3\">\r\n\t\t\t\t<PropGrid rows={props}\r\n\t\t\t\t\tvalues={item} />\r\n\t\t\t</div>;\t\r\n\t\t});\r\n\t\treturn <V />;\r\n\t}\r\n}\r\n","import { zh } from \"./zh\";\r\nimport { en } from \"./en\";\r\n\r\nexport const res = {\r\n\t$zh: zh,\r\n\t$en: en,\r\n}\r\n","export const zh = {\r\n\tnew: '新建',\r\n\tedit: '修改',\r\n\tlist: '列表',\r\n}","export const en = {\r\n\tnew: 'New',\r\n\tedit: 'Edit',\r\n\tlist: 'List',\r\n}\r\n","import { makeObservable, observable, runInAction } from \"mobx\";\r\nimport { Context, Controller } from \"tonva-react\";\r\nimport { renderItem } from \"../tools\";\r\nimport { IDBase } from \"../base\";\r\nimport { CList } from '../list';\r\nimport { CFormView, FormUI } from \"../form\";\r\nimport { MidID } from \"./MidID\";\r\nimport { MidIDList } from \"./MidIDList\";\r\nimport { VEdit } from \"./VEdit\";\r\nimport { VView } from \"./VView\";\r\nimport { res } from \"./res\";\r\n\r\nexport class CID<T extends IDBase> extends Controller {\r\n\titem:T = null;\r\n\tmidID: MidID<T>;\r\n\tcFormView: CFormView<T>;\r\n\tprivate midIDList: MidIDList<T>;\r\n\tprivate valueChanged: boolean;\r\n\r\n\tconstructor(midID: MidID<T>) {\r\n\t\tsuper();\r\n\t\tmakeObservable(this, {\r\n\t\t\titem: observable,\r\n\t\t});\r\n\t\tthis.setRes(res);\r\n\t\tthis.setRes(midID.res);\r\n\t\tthis.midID = midID;\r\n\t}\r\n\r\n\tprotected async internalStart() {\r\n\t\tthis.valueChanged = false;\r\n\t\tawait this.midID.init();\r\n\t\tthis.createFormView();\r\n\t\tthis.midIDList =  this.midID.createMidIDList();\r\n\t\tthis.midIDList.onRightClick = this.onItemNew;\r\n\t\tthis.midIDList.renderItem = this.renderItem;\r\n\t\tthis.midIDList.onItemClick = this.onItemClick;\r\n\t\tthis.midIDList.renderRight = undefined;\r\n\t\tlet cList = this.createCList();\r\n\t\tawait cList.call();\r\n\t\tthis.returnCall(this.valueChanged);\r\n\t}\r\n\r\n\tprotected createFormView() {\r\n\t\tlet {ID, IDUI} = this.midID;\r\n\t\tlet {fieldCustoms} = IDUI;\r\n\t\tlet formUI = new FormUI(ID.ui, fieldCustoms, ID.t);\r\n\t\tthis.cFormView = new CFormView(formUI);\r\n\t\tthis.cFormView.onSubmit = this.onSubmit;\r\n\t} \r\n\r\n\tprotected createCList() {\r\n\t\treturn new CList(this.midIDList);\r\n\t}\r\n\r\n\tprivate onSubmit = async (name:string, context: Context) => {\r\n\t\tawait this.saveID(context.data);\r\n\t\tthis.closePage();\r\n\t}\r\n\r\n\trenderItem: (item:T, index:number) => JSX.Element = (item:T, index:number) => {\r\n\t\tlet {ID } = this.midID;\r\n\t\tif (ID) return ID.render(item);\r\n\t\treturn renderItem(item, index);\r\n\t}\r\n\tonItemClick: (item: T) => void = (item:any) => {\r\n\t\trunInAction(() => {\r\n\t\t\tthis.item = item;\r\n\t\t\tthis.onItemView();\t\r\n\t\t});\r\n\t}\r\n\r\n\tonItemEdit = async (): Promise<void> => {\r\n\t\tthis.openVPage(VEdit);\r\n\t}\r\n\r\n\tonItemView():void {\r\n\t\tthis.openVPage(VView);\r\n\t}\r\n\r\n\tonItemNew = async (): Promise<void> => {\r\n\t\tawait this.cFormView.setNO(this.midID.ID);\r\n\t\trunInAction(() => {\r\n\t\t\tthis.item = undefined;\r\n\t\t\tthis.openVPage(VEdit);\r\n\t\t});\r\n\t}\r\n\r\n\tasync saveID(itemProps:any) {\r\n\t\tlet id = this.item?.id;\r\n\t\tlet item = {\r\n\t\t\t...itemProps,\r\n\t\t\tid,\r\n\t\t}\r\n\t\tlet ret = await this.midID.saveID(item);\r\n\t\tif (ret) id = ret;\r\n\t\tthis.midIDList?.update(id, item);\r\n\t\trunInAction(() => {\r\n\t\t\tif (this.item)\r\n\t\t\t\tObject.assign(this.item, item);\r\n\t\t\telse\r\n\t\t\t\tthis.item = item;\r\n\t\t});\r\n\t\tthis.valueChanged = true;\r\n\t\treturn ret;\r\n\t}\r\n\r\n\tget itemHeader() {\r\n\t\treturn (this.midID.itemHeader as string ?? this.midID.ID.ui.label as string)\r\n\t}\r\n\r\n\tget editHeader() {\r\n\t\treturn this.t(this.item? 'edit' : 'new') + ' ' + this.itemHeader;\r\n\t}\r\n}\r\n","import { ID, IX, Uq } from \"tonva-react\";\r\nimport { IDBase, IXBase } from \"../base\";\r\nimport { MidIDListBase } from \"../list\";\r\n\r\nexport class MidIDList<T extends IDBase> extends MidIDListBase<T> {\r\n\treadonly ID:ID;\r\n\t\r\n\tconstructor(uq:Uq, ID:ID) {\r\n\t\tsuper(uq);\r\n\t\tthis.ID = ID;\r\n\t}\r\n\r\n\tasync init() {\r\n\t\t//await this.ID.loadSchema();\r\n\t}\r\n\r\n\tprotected async loadPageItems(pageStart:any, pageSize:number):Promise<T[]> {\r\n\t\tlet ret = await this.uq.ID<T>({\r\n\t\t\tIDX: this.ID,\r\n\t\t\tid: undefined,\r\n\t\t\tpage: {start:pageStart, size:pageSize},\r\n\t\t});\r\n\t\treturn ret;\r\n\t}\r\n\r\n\tupdate(id:number, item:any) {\r\n\t\titem.id = id;\r\n\t\tthis.listPageItems.update(item);\r\n\t}\r\n}\r\n\r\nexport class MidIXIDList<T extends IXBase> extends MidIDList<T> {\r\n\treadonly IX:IX;\r\n\tconstructor(uq:Uq, ID:ID, IX:IX) {\r\n\t\tsuper(uq, ID);\r\n\t\tthis.IX = IX;\r\n\t}\r\n\r\n\tprotected async loadPageItems(pageStart:any, pageSize:number):Promise<T[]> {\r\n\t\tlet ret = await this.uq.IX<T>({\r\n\t\t\tIX: this.IX,\r\n\t\t\tIDX: [this.ID],\r\n\t\t\tix: undefined,\r\n\t\t\tpage: {start:pageStart, size:pageSize},\r\n\t\t});\r\n\t\t/*\r\n\t\tfor (let item of ret) {\r\n\t\t\titem.id = item.id;\r\n\t\t\tdelete item.id;\r\n\t\t}\r\n\t\t*/\r\n\t\treturn ret;\r\n\t}\r\n}\r\n","import { ID, Schema, UiSchema, Uq, Prop, UiButton, UiItemCollection, IDUI, IX, ParamActIX } from \"tonva-react\";\r\nimport { IDBase, Mid } from \"../base\";\r\nimport { MidIDList, MidIXIDList } from \"./MidIDList\";\r\n\r\nexport class MidID<T extends IDBase> extends Mid {\r\n\treadonly IDUI: IDUI;\r\n\treadonly ID: ID;\r\n\r\n\tconstructor(uq: Uq, IDUI: IDUI) {\r\n\t\tsuper(uq);\r\n\t\tthis.IDUI = IDUI;\r\n\t\tthis.ID = IDUI.ID;\r\n\t}\r\n\r\n\tlistHeader: string|JSX.Element;\r\n\titemHeader: string|JSX.Element;\r\n\r\n\tasync init():Promise<void> {\r\n\t\tawait this.loadSchema();\r\n\t\tthis._itemSchema = await this.buildItemSchema(this.IDUI);\r\n\t\tthis._uiSchema = this.buildUISchema(this.IDUI);\r\n\t}\r\n\r\n\tcreateMidIDList():MidIDList<T> {\r\n\t\tlet ret = new MidIDList<T>(this.uq, this.ID);\r\n\t\tret.header = this.listHeader;\r\n\t\treturn ret;\r\n\t}\r\n\r\n\tprotected buildUISchema(IDUI:IDUI):UiSchema {\r\n\t\tlet {ID} = IDUI;\r\n\t\tlet items:UiItemCollection = {};\r\n\t\tthis._uiSchema = {items};\r\n\t\tlet {fields} = ID.ui;\r\n\t\tif (fields) {\r\n\t\t\tfor (let f of this._itemSchema) {\r\n\t\t\t\tlet {name} = f;\r\n\t\t\t\tObject.assign(f, (fields as any)[name]);\r\n\t\t\t\t(items as any)[name] = f;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tlet uiButton: UiButton = {\r\n\t\t\tlabel: '提交',\r\n\t\t\tclassName: 'btn btn-primary',\r\n\t\t\twidget: 'button',\r\n\t\t};\r\n\t\titems['submit'] = uiButton;\r\n\t\treturn this._uiSchema;\r\n\t}\r\n\tprotected async loadSchema() {\r\n\t\tawait this.ID.loadSchema();\r\n\t}\r\n\r\n\tasync load(id:number): Promise<T[]> {\r\n\t\tlet ret = await this.uq.ID<T>({\r\n\t\t\tIDX: this.ID,\r\n\t\t\tid,\r\n\t\t\tpage: undefined,\r\n\t\t});\r\n\t\treturn ret;\r\n\t}\r\n\tasync saveID(data:any):Promise<number> {\r\n\t\tlet param: any = {};\r\n\t\tparam[this.ID.name] = [data];\r\n\t\tlet ret = await this.uq.Acts(param);\r\n\t\tlet id = ret[this.ID.name];\r\n\t\tif (!id) return;\r\n\t\treturn id[0];\r\n\t}\r\n\r\n\tprivate _itemSchema: Schema;\r\n\tget itemSchema(): Schema {\r\n\t\t//if (this._itemSchema !== undefined) \r\n\t\treturn this._itemSchema;\r\n\t\t//return this._itemSchema = this.buildItemSchema(this.ID);\r\n\t}\r\n\r\n\tprivate _uiSchema: UiSchema;\r\n\tget uiSchema(): UiSchema {\r\n\t\t//if (this._uiSchema !== undefined) \r\n\t\treturn this._uiSchema;\r\n\t\t//return this._uiSchema = this.buildUISchema(this.ID);\r\n\t}\r\n\r\n\tprivate _props: Prop[];\r\n\tget props():Prop[] {\r\n\t\tif (this._props !== undefined) return this._props;\r\n\t\treturn this._props = this.buildGridProps(this.IDUI.ID.ui);\r\n\t}\r\n\r\n\t/*\r\n\tprotected async setDefaultNo() {\r\n\t\tfor (let fieldItem of this._itemSchema) {\r\n\t\t\tif (fieldItem.name === 'no') {\r\n\t\t\t\tlet no = await this.ID.NO();\r\n\t\t\t\tthis.setNO(no, fieldItem);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t*/\r\n}\r\n\r\nexport class MidIXID<T extends IDBase> extends MidID<T> {\r\n\treadonly IX: IX;\r\n\tconstructor(uq: Uq, IDUI: IDUI, IX: IX) {\r\n\t\tsuper(uq, IDUI);\r\n\t\tthis.IX = IX;\r\n\t}\r\n\r\n\tcreateMidIDList():MidIDList<T> {\r\n\t\tlet ret = new MidIXIDList<any>(this.uq, this.ID, this.IX);\r\n\t\tret.header = this.listHeader;\r\n\t\treturn ret;\r\n\t}\r\n\r\n\tasync saveID(data:any):Promise<number> {\r\n\t\tlet param: ParamActIX<T> = {\r\n\t\t\tID: this.ID,\r\n\t\t\tIX: this.IX,\r\n\t\t\tvalues: [\r\n\t\t\t\t{ix:undefined, id:data}\r\n\t\t\t],\r\n\t\t};\r\n\t\tlet ret = await this.uq.ActIX(param);\r\n\t\tlet id = ret[0];\r\n\t\tif (!id) return;\r\n\t\treturn id;\r\n\t}\r\n}\r\n","import {HttpChannel} from './httpChannel';\r\nimport { Caller } from './caller';\r\n\r\nexport async function refetchApi(channel:HttpChannel, url:string, options:any, \r\n    resolve:(values:any)=>any, reject:(reason:any)=>void)\r\n{\r\n    await channel.fetch(url, options, false, resolve, reject);\r\n}\r\n\r\nexport abstract class ApiBase {\r\n    protected token: string;\r\n    protected path: string;\r\n    protected showWaiting: boolean;\r\n\r\n    constructor(path: string, showWaiting: boolean) {\r\n        this.path = path || '';\r\n        this.showWaiting = showWaiting;\r\n    }\r\n\r\n    protected abstract getHttpChannel(): Promise<HttpChannel>;\r\n\r\n    async xcall(caller:Caller<any>):Promise<any> {\r\n        let channel = await this.getHttpChannel();\r\n        return await channel.xcall(this.path, caller);\r\n    }\r\n\r\n    public async call(url:string, method:string, body:any):Promise<any> {\r\n        let channel = await this.getHttpChannel();\r\n        return await channel.callFetch(url, method, body);\r\n    }\r\n\r\n    public async get(path:string, params:any=undefined): Promise<any> {\r\n        let channel = await this.getHttpChannel();\r\n        return await channel.get(this.path + path, params);\r\n    }\r\n\r\n    public async post(path:string, params:any): Promise<any> {\r\n        let channel = await this.getHttpChannel();\r\n        return await channel.post(this.path + path, params);\r\n    }\r\n\r\n    public async put(path:string, params:any): Promise<any> {\r\n        let channel = await this.getHttpChannel();\r\n        return await channel.put(this.path + path, params);\r\n    }\r\n\r\n    public async delete(path:string, params:any): Promise<any> {\r\n        let channel = await this.getHttpChannel();\r\n        return await channel.delete(this.path + path, params);\r\n    }\r\n}\r\n","import { LocalMap, LocalCache, env } from '../tool';\r\nimport { UqData, UqAppData, CenterAppApi } from '../net';\r\nimport { UqMan } from './uqMan';\r\nimport { TuidImport, TuidInner } from './tuid';\r\nimport { nav } from '../components';\r\nimport { AppConfig, UqConfig } from '../app';\r\n\r\nexport interface TVs {\r\n    [uqName:string]: {\r\n        [tuidName: string]: (values: any) => JSX.Element;\r\n    }\r\n}\r\n\r\nexport class UQsMan {\r\n\tstatic _uqs: any;\r\n\tstatic value: UQsMan;\r\n\t//static uqOwnerMap: {[key:string]:string};\r\n\r\n\tstatic async build(appConfig: AppConfig) {\r\n\t\tlet {app, uqs, tvs} = appConfig;\r\n\t\tlet retErrors:string[];\r\n\t\tif (app) {\r\n\t\tlet {name, version/*, ownerMap*/} = app;\r\n\t\t\t//UQsMan.uqOwnerMap = ownerMap || {};\r\n\t\t\t//for (let i in ownerMap) ownerMap[i.toLowerCase()] = ownerMap[i];\r\n\t\t\tretErrors = await UQsMan.load(name, version, tvs);\r\n\t\t}\r\n\t\telse if (uqs) {\r\n\t\t\t/*\r\n\t\t\tlet uqNames:{owner:string; name:string; version:string}[] = [];\r\n\t\t\t//let map:{[owner:string]: string} = UQsMan.uqOwnerMap = {};\r\n\t\t\tfor (let uq of uqs) {\r\n\t\t\t\t//let ownerObj = uqs[owner];\r\n\t\t\t\tlet {dev, name, alias, version:uqVersion, memo} = uq;\r\n\t\t\t\tfor (let name in uq) {\r\n\t\t\t\t\tlet {name:owner} = dev;\r\n\t\t\t\t\t//let v = ownerObj[name];\r\n\t\t\t\t\t//if (name === '$') {\r\n\t\t\t\t\t//\tmap[owner.toLowerCase()] = v;\r\n\t\t\t\t\t//\tcontinue;\r\n\t\t\t\t\t//}\r\n\t\t\t\t\tuqNames.push({owner, name, version:uqVersion});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t*/\r\n\t\t\tretErrors = await UQsMan.loadUqs(uqs, tvs);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthrow new Error('either uqs or app must be defined in AppConfig');\r\n\t\t}\r\n\t\treturn retErrors;\r\n\t}\r\n\r\n\t// 返回 errors, 每个uq一行\r\n\tprivate static async load(tonvaAppName:string, version:string, tvs:TVs):Promise<string[]> {\r\n\t\tlet uqsMan = UQsMan.value = new UQsManApp(tonvaAppName, tvs);\r\n        let {appOwner, appName} = uqsMan;\r\n        let {localData} = uqsMan;\r\n        let uqAppData:UqAppData = localData.get();\r\n        if (!uqAppData || uqAppData.version !== version) {\r\n\t\t\tuqAppData = await loadAppUqs(appOwner, appName);\r\n\t\t\tif (!uqAppData.id) {\r\n\t\t\t\treturn [\r\n\t\t\t\t\t`${appOwner}/${appName}不存在。请仔细检查app全名。`\r\n\t\t\t\t];\r\n\t\t\t}\r\n            uqAppData.version = version;\r\n            localData.set(uqAppData);\r\n            // \r\n            for (let uq of uqAppData.uqs) uq.newVersion = true;\r\n        }\r\n        let {id, uqs} = uqAppData;\r\n\t\tuqsMan.id = id;\r\n\t\t//console.error(uqAppData);\r\n\t\t//let ownerProfixMap: {[owner: string]: string};\r\n\t\treturn uqsMan.buildUqs(uqs);\r\n\t}\r\n\r\n\t// 返回 errors, 每个uq一行\r\n\tprivate static async loadUqs(uqConfigs: UqConfig[], tvs:TVs):Promise<string[]> {\r\n\t\tlet uqsMan = UQsMan.value = new UQsMan(tvs);\r\n\t\tlet uqs = await loadUqs(uqConfigs);\r\n\t\treturn uqsMan.buildUqs(uqs, uqConfigs);\r\n\t}\r\n\r\n\tprivate uqMans: UqMan[] = [];\r\n    private collection: {[uqLower: string]: UqMan};\r\n    private readonly tvs: TVs;\r\n\r\n    protected constructor(tvs:TVs) {\r\n        this.tvs = tvs || {};\r\n\t\tthis.buildTVs();\r\n\t\tthis.uqMans = [];\r\n        this.collection = {};\r\n    }\r\n\r\n\tprivate async buildUqs(uqDataArr:UqData[], uqConfigs?:UqConfig[]):Promise<string[]> {\r\n        await this.init(uqDataArr);\r\n        let retErrors = await this.load();\r\n\t\tif (retErrors.length > 0) return retErrors;\r\n\t\tretErrors.push(...this.setTuidImportsLocal());\r\n\t\tif (retErrors.length > 0) return retErrors;\r\n\t\tif (uqConfigs) {\r\n\t\t\tfor (let uqConfig of uqConfigs) {\r\n\t\t\t\tlet {dev, name} = uqConfig;\r\n\t\t\t\tlet {name:owner} = dev;\r\n\t\t\t\tlet uqLower = owner.toLowerCase() + '/' + name.toLowerCase();\r\n\t\t\t\tlet uq = this.collection[uqLower];\r\n\t\t\t\tuq.config = uqConfig;\r\n\t\t\t}\r\n\t\t}\r\n\t\tUQsMan._uqs = this.buildUQs();\r\n\t}\r\n\r\n\tstatic uq(uqName: string): UqMan {\r\n\t\treturn UQsMan.value.collection[uqName.toLowerCase()];\r\n\t}\r\n\t\r\n\tstatic async getUqUserRoles(uqLower:string):Promise<string[]> {\r\n\t\tlet uqMan = UQsMan.value.collection[uqLower];\r\n\t\tif (uqMan === undefined) return null;\r\n\t\tlet roles = await uqMan.getRoles();\r\n\t\treturn roles;\r\n\t}\r\n\r\n    private buildTVs() {\r\n\t\tif (!this.tvs) return;\r\n        for (let i in this.tvs) {\r\n            let uqTVs = this.tvs[i];\r\n            if (uqTVs === undefined) continue;\r\n            let l = i.toLowerCase();\r\n            if (l === i) continue;\r\n            this.tvs[l] = uqTVs;\r\n            for (let j in uqTVs) {\r\n                let en = uqTVs[j];\r\n                if (en === undefined) continue;\r\n                let lj = j.toLowerCase();\r\n                if (lj === j) continue;\r\n                uqTVs[lj] = en;\r\n            }\r\n        }\r\n    }\r\n\r\n    async init(uqsData:UqData[]):Promise<void> {\r\n        let promiseInits: PromiseLike<void>[] = uqsData.map(uqData => {\r\n\t\t\tlet {uqOwner, uqName} = uqData;\r\n\t\t\tlet uqFullName = uqOwner + '/' + uqName;\r\n\t\t\t//let uqUI = this.ui.uqs[uqFullName] as UqUI || {};\r\n\t\t\t//let cUq = this.newCUq(uqData, uqUI);\r\n\t\t\t//this.cUqCollection[uqFullName] = cUq;\r\n\t\t\t//this.uqs.addUq(cUq.uq);\r\n\t\t\tlet uq = new UqMan(this, uqData, undefined, this.tvs[uqFullName] || this.tvs[uqName]);\r\n\t\t\tthis.uqMans.push(uq);\r\n\t\t\t//uq.ownerProfix = UQsMan.uqOwnerMap[uqOwner.toLowerCase()];\r\n\t\t\t//this.collection[uqFullName] = uq;\r\n\t\t\tlet lower = uqFullName.toLowerCase();\r\n\t\t\tthis.collection[lower] = uq;\r\n\t\t\t/*\r\n\t\t\tif (lower !== uqFullName) {\r\n\t\t\t\tthis.collection[lower] = uq;\r\n\t\t\t}\r\n\t\t\t*/\r\n\t\t\treturn uq.init();\r\n\t\t});\r\n        await Promise.all(promiseInits);\r\n    }\r\n\r\n    async load(): Promise<string[]> {\r\n        let retErrors:string[] = [];\r\n\t\tlet promises: PromiseLike<string>[] = [];\r\n\t\t//let lowerUqNames:string[] = [];\r\n\t\t// collection有小写名字，还有正常名字\r\n        //for (let i in this.collection) {\r\n\t\tfor (let uqMan of this.uqMans) {\r\n\t\t\t//let lower = (i as string).toLowerCase();\r\n\t\t\t//if (lowerUqNames.indexOf(lower) >= 0) continue;\r\n\t\t\t//lowerUqNames.push(lower);\r\n            //let uq = this.collection[i];\r\n            promises.push(uqMan.loadEntities());\r\n\t\t}\r\n\t\tlet results = await Promise.all(promises);\r\n        for (let result of results)\r\n        {\r\n            let retError = result; // await cUq.loadSchema();\r\n            if (retError !== undefined) {\r\n                retErrors.push(retError);\r\n            }\r\n\t\t}\r\n        return retErrors;\r\n    }\r\n\r\n    buildUQs(): any {\r\n        //let that = this;\r\n        let uqs:any = {};\r\n        for (let uqMan of this.uqMans) {\r\n            let uqKey = uqMan.getUqKey();\r\n\t\t\tlet lower = uqKey.toLowerCase();\r\n\t\t\tlet proxy = uqMan.createProxy();\r\n\t\t\tuqs[uqKey] = proxy;\r\n\t\t\tif (lower !== uqKey) uqs[lower] = proxy;\r\n        }\r\n        return new Proxy(uqs, {\r\n            get: (target, key, receiver) => {\r\n                let lk = (key as string).toLowerCase();\r\n                let ret = target[lk];\r\n                if (ret !== undefined) return ret;\r\n                /*\r\n                for (let i in uqs) {\r\n                    if (i.toLowerCase() === lk) {\r\n                        return uqs[i];\r\n                    }\r\n                }*/\r\n                debugger;\r\n                console.error('error in uqs');\r\n                this.showReload(`代码错误：新增 uq ${String(key)}`);\r\n                return undefined;\r\n            },\r\n        });\r\n\t}\r\n\t\r\n\tgetUqMans() {\r\n\t\treturn this.uqMans;\r\n\t}\r\n\r\n    private showReload(msg: string) {\r\n\t\tfor (let uqMan of this.uqMans) {\r\n\t\t\tuqMan.localMap.removeAll();\r\n\t\t}\r\n        nav.showReloadPage(msg);\r\n    }\r\n\r\n    setTuidImportsLocal():string[] {\r\n        let ret:string[] = [];\r\n        for (let uqMan of this.uqMans) {\r\n            for (let tuid of uqMan.tuidArr) {\r\n                if (tuid.isImport === true) {\r\n                    let error = this.setInner(tuid as TuidImport);\r\n                    if (error) ret.push(error);\r\n                }\r\n            }\r\n        }\r\n        return ret;\r\n    }\r\n\r\n    private setInner(tuidImport: TuidImport):string {\r\n        let {from} = tuidImport;\r\n        let fromName = from.owner + '/' + from.uq;\r\n        let uq = this.collection[fromName];\r\n        if (uq === undefined) {\r\n            //debugger;\r\n            return `setInner(tuidImport: TuidImport): uq ${fromName} is not loaded`;\r\n        }\r\n        let iName = tuidImport.name\r\n        let tuid = uq.tuid(iName);\r\n        if (tuid === undefined) {\r\n            //debugger;\r\n            return `setInner(tuidImport: TuidImport): uq ${fromName} has no Tuid ${iName}`;\r\n        }\r\n        if (tuid.isImport === true) {\r\n            //debugger;\r\n            return `setInner(tuidImport: TuidImport): uq ${fromName} Tuid ${iName} is import`;\r\n        }\r\n        tuidImport.setFrom(tuid as TuidInner);\r\n    }\r\n}\r\n\r\nclass UQsManApp extends UQsMan {\r\n    readonly appOwner: string;\r\n    readonly appName: string;\r\n    readonly localMap: LocalMap;\r\n    readonly localData: LocalCache;\r\n    id: number;\r\n\r\n\tconstructor(tonvaAppName:string, tvs:TVs) {\r\n\t\tsuper(tvs);\r\n        let parts = tonvaAppName.split('/');\r\n        if (parts.length !== 2) {\r\n            throw new Error('tonvaApp name must be / separated, owner/app');\r\n        }\r\n        this.appOwner = parts[0];\r\n        this.appName = parts[1];\r\n        this.localMap = env.localDb.map(tonvaAppName);\r\n        this.localData = this.localMap.child('uqData');\r\n\t}\r\n}\r\n\r\nasync function loadAppUqs(appOwner:string, appName:string): Promise<UqAppData> {\r\n    let centerAppApi = new CenterAppApi('tv/', undefined);\r\n    let ret = await centerAppApi.appUqs(appOwner, appName);\r\n    return ret;\r\n}\r\n\r\nasync function loadUqs(uqConfigs: UqConfig[]): Promise<UqData[]> {\r\n\tlet uqs: {owner:string; name:string; version:string}[] = uqConfigs.map(\r\n\t\tv => {\r\n\t\t\tlet {dev, name, version} =v;\r\n\t\t\tlet {name:owner} = dev;\r\n\t\t\treturn {owner, name, version};\r\n\t\t}\r\n\t);\r\n    let centerAppApi = new CenterAppApi('tv/', undefined);\r\n    let ret = await centerAppApi.uqs(uqs);\r\n    return ret;\r\n}\r\n","import { Holding, Portfolio, Stock, StockValue } from \"uq-app/uqs/BruceYuMi\";\r\n\r\nexport class HoldingStock implements Holding, Portfolio {\r\n\tid: number;\r\n\taccount: number;\r\n\tstock: number;\r\n\torder: number;\r\n\tprice: number;\r\n\tquantity: number;\r\n\tmi: number;\t\t\t\t// 米值\r\n\tmarket: number;\t\t\t// 市值\r\n\tdivident: number;\t\t// 股息\r\n\tstockObj: Stock & StockValue;\r\n\r\n\tconstructor(holdingId: number, stock: Stock & StockValue, quantity: number) {\r\n\t\tthis.id = holdingId;\r\n\t\tthis.stock = stock.id;\r\n\t\tthis.stockObj = stock;\r\n\t\tthis.setQuantity(stock.price, quantity);\r\n\t}\r\n\r\n\tsetQuantity(price: number, quantity: number) {\r\n\t\tthis.price = price;\r\n\t\tthis.quantity = quantity;\r\n\t\tlet {miValue, divident} = this.stockObj;\r\n\t\tif (miValue === undefined) miValue = 0;\r\n\t\tif (divident === undefined) divident = 0;\r\n\t\tthis.mi = quantity * miValue / 100;\r\n\t\tthis.market = quantity * (price as number);\r\n\t\tthis.divident = quantity * (divident as number ?? 0);\r\n\t}\r\n}\r\n","// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\nimport { runInAction } from \"mobx\";\r\nimport { ID, IX, Uq } from \"tonva-react\";\r\nimport { CList, MidIDListBase } from \"../list\";\r\nimport { IXBase } from \"../base\";\r\n\r\nexport class CIXList<T2 extends IXBase> extends CList<T2> {\r\n\tprotected midIXList: MidIXList<T2>;\r\n\tconstructor(midIXList: MidIXList<T2>) {\r\n\t\tsuper(midIXList);\r\n\t\tthis.setRes(midIXList.res);\r\n\t\tthis.midIXList = midIXList;\r\n\t}\r\n\r\n\tupdate(item:any) {\r\n\t\tthis.midIXList.update(item);\r\n\t}\r\n}\r\n\r\nexport class MidIXList<T extends IXBase> extends MidIDListBase<T> {\r\n\treadonly IX:IX;\r\n\treadonly ID:ID;\r\n\treadonly id: number;\r\n\tconstructor(uq:Uq, IX:IX, ID:ID, id:number) {\r\n\t\tsuper(uq, undefined);\r\n\t\tthis.IX = IX;\r\n\t\tthis.ID = ID;\r\n\t\tthis.id = id;\r\n\t}\r\n\r\n\tasync init() {\r\n\t\tawait this.IX.loadSchema();\r\n\t}\r\n\r\n\t//key:((item:T) => number|string) = item => item.id 2;\r\n\r\n\tprotected async loadPageItems(pageStart:any, pageSize:number):Promise<T[]> {\r\n\t\tlet ret = await this.uq.IX<T>({\r\n\t\t\tIX: this.IX,\r\n\t\t\tIDX: this.ID? [this.ID] : undefined,\r\n\t\t\tix: this.id,\r\n\t\t\tpage: {start:pageStart, size:pageSize},\r\n\t\t});\r\n\t\treturn ret;\r\n\t}\r\n\r\n\tupdate(item:T) {\r\n\t\trunInAction(() => {\r\n\t\t\tlet {_items} = this.listPageItems;\r\n\t\t\tif (!_items) return;\r\n\t\t\tlet {ix, id} = item;\r\n\t\t\tif (id < 0) {\r\n\t\t\t\tlet index = _items.findIndex(v => v.id === -id && v.id === id);\r\n\t\t\t\tif (index >= 0) _items.splice(index, 1);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tlet ret = _items.find(v => v.id === id && v.id === id);\r\n\t\t\t\tif (!ret) {\r\n\t\t\t\t\t_items.unshift({ix, id} as T);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n}\r\n","import { Controller, ID, IX, Uq } from \"tonva-react\";\r\nimport { Mid } from \"../base\";\r\nimport { CIXList, MidIXList } from \"./CIXList\";\r\n\r\nexport class MidIX extends Mid {\r\n\treadonly IX: IX;\r\n\treadonly ID: ID;\r\n\treadonly id: number;\r\n\tconstructor(uq:Uq, IX:IX, ID:ID, id:number, res?:any) {\r\n\t\tsuper(uq, res);\r\n\t\tthis.IX = IX;\r\n\t\tthis.ID = ID;\r\n\t\tthis.id = id;\r\n\t}\r\n\r\n\tasync init(): Promise<void> {\r\n\t}\r\n}\r\n\r\nexport class CIX<P extends MidIX> extends Controller {\r\n\tprotected readonly midIX: P;\r\n\r\n\tconstructor(midIX: P) {\r\n\t\tsuper();\r\n\t\tthis.setRes(midIX.res);\r\n\t\tthis.midIX = midIX;\r\n\t}\r\n\r\n\tprotected async internalStart() {\r\n\t\tlet {uq, IX, ID, id} = this.midIX;\r\n\t\tlet midIXList = new MidIXList(uq, IX, ID, id);\r\n\t\tmidIXList.onRightClick = this.onItemEdit;\r\n\t\tmidIXList.renderItem = undefined;\r\n\t\tmidIXList.onItemClick = this.onItemClick;\r\n\t\tmidIXList.renderRight = undefined;\r\n\t\tlet idList = new CIXList(midIXList);\r\n\t\tawait idList.start();\r\n\t}\r\n\r\n\tprivate onItemEdit = () => {\r\n\r\n\t}\r\n\r\n\tprivate onItemClick = (item:any) => {\r\n\t\t\r\n\t}\r\n}\r\n","import { ID } from \"tonva-react\";\r\nimport { CIX, MidIX } from \"./CIX\";\r\nimport { CIXList, MidIXList} from \"./CIXList\";\r\nimport { CIXSelect, MidIXSelectList } from \"../select\";\r\n\r\nexport interface IXEditProps extends MidIX {\r\n\tID: ID;\r\n}\r\n\r\nexport class CIXEdit extends CIX<IXEditProps> {\r\n\tprivate cIXList: CIXList<any>;\r\n\tprotected async internalStart() {\r\n\t\tlet {uq, IX, ID, id} = this.midIX;\r\n\t\tlet midIXList = new MidIXList(uq, IX, ID, id);\r\n\t\tmidIXList.onRightClick = this.onListRightClick;\r\n\t\tmidIXList.renderItem = undefined;\r\n\t\tmidIXList.onItemClick = undefined;\r\n\t\tmidIXList.renderRight = undefined;\r\n\t\tthis.cIXList = new CIXList(midIXList);\r\n\t\tawait this.cIXList.start();\r\n\t}\r\n\r\n\tprivate onListRightClick = async () => {\r\n\t\tlet {uq, ID, IX, id} = this.midIX;\r\n\t\tlet midIXList = new MidIXSelectList(uq, ID, IX, id);\r\n\t\tmidIXList.renderItem = undefined;\r\n\t\tmidIXList.onSelectChange = this.onSelectChange;\r\n\t\tlet cSelect = new CIXSelect(midIXList);\r\n\t\tawait cSelect.start();\r\n\t}\r\n\r\n\tprivate onSelectChange = async (item:any, isSelected:boolean) => {\r\n\t\tlet param:any = {};\r\n\t\tlet {IX, id} = this.midIX;\r\n\t\tif (isSelected === false) {\r\n\t\t\t// id negtive means delete\r\n\t\t\tid = -id;\r\n\t\t}\r\n\t\tlet idItem = {ix:id, id: item.id};\r\n\t\tparam[IX.name] = [idItem];\r\n\t\t// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n\t\tlet ret = await this.midIX.uq.Acts(param);\r\n\t\tthis.cIXList.update(idItem);\r\n\t} \r\n}\r\n","import * as React from 'react';\r\nimport { observer } from 'mobx-react';\r\nimport { makeObservable, observable } from 'mobx';\r\nimport { ItemSchema, UiImageItem, UiItem } from '../schema';\r\nimport { ImageUploader } from '../resUploader';\r\nimport { nav } from '../nav';\r\nimport { ItemEdit } from './itemEdit';\r\nimport { Edit } from './edit';\r\n\r\nexport class ImageItemEdit extends ItemEdit {\r\n    get uiItem(): UiImageItem {return this._uiItem as UiImageItem}\r\n\tresId: string = null;\r\n\t\r\n\tconstructor(edit:Edit, itemSchema: ItemSchema, uiItem:UiItem, label:string|JSX.Element, value: any) {\r\n\t\tsuper(edit, itemSchema, uiItem, label, value);\r\n\t\tmakeObservable(this, {\r\n\t\t\tresId: observable\r\n\t\t})\r\n\t}\r\n\r\n    protected async internalStart():Promise<any> {\r\n        this.resId = this.value;\r\n        return new Promise<any>((resolve, reject) => {\r\n            nav.push(React.createElement(this.page, {resolve:resolve, reject:reject}), ()=>reject());\r\n        });\r\n    }\r\n\r\n    /*\r\n    private upload = async () => {\r\n        if (!this.resUploader) return;\r\n        let ret = await this.resUploader.upload();\r\n        if (ret === null) {\r\n            this.overSize = true;\r\n            env.setTimeout('imageItemEdit upload', () => this.overSize = false, 3000);\r\n            return;\r\n        }\r\n        this.resId = ret;\r\n        this.isChanged = (this.resId !== this.value);\r\n    }\r\n    */\r\n\r\n    private page = observer((props:{resolve:(value:any)=>void, reject: (resean?:any)=>void}):JSX.Element => {\r\n        let {resolve} = props;\r\n        let size:any = this.uiItem && this.uiItem.size;\r\n\r\n        /*\r\n        let right = <button\r\n            className=\"btn btn-sm btn-success align-self-center\"\r\n            disabled={!this.isChanged}\r\n            onClick={()=>resolve(this.resId)}>保存</button>;\r\n        let overSize:any;\r\n        if (this.overSize === true) {\r\n            overSize = <div className=\"text-danger\">\r\n                <i className=\"fa fa-times-circle\" /> 图片文件大小超过2M，无法上传\r\n            </div>;\r\n        }\r\n        */\r\n        return <ImageUploader \r\n            label={'更改' + this.label}\r\n            id={this.resId}\r\n            size={size}\r\n            onSaved={(resId):Promise<void>=>{resolve(resId); return;}} />;\r\n        /*\r\n        return <Page header={'更改' + this.label} right={right}>\r\n            <div className=\"my-3 px-3 py-3 bg-white\">\r\n                <div>\r\n                    <div>上传图片：</div>\r\n                    <div className=\"my-3\">\r\n                        <ResUploader ref={v=>this.resUploader=v} multiple={false} maxSize={2048} />\r\n                    </div>\r\n                    <div>\r\n                        <button className=\"btn btn-primary\" onClick={this.upload}>上传</button>\r\n                    </div>\r\n                </div>\r\n                {overSize}\r\n                <div className=\"small muted my-4\">支持JPG、GIF、PNG格式图片，不超过2M。</div>\r\n                <div className=\"d-flex\">\r\n                    <div className=\"w-12c h-12c mr-4\"\r\n                        style={{border: '1px dotted gray', padding: '8px'}}>\r\n                        <Image className=\"w-100 h-100\" src={this.resId} />\r\n                    </div>\r\n                    <div>\r\n                        <div className=\"small\">图片预览</div>\r\n                        <Image className=\"w-4c h-4c mt-3\" src={this.resId} />\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </Page>;\r\n        */\r\n    })\r\n}\r\n","\r\nexport const mobileRegex = /^[0-9]*$/;\r\nexport const emailRegex = /\\w+([-+.]\\w+)*@\\w+([-.]\\w+)*\\.\\w+([-.]\\w+)*/;\r\n// /^([a-zA-Z0-9]+[_|\\_|\\.]?)*[a-zA-Z0-9]+@([a-zA-Z0-9]+[_|\\_|\\.]?)*[a-zA-Z0-9]+\\.[a-zA-Z]{2,3}$/\r\n\r\nexport const EmailFieldRule = (value:any): string|string[] => {\r\n    if (emailRegex.test(value as string) === false) return '电子邮件格式错误';\r\n}\r\n\r\nexport const MobileFieldRule = (value:any): string|string[] => {\r\n    if (emailRegex.test(value as string) === false) return '手机格式错误';\r\n}\r\n","import _ from 'lodash';\r\nimport {observable, IObservableArray, computed, makeObservable, runInAction} from 'mobx';\r\n\r\nexport abstract class PageItems<T> {\r\n    loading: boolean = false;\r\n    beforeLoad: boolean = true;\r\n    loaded: boolean = false;\r\n    _items:IObservableArray<T> = null;\r\n    allLoaded: boolean = false;\r\n    get items():IObservableArray<T> {\r\n        if (this.beforeLoad === true) return null;\r\n        if (this.loaded === false) return undefined;\r\n        return this._items;\r\n\t}\r\n    topDiv:string = '$$top';\r\n\tbottomDiv:string = '$$bottom';\r\n\r\n    constructor(itemObservable:boolean = false) {\r\n\t\tmakeObservable(this, {\r\n\t\t\tloading: observable,\r\n\t\t\tbeforeLoad: observable,\r\n\t\t\tloaded: observable,\r\n\t\t\t_items: observable,\r\n\t\t\tallLoaded: observable,\r\n\t\t\titems: computed,\r\n\t\t\ttopDiv: observable,\r\n\t\t\tbottomDiv: observable,\r\n\t\t});\r\n\t\tif (itemObservable === undefined) itemObservable = false;\r\n        this._items = observable.array<T>([], {deep:itemObservable});\r\n    }\r\n\tprivate isFirst: boolean = true;\r\n\tprivate pageItemAction: (item:T, results:{[name:string]:any[]}) => void;\r\n\tprivate itemConverter: (item:any, queryResults:{[name:string]:any[]}) => T;\r\n\t\t\r\n\tsetEachPageItem(pageItemAction: (item:T, results:{[name:string]:any[]}) => void) {\r\n\t\tthis.pageItemAction = pageItemAction;\r\n\t}\r\n\r\n\tsetItemConverter(itemConverter: (item:any, queryResults:{[name:string]:any[]}) => T) {\r\n\t\tthis.itemConverter = itemConverter;\r\n\t}\r\n\r\n    scrollToTop = () => {\r\n\t\tthis.scrollIntoView(this.topDiv);\r\n\t\t//let id = '$$top'+uid();\r\n\t\t//this.topDiv = id;\r\n\t\t/*\r\n\t\tsetTimeout(() => {\r\n\t\t\tlet div = document.getElementById(this.topDiv);\r\n\t\t\tdiv?.scrollIntoView();\r\n\t\t}, 20);\r\n\t\t*/\r\n    }\r\n    scrollToBottom = () => {\r\n\t\tthis.scrollIntoView(this.bottomDiv);\r\n\t\t//let id = '$$bottom'+uid();\r\n\t\t//this.bottomDiv = id;\r\n\t\t/*\r\n\t\tsetTimeout(() => {\r\n\t\t\tlet div = document.getElementById(this.bottomDiv);\r\n\t\t\tdiv?.scrollIntoView();\r\n\t\t}, 20);\r\n\t\t*/\r\n\t}\r\n\tprivate scrollIntoView(divId:string) {\r\n\t\tsetTimeout(() => {\r\n\t\t\tlet div = document.getElementById(divId);\r\n\t\t\tdiv?.scrollIntoView();\r\n\t\t}, 20);\r\n\t}\r\n\r\n    protected param: any;\r\n    protected firstSize = 100;\r\n    protected pageStart:any = undefined;\r\n    protected pageSize = 30;\r\n    protected appendPosition:'head'|'tail' = 'tail';\r\n\r\n\tprotected sortOrder:'asc'|'desc';\r\n\tprotected abstract loadResults(param:any, pageStart:any, pageSize:number):Promise<{[name:string]:any[]}>;\r\n\tprotected getPageId(item:T):any {return;}\r\n\tprotected setPageStart(item:T) {\r\n\t\tthis.pageStart = this.getPageId(item);\r\n\t}\r\n\t\r\n\tprotected async load(param:any, pageStart:any, pageSize:number):Promise<any[]> {\r\n\t\tlet results = await this.loadResults(param, pageStart, pageSize);\r\n\t\tlet pageList = results.$page;\r\n\t\tif (this.itemConverter) {\r\n\t\t\tlet ret:T[] = [];\r\n\t\t\tlet len = pageList.length;\r\n\t\t\tfor (let i=0; i<len; i++) {\r\n\t\t\t\tlet item = this.itemConverter(pageList[i], results);\r\n\t\t\t\tret.push(item);\r\n\t\t\t}\r\n\t\t\treturn ret;\r\n\t\t}\r\n\t\tif (this.pageItemAction !== undefined) {\r\n\t\t\tlet len = pageList.length;\r\n\t\t\tfor (let i=0; i<len; i++) {\r\n\t\t\t\tthis.pageItemAction(pageList[i], results);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn pageList;\r\n\t}\r\n\r\n    reset() {\r\n\t\trunInAction(() => {\r\n\t\t\tthis.isFirst = true;\r\n\t\t\tthis.beforeLoad = true;\r\n\t\t\tthis.loaded = false;\r\n\t\t\tthis.param = undefined;\r\n\t\t\tthis.allLoaded = false;\r\n\t\t\tthis.pageStart = undefined;\r\n\t\t\tthis._items.clear();\r\n\t\t\t//this.setPageStart(undefined);\r\n\t\t});\r\n    }\r\n\r\n    append(item:T) {\r\n        if (this.appendPosition === 'tail')\r\n            this._items.unshift(item);\r\n        else\r\n            this._items.push(item);\r\n    }\r\n\r\n    async first(param:any):Promise<void> {\r\n        this.reset();\r\n        this.beforeLoad = false;\r\n        this.param = param;\r\n        await this.more();\r\n\t}\r\n\r\n\tprivate changing = false;\r\n\tasync attach(): Promise<void> {\r\n\t\tif (this.sortOrder === undefined) {\r\n\t\t\tconsole.error('没有定义增减序，无法attach');\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (this.changing === true) return;\r\n\t\tthis.changing = true;\r\n\t\tlet items = this._items;\r\n\t\tlet isAsc = this.sortOrder === 'asc';\r\n\t\t//let isTail:boolean, \r\n\t\tlet endItem:T;\r\n\t\tlet scrollToEnd:() => void;\r\n\t\tlet pushItem:(item:T) => void;\r\n\t\tif (this.appendPosition === 'tail') {\r\n\t\t\t//isTail = true;\r\n\t\t\tendItem = items[0];\r\n\t\t\tscrollToEnd = this.scrollToTop;\r\n\t\t\tpushItem = (item:T) => items.unshift(item);\r\n\r\n\t\t}\r\n\t\telse {\r\n\t\t\t//isTail = false;\r\n\t\t\tlet endIndex = items.length;\r\n\t\t\tendItem = items[endIndex-1];\r\n\t\t\tscrollToEnd = this.scrollToBottom;\r\n\t\t\tpushItem = (item:T) => items.splice(endIndex, 0, item);\r\n\t\t}\r\n\t\tlet startId = this.getPageId(endItem);\r\n\t\tlet pid = undefined;\r\n\t\tlet sum = 0, max = 50;\r\n\t\tfor (;sum < max;) {\r\n\t\t\tlet ret = await this.load(this.param, pid, 3);\r\n\t\t\tlet len = ret.length;\r\n\t\t\tif (len === 0) break;\r\n\r\n\t\t\tfor (let i=0; i<len; i++) {\r\n\t\t\t\tlet item = ret[i];\r\n\t\t\t\tpid = this.getPageId(item);\r\n\t\t\t\tif (isAsc === true) {\r\n\t\t\t\t\tif (pid >= startId) {\r\n\t\t\t\t\t\tmax = 0;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tif (pid <= startId) {\r\n\t\t\t\t\t\tmax = 0;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tpushItem(item);\r\n\t\t\t\t/*\r\n\t\t\t\tif (isTail === true) {\r\n\t\t\t\t\tthis._items.unshift(item);\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tthis._items.push(item);\r\n\t\t\t\t}\r\n\t\t\t\t*/\r\n\t\t\t\t++sum;\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.changing = false;\r\n\t\tif (sum > 0) {\r\n\t\t\tscrollToEnd();\r\n\t\t\t/*\r\n\t\t\tif (isTail === true) this.scrollToTop();\r\n\t\t\telse this.scrollToBottom();\r\n\t\t\t*/\r\n\t\t}\r\n\t}\r\n\r\n\tasync refresh(): Promise<void> {\r\n\t\tif (this.changing === true) return;\r\n\t\tthis.changing = true;\r\n\t\tlet ret = await this.load(this.param, undefined, this.firstSize>this.pageSize? this.firstSize:this.pageSize);\r\n\t\tthis._items.clear();\r\n\t\tthis.setLoaded(ret);\r\n\t\t/*\r\n\t\tfor (let i=0; i<len; i++) {\r\n\t\t\tlet item = ret[i];\r\n\t\t\tlet pid = this.getRefreshPageId(item);\r\n\t\t\tlet index = this._items.findIndex(v => this.getRefreshPageId(v) === pid);\r\n\t\t\t//let index = _.sortedIndexBy(this._items, item, v=>this.getRefreshPageId(v));\r\n\t\t\t//let oldItem = this._items[index];\r\n\t\t\t//let oid = this.getRefreshPageId(oldItem);\r\n\t\t\tif (index >= 0) {\r\n\t\t\t\t_.merge(this._items[index], item);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tthis._items.splice(0, 0, item);\r\n\t\t\t}\r\n\t\t}\r\n\t\t*/\r\n\t\tthis.changing = false;\r\n\t}\r\n\r\n\tprotected getRefreshPageId(item:T) {\r\n\t\treturn this.getPageId(item);\r\n\t}\r\n\r\n    protected async onLoad(): Promise<void> {}\r\n    protected async onLoaded(): Promise<void> {}\r\n\r\n    async more():Promise<boolean> {\r\n        if (this.allLoaded === true) return false;\r\n\t\tif (this.loading === true) return true;\r\n\t\tif (this.changing === true) return true;\r\n\t\trunInAction(() => {\r\n\t\t\tthis.loading = true;\r\n\t\t\tthis.changing = true;\r\n\t\t});\r\n        await this.onLoad();\r\n        if (this.pageStart === undefined) this.setPageStart(undefined);\r\n        let pageSize = this.pageSize + 1;\r\n        if (this.isFirst === true) {\r\n            if (this.firstSize > this.pageSize) pageSize = this.firstSize+1;\r\n        }\r\n        let ret = await this.load(\r\n                this.param, \r\n                this.pageStart,\r\n\t\t\t\tpageSize);\r\n\t\tlet len = ret.length;\r\n\t\tlet allLoaded:boolean;\r\n        if ((this.isFirst===true && len>this.firstSize) ||\r\n            (this.isFirst===false && len>this.pageSize))\r\n        {\r\n            allLoaded = false;\r\n            --len;\r\n            ret.splice(len, 1);\r\n        }\r\n        else {\r\n            allLoaded = true;\r\n\t\t}\r\n\t\tthis.setLoaded(ret);\r\n\t\tthis.onLoaded();\r\n\t\trunInAction(() => {\r\n\t\t\tthis.loaded = true;\r\n\t\t\tthis.allLoaded = allLoaded;\r\n\t\t\tthis.isFirst = false;\r\n\t\t\tthis.changing = false;\r\n\t\t\tthis.loading = false;\r\n\t\t});\r\n\t\treturn !this.allLoaded;\r\n\t}\r\n\t\r\n\tprivate setLoaded(data:any[]) {\r\n\t\tlet len = data.length;\r\n        if (len === 0) {\r\n\t\t\tthis.setPageStart(undefined);\r\n            this._items.clear();\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.setPageStart(data[len-1]);\r\n\t\t\tif (this.appendPosition === 'tail') {\r\n\t\t\t\tthis._items.push(...data);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tthis._items.unshift(...data.reverse());\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tfindItem(item:any):T {\r\n\t\tlet pid = this.getPageId(item);\r\n\t\tlet index = _.findIndex(this._items, v => this.getPageId(v) === pid);\r\n\t\tif (index < 0) return;\r\n\t\treturn this._items[index];\r\n\t\t//let oldItem = this._items[index];\r\n\t\t//let oid = this.getPageId(oldItem);\r\n\t\t//if (pid === oid) return oldItem;\r\n\t}\r\n}\r\n","const digits = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz';\r\nconst c0 = digits.charCodeAt(0);\r\nconst c9 = digits.charCodeAt(9);\r\nconst A = digits.charCodeAt(10);\r\nconst Z = digits.charCodeAt(35);\r\nconst a = digits.charCodeAt(36);\r\nconst z = digits.charCodeAt(61);\r\nexport function from62(v:string):number {\r\n\tif (v === null) return null;\r\n\tif (v === undefined) return undefined;\r\n\tif (typeof v !== 'string') return Number.NaN;\r\n\tlet len = v.length;\r\n\tif (len === 0) return Number.NaN;\r\n\tlet ret = 0;\r\n\tfor (let i=0; i<len; i++) {\r\n\t\tlet c = v.charCodeAt(i);\r\n\t\tlet n:number;\r\n\t\tif (c < c0) return Number.NaN;\r\n\t\tif (c <= c9) {\r\n\t\t\tn = c - c0;\r\n\t\t}\r\n\t\telse if (c < A) {\r\n\t\t\treturn Number.NaN;\r\n\t\t} \r\n\t\telse if (c <= Z) {\r\n\t\t\tn = c - A + 10;\r\n\t\t}\r\n\t\telse if (c < a) {\r\n\t\t\treturn Number.NaN;\r\n\t\t}\r\n\t\telse if (c <= z) {\r\n\t\t\tn = c - a + 36;\r\n\t\t}\r\n\t\telse {\r\n\t\t\treturn Number.NaN;\r\n\t\t}\r\n\t\tret *= 62;\r\n\t\tret += n;\r\n\t}\r\n\treturn ret;\r\n}\r\n\r\nexport function to62(v:number):string {\r\n\tif (v === null) return null;\r\n\tif (v === undefined) return undefined;\r\n\tif (typeof v !== 'number') return '';\r\n\tif (v < 0) return '';\r\n\tlet ret = '';\r\n\tfor (;;) {\r\n\t\tret = digits[v % 62] + ret;\r\n\t\tv = Math.floor(v / 62);\r\n\t\tif (v === 0) break;\r\n\t}\r\n\treturn ret;\r\n}\r\n","class MessageHub {\r\n    private handlerSeed = 1;\r\n    private anyHandlers:{[id:number]:(msg:any)=>Promise<void>} = {};\r\n    private msgHandlers:{[id:number]:{type:string, handler:(msg:any)=>Promise<void>}} = {};\r\n\tregisterReceiveHandler(handler:(msg:any)=>Promise<void>):number;\r\n\tregisterReceiveHandler(type:string, handler:(msg:any)=>Promise<void>):number;\t\r\n    registerReceiveHandler(...args:any[]):number {\r\n\t\tlet seed = this.handlerSeed++;\r\n\t\tlet args0 = args[0];\r\n\t\tlet handler:(msg:any)=>Promise<void>;\r\n\t\tswitch (typeof args0) {\r\n\t\t\tcase 'string':\r\n\t\t\t\thandler = args[1];\r\n\t\t\t\tthis.msgHandlers[seed] = {type:args0, handler};\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'function':\r\n\t\t\t\tthis.anyHandlers[seed] = args0;\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\treturn seed;\r\n    }\r\n    unregisterReceiveHandler(handlerId:number) {\r\n        delete this.anyHandlers[handlerId];\r\n        delete this.msgHandlers[handlerId];\r\n    }\r\n    async dispatch(msg:any) {\r\n        let {$type} = msg;\r\n        for (let i in this.anyHandlers) {\r\n            await this.anyHandlers[i](msg);\r\n        }\r\n        for (let i in this.msgHandlers) {\r\n            let {type, handler} = this.msgHandlers[i];\r\n            if (type !== $type) continue;\r\n            await handler(msg);\r\n        }\r\n    }\r\n}\r\n\r\nexport const messageHub = new MessageHub();\r\n","// typescript version of krasimir/navigo\r\n\r\nexport type RouteFunc = (params?:string|{[name:string]:string}, query?:string) => void;\r\n\r\nexport interface NamedRoute {\r\n\tas: string;\r\n\tuses: RouteFunc;\r\n\thooks?: Hooks;\r\n}\r\nexport interface Hooks {\r\n\tbefore: (done:()=>void, params:object) => void;\r\n\tafter: (params:object) => void;\r\n\tleave: (params:object) => void;\r\n\talready: (params:object) => void;\r\n}\r\ninterface Handler {\r\n\thandler: RouteFunc;\r\n\thooks: Hooks;\r\n}\r\ninterface LastResolved {\r\n\turl: string;\r\n\tquery: string;\r\n\thooks: Hooks;\r\n\tparams?: {[name:string]:string};\r\n\tname?: string;\r\n}\r\ninterface Route {\r\n\troute: string|RegExp;\r\n\thandler: RouteFunc,\r\n\tname: string,\r\n\thooks: Hooks\r\n}\r\n\r\nexport class Navigo {\r\n\tprivate static PARAMETER_REGEXP = /([:*])(\\w+)/g;\r\n\tprivate static WILDCARD_REGEXP = /\\*/g;\r\n\tprivate static REPLACE_VARIABLE_REGEXP = '([^\\\\/]+)';   \t// 单\\，编译错误 ([^\\/]+)\r\n\tprivate static REPLACE_WILDCARD = `(?:.*)`;\r\n\tprivate static FOLLOWED_BY_SLASH_REGEXP = '(?:\\\\/$|$)';\t\t// 单\\，编译错误 (?:\\/$|$)\r\n\tprivate static MATCH_REGEXP_FLAGS = '';\r\n\r\n\tprivate static isPushStateAvailable() {\r\n\t\treturn !!(\r\n\t\t  typeof window !== 'undefined' &&\r\n\t\t  window.history &&\r\n\t\t  window.history.pushState\r\n\t\t);\r\n\t}\r\n\t\r\n\tprivate static clean(s:string|RegExp) {\r\n\t\tif (s instanceof RegExp) return s;\r\n\t\treturn Navigo.cleanUrl(s);\r\n\t}\r\n\tprivate static cleanUrl(s:string) {\r\n\t\treturn s.replace(/\\/+$/, '').replace(/^\\/+/, '^/');\r\n\t}\r\n\r\n\tprivate static regExpResultToParams(match:any[], names:string[]) {\r\n\t\tif (names.length === 0) return null;\r\n\t\tif (!match) return null;\r\n\t\treturn match\r\n\t\t  .slice(1, match.length)\r\n\t\t  .reduce((params, value, index) => {\r\n\t\t\t\tif (params === null) params = {};\r\n\t\t\t\tparams[names[index]] = decodeURIComponent(value);\r\n\t\t\t\treturn params;\r\n\t\t  }, null);\r\n\t}\r\n\t  \r\n\tprivate static replaceDynamicURLParts(route:string|RegExp) {\r\n\t\tlet paramNames:string[] = [], regexp:RegExp;\r\n\t  \r\n\t\tif (route instanceof RegExp) {\r\n\t\t\tregexp = route;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tregexp = new RegExp(\r\n\t\t\t\troute.replace(Navigo.PARAMETER_REGEXP, function (full, dots, name) {\r\n\t\t\t\t\t\tparamNames.push(name);\r\n\t\t\t\t\t\treturn Navigo.REPLACE_VARIABLE_REGEXP;\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.replace(Navigo.WILDCARD_REGEXP, Navigo.REPLACE_WILDCARD) + Navigo.FOLLOWED_BY_SLASH_REGEXP\r\n\t\t\t\t, Navigo.MATCH_REGEXP_FLAGS);\r\n\t\t}\r\n\t\treturn { regexp, paramNames };\r\n\t}\r\n\t  \r\n\tprivate static getUrlDepth(url:string):number {\r\n\t\treturn url.replace(/\\/$/, '').split('/').length;\r\n\t}\r\n\t  \r\n\tprivate static compareUrlDepth(urlA:string, urlB:string) {\r\n\t\treturn Navigo.getUrlDepth(urlB) - Navigo.getUrlDepth(urlA);\r\n\t}\r\n\t  \r\n\tprivate static findMatchedRoutes(url:string, routes:Route[] = []) {\r\n\t\treturn routes.map(route => {\r\n\t\t\tlet { regexp, paramNames } = Navigo.replaceDynamicURLParts(Navigo.clean(route.route));\r\n\t\t\tlet match = url.replace(/^\\/+/, '/').match(regexp);\r\n\t\t\tlet params = Navigo.regExpResultToParams(match, paramNames);\r\n\t\t\treturn match ? { match, route, params } : false;\r\n\t\t}).filter(m => m);\r\n\t}\r\n\t  \r\n\tprivate static match(url:string, routes:Route[]) {\r\n\t\treturn Navigo.findMatchedRoutes(url, routes)[0] || false;\r\n\t}\r\n\t  \r\n\tprivate static root(url:string, routes:Route[]) {\r\n\t\tconst colonExp = RegExp('\\\\/:\\\\D(\\\\w*)', 'g');\r\n\t\tconst exp = ''; // '($|\\\\/)';  // 单\\，编译报错 ($|\\/)\r\n\t\tlet matched = routes.map(\r\n\t\t\troute => {\r\n\t\t\t\tlet r = route.route;\r\n\t\t\t\tif (r === '' || r === '*') return url;\r\n\t\t\t\tif (typeof r === 'string') {\r\n\t\t\t\t\tr = r.replace(colonExp, '\\\\/\\\\w+');\r\n\t\t\t\t}\r\n\t\t\t\tlet routeExp = r + exp;\r\n\t\t\t\tlet ret = url.split(new RegExp(routeExp))[0];\r\n\t\t\t\treturn ret;\r\n\t\t\t}\r\n\t\t);\r\n\t\tlet fallbackURL = Navigo.cleanUrl(url);\r\n\t\tlet len = matched.length;\r\n\t\tif (len === 0) return fallbackURL;\r\n\t\tlet matched0 = matched[0];\r\n\t\tif (len === 1) return matched0;\r\n\t\treturn matched.reduce((result, url) => {\r\n\t\t\tif (result.length > url.length) result = url;\r\n\t\t\treturn result;\r\n\t\t}, matched0);\r\n\t}\r\n\t  \r\n\tprivate static isHashChangeAPIAvailable() {\r\n\t\treturn typeof window !== 'undefined' && 'onhashchange' in window;\r\n\t}\r\n\t  \r\n\tprivate static extractGETParameters(url:string):string {\r\n\t\treturn url.split(/\\?(.*)?$/).slice(1).join('');\r\n\t}\r\n\t  \r\n\tprivate static getOnlyURL(url:string, useHash:boolean, hash:string) {\r\n\t\tlet onlyURL = url, split:string[];\r\n\t\tvar cleanGETParam = (str:string) => str.split(/\\?(.*)?$/)[0];\r\n\t  \r\n\t\tif (typeof hash === 'undefined') {\r\n\t\t\t// To preserve BC\r\n\t\t\thash = '#';\r\n\t\t}\r\n\t  \r\n\t\tif (Navigo.isPushStateAvailable() && !useHash) {\r\n\t\t  \tonlyURL = cleanGETParam(url).split(hash)[0];\r\n\t\t}\r\n\t\telse {\r\n\t\t\tsplit = url.split(hash);\r\n\t\t\tonlyURL = split.length > 1 ? cleanGETParam(split[1]) : cleanGETParam(split[0]);\r\n\t\t}\r\n\t\treturn onlyURL;\r\n\t}\r\n\t  \r\n\tprivate static manageHooks(handler:RouteFunc, hooks:Hooks, params?:any, exHooks?:Hooks) {\r\n\t\tif (hooks && typeof hooks === 'object') {\r\n\t\t\tif (hooks.before) {\r\n\t\t\t\thooks.before((shouldRoute = true) => {\r\n\t\t\t\tif (!shouldRoute) return;\r\n\t\t\t\thandler();\r\n\t\t\t\thooks.after && hooks.after(params);\r\n\t\t\t\t}, params);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\telse if (hooks.after) {\r\n\t\t\t\thandler();\r\n\t\t\t\thooks.after && hooks.after(params);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\t\thandler();\r\n\t}\r\n\t  \r\n\tprivate static isHashedRoot(url:string, useHash:boolean, hash:string) {\r\n\t\tif (Navigo.isPushStateAvailable() && !useHash) {\r\n\t\t  return false;\r\n\t\t}\r\n\t  \r\n\t\tif (!url.match(hash)) {\r\n\t\t  return false;\r\n\t\t}\r\n\t  \r\n\t\tlet split = url.split(hash);\r\n\t  \r\n\t\treturn split.length < 2 || split[1] === '';\r\n\t}\r\n\t\r\n\tprivate root:string;\r\n\tprivate _routes:Route[] = [];\r\n\tprivate _useHash:boolean;\r\n\tprivate _hash:string;\r\n\tprivate _paused:boolean;\r\n\tprivate _destroyed:boolean;\r\n\tprivate _lastRouteResolved:LastResolved;\r\n\tprivate _notFoundHandler:Handler;\r\n\tprivate _defaultHandler:Handler;\r\n\tprivate _usePushState:boolean;\r\n\tprivate _genericHooks:Hooks;\r\n\tprivate _historyUpdateMethod: 'pushState' | 'replaceState'; // HistoryUpdateMethod;\r\n\tprivate timout: any; //NodeJS.Timeout;\r\n\r\n\tconstructor(r:string = null, useHash:boolean = false, hash:string = '#') {\r\n\t\tthis.root = null;\r\n\t\tthis._useHash = useHash;\r\n\t\tthis._hash = (!hash)? '#' : hash;\r\n\t\tthis._paused = false;\r\n\t\tthis._destroyed = false;\r\n\t\tthis._lastRouteResolved = null;\r\n\t\tthis._notFoundHandler = null;\r\n\t\tthis._defaultHandler = null;\r\n\t\tthis._usePushState = !useHash && Navigo.isPushStateAvailable();\r\n\t\t//this._onLocationChange = this._onLocationChange.bind(this);\r\n\t\tthis._genericHooks = null;\r\n\t\tthis._historyUpdateMethod = 'pushState';\r\n\t\r\n\t\tif (r) {\r\n\t\t\tthis.root = useHash ? r.replace(/\\/$/, '/' + this._hash) : r.replace(/\\/$/, '');\r\n\t\t} else if (useHash) {\r\n\t\t\tthis.root = this._cLoc().split(this._hash)[0].replace(/\\/$/, '/' + this._hash);\r\n\t\t}\r\n\t\r\n\t\tthis._listen();\r\n\t\tthis.updatePageLinks();\r\n\t}\r\n  \r\n\tnavigate(path:string, absolute:boolean = false):Navigo {\r\n\t\tlet to:string;\r\n\t\tpath = path || '';\r\n\t\tif (this._usePushState) {\r\n\t\t\tto = (!absolute ? this._getRoot() + '/' : '') + path.replace(/^\\/+/, '/');\r\n\t\t\tto = to.replace(/([^:])(\\/{2,})/g, '$1/');\r\n\t\t\tthis._historyUpdate({}, '', to);\r\n\t\t\tthis.resolve();\r\n\t\t}\r\n\t\telse if (typeof window !== 'undefined') {\r\n\t\t\tpath = path.replace(new RegExp('^' + this._hash), '');\r\n\t\t\tlet {location} = window;\r\n\t\t\tlocation.href = location.href\r\n\t\t\t\t.replace(/#$/, '')\r\n\t\t\t\t.replace(new RegExp(this._hash + '.*$'), '') + this._hash + path;\r\n\t\t}\r\n\t\treturn this;\r\n\t}\r\n\r\n\ton(routeFunc:RouteFunc, hooks?:Hooks):Navigo;\r\n\ton(url:string, routeFunc:RouteFunc, hooks?:Hooks):Navigo;\r\n\ton(regex:RegExp, routeFunc:RouteFunc, hooks?:Hooks):Navigo;\r\n\ton(options: {[url:string]: RouteFunc|NamedRoute}):Navigo;\r\n\ton(...args:any[]):Navigo {\r\n\t\tlet arg0 = args[0];\r\n\t\tlet arg1 = args[1];\r\n\t\tswitch (typeof arg0) {\r\n\t\t\tcase 'function':\r\n\t\t\t\tthis._defaultHandler = { handler: arg0, hooks: arg1 };\r\n\t\t\t\tif (!this._notFoundHandler) {\r\n\t\t\t\t\tthis._notFoundHandler = this._defaultHandler;\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'object':\r\n\t\t\t\tlet orderedRoutes = Object.keys(arg0).sort(Navigo.compareUrlDepth);\r\n\t\t\t\torderedRoutes.forEach(route => this.on(route, arg0[route]));\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tif (args.length < 2) break;\r\n\t\t\t\tif (arg0 === '/') {\r\n\t\t\t\t\tthis._defaultHandler = { \r\n\t\t\t\t\t\thandler: typeof arg1 === 'object'? arg1.uses : arg1, \r\n\t\t\t\t\t\thooks: args[2],\r\n\t\t\t\t\t};\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tthis._add(arg0, arg1, args[2]);\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\treturn this;\r\n\t}\r\n\r\n\toff(handler:RouteFunc):Navigo {\r\n\t\tif (this._defaultHandler !== null && handler === this._defaultHandler.handler) {\r\n\t\t\tthis._defaultHandler = null;\r\n\t\t}\r\n\t\telse if (this._notFoundHandler !== null && handler === this._notFoundHandler.handler) {\r\n\t\t\tthis._notFoundHandler = null;\r\n\t\t}\r\n\t\tthis._routes = this._routes.reduce((result, r) => {\r\n\t\t\tif (r.handler !== handler) result.push(r);\r\n\t\t\treturn result;\r\n\t\t}, []);\r\n\t\treturn this;\r\n\t}\r\n\r\n\tnotFound(handler:RouteFunc, hooks:Hooks):Navigo {\r\n\t\tthis._notFoundHandler = { handler, hooks };\r\n\t\treturn this;\r\n\t}\r\n\r\n\tresolve(current?:string) {\r\n\t\tlet c = current || this._cLoc();\r\n\t\tlet root = this._getRoot();\r\n\t\tlet url = c.replace(root, '');\r\n\t\r\n\t\tif (this._useHash) {\r\n\t\t\tconst exp = '^\\\\/';  // 单\\，编译报错 ^\\/\r\n\t\t\turl = url.replace(new RegExp(exp + this._hash), '/');\r\n\t\t}\r\n\t\r\n\t\tlet GETParameters = Navigo.extractGETParameters(current || this._cLoc());\r\n\t\tlet onlyURL = Navigo.getOnlyURL(url, this._useHash, this._hash);\r\n\t\r\n\t\tif (this._paused) return false;\r\n\t\r\n\t\tif (\r\n\t\t\tthis._lastRouteResolved &&\r\n\t\t\tonlyURL === this._lastRouteResolved.url &&\r\n\t\t\tGETParameters === this._lastRouteResolved.query\r\n\t\t) {\r\n\t\t\tif (this._lastRouteResolved.hooks && this._lastRouteResolved.hooks.already) {\r\n\t\t\t\tthis._lastRouteResolved.hooks.already(this._lastRouteResolved.params);\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\r\n\t\tlet matched = Navigo.match(onlyURL, this._routes);\r\n\t\r\n\t\tlet manageHooks = (handler:Handler) => {\r\n\t\t\tNavigo.manageHooks(() => {\r\n\t\t\t\tNavigo.manageHooks(() => {\r\n\t\t\t\t\tthis._callLeave();\r\n\t\t\t\t\tthis._lastRouteResolved = {\r\n\t\t\t\t\t\turl: onlyURL,\r\n\t\t\t\t\t\tquery: GETParameters, \r\n\t\t\t\t\t\thooks: handler.hooks\r\n\t\t\t\t\t};\r\n\t\t\t\t\thandler.handler(GETParameters);\r\n\t\t\t\t}, handler.hooks);\r\n\t\t\t}, this._genericHooks);\r\n\t\t}\r\n\r\n\t\tif (matched === false) {\r\n\t\t\tif (this._defaultHandler && (\r\n\t\t\t\tonlyURL === '' ||\r\n\t\t\t\tonlyURL === '/' ||\r\n\t\t\t\tonlyURL === this._hash ||\r\n\t\t\t\tNavigo.isHashedRoot(onlyURL, this._useHash, this._hash)\r\n\t\t\t)) {\r\n\t\t\t\t/*\r\n\t\t\t\tNavigo.manageHooks(() => {\r\n\t\t\t\t\tNavigo.manageHooks(() => {\r\n\t\t\t\t\t\tthis._callLeave();\r\n\t\t\t\t\t\tthis._lastRouteResolved = {\r\n\t\t\t\t\t\t\turl: onlyURL,\r\n\t\t\t\t\t\t\tquery: GETParameters, \r\n\t\t\t\t\t\t\thooks: this._defaultHandler.hooks\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tthis._defaultHandler.handler(GETParameters);\r\n\t\t\t\t\t}, this._defaultHandler.hooks);\r\n\t\t\t\t}, this._genericHooks);\r\n\t\t\t\t*/\r\n\t\t\t\tmanageHooks(this._defaultHandler);\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\telse if (this._notFoundHandler) {\r\n\t\t\t\t/*\r\n\t\t\t\tNavigo.manageHooks(() => {\r\n\t\t\t\t\tNavigo.manageHooks(() => {\r\n\t\t\t\t\t\tthis._callLeave();\r\n\t\t\t\t\t\tthis._lastRouteResolved = {\r\n\t\t\t\t\t\t\turl: onlyURL,\r\n\t\t\t\t\t\t\tquery: GETParameters,\r\n\t\t\t\t\t\t\thooks: this._notFoundHandler.hooks\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tthis._notFoundHandler.handler(GETParameters);\r\n\t\t\t\t\t}, this._notFoundHandler.hooks);\r\n\t\t\t\t}, this._genericHooks);\r\n\t\t\t\t*/\r\n\t\t\t\tmanageHooks(this._notFoundHandler);\r\n\t\t\t}\r\n\t\t\treturn false;\t\r\n\t\t}\r\n\t\tlet m = matched;\r\n\t\tif (m) {\r\n\t\t\tthis._callLeave();\r\n\t\t\tthis._lastRouteResolved = {\r\n\t\t\t\turl: onlyURL,\r\n\t\t\t\tquery: GETParameters,\r\n\t\t\t\thooks: m.route.hooks,\r\n\t\t\t\tparams: m.params,\r\n\t\t\t\tname: m.route.name\r\n\t\t\t};\r\n\t\t\tlet handler = m.route.handler;\r\n\t\t\tNavigo.manageHooks(() => {\r\n\t\t\t\tNavigo.manageHooks(() => {\r\n\t\t\t\t\tm.route.route instanceof RegExp ?\r\n\t\t\t\t\thandler(...(m.match.slice(1, m.match.length))) :\r\n\t\t\t\t\thandler(m.params, GETParameters);\r\n\t\t\t\t}, m.route.hooks, m.params, this._genericHooks);\r\n\t\t\t}, this._genericHooks, m.params);\r\n\t\t\treturn m;\r\n\t\t}\r\n\t}\r\n\r\n\tdestroy() {\r\n\t\tthis._routes = [];\r\n\t\tthis._destroyed = true;\r\n\t\tthis._lastRouteResolved = null;\r\n\t\tthis._genericHooks = null;\r\n\t\tclearTimeout(this.timout);\r\n\t\tif (typeof window !== 'undefined') {\r\n\t\t\twindow.removeEventListener('popstate', this._onLocationChange);\r\n\t\t\twindow.removeEventListener('hashchange', this._onLocationChange);\r\n\t\t}\r\n\t}\r\n\r\n\tupdatePageLinks() {\r\n\t\t//var self = this;\r\n\t\tif (typeof document === 'undefined') return;\r\n\t\t\tthis._findLinks().forEach(link => {\r\n\t\t\tif (!link.hasListenerAttached) {\r\n\t\t\t\tlink.addEventListener('click', (e: React.MouseEvent<HTMLElement>) => {\r\n\t\t\t\t\tif((e.ctrlKey || e.metaKey) && e.currentTarget.tagName.toLowerCase() === 'a'){ return false; }\r\n\t\t\t\t\tvar location = this.getLinkPath(link);\r\n\t\t\r\n\t\t\t\t\tif (!this._destroyed) {\r\n\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\tthis.navigate(location.replace(/\\/+$/, '').replace(/^\\/+/, '/'));\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tlink.hasListenerAttached = true;\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tgenerate(name:string, data:any = {}) {\r\n\t\tlet result = this._routes.reduce((result, route) => {\r\n\t\t\tif (route.name === name) {\r\n\t\t\t\tresult = route.route.toString();\r\n\t\t\t\tfor (let key in data) {\r\n\t\t\t\t\tresult = result.replace(':' + key, data[key]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn result;\r\n\t\t}, '');\r\n\t\r\n\t\treturn this._useHash ? this._hash + result : result;\r\n\t}\r\n\r\n\tlink(path:string) {\r\n\t\treturn this._getRoot() + path;\r\n\t}\r\n\r\n\tpause(status:boolean = true) {\r\n\t\tthis._paused = status;\r\n\t\tif (status) {\r\n\t\t\tthis._historyUpdateMethod = 'replaceState';\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis._historyUpdateMethod = 'pushState';\r\n\t\t}\r\n\t}\r\n\r\n\tresume() {\r\n\t\tthis.pause(false);\r\n\t}\r\n\r\n\thistoryAPIUpdateMethod(value:'pushState' | 'replaceState') {\r\n\t\tif (typeof value === 'undefined') return this._historyUpdateMethod;\r\n\t\tthis._historyUpdateMethod = value;\r\n\t\treturn value;\r\n\t}\r\n\r\n\tdisableIfAPINotAvailable() {\r\n\t\tif (!Navigo.isPushStateAvailable()) {\r\n\t\t\tthis.destroy();\r\n\t\t}\r\n\t}\r\n\r\n\tlastRouteResolved() {\r\n\t\treturn this._lastRouteResolved;\r\n\t}\r\n\r\n\tgetLinkPath(link:any) {\r\n\t\treturn link.getAttribute('href');\r\n\t}\r\n\r\n\thooks(hooks:Hooks) {\r\n\t\tthis._genericHooks = hooks;\r\n\t}\r\n\r\n\tprivate _add(route:string|RegExp, handler:RouteFunc|NamedRoute, hooks:Hooks) {\r\n\t\tif (typeof route === 'string') {\r\n\t\t\troute = encodeURI(route);\r\n\t\t}\r\n\t\tthis._routes.push(\r\n\t\t\ttypeof handler === 'object' ?\r\n\t\t\t{\r\n\t\t\t\troute,\r\n\t\t\t\thandler: handler.uses,\r\n\t\t\t\tname: handler.as,\r\n\t\t\t\thooks: hooks || handler.hooks\r\n\t\t\t} \r\n\t\t\t:\r\n\t\t\t{\r\n\t\t\t\troute,\r\n\t\t\t\thandler, \r\n\t\t\t\tname: undefined,\r\n\t\t\t\thooks,\r\n\t\t\t}\r\n\t\t);\r\n\t\treturn this._add;\r\n\t}\r\n\r\n\tprivate _historyUpdate(data:any, title:string, url?:string) {\r\n\t\tswitch (this._historyUpdateMethod) {\r\n\t\t\tdefault: throw Error('unknow history method ' + this._historyUpdateMethod);\r\n\t\t\tcase 'pushState': window.history.pushState(data, title, url); return;\r\n\t\t\tcase 'replaceState': window.history.replaceState(data, title, url); return;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate _getRoot() {\r\n\t\tif (this.root !== null) return this.root;\r\n\t\tlet cLoc = this._cLoc();\r\n\t\tlet cLocRoot = cLoc.split('?')[0];\r\n\t\tthis.root = Navigo.root(cLocRoot, this._routes);\r\n\t\treturn this.root;\r\n\t}\r\n\r\n\tprivate _listen() {\r\n\t\tif (this._usePushState) {\r\n\t\t\twindow.addEventListener('popstate', this._onLocationChange);\r\n\t\t}\r\n\t\telse if (Navigo.isHashChangeAPIAvailable()) {\r\n\t\t\twindow.addEventListener('hashchange', this._onLocationChange);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tlet cached = this._cLoc();\r\n\t\r\n\t\t\tlet check = () => {\r\n\t\t\t\tlet current = this._cLoc();\r\n\t\t\t\tif (cached !== current) {\r\n\t\t\t\t\tcached = current;\r\n\t\t\t\t\tthis.resolve();\r\n\t\t\t\t}\r\n\t\t\t\tif (this.timout) clearTimeout(this.timout);\r\n\t\t\t\tthis.timout = setTimeout(check, 200);\r\n\t\t\t};\r\n\t\t\tcheck();\r\n\t\t}\r\n\t}\r\n\r\n\tprivate _cLoc() {\r\n\t\tif (typeof window !== 'undefined') {\r\n\t\t\t//if (typeof window.__NAVIGO_WINDOW_LOCATION_MOCK__ !== 'undefined') {\r\n\t\t\t//\treturn window.__NAVIGO_WINDOW_LOCATION_MOCK__;\r\n\t\t\t//}\r\n\t\t\treturn Navigo.cleanUrl(window.location.href);\r\n\t\t}\r\n\t\treturn '';\r\n\t}\r\n\r\n\tprivate _findLinks() {\r\n\t\treturn [].slice.call(document.querySelectorAll('[data-navigo]'));\r\n\t}\r\n\r\n\tprivate _onLocationChange = () => {\r\n\t\tconsole.log('_onLocationChange');\r\n\t\tthis.resolve();\r\n\t}\r\n\r\n\tprivate _callLeave() {\r\n\t\tconst lastRouteResolved = this._lastRouteResolved;\t\r\n\t\tif (lastRouteResolved) {\r\n\t\t\tlet {params, hooks} = lastRouteResolved;\r\n\t\t\tif (hooks) {\r\n\t\t\t\tif (hooks.leave) {\r\n\t\t\t\t\thooks.leave(params);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\n//export default Navigo;\r\nexport const navigo = new Navigo();\r\n","import * as React from 'react';\r\nimport {nav} from '../nav';\r\n\r\nexport interface PageHeaderProps {\r\n    back?: 'back' | 'close' | 'none';\r\n    center: string | JSX.Element;\r\n    right?: JSX.Element;\r\n    logout?: boolean | (()=>Promise<void>);\r\n    className?: string;\r\n\tafterBack?: () => void;\r\n\tex?: JSX.Element;\r\n}\r\n\r\nexport function renderPageHeader(props: PageHeaderProps, inWebNav?: boolean) {\r\n    let onBack = async () => {\r\n        await nav.back(); // 这个才会显示confirm box，在dataForm里面，如果输入了数据的话\r\n\t\tlet {afterBack} = props;\r\n\t\tif (afterBack) afterBack();\r\n    }\r\n    let onLogoutClick = () => {\r\n\t\tlet logout = async () => {\r\n\t\t\tlet {logout} = props;\r\n\t\t\tif (typeof logout === 'function') {\r\n\t\t\t\tawait logout(); \r\n\t\t\t}\r\n\t\t\tawait nav.logout(undefined);\r\n\t\t}\r\n\t\tnav.showLogout(logout);\r\n    }\r\n\r\n\tlet b = nav.level > 1 || window.self !== window.top;\r\n\tlet {back, right, center, logout, className, ex} = props;\r\n\tif (inWebNav === true &&  !back && !right && !center) return;\r\n\tlet vBack:any, debugLogout:any;\r\n\tif (logout !== undefined && window.self === window.top) {\r\n\t\tif ((typeof logout === 'boolean' && logout === true)\r\n\t\t\t|| typeof logout === 'function')\r\n\t\t{\r\n\t\t\tlet {user} = nav;\r\n\t\t\tif (user !== undefined) {\r\n\t\t\t\tlet {nick, name} = user;\r\n\t\t\t\tdebugLogout = <div className=\"d-flex align-items-center\">\r\n\t\t\t\t\t<small className=\"text-light\">{nick || name}</small>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t// eslint-disable-next-line\r\n\t\t\t\t\t\t<div className=\"ml-2 py-2 px-3 cursor-pointer\"\r\n\t\t\t\t\t\t\trole=\"button\"\r\n\t\t\t\t\t\t\tonClick={onLogoutClick}>\r\n\t\t\t\t\t\t\t<i className=\"fa fa-sign-out fa-lg\" />\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t}\r\n\t\t\t\t</div>;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tif (b) {\r\n\t\tswitch (props.back) {\r\n\t\t\tcase 'none':\r\n\t\t\t\tvBack = undefined;\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\tcase 'back':\r\n\t\t\t\tvBack = <nav onClick={onBack}>{nav.backIcon}</nav>;\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'close':\r\n\t\t\t\tvBack = <nav onClick={onBack}>{nav.closeIcon}</nav>;\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\tif (window.self !== window.top) {\r\n\t\tconsole.log(document.location.href);\r\n\t\t// pop = <header onClick={this.openWindow} className=\"mx-1\"><FA name=\"external-link\" /></header>;\r\n\t}\r\n\tif (vBack === undefined && typeof center === 'string') {\r\n\t\tcenter = <div className=\"px-3\">{center}</div>;\r\n\t}\r\n\tlet rightView = (right || debugLogout) && <aside>{right} {debugLogout}</aside>;\r\n\tlet header = <header className={className}>\r\n\t\t<nav>\r\n\t\t\t{vBack}\r\n\t\t\t{/*pop 弹出window暂时停止作用 */}\r\n\t\t\t<div>{center}</div>\r\n\t\t\t{rightView}\r\n\t\t</nav>\r\n\t\t{ex}\r\n\t</header>;\r\n\tif (inWebNav === true) return header;\r\n\treturn <>\r\n\t\t<section className=\"tv-page-header\">{header}</section>\r\n\t\t{header}\r\n\t</>;\r\n}\r\n\r\nexport class PageHeader extends React.Component<PageHeaderProps> {\r\n\trender() {return renderPageHeader(this.props)}\r\n\t/*\r\n    private back = async () => {\r\n        await nav.back(); // 这个才会显示confirm box，在dataForm里面，如果输入了数据的话\r\n\t\tlet {afterBack} = this.props;\r\n\t\tif (afterBack) afterBack();\r\n    }\r\n    openWindow() {\r\n        window.open(document.location.href);\r\n    }\r\n    private logoutClick = () => {\r\n        nav.showLogout(this.logout);\r\n    }\r\n    private logout = async () => {\r\n        let {logout} = this.props;\r\n        if (typeof logout === 'function') {\r\n            await logout(); \r\n        }\r\n        await nav.logout(undefined);\r\n    }\r\n    render() {\r\n        let b = nav.level > 1 || window.self !== window.top;\r\n        let {right, center, logout, className, ex} = this.props;\r\n        let back:any, debugLogout:any;\r\n        if (logout !== undefined && window.self === window.top) {\r\n            if ((typeof logout === 'boolean' && logout === true)\r\n                || typeof logout === 'function')\r\n            {\r\n                let {user} = nav;\r\n                if (user !== undefined) {\r\n                    let {nick, name} = user;\r\n                    debugLogout = <div className=\"d-flex align-items-center\">\r\n                        <small className=\"text-light\">{nick || name}</small>\r\n                        {\r\n                            // eslint-disable-next-line\r\n                            <div className=\"ml-2 py-2 px-3 cursor-pointer\"\r\n                                role=\"button\"\r\n                                onClick={this.logoutClick}>\r\n                                <i className=\"fa fa-sign-out fa-lg\" />\r\n                            </div>\r\n                        }\r\n                    </div>;\r\n                }\r\n            }\r\n        }\r\n        if (b) {\r\n            switch (this.props.back) {\r\n                case 'none':\r\n                    back = undefined;\r\n                    break;\r\n                default:\r\n                case 'back':\r\n                    back = <nav onClick={this.back}><i className=\"fa fa-angle-left\" /></nav>;\r\n                    break;\r\n                case 'close':\r\n                    back = <nav onClick={this.back}><i className=\"fa fa-close\" /></nav>;\r\n                    break;\r\n            }\r\n        }\r\n        if (window.self !== window.top) {\r\n            console.log(document.location.href);\r\n            // pop = <header onClick={this.openWindow} className=\"mx-1\"><FA name=\"external-link\" /></header>;\r\n        }\r\n        if (back === undefined && typeof center === 'string') {\r\n            center = <div className=\"px-3\">{center}</div>;\r\n        }\r\n\t\tlet rightView = (right || debugLogout) && <aside>{right} {debugLogout}</aside>;\r\n\t\tlet header = <header className={className}>\r\n\t\t\t<nav>\r\n\t\t\t\t{back}\r\n\t\t\t\t<div>{center}</div>\r\n\t\t\t\t{rightView}\r\n\t\t\t</nav>\r\n\t\t\t{ex}\r\n\t\t</header>;\r\n        return <>\r\n\t\t\t<section className=\"tv-page-header\">{header}</section>\r\n\t\t\t{header}\r\n\t\t</>;\r\n\t}\r\n\t*/\r\n}\r\n","import * as React from 'react';\r\nimport { makeObservable, observable, runInAction } from 'mobx';\r\nimport { observer } from 'mobx-react';\r\nimport classNames from 'classnames';\r\nimport { IVPage } from './page';\r\nimport { IObservableValue } from 'mobx';\r\nimport '../../css/va-tab.css';\r\nimport { ScrollView } from './scrollView';\r\n\r\nexport type TabCaption = (selected:boolean) => JSX.Element;\r\n\r\nexport interface TabProp {\r\n    name: string;\r\n    caption: TabCaption;\r\n\tcontent?: () => JSX.Element;\r\n\tpage?: IVPage;\r\n    notify?: IObservableValue<number>;\r\n    load?: () => Promise<void>;\r\n\tonShown?: () => Promise<void>;\r\n\tisSelected?: boolean;\r\n\tonScroll?: () => void;\r\n\tonScrollTop?: () => Promise<boolean>;\r\n\tonScrollBottom?: () => Promise<void>;\r\n\tclassName?: string;\r\n}\r\n\r\nexport interface TabsProps {\r\n    tabs: TabProp[];\r\n    tabPosition?: 'top' | 'bottom';\r\n    size?: 'sm' | 'lg' | 'md';\r\n    tabBg?: string;\r\n    contentBg?: string;\r\n    sep?: string;\r\n    selected?: string;\r\n    borderColor?: string;\r\n    borderWidth?: string;\r\n}\r\n\r\nclass Tab {\r\n\tloaded: boolean = false;\r\n\tselected: boolean = false;\r\n\t\r\n    name: string;\r\n    caption: TabCaption;\r\n\tcontentBuilder: ()=>JSX.Element;\r\n\tpage: IVPage;\r\n    notify: IObservableValue<number>;\r\n    load?: () => Promise<void>;\r\n\tonShown?: () => Promise<void>;\r\n\tonScroll?: () => void;\r\n\tonScrollTop?: () => Promise<boolean>;\r\n\tonScrollBottom?: () => Promise<void>;\r\n\tclassName?: string;\r\n\r\n\tprivate _content: JSX.Element;\r\n\t\r\n\tconstructor() {\r\n\t\tmakeObservable(this, {\r\n\t\t\tloaded: observable, \r\n\t\t\tselected: observable, \r\n\t\t});\r\n\t}\r\n    \r\n    get content(): JSX.Element {\r\n\t\tif (this.load && this.loaded === false) return null;\r\n\t\tif (this.selected === false) return this._content;\r\n\t\tif (!this._content) {\r\n\t\t\tif (this.contentBuilder !== undefined) {\r\n\t\t\t\tthis._content = this.contentBuilder();\r\n\t\t\t}\r\n\t\t\telse if (this.page !== undefined) {\r\n\t\t\t\tthis._content = this.page.content();\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tthis._content = <div className=\"p-5\">tab 应该定义content或者page</div>;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn this._content;\r\n    }\r\n\r\n    async shown() {\r\n        if (this.onShown !== undefined) {\r\n            await this.onShown();\r\n        }\r\n        if (this.load !== undefined) {\r\n\t\t\tif (this.loaded === false) {\r\n\t\t\t\tawait this.load();\r\n\t\t\t\trunInAction(() => {\r\n\t\t\t\t\tthis.loaded = true;\r\n\t\t\t\t});\r\n\t\t\t}\r\n        }\r\n    }\r\n}\r\n\r\nexport const TabCaptionComponent = (label:string|JSX.Element, icon:string, color:string) => <div \r\n    className={'d-flex justify-content-center align-items-center flex-column cursor-pointer ' + color}>\r\n    <div><i className={'fa fa-lg fa-' + icon} /></div>\r\n    <small>{label}</small>\r\n</div>;\r\n\r\n//export const TabCaption = TabCaptionComponent;\r\n\r\nexport class TabsView {\r\n\tprivate props: TabsProps;\r\n    private size: string;\r\n    private tabBg: string;\r\n    private sep: string;\r\n    selectedTab: Tab;\r\n    tabArr: Tab[];\r\n\r\n    constructor(props: TabsProps) {\r\n\t\tthis.props = props;\r\n\t\tlet {size, tabs, tabBg: tabBack, sep, selected} = props;\r\n\t\tthis.size = size || 'md';\r\n        this.tabArr = tabs.map(v => {\r\n            let tab = new Tab();\r\n            let {name, caption, content, page, notify, load, onShown, isSelected, onScroll, onScrollTop, onScrollBottom, className} = v;\r\n\t\t\ttab.name = name;\r\n\t\t\tif (isSelected === true || name === selected) {\r\n\t\t\t\tthis.selectedTab = tab;\r\n\t\t\t}\r\n\t\t\ttab.selected = false;\r\n\t\t\ttab.caption = caption;\r\n\t\t\tif (content !== undefined) {\r\n\t\t\t\ttab.contentBuilder = content;\r\n\t\t\t}\r\n\t\t\telse if (page !== undefined) {\r\n\t\t\t\ttab.page = page;\r\n\t\t\t\t//contentBuilder = () => {return page.content()};\r\n\t\t\t}\r\n            tab.notify = notify;\r\n            tab.load = load;\r\n\t\t\ttab.onShown = onShown;\r\n\t\t\ttab.onScroll = onScroll;\r\n\t\t\ttab.onScrollTop = onScrollTop;\r\n\t\t\ttab.onScrollBottom = onScrollBottom;\r\n\t\t\ttab.className = className;\r\n            return tab;\r\n        });\r\n        this.tabBg = tabBack;\r\n        //this.contentBg = contentBack;\r\n        this.sep = sep;\r\n        if (this.selectedTab === undefined) {\r\n\t\t\tthis.selectedTab = this.tabArr[0];\r\n\t\t}\r\n        this.selectedTab.selected = true;\r\n\t\tmakeObservable(this, {\r\n\t\t\tselectedTab: observable, \r\n\t\t\ttabArr: observable,\r\n\t\t});\r\n\t\tsetTimeout(() => {\r\n\t\t\tthis.tabClick(this.selectedTab);\r\n\t\t}, 100);\t\t\r\n    }\r\n\r\n    tabClick = async (tab:Tab) => {\r\n\t\tif (!tab) {\r\n\t\t\ttab = this.selectedTab;\r\n\t\t\tif (tab === undefined) {\r\n\t\t\t\tif (this.tabArr === undefined) return;\r\n\t\t\t\tif (this.tabArr.length === 0) return;\r\n\t\t\t\ttab = this.tabArr[0];\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\trunInAction(() => {\r\n\t\t\tthis.selectedTab.selected = false;\r\n\t\t\ttab.selected = true;\r\n\t\t\tthis.selectedTab = tab;\r\n\t\t});\r\n\t\t\r\n\t\tawait tab.shown();\r\n    }\r\n\r\n\tprivate tabs = observer(() => {\r\n        let {tabPosition, borderColor} = this.props;\r\n        let bsCur:React.CSSProperties, bsTab:React.CSSProperties\r\n        if (borderColor) {\r\n            bsCur = {\r\n                borderColor: borderColor,\r\n                borderStyle: 'solid',\r\n                borderTopWidth: 1,\r\n                borderLeftWidth: 1,\r\n                borderRightWidth: 1,\r\n                borderBottomWidth: 1,\r\n            }\r\n            bsTab = {\r\n                borderColor: borderColor,\r\n                borderStyle: 'solid',\r\n                borderTopWidth: 1,\r\n                borderBottomWidth: 1,\r\n                borderLeftWidth: 0,\r\n                borderRightWidth: 0,\r\n            }\r\n            if (tabPosition === 'top') {\r\n                bsCur.borderBottomWidth = 0;\r\n                bsCur.borderTopLeftRadius = 10;\r\n                bsCur.borderTopRightRadius = 10;\r\n                bsTab.borderTopWidth = 0;\r\n            }\r\n            else {\r\n                bsCur.borderTopWidth = 0;\r\n                bsCur.borderBottomLeftRadius = 10;\r\n                bsCur.borderBottomRightRadius = 10;\r\n                bsTab.borderBottomWidth = 0;\r\n            }\r\n        }\r\n\t\tlet cn = classNames('tv-tabs', this.tabBg, this.sep, 'tv-tabs-' + this.size);\r\n\t\tlet tabs = <div className={cn}>\r\n            {this.tabArr.map((v,index) => {\r\n                let {selected, caption, notify} = v;\r\n                let notifyCircle:any;\r\n                if (notify !== undefined) {\r\n                    let num = notify.get();\r\n                    if (num !== undefined) {\r\n                        if (num > 0) notifyCircle = <u>{num>99?'99+':num}</u>;\r\n                        else if (num < 0) notifyCircle = <u className=\"dot\" />;\r\n                    }\r\n                }\r\n                return <div key={index} onClick={()=>this.tabClick(v)} style={selected===true? bsCur:bsTab}>\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t{notifyCircle}\r\n\t\t\t\t\t{caption(selected)}\r\n\t\t\t\t\t</div>\r\n                </div>\r\n            })}\r\n\t\t</div>;\r\n\t\treturn tabs;\r\n\t});\r\n\r\n\tcontent = observer(() => {\r\n\t\tlet displayNone:React.CSSProperties = {visibility: 'hidden'};\r\n\t\treturn <>\r\n\t\t\t{this.tabArr.map((v,index) => {\r\n\t\t\t\tlet {tabPosition} = this.props;\r\n\t\t\t\tlet {content, page, onScroll, onScrollTop, onScrollBottom, className} = v;\r\n\t\t\t\tlet tabs = React.createElement(this.tabs);\r\n\t\t\t\tlet pageHeader:any, pageFooter:any;\r\n\t\t\t\tif (page !== undefined) {\r\n\t\t\t\t\tpageHeader = page.header();\r\n\t\t\t\t\tpageFooter = page.footer();\r\n\t\t\t\t}\r\n\t\t\t\tlet header:any, footer:any;\r\n\t\t\t\tlet visibility:React.CSSProperties = {visibility:'hidden'};\r\n\t\t\t\tif (tabPosition === 'top') {\r\n\t\t\t\t\theader = <>\r\n\t\t\t\t\t\t<section className=\"tv-page-header\">\r\n\t\t\t\t\t\t\t<header>{tabs}{pageHeader}</header>\r\n\t\t\t\t\t\t</section>\r\n\t\t\t\t\t\t<header style={visibility}>{tabs}{pageHeader}</header>\r\n\t\t\t\t\t</>;\r\n\t\t\t\t\tif (pageFooter !== undefined) {\r\n\t\t\t\t\t\tfooter = <>\r\n\t\t\t\t\t\t\t<footer style={visibility}>{pageFooter}</footer>\r\n\t\t\t\t\t\t\t<section className=\"tv-page-footer\">\r\n\t\t\t\t\t\t\t\t<footer>{pageFooter}</footer>\r\n\t\t\t\t\t\t\t</section>\r\n\t\t\t\t\t\t</>;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tif (pageHeader !== undefined) {\r\n\t\t\t\t\t\theader = <>\r\n\t\t\t\t\t\t\t<section className='tv-page-header'>\r\n\t\t\t\t\t\t\t\t<header>{pageHeader}</header>\r\n\t\t\t\t\t\t\t</section>\r\n\t\t\t\t\t\t\t<header style={visibility}>{pageHeader}</header>\r\n\t\t\t\t\t\t</>;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfooter = <>\r\n\t\t\t\t\t\t<footer style={visibility}>{pageFooter}{tabs}</footer>\r\n\t\t\t\t\t\t<section className='tv-page-footer'>\r\n\t\t\t\t\t\t\t<footer>{pageFooter}{tabs}</footer>\r\n\t\t\t\t\t\t</section>\r\n\t\t\t\t\t</>;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlet style:React.CSSProperties;\r\n\t\t\t\tif (v.selected===false) style = displayNone;\r\n\t\t\t\treturn <ScrollView key={index} className={className}\r\n\t\t\t\t\tstyle={style}\r\n\t\t\t\t\tonScroll={onScroll} onScrollTop={onScrollTop} onScrollBottom={onScrollBottom}>\r\n\t\t\t\t\t{header}\r\n\t\t\t\t\t{content}\r\n\t\t\t\t\t{footer}\r\n\t\t\t\t</ScrollView>;\r\n\t\t\t})}\r\n\t\t</>;\r\n\t});\r\n\r\n    render() {\r\n\t\tlet {tabPosition} = this.props;\r\n\t\tlet tabs = React.createElement(this.tabs);\r\n\t\tlet header:any, footer:any;\r\n\t\tlet visibility:React.CSSProperties = {display:'none'};\r\n\t\tif (tabPosition === 'top') {\r\n\t\t\theader = <header>{tabs}</header>;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tfooter = <footer>{tabs}</footer>;\r\n\t\t}\r\n\t\treturn <>\r\n\t\t\t{header}\r\n\t\t\t{this.tabArr.map((v,index) => {\r\n\t\t\t\tlet style:React.CSSProperties;\r\n\t\t\t\tif (v.selected===false) style = visibility;\r\n\t\t\t\treturn <div key={index} className={classNames(v.className)} style={style}>\r\n\t\t\t\t\t{v.content}\r\n\t\t\t\t</div>;\r\n\t\t\t})}\r\n\t\t\t{footer}\r\n\t\t</>;\r\n    }\r\n};\r\n\r\n@observer export class Tabs extends React.Component<TabsProps> {\r\n\tprivate readonly tabsView: TabsView;\r\n    constructor(props: TabsProps) {\r\n\t\tsuper(props);\r\n\t\tthis.tabsView = new TabsView(props);\r\n\t\t/*\r\n\t\tsetTimeout(() => {\r\n\t\t\tthis.tabsView.tabClick(undefined);\r\n\t\t}, 100);\r\n\t\t*/\r\n    }\r\n\r\n    render() {\r\n\t\treturn this.tabsView.render();\r\n    }\r\n};\r\n\r\n@observer export class RootTabs extends React.Component<TabsProps> {\r\n\tprivate readonly tabsView: TabsView;\r\n    constructor(props: TabsProps) {\r\n\t\tsuper(props);\r\n\t\tthis.tabsView = new TabsView(props);\r\n\t\t/*\r\n\t\tsetTimeout(() => {\r\n\t\t\tthis.tabsView.tabClick(undefined);\r\n\t\t}, 100);\r\n\t\t*/\r\n    }\r\n\r\n    render() {\r\n\t\treturn React.createElement(this.tabsView.content);\r\n    }\r\n};\r\n","import * as React from 'react';\r\nimport { nav } from './nav';\r\nimport { Loading } from './loading';\r\nimport { Image as ImageControl } from './image';\r\nimport { Page } from './page/page';\r\nimport { observer } from 'mobx-react';\r\nimport { makeObservable, observable } from 'mobx';\r\nimport { LMR } from './simple';\r\n\r\nexport interface ResUploaderProps {\r\n    className?: string;\r\n    label?: string;\r\n    multiple?: boolean;\r\n    maxSize?: number;\r\n    onFilesChange?: (evt: React.ChangeEvent<HTMLInputElement>) => void;\r\n}\r\n\r\n@observer\r\nexport class ResUploader extends React.Component<ResUploaderProps> {\r\n    private fileInput: HTMLInputElement;\r\n\tfileName: string = null;\r\n\t\r\n\tconstructor(props: ResUploaderProps) {\r\n\t\tsuper(props);\r\n\t\tmakeObservable(this, {\r\n\t\t\tfileName: observable,\r\n\t\t});\r\n\t}\r\n\r\n    buildFormData():FormData {\r\n        let {maxSize} = this.props;\r\n        if (maxSize === undefined || maxSize <= 0) \r\n            maxSize = 100000000000;\r\n        else\r\n            maxSize = maxSize * 1024;\r\n        var files:FileList = this.fileInput.files;\r\n        var data = new FormData();\r\n        let len = files.length;\r\n        for (let i=0; i<len; i++) {\r\n            let file = files[i];\r\n            if (file.size > maxSize) return null;\r\n            data.append('files[]', file, file.name);\r\n        }\r\n    }\r\n\r\n    getFile0(): File {\r\n        return this.fileInput.files[0];\r\n    }\r\n\r\n    upload = async (formData?: FormData):Promise<string|{error:any}> => {\r\n        let resUrl = nav.resUrl + 'upload';\r\n        if (!formData) formData = this.buildFormData();\r\n        try {\r\n            nav.startWait();\r\n            let headers = new Headers();\r\n            headers.append('Access-Control-Allow-Origin', '*');\r\n            //2019-12-18：因为 vivo按oppo某些版本不支持，暂时先不要 \r\n            //let abortController = new AbortController();\r\n            let res = await fetch(resUrl, {\r\n                method: \"POST\",\r\n                body: formData,\r\n                headers: headers,\r\n                //signal: abortController.signal,\r\n            });\r\n            let json = await res.json();\r\n            return ':' + json.res.id;\r\n        }\r\n        catch (err) {\r\n            console.error('%s %s', resUrl, err);\r\n            return {error:err};\r\n        }\r\n        finally {\r\n            nav.endWait();\r\n        }\r\n    }\r\n\r\n    private onFilesChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\r\n        let {onFilesChange} = this.props;\r\n        if (onFilesChange) onFilesChange(evt);\r\n        let files = evt.target.files;\r\n        let len = files.length;\r\n        let names:string[] = [];\r\n        for (let i=0; i<len; i++) {\r\n            names.push(files.item(i).name);\r\n        }\r\n        this.fileName = names.join(', ');\r\n    }\r\n\r\n    render() {\r\n        let {className, multiple, label} = this.props;\r\n        return <div>\r\n                <label className=\"btn btn-outline-success\">\r\n                    {label || '选择文件'} \r\n                    <input \r\n                        className={className}\r\n                        ref={t=>this.fileInput=t} \r\n                        onChange={this.onFilesChange}\r\n                        type='file' name='file' \r\n                        multiple={multiple} style={{display:'none'}} />\r\n                </label>\r\n                &nbsp;\r\n                {this.fileName}\r\n            </div>\r\n    }\r\n}\r\n\r\nfunction formatSize(size:number, pointLength:number=2, units?:string[]) {\r\n    var unit;\r\n    units = units || [ 'B', 'K', 'M', 'G', 'TB' ];\r\n    while ( (unit = units.shift()) && size > 1024 ) {\r\n        size = size / 1024;\r\n    }\r\n    return (unit === 'B' ? size : size.toFixed( pointLength === undefined ? 2 : pointLength)) + unit;\r\n}\r\n\r\ninterface ImageUploaderProps {\r\n    id?: string;\r\n    label?: string;\r\n    size?: 'sm' | 'md' | 'lg' | 'xl' | 'raw';\r\n\tonSaved?: (imageId:string) => Promise<void>;\r\n\timageTypes?: string[];\r\n}\r\n\r\nconst xlargeSize = 1600;\r\nconst largeSize = 800;\r\nconst mediumSize = 400;\r\nconst smallSize = 180;\r\n\r\n@observer\r\nexport class ImageUploader extends React.Component<ImageUploaderProps> {\r\n\tprivate static imageTypes = ['gif', 'jpg', 'jpeg', 'png', 'svg', 'apng', 'bmp', 'ico', 'cur', 'tiff', 'tif', 'webp'];\r\n\tprivate imgBaseSize: number;\r\n\tprivate imageTypes: string[];\r\n    private suffix: string;\r\n\tprivate resUploader: ResUploader;\r\n\t\r\n    file: File = null;\r\n    desImgWidth: number = null;\r\n    desImgHeight: number = null;\r\n    desImgSize: number = null;\r\n    srcImgWidth: number = null;\r\n    srcImgHeight: number = null;\r\n    isChanged: boolean = false;\r\n    resId: string = null;\r\n    enableUploadButton: boolean = false;\r\n    srcImage: string = null;\r\n    desImage: string = null;\r\n    fileError: string = null;\r\n    uploaded: boolean = false;\r\n\r\n    constructor(props: ImageUploaderProps) {\r\n\t\tsuper(props);\r\n\t\tmakeObservable(this, {\r\n\t\t\tfile: observable,\r\n\t\t\tdesImgWidth: observable,\r\n\t\t\tdesImgHeight: observable,\r\n\t\t\tdesImgSize: observable,\r\n\t\t\tsrcImgWidth: observable,\r\n\t\t\tsrcImgHeight: observable,\r\n\t\t\tisChanged: observable,\r\n\t\t\tresId: observable,\r\n\t\t\tenableUploadButton: observable,\r\n\t\t\tsrcImage: observable,\r\n\t\t\tdesImage: observable,\r\n\t\t\tfileError: observable,\r\n\t\t\tuploaded: observable,\r\n\t\t});\r\n\t\tthis.resId = props.id;\r\n\t\tthis.imageTypes = props.imageTypes || ImageUploader.imageTypes;\r\n    }\r\n\r\n    private onFileChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\r\n        this.fileError = undefined;\r\n        this.uploaded = false;\r\n        this.enableUploadButton = evt.target.files.length > 0;\r\n        if (this.enableUploadButton) {\r\n            this.file = evt.target.files[0];\r\n            let pos = this.file.name.lastIndexOf('.');\r\n            if (pos >= 0) this.suffix = this.file.name.substr(pos+1).toLowerCase();\r\n            if(this.imageTypes.indexOf(this.suffix) < 0){\r\n                this.fileError = `图片类型必须是 ${this.imageTypes.join(', ')} 中的一种`;\r\n                return;\r\n            }\r\n            let reader = new FileReader();\r\n            reader.readAsDataURL(this.file);\r\n            reader.onload = async () => {\r\n\t\t\t\tthis.srcImage = reader.result as string;\r\n\t\t\t\tswitch (this.suffix ) {\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\tawait this.setSize(this.props.size);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'svg':\r\n\t\t\t\t\t\tthis.imgBaseSize = mediumSize;\r\n\t\t\t\t\t\tthis.desImgSize = this.srcImage.length;\r\n\t\t\t\t\t\tthis.desImage = this.srcImage;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n            };\r\n        }\r\n    }\r\n\r\n    private async setSize(size?: 'sm' | 'md' | 'lg' | 'xl' | 'raw') {\r\n        switch (size) {\r\n            default:\r\n            case 'sm':\r\n                this.imgBaseSize = smallSize; break;\r\n            case 'md':\r\n                this.imgBaseSize = mediumSize; break;\r\n            case 'lg':\r\n\t\t\t\tthis.imgBaseSize = largeSize; break;\r\n\t\t\tcase 'xl':\r\n\t\t\t\tthis.imgBaseSize = xlargeSize; break;\r\n\t\t\tcase 'raw':\r\n\t\t\t\tthis.imgBaseSize = -1; break;\r\n\t\t}\r\n\t\tthis.desImage = await this.compress();\r\n    }\r\n\r\n    private compress = ():Promise<string> => {\r\n        return new Promise<string>((resolve, reject) => {\r\n            var img = new Image();\r\n            img.src = this.srcImage;\r\n            img.onload = () => {\r\n                //var that = this;\r\n                // 默认按比例压缩\r\n                let {width, height} = img;\r\n                this.srcImgWidth = width;\r\n                this.srcImgHeight = height;\r\n                let scale = width / height;\r\n\t\t\t\tlet w:number, h:number;\r\n\t\t\t\tif (this.imgBaseSize < 0) {\r\n\t\t\t\t\tw = width;\r\n\t\t\t\t\th = height;\r\n\t\t\t\t}\r\n                else if (width <= this.imgBaseSize && height <= this.imgBaseSize) {\r\n                    w = width;\r\n                    h = height;\r\n                }\r\n                else if (scale < 0) {\r\n                    w = this.imgBaseSize;\r\n                    h = w / scale;\r\n                }\r\n                else {\r\n                    h = this.imgBaseSize;\r\n                    w = h * scale;\r\n                }\r\n                this.desImgWidth = Math.round(w);\r\n                this.desImgHeight = Math.round(h);\r\n                var quality = 0.7;  // 默认图片质量为0.7\r\n                //生成canvas\r\n                var canvas = document.createElement('canvas');\r\n                var ctx = canvas.getContext('2d');\r\n                // 创建属性节点\r\n                var anw = document.createAttribute(\"width\");\r\n                anw.nodeValue = String(w);\r\n                var anh = document.createAttribute(\"height\");\r\n                anh.nodeValue = String(h);\r\n                canvas.setAttributeNode(anw);\r\n                canvas.setAttributeNode(anh);\r\n                ctx.drawImage(img, 0, 0, w, h);\r\n                let base64 = canvas.toDataURL('image/' + this.suffix , quality);\r\n                let blob = this.convertBase64UrlToBlob(base64);\r\n                this.desImgSize = blob.size;\r\n                if (this.desImgSize > 3*1024*1024) {\r\n                    this.fileError = \"图片大于3M，无法上传\";\r\n                    this.enableUploadButton = false;\r\n                }\r\n                resolve(base64);\r\n            }\r\n        });\r\n    }\r\n\r\n    private convertBase64UrlToBlob(urlData: string):Blob {\r\n        let arr = urlData.split(',');\r\n        let mime = arr[0].match(/:(.*?);/)[1];\r\n        let bstr = atob(arr[1]);\r\n        let n = bstr.length;\r\n        let u8arr = new Uint8Array(n);\r\n        while(n--){\r\n            u8arr[n] = bstr.charCodeAt(n);\r\n        }\r\n        return new Blob([u8arr], {type:mime});\r\n    }\r\n\r\n    private upload = async () => {\r\n        if (!this.resUploader) return;\r\n        let formData = new FormData();\r\n        let blob = this.convertBase64UrlToBlob(this.desImage);\r\n        formData.append('image', blob, this.file.name);\r\n        let ret = await this.resUploader.upload(formData);\r\n        if (typeof ret === 'object') {\r\n            let {error} = ret;\r\n            let type = typeof error;\r\n            let err:string;\r\n            switch (type) {\r\n                case 'undefined': err = 'error: undefined'; break;\r\n                case 'string': err = error; break;\r\n                case 'object': err = error.message; break;\r\n                default: err = String(err); break;\r\n            }\r\n            this.fileError = 'error: ' + type + ' - ' + err;\r\n            return;\r\n        }\r\n        this.resId = ret;\r\n        this.isChanged = (this.resId !== this.props.id);\r\n        this.uploaded = true;\r\n    }\r\n\r\n    private onSaved = (): Promise<void> => {\r\n        let {onSaved} = this.props;\r\n        onSaved && onSaved(this.resId);\r\n        return;\r\n    }\r\n\r\n    private showOrgImage = () => {\r\n        nav.push(<Page header=\"原图\">\r\n            <div className=\"p-3 text-center\">\r\n                <ImageControl className=\"h-min-4c\" style={{maxWidth:'100%'}} src={this.srcImage} />\r\n            </div>\r\n        </Page>);\r\n    }\r\n\r\n    private levelDiv() {\r\n        if (this.props.size) return;\r\n        let arr = [{caption:'小图', size:'sm'}];\r\n        if (this.srcImgHeight > mediumSize || this.srcImgWidth > mediumSize) {\r\n            arr.push({caption:'中图', size:'md'});\r\n        }\r\n        if (this.srcImgHeight > largeSize || this.srcImgWidth > largeSize) {\r\n            arr.push({caption:'大图', size:'lg'});\r\n        }\r\n        if (this.srcImgHeight > xlargeSize || this.srcImgWidth > xlargeSize) {\r\n\t\t\tarr.push({caption:'超大图', size:'xl'});\r\n\t\t\tarr.push({caption:'原图', size:'raw'});\r\n        }\r\n        if (arr.length < 2) return;\r\n        return <div>{arr.map((v, index) => {\r\n            let {caption, size} = v;\r\n            return <label key={index} className=\"mr-3\"><input type=\"radio\" name=\"size\" \r\n                onChange={()=>this.setSize(size as any)}\r\n                defaultChecked={index===0} /> {caption}</label>;\r\n        })}</div>\r\n    }\r\n\r\n    render() {\r\n        let {label} = this.props;\r\n        let right = <button\r\n            className=\"btn btn-sm btn-success align-self-center mr-2\"\r\n            disabled={!this.isChanged}\r\n            onClick={this.onSaved}>保存</button>;\r\n        return <Page header={label || '更改图片'} right={right}>\r\n            <div className=\"my-3 px-3 py-3 bg-white\">\r\n                <div>\r\n                    <div className=\"mb-3\">\r\n                        <ResUploader ref={v=>this.resUploader=v} \r\n                            multiple={false} maxSize={2048} \r\n                            label=\"选择图片文件\"\r\n                            onFilesChange={this.onFileChange} />\r\n                        <div className=\"small text-muted\">支持 {this.imageTypes.join(', ')} 格式图片。</div>\r\n                        {this.fileError && <div className=\"text-danger\">{this.fileError}</div>}\r\n                    </div>\r\n                    <LMR left=\r\n                    {\r\n                        this.uploaded === true? \r\n                            <div className=\"text-success p-2\">上传成功！</div>\r\n                            :\r\n                            this.file && this.desImgSize > 0 && <div className=\"mb-3 d-flex align-items-end\">\r\n                                <div className=\"mr-5\">\r\n                                    {this.levelDiv()}\r\n                                    <div>分辨率：{this.desImgWidth} x {this.desImgHeight}\r\n                                    &nbsp; &nbsp;\r\n                                    文件大小：{formatSize(this.desImgSize)}\r\n                                    </div>\r\n                                </div>\r\n                                <button className=\"btn btn-primary\" \r\n                                    disabled={!this.enableUploadButton}\r\n                                    onClick={this.upload}>上传</button>\r\n                            </div>\r\n                    }\r\n                    right={this.desImage && \r\n                        <button className=\"btn btn-link btn-sm text-right mb-3\" onClick={this.showOrgImage}>\r\n                            原图大小: {formatSize(this.file.size)}<br/>\r\n                            分辨率：{this.srcImgWidth} x {this.srcImgHeight}\r\n                        </button>\r\n                    }\r\n                    ></LMR>\r\n                </div>\r\n                <div className=\"text-center\" \r\n                    style={{\r\n                        border: (this.uploaded===true? '2px solid green' : '1px dotted gray'),\r\n                        padding: '8px'\r\n                    }}>\r\n                    <ImageControl className=\"h-min-4c\" style={{maxWidth:'100%'}} src={this.desImage} />\r\n                </div>\r\n            </div>\r\n        </Page>;\r\n    }\r\n}\r\n\r\ninterface AudioUploaderProps {\r\n    id?: string;\r\n    label?: string;\r\n    onSaved?: (imageId:string) => Promise<void>;\r\n}\r\n\r\n@observer\r\nexport class AudioUploader extends React.Component<AudioUploaderProps> {\r\n\tprivate static audioTypes = ['mp3', 'wav'];\r\n\r\n    private suffix: string;\r\n\tprivate resUploader: ResUploader;\r\n\r\n\tcontent: string = null;\r\n\tfile: File = null;\r\n\tfileSize: number = null;\r\n    isChanged: boolean = false;\r\n    resId: string = null;\r\n    enableUploadButton: boolean = false;\r\n    fileError: string = null;\r\n\tuploaded: boolean = false;\r\n\tuploading: boolean = false;\r\n\r\n    constructor(props: AudioUploaderProps) {\r\n\t\tsuper(props);\r\n\t\tmakeObservable(this, {\r\n\t\t\tcontent: observable,\r\n\t\t\tfile: observable,\r\n\t\t\tfileSize: observable,\r\n\t\t\r\n\t\t\tisChanged: observable,\r\n\t\t\tresId: observable,\r\n\t\t\tenableUploadButton: observable,\r\n\t\t\tfileError: observable,\r\n\t\t\tuploaded: observable,\r\n\t\t\tuploading: observable,\r\n\t\t});\r\n        this.resId = props.id;\r\n    }\r\n\r\n    private onFileChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\r\n        this.fileError = undefined;\r\n        this.uploaded = false;\r\n        this.enableUploadButton = evt.target.files.length > 0;\r\n        if (this.enableUploadButton) {\r\n            this.file = evt.target.files[0];\r\n            let pos = this.file.name.lastIndexOf('.');\r\n            if (pos >= 0) this.suffix = this.file.name.substr(pos+1).toLowerCase();\r\n            if(AudioUploader.audioTypes.indexOf(this.suffix) < 0){\r\n                this.fileError = `音频类型必须是 ${AudioUploader.audioTypes.join(', ')} 中的一种`;\r\n                return;\r\n            }\r\n            let reader = new FileReader();\r\n            reader.readAsDataURL(this.file);\r\n            reader.onload = async () => {\r\n\t\t\t\tthis.content = reader.result as string;\r\n\t\t\t\tthis.fileSize = this.content.length;\r\n            };\r\n        }\r\n    }\r\n\r\n    private convertBase64UrlToBlob(urlData: string):Blob {\r\n        let arr = urlData.split(',');\r\n        let mime = arr[0].match(/:(.*?);/)[1];\r\n        let bstr = atob(arr[1]);\r\n        let n = bstr.length;\r\n        let u8arr = new Uint8Array(n);\r\n        while(n--){\r\n            u8arr[n] = bstr.charCodeAt(n);\r\n        }\r\n        return new Blob([u8arr], {type:mime});\r\n    }\r\n\r\n    private upload = async () => {\r\n\t\tif (!this.resUploader) return;\r\n\t\tthis.uploading = true;\r\n        let formData = new FormData();\r\n        let blob = this.convertBase64UrlToBlob(this.content);\r\n        formData.append('image', blob, this.file.name);\r\n        let ret = await this.resUploader.upload(formData);\r\n        if (typeof ret === 'object') {\r\n            let {error} = ret;\r\n            let type = typeof error;\r\n            let err:string;\r\n            switch (type) {\r\n                case 'undefined': err = 'error: undefined'; break;\r\n                case 'string': err = error; break;\r\n                case 'object': err = error.message; break;\r\n                default: err = String(err); break;\r\n            }\r\n            this.fileError = 'error: ' + type + ' - ' + err;\r\n            return;\r\n        }\r\n        this.resId = ret;\r\n        this.isChanged = (this.resId !== this.props.id);\r\n        this.uploaded = true;\r\n    }\r\n\r\n    private onSaved = (): Promise<void> => {\r\n        let {onSaved} = this.props;\r\n        onSaved && onSaved(this.resId);\r\n        return;\r\n    }\r\n\r\n    render() {\r\n        let {label} = this.props;\r\n        let right = <button\r\n            className=\"btn btn-sm btn-success align-self-center mr-2\"\r\n            disabled={!this.isChanged}\r\n            onClick={this.onSaved}>保存</button>;\r\n        return <Page header={label || '更改文件'} right={right}>\r\n            <div className=\"my-3 px-3 py-3 bg-white\">\r\n                <div>\r\n                    <div className=\"mb-3\">\r\n                        <ResUploader ref={v=>this.resUploader=v} \r\n                            multiple={false} maxSize={2048} \r\n                            label=\"选择音频文件\"\r\n                            onFilesChange={this.onFileChange} />\r\n                        <div className=\"small text-muted\">支持 {AudioUploader.audioTypes.join(', ')} 格式。</div>\r\n                        {this.fileError && <div className=\"text-danger\">{this.fileError}</div>}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\t\t\t<LMR left=\r\n                    {\r\n                        this.uploaded === true? \r\n                            <div className=\"text-success p-2\">上传成功！</div>\r\n\t\t\t\t\t\t\t:\r\n\t\t\t\t\t\t\tthis.uploading === true?\r\n\t\t\t\t\t\t\t\t<div className=\"m-3\"><Loading /></div>\r\n\t\t\t\t\t\t\t\t:\r\n\t\t\t\t\t\t\t\tthis.file && this.content && <div className=\"m-3\">\r\n\t\t\t\t\t\t\t\t\t<div className=\"mb-3\">\r\n\t\t\t\t\t\t\t\t\t\t文件大小：{formatSize(this.fileSize)}\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t<button className=\"btn btn-primary\" \r\n\t\t\t\t\t\t\t\t\t\tdisabled={!this.enableUploadButton}\r\n\t\t\t\t\t\t\t\t\t\tonClick={this.upload}>上传</button>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t}\r\n\t\t\t/>\r\n        </Page>;\r\n    }\r\n}\r\n","import { UqApi, UqData, UnitxApi } from '../net';\r\nimport { Tuid, TuidDiv, TuidImport, TuidInner, TuidBox, TuidsCache } from './tuid';\r\nimport { Action } from './action';\r\nimport { Sheet } from './sheet';\r\nimport { Query } from './query';\r\nimport { Book } from './book';\r\nimport { History } from './history';\r\nimport { Map } from './map';\r\nimport { Pending } from './pending';\r\nimport { CreateBoxId, BoxId } from './tuid';\r\nimport { LocalMap, LocalCache, env, capitalCase } from '../tool';\r\nimport { UQsMan } from './uqsMan';\r\nimport { ReactBoxId } from './tuid/reactBoxId';\r\nimport { Tag } from './tag/tag';\r\nimport { UqEnum } from './enum';\r\nimport { Entity } from './entity';\r\nimport { CenterApi, centerApi, UqConfig } from '../app';\r\nimport { ID, IX, IDX } from './ID';\r\nimport { nav } from '../components';\r\n\r\nexport type FieldType = 'id' | 'tinyint' | 'smallint' | 'int' | 'bigint' | 'dec' | 'char' | 'text'\r\n    | 'datetime' | 'date' | 'time' | 'timestamp';\r\n\r\nexport function fieldDefaultValue(type:FieldType) {\r\n    switch (type) {\r\n        case 'tinyint':\r\n        case 'smallint':\r\n        case 'int':\r\n        case 'bigint':\r\n        case 'dec':\r\n            return 0;\r\n        case 'char':\r\n        case 'text':\r\n            return '';\r\n        case 'datetime':\r\n        case 'date':\r\n            return '2000-1-1';\r\n        case 'time':\r\n            return '0:00';\r\n    }\r\n}\r\n\r\nexport interface Field {\r\n    name: string;\r\n    type: FieldType;\r\n    tuid?: string;\r\n    arr?: string;\r\n    null?: boolean;\r\n    size?: number;\r\n    owner?: string;\r\n    _tuid: TuidBox;\r\n}\r\nexport interface ArrFields {\r\n    name: string;\r\n    fields: Field[];\r\n    id?: string;\r\n    order?: string;\r\n}\r\nexport interface FieldMap {\r\n    [name:string]: Field;\r\n}\r\nexport interface SchemaFrom {\r\n    owner:string;\r\n    uq:string;\r\n}\r\nexport interface TuidModify {\r\n    max: number;\r\n    seconds: number;\r\n}\r\n\r\ninterface ParamPage {\r\n\tstart:number;\r\n\tend?: number;\r\n\tsize:number;\r\n}\r\n\r\nexport interface ParamActIX<T> {\r\n\tIX: IX;\r\n\tID?: ID;\r\n\tvalues: {ix:number, id:number|T}[];\r\n}\r\n\r\nexport interface ParamActDetail<M,D> {\r\n\tmaster: {\r\n\t\tID: ID;\r\n\t\tvalue: M;\r\n\t};\r\n\tdetail: {\r\n\t\tID: ID;\r\n\t\tvalues: D[];\r\n\t};\r\n}\r\n\r\nexport interface RetActDetail {\r\n\tmaster: number;\r\n\tdetail: number[];\r\n}\r\n\r\nexport interface ParamActDetail2<M,D,D2> extends ParamActDetail<M, D> {\r\n\tdetail2: {\r\n\t\tID: ID;\r\n\t\tvalues: D2[];\r\n\t};\r\n}\r\n\r\nexport interface RetActDetail2 extends RetActDetail {\r\n\tdetail2: number[];\r\n}\r\n\r\nexport interface ParamActDetail3<M,D,D2,D3> extends ParamActDetail2<M, D, D2> {\r\n\tdetail3: {\r\n\t\tID: ID;\r\n\t\tvalues: D3[];\r\n\t};\r\n}\r\n\r\nexport interface RetActDetail3 extends RetActDetail2 {\r\n\tdetail3: number[];\r\n}\r\n\r\nexport interface ParamIDNO {\r\n\tID: ID;\r\n}\r\n\r\nexport interface ParamIDDetailGet {\r\n\tid: number;\r\n\tmaster: ID;\r\n\tdetail: ID;\r\n\tdetail2?: ID;\r\n\tdetail3?: ID;\r\n}\r\n\r\nexport interface ParamID {\r\n\tIDX: (ID|IDX) | (ID|IDX)[];\r\n\tid: number | number[];\r\n\tpage?: ParamPage;\r\n}\r\n\r\nexport interface ParamKeyID {\r\n\tID: ID;\r\n\tkey: {[key:string]:string|number};\r\n\tIDX?: (ID|IDX)[];\r\n\tpage?: ParamPage;\r\n}\r\n\r\nexport interface ParamIX {\r\n\tIX: IX;\r\n\tIX1?: IX;\r\n\tix: number | number[];\r\n\tIDX?: (ID|IDX)[];\r\n\tpage?: ParamPage;\r\n}\r\n\r\nexport interface ParamKeyIX {\r\n\tID: ID;\r\n\tkey: {[key:string]:string|number};\r\n\tIX: IX;\r\n\tIDX?: (ID|IDX)[];\r\n\tpage?: ParamPage;\r\n}\r\n\r\nexport interface ParamIDLog {\r\n\tIDX: (ID|IDX);\r\n\tfield: string;\r\n\tid: number;\r\n\tlog: 'each' | 'day' | 'week' | 'month' | 'year';\r\n\ttimeZone?: number;\r\n\tfar?: number;\r\n\tnear?: number;\r\n\tpage: ParamPage;\r\n}\r\n\r\nexport interface ParamIDSum {\r\n\tIDX: IDX;\r\n\tfield: string[];\r\n\tid: number|number[];\r\n\tfar?: number;\t\t\t\t// 以前\r\n\tnear?: number;\t\t\t\t// 最近\r\n}\r\n\r\nexport interface ParamIDxID {\r\n\tID: ID;\r\n\tIX: IX;\r\n\tID2: ID;\r\n\tpage?: ParamPage;\r\n}\r\n\r\nexport interface IDXValue {\r\n\tvalue: number;\r\n\ttime?: number|Date;\r\n\tact: '='|'+';\r\n}\r\n\r\nexport interface ParamIDinIX {\r\n\tID: ID;\r\n\tid: number;\r\n\tIX: IX;\r\n\tpage?: ParamPage;\r\n}\r\n\r\nexport interface ParamIDTree {\r\n\tID: ID;\r\n\tparent: number;\r\n\tkey: string|number;\r\n\tlevel?: number;\t\t\t\t// 无值，默认1一级\r\n\tpage?: ParamPage;\r\n}\r\n\r\nfunction IDPath(path:string):string {return path;}\r\n\r\nexport interface Uq {\r\n\t$: UqMan;\r\n\tActs(param:any): Promise<any>;\r\n\tActIX<T>(param: ParamActIX<T>): Promise<number[]>;\r\n\tActDetail<M,D>(param: ParamActDetail<M,D>): Promise<RetActDetail>;\r\n\tActDetail<M,D,D2>(param: ParamActDetail2<M,D,D2>): Promise<RetActDetail2>;\r\n\tActDetail<M,D,D2,D3>(param: ParamActDetail3<M,D,D2,D3>): Promise<RetActDetail3>;\r\n\tIDNO(param: ParamIDNO): Promise<string>;\r\n\tIDDetailGet<M,D>(param: ParamIDDetailGet): Promise<[M[], D[]]>;\r\n\tIDDetailGet<M,D,D2>(param: ParamIDDetailGet): Promise<[M[], D[], D2[]]>;\r\n\tIDDetailGet<M,D,D2,D3>(param: ParamIDDetailGet): Promise<[M[], D[], D2[], D3[]]>;\r\n\tID<T>(param: ParamID): Promise<T[]>;\r\n\tKeyID<T>(param: ParamKeyID): Promise<T[]>;\r\n\tIX<T>(param: ParamIX): Promise<T[]>;\r\n\tIXr<T> (param: ParamIX): Promise<T[]>; // IX id 反查IX list\r\n\tKeyIX<T>(param: ParamKeyIX): Promise<T[]>;\r\n\tIDLog<T> (param: ParamIDLog): Promise<T[]>;\r\n\tIDSum<T> (param: ParamIDSum): Promise<T[]>;\r\n\tIDxID<T,T2> (param: ParamIDxID): Promise<[T[],T2[]]>; // ID list with IX 对应的子集\r\n\tIDinIX<T>(param:ParamIDinIX): Promise<T&{$in:boolean}[]>;\r\n\tIDTree<T>(param:ParamIDTree): Promise<T[]>;\r\n}\r\n\r\nexport class UqMan {\r\n\tprivate readonly entities: {[name:string]: Entity} = {};\r\n\tprivate readonly enums: {[name:string]: UqEnum} = {};\r\n\tprivate readonly actions: {[name:string]: Action} = {};\r\n    private readonly queries: {[name:string]: Query} = {};\r\n\tprivate readonly ids: {[name:string]: ID} = {};\r\n\tprivate readonly idxs: {[name:string]: IDX} = {};\r\n\tprivate readonly ixs: {[name:string]: IX} = {};\r\n\r\n    private readonly sheets: {[name:string]: Sheet} = {};\r\n    private readonly books: {[name:string]: Book} = {};\r\n    private readonly maps: {[name:string]: Map} = {};\r\n    private readonly histories: {[name:string]: History} = {};\r\n\tprivate readonly pendings: {[name:string]: Pending} = {};\r\n\tprivate readonly tags: {[name:string]: Tag} = {};\r\n    private readonly tuidsCache: TuidsCache;\r\n    private readonly localEntities: LocalCache;\r\n    private readonly tvs:{[entity:string]:(values:any)=>JSX.Element};\r\n\tproxy: any;\r\n    readonly localMap: LocalMap;\r\n    readonly localModifyMax: LocalCache;\r\n    readonly tuids: {[name:string]: Tuid} = {};\r\n    readonly createBoxId: CreateBoxId;\r\n    readonly newVersion: boolean;\r\n    readonly uqOwner: string;\r\n    readonly uqName: string;\r\n    readonly name: string;\r\n    readonly uqApi: UqApi;\r\n\treadonly id: number;\r\n\r\n    uqVersion: number;\r\n\t//ownerProfix: string;\r\n\tconfig: UqConfig;\r\n\r\n    constructor(uqs:UQsMan, uqData: UqData, createBoxId:CreateBoxId, tvs:{[entity:string]:(values:any)=>JSX.Element}) {\r\n        this.createBoxId = createBoxId;\r\n        if (createBoxId === undefined) {\r\n            this.createBoxId = this.createBoxIdFromTVs;\r\n            this.tvs = tvs || {};\r\n        }\r\n        let {id, uqOwner, uqName, /*access, */newVersion} = uqData;\r\n        this.newVersion = newVersion;\r\n        this.uqOwner = uqOwner;\r\n        this.uqName = uqName;\r\n        this.id = id;\r\n        this.name = uqOwner + '/' + uqName;\r\n        this.uqVersion = 0;\r\n\t\t//this.localMap = uqs.localMap.map(this.name);\r\n\t\tthis.localMap = env.localDb.map(this.name);\r\n        this.localModifyMax = this.localMap.child('$modifyMax');\r\n        this.localEntities = this.localMap.child('$access');\r\n        let baseUrl = 'tv/';\r\n\r\n\t\t/*\r\n        let acc: string[];\r\n        if (access === null || access === undefined || access === '*') {\r\n            acc = [];\r\n        }\r\n        else {\r\n            acc = access.split(';').map(v => v.trim()).filter(v => v.length > 0);\r\n\t\t}\r\n\t\t*/\r\n        if (this.name === '$$$/$unitx') {\r\n            // 这里假定，点击home link之后，已经设置unit了\r\n            // 调用 UnitxApi会自动搜索绑定 unitx service\r\n            this.uqApi = new UnitxApi(env.unit);\r\n        }\r\n        else {\r\n            //let {appOwner, appName} = uqs;\r\n            this.uqApi = new UqApi(baseUrl, /*appOwner, appName, */uqOwner, uqName/*, acc*/, true);\r\n        }\r\n        this.tuidsCache = new TuidsCache(this);\r\n    }\r\n\r\n\tget center():CenterApi {return centerApi;}\r\n\r\n\tgetID(name:string):ID {return this.ids[name.toLowerCase()];};\r\n\tgetIDX(name:string):IDX {return this.idxs[name.toLowerCase()];};\r\n\tgetIX(name:string):IX {return this.ixs[name.toLowerCase()];};\r\n\r\n    private createBoxIdFromTVs:CreateBoxId = (tuid:Tuid, id:number):BoxId =>{\r\n        let {name} = tuid;\r\n        /*\r\n        let tuidUR = this.tuidURs[name];\r\n        if (tuidUR === undefined) {\r\n            let {ui, res} = this.getUI(tuid);\r\n            this.tuidURs[name] = tuidUR = new TuidWithUIRes(tuid, ui, res);\r\n        }\r\n        */\r\n        return new ReactBoxId(id, tuid, this.tvs[name]);\r\n\t}\r\n\t\r\n\tprivate roles:string[];\r\n\tasync getRoles():Promise<string[]> {\r\n\t\tif (this.roles !== undefined) return this.roles;\r\n\t\tthis.roles = await this.uqApi.getRoles();\r\n\t\treturn this.roles;\r\n\t}\r\n\r\n    tuid(name:string):Tuid {return this.tuids[name.toLowerCase()]}\r\n    tuidDiv(name:string, div:string):TuidDiv {\r\n        let tuid = this.tuids[name.toLowerCase()]\r\n        return tuid && tuid.div(div.toLowerCase());\r\n    }\r\n    action(name:string):Action {return this.actions[name.toLowerCase()]}\r\n    sheet(name:string):Sheet {return this.sheets[name.toLowerCase()]}\r\n    query(name:string):Query {return this.queries[name.toLowerCase()]}\r\n    book(name:string):Book {return this.books[name.toLowerCase()]}\r\n    map(name:string):Map {return this.maps[name.toLowerCase()]}\r\n    history(name:string):History {return this.histories[name.toLowerCase()]}\r\n    pending(name:string):Pending {return this.pendings[name.toLowerCase()]}\r\n\r\n    sheetFromTypeId(typeId:number):Sheet {\r\n        for (let i in this.sheets) {\r\n            let sheet = this.sheets[i];\r\n            if (sheet.typeId === typeId) return sheet;\r\n        }\r\n    }\r\n\r\n\tallRoles: string[];\r\n    readonly tuidArr: Tuid[] = [];\r\n    readonly actionArr: Action[] = [];\r\n    readonly queryArr: Query[] = [];\r\n    readonly idArr: ID[] = [];\r\n    readonly idxArr: IDX[] = [];\r\n    readonly ixArr: IX[] = [];\r\n    readonly enumArr: UqEnum[] = [];\r\n    readonly sheetArr: Sheet[] = [];\r\n    readonly bookArr: Book[] = [];\r\n    readonly mapArr: Map[] = [];\r\n    readonly historyArr: History[] = [];\r\n    readonly pendingArr: Pending[] = [];\r\n    readonly tagArr: Tag[] = [];\r\n\r\n    async init() {\r\n        await this.uqApi.init();\r\n    }\r\n\r\n    async loadEntities(): Promise<string> {\r\n        try {\r\n            let entities = this.localEntities.get();\r\n            if (!entities) {\r\n                entities = await this.uqApi.loadEntities();\r\n\t\t\t}\r\n            if (!entities) return;\r\n            this.buildEntities(entities);\r\n        }\r\n        catch (err) {\r\n            return err;\r\n        }\r\n    }\r\n\r\n\tbuildEntities(entities:any) {\r\n        if (entities === undefined) {\r\n            debugger;\r\n        }\r\n        this.localEntities.set(entities);\r\n        let {access, tuids, role, version} = entities;\r\n\t\tthis.uqVersion = version;\r\n\t\tthis.allRoles = role?.names;\r\n        this.buildTuids(tuids);\r\n\t\tthis.buildAccess(access);\r\n\t}\r\n\t\r\n    private buildTuids(tuids:any) {\r\n        for (let i in tuids) {\r\n            let schema = tuids[i];\r\n            let {typeId, from} = schema;\r\n            let tuid = this.newTuid(i, typeId, from);\r\n            tuid.sys = true;\r\n        }\r\n        for (let i in tuids) {\r\n            let schema = tuids[i];\r\n            let tuid = this.getTuid(i);\r\n            tuid.setSchema(schema);\r\n        }\r\n        for (let i in this.tuids) {\r\n            let tuid = this.tuids[i];\r\n            tuid.buildFieldsTuid();\r\n        }\r\n\t}\r\n\r\n    async loadEntitySchema(entityName: string): Promise<any> {\r\n        return await this.uqApi.schema(entityName);\r\n    }\r\n\r\n\tasync loadAllSchemas():Promise<void> {\r\n\t\tlet ret = await this.uqApi.allSchemas();\r\n\t\tlet entities: Entity[][] = [\r\n\t\t\tthis.actionArr, \r\n\t\t\tthis.enumArr,\r\n\t\t\tthis.sheetArr,\r\n\t\t\tthis.queryArr,\r\n\t\t\tthis.bookArr,\r\n\t\t\tthis.mapArr,\r\n\t\t\tthis.historyArr,\r\n\t\t\tthis.pendingArr,\r\n\t\t\tthis.tagArr,\r\n\t\t\tthis.idArr,\r\n\t\t\tthis.idxArr,\r\n\t\t\tthis.ixArr,\r\n\t\t];\r\n\t\tentities.forEach(arr => {\r\n\t\t\tarr.forEach(v => {\r\n\t\t\t\tlet entity = ret[v.name.toLowerCase()];\r\n\t\t\t\tif (!entity) return;\r\n\t\t\t\tlet schema = entity.call;\r\n\t\t\t\tif (!schema) return;\r\n\t\t\t\tv.buildSchema(schema);\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n    getTuid(name:string): Tuid {\r\n        return this.tuids[name];\r\n    }\r\n\r\n    private buildAccess(access:any) {\r\n        for (let a in access) {\r\n            let v = access[a];\r\n            switch (typeof v) {\r\n                case 'string': this.fromType(a, v); break;\r\n                case 'object': this.fromObj(a, v); break;\r\n            }\r\n        }\r\n    }\r\n\r\n    cacheTuids(defer:number) {\r\n        this.tuidsCache.cacheTuids(defer);\r\n    }\r\n\r\n\tprivate setEntity(name:string, entity:Entity) {\r\n\t\tthis.entities[name] = entity;\r\n\t\tthis.entities[name.toLowerCase()] = entity;\r\n\t}\r\n\r\n    newEnum(name:string, id:number):UqEnum {\r\n        let enm = this.enums[name];\r\n        if (enm !== undefined) return enm;\r\n\t\tenm = this.enums[name] = new UqEnum(this, name, id);\r\n\t\tthis.setEntity(name, enm);\r\n        this.enumArr.push(enm);\r\n        return enm;\r\n    }\r\n\tnewAction(name:string, id:number):Action {\r\n        let action = this.actions[name];\r\n        if (action !== undefined) return action;\r\n        action = this.actions[name] = new Action(this, name, id);\r\n\t\tthis.setEntity(name, action);\r\n        this.actionArr.push(action);\r\n        return action;\r\n    }\r\n    private newTuid(name:string, id:number, from:SchemaFrom):Tuid {\r\n        let tuid = this.tuids[name];\r\n        if (tuid !== undefined) return tuid;\r\n        if (from !== undefined)\r\n            tuid = new TuidImport(this, name, id, from);\r\n        else\r\n            tuid = new TuidInner(this, name, id);\r\n        this.tuids[name] = tuid;\r\n\t\tthis.setEntity(name, tuid);\r\n        this.tuidArr.push(tuid);\r\n        return tuid;\r\n    }\r\n    newQuery(name:string, id:number):Query {\r\n        let query = this.queries[name];\r\n        if (query !== undefined) return query;\r\n        query = this.queries[name] = new Query(this, name, id)\r\n\t\tthis.setEntity(name, query);\r\n        this.queryArr.push(query);\r\n        return query;\r\n    }\r\n    private newBook(name:string, id:number):Book {\r\n        let book = this.books[name];\r\n        if (book !== undefined) return book;\r\n        book = this.books[name] = new Book(this, name, id);\r\n\t\tthis.setEntity(name, book);\r\n        this.bookArr.push(book);\r\n        return book;\r\n    }\r\n    private newMap(name:string, id:number):Map {\r\n        let map = this.maps[name];\r\n        if (map !== undefined) return map;\r\n        map = this.maps[name] = new Map(this, name, id)\r\n\t\tthis.setEntity(name, map);\r\n        this.mapArr.push(map);\r\n        return map;\r\n    }\r\n    private newTag(name:string, id:number):Tag {\r\n        let tag = this.tags[name];\r\n        if (tag !== undefined) return tag;\r\n        tag = this.tags[name] = new Tag(this, name, id)\r\n\t\tthis.setEntity(name, tag);\r\n        this.tagArr.push(tag);\r\n        return tag;\r\n    }\r\n    private newHistory(name:string, id:number):History {\r\n        let history = this.histories[name];\r\n        if (history !== undefined) return;\r\n        history = this.histories[name] = new History(this, name, id)\r\n\t\tthis.setEntity(name, history);\r\n        this.historyArr.push(history);\r\n        return history;\r\n    }\r\n    private newPending(name:string, id:number):Pending {\r\n        let pending = this.pendings[name];\r\n        if (pending !== undefined) return;\r\n        pending = this.pendings[name] = new Pending(this, name, id)\r\n\t\tthis.setEntity(name, pending);\r\n        this.pendingArr.push(pending);\r\n        return pending;\r\n    }\r\n    private newSheet(name:string, id:number):Sheet {\r\n        let sheet = this.sheets[name];\r\n        if (sheet !== undefined) return sheet;\r\n        sheet = this.sheets[name] = new Sheet(this, name, id);\r\n\t\tthis.setEntity(name, sheet);\r\n        this.sheetArr.push(sheet);\r\n        return sheet;\r\n    }\r\n    private newID(name:string, id:number):ID {\r\n\t\tlet lName = name.toLowerCase();\r\n        let idEntity = this.ids[lName];\r\n        if (idEntity !== undefined) return idEntity;\r\n        idEntity = this.ids[lName] = new ID(this, name, id);\r\n\t\tthis.setEntity(name, idEntity);\r\n        this.idArr.push(idEntity);\r\n        return idEntity;\r\n    }\r\n    private newIDX(name:string, id:number):IDX {\r\n\t\tlet lName = name.toLowerCase();\r\n        let idx = this.idxs[lName];\r\n        if (idx !== undefined) return idx;\r\n        idx = this.idxs[lName] = new IDX(this, name, id);\r\n\t\tthis.setEntity(name, idx);\r\n        this.idxArr.push(idx);\r\n        return idx;\r\n    }\r\n    private newIX(name:string, id:number):IX {\r\n\t\tlet lName = name.toLowerCase();\r\n        let ix = this.ixs[lName];\r\n        if (ix !== undefined) return ix;\r\n        ix = this.ixs[lName] = new IX(this, name, id);\r\n\t\tthis.setEntity(name, ix);\r\n        this.ixArr.push(ix);\r\n        return ix;\r\n    }\r\n    private fromType(name:string, type:string) {\r\n        let parts = type.split('|');\r\n        type = parts[0];\r\n        let id = Number(parts[1]);\r\n        switch (type) {\r\n            //case 'uq': this.id = id; break;\r\n            case 'tuid':\r\n                // Tuid should not be created here!;\r\n                //let tuid = this.newTuid(name, id);\r\n                //tuid.sys = false;\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'id': this.newID(name, id); break;\r\n\t\t\tcase 'idx': this.newIDX(name, id); break;\r\n\t\t\tcase 'ix': this.newIX(name, id); break;\r\n            case 'action': this.newAction(name, id); break;\r\n            case 'query': this.newQuery(name, id); break;\r\n            case 'book': this.newBook(name, id); break;\r\n            case 'map': this.newMap(name, id); break;\r\n            case 'history': this.newHistory(name, id); break;\r\n            case 'sheet':this.newSheet(name, id); break;\r\n\t\t\tcase 'pending': this.newPending(name, id); break;\r\n\t\t\tcase 'tag': this.newTag(name, id); break;\r\n\t\t\tcase 'enum': this.newEnum(name, id); break;\r\n        }\r\n    }\r\n    private fromObj(name:string, obj:any) {\r\n        switch (obj['$']) {\r\n            case 'sheet': this.buildSheet(name, obj); break;\r\n        }\r\n    }\r\n    private buildSheet(name:string, obj:any) {\r\n        let sheet = this.sheets[name];\r\n        if (sheet === undefined) sheet = this.newSheet(name, obj.id);\r\n        sheet.build(obj);\r\n    }\r\n    buildFieldTuid(fields:Field[], mainFields?:Field[]) {\r\n        if (fields === undefined) return;\r\n        for (let f of fields) {\r\n            let {tuid} = f;\r\n            if (tuid === undefined) continue;\r\n            let t = this.getTuid(tuid);\r\n            if (t === undefined) continue;\r\n            f._tuid = t.buildTuidBox();\r\n        }\r\n        for (let f of fields) {\r\n            let {owner} = f;\r\n            if (owner === undefined) continue;\r\n            let ownerField = fields.find(v => v.name === owner);\r\n            if (ownerField === undefined) {\r\n                if (mainFields !== undefined) {\r\n                    ownerField = mainFields.find(v => v.name === owner);\r\n                }\r\n                if (ownerField === undefined) {\r\n                    debugger;\r\n                    throw new Error(`owner field ${owner} is undefined`);\r\n                }\r\n            }\r\n            let {arr, tuid} = f;\r\n            let t = this.getTuid(ownerField._tuid.tuid.name);\r\n            if (t === undefined) continue;\r\n            let div = t.div(arr || tuid);\r\n            f._tuid = div && div.buildTuidDivBox(ownerField);\r\n            if (f._tuid === undefined) {\r\n                debugger;\r\n                throw new Error(`owner field ${owner} is not tuid`);\r\n            }\r\n        }\r\n    }\r\n    buildArrFieldsTuid(arrFields:ArrFields[], mainFields:Field[]) {\r\n        if (arrFields === undefined) return;\r\n        for (let af of arrFields) {\r\n            let {fields} = af;\r\n            if (fields === undefined) continue;\r\n            this.buildFieldTuid(fields, mainFields);\r\n        }\r\n    }\r\n\r\n    pullModify(modifyMax:number) {\r\n        this.tuidsCache.pullModify(modifyMax);\r\n\t}\r\n\r\n\tgetUqKey() {\r\n\t\t//let l = this.uqName.toLowerCase();\r\n\t\tlet uqKey:string = this.uqName.split(/[-._]/).join('').toLowerCase();\r\n\t\tif (this.config) {\r\n\t\t\tlet {dev} = this.config;\r\n\t\t\tuqKey = capitalCase(dev.alias || dev.name) + capitalCase(uqKey);\r\n\t\t}\r\n\t\treturn uqKey;\r\n\t}\r\n\r\n\tcreateProxy():any {\r\n\t\tlet ret = new Proxy(this.entities, {\r\n\t\t\tget: (target, key, receiver) => {\r\n\t\t\t\tlet lk = (key as string).toLowerCase();\r\n\t\t\t\tif (lk === '$') {\r\n\t\t\t\t\treturn this;\r\n\t\t\t\t}\r\n\t\t\t\tlet ret = target[lk];\r\n\t\t\t\tif (ret !== undefined) return ret;\r\n\t\t\t\tswitch (key) {\r\n\t\t\t\t\tdefault: debugger; break;\r\n\t\t\t\t\tcase 'Acts': return this.Acts;\r\n\t\t\t\t\tcase 'ActIX': return this.ActIX;\r\n\t\t\t\t\tcase 'IDDetail': return this.ActDetail;\r\n\t\t\t\t\tcase 'IDNO': return this.IDNO;\r\n\t\t\t\t\tcase 'IDDetailGet': return this.IDDetailGet;\r\n\t\t\t\t\tcase 'ID': return this.ID;\r\n\t\t\t\t\tcase 'KeyID': return this.KeyID;\r\n\t\t\t\t\tcase 'IX': return this.IX;\r\n\t\t\t\t\tcase 'IXr': return this.IXr;\r\n\t\t\t\t\tcase 'KeyIX': return this.KeyIX;\r\n\t\t\t\t\tcase 'IDLog': return this.IDLog;\r\n\t\t\t\t\tcase 'IDSum': return this.IDSum;\r\n\t\t\t\t\tcase 'IDinIX': return this.IDinIX;\r\n\t\t\t\t\tcase 'IDxID': return this.IDxID;\r\n\t\t\t\t\tcase 'IDTree': return this.IDTree;\r\n\t\t\t\t}\r\n\t\t\t\tlet err = `entity ${this.name}.${String(key)} not defined`;\r\n\t\t\t\tconsole.error(err);\r\n\t\t\t\tthis.showReload('UQ错误：' + err);\r\n\t\t\t\treturn undefined;\r\n\t\t\t}\r\n\t\t});\r\n\t\tthis.proxy = ret;\r\n\t\treturn ret;\r\n\t}\r\n\r\n    private showReload(msg: string) {\r\n\t\tthis.localMap.removeAll();\r\n\t\tnav.showReloadPage(msg);\r\n    }\r\n\r\n\t//private coms:any;\r\n\t//private setComs = (coms: any) => {this.coms = coms;}\r\n\tprivate Acts = async (param:any): Promise<any> => {\r\n\t\t// 这边的obj属性序列，也许会不一样\r\n\t\tlet arr:string[] = [];\r\n\t\tlet apiParam:any = {};\r\n\t\tfor (let i in param) {\r\n\t\t\tarr.push(i);\r\n\t\t\tapiParam[i] = (param[i] as any[]).map(v => {\r\n\t\t\t\tlet obj:any = {};\r\n\t\t\t\tfor (let j in v) {\r\n\t\t\t\t\tlet val = v[j];\r\n\t\t\t\t\tif (typeof val === 'object') {\r\n\t\t\t\t\t\tlet nv:any = {};\r\n\t\t\t\t\t\tfor (let n in val) {\r\n\t\t\t\t\t\t\tlet tv = val[n];\r\n\t\t\t\t\t\t\tif (tv && typeof tv === 'object') {\r\n\t\t\t\t\t\t\t\tif (n === 'time') {\r\n\t\t\t\t\t\t\t\t\tif (Object.prototype.toString.call(tv) === '[object Date]') {\r\n\t\t\t\t\t\t\t\t\t\ttv = (tv as Date).getTime();\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\t\tlet id = tv['id'];\r\n\t\t\t\t\t\t\t\t\ttv = id;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tnv[n] = tv;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tobj[j] = nv;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tobj[j] = val;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn obj;\r\n\t\t\t});\r\n\t\t}\r\n\t\tapiParam['$'] = arr;\r\n\t\tlet ret = await this.uqApi.post(IDPath('acts'), apiParam);\r\n\t\tlet retArr = (ret[0].ret as string).split('\\n');\r\n\t\tlet retActs:{[key:string]:number[]} = {};\r\n\t\tfor (let i=0; i<arr.length; i++) {\r\n\t\t\tretActs[arr[i]] = ids(retArr[i].split('\\t'));\r\n\t\t}\r\n\t\treturn retActs;\r\n\t}\r\n\r\n\tprivate ActIX = async (param: ParamActIX<any>): Promise<number[]> => {\r\n\t\tlet {IX, ID, values} = param;\r\n\t\tlet apiParam:any = {\r\n\t\t\tIX: entityName(IX),\r\n\t\t\tID: entityName(ID),\r\n\t\t\tvalues,\r\n\t\t};\r\n\t\tlet ret = await this.uqApi.post(IDPath('act-ix'), apiParam);\r\n\t\treturn (ret[0].ret as string).split('\\t').map(v => Number(v));\r\n\t}\r\n\r\n\tprivate ActDetail = async (param: ParamActDetail<any, any>): Promise<any> => {\r\n\t\tlet {master, detail, detail2, detail3} = param as unknown as ParamActDetail3<any, any, any, any>;\r\n\t\tlet postParam:any = {\r\n\t\t\tmaster: {\r\n\t\t\t\tname: entityName(master.ID),\r\n\t\t\t\tvalue: toScalars(master.value),\r\n\t\t\t},\r\n\t\t\tdetail: {\r\n\t\t\t\tname: entityName(detail.ID),\r\n\t\t\t\tvalues: detail.values?.map(v => toScalars(v)),\r\n\t\t\t},\r\n\t\t}\r\n\t\tif (detail2) {\r\n\t\t\tpostParam.detail2 = {\r\n\t\t\t\tname: entityName(detail2.ID),\r\n\t\t\t\tvalues: detail2.values?.map(v => toScalars(v)),\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (detail3) {\r\n\t\t\tpostParam.detail3 = {\r\n\t\t\t\tname: entityName(detail3.ID),\r\n\t\t\t\tvalues: detail3.values?.map(v => toScalars(v)),\r\n\t\t\t}\r\n\t\t}\r\n\t\tlet ret = await this.uqApi.post(IDPath('act-detail'), postParam);\r\n\t\tlet val:string = ret[0].ret;\r\n\t\tlet parts = val.split('\\n');\r\n\t\tlet items = parts.map(v => v.split('\\t'));\r\n\t\tret = {\r\n\t\t\tmaster: ids(items[0])[0],\r\n\t\t\tdetail: ids(items[1]),\r\n\t\t\tdetail2: ids(items[2]),\r\n\t\t\tdetail3: ids(items[3]),\r\n\t\t};\r\n\t\treturn ret;\r\n\t}\r\n\r\n\tprivate IDNO = async (param: ParamIDNO): Promise<string> => {\r\n\t\tlet {ID} = param;\r\n\t\tlet ret = await this.uqApi.post(IDPath('id-no'), {ID: entityName(ID)});\r\n\t\treturn ret;\r\n\t}\r\n\r\n\tprivate IDDetailGet = async (param: ParamIDDetailGet): Promise<any> => {\r\n\t\tlet {id, master, detail, detail2, detail3} = param;\r\n\t\tlet ret = await this.uqApi.post(IDPath('id-detail-get'), {\r\n\t\t\tid,\r\n\t\t\tmaster: entityName(master),\r\n\t\t\tdetail: entityName(detail),\r\n\t\t\tdetail2: entityName(detail2),\r\n\t\t\tdetail3: entityName(detail3),\r\n\t\t});\r\n\t\treturn ret;\r\n\t}\r\n\r\n\t//private checkParam(ID:ID, IDX:(ID|IDX)|(ID|IDX)[], IX:IX, id:number|number[], key:{[key:string]:string|number}, page: ParamPage) {\r\n\t//}\r\n\tprivate IDXToString(p:ID|IDX|((ID|IDX)[])):string|string[] {\r\n\t\tif (Array.isArray(p) === true) return (p as (ID|IDX)[]).map(v => entityName(v));\r\n\t\treturn entityName(p as ID|IDX);\r\n\t}\r\n\tprivate ID = async (param: ParamID): Promise<any[]> => {\r\n\t\tlet {IDX} = param;\r\n\t\t//this.checkParam(null, IDX, null, id, null, page);\r\n\t\tlet ret = await this.uqApi.post(IDPath('id'), {\r\n\t\t\t...param,\r\n\t\t\tIDX: this.IDXToString(IDX),\r\n\t\t});\r\n\t\treturn ret;\r\n\t}\r\n\tprivate KeyID = async (param: ParamKeyID): Promise<any[]> => {\r\n\t\tlet {ID, IDX} = param;\r\n\t\t//this.checkParam(null, IDX, null, null, key, page);\r\n\t\tlet ret = await this.uqApi.post(IDPath('key-id'), {\r\n\t\t\t...param,\r\n\t\t\tID: entityName(ID),\r\n\t\t\tIDX: IDX?.map(v => entityName(v)),\r\n\t\t});\r\n\t\treturn ret;\r\n\t}\r\n\tprivate IX = async (param: ParamIX): Promise<any[]> => {\r\n\t\tlet {IX, IX1, IDX} = param;\r\n\t\t//this.checkParam(null, IDX, IX, id, null, page);\r\n\t\tlet ret = await this.uqApi.post(IDPath('ix'), {\r\n\t\t\t...param,\r\n\t\t\tIX: entityName(IX),\r\n\t\t\tIX1: entityName(IX1),\r\n\t\t\tIDX: IDX?.map(v => entityName(v)),\r\n\t\t});\r\n\t\treturn ret;\r\n\t}\r\n\tprivate IXr = async (param: ParamIX): Promise<any[]> => {\r\n\t\tlet {IX, IX1, IDX} = param;\r\n\t\t//this.checkParam(null, IDX, IX, id, null, page);\r\n\t\tlet ret = await this.uqApi.post(IDPath('ixr'), {\r\n\t\t\t...param,\r\n\t\t\tIX: entityName(IX),\r\n\t\t\tIX1: entityName(IX1),\r\n\t\t\tIDX: IDX?.map(v => entityName(v)),\r\n\t\t});\r\n\t\treturn ret;\r\n\t}\r\n\tprivate KeyIX = async (param: ParamKeyIX): Promise<any[]> => {\r\n\t\tlet {ID, IX, IDX} = param;\r\n\t\t//this.checkParam(ID, IDX, IX, null, key, page);\r\n\t\tlet ret = await this.uqApi.post(IDPath('key-ix'), {\r\n\t\t\t...param,\r\n\t\t\tID: entityName(ID),\r\n\t\t\tIX: entityName(IX),\r\n\t\t\tIDX: IDX?.map(v => entityName(v)),\r\n\t\t});\r\n\t\treturn ret;\r\n\t}\r\n\tprivate IDLog = async (param: ParamIDLog): Promise<any[]> => {\r\n\t\tlet {IDX} = param;\r\n\t\t//this.checkParam(null, IDX, null, id, null, page);\r\n\t\tlet ret = await this.uqApi.post(IDPath('id-log'), {\r\n\t\t\t...param,\r\n\t\t\tIDX: entityName(IDX),\r\n\t\t});\r\n\t\treturn ret;\r\n\t}\r\n\tprivate IDSum = async (param: ParamIDSum): Promise<any[]> => {\r\n\t\tlet {IDX} = param;\r\n\t\t//this.checkParam(null, IDX, null, id, null, page);\r\n\t\tlet ret = await this.uqApi.post(IDPath('id-sum'), {\r\n\t\t\t...param,\r\n\t\t\tIDX: entityName(IDX),\r\n\t\t});\r\n\t\treturn ret;\r\n\t}\r\n\tprivate IDinIX = async (param:ParamIDinIX): Promise<any|{$in:boolean}[]> => {\r\n\t\tlet {ID, IX} = param;\r\n\t\t//this.checkParam(null, IDX, null, id, null, page);\r\n\t\tlet ret = await this.uqApi.post(IDPath('id-in-ix'), {\r\n\t\t\t...param,\r\n\t\t\tID: entityName(ID),\r\n\t\t\tIX: entityName(IX),\r\n\t\t});\r\n\t\treturn ret;\r\n\t}\r\n\tprivate IDxID = async (param:ParamIDxID): Promise<any[]> => {\r\n\t\tlet {ID, IX, ID2} = param;\r\n\t\t//this.checkParam(null, IDX, null, id, null, page);\r\n\t\tlet ret = await this.uqApi.post(IDPath('id-x-id'), {\r\n\t\t\t...param,\r\n\t\t\tID: entityName(ID),\r\n\t\t\tIX: entityName(IX),\r\n\t\t\tID2: entityName(ID2),\r\n\t\t});\r\n\t\treturn ret;\r\n\t}\r\n\r\n\tprivate IDTree = async (param:ParamIDTree): Promise<any[]> => {\r\n\t\tlet {ID} = param;\r\n\t\tlet ret = await this.uqApi.post(IDPath('id-tree'), {\r\n\t\t\t...param,\r\n\t\t\tID: entityName(ID),\r\n\t\t});\r\n\t\treturn ret;\r\n\t}\r\n}\r\n\r\nfunction ids(item:string[]):number[] {\r\n\tif (!item) return;\r\n\tlet len = item.length;\r\n\tif (len <= 1) return;\r\n\tlet ret:number[] = [];\r\n\tfor (let i=0; i<len-1; i++) ret.push(Number(item[i]));\r\n\treturn ret;\r\n}\r\n\r\nfunction entityName(entity:Entity | string): string {\r\n\tif (!entity) return;\r\n\tif (typeof entity === 'string') return entity;\r\n\treturn entity.name;\r\n}\r\n\r\nfunction toScalars(value:any):any {\r\n\tif (!value) return value;\r\n\tlet ret:any = {};\r\n\tfor (let i in value) {\r\n\t\tlet v = value[i];\r\n\t\tif (typeof v === 'object') v = v['id'];\r\n\t\tret[i] = v;\r\n\t}\r\n\treturn ret;\r\n}","import { Entity } from './entity';\r\nimport { PageItems } from '../tool/pageItems';\r\nimport { EntityCaller } from './caller';\r\nimport { ArrFields } from './uqMan';\r\n\r\nexport interface SheetState {\r\n    name: string;\r\n    actions: SheetAction[];\r\n}\r\n\r\nexport interface SheetAction {\r\n    name: string;\r\n}\r\n\r\nexport interface StateCount {\r\n    state: string;\r\n    count: number;\r\n}\r\n\r\nexport interface SheetSaveReturnV<V> {\r\n\tid: number;\r\n\tflow: number;\r\n\tstate: string;\r\n\tverify: V[];\r\n}\r\n\r\nexport interface SheetSaveReturn extends SheetSaveReturnV<any> {\r\n}\r\n\r\ninterface GetSheetReturn<M> {\r\n\tbrief: any;\r\n\tdata: M;\r\n\tflows: any[];\r\n}\r\n\r\nexport class UqSheet<M, V> extends Entity {\r\n    get typeName(): string { return 'sheet';}\r\n\tstates: SheetState[];\r\n\tverify: {returns: ArrFields[]};\r\n\r\n    /*\r\n    setStates(states: SheetState[]) {\r\n        for (let state of states) {\r\n            this.setStateAccess(this.states.find(s=>s.name==state.name), state);\r\n        }\r\n    }*/\r\n    setSchema(schema:any) {\r\n        super.setSchema(schema);\r\n\t\tthis.states = schema.states;\r\n\t\tthis.verify = schema.verify;\r\n    }\r\n    build(obj:any) {\r\n        this.states = [];\r\n        for (let op of obj.ops) {\r\n            this.states.push({name: op, actions:undefined});\r\n        }\r\n        /*\r\n        for (let p in obj) {\r\n            switch(p) {\r\n                case '#':\r\n                case '$': continue;\r\n                default: this.states.push(this.createSheetState(p, obj[p])); break;\r\n            }\r\n        }*/\r\n    }\r\n    private createSheetState(name:string, obj:object):SheetState {\r\n        let ret:SheetState = {name:name, actions:[]};\r\n        let actions = ret.actions;\r\n        for (let p in obj) {\r\n            let action:SheetAction = {name: p};\r\n            actions.push(action);\r\n        }\r\n        return ret;\r\n    }\r\n    async save(discription:string, data:M):Promise<SheetSaveReturnV<V>> {\r\n        let {id} = this.uq;\r\n        let params = {app: id, discription: discription, data:data};\r\n        return await new SaveCaller(this, params).request();\r\n    }\r\n    async saveDebugDirect(discription:string, data:M):Promise<SheetSaveReturn> {\r\n        let {id} = this.uq;\r\n        let params = {app: id, discription: discription, data:data};\r\n        return await new SaveDirectCaller(this, params).request();\r\n    }\r\n    async action(id:number, flow:number, state:string, action:string) {\r\n        return await new ActionCaller(this, {id:id, flow:flow, state:state, action:action}).request();\r\n    }\r\n    async actionDebugDirect(id:number, flow:number, state:string, action:string) {\r\n        return await new ActionDirectCaller(this, {id:id, flow:flow, state:state, action:action}).request();\r\n    }\r\n    private unpack(data:any):GetSheetReturn<M> {\r\n        //if (this.schema === undefined) await this.loadSchema();\r\n        let ret = data[0];\r\n        let brief = ret[0];\r\n        let sheetData = this.unpackSheet(brief.data);\r\n        let flows = data[1];\r\n        return {\r\n            brief: brief,\r\n            data: sheetData,\r\n            flows: flows,\r\n        }\r\n    }\r\n    async getSheet(id:number):Promise<GetSheetReturn<M>> {\r\n        /*\r\n        await this.loadSchema();\r\n        let ret = await this.uqApi.getSheet(this.name, id);\r\n        */\r\n        let ret = await new GetSheetCaller(this, id).request();\r\n        if (ret[0].length === 0) return await this.getArchive(id);\r\n        return this.unpack(ret);\r\n    }\r\n    async getArchive(id:number):Promise<GetSheetReturn<M>> {\r\n        /*\r\n        await this.loadSchema();\r\n        let ret = await this.uqApi.sheetArchive(this.name, id)\r\n        return this.unpack(ret);\r\n        */\r\n        let ret = await new SheetArchiveCaller(this, id).request();\r\n        return this.unpack(ret);\r\n    }\r\n\r\n    async getArchives(pageStart:number, pageSize:number) {\r\n        /*\r\n        await this.loadSchema();\r\n        let ret = await this.uqApi.sheetArchives(this.name, {pageStart:pageStart, pageSize:pageSize});\r\n        return ret;\r\n        */\r\n        let params = {pageStart:pageStart, pageSize:pageSize};\r\n        return await new SheetArchivesCaller(this, params).request();\r\n    }\r\n\r\n    async getStateSheets(state:string, pageStart:number, pageSize:number):Promise<any[]> {\r\n        /*\r\n        await this.loadSchema();\r\n        let ret = await this.uqApi.stateSheets(this.name, {state:state, pageStart:pageStart, pageSize:pageSize});\r\n        return ret;\r\n        */\r\n        let params = {state:state, pageStart:pageStart, pageSize:pageSize};\r\n        return await new StateSheetsCaller(this, params).request();\r\n    }\r\n    createPageStateItems<T>(): PageStateItems<T> {return new PageStateItems<T>(this);}\r\n\r\n    async stateSheetCount():Promise<StateCount[]> {\r\n        /*\r\n        await this.loadSchema();\r\n        let ret:StateCount[] = await this.uqApi.stateSheetCount(this.name);\r\n        return this.states.map(s => {\r\n            let n = s.name, count = 0;\r\n            let r = ret.find(v => v.state === n);\r\n            if (r !== undefined) count = r.count;\r\n            return {state: n, count: count} \r\n        });\r\n        */\r\n        return await new StateSheetCountCaller(this, undefined).request();\r\n    }\r\n\r\n    async userSheets(state:string, user:number, pageStart:number, pageSize:number):Promise<any[]> {\r\n        let params = {state:state, user:user, pageStart:pageStart, pageSize:pageSize};\r\n        return await new UserSheetsCaller(this, params).request();\r\n    }\r\n\r\n    async mySheets(state:string, pageStart:number, pageSize:number):Promise<any[]> {\r\n        /*\r\n        await this.loadSchema();\r\n        let ret = await this.uqApi.mySheets(this.name, {state:state, pageStart:pageStart, pageSize:pageSize});\r\n        return ret;\r\n        */\r\n        let params = {state:state, pageStart:pageStart, pageSize:pageSize};\r\n        return await new MySheetsCaller(this, params).request();\r\n    }\r\n}\r\n\r\nexport class Sheet extends UqSheet<any, any> {\r\n}\r\n\r\nabstract class SheetCaller<T> extends EntityCaller<T> {\r\n    protected get entity(): Sheet {return this._entity as Sheet;}\r\n    protected readonly suffix:string;\r\n    get path():string {return `sheet/${this.entity.name}/${this.suffix}`;}\r\n}\r\n\r\nclass SaveCaller extends SheetCaller<{app:number; discription:string; data:any}> {\r\n    get path():string {return `sheet/${this.entity.name}`;}\r\n    buildParams() {\r\n        let {app, discription, data} = this.params;\r\n        return {\r\n            app: app,\r\n            discription: discription,\r\n            data: this.entity.pack(data)\r\n        };\r\n    }\r\n    xresult(res:any):any {\r\n\t\tlet {verify} = this.entity;\r\n\t\tif (verify === undefined) return res;\r\n\t\tlet resVerify = res.verify;\r\n\t\tif (resVerify === undefined || resVerify.length === 0) {\r\n\t\t\tres.verify = undefined;\r\n\t\t\treturn res;\r\n\t\t}\r\n\t\tlet {returns} = verify;\r\n\t\tres.verify = this.entity.unpackReturns(resVerify, returns);\r\n        return res;\r\n    }\r\n}\r\n\r\nclass SaveDirectCaller extends SaveCaller {\r\n    get path():string {return `sheet/${this.entity.name}/direct`;}\r\n}\r\n\r\nclass ActionCaller extends SheetCaller<{id:number, flow:number, state:string, action:string}> {\r\n    method = 'PUT';\r\n    get path():string {return `sheet/${this.entity.name}`;}\r\n}\r\n\r\nclass ActionDirectCaller extends ActionCaller {\r\n    get path():string {return `sheet/${this.entity.name}/direct`;}\r\n}\r\n\r\nclass GetSheetCaller extends SheetCaller<number> {\r\n    //protected readonly params: number;  // id\r\n    method = 'GET';\r\n    //private id:number;\r\n    //protected readonly suffix = 'archive';\r\n    buildParams() {}\r\n    get path():string {return `sheet/${this.entity.name}/get/${this.params}`;}\r\n}\r\n\r\nclass SheetArchiveCaller extends SheetCaller<number> {\r\n    //protected readonly params: number;  // id\r\n    method = 'GET';\r\n    //protected readonly suffix = 'archive';\r\n    buildParams() {}\r\n    get path():string {return `sheet/${this.entity.name}/archive/${this.params}`;}\r\n}\r\n\r\nclass SheetArchivesCaller extends SheetCaller<{pageStart:number, pageSize:number}> {\r\n    protected readonly suffix = 'archives';\r\n}\r\n\r\nclass StateSheetsCaller extends SheetCaller<{state:string, pageStart:number, pageSize:number}> {\r\n    protected readonly suffix = 'states';\r\n}\r\n\r\nclass StateSheetCountCaller extends SheetCaller<undefined> {\r\n    method = 'GET';\r\n    protected readonly suffix = 'statecount';\r\n    xresult(res:any):any {\r\n        let {states} = this.entity;\r\n        return states.map(s => {\r\n            let n = s.name, count = 0;\r\n            let r = (res as any[]).find(v => v.state === n);\r\n            if (r !== undefined) count = r.count;\r\n            return {state: n, count: count} \r\n        });\r\n    }\r\n}\r\n\r\nclass UserSheetsCaller extends SheetCaller<{state:string, user:number, pageStart:number, pageSize:number}> {\r\n    protected readonly suffix = 'user-sheets';\r\n    xresult(res:any):any {\r\n        return res;\r\n    }\r\n}\r\n\r\nclass MySheetsCaller extends SheetCaller<{state:string, pageStart:number, pageSize:number}> {\r\n    protected readonly suffix = 'my-sheets';\r\n    xresult(res:any):any {\r\n        return res;\r\n    }\r\n}\r\n\r\nexport class PageStateItems<T> extends PageItems<T> {\r\n    private sheet: Sheet;\r\n    constructor(sheet: Sheet) {\r\n        super(true);\r\n        this.sheet = sheet;\r\n        this.pageSize = 10;\r\n\t}\r\n\tprotected async loadResults(param:any, pageStart:any, pageSize:number):Promise<{[name:string]:any[]}> {\r\n\t\tlet ret = await this.sheet.getStateSheets(param, pageStart, pageSize);\r\n\t\treturn {$page: ret};\r\n\t}\r\n\t/*\r\n    protected async load(param:any, pageStart:any, pageSize:number):Promise<any[]> {\r\n        let ret = await this.sheet.getStateSheets(param, pageStart, pageSize);\r\n        return ret;\r\n\t}\r\n\t*/\r\n\tprotected getPageId(item:T) {\r\n\t\treturn item === undefined? 0 : (item as any).id;\r\n\t}\r\n\t/*\r\n    protected setPageStart(item:any) {\r\n        this.pageStart = item === undefined? 0 : item.id;\r\n\t}\r\n\t*/\r\n}\r\n","import { UqQuery} from './query';\r\nimport { QueryQueryCaller } from './caller';\r\n\r\nexport class UqBook<P, R> extends UqQuery<P, R> {\r\n    get typeName(): string { return 'book';}\r\n    protected queryApiName = 'book';\r\n\r\n    protected queryCaller(params: any): QueryQueryCaller {\r\n        return new BookQueryCaller(this, params);\r\n    }\r\n}\r\n\r\nexport class Book extends UqBook<any, any> {\r\n}\r\n\r\nexport class BookQueryCaller extends QueryQueryCaller {\r\n    get path():string {return `book/${this.entity.name}`;}\r\n}\r\n","import { UqQuery } from './query';\r\n\r\nexport class UqHistory<P,R> extends UqQuery<P,R>  {\r\n    get typeName(): string { return 'history';}\r\n    protected queryApiName = 'history';\r\n}\r\n\r\nexport class History extends UqHistory<any, any> {\r\n}\r\n","import { Entity } from './entity';\r\nimport { Action, ActionSubmitCaller } from './action';\r\nimport { Query } from './query';\r\nimport { Field } from './uqMan';\r\nimport { EntityCaller, QueryPageCaller, QueryQueryCaller } from './caller';\r\n\r\ninterface MapActions {\r\n    add: Action;\r\n    del: Action;\r\n}\r\ninterface MapQueries {\r\n    all: Query;\r\n    page: Query;\r\n    query: Query;\r\n}\r\n\r\nexport class UqMap extends Entity {\r\n    get typeName(): string { return 'map';}\r\n    keys: Field[];\r\n    actions: MapActions = {} as any;\r\n    queries: MapQueries = {} as any;\r\n    schemaFrom: {owner:string; uq:string};\r\n\r\n    setSchema(schema:any) {\r\n        super.setSchema(schema);\r\n        this.schemaFrom = this.schema.from;\r\n        let {actions, queries, keys} = schema;\r\n        this.uq.buildFieldTuid(this.keys = keys);\r\n        for (let i in actions) {\r\n            let actionSchema = actions[i];\r\n            let {name} = actionSchema;\r\n            let action = this.uq.newAction(name, undefined);\r\n            action.setSchema(actionSchema);\r\n            action.buildFieldsTuid();\r\n            (this.actions as any)[i] = action;\r\n        }\r\n        for (let i in queries) {\r\n            let querySchema = queries[i];\r\n            let {name} = querySchema;\r\n            let query = this.uq.newQuery(name, undefined);\r\n            query.setSchema(querySchema);\r\n            query.buildFieldsTuid();\r\n            (this.queries as any)[i] = query;\r\n        }\r\n    }\r\n\r\n    async add(param:any) {\r\n        let ret = await new AddCaller(this, param).request();\r\n        return ret;\r\n    }\r\n\r\n    async del(param:any) {\r\n        let ret = await new DelCaller(this, param).request();\r\n        return ret;\r\n    }\r\n\r\n    async all() {\r\n        let ret = await new AllCaller(this, undefined).request();\r\n        return ret;\r\n    }\r\n\r\n    async page(param:any, pageStart:any, pageSize: number) {\r\n        let ret = await new PageCaller(this, {pageStart:pageStart, pageSize:pageSize, param:param}).request();\r\n        return ret;\r\n    }\r\n\r\n    async query(param:any) {\r\n       let qc = new QueryCaller(this, param);\r\n       let ret = await qc.request();\r\n       return ret;\r\n   }\r\n    async table(params:any): Promise<any[]> {\r\n        let ret = await this.query(params);\r\n        for (let i in ret) {\r\n            return ret[i];\r\n        }\r\n    }\r\n    async obj(params:any):Promise<any> {\r\n        let ret = await this.table(params);\r\n        if (ret.length > 0) return ret[0];\r\n    }\r\n    async scalar(params:any):Promise<any> {\r\n        let ret = await this.obj(params);\r\n        for (let i in ret) return ret[i];\r\n    }\r\n}\r\n\r\nexport class Map extends UqMap {\r\n}\r\n\r\nabstract class MapCaller extends EntityCaller<any> {\r\n    protected get entity(): Map {return this._entity as Map;}\r\n    get path():string {return undefined;}\r\n\r\n    protected abstract getCaller(param: any):EntityCaller<any>;\r\n\r\n    protected async innerCall(): Promise<any> {\r\n        let caller = this.getCaller(this.params);\r\n        let res = await this.entity.uqApi.xcall(caller);\r\n        let ret = caller.xresult(res.res);\r\n        return {res: ret};\r\n    }\r\n\r\n    buildParams() {\r\n        let p = super.buildParams();\r\n        return p;\r\n    }\r\n}\r\n\r\nclass AddCaller extends MapCaller {\r\n    protected getCaller(param:any):EntityCaller<any> {\r\n        return new MapAddCaller(this.entity, this.entity.actions.add, param);\r\n    }\r\n}\r\n\r\nclass DelCaller extends MapCaller {\r\n    protected getCaller(param:any):EntityCaller<any> {\r\n        return new MapDelCaller(this.entity, this.entity.actions.add, param);\r\n    }\r\n}\r\n\r\nclass AllCaller extends MapCaller {\r\n    protected getCaller(param:any):EntityCaller<any> {\r\n        return new MapAllCaller(this.entity, this.entity.queries.all, param);\r\n    }\r\n}\r\n\r\nclass PageCaller extends MapCaller {\r\n    protected getCaller(param:any):EntityCaller<any> {\r\n        return new MapPageCaller(this.entity, this.entity.queries.page, param);\r\n    }\r\n}\r\n\r\nclass QueryCaller extends MapCaller {\r\n    protected getCaller(param:any):EntityCaller<any> {\r\n        return new MapQueryCaller(this.entity, this.entity.queries.query, param);\r\n    }\r\n}\r\n\r\nclass MapAddCaller extends ActionSubmitCaller {\r\n    private map: Map;\r\n    constructor(map:Map, action:Action, params:any) {\r\n        super(action, params);\r\n        this.map = map;\r\n    }\r\n\r\n    get path():string {return `map/${this.map.name}/add`}\r\n    get headers(): {[header:string]: string} {return undefined;}\r\n}\r\n\r\nclass MapDelCaller extends ActionSubmitCaller {\r\n    private map: Map;\r\n    constructor(map:Map, action:Action, params:any) {\r\n        super(action, params);\r\n        this.map = map;\r\n    }\r\n\r\n    get path():string {return `map/${this.map.name}/del`}\r\n    get headers(): {[header:string]: string} {return undefined}\r\n}\r\n\r\nclass MapAllCaller extends QueryPageCaller {\r\n    private map: Map;\r\n    constructor(map:Map, query:Query, params:any) {\r\n        super(query, params);\r\n        this.map = map;\r\n    }\r\n\r\n    get path():string {return `map/${this.map.name}/all`}\r\n    get headers(): {[header:string]: string} {return undefined}\r\n}\r\n\r\nclass MapPageCaller extends QueryPageCaller {\r\n    private map: Map;\r\n    constructor(map:Map, query:Query, params:any) {\r\n        super(query, params);\r\n        this.map = map;\r\n    }\r\n\r\n    get path():string {return `map/${this.map.name}/page`}\r\n    get headers(): {[header:string]: string} {return undefined}\r\n}\r\n\r\nclass MapQueryCaller extends QueryQueryCaller {\r\n    private map: Map;\r\n    constructor(map:Map, query:Query, params:any) {\r\n        super(query, params);\r\n        this.map = map;\r\n    }\r\n\r\n    get path():string {return `map/${this.map.name}/query`}\r\n    get headers(): {[header:string]: string} {return undefined}\r\n}\r\n","import { UqQuery } from './query';\r\n\r\nexport class UqPending<P,R> extends UqQuery<P,R>  {\r\n    get typeName(): string { return 'pending';}\r\n    protected queryApiName = 'pending';\r\n}\r\n\r\nexport class Pending extends UqPending<any, any> {\r\n}\r\n","import { Entity } from \"./entity\";\r\n\r\nexport class UqEnum extends Entity {\r\n    get typeName(): string { return 'enum';}\r\n}","import { UqExt as Uq } from './BzHelloTonva';\r\nimport * as Customer from './Customer.ui';\r\nimport * as OrderMaster from './OrderMaster.ui';\r\nimport * as OrderDetail from './OrderDetail.ui';\r\nimport * as Tag from './Tag.ui';\r\nimport * as Staff from './Staff.ui';\r\nimport * as $Piecewise from './$Piecewise.ui';\r\nimport * as $PiecewiseDetail from './$PiecewiseDetail.ui';\r\nimport * as Achieve from './Achieve.ui';\r\nimport * as Hours from './Hours.ui';\r\nimport * as CustomerTag from './CustomerTag.ui';\r\nimport * as UserStaff from './UserStaff.ui';\r\n\r\nexport function setUI(uq: Uq) {\r\n\tObject.assign(uq.Customer, Customer);\r\n\tObject.assign(uq.OrderMaster, OrderMaster);\r\n\tObject.assign(uq.OrderDetail, OrderDetail);\r\n\tObject.assign(uq.Tag, Tag);\r\n\tObject.assign(uq.Staff, Staff);\r\n\tObject.assign(uq.$Piecewise, $Piecewise);\r\n\tObject.assign(uq.$PiecewiseDetail, $PiecewiseDetail);\r\n\tObject.assign(uq.Achieve, Achieve);\r\n\tObject.assign(uq.Hours, Hours);\r\n\tObject.assign(uq.CustomerTag, CustomerTag);\r\n\tObject.assign(uq.UserStaff, UserStaff);\r\n}\r\nexport * from './BzHelloTonva';\r\n","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport * as React from 'react';\r\nimport { VPage, Page, View, List, LMR, left0, FA } from 'tonva-react';\r\nimport { observable } from 'mobx';\r\nimport { observer } from 'mobx-react';\r\nimport RC2 from 'react-chartjs-2'\r\nimport { GFunc } from '../tool/GFunc';\r\nimport { CStockInfo } from './CStockInfo'\r\nimport { NStockInfo, StockCapitalearning, StockBonus } from './StockInfoType';\r\nimport { ErForEarning, SlrForEarning } from 'regression';\r\nimport { renderStockRow } from 'tool';\r\n\r\nexport class VStockInfo extends VPage<CStockInfo> {\r\n    private input: HTMLInputElement;\r\n    private key: string = undefined;\r\n\r\n    async open(param?: any) {\r\n        this.openPage(this.page);\r\n    }\r\n\r\n    @observable protected ttmLimit: boolean = false;\r\n\r\n    render(param: any): JSX.Element {\r\n        return this.page();\r\n    }\r\n\r\n    checkLimitShow = (e: any) => {\r\n        let check = e.target.checked as boolean;\r\n        this.ttmLimit = check;\r\n    }\r\n\r\n    checkShowLater = (e: any) => {\r\n        let check = e.target.checked as boolean;\r\n        //this.controller.loadHistoryData(check);\r\n    }\r\n\r\n    checkDefaultTag = (e: any) => {\r\n        let check = e.target.checked as boolean;\r\n        this.controller.onClickDefaultTag(check);\r\n    }\r\n\r\n    private page = observer(() => {\r\n        let { openMetaView, baseItem, onSelectTag, stockTags, isLogined } = this.controller;\r\n        let { name, code, day } = baseItem;\r\n        let viewMetaButton = <></>;\r\n        if (isLogined) {\r\n            viewMetaButton = <button type=\"button\" className=\"btn w-100\" onClick={openMetaView}>view</button>\r\n        }\r\n\t\t/*\r\n        let right = stockTags && <button\r\n            className=\"btn btn-sm mr-2 btn-outline-success bg-light align-self-center\"\r\n            onClick={onSelectTag}>\r\n            {stockTags.length === 0 ? '加自选' : '设分组'}\r\n        </button>;\r\n\t\t*/\r\n        let headStr = name + ' ' + code;\r\n        if (day !== undefined) {\r\n            headStr += ' - ' + day;\r\n        }\r\n        let head = <div onClick={() => this.controller.showSelectStock(day)}>{headStr}</div>\r\n        return <Page header={head}\r\n            headerClassName='bg-primary'>\r\n            {React.createElement(this.pageContent)}\r\n        </Page>;\r\n    })\r\n\r\n    private pageContent = observer(() => {\r\n        return <>\r\n            {React.createElement(this.baseInfo)}\r\n            {this.dateHead()}\r\n            {this.historyChart()}\r\n            {React.createElement(this.predictInfo)}\r\n            {React.createElement(this.predictSeasonEarning)}\r\n            {React.createElement(this.seasonEarning)}\r\n            {React.createElement(this.capitalEarning)}\r\n            {React.createElement(this.bonus)}\r\n        </>\r\n    });\r\n\r\n    private onChange = (evt: React.ChangeEvent<any>) => {\r\n        let v = evt.target.value;\r\n        let n = Number(v);\r\n        if (isNaN(n) === true || !Number.isInteger(n)) {\r\n            if (this.input) {\r\n                this.input.value = this.key;\r\n            }\r\n            return;\r\n        }\r\n        this.key = evt.target.value;\r\n        if (this.key !== undefined) {\r\n            this.key = this.key.trim();\r\n            if (this.key === '') this.key = undefined;\r\n        }\r\n    }\r\n\r\n    private onSubmit = async (evt: React.FormEvent<any>) => {\r\n        evt.preventDefault();\r\n        if (this.key === undefined) this.key = '';\r\n        let n = Number(this.key);\r\n        if (!isNaN(n) && Number.isInteger((n))) {\r\n            if (n === 0 || (n >= 20000101 && n < 30000101)) {\r\n                await this.controller.changeDay(n);\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    private dateHead = () => {\r\n        let { day } = this.controller.baseItem;\r\n        let dayString = day === undefined || isNaN(day) ? '' : day.toString();\r\n        return <div className=\"px-3 py-2 bg-white\">\r\n            <form className=\"w-100\" onSubmit={this.onSubmit} >\r\n                <div className=\"input-group input-group-sm\">\r\n                    <label className=\"input-group-addon mr-2 mb-0 align-self-center\">{'日期'}</label>\r\n                    <input ref={v => this.input = v} onChange={this.onChange}\r\n                        type=\"text\"\r\n                        name=\"key\"\r\n                        defaultValue={dayString}\r\n                        className=\"form-control border-primary px-2\"\r\n                        placeholder={'yyyymmdd'}\r\n                        maxLength={8} />\r\n                    <div className=\"input-group-append\">\r\n                        <button className=\"btn btn-primary px-2\"\r\n                            type=\"submit\">\r\n                            <i className='fa fa-search' />\r\n                            <i className=\"fa\" />\r\n                            {'跳转'}\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n            </form>\r\n        </div>;\r\n    }\r\n\r\n\r\n    private baseInfo = observer(() => {\r\n        let { stock, baseItem } = this.controller;\r\n        let { id, name, market, code, symbol, pe, roe, price, order, divyield, e, capital, bonus } = baseItem;\r\n\t\tlet {cCommon} = this.controller.cApp;\r\n\t\t/*\r\n        let right = <label className=\"align-self-center px-3\"> <input type=\"checkbox\" name=\"checkDefaultList\" defaultChecked={isMySelect}\r\n            onChange={this.checkDefaultTag} />自选股</label>;\r\n\t\t*/\r\n\t\tlet pinStock = <span>\r\n\t\t\t{cCommon.renderStockLink(stock)}\r\n\t\t\t&nbsp;\r\n\t\t\t{cCommon.renderPinStock(stock)}\r\n\t\t\t&nbsp;\r\n\t\t\t{cCommon.renderBlockStock(stock)}\r\n\t\t</span>;\r\n\t\treturn renderStockRow(undefined, stock, undefined, undefined, pinStock);\r\n\t\t/*\r\n        return <LMR className=\"bg-white\" right={pinStock}> <div className=\"px-3 py-2\" >\r\n            <div className=\"d-flex flex-wrap\">\r\n                <div className=\"px-3 c8\">{GFunc.caption('TTM')}{GFunc.numberToFixString(pe)}</div>\r\n                <div className=\"px-3 c8\">{GFunc.caption('股息率')}{GFunc.percentToFixString(divyield)}</div>\r\n                <div className=\"px-3 c8\">{GFunc.caption('ROE')}{GFunc.percentToFixString(roe)}</div>\r\n                <div className=\"px-3 c8\">{GFunc.caption('价格')}{GFunc.numberToFixString(price)}</div>\r\n                <a className=\"px-3 text-info\" href={url} target=\"_blank\" rel=\"noopener noreferrer\" onClick={(e) => { e.stopPropagation() }}>{urlTitle}</a>\r\n            </div>\r\n        </div>\r\n        </LMR>;\r\n\t\t*/\r\n    });\r\n\r\n    private historyChart = () => {\r\n        let { baseItem } = this.controller;\r\n        let { market, code, symbol } = baseItem;\r\n        if (market === 'HK') {\r\n            return undefined;\r\n        }\r\n        else {\r\n            let urlweek = `https://image.sinajs.cn/newchart/weekly/n/${symbol}.gif`;\r\n            let urlmonth = `https://image.sinajs.cn/newchart/monthly/n/${symbol}.gif`\r\n            return <div className=\"d-flex\">\r\n                <div className=\"px-2\" style={{ width: '50%' }}><img alt=\"\" src={urlweek} /></div>\r\n                <div className=\"px-2\" style={{ width: '50%' }}><img alt=\"\" src={urlmonth} /></div>\r\n            </div>;\r\n        }\r\n    }\r\n\r\n    // protected historyChart = observer(() => {\r\n    // \tlet {historyData, baseItem} = this.controller;\r\n    // \tif (historyData === undefined) \r\n    // \treturn <></>;\r\n    // \tlet chartHistory = <></>;\r\n    // \tlet labelList:any[] = [];\r\n    // \tlet priceList:number[] = [];\r\n    // \tlet ttmList:number[] = [];\r\n    // \tfor (let item of historyData) {\r\n    // \tlet {day, price, ttm} = item;\r\n    // \tlabelList.push(day);\r\n    // \tpriceList.push(GFunc.numberToPrecision(price, 4));\r\n    // \tif (ttm <= 0) \r\n    // \t\tttmList.push(undefined);\r\n    // \telse {\r\n    // \t\tif (this.ttmLimit && ttm >= 35) {\r\n    // \t\tttmList.push(35);\r\n    // \t\t}\r\n    // \t\telse {\r\n    // \t\tttmList.push(GFunc.numberToPrecision(ttm, 4));\r\n    // \t\t}\r\n    // \t}\r\n    // \t}\r\n    // \tlet chartdata1 = {\r\n    // \tlabels: labelList,\r\n    // \tdatasets: [\r\n    // \t\t{\r\n    // \t\tlabel: '价格',\r\n    // \t\tdata: priceList,\r\n    // \t\tborderColor:'blue',\r\n    // \t\tbackgroundColor:'skyBlue',\r\n    // \t\tborderWidth: 1,\r\n    // \t\tfill: false,\r\n    // \t\tyAxisID: 'y-axis-1',\r\n    // \t\t},\r\n    // \t\t{\r\n    // \t\tlabel: 'TTM',\r\n    // \t\tdata: ttmList,\r\n    // \t\tborderColor:'red',\r\n    // \t\tbackgroundColor:'pink',\r\n    // \t\tborderWidth: 1,\r\n    // \t\tfill: false,\r\n    // \t\tyAxisID: 'y-axis-2',\r\n    // \t\t}\r\n    // \t]\r\n    // \t};\r\n    // \tlet options = {\r\n    // \tscales:{\r\n    // \t\tyAxes: [{\r\n    // \t\t\ttype: 'linear',\r\n    // \t\t\tdisplay: true,\r\n    // \t\t\tposition: 'left',\r\n    // \t\t\tid: 'y-axis-1',\r\n    // \t\t}, {\r\n    // \t\t\ttype: 'linear',\r\n    // \t\t\tdisplay: true,\r\n    // \t\t\tposition: 'right',\r\n    // \t\t\tid: 'y-axis-2',\r\n    // \t\t\tgridLines: {\r\n    // \t\t\t\tdrawOnChartArea: false\r\n    // \t\t\t}\r\n    // \t\t}],       \r\n    // \t}\r\n    // \t}\r\n    // \tchartHistory = <RC2 data={chartdata1} type='line' options={options} />;\r\n    // \tlet right = <></>;\r\n    // \tif (baseItem.day !== undefined) {\r\n    // \tright = <><label className=\"px-3\"> <input type=\"checkbox\" name=\"showLater\" defaultChecked={false}\r\n    // \t\t\tonChange={this.checkShowLater} />显示后面数据</label>\r\n    // \t\t<label className=\"px-3\"> <input type=\"checkbox\" name=\"selectType\" defaultChecked={this.ttmLimit}\r\n    // \t\tonChange={this.checkLimitShow} />限制TTM显示范围</label>\r\n    // \t\t</>;\r\n\r\n    // \t}\r\n    // \telse {\r\n    // \tright = <label className=\"px-3\"> <input type=\"checkbox\" name=\"selectType\" defaultChecked={this.ttmLimit}\r\n    // \t\tonChange={this.checkLimitShow} />限制TTM显示范围</label>;\r\n    // \t}\r\n    // \treturn <><LMR className=\"px-3 py-2 bg-white\" left={'历史走势'} right={right}></LMR>\r\n    // \t<div className=\"px-3\" style={{width:'95%'}}>{chartHistory}</div>\r\n    // \t</>;\r\n    // });\r\n\r\n    protected predictInfo = observer(() => {\r\n        let { predictData, ypredict } = this.controller;\r\n        if (predictData === undefined)\r\n            return <></>;\r\n        let { e, b, r2, epre, l, lr2, lpre } = predictData;\r\n        let chart1 = <></>;\r\n        if (ypredict.length === 5) {\r\n            let er = new ErForEarning(ypredict);\r\n            let chartdata1 = {\r\n                labels: ['0', '1', '2', '3', '4'],\r\n                datasets: [\r\n                    {\r\n                        label: '原值',\r\n                        data: ypredict.map(v => GFunc.numberToPrecision(v)),\r\n                        borderColor: 'black',\r\n                        backgroundColor: 'skyBlue',\r\n                        showLine: false,\r\n                        pointStyle: \"crossRot\",\r\n                        borderWidth: 1,\r\n                        pointRadius: 5,\r\n                        fill: false,\r\n                    } as any\r\n                ]\r\n            };\r\n            if (!(isNaN(er.B) || isNaN(er.A))) {\r\n                let per: number[] = [];\r\n                for (let i = 0; i < 5; ++i) {\r\n                    per.push(GFunc.numberToPrecision(er.predict(i), 4));\r\n                }\r\n                chartdata1.datasets.push(\r\n                    {\r\n                        label: '指数回归',\r\n                        data: per,\r\n                        borderColor: 'red',\r\n                        backgroundColor: 'pink',\r\n                        borderWidth: 1,\r\n                        fill: false,\r\n                    });\r\n            }\r\n            let lr = new SlrForEarning(ypredict);\r\n            if (!(isNaN(lr.slope) || isNaN(lr.intercept))) {\r\n                let plr: number[] = [];\r\n                for (let i = 0; i < 5; ++i) {\r\n                    plr.push(GFunc.numberToPrecision(lr.predict(i), 4));\r\n                }\r\n                chartdata1.datasets.push(\r\n                    {\r\n                        label: '线性回归',\r\n                        data: plr,\r\n                        borderColor: 'blue',\r\n                        backgroundColor: 'pink',\r\n                        borderWidth: 1,\r\n                        fill: false,\r\n                    });\r\n            }\r\n            chart1 = <RC2 data={chartdata1} type='line' />;\r\n        }\r\n        let chart2 = this.predictChartFullInfo();\r\n        let chart3 = this.predictChartROE();\r\n        return <><div className=\"px-3 py-2 bg-white\">指数回归预测</div>\r\n            <div className=\"d-flex flex-wrap\">\r\n                <div className=\"px-3 c12\">{GFunc.caption('e')}{GFunc.numberToString(e, 4)}</div>\r\n                <div className=\"px-3 c12\">{GFunc.caption('指数b')}{GFunc.numberToString(b, 4)}</div>\r\n                <div className=\"px-3 c12\">{GFunc.caption('r2')}{GFunc.numberToString(r2, 4)}</div>\r\n                <div className=\"px-3 c12\">{GFunc.caption('e预测')}{GFunc.numberToString(epre)}</div>\r\n            </div>\r\n            <div className=\"px-3 py-2 bg-white\">线性回归预测</div>\r\n            <div className=\"d-flex flex-wrap\">\r\n                <div className=\"px-3 c12\">{GFunc.caption('e')}{GFunc.numberToString(e, 4)}</div>\r\n                <div className=\"px-3 c12\">{GFunc.caption('增长率')}{GFunc.numberToString(l, 4)}</div>\r\n                <div className=\"px-3 c12\">{GFunc.caption('r2')}{GFunc.numberToString(lr2, 4)}</div>\r\n                <div className=\"px-3 c12\">{GFunc.caption('e预测')}{GFunc.numberToString(lpre)}</div>\r\n            </div>\r\n            <div className=\"d-flex\">\r\n                <div className=\"px-2\" style={{ width: '50%' }}>{chart1}</div>\r\n                <div className=\"px-2\" style={{ width: '50%' }}>{chart2}</div>\r\n            </div>\r\n            <div className=\"d-flex\">\r\n                <div className=\"px-2\" style={{ width: '50%' }}>{chart3}</div>\r\n            </div>\r\n        </>;\r\n    });\r\n\r\n    protected predictChartFullInfo = () => {\r\n        let { predictSeasonDataFull } = this.controller;\r\n        let len = predictSeasonDataFull.length;\r\n        if (len <= 0)\r\n            return <></>;\r\n        let label = [];\r\n        let y: number[] = [];\r\n        for (let i = len - 1; i >= 0; --i) {\r\n            let item = predictSeasonDataFull[i];\r\n            if (item.esum === undefined)\r\n                continue;\r\n            label.push(GFunc.SeasonnoToYearMonth(item.season));\r\n            y.push(item.esum);\r\n        }\r\n\r\n        let er = new ErForEarning(y);\r\n        let chartdataFull = {\r\n            labels: label,\r\n            datasets: [\r\n                {\r\n                    label: '原值',\r\n                    data: y.map(v => GFunc.numberToPrecision(v)),\r\n                    borderColor: 'black',\r\n                    backgroundColor: 'skyBlue',\r\n                    showLine: false,\r\n                    pointStyle: \"crossRot\",\r\n                    borderWidth: 1,\r\n                    pointRadius: 5,\r\n                    fill: false,\r\n                } as any\r\n            ]\r\n        };\r\n        if (!(isNaN(er.B) || isNaN(er.A))) {\r\n            let per: number[] = [];\r\n            for (let i = 0; i < len; ++i) {\r\n                per.push(GFunc.numberToPrecision(er.predict(i), 4));\r\n            }\r\n            chartdataFull.datasets.push(\r\n                {\r\n                    label: '指数 R2:' + GFunc.numberToString(er.r2, 4),\r\n                    data: per,\r\n                    borderColor: 'red',\r\n                    backgroundColor: 'pink',\r\n                    borderWidth: 1,\r\n                    fill: false,\r\n                });\r\n        }\r\n        let lr = new SlrForEarning(y);\r\n        if (!(isNaN(lr.slope) || isNaN(lr.intercept))) {\r\n            let plr: number[] = [];\r\n            for (let i = 0; i < len; ++i) {\r\n                plr.push(GFunc.numberToPrecision(lr.predict(i), 4));\r\n            }\r\n            chartdataFull.datasets.push(\r\n                {\r\n                    label: '线性 R2:' + GFunc.numberToString(lr.r2, 4),\r\n                    data: plr,\r\n                    borderColor: 'blue',\r\n                    backgroundColor: 'pink',\r\n                    borderWidth: 1,\r\n                    fill: false,\r\n                });\r\n        }\r\n        return <RC2 data={chartdataFull} type='line' />;\r\n    };\r\n\r\n    protected predictChartROE = () => {\r\n        let { predictSeasonDataFull } = this.controller;\r\n        let len = predictSeasonDataFull.length;\r\n        if (len <= 0)\r\n            return <></>;\r\n        let label = [];\r\n        let y: number[] = [];\r\n        for (let i = len - 1; i >= 0; --i) {\r\n            let item = predictSeasonDataFull[i];\r\n            if (item.esum === undefined)\r\n                continue;\r\n            label.push(GFunc.SeasonnoToYearMonth(item.season));\r\n            y.push(item.esumorg / item.corg);\r\n        }\r\n\r\n        let chartdataFull = {\r\n            labels: label,\r\n            datasets: [\r\n                {\r\n                    label: 'ROE原值',\r\n                    data: y.map(v => GFunc.numberToPrecision(v)),\r\n                    borderColor: 'black',\r\n                    backgroundColor: 'skyBlue',\r\n                    showLine: false,\r\n                    pointStyle: \"crossRot\",\r\n                    borderWidth: 1,\r\n                    pointRadius: 5,\r\n                    fill: false,\r\n                } as any\r\n            ]\r\n        };\r\n        let lr = new SlrForEarning(y);\r\n        if (!(isNaN(lr.slope) || isNaN(lr.intercept))) {\r\n            let plr: number[] = [];\r\n            for (let i = 0; i < len; ++i) {\r\n                plr.push(Number.parseFloat(lr.predict(i).toPrecision(4)));\r\n            }\r\n            chartdataFull.datasets.push(\r\n                {\r\n                    label: '线性 R2:' + GFunc.numberToString(lr.r2, 4),\r\n                    data: plr,\r\n                    borderColor: 'blue',\r\n                    backgroundColor: 'pink',\r\n                    borderWidth: 1,\r\n                    fill: false,\r\n                });\r\n        }\r\n        return <RC2 data={chartdataFull} type='line' />;\r\n    };\r\n\r\n    private predictSeasonEarning = observer(() => {\r\n        let items = this.controller.predictSeasonData;\r\n        let header = <div className=\"px-3\">\r\n            <div className=\"px-3 c6\">年月</div>\r\n            <div className=\"px-3 c6 text-right\">股本</div>\r\n            <div className=\"px-3 c6 text-right\">季收益</div>\r\n            <div className=\"px-3 c6 text-right\">年收益</div>\r\n            <div className=\"px-3 c6 text-right\">ROE</div>\r\n            <div className=\"px-3 c6 text-right\">股本o</div>\r\n            <div className=\"px-3 c6 text-right\">季收益o</div>\r\n            <div className=\"px-3 c6 text-right\">年收益o</div>\r\n        </div>;\r\n        return <>\r\n            <div className=\"px-3 py-1\">历年股本收益-用于回归计算</div>\r\n            <List header={header} loading=\"...\"\r\n                items={items}\r\n                item={{\r\n                    render: (row: { season: number, c: number, e: number, esum: number, corg: number, eorg: number, esumorg: number }) => {\r\n                        let { season, c, e, esum, corg, eorg, esumorg } = row;\r\n                        let ym = GFunc.SeasonnoToYearMonth(season);\r\n                        let a = 0;\r\n                        return <div className=\"px-3 py-2 d-flex flex-wrap\">\r\n                            <div className=\"px-3 c6\">{ym.toString()}</div>\r\n                            <div className=\"px-3 c6 text-right\">{GFunc.numberToFixString(c)}</div>\r\n                            <div className=\"px-3 c6 text-right\">{GFunc.numberToFixString(e)}</div>\r\n                            <div className=\"px-3 c6 text-right\">{GFunc.numberToFixString(esum)}</div>\r\n                            <div className=\"px-3 c6 text-right\">{GFunc.percentToFixString(esum / c)}</div>\r\n                            <div className=\"px-3 c6 text-right\">{GFunc.numberToFixString(corg)}</div>\r\n                            <div className=\"px-3 c6 text-right\">{GFunc.numberToFixString(eorg)}</div>\r\n                            <div className=\"px-3 c6 text-right\">{GFunc.numberToFixString(esumorg)}</div>\r\n                        </div>\r\n                    }\r\n                }}\r\n            />\r\n        </>\r\n    });\r\n\r\n\r\n    private seasonEarning = observer(() => {\r\n        let items = this.controller.seasonData;\r\n        let header = <div className=\"px-3\">\r\n            <div className=\"px-3 c6\">年月</div>\r\n            <div className=\"px-3 c6 text-right\">股本</div>\r\n            <div className=\"px-3 c6 text-right\">季收益</div>\r\n            <div className=\"px-3 c6 text-right\">年收益</div>\r\n            <div className=\"px-3 c6 text-right\">ROE</div>\r\n            <div className=\"px-3 c6 text-right\">股本o</div>\r\n            <div className=\"px-3 c6 text-right\">季收益o</div>\r\n            <div className=\"px-3 c6 text-right\">年收益o</div>\r\n        </div>;\r\n        return <>\r\n            <div className=\"px-3 py-1\">历年季度股本收益</div>\r\n            <List header={header} loading=\"...\"\r\n                items={items}\r\n                item={{\r\n                    render: (row: { season: number, c: number, e: number, esum: number, corg: number, eorg: number, esumorg: number }) => {\r\n                        let { season, c, e, esum, corg, eorg, esumorg } = row;\r\n                        let ym = GFunc.SeasonnoToYearMonth(season);\r\n                        let a = 0;\r\n                        return <div className=\"px-3 py-2 d-flex flex-wrap\">\r\n                            <div className=\"px-3 c6\">{ym.toString()}</div>\r\n                            <div className=\"px-3 c6 text-right\">{GFunc.numberToFixString(c)}</div>\r\n                            <div className=\"px-3 c6 text-right\">{GFunc.numberToFixString(e)}</div>\r\n                            <div className=\"px-3 c6 text-right\">{GFunc.numberToFixString(esum)}</div>\r\n                            <div className=\"px-3 c6 text-right\">{GFunc.percentToFixString(esum / c)}</div>\r\n                            <div className=\"px-3 c6 text-right\">{GFunc.numberToFixString(corg)}</div>\r\n                            <div className=\"px-3 c6 text-right\">{GFunc.numberToFixString(eorg)}</div>\r\n                            <div className=\"px-3 c6 text-right\">{GFunc.numberToFixString(esumorg)}</div>\r\n                        </div>\r\n                    }\r\n                }}\r\n            />\r\n        </>\r\n    });\r\n\r\n\r\n    private capitalEarning = observer(() => {\r\n        let items = this.controller.capitalearning;\r\n        let header = <div className=\"px-3\">\r\n            <div className=\"px-3 c6\">年</div>\r\n            <div className=\"px-3 c6 text-right\">股本</div>\r\n            <div className=\"px-3 c6 text-right\">收益</div>\r\n            <div className=\"px-3 c6 text-right\">ROE</div>\r\n        </div>;\r\n        return <>\r\n            <div className=\"px-3 py-1\">历年股本收益</div>\r\n            <List header={header} loading=\"...\"\r\n                items={items}\r\n                item={{\r\n                    render: (row: StockCapitalearning) => {\r\n                        let { capital, earning } = row;\r\n                        return <div className=\"px-3 py-2 d-flex flex-wrap\">\r\n                            <div className=\"px-3 c6\">{row.year}</div>\r\n                            <div className=\"px-3 c6 text-right\"> {capital.toFixed(2)}</div>\r\n                            <div className=\"px-3 c6 text-right\"> {earning.toFixed(2)}</div>\r\n                            <div className=\"px-3 c6 text-right\"> {(earning / capital * 100).toFixed(1)}%</div>\r\n                        </div>\r\n                    }\r\n                }}\r\n            />\r\n        </>\r\n    });\r\n\r\n    private bonus = observer(() => {\r\n        let items = this.controller.bonus;\r\n        let header = <div className=\"px-3\">\r\n            <div className=\"px-3 c8\">日期</div>\r\n            <div className=\"px-3 c6 text-right\">分红</div>\r\n        </div>;\r\n        return <>\r\n            <div className=\"px-3 py-1\">历年分红</div>\r\n            <List header={header} loading=\"...\"\r\n                items={items}\r\n                item={{\r\n                    render: (row: StockBonus) => {\r\n                        return <div className=\"px-3 py-2 d-flex flex-wrap\">\r\n                            <div className=\"px-3 c8\">{row.day}</div>\r\n                            <div className=\"px-3 c6 text-right\"> {row.bonus.toFixed(2)}</div>\r\n                        </div>\r\n                    }\r\n                }}\r\n            />\r\n        </>\r\n    });\r\n}","import { defaultBlackListGroupName, defaultGroupName } from \"consts\";\r\nimport { IObservableArray, observable } from \"mobx\";\r\nimport { MiNet } from \"../net\";\r\nimport { StockGroup } from \"./stockGroup\";\r\n\r\nexport class StockGroups {\r\n\tprivate miNet: MiNet;\r\n\treadonly groups: IObservableArray<StockGroup>;\r\n\tdefaultGroup: StockGroup;\r\n\tblackGroup: StockGroup;\r\n\r\n\tconstructor(miNet: MiNet) {\r\n\t\tthis.miNet = miNet;\r\n\t\tthis.groups = observable.array<StockGroup>([], { deep: true });\r\n\t}\r\n\r\n\tasync init() {\r\n\t\tthis.defaultGroup = this.groupFromName(defaultGroupName);\r\n\t\tthis.blackGroup = this.groupFromName(defaultBlackListGroupName);\r\n\t\tawait Promise.all([\r\n\t\t\tthis.defaultGroup?.loadItems(),\r\n\t\t\tthis.blackGroup?.loadItems(),\r\n\t\t]);\r\n\t}\r\n\t\r\n\tgroupFromName(groupName:string) {\r\n\t\treturn this.groups.find(v => v.name === groupName);\r\n\t}\r\n\r\n\tgroupFromId(id:number) {\r\n\t\treturn this.groups.find(v => v.id === id);\r\n\t}\r\n\r\n\tget group0() {return this.groups[0]}\r\n\r\n\tgetSelected(tags:{tag:number}[]) {\r\n\t\tlet ret = this.groups.filter(v => {\r\n\t\t\tlet i = tags.findIndex(st => st.tag === v.id);\r\n\t\t\treturn i >= 0;\r\n\t\t});\r\n\t\treturn ret;\r\n\t}\r\n\r\n\tadd(group: StockGroup) {\r\n\t\tthis.groups.push(group);\r\n\t}\r\n\r\n\texists(id:number, name:string): boolean {\r\n\t\treturn this.groups.findIndex(v => v.id === id && v.name === name) >= 0;\r\n\t}\r\n\t\r\n\tisMySelect(id:number): boolean {\r\n\t\tfor (let group of this.groups) {\r\n\t\t\tif (group.exists(id) === true) return true;\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\t\r\n\tisMyBlack(id:number): boolean {\r\n\t\tif (!this.blackGroup) return false;\r\n\t\treturn this.blackGroup.exists(id);\r\n\t}\r\n\r\n\tasync load(): Promise<void> {\r\n\t\tlet r = await this.miNet.t_tag$all();\r\n\t\tlet ret = r as any[];\r\n\t\tlet bc = await this.checkDefaultTags(ret);\r\n\t\tif (bc) {\r\n\t\t\t//r = await this.miApi.query('t_tag$all', [this.user.id]);\r\n\t\t\tr = await this.miNet.t_tag$all();\r\n\t\t\tret = r as any[];\r\n\t\t}\r\n\t\tlet r1 = [];\r\n\t\tlet i = ret.findIndex(v=>v.name === defaultGroupName);\r\n\t\tif (i >= 0) {\r\n\t\t\tr1.push(ret[i]);\r\n\t\t\tret.splice(i, 1);\r\n\t\t}\r\n\t\ti = ret.findIndex(v=> v.name === defaultBlackListGroupName);\r\n\t\tif (i >= 0) {\r\n\t\t\tr1.push(ret[i]);\r\n\t\t\tret.splice(i, 1);\r\n\t\t}\r\n\t\tr1.push(...ret);\r\n\t\tthis.groups.replace(r1.map(v => new StockGroup(v.name, v.id, this.miNet)));\r\n\t}\r\n\r\n\tprivate async checkDefaultTags(list:any[]): Promise<boolean> {\r\n\t\tlet br = false;\r\n\t\tif (list === undefined) {\r\n\t\t\tawait this.miNet.t_tag$save(defaultGroupName);\r\n\t\t\tawait this.miNet.t_tag$save(defaultBlackListGroupName);\r\n\t\t\tbr = true;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tlet i = list.findIndex(v => v.name === defaultGroupName);\r\n\t\t\tif (i < 0) {\r\n\t\t\t\tawait this.miNet.t_tag$save(defaultGroupName);\r\n\t\t\t\tbr = true;\r\n\t\t\t}\r\n\t\t\ti = list.findIndex(v => v.name === defaultBlackListGroupName);\r\n\t\t\tif (i < 0) {\r\n\t\t\t\tawait this.miNet.t_tag$save(defaultBlackListGroupName);\r\n\t\t\t\tbr = true;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn br;\r\n\t}\r\n}\r\n","import { IObservableArray, observable, runInAction } from \"mobx\";\r\n//import { SlrForEarning } from \"regression\";\r\nimport { GFunc } from \"tool\";\r\nimport { MiNet } from \"../net\";\r\nimport { sortStocks } from \"./sortStocks\";\r\nimport { Stock } from \"./types\";\r\n\r\nexport class StockGroup {\r\n\tprivate miNet: MiNet;\r\n\tprivate sortType: string;\r\n\r\n\tid: number;\r\n\tname: string;\r\n\tstocks: IObservableArray<Stock>;\r\n\r\n\tconstructor(groupName:string, groupId:number, miNet: MiNet) {\r\n\t\tthis.name = groupName;\r\n\t\tthis.id = groupId;\r\n\t\tthis.miNet = miNet;\r\n\t\tthis.stocks = observable.array<Stock>([], { deep: true });\r\n\t}\r\n\r\n\tasync loadItems() {\r\n\t\t// 距离上次\r\n\t\tlet queryName = 'taguser';\r\n\r\n\t\tlet query = {\r\n\t\t\tname: queryName,\r\n\t\t\tpageStart: 0,\r\n\t\t\tpageSize: 1000,\r\n\t\t\tuser: this.miNet.userId,\r\n\t\t\ttag: this.id,\r\n\t\t\tyearlen: 1,\r\n\t\t};\r\n\t\tlet result = await this.miNet.process(query, []);\r\n\t\tif (Array.isArray(result) === false) return;\r\n\r\n\t\tlet arr: Stock[] = result;\r\n\t\tfor (let item of arr) {\r\n            let data = item.data;\r\n\t\t\tlet dataArray = data ===undefined ? [] : JSON.parse(item.data) as number[];\r\n\t\t\titem.dataArr = dataArray;\r\n            let e = item.e * item.eshares;\r\n            let p = item.price * item.pshares;\r\n            let c = item.capital * item.eshares;\r\n            let b = item.bonus * item.bshares;\r\n\t\t\titem.v = GFunc.calculateVS(item.ev * item.eshares, b, p);\r\n            item.pe = p / e;\r\n            item.roe = e / c;\r\n            item.divyield = b / p;\r\n\t\t}\r\n\t\tsortStocks(undefined, arr);\r\n\r\n\t\trunInAction(() => {\r\n\t\t\tthis.stocks.clear();\r\n\t\t\tthis.stocks.push(...arr);\t\r\n\t\t});\r\n\t}\r\n\r\n\tsort(sortType: string) {\r\n\t\tthis.sortType = sortType;\r\n\t\tsortStocks(sortType, this.stocks);\r\n\t}\r\n\r\n\tasync addStock(stock: Stock) {\r\n\t\tawait this.miNet.t_tagstock$add(this.id, stock.id);\r\n\t\tlet index = this.stocks.findIndex(v => v.id === stock.id);\r\n\t\tif (index >= 0) {\r\n\t\t\tlet rows = this.stocks.splice(index, 1);\r\n\t\t\tthis.stocks.unshift(rows[0]);\r\n\t\t}\r\n\t\telse {\r\n\t\t\t// 重新加载stock的其它值\r\n\t\t\t// await ...\r\n\t\t\t//this.stocks.unshift(stock);\r\n\t\t\tawait this.loadItems();\r\n\t\t\tsortStocks(this.sortType, this.stocks);\r\n\t\t}\r\n\t}\r\n\r\n\tasync removeStock(stock: Stock) {\r\n\t\tawait this.miNet.t_tagstock$del(this.id, stock.id);\r\n\t\tlet index = this.stocks.findIndex(v => v.id === stock.id);\r\n\t\tif (index >= 0) this.stocks.splice(index, 1);\r\n\t}\r\n\r\n\texists(stockId: number): boolean {\r\n\t\tfor (let stock of this.stocks) {\r\n\t\t\tif (stock.id === stockId) return true;\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n}\r\n","import { IObservableArray, makeObservable, observable, runInAction } from \"mobx\";\r\nimport { Account, AccountValue, Holding, Portfolio } from \"uq-app/uqs/BruceYuMi\";\r\nimport { HoldingStock } from \"./holdingStock\";\r\nimport { Store } from \"./store\";\r\n\r\nexport class MiAccount  implements Account, AccountValue {\r\n\tprotected store: Store;\r\n\tid: number;\r\n\tno: string;\r\n\tname: string;\r\n\tcount: number = 0;\r\n\tmi: number = 0;\r\n\tmarket: number = 0;\r\n\tdivident: number = 0;\r\n\tcash: number = null;\r\n\r\n\tholdingStocks: IObservableArray<HoldingStock> = null;\r\n\r\n\tconstructor(store: Store, account: Account&AccountValue) {\r\n\t\tmakeObservable(this, {\r\n\t\t\tholdingStocks: observable,\r\n\t\t\tcount: observable,\r\n\t\t\tmi: observable,\r\n\t\t\tmarket: observable,\r\n\t\t\tdivident: observable,\r\n\t\t\tcash: observable,\r\n\t\t})\r\n\t\tthis.store = store;\r\n\t\trunInAction(() => {\r\n\t\t\tObject.assign(this, account);\r\n\t\t\tthis.cash = undefined;\r\n\t\t});\r\n\t}\r\n\r\n\tasync loadItems() {\r\n\t\tif (this.holdingStocks) return;\r\n\t\tlet {yumi} = this.store;\r\n\t\tlet ret = await yumi.IX<Holding&Portfolio>({\r\n\t\t\t// IX: yumi.UserAccount,\r\n\t\t\tIX: yumi.AccountHolding,\r\n\t\t\tix: this.id,\r\n\t\t\tIDX: [yumi.Holding, yumi.Portfolio]\r\n\t\t});\r\n\t\tlet noneStocks = ret.filter(v => !this.store.stockFromId(v.stock));\r\n\t\tif (noneStocks.length > 0) {\r\n\t\t\tawait yumi.ActIX({\r\n\t\t\t\tIX: yumi.UserAllStock,\r\n\t\t\t\tvalues: noneStocks.map(v => ({ix:undefined, id: v.stock}))\r\n\t\t\t});\r\n\t\t\tawait this.store.loadMyAll();\r\n\t\t}\r\n\t\trunInAction(() => {\r\n\t\t\tthis.holdingStocks = observable(ret.map(v => {\r\n\t\t\t\tlet {id, stock:stockId} = v;\r\n\t\t\t\tlet stock = this.store.stockFromId(stockId);\r\n\t\t\t\tlet holdingStock = new HoldingStock(id, stock, v.quantity);\r\n\t\t\t\treturn holdingStock;\r\n\t\t\t}));\r\n\t\t\tthis.count = this.holdingStocks.length;\r\n\t\t});\r\n\t}\r\n\r\n\tasync buyNewHolding(stockId: number, price: number, quantity: number) {\r\n\t\tlet holdingId: number;\r\n\t\tlet stock = this.store.stockFromId(stockId);\r\n\t\tif (!stock) {\r\n\t\t\tstock = await this.store.loadStock(stockId);\r\n\t\t\tif (!stock) throw new Error(`stock ${stockId} not exists`);\r\n\t\t}\r\n\t\tlet index = this.holdingStocks.findIndex(v => v.stock === stockId);\r\n\t\tif (index < 0) {\r\n\t\t\tholdingId = await this.saveHolding(stockId);\r\n\t\t\tawait this.store.addMyAll(stock);\r\n\t\t\tlet hs = new HoldingStock(holdingId, stock, quantity);\r\n\t\t\ths.setQuantity(price, quantity);\r\n\t\t\trunInAction(() => {\r\n\t\t\t\tthis.holdingStocks.push(hs);\r\n\t\t\t})\r\n\t\t}\r\n\t\telse {\r\n\t\t\tlet orgHs = this.holdingStocks[index];\r\n\t\t\tholdingId = orgHs.id;\r\n\t\t\tlet holdingQuantity = orgHs.quantity + quantity;\r\n\t\t\torgHs.setQuantity(price, holdingQuantity);\r\n\t\t}\r\n\t\tawait this.bookHolding(holdingId, price, quantity);\r\n\t}\r\n\r\n\tasync buyHolding(stockId: number, price: number, quantity: number) {\r\n\t\tlet index = this.holdingStocks.findIndex(v => v.stock === stockId);\r\n\t\tif (index < 0) return;\r\n\t\tlet orgHs = this.holdingStocks[index];\r\n\t\tlet holdingId = orgHs.id;\r\n\t\tlet holdingQuantity = orgHs.quantity + quantity;\r\n\t\trunInAction(() => {\r\n\t\t\torgHs.setQuantity(price, holdingQuantity);\r\n\t\t});\r\n\t\tawait this.bookHolding(holdingId, price, quantity);\r\n\t}\r\n\r\n\tprivate async saveHolding(stock:number): Promise<number> {\r\n\t\tlet ret = await this.store.yumi.Acts({\r\n\t\t\tholding: [{account: this.id, stock, order: undefined}]\r\n\t\t});\r\n\t\treturn ret.holding[0];\r\n\t}\r\n\r\n\tprivate async bookHolding(holdingId:number, price:number, quantity:number): Promise<void> {\r\n\t\tthis.recalc();\r\n\t\tawait this.store.yumi.Acts({\r\n\t\t\taccountValue: [{\r\n\t\t\t\tid: this.id,\r\n\t\t\t\tmi: this.mi,\r\n\t\t\t\tmarket: this.market,\r\n\t\t\t\tcount: this.count,\r\n\t\t\t}],\r\n\t\t\taccountHolding: [{\r\n\t\t\t\tix: this.id,\r\n\t\t\t\tid: holdingId\r\n\t\t\t}],\r\n\t\t\tportfolio: [{\r\n\t\t\t\tid: holdingId,\r\n\t\t\t\tquantity: quantity,\r\n\t\t\t}],\r\n\t\t\ttransaction: [{\r\n\t\t\t\tholding: holdingId,\r\n\t\t\t\ttick: undefined,\r\n\t\t\t\tprice, \r\n\t\t\t\tquantity,\r\n\t\t\t\tamount: price * quantity,\r\n\t\t\t}],\r\n\t\t});\r\n\t}\r\n\r\n\tasync sellHolding(stockId: number, price: number, quantity: number) {\r\n\t\tlet holding = this.holdingStocks.find(v => v.stock === stockId);\r\n\t\tif (holding === undefined) return;\r\n\t\trunInAction(() => {\r\n\t\t\tholding.setQuantity(price, holding.quantity - quantity);\r\n\t\t});\r\n\t\tawait this.bookHolding(holding.id, price, -quantity);\r\n\t}\r\n\r\n\tprivate recalc() {\r\n\t\tthis.count = this.holdingStocks.length;\r\n\t\tlet sumMi = 0, sumMarket = 0, sumDivident = 0;\r\n\t\tfor (let sh of this.holdingStocks) {\r\n\t\t\tlet {mi, market, divident} = sh;\r\n\t\t\tsumMi += mi;\r\n\t\t\tsumMarket += market;\r\n\t\t\tsumDivident += divident;\r\n\t\t}\r\n\t\tthis.mi = sumMi;\r\n\t\tthis.market = sumMarket;\r\n\t\tthis.divident = sumDivident;\r\n\t}\r\n\r\n\tprivate async cashAct(amount: number, act: string):Promise<void> {\r\n\t\tawait this.store.yumi.Acts({\r\n\t\t\taccountValue: [{id: this.id, cash: {value: amount, act:'+'}}]\r\n\t\t});\r\n\t}\r\n\r\n\tasync cashInit(amount: number) {\r\n\t\tawait this.cashAct(amount, 'init');\r\n\t\trunInAction(() => {\r\n\t\t\tif (typeof this.cash !== 'number') this.cash = amount;\r\n\t\t});\r\n\t}\r\n\r\n\tasync cashIn(amount: number) {\r\n\t\tawait this.cashAct(amount, 'in');\r\n\t\trunInAction(() => {\r\n\t\t\tif (!this.cash) this.cash = amount;\r\n\t\t\telse this.cash += amount;\r\n\t\t});\r\n\t}\r\n\r\n\tasync cashOut(amount: number) {\r\n\t\tawait this.cashAct(-amount, 'out');\r\n\t\trunInAction(() => {\r\n\t\t\tthis.cash -= amount;\r\n\t\t});\r\n\t}\r\n\r\n\tasync cashAdjust(amount: number) {\r\n\t\tawait this.cashAct(amount, 'adjust');\r\n\t\trunInAction(() => {\r\n\t\t\tif (!this.cash) this.cash = amount;\r\n\t\t\telse this.cash += amount;\r\n\t\t});\r\n\t}\r\n}\r\n","import { IObservableArray, makeObservable, observable, runInAction} from \"mobx\";\r\nimport { EnumGroupType, Group, Stock, StockValue } from \"uq-app/uqs/BruceYuMi\";\r\nimport { Store } from \"./store\";\r\n\r\nexport class MiGroup implements Group {\r\n\tprotected readonly store: Store;\r\n\tid: number;\r\n\tname: string;\r\n\tcount: number;\r\n\ttype: EnumGroupType;\r\n\tstocks: IObservableArray<Stock & StockValue> = null;\r\n\r\n\tconstructor(store:Store, group:Group, stockCount:number) {\r\n\t\tmakeObservable(this, {\r\n\t\t\tstocks: observable,\r\n\t\t\tcount: observable,\r\n\t\t});\r\n\t\tthis.store = store;\r\n\t\tObject.assign(this, group);\r\n\t\tthis.count = stockCount;\r\n\t}\r\n\r\n\tasync loadItems() {\r\n\t\tif (this.stocks) return;\r\n\t\tlet ret = await this.store.loadGroupStocks(this.id);\r\n\t\trunInAction(() => {\r\n\t\t\tthis.stocks = observable(ret, {deep: false});\r\n\t\t\tthis.count = this.stocks.length;\r\n\t\t});\r\n\t}\r\n\r\n\taddStock(stock: Stock & StockValue, stockCount: number) {\r\n\t\tif (this.stocks) {\r\n\t\t\tthis.stocks.push(stock);\r\n\t\t\tthis.count = this.stocks.length + 1;\r\n\t\t}\r\n\t}\r\n\r\n\tremoveStock(stock: Stock & StockValue, stockCount: number) {\r\n\t\tif (this.stocks) {\r\n\t\t\tlet stockId = stock.id;\r\n\t\t\tlet index = this.stocks.findIndex(v => v.id === stockId);\r\n\t\t\tif (index >= 0) this.stocks.splice(index, 1);\r\n\t\t}\r\n\t}\r\n\r\n\texists(stockId: number) {\r\n\t\treturn this.stocks?.findIndex(v => v.id === stockId) \r\n\t}\r\n}\r\n","import {CenterApiBase} from '../net';\r\n\r\nexport class CenterApi extends CenterApiBase {\r\n    async userAppUnits(app:number):Promise<any[]> {\r\n        return await this.get('tie/user-app-units', {app:app});\r\n    }\r\n    async userFromId(userId:number):Promise<any> {\r\n        return await this.get('user/user-name-nick-icon-from-id', {userId:userId});\r\n\t}\r\n\tasync userFromKey(userName:string):Promise<any> {\r\n\t\treturn await this.get('tie/user-from-key', {key:userName});\r\n\t}\r\n}\r\n\r\nexport const centerApi = new CenterApi('tv/', undefined);\r\n","//import * as React from 'react';\r\nimport { Page, nav, LMR } from \"../components\";\r\nimport { VPage } from '../vm';\r\n//import { appInFrame } from '../net';\r\nimport { CAppBase } from \"./CAppBase\";\r\n//import { UQsMan } from '../uq';\r\n\r\n/*\r\nexport class VAppMain extends VPage<CMainBase> {\r\n    async open(param?:any) {\r\n        this.openPage(this.appPage);\r\n    }\r\n\r\n    render(param?:any) {\r\n        return this.appContent();\r\n    }\r\n\r\n    protected appPage = () => {\r\n        let {caption} = this.controller;\r\n        return <Page header={caption} logout={async()=>{appInFrame.unit = undefined}}>\r\n            {this.appContent()}\r\n        </Page>;\r\n    }\r\n\r\n    protected appContent = () => {\r\n        let {cUqArr} = this.controller;\r\n        let content:any;\r\n        if (cUqArr.length === 0) {\r\n            content = <div className=\"text-danger\">\r\n                <FA name=\"\" /> 此APP没有绑定任何的UQ\r\n            </div>;\r\n        }\r\n        else {\r\n            content = cUqArr.map((v,i) => <div key={i}>{v.render()}</div>);\r\n        }\r\n        return <>{content}</>;\r\n    };\r\n}\r\n*/\r\nexport class VUnsupportedUnit extends VPage<CAppBase<any>> {\r\n\tprivate params: {predefinedUnit:number, uqsLoadErrors:string[]};\r\n    async open(params: {predefinedUnit:number, uqsLoadErrors:string[]}) {\r\n\t\tthis.params = params;\r\n        this.openPage(this.page);\r\n    }\r\n\r\n    private page = () => {\r\n\t\tlet {predefinedUnit, uqsLoadErrors} = this.params;\r\n        let {user} = nav;\r\n\t\tlet userName:string = user? user.name : '[未登录]';\r\n\t\t//let {appOwner, appName} = UQsMan.value;\r\n        return <Page header=\"APP无法运行\" logout={true}>\r\n            <div className=\"m-3 text-danger container\">\r\n                <div className=\"form-group row\">\r\n                    <div className=\"col-sm-3 font-weight-bold\">登录用户</div>\r\n                    <div className=\"col-sm text-body\">{userName}</div>\r\n                </div>\r\n                <div className=\"form-group row\">\r\n                    <div className=\"col-sm-3 font-weight-bold\">预设小号</div>\r\n                    <div className=\"col-sm text-body\">{predefinedUnit || <small className=\"\">[无预设小号]</small>}</div>\r\n                </div>\r\n\t\t\t\t{\r\n\t\t\t\t\tuqsLoadErrors && uqsLoadErrors.map(v => {\r\n\t\t\t\t\t\treturn <div className=\"form-group row\">\r\n\t\t\t\t\t\t\t<div className=\"col-sm-3 font-weight-bold\">App</div>\r\n\t\t\t\t\t\t\t<div className=\"col-sm text-body\">{v}</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n                <div className=\"form-group row\">\r\n                    <div className=\"col-sm-3 font-weight-bold\">小号{predefinedUnit}</div>\r\n                    <div className=\"col-sm text-body\">\r\n                        预设小号定义在 public/unit.json 文件中。\r\n                        定义了这个文件的程序，只能由url直接启动。\r\n                        用户第一次访问app之后，会缓存在localStorage里。<br/>\r\n                        如果要删去缓存的预定义Unit，logout然后再login。\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\t\t</Page>;\t\t\r\n\t}\r\n\t/*\r\n\t<div className=\"form-group row\">\r\n\t\t<div className=\"col-sm-3 font-weight-bold\">\r\n\t\t\t可能原因<FA name=\"exclamation-triangle\" />\r\n\t\t</div>\r\n\t\t<div className=\"col-sm text-body\">\r\n\t\t\t<ul className=\"p-0\">\r\n\t\t\t\t<li>没有小号运行 {appName}</li>\r\n\t\t\t\t<li>用户 <b>{userName}</b> 没有加入任何一个运行{appName}的小号</li>\r\n\t\t\t\t{\r\n\t\t\t\t\tpredefinedUnit && \r\n\t\t\t\t\t<li>预设小号 <b>{predefinedUnit}</b> 没有运行App {appName}</li>\r\n\t\t\t\t}\r\n\t\t\t</ul>\r\n\t\t</div>\r\n\t</div>\r\n\t*/\r\n}\r\n\r\nexport class VUnitSelect extends VPage<CAppBase<any>> {\r\n    async open() {\r\n        this.openPage(this.page);\r\n    }\r\n\r\n    private renderRow = (item: any, index: number):JSX.Element => {\r\n        let {id, nick, name} = item;\r\n        return <LMR className=\"px-3 py-2\" right={'id: ' + id}>\r\n            <div>{nick || name}</div>\r\n        </LMR>;\r\n    }\r\n    private onRowClick = async (appUnit: any) => {\r\n\t\t//appInFrame.unit = appUnit.id; // 25;\r\n\t\t//this.controller.setAppUnit(appUnit);\r\n        await this.controller.start();\r\n    }\r\n\r\n    private page = () => {\r\n        return <Page header=\"选择小号\" logout={true}>\r\n\t\t\t<div>this.controller.appUnits appUnits removed</div>\r\n        </Page>\r\n        // <List items={this.controller.appUnits} item={{render: this.renderRow, onClick: this.onRowClick}}/>\r\n\t}\r\n}\r\n\r\nexport class VErrorsPage extends VPage<CAppBase<any>> {\r\n    async open(errors:string[]) {\r\n        this.openPage(this.page, {errors:errors});\r\n    }\r\n\r\n    private page = (errors:{errors:string[]}) => {\r\n        return <Page header=\"ERROR\">\r\n            <div className=\"m-3\">\r\n\t\t\t\t<div className=\"p-3 d-flex justify-content-center align-items-center\">\r\n\t\t\t\t\t<button className=\"btn btn-danger\" onClick={nav.resetAll}>重启网页</button>\r\n\t\t\t\t</div>\r\n\r\n                <div>Load Uqs 发生错误：</div>\r\n                {errors.errors.map((r, i) => <div key={i}>{r}</div>)}\r\n            </div>\r\n        </Page>;\r\n    }\r\n}\r\n\r\nexport class VStartError extends VPage<CAppBase<any>> {\r\n    async open(error:any) {\r\n        this.openPage(this.page, {error:error});\r\n    }\r\n\r\n    private page = ({error}:{error:any}) => {\r\n        return <Page header=\"App start error!\">\r\n            <pre>\r\n                {typeof error === 'string'? error : error.message}\r\n            </pre>\r\n        </Page>;\r\n    }\r\n}","import { nav, RouteFunc, Hooks, Navigo, NamedRoute } from \"../components\";\r\nimport { t, setGlobalRes } from '../res';\r\nimport { Controller } from '../vm';\r\nimport { UQsMan, TVs } from \"../uq\";\r\nimport { centerApi } from \"./centerApi\";\r\nimport { VErrorsPage, VStartError } from \"./vMain\";\r\nimport { User } from \"../tool\";\r\n\r\nexport interface IConstructor<T> {\r\n    new (...args: any[]): T;\r\n}\r\n\r\nexport interface DevConfig {\r\n\tname: string;\r\n\talias?: string;\r\n\tmemo?: string;\r\n}\r\n\r\nexport interface UqConfig {\r\n\tdev: DevConfig;\r\n\tname: string;\r\n\talias?: string;\t\r\n\tversion?: string;\r\n\tmemo?: string;\r\n}\r\n\r\nexport interface UqsConfig {\r\n\tapp?: {\r\n\t\tdev: DevConfig;\r\n\t\tname: string;\r\n\t\tversion?: string;\r\n\t};\r\n\t//devs?: DevConfig[];\r\n\tuqs?: UqConfig[];\r\n}\r\n\r\nexport interface AppConfig extends UqsConfig {\r\n\t/*\r\n\tapp?: {\r\n\t\tname: string;\r\n\t\tversion: string;\r\n\t\townerMap?: {[key:string]: string};\r\n\t};\r\n\t*/\r\n    //appName: string;        // 格式: owner/appName\r\n    version: string;        // 版本变化，缓存的uqs才会重载\r\n    tvs?: TVs;\r\n    //uqNameMap?: {[uqName:string]: string};      // uqName='owner/uq' 映射到内存简单名字：uq, 可以注明映射，也可以自动。有可能重\r\n    loginTop?: JSX.Element;\r\n    oem?: string;               // 用户注册发送验证码的oem厂家，默认同花\r\n\tprivacy?: string;\r\n\tnoUnit?: boolean;\t\t\t// app的运行，不跟unit绑定\r\n\thtmlTitle?: string;\r\n}\r\n\r\nexport interface Elements {\r\n\t[id:string]: (element: HTMLElement)=>void,\r\n}\r\n\r\nexport abstract class CAppBase<U> extends Controller {\r\n\tprivate appConfig: AppConfig;\r\n    protected _uqs: U;\r\n\r\n    constructor(config?: AppConfig) {\r\n\t\tsuper();\r\n\t\tthis.appConfig = config || (nav.navSettings as AppConfig);\r\n\t\tif (this.appConfig) {\r\n\t\t\tlet {app, uqs} = this.appConfig;\r\n\t\t\tif (app === undefined && uqs === undefined) {\r\n\t\t\t\tthrow new Error('app or uqs must be defined in AppConfig');\r\n\t\t\t}\r\n\t\t}\r\n    }\r\n\r\n    get uqs(): U {return this._uqs;}\r\n\r\n\tinternalT(str:string):any {\r\n\t\treturn t(str);\r\n\t}\r\n\t\r\n\tsetRes(res:any) {\r\n\t\tsetGlobalRes(res);\r\n\t}\r\n\tprotected afterBuiltUQs(uqs: any) {}\r\n\r\n    protected async beforeStart():Promise<boolean> {\r\n        try {\r\n\t\t\tthis.onNavRoutes();\r\n\t\t\tif (!this.appConfig) return true;\r\n\t\t\tlet retErrors = await UQsMan.build(this.appConfig);\r\n            if (retErrors !== undefined) {\r\n                this.openVPage(VErrorsPage, retErrors);\r\n                return false;\r\n            }\r\n\t\t\tthis._uqs = UQsMan._uqs;\r\n\t\t\tthis.afterBuiltUQs(this._uqs);\r\n            //let retErrors = await this.load();\r\n            //let app = await loadAppUqs(this.appOwner, this.appName);\r\n            // if (isDevelopment === true) {\r\n\t\t\t// 这段代码原本打算只是在程序员调试方式下使用，实际上，也可以开放给普通用户，production方式下\r\n\t\t\t//let retErrors = UQsMan.errors;\r\n            //let {predefinedUnit} = appInFrame;\r\n            let {user} = nav;\r\n            if (user !== undefined && user.id > 0) {\r\n            }\r\n            return true;\r\n        }\r\n        catch (err) {\r\n            this.openVPage(VStartError, err);\r\n            return false;\r\n        }\r\n    }\r\n\tprotected async afterStart():Promise<void> {\r\n\t\tnav.resolveRoute();\r\n\t\tnav.onChangeLogin = (user:User) => this.onChangeLogin(user);\r\n\t\tthis.onChangeLogin(this.user);\r\n\t}\r\n\r\n    async userFromId(userId:number):Promise<any> {\r\n        return await centerApi.userFromId(userId);\r\n    }\r\n\r\n\tprotected on(routeFunc:RouteFunc, hooks?:Hooks):Navigo;\r\n\tprotected on(url:string, routeFunc:RouteFunc, hooks?:Hooks):Navigo;\r\n\tprotected on(regex:RegExp, routeFunc:RouteFunc, hooks?:Hooks):Navigo;\r\n\tprotected on(options: {[url:string]: RouteFunc|NamedRoute}):Navigo;\r\n\tprotected on(...args:any[]):Navigo {\r\n\t\treturn nav.on(args[0], args[1], args[2]);\r\n\t}\r\n\r\n\tprotected onNavRoutes() {return;}\r\n\r\n\tasync getUqRoles(uqName:string):Promise<string[]> {\r\n\t\tlet {user} = nav;\r\n\t\tif (!user) return null;\r\n\t\tlet {roles:userRoles} = nav.user;\r\n\t\tlet uq = uqName.toLowerCase();\r\n\t\tlet roles:string[];\r\n\t\tif (userRoles) {\r\n\t\t\troles = userRoles[uq];\r\n\t\t}\r\n\t\tif (roles) return roles;\r\n\r\n\t\troles = await UQsMan.getUqUserRoles(uq);\r\n\t\tif (!roles) roles = null;\r\n\t\tnav.setUqRoles(uq, roles);\r\n\t\treturn roles;\r\n\t}\r\n\r\n\tisAdmin(roles:string[]):boolean {\r\n\t\treturn this.isRole(roles, '$');\r\n\t}\r\n\r\n\tisRole(roles:string[], role:string):boolean {\r\n\t\tif (!roles) return false;\r\n\t\trole = role.toLowerCase();\r\n\t\treturn roles.indexOf(role) >= 0;\r\n\t}\r\n\r\n\tprotected onChangeLogin(user: User):Promise<void> {\r\n\t\treturn;\r\n\t}\r\n}\r\n","import { AppConfig, CAppBase } from './CAppBase';\r\n\r\nexport async function start(CApp: new (config: AppConfig) => CAppBase<any>, appConfig: AppConfig, isUserLogin?:boolean) {\r\n\tif (appConfig) {\r\n\t\tlet {htmlTitle} = appConfig;\r\n\t\tif (htmlTitle) {\r\n\t\t\tdocument.title = htmlTitle;\r\n\t\t}\r\n\t\tlet html = document.getElementsByTagName('html');\r\n\t\tlet html0 = html[0];\r\n\t\tif (html0) {\r\n\t\t\tlet version = html0?.getAttribute('data-version');\r\n\t\t\tif (version) {\r\n\t\t\t\t//appConfig.version = version;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tlet cApp = new CApp(appConfig);\r\n    await cApp.start(isUserLogin);\r\n}\r\n","import _ from 'lodash';\r\nimport { Controller, WebNav } from \"../vm\";\r\nimport { CAppBase, IConstructor } from \"./CAppBase\";\r\n\r\nexport abstract class CBase<A extends CAppBase<U>, U> extends Controller {\r\n    protected readonly _uqs: U;\r\n    protected readonly _cApp: A;\r\n\r\n    constructor(cApp: any) {\r\n        super();\r\n        this._cApp = cApp;\r\n        this._uqs = cApp?.uqs;\r\n\t}\r\n\r\n    get uqs(): U {return this._uqs}\r\n\tget cApp(): A {return this._cApp}\r\n\tasync getUqRoles(uqName:string):Promise<string[]> {\r\n\t\treturn this._cApp?.getUqRoles(uqName);\r\n\t}\r\n\r\n\tinternalT(str:string):any {\r\n\t\tlet r = super.internalT(str);\r\n\t\tif (r!==undefined) return r;\r\n\t\treturn this._cApp.internalT(str);\r\n\t}\r\n\r\n    protected newC<T extends CBase<A,U>>(type: IConstructor<T>, param?:any):T {\r\n\t\tlet c = new type(this.cApp);\r\n\t\tc.init(param);\r\n\t\treturn c;\r\n    }\r\n\r\n    protected newSub<O extends CBase<A,U>, T extends CSub<A,U,O>>(type: IConstructor<T>, param?:any):T {\r\n\t\tlet s = new type(this);\r\n\t\ts.init(param);\r\n\t\treturn s;\r\n\t}\r\n\t\r\n\tgetWebNav(): WebNav<any> {\r\n\t\tlet wn = this._cApp?.getWebNav();\r\n\t\tif (wn === undefined) return;\r\n\t\tlet ret = _.clone(wn);\r\n\t\t_.merge(ret, this.webNav);\r\n\t\treturn ret;\r\n\t}\r\n}\r\n\r\nexport abstract class CSub<A extends CAppBase<U>, U, T extends CBase<A, U>> extends CBase<A,U> {\r\n    protected _owner: T;\r\n\r\n    constructor(owner: T) {\r\n        super(owner.cApp);\r\n        this._owner = owner;\r\n\t}\r\n\r\n\tinternalT(str:string):any {\r\n\t\tlet r = super.internalT(str);\r\n\t\tif (r!==undefined) return r;\r\n\t\treturn this._owner.internalT(str);\r\n\t}\r\n\r\n    protected get owner(): T {return this._owner}\r\n\t\r\n\tgetWebNav(): WebNav<any> {\r\n\t\tlet wn = this._cApp?.getWebNav();\r\n\t\tif (wn === undefined) return;\r\n\t\tlet ownerWNs:WebNav<any>[] = [];\r\n\t\tfor (let p = this.owner; p!==undefined; p = (p as any)?.owner) {\r\n\t\t\townerWNs.push(p.webNav);\r\n\t\t}\r\n\t\tlet ret = _.clone(wn);\r\n\t\tfor (;;) {\r\n\t\t\tlet own = ownerWNs.pop();\r\n\t\t\tif (own === undefined) break;\r\n\t\t\t_.merge(ret, own);\r\n\t\t}\r\n\t\t_.merge(ret, this.webNav);\r\n\t\treturn ret;\r\n\t}\r\n}\r\n","import * as React from 'react';\r\nimport { IValuesView, IValuesViewRenderOptions } from '../../components';\r\nimport { Tag, TagValue } from './tag';\r\n\r\nconst radioStyle:React.CSSProperties = {height: 'auto'};\r\n\r\nexport class TagView implements IValuesView {\r\n\tprivate tag: Tag;\r\n\tconstructor(tag: Tag) {\r\n\t\tthis.tag = tag;\r\n\t}\r\n\trender(values: number|string):JSX.Element {\r\n\t\tlet names:string[];\r\n\t\tif (typeof values === 'number') {\r\n\t\t\tnames = [this.tag.nameFromId(values)];\r\n\t\t}\r\n\t\telse {\r\n\t\t\tnames = this.tag.namesFromIds(values);\r\n\t\t}\r\n\t\treturn <div className=\"d-flex flex-wrap \">{names.map((name, index)=>{\r\n\t\t\treturn <div key={index} className=\"mx-2 border border-muted rounded px-3 bg-light\">{name}</div>\r\n\t\t})}</div>;\r\n\t}\r\n\trenderRadios(value: number, options: IValuesViewRenderOptions): JSX.Element {\r\n        let content = this.tag.values.map((item,index) => {\r\n\t\t\treturn <div className=\"col\" key={index}>{this.renderRadio(item, value, options)}</div>;\r\n        });\r\n\t\treturn this.renderView(options, content);\r\n\t}\r\n\trenderChecks(values: string, options: IValuesViewRenderOptions): JSX.Element {\r\n\t\tlet arr = values===undefined? undefined : values.split('|').map(v => Number(v));\r\n\t\tlet content = this.tag.values.map((item,index) => {\r\n\t\t\tlet checked: boolean = arr===undefined? undefined : arr.indexOf(item.id)>=0;\r\n\t\t\treturn <div className=\"col\" key={index}>{this.renderCheck(item, checked, options)}</div>\r\n\t\t});\r\n\t\treturn this.renderView(options, content);\r\n\t}\r\n\tprivate renderView(options: IValuesViewRenderOptions, content:any) {\r\n\t\tlet {className, wrapClassName} = options;\r\n\t\twrapClassName = wrapClassName?\r\n\t\t\t'row ' + wrapClassName\r\n\t\t\t:\r\n\t\t\t'row row-cols-2 row-cols-sm-3 row-cols-md-4';\r\n\t\treturn <div className={className} style={radioStyle}>\r\n\t\t\t<div className={wrapClassName}>\r\n                {content}\r\n\t\t\t</div>\r\n        </div>;\r\n\t}\r\n\tprivate renderRadio(item:TagValue, value: number, options: IValuesViewRenderOptions):JSX.Element {\r\n\t\tlet {id, name} = item;\r\n\t\tlet {inputs, inputName, onInputChange} = options;\r\n\t\tlet ref = inputs && ((input:HTMLInputElement)=>inputs[id]=input);\r\n\t\treturn <label className=\"form-radio-inline\">\r\n\t\t\t<input ref={ref} type=\"radio\" name={inputName}\r\n\t\t\t\tvalue={id} defaultChecked={value===id}\r\n\t\t\t\tonChange={onInputChange} />\r\n\t\t\t{name}\r\n\t\t</label>;\r\n\t}\r\n\r\n\tprivate renderCheck(item:TagValue, checked: boolean, options: IValuesViewRenderOptions):JSX.Element {\r\n\t\tlet {id, name} = item;\r\n\t\tlet {inputs, onInputChange} = options;\r\n\t\tlet ref = inputs && ((input:HTMLInputElement)=>inputs[id]=input);\r\n\t\treturn <label className=\"form-radio-inline\">\r\n\t\t\t<input ref={ref} type=\"checkbox\"\r\n\t\t\t\tvalue={id} defaultChecked={checked}\r\n\t\t\t\tonChange={onInputChange} />\r\n\t\t\t{name}\r\n\t\t</label>;\r\n\t}\r\n}\r\n","import { Entity } from \"../entity\";\r\nimport { TagView } from \"./tagView\";\r\n\r\nexport interface TagValue {\r\n\tid: number;\r\n\tname: string;\r\n\text: string;\r\n}\r\n\r\nexport class UqTag extends Entity {\r\n    get typeName(): string { return 'tag';}\r\n\tvalues: TagValue[];\r\n\tprivate coll: {[id:number]: TagValue} = {};\r\n\r\n\tprivate _view: TagView;\r\n\tget view(): TagView { \r\n\t\tif (this._view !== undefined) return this._view; \r\n\t\treturn this._view = new TagView(this);\r\n\t}\r\n\r\n\tnameFromId(id:number) {\r\n\t\tlet c = this.coll[id]; \r\n\t\treturn c===undefined? undefined : c.name;\r\n\t}\r\n\r\n\tnamesFromIds(ids:string):string[] {\r\n\t\tlet ret:string[] = [];\r\n\t\tfor (let id of ids.split('|')) {\r\n\t\t\tlet c = this.coll[Number(id)];\r\n\t\t\tlet name = c===undefined? undefined : c.name;\r\n\t\t\tif (name !== undefined) ret.push(name);\r\n\t\t}\r\n\t\treturn ret;\r\n\t}\r\n\r\n\tasync loadValues():Promise<TagValue[]> {\r\n\t\tif (this.values !== undefined) return this.values;\r\n\t\tthis.values = [];\r\n\t\tlet ret = await this.uqApi.get('tag/values/' + this.name);\r\n\t\tif (ret === undefined) return;\r\n\t\tlet lines = (ret as string).split('\\n');\r\n\t\tfor (let line of lines) {\r\n\t\t\tif (line.length === 0) continue;\r\n\t\t\tlet parts = line.split('\\t');\r\n\t\t\tlet id = Number(parts[0]);\r\n\t\t\tlet val = {\r\n\t\t\t\tid: id,\r\n\t\t\t\tname: parts[1],\r\n\t\t\t\text: parts[2],\r\n\t\t\t};\r\n\t\t\tthis.values.push(val);\r\n\t\t\tthis.coll[id] = val;\r\n\t\t}\r\n\t\treturn this.values;\r\n\t}\r\n}\r\n\r\nexport class Tag extends UqTag {\r\n}","import { Res, UI } from \"tonva-react\";\r\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\nimport { FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-react\";\r\nimport { Customer } from \"./BzHelloTonva\";\r\n\r\n/*--fields--*/\r\nconst fields = {\r\n\tid: {\r\n\t\t\"name\": \"id\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": false,\r\n\t\t\"label\": \"Id\"\r\n\t} as FieldItemId,\r\n\tno: {\r\n\t\t\"name\": \"no\",\r\n\t\t\"type\": \"string\",\r\n\t\t\"isKey\": true,\r\n\t\t\"widget\": \"string\",\r\n\t\t\"label\": \"No\"\r\n\t} as FieldItemString,\r\n\tfirstName: {\r\n\t\t\"name\": \"firstName\",\r\n\t\t\"type\": \"string\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"string\",\r\n\t\t\"label\": \"名字\"\r\n\t} as FieldItemString,\r\n\tlastName: {\r\n\t\t\"name\": \"lastName\",\r\n\t\t\"type\": \"string\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"string\",\r\n\t\t\"label\": \"LastName\"\r\n\t} as FieldItemString,\r\n};\r\n/*==fields==*/\r\n\r\nexport const fieldArr: FieldItem[] = [\r\n\tfields.no, fields.firstName, fields.lastName, \r\n];\r\n\r\nexport const ui: UI = {\r\n\tlabel: \"Customer\",\r\n\tfieldArr,\r\n\tfields,\r\n};\r\n\r\nexport const res: Res<any> = {\r\n\tzh: {\r\n\t},\r\n\ten: {\r\n\t}\r\n};\r\n\r\nexport function render(item: Customer):JSX.Element {\r\n\tlet {firstName, lastName, no} = item;\r\n\treturn <span>\r\n\t\t<small className=\"d-inline-block w-3c\">{no}</small> <b>{firstName} {lastName}</b>\r\n\t</span>;\r\n};\r\n","export * from './StockInfoType';\r\nexport { CStockInfo } from './CStockInfo';\r\nexport { VStockInfo } from './VStockInfo';","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport { VPage, List, LMR, SearchBox, Scroller } from 'tonva-react';\r\nimport { CSelectStock } from './CSelectStock'\r\n\r\nexport class VStockSelect extends VPage<CSelectStock> {\r\n\tprivate onClickStock = async (model: any) => {\r\n\t\tawait this.controller.returnStock(model);\r\n\t\tthis.closePage();\r\n\t}\r\n\r\n\theader() {return '选择股票'}\r\n\tget headerClassName() {return 'bg-primary'}\r\n\tprotected async onPageScrollBottom(scroller: Scroller) {\r\n\t\tawait this.controller.pageItems.more();\r\n\t}\r\n\r\n\tcontent() {\r\n\t\tlet { pageItems, searchByKey } = this.controller;\r\n\t\tlet none = <div className=\"p-3 small text-muted\">无结果</div>;\r\n\t\treturn <div>\r\n\t\t\t<SearchBox className=\"px-1 w-100  mt-2 mr-2\"\r\n\t\t\t\tsize='md'\r\n\t\t\t\tallowEmptySearch={true}\r\n\t\t\t\tonSearch={searchByKey}\r\n\t\t\t\tplaceholder=\"搜索股票\" />\r\n\t\t\t<List before={''} none={none} \r\n\t\t\t\titems={pageItems} \r\n\t\t\t\titem={{ render: this.renderStock, onClick: this.onClickStock }} />\r\n\t\t</div>\r\n\t}\r\n\r\n\tprivate renderStock = (stock: any, index: number) => {\r\n\t\tlet { name, code } = stock;\r\n\t\treturn <LMR className=\"px-3 py-2 \" >\r\n\t\t\t<div className=\"font-weight-bold\"></div>\r\n\t\t\t<div>{name + ' ' + code}</div>\r\n\t\t</LMR >\r\n\t}\r\n}","import { PageItems } from 'tonva-react';\r\nimport { Stock } from 'store';\r\nimport { MiNet } from '../net';\r\nimport { CUqBase } from \"../uq-app\";\r\nimport { VStockSelect } from './VSelectStock';\r\n\r\nclass PageStockItems<T> extends PageItems<T> {\r\n\tprivate miNet: MiNet;\r\n\r\n\tconstructor(miNet: MiNet) {\r\n\t\tsuper(true);\r\n\t\tthis.miNet = miNet;\r\n\t\tthis.firstSize = this.pageSize = 30;\r\n\t}\r\n\r\n\tprotected async loadResults(param: any, pageStart: any, pageSize: number): Promise<{\r\n\t\t\t[name: string]: any[];\r\n\t\t}> {\r\n\t\tif (pageStart === undefined) pageStart = 0;\r\n\t\tlet p = [this.miNet.userId, '%' + param.key + '%'];\r\n\t\ttry {\r\n\t\t\t//let ret = await this.cStock.cApp.store.miApi.page('q_stocks$page', p, pageStart, pageSize);\r\n\t\t\tlet ret = await this.miNet.q_stocks$page(p, pageStart, pageSize);\r\n\t\t\treturn {$page: ret};\r\n\t\t}\r\n\t\tcatch (error) {\r\n\t\t\t//let e = error;\r\n\t\t\treturn undefined;\r\n\t\t}\r\n\t}\r\n\r\n\tprotected setPageStart(item: any): any {\r\n\t\tthis.pageStart = item === undefined ? 0 : item.id;\r\n\t}\r\n}\r\n\r\nexport class CSelectStock extends CUqBase {\r\n\tpageItems: PageStockItems<Stock>;\r\n\r\n\tasync internalStart(param: any) {\r\n\t\tthis.pageItems = new PageStockItems<any>(this.cApp.miNet);\r\n\t\tthis.openVPage(VStockSelect);\r\n\t}\r\n\r\n\tsearchByKey = async (key: string) => {\r\n\t\tthis.pageItems.first({ key: key });\r\n\t}\r\n\r\n\t//给调用页面返回id\r\n\treturnStock = async (item: any): Promise<any> => {\r\n\t\tthis.returnCall(item);\r\n\t}\r\n\r\n\tonPage = async () => {\r\n\t\tawait this.pageItems.more();\r\n\t}\r\n}\r\n","import { capitalCase } from \"../../tool\";\r\nimport { FieldItem, FieldUIType } from \"../../ui\";\r\n\r\nexport function buildFieldItem(field:any, isKey:boolean):FieldItem {\r\n\tlet $FieldItemType: string, fieldItemType: string, widget:FieldUIType;\r\n\tlet {name, type} = field;\r\n\tswitch (type) {\r\n\t\tcase 'id':\r\n\t\t\t$FieldItemType = 'FieldItemId';\r\n\t\t\tfieldItemType = 'id';\r\n\t\t\tbreak;\r\n\t\tcase 'char':\r\n\t\t\t$FieldItemType = 'FieldItemString';\r\n\t\t\tfieldItemType = 'string';\r\n\t\t\twidget = 'string';\r\n\t\t\tbreak;\r\n\t\tcase 'smallint':\r\n\t\tcase 'int':\r\n\t\tcase 'bigint':\r\n\t\t\t$FieldItemType = 'FieldItemInt';\r\n\t\t\tfieldItemType = 'integer';\r\n\t\t\twidget = 'updown';\r\n\t\t\tbreak;\r\n\t\tcase 'dec':\r\n\t\t\t$FieldItemType = 'FieldItemNum';\r\n\t\t\tfieldItemType = 'number';\r\n\t\t\twidget = 'number';\r\n\t\t\tbreak;\r\n\t}\r\n\treturn {\r\n\t\tname,\r\n\t\ttype: fieldItemType,\r\n\t\tisKey,\r\n\t\twidget,\r\n\t\tlabel: capitalCase(name),\r\n\t\t$FieldItemType,\r\n\t} as FieldItem;\r\n}\r\n","import React from 'react';\r\nimport { nav } from '../components';\r\nimport { VPage } from '../vm';\r\nimport { CLogin } from './CLogin';\r\n\r\nexport class VLogout extends VPage<CLogin> {\r\n\tprivate onLogout: ()=>void;\r\n\r\n\tinit(param: any) {\r\n\t\tthis.onLogout = param;\r\n\t}\r\n\theader() {return this.isWebNav === true? false : '安全退出';}\r\n\tfooter() {\r\n\t\treturn <div className=\"mt-5 text-center justify-content-center\">\r\n\t\t\t<button className=\"btn btn-outline-warning\" onClick={nav.resetAll}>升级软件</button>\r\n\t\t</div>;\r\n\t}\r\n\tprotected get back(): 'close' | 'back' | 'none' {return 'close'}\r\n\tcontent() {\r\n\t\treturn <div className=\"m-5 border border-info bg-white rounded-3 p-5 text-center\">\r\n\t\t\t<div>退出当前账号不会删除任何历史数据，下次登录依然可以使用本账号</div>\r\n\t\t\t<div className=\"mt-5 text-center\">\r\n\t\t\t\t<button className=\"btn btn-danger\" onClick={this.onLogout}>安全退出</button>\r\n\t\t\t</div>\r\n\t\t</div>;\r\n\t}\r\n}\r\n","import * as React from 'react';\r\nimport {Form, Schema, UiSchema, UiTextItem, UiPasswordItem, Context, UiButton, StringSchema, Ax, nav} from '../components';\r\nimport { tonvaTop, getSender } from './tools';\r\nimport { CLogin } from './CLogin';\r\nimport { VPage } from '../vm';\r\n\r\nconst schema: Schema = [\r\n    {name: 'username', type: 'string', required: true, maxLength: 100} as StringSchema,\r\n    {name: 'password', type: 'string', required: true, maxLength: 100} as StringSchema,\r\n    {name: 'login', type: 'submit'},\r\n];\r\n\r\nexport class VLogin extends VPage<CLogin> {\r\n    private onLogin: (un:string, pwd:string) => Promise<boolean>;\r\n    private withBack: boolean;\r\n\r\n\tinit({onLogin, withBack}:{onLogin: (un:string, pwd:string) => Promise<boolean>; withBack: boolean;}) {\r\n\t\tthis.onLogin = onLogin;\r\n\t\tthis.withBack = withBack;\r\n\t}\r\n\r\n    private uiSchema: UiSchema = {\r\n        items: {\r\n            username: {placeholder: '手机/邮箱/用户名', label: '登录账号'} as UiTextItem,\r\n            password: {widget: 'password', placeholder: '密码', label: '密码'} as UiPasswordItem,\r\n            login: {widget: 'button', className: 'btn btn-primary btn-block mt-3', label: '登录'} as UiButton,\r\n        }\r\n    }\r\n\r\n    private onSubmit = async (name:string, context:Context):Promise<string> => {\r\n        let values = context.form.data;\r\n        let un = values['username'];\r\n        let pwd = values['password'];\r\n        if (pwd === undefined) {\r\n            return 'something wrong, pwd is undefined';\r\n\t\t}\r\n\t\tlet ret = await this.onLogin(un, pwd);\r\n\t\tif (ret === true) return;\r\n\r\n\t\tlet sender = getSender(un);\r\n\t\tlet type:string = sender !== undefined? sender.caption : '用户名';\r\n\t\treturn type + '或密码错！';\r\n    }\r\n    private onEnter = async (name:string, context:Context):Promise<string> => {\r\n        if (name === 'password') {\r\n            return await this.onSubmit('login', context);\r\n        }\r\n\t}\r\n\r\n\theader() {\r\n        if (this.withBack === true) {\r\n            return '登录';\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\r\n\tcontent() {\r\n        return <div className=\"d-flex p-5 flex-column justify-content-center align-items-center\">\r\n\t\t\t<div className=\"flex-fill\" />\r\n\t\t\t<div className=\"w-20c\">\r\n\t\t\t\t{tonvaTop()}\r\n\t\t\t\t<div className=\"h-2c\" />\r\n\t\t\t\t<Form schema={schema} uiSchema={this.uiSchema} \r\n\t\t\t\t\tonButtonClick={this.onSubmit} \r\n\t\t\t\t\tonEnter={this.onEnter}\r\n\t\t\t\t\trequiredFlag={false} />\r\n\t\t\t\t<div className=\"text-center\">\r\n\t\t\t\t\t<Ax className=\"btn btn-link\" href=\"/forget\">\r\n\t\t\t\t\t\t忘记密码\r\n\t\t\t\t\t</Ax>\r\n\t\t\t\t\t<Ax href=\"/register\" className=\"btn btn-link\">\r\n\t\t\t\t\t\t注册账号\r\n\t\t\t\t\t</Ax>\r\n\t\t\t\t</div>\r\n\t\t\t\t{nav.privacyEntry()}\r\n\t\t\t</div>\r\n\t\t\t<div className=\"flex-fill\" />\r\n\t\t\t<div className=\"flex-fill\" />\r\n\t\t</div>;\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport { VPage } from '../vm';\r\nimport { Page, Form, ItemSchema, UiSchema, StringSchema, UiPasswordItem, Context, ButtonSchema, UiButton, nav } from '../components';\r\n//import { CenterAppApi } from '../net';\r\nimport { CLogin } from './CLogin';\r\n\r\nexport class VChangePassword extends VPage<CLogin> {\r\n    private schema: ItemSchema[] = [\r\n        {name:'orgPassword', type: 'string', maxLength: 60, required: true} as StringSchema,\r\n        {name:'newPassword', type: 'string', maxLength: 60, required: true} as StringSchema,\r\n        {name:'newPassword1', type: 'string', maxLength: 60, required: true} as StringSchema,\r\n        {name:'submit', type: 'submit'} as ButtonSchema\r\n    ];\r\n    private uiSchema: UiSchema = {\r\n        items: {\r\n            orgPassword: {\r\n                widget: 'password',\r\n                label: '原密码',\r\n                placeholder: '输入原来的密码'\r\n            } as UiPasswordItem,\r\n            newPassword: {\r\n                widget: 'password',\r\n                label: '新密码',\r\n                placeholder: '输入新设的密码'\r\n            } as UiPasswordItem,\r\n            newPassword1: {\r\n                widget: 'password',\r\n                label: '确认密码', \r\n                placeholder: '再次输入新设密码'\r\n            } as UiPasswordItem,\r\n            submit: {\r\n                widget: 'button',\r\n                label: '提交',\r\n                className: 'btn btn-primary'\r\n            } as UiButton,\r\n        }\r\n\t};\r\n\t\r\n\tprivate onChange: (orgPassword:string, newPassword:string) => Promise<boolean>\r\n\tinit(onChange: (orgPassword:string, newPassword:string) => Promise<boolean>) {\r\n\t\tthis.onChange = onChange;\r\n\t}\r\n\r\n    private onSubmit = async (name:string, context: Context):Promise<any> => {\r\n        let {orgPassword, newPassword, newPassword1} = context.data;\r\n        if (newPassword !== newPassword1) {\r\n            context.setError('newPassword1', '新密码错误，请重新输入');\r\n            return;\r\n        }\r\n        //let centerAppApi = new CenterAppApi('tv/', undefined);\r\n\t\t//let ret = await centerAppApi.changePassword({orgPassword, newPassword});\r\n\t\tlet ret = await this.onChange(orgPassword, newPassword);\r\n        if (ret === false) {\r\n            context.setError('orgPassword', '原密码错误');\r\n            return;\r\n        }\r\n        nav.replace(<Page header=\"修改密码\" back=\"close\">\r\n            <div className=\"m-3  text-success\">\r\n                密码修改成功！\r\n            </div>\r\n        </Page>);\r\n        return;\r\n    }\r\n\r\n\theader() {return '修改密码'}\r\n\r\n    content() {\r\n        return <Form\r\n\t\t\tclassName=\"m-3\" \r\n\t\t\tschema={this.schema}\r\n\t\t\tuiSchema={this.uiSchema}\r\n\t\t\tonButtonClick={this.onSubmit}\r\n\t\t\tfieldLabelSize={2} />\r\n    }\r\n}\r\n","import { User } from '../tool';\r\nimport { nav, Login } from '../components';\r\nimport { Controller, VPage } from \"../vm\";\r\nimport { VLogout } from './VLogout';\r\nimport { VLogin } from './VLogin';\r\nimport { CenterAppApi, userApi } from '../net';\r\nimport { VChangePassword } from './VChangePassword';\r\n\r\nexport class CLogin extends Controller implements Login {\r\n\tprotected async internalStart() {\r\n\t}\r\n\r\n\tasync showLogin(callback?: (user:User)=>Promise<void>, withBack?:boolean):Promise<void> {\r\n\t\tlet onLogin = async (un:string, pwd:string):Promise<boolean> => {\r\n\t\t\tlet user = await userApi.login({\r\n\t\t\t\tuser: un,\r\n\t\t\t\tpwd: pwd,\r\n\t\t\t\tguest: nav.guest,\r\n\t\t\t});\r\n\t\r\n\t\t\tif (user === undefined) return false;\r\n\t\t\tconsole.log(\"onLoginSubmit: user=%s pwd:%s\", user.name, user.token);\r\n\t\t\tawait nav.userLogined(user, callback);\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\tthis.openVPage(VLogin, {onLogin, withBack});\r\n    }\r\n\r\n    async showLogout(callback?: ()=>Promise<void>) {\r\n\t\tthis.openVPage(VLogout, () => {\r\n\t\t\tnav.logout(callback);\r\n\t\t});\r\n\t}\r\n\t/*\r\n\tasync showRegister() {\r\n\t\tlet cRegister = new (await import('./register')).CRegister(this.res);\r\n\t\tawait cRegister.start();\r\n\t}\r\n\r\n\tasync showForget() {\r\n\t\tlet cForget = new (await import('./register')).CForget(this.res);\r\n\t\tawait cForget.start();\r\n\t}\r\n\t*/\r\n\r\n\tprotected getVChangePassword():new (cLogin:CLogin) => VPage<CLogin> {\r\n\t\treturn VChangePassword;\r\n\t}\r\n\tasync showChangePassword() {\r\n\t\tlet vPage = this.getVChangePassword();\r\n\t\tthis.openVPage(vPage, async (orgPassword:string, newPassword:string):Promise<boolean> => {\r\n\t\t\tlet centerAppApi = new CenterAppApi('tv/', undefined);\r\n\t\t\tlet ret = await centerAppApi.changePassword({orgPassword, newPassword});\r\n\t\t\treturn ret;\r\n\t\t});\r\n    }\r\n}\r\n","export default __webpack_public_path__ + \"static/media/logo.2d27ead7.svg\";","import * as React from 'react';\r\nimport { nav } from '../components';\r\nimport { mobileRegex, emailRegex } from '../tool';\r\nimport logo from '../img/logo.svg';\r\n\r\nexport function tonvaTop() {\r\n    return nav.loginTop(<div className=\"d-flex align-items-center position-relative\">\r\n        <img className=\"App-logo h-3c position-absolute\" src={logo} alt=\"img\" />\r\n        <div className=\"h3 flex-fill text-center\"><span className=\"text-primary mr-3\">同</span>\r\n            <span className=\"text-danger\">花</span>\r\n        </div>\r\n    </div>);\r\n}\r\n\r\ninterface Sender {\r\n    type: string;\r\n    caption: string;\r\n    regex: RegExp;\r\n}\r\n\r\nconst senders:Sender[] = [\r\n    {type:'mobile', caption:'手机号', regex: mobileRegex},\r\n    {type:'email', caption:'邮箱', regex: emailRegex}\r\n];\r\n\r\nexport function getSender(un: string):Sender {\r\n    let sender = senders.find(v => v.regex.test(un) === true);\r\n    return sender;\r\n}","export * from './page';\r\nexport * from './tabs';\r\nexport * from './scrollView';\r\nexport * from './pageHeader';","export * from './schema';\r\nexport * from './uiSchema';\r\nexport * from './toUiSelectItems';\r\nexport * from './IValuesView';","import * as React from 'react';\r\nimport classNames from 'classnames';\r\n\r\nexport interface DropdownAction {\r\n    icon?: string;\r\n    caption?: string;\r\n\taction?: () => void;\r\n\ticonClass?: string;\r\n\tcaptionClass?: string;\r\n}\r\n\r\nexport interface DropdownActionsProps {\r\n    icon?: string;\r\n\tcontent?: string|JSX.Element;\r\n    actions: DropdownAction[];\r\n    isRight?: boolean;\r\n\tclassName?: string;\r\n\tcontainerClass?: string;\r\n\titemIconClass?: string;\r\n\titemCaptionClass?: string;\r\n}\r\n\r\nexport interface DropdownActionsState {\r\n    dropdownOpen: boolean;\r\n}\r\n\r\nexport class DropdownActions extends React.Component<DropdownActionsProps, DropdownActionsState> {\r\n    private menu: HTMLDivElement;\r\n    private button: HTMLElement;\r\n    constructor(props:DropdownActionsProps) {\r\n        super(props);\r\n        this.state = {\r\n            dropdownOpen: false\r\n        };\r\n    }\r\n\r\n    componentDidMount() {\r\n        document.addEventListener('click', this.handleDocumentClick);\r\n        document.addEventListener('touchstart', this.handleDocumentClick);\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        document.removeEventListener('click', this.handleDocumentClick);\r\n        document.removeEventListener('touchstart', this.handleDocumentClick);\r\n    }\r\n\r\n    private handleDocumentClick = (evt:any) => {\r\n        if (this.state.dropdownOpen === false) return;\r\n        if (this.button && this.button.contains(evt.target)) return;\r\n        if (!this.menu) return;\r\n        //if (!this.menu.contains(evt.target)) \r\n        this.toggle();\r\n    }\r\n\r\n    private toggle = () => {\r\n        this.setState({\r\n            dropdownOpen: !this.state.dropdownOpen\r\n        });\r\n    }\r\n\r\n    render() {\r\n        let {icon, content, actions, isRight, className, containerClass, itemIconClass, itemCaptionClass} = this.props;\r\n        if (isRight === undefined) isRight = true;\r\n        let hasIcon = actions.some(v => {\r\n\t\t\tif (!v) return false;\r\n\t\t\treturn v.icon !== undefined\r\n\t\t});\r\n        let {dropdownOpen} = this.state;\r\n\t\t//isOpen={this.state.dropdownOpen} toggle={this.toggle}\r\n\t\tlet cn = className || 'cursor-pointer dropdown-toggle btn btn-sm';\r\n\t\t//if (className) cn += className;\r\n        return <div className={classNames('dropdown', containerClass)}>\r\n\t\t\t<button ref={v=>this.button=v} \r\n\t\t\t\tclassName={cn}\r\n                data-toggle=\"dropdown\"\r\n                aria-expanded={dropdownOpen}\r\n                onClick={this.toggle}>\r\n                <i className={classNames('fa fa-fw ', 'fa-'+(icon||'ellipsis-v'))} /> \r\n\t\t\t\t{content && <span className=\"ml-1\">{content}</span>}\r\n            </button>\r\n            <div ref={v => this.menu=v} className={classNames({\"dropdown-menu\":true, \"dropdown-menu-right\":isRight, \"show\":dropdownOpen})}>\r\n                {\r\n                    actions.map((v,index) => {\r\n\t\t\t\t\t\tif (!v) {\r\n                            return <div className=\"dropdown-divider\" key={index}/>;\r\n\t\t\t\t\t\t}\r\n                        let {icon, caption, action, iconClass, captionClass} = v;\r\n                        if (icon === undefined && caption === undefined) \r\n                            return <div className=\"dropdown-divider\" />;\r\n                        let i:any;\r\n                        if (hasIcon === true) {\r\n                            if (icon !== undefined) icon = 'fa-' + icon;\r\n\t\t\t\t\t\t\tif (!iconClass) iconClass = 'text-info';\r\n\t\t\t\t\t\t\ti = <i className={classNames('mr-2', 'fa', icon, 'fa-fw', iconClass || itemIconClass)}\r\n\t\t\t\t\t\t\t\taria-hidden={true}></i>;\r\n                        }\r\n                        if (action === undefined) \r\n                            return <h6 className=\"dropdown-header\">{i} {caption}</h6>;\r\n                        let onMenuItemClick = (evt:React.MouseEvent<HTMLAnchorElement>)=>{\r\n                            evt.preventDefault();\r\n                            action();\r\n                        }\r\n                        let onTouchStart = (evt: React.TouchEvent<HTMLAnchorElement>) => {\r\n                            action();\r\n                        }\r\n                            // eslint-disable-next-line\r\n                        return <a className=\"dropdown-item\" key={index} href=\"#/\" \r\n                            onClick={onMenuItemClick} onTouchStart={onTouchStart}\r\n                            >{i} <span className={captionClass || itemCaptionClass}>{caption}</span></a>\r\n                    })\r\n                }\r\n            </div>\r\n        </div>\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport { setRes } from '../../res';\r\n\r\nexport interface EasyDateProps {\r\n    date: Date | number;\r\n}\r\n\r\n//type YMD = (year:number, month:number, date:number) => string;\r\n//type MD = (month:number, date:number) => string;\r\n\r\nconst timeRes:{[prop:string]:any} = {\r\n\tmd: (month:number, date:number) => `${month}-${date}`,\r\n\tymd: (year:number, month:number, date:number) => `${year}-${month}-${date}`,\r\n\tyesterday: 'Yday',\r\n\ttoday: 'Today',\r\n\ttomorrow: 'Tmw',\r\n\t$zh: {\r\n\t\tmd: (month:number, date:number) => `${month}月${date}日`,\r\n\t\tymd: (year:number, month:number, date:number) => `${year}年${month}月${date}日`,\r\n\t\tyesterday: '昨天',\r\n\t\ttoday: '今天',\r\n\t\ttomorrow: '明天',\r\n\t},\r\n\t$en: {\r\n\t\tmd: (month:number, date:number) => `${month}-${date}`,\r\n\t\tymd: (year:number, month:number, date:number) => `${year}-${month}-${date}`,\r\n\t\tyesterday: 'Yday',\r\n\t\ttoday: 'Today',\r\n\t\ttomorrow: 'Tmw',\r\n\t}\r\n}\r\n\r\nsetRes(timeRes, timeRes);\r\n\r\nfunction tt(str:string):any {\r\n\treturn timeRes[str];\r\n}\r\n\r\nfunction renderDate(vDate:Date|number, withTime:boolean, always:boolean = false) {\r\n    if (!vDate) return null;\r\n    let date: Date;\r\n    switch (typeof vDate) {\r\n        default: date = vDate as Date; break;\r\n        case 'string': date = new Date(vDate); break;\r\n        case 'number': date = new Date((vDate as number)*1000); break;\r\n    }\r\n\r\n    let now = new Date();\r\n    let tick:number, nDate:number, _date:number, month:number, year:number, nowYear:number;\r\n    let d = date;\r\n    tick = now.getTime() - d.getTime();\r\n    let hour=d.getHours(), minute=d.getMinutes();\r\n    nDate=now.getDate();\r\n    _date=d.getDate();\r\n    month=d.getMonth()+1;\r\n    year=d.getFullYear();\r\n\tnowYear = now.getFullYear();\r\n\r\n\tlet appendTime:boolean = false;\r\n\tlet dPart:string = (function() {\r\n\t\tif (tick < -24*3600*1000) {\r\n\t\t\tif (year === nowYear) {\r\n\t\t\t\tappendTime = true;\r\n\t\t\t\treturn tt('md')(month, _date);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tappendTime = true;\r\n\t\t\t\treturn tt('ymd')(year, month, _date);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (tick < 24*3600*1000) {\r\n\t\t\tif (_date!==nDate) {\r\n\t\t\t\tappendTime = true;\r\n\t\t\t\treturn tt(tick < 0? 'tomorrow' : 'yesterday');\r\n\t\t\t}\r\n\t\t\tif (withTime===true) {\r\n\t\t\t\tappendTime = true;\r\n\t\t\t\treturn '';\r\n\t\t\t}\r\n\t\t\treturn tt('today');\r\n\t\t}\r\n\t\tif (year === nowYear) {\r\n\t\t\treturn tt('md')(month, _date);\r\n\t\t}\r\n\t\treturn tt('ymd')(year, month, _date);\r\n\t})();\r\n\r\n\tlet hm = hour + ((minute<10?':0':':') + minute);\r\n\r\n\t/*\r\n    if (tick < -24*3600*1000) {\r\n        if (year === nowYear)\r\n            return tt('md')(month, _date) + ' ' + hm;\r\n        else\r\n            return tt('ymd')(year, month, _date) + ' ' + hm;\r\n    }\r\n    if (always === true || tick < 24*3600*1000) {\r\n        return _date!==nDate? \r\n            tt(tick < 0? 'tomorrow' : 'yesterday') + ' ' + hm \r\n            : withTime===true? hm : tt('today');\r\n    }\r\n    if (year === nowYear) {\r\n        return tt('md')(month, _date);\r\n    }\r\n\treturn tt('ymd')(year, month, _date);\r\n\t*/\r\n\tif (appendTime === true || always === true) {\r\n\t\treturn dPart + ' ' + hm;\r\n\t}\r\n\treturn dPart;\r\n}\r\n\r\n\r\nexport class EasyDate extends React.Component<EasyDateProps> {\r\n    render() {\r\n        return renderDate(this.props.date, false);\r\n    }\r\n}\r\n\r\ninterface EasyTimeProps extends EasyDateProps {\r\n\talways?: boolean;\r\n}\r\nexport class EasyTime extends React.Component<EasyTimeProps> {\r\n    render() {\r\n\t\tlet {date, always} = this.props;\r\n        return renderDate(date, true, always);\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport classNames from 'classnames';\r\nimport { Image } from '.';\r\n\r\nexport interface MediaProps {\r\n    icon: string;\r\n    main: string|JSX.Element;\r\n    discription?: string | JSX.Element;\r\n    px?: number;\r\n    py?: number;\r\n}\r\n\r\nexport class Media extends React.Component<MediaProps> {\r\n    render() {\r\n        let {icon, main, discription, px, py} = this.props;\r\n        let disp:any;\r\n        if (typeof discription === 'string')\r\n            disp = <div>{discription}</div>;\r\n        else\r\n            disp = discription;\r\n        let cn = classNames(\r\n            'media', \r\n            px===undefined? 'px-0':'px-'+px, \r\n            py===undefined? 'py-2':'py-'+py);\r\n        return <div className={cn}>\r\n            <Image className=\"mr-3 w-4c h-4c\" src={icon} />\r\n            <div className=\"media-body\">\r\n                <h5 className=\"mt-0\">{main}</h5>\r\n                {disp}\r\n            </div>\r\n        </div>\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport classNames from 'classnames';\r\n\r\nexport interface SearchBoxProps {\r\n    className?: string;\r\n    label?: string;\r\n    initKey?: string;\r\n    placeholder?: string;\r\n    buttonText?: string;\r\n    maxLength?: number;\r\n    size?: 'sm' | 'md' | 'lg';\r\n    inputClassName?: string;\r\n    onSearch: (key:string)=>Promise<void>;\r\n    onFocus?: ()=>void;\r\n    allowEmptySearch?: boolean;\r\n}\r\n\r\n/*\r\nexport interface SearchBoxState {\r\n    disabled: boolean;\r\n}*/\r\n\r\nexport class SearchBox extends React.Component<SearchBoxProps> { //}, SearchBoxState> {\r\n    private input: HTMLInputElement;\r\n\tprivate button: HTMLButtonElement;\r\n    private key: string = null;\r\n\t\r\n    private onChange = (evt: React.ChangeEvent<any>) => {\r\n        this.key = evt.target.value;\r\n        if (this.key !== undefined) {\r\n            this.key = this.key.trim();\r\n            if (this.key === '') this.key = undefined;\r\n        }\r\n\t\tconsole.log('key = ' + this.key);\r\n        if (this.props.allowEmptySearch === true) {\r\n\t\t}\r\n\t\telse {\r\n            this.button.disabled = this.key === undefined || this.key.length === 0;\r\n        }\r\n    }\r\n    private onSubmit = async (evt: React.FormEvent<any>) => {\r\n        evt.preventDefault();\r\n        if (this.key === null) this.key = this.props.initKey || '';\r\n        if (this.props.allowEmptySearch !== true) {\r\n            if (!this.key) return;\r\n            if (this.input) this.input.disabled = true;\r\n\t\t\tif (this.button) this.button.disabled = true;\r\n        }\r\n        await this.props.onSearch(this.key);\r\n        if (this.input) this.input.disabled = false;\r\n\t\tif (this.button) this.button.disabled = false;\r\n    }\r\n    clear() {\r\n        if (this.input) this.input.value = '';\r\n    }\r\n    render() {\r\n\t\tlet {className, inputClassName, onFocus,\r\n\t\t\tlabel, placeholder, buttonText, maxLength, size} = this.props;\r\n\t\tlet inputSize:string;\r\n\t\tswitch (size) {\r\n\t\t\tdefault:\r\n\t\t\tcase 'sm': inputSize = 'input-group-sm'; break;\r\n\t\t\tcase 'md': inputSize = 'input-group-md'; break;\r\n\t\t\tcase 'lg': inputSize = 'input-group-lg'; break;\r\n\t\t}\r\n\t\treturn <form className={className} onSubmit={this.onSubmit} >\r\n\t\t\t<div className={classNames(\"input-group\", inputSize)}>\r\n\t\t\t\t{label && <div className=\"input-group-addon align-self-center mr-2\">{label}</div>}\r\n\t\t\t\t<input ref={v=>this.input=v} onChange={this.onChange}\r\n\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\tname=\"key\"\r\n\t\t\t\t\tonFocus={onFocus}\r\n\t\t\t\t\tclassName={classNames('form-control', inputClassName || 'border-primary')}\r\n\t\t\t\t\tplaceholder={placeholder}\r\n\t\t\t\t\tdefaultValue={this.props.initKey}\r\n\t\t\t\t\tmaxLength={maxLength} />\r\n\t\t\t\t<div className=\"input-group-append\">\r\n\t\t\t\t\t<button ref={v=>this.button=v} className=\"btn btn-primary\"\r\n\t\t\t\t\t\ttype=\"submit\"\r\n\t\t\t\t\t\tdisabled={this.props.allowEmptySearch !== true}>\r\n\t\t\t\t\t\t<i className='fa fa-search' />\r\n\t\t\t\t\t\t<i className=\"fa\"/>\r\n\t\t\t\t\t\t{buttonText}\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</form>;\t\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport classNames from 'classnames';\r\nimport { nav } from './nav';\r\nimport { observer } from 'mobx-react';\r\nimport { observable } from 'mobx';\r\nimport { userApi } from '../net';\r\nimport { User } from '../tool';\r\n\r\nexport type UserLoader = (userId:number)=>Promise<any>;\r\n\r\nexport class UserCache<T> {\r\n\tprivate loader: UserLoader;\r\n\tprivate onLoaded: (user:User) => void;\r\n\tprivate map = observable(new Map<number, T|number>());\r\n\r\n\tconstructor(loader: UserLoader) {\r\n\t\tif (loader === undefined) loader = (userId:number)=>userApi.user(userId);\r\n\t\tthis.loader = loader;\r\n\t}\r\n\r\n\tuse(id:number|any, onLoaded?:(user:User)=>void) {\t\t\r\n\t\tif (!id) return;\r\n\t\tif (typeof id === 'object') id = id.id;\r\n\t\tif (!id) return;\r\n\t\tthis.onLoaded = onLoaded;\r\n\t\tid = Number(id);\r\n\t\tlet ret = this.map.get(id);\r\n\t\tif (ret === undefined) {\r\n\t\t\tthis.map.set(id, id);\r\n\t\t}\r\n\t}\r\n\r\n\tgetValue(id:number|any):any {\r\n\t\tif (!id) return;\r\n\t\tswitch (typeof(id)) {\r\n\t\t\tcase 'object': \r\n\t\t\t\tid = id.id; \r\n\t\t\t\tif (!id) return;\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\tlet ret = this.map.get(id);\r\n\t\tif (!ret) return;\r\n\t\tswitch (typeof(ret)) {\r\n\t\tdefault:\r\n\t\t\treturn ret;\r\n\t\tcase 'number':\r\n\t\t\tif (ret < 0) return id;\r\n\t\t\tthis.map.set(id, -id);\r\n\t\t\tthis.loader(id).then(v => {\r\n\t\t\t\tif (!v) v = null;\r\n\t\t\t\tthis.map.set(id, v);\r\n\t\t\t\tif (this.onLoaded) this.onLoaded(v);\r\n\t\t\t}).catch(reason => {\r\n\t\t\t\tconsole.error(reason);\r\n\t\t\t});\r\n\t\t\treturn id;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nconst userCache = new UserCache(undefined);\r\n\r\nexport interface UserIconProps {\r\n    id: number;\r\n    className?: string;\r\n    style?: React.CSSProperties;\r\n    altImage?: string;\r\n    noneImage?: any;\r\n}\r\n\r\nexport const UserIcon = observer((props: UserIconProps):JSX.Element => {\r\n    let {className, style, id, altImage, noneImage} = props;\r\n    let user = userCache.getValue(id);\r\n    switch (typeof user) {\r\n\tcase 'undefined':\r\n\tcase 'number':\r\n        return <div className={classNames(className, 'image-none')} style={style}>\r\n            {noneImage || <i className=\"fa fa-file-o\" />}\r\n        </div>;\r\n    }\r\n    let {icon} = user;\r\n    if (!icon) {\r\n        return <div className={classNames(className, 'image-none')} style={style}>\r\n            <i className=\"fa fa-file-o\" />\r\n        </div>;\r\n    }\r\n    if (icon.startsWith(':') === true) {\r\n        icon = nav.resUrl + icon.substr(1);\r\n    }\r\n    return <img src={icon} className={className} alt=\"img\"\r\n        style={style}\r\n        onError={evt=>{\r\n            if (altImage) evt.currentTarget.src=altImage;\r\n            else evt.currentTarget.src = 'https://tv.jkchemical.com/imgs/0001.png';\r\n        }} />;\r\n});\r\n\r\nexport interface UserViewProps {\r\n\tid?: number;\r\n\tuser?: number|User;\r\n\trender: (user:User) => JSX.Element;\r\n\tonLoaded?: (user:User) => void\r\n}\r\n\r\nexport const UserView = observer((props: UserViewProps):JSX.Element => {\r\n\tlet {id:idProp, user, render, onLoaded} = props;\r\n\tif (user === null) return <>null</>;\r\n\tswitch (typeof user) {\r\n\t\tcase 'undefined': \r\n\t\t\tuser = userCache.getValue(idProp);\r\n\t\t\tbreak;\r\n\t\tcase 'object': \r\n\t\t\tlet {/*obj, */id} = user as any;\r\n\t\t\t//if (typeof obj !== 'object') {\r\n\t\t\t\tuseUser(id, onLoaded);\r\n\t\t\t\tuser = userCache.getValue(id);\r\n\t\t\t//}\r\n\t\t\tbreak;\r\n\t\tcase 'number':\r\n\t\t\tuseUser(user as number, onLoaded);\r\n\t\t\tuser = userCache.getValue(user as number);\r\n\t\t\tbreak;\r\n\t\tcase 'string':\r\n\t\t\tuseUser(Number(user), onLoaded);\r\n\t\t\tuser = userCache.getValue(Number(user));\r\n\t\t\tbreak;\r\n\t\tdefault:\r\n\t\t\tuser = undefined;\r\n\t\t\tbreak;\r\n\t}\r\n    switch (typeof user) {\r\n\t\tcase 'undefined':\r\n\t\tcase 'number':\r\n        \treturn <>{user}</>;\r\n    }\r\n    return render(user);\r\n});\r\n\r\nexport function useUser(id: number|object, onLoaded?: (user:User)=>void) {\r\n\tif (!id) return;\r\n\tif (typeof(id) === 'object') {\r\n\t\tid = (id as any).id;\r\n\t}\r\n\tuserCache.use(id, onLoaded);\r\n}\r\n","import React from \"react\";\r\nimport classNames from 'classnames';\r\nimport { nav } from \"../nav\";\r\n\r\nexport interface AxProps extends React.DetailedHTMLProps<React.AnchorHTMLAttributes<HTMLAnchorElement>, HTMLAnchorElement> {\r\n\t//children: React.ReactNode;\r\n\t//href: string;\r\n\t//onClick?: (event:React.MouseEvent) => void;\r\n\t//className?: string;\r\n\taClassName?: string;\r\n\tnaClassName?: string;\r\n\t//target?: string;\r\n\t//props?: any;\r\n}\r\n\r\n// 如果是web方式，用webNav方式route网页\r\n// 如果是app方式，用click方式压栈页面\r\nexport const Ax = (axProps: AxProps) => {\r\n\tlet {href, children, className, onClick} = axProps;\r\n\tif (nav.isWebNav === true) {\r\n\t\tlet {aClassName } = axProps;\r\n\t\tif (!href) return <span className=\"text-danger\">Error: href not defined in Ax</span>;\r\n\t\tlet onAxClick = (evt: React.MouseEvent<HTMLAnchorElement>) => {\r\n\t\t\tevt.preventDefault();\r\n\t\t\tlet ret:boolean;\r\n\t\t\tif (onClick) {\r\n\t\t\t\tret = onClick(evt) as unknown as boolean;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tnav.navigate(href);\r\n\t\t\t\tret = false;\r\n\t\t\t}\r\n\t\t\treturn ret;\r\n\t\t}\r\n\t\treturn <a {...axProps} className={classNames(className, aClassName)} onClick={onAxClick}>{children}</a>;\r\n\t}\r\n\telse {\r\n\t\tlet {naClassName} = axProps;\r\n\t\tif (!onClick) {\r\n\t\t\tonClick = () => {\r\n\t\t\t\tif (nav.openSysPage(href) === false) {\r\n\t\t\t\t\tnav.navigate(href);\r\n\t\t\t   };\r\n\t\t\t   return false;\r\n\t\t   }\r\n\t\t}\r\n\t\treturn <span className={classNames(className, 'cursor-pointer', naClassName)} onClick={onClick}>{children}</span>;\r\n\t}\r\n}\r\n\r\n// 同普通的a tag\r\n// 会自动处理href，处理生产版跟测试版之间的不同\r\nexport const A = (props: React.DetailedHTMLProps<React.AnchorHTMLAttributes<HTMLAnchorElement>, HTMLAnchorElement>) => {\r\n\tlet {children} = props;\r\n\tif (nav.isWebNav === false) {\r\n\t\treturn <a {...props}>{children}</a>;\r\n\t}\r\n\tlet {href} = props;\r\n\t//if (nav.testing === true) href += '#test';\r\n\tlet onClick = (evt: React.MouseEvent<HTMLAnchorElement>) => {\r\n\t\tevt.preventDefault();\r\n\t\tnav.navigate(href);\r\n\t\treturn false;\r\n\t}\r\n\treturn <a {...props} href={href} onClick={onClick}>{children}</a>;\r\n}\r\n","import React from 'react';\r\nimport { observer } from \"mobx-react\";\r\nimport { IObservableValue } from 'mobx';\r\n\r\nexport function autoHideTips(\r\n\ttips: IObservableValue<boolean|string|JSX.Element>, \r\n\ttemplet?:string|JSX.Element|((v:string|JSX.Element)=>JSX.Element), \r\n\ttimeout?:number):React.FunctionComponentElement<any> \r\n{\r\n\tlet timer:any;\r\n\treturn React.createElement(observer(():JSX.Element => {\r\n\t\tif (timer) {\r\n\t\t\tclearTimeout(timer);\r\n\t\t\ttimer = undefined;\r\n\t\t}\r\n\t\tlet t = tips.get();\r\n\t\tif (!t) return null;\r\n\t\tif (timeout === undefined) timeout = 3000;\r\n\r\n\t\tif (timeout > 0) {\r\n\t\t\ttimer = setTimeout(() => {\r\n\t\t\t\ttips.set(null);\r\n\t\t\t}, timeout);\r\n\t\t}\r\n\t\tswitch (typeof templet) {\r\n\t\t\tcase 'undefined': return <>{t}</>;\r\n\t\t\tcase 'function': return templet(t as string);\r\n\t\t\tcase 'string': return <>{templet}</>;\r\n\t\t\tdefault: return templet;\r\n\t\t}\r\n\t}));\r\n};\r\n","import { UqMan, TuidModify } from '../uqMan';\r\nimport { Tuid } from \"./tuid\";\r\nimport { env } from '../../tool';\r\n\r\ninterface Modify {\r\n    id: number;\r\n    entity: string;\r\n    key: string;\r\n}\r\n\r\nexport class TuidsCache {\r\n    private readonly uq: UqMan;\r\n    private modifyMax: TuidModify;\r\n    private cacheTimer: any;\r\n    constructor(uq: UqMan) {\r\n        this.uq = uq;\r\n    }\r\n\r\n    cacheTuids(defer:number) {\r\n        this.clearCacheTimer();\r\n        this.cacheTimer = env.setTimeout('TuidsCache.cacheTuids', this.loadIds, defer);\r\n    }\r\n    private clearCacheTimer() {\r\n        if (this.cacheTimer === undefined) return;\r\n        env.clearTimeout(this.cacheTimer);\r\n        this.cacheTimer = undefined;\r\n    }\r\n    private loadIds = () => {\r\n        this.clearCacheTimer();\r\n        let {tuids} = this.uq;\r\n        for (let i in tuids) {\r\n            let tuid = tuids[i];\r\n            tuid.cacheIds();\r\n        }\r\n    }\r\n    \r\n    pullModify(modifyMax:number) {\r\n        if (modifyMax === undefined) return;\r\n        let now = Math.floor(Date.now() / 1000);\r\n        if (this.modifyMax === undefined) {\r\n            this.modifyMax = this.uq.localModifyMax.get();\r\n            if (this.modifyMax === undefined) {\r\n                this.modifyMax = {\r\n                    max: modifyMax,\r\n                    seconds: now,\r\n                };\r\n                this.uq.localModifyMax.set(this.modifyMax);\r\n            }\r\n        }\r\n        let {max, seconds} = this.modifyMax;\r\n        let lockGap = 3600;\r\n        if (now - seconds < lockGap) return;\r\n        if (modifyMax <= max) return;\r\n        let tuidCached:string[] = [];\r\n        let {tuids} = this.uq;\r\n        for (let i in tuids) {\r\n            //if (tuids[i].cached === true) \r\n            tuidCached.push(i);\r\n        }\r\n        if (tuidCached.length === 0) return;\r\n        this.modifyMax.seconds = now;\r\n        this.innerPullModify(tuidCached.join('\\t'));\r\n    }\r\n\r\n    private async innerPullModify(tuidLists:string):Promise<void> {\r\n        let {uqApi, tuids} = this.uq;\r\n        let {max} = this.modifyMax;\r\n        let ret:{queue:Modify[], queueMax:number} = await uqApi.queueModify(max, 30, tuidLists);\r\n        let group:{[entity:string]: {tuid:Tuid; ids: string[]}} = {};\r\n        let modifyMax:number = 0;\r\n        for (let modify of ret.queue) {\r\n\t\t\tlet {id, entity, key} = modify;\r\n\t\t\tif (!key) continue;\r\n            let tuid = tuids[entity];\r\n            if (tuid === undefined) continue;\r\n            let item = group[entity];\r\n            if (item === undefined) {\r\n                item = group[entity] = {tuid: tuid, ids:[]};\r\n            }\r\n            item.ids.push(key);\r\n            if (id > modifyMax) modifyMax = id;\r\n        }\r\n        for (let i in group) {\r\n            let {tuid, ids} = group[i];\r\n            await tuid.modifyIds(ids);\r\n        }\r\n        let now = Math.floor(Date.now() / 1000);\r\n        this.modifyMax = {\r\n            max: modifyMax,\r\n            seconds: now,\r\n        }\r\n        this.uq.localModifyMax.set(this.modifyMax);\r\n    }\r\n}\r\n","export * from './ui';\r\nexport * from './fieldItem';\r\nexport * from './fieldUI';\r\nexport * from './IDUI';\r\n","import { ButtonSchema, FieldItem, FieldItemId, FieldItemString, IDUI, PickId, Prop, Schema, UI, UiButton, UiSchema, Uq } from \"tonva-react\";\r\n\r\nexport abstract class Mid {\r\n\treadonly uq: Uq;\r\n\treadonly res: any;\r\n\tconstructor(uq: Uq, res?: any) {\r\n\t\tthis.uq = uq;\r\n\t\tthis.res = res;\r\n\t}\r\n\r\n\tabstract init():Promise<void>;\r\n\r\n\tprotected async buildItemSchema(IDUI: IDUI): Promise<Schema> {\r\n\t\tlet {ID} = IDUI;\r\n\t\tlet ret:Schema = [];\r\n\t\tlet {fieldArr} = ID.ui;\r\n\t\tfor (let f of fieldArr) {\r\n\t\t\tlet {type, isKey} = f;\r\n\t\t\tlet required = isKey; // (keys as any[]).findIndex(v => v.name === name) >= 0;\r\n\t\t\tlet fieldItem = {\r\n\t\t\t\t...f,\r\n\t\t\t\trequired,\r\n\t\t\t};\r\n\t\t\tswitch (type) {\r\n\t\t\t\tdefault: ret.push(fieldItem); break;\r\n\t\t\t}\r\n\t\t\tlet {ID} = fieldItem;\r\n\t\t\tif (ID) {\r\n\t\t\t\tlet importSelect = await import('../select');\r\n\t\t\t\tthis.setIDUi(fieldItem, importSelect.createPickId(this.uq, ID), ID.render);\r\n\t\t\t}\r\n\t\t}\r\n\t\tret.push({\r\n\t\t\tname: 'submit',\r\n\t\t\ttype: 'submit',\r\n\t\t} as ButtonSchema);\r\n\t\treturn ret;\r\n\t}\r\n\r\n\tprotected buildUISchema(IDUI:IDUI):UiSchema {\r\n\t\tlet {ID} = IDUI;\r\n\t\tlet {fields} = ID.ui;\r\n\t\tlet items = {...fields as any};\r\n\t\tlet uiButton: UiButton = {\r\n\t\t\tlabel: '提交',\r\n\t\t\tclassName: 'btn btn-primary',\r\n\t\t\twidget: 'button',\r\n\t\t};\r\n\t\titems['submit'] = uiButton;\r\n\t\tlet ret = {items};\r\n\t\treturn ret;\r\n\t}\r\n\r\n\tprotected buildGridProps(ui: UI):Prop[] {\r\n\t\tlet ret:Prop[] = [];\r\n\t\tlet {fieldArr } = ui;\r\n\t\tfor (let f of fieldArr) {\r\n\t\t\tlet prop = {\r\n\t\t\t\t...f\r\n\t\t\t};\r\n\t\t\tret.push(prop as any);\r\n\t\t}\r\n\t\treturn ret;\r\n\t}\r\n\t\r\n\tprotected setIDUi(fieldItem:FieldItem, pickId: PickId, render: (values:any) => JSX.Element) {\r\n\t\tif (fieldItem.type !== 'id') {\r\n\t\t\talert(`${fieldItem.name} is not id UI`);\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tlet idField = fieldItem as FieldItemId;\r\n\t\tidField.widget = 'id';\r\n\t\tidField.pickId = pickId;\r\n\t\t(idField as any).Templet = render;\r\n\t}\r\n\r\n\tprotected setNO(no:string, noFieldItem: FieldItem) {\r\n\t\tif (!noFieldItem) return;\r\n\t\tif (noFieldItem.type !== 'string') return;\r\n\t\tlet noField = noFieldItem as FieldItemString;\r\n\t\tnoField.readOnly = true;\r\n\t\tnoField.defaultValue = no;\r\n\t}\r\n\r\n}\r\n","import _ from 'lodash';\r\nimport { Context } from '../context';\r\nimport { FormRes } from '../../../res/formRes';\r\n\r\nexport abstract class Rule {\r\n    abstract check(defy:string[], value:any):void;\r\n}\r\n\r\nexport type ContextRule = (context:Context)=>{[target:string]:string[]|string} | string[] | string;\r\nexport type FieldRule = (value:any) => string[] | string;\r\n\r\nexport class RuleCustom extends Rule {\r\n    private func: FieldRule;\r\n    constructor(func: FieldRule) {\r\n        super();\r\n        this.func = func;\r\n    }\r\n    check(defy:string[], value:any) {\r\n        let ret = this.func(value);\r\n        if (ret === undefined) return;\r\n        switch (typeof ret) {\r\n            case 'undefined': return;\r\n            case 'string': defy.push(ret as string); return;\r\n            default: defy.push(...ret); return;\r\n        }        \r\n    }\r\n}\r\n\r\nexport abstract class RulePredefined extends Rule {\r\n    protected res: FormRes;\r\n    constructor(res: FormRes) {\r\n        super();\r\n        this.res = res;\r\n    }\r\n}\r\n\r\nexport class RuleRequired extends RulePredefined {\r\n    check(defy:string[], value:any) {\r\n        switch (typeof value) {\r\n            default:\r\n            case 'boolean': return;\r\n            case 'object':\r\n                if (value !== null) return;\r\n                break;\r\n            case 'string':\r\n                if ((value as string).trim().length > 0) return;\r\n                break;\r\n            case 'number':\r\n                if (isNaN(value as number) === false) return;\r\n                break;\r\n            case 'undefined':\r\n                break;\r\n        }\r\n        defy.push(this.res.required);\r\n    }\r\n}\r\n\r\nexport class RuleNum extends RulePredefined {\r\n    private minMsg: _.TemplateExecutor;\r\n    private maxMsg: _.TemplateExecutor;\r\n    protected min: number;\r\n    protected max: number\r\n    constructor(res: FormRes, min?: number, max?: number) {\r\n        super(res);\r\n        this.minMsg = _.template(res.min);\r\n        this.maxMsg = _.template(res.max);\r\n        this.min = min;\r\n        this.max = max;\r\n    }\r\n    check(defy:string[], value:any) {\r\n        if (value === undefined || value === null) return;\r\n        let n = Number(value);\r\n        if (isNaN(n) === true) {\r\n            defy.push(this.res.number);\r\n        }\r\n        else {\r\n            this.checkMore(defy, n);\r\n        }\r\n    }\r\n\r\n    protected checkMore(defy:string[], value: number) {\r\n        if (this.min !== undefined && Number(value) < this.min) {\r\n            defy.push(this.minMsg({min:this.min}));\r\n        }\r\n        if (this.max !== undefined && Number(value) > this.max) {\r\n            defy.push(this.maxMsg({max:this.max}));\r\n        }\r\n    }\r\n}\r\n\r\nexport class RuleInt extends RuleNum {\r\n    protected checkMore(defy:string[], n: number) {\r\n        super.checkMore(defy, n);\r\n        if (Number.isInteger(n) === false) {\r\n            defy.push(this.res.integer);\r\n        }\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport classNames from 'classnames';\r\nimport { UiItem, ChangingHandler, ChangedHandler } from '../../schema';\r\nimport { FieldProps } from '../field';\r\nimport { Context } from '../context';\r\nimport { ItemSchema } from '../../schema';\r\nimport { Rule, RuleRequired, RuleCustom, FieldRule } from '../rules';\r\nimport { computed, makeObservable, observable } from 'mobx';\r\nimport { observer } from 'mobx-react';\r\n\r\nexport abstract class Widget {\r\n    name: string;\r\n    protected context: Context;\r\n    protected fieldProps:FieldProps;\r\n    protected children: React.ReactNode;\r\n    protected _itemSchema: ItemSchema;\r\n    protected _ui: UiItem;\r\n\tprotected defaultValue: any;\r\n    protected rules: Rule[];\r\n    protected readOnly:boolean;\r\n\tprotected disabled:boolean;\r\n\t\r\n    errors: string[] = [];\r\n    contextErrors: string[] = [];\r\n    get hasError():boolean {return (this.errors.length + this.contextErrors.length)>0}\r\n    visible:boolean = null;\r\n\tvalue: any = null;\r\n\r\n    constructor(context:Context, itemSchema:ItemSchema, fieldProps:FieldProps, children: React.ReactNode) {\r\n\t\tmakeObservable(this, {\r\n\t\t\terrors: observable,\r\n\t\t\tcontextErrors: observable,\r\n\t\t\thasError: computed,\r\n\t\t\tvisible: observable,\r\n\t\t\tvalue: observable,\r\n\t\t});\r\n        this.context = context;\r\n        let {name} = itemSchema;\r\n        this.name = name;\r\n        this._itemSchema = itemSchema;\r\n        this.fieldProps = fieldProps;\r\n        this.children = children;\r\n        this._ui = context.getUiItem(name);\r\n        if (this.ui === undefined) {\r\n            this.readOnly = false;\r\n            this.disabled = false;\r\n            this.visible = true;\r\n        }\r\n        else {\r\n            let {readOnly, disabled, visible} = this.ui;\r\n            this.readOnly = (readOnly === true);\r\n            this.disabled = (disabled === true);\r\n            this.visible = !(visible === false);            \r\n        }\r\n        this.value = this.defaultValue =  context.getValue(name); //defaultValue;\r\n        // this.init();\r\n    }\r\n\r\n    protected get itemSchema(): ItemSchema {return this._itemSchema};\r\n    protected get ui(): UiItem {return this._ui};\r\n\r\n    init() {\r\n        this.rules = [];\r\n        if (this.itemSchema.required === true) {\r\n            this.rules.push(new RuleRequired(this.context.form.res));\r\n        }\r\n        this.buildRules();\r\n        if (this.ui === undefined) return;\r\n        let {rules} = this.ui;\r\n        if (rules === undefined) return;\r\n        if (Array.isArray(rules) === false) {\r\n            this.rules.push(new RuleCustom(rules as FieldRule));\r\n            return;\r\n        }\r\n        for (let rule of rules as FieldRule[]) {\r\n            this.rules.push(new RuleCustom(rule));\r\n        }\r\n    }\r\n\r\n    protected buildRules() {\r\n    }\r\n\r\n    checkRules() {\r\n        let defy:string[] = [];\r\n        for (let r of this.rules) r.check(defy, this.value);\r\n        if (defy.length === 0) {\r\n            this.context.removeErrorWidget(this);\r\n        }\r\n        else {\r\n            this.context.addErrorWidget(this);\r\n            this.errors.push(...defy);\r\n        }\r\n    }\r\n\r\n    @computed get isOk() {\r\n        return this.errors.length ===0;\r\n    }\r\n\r\n    setError(err:string | string[]) {\r\n        if (err === undefined) return;\r\n        if (typeof err === 'string') this.errors.push(err);\r\n        else this.errors.push(...err);\r\n    }\r\n\r\n    setContextError(err:string | string[]) {\r\n        if (err === undefined) return;\r\n        if (typeof err === 'string') this.contextErrors.push(err);\r\n        else this.contextErrors.push(...err);\r\n    }\r\n\r\n    clearError() {\r\n        this.errors.splice(0);\r\n    }\r\n\r\n    clearContextError() {\r\n        this.contextErrors.splice(0);\r\n    }\r\n\r\n    protected parse(value:any):any {return value}\r\n\r\n    protected setElementValue(value:any) {}\r\n    protected setDataValue(value:any) {\r\n        if (this.isChanging === true) return;\r\n        this.context.initData[this.name] = this.value = this.parse(value);\r\n    }\r\n\r\n    setValue(value:any) {\r\n        if (this.isChanging === true) return;\r\n        //this.setDataValue(value);\r\n        //this.setElementValue(value);\r\n        this.changeValue(value, false);\r\n    }\r\n\r\n    getValue() {\r\n        return this.context.getValue(this.name);\r\n    }\r\n\r\n    getReadOnly():boolean {return this.readOnly}\r\n    getDisabled():boolean {return this.disabled}\r\n    getVisible():boolean {return this.visible}\r\n    setReadOnly(value:boolean) {this.readOnly = value}\r\n    setDisabled(value:boolean) {this.disabled = value}\r\n    setVisible(value:boolean) {this.visible = value}\r\n\r\n    private isChanging: boolean;\r\n    protected onInputChange = (evt: React.ChangeEvent<any>) => {\r\n        this.changeValue(evt.target.value, true);\r\n    }\r\n\r\n    protected changeValue(newValue: any, fromElement: boolean) {\r\n        let prev = this.value;\r\n        let onChanging: ChangingHandler;\r\n        let onChanged: ChangedHandler;\r\n        if (this.ui !== undefined) {\r\n            onChanging = this.ui.onChanging;\r\n            onChanged = this.ui.onChanged;\r\n        }\r\n        let allowChange = true;\r\n        if (onChanging !== undefined) {\r\n            this.isChanging = true;\r\n            allowChange = onChanging(this.context, this.value, prev);\r\n            this.isChanging = false;\r\n        }\r\n        if (allowChange === true) {\r\n            this.setDataValue(newValue);\r\n            if (fromElement !== true) this.setElementValue(newValue);\r\n            if (onChanged !== undefined) {\r\n                this.isChanging = true;\r\n                onChanged(this.context, this.value, prev);\r\n                this.isChanging = false;\r\n            }\r\n        }\r\n    }\r\n\r\n    protected get className():string {\r\n        let fieldClass:string;\r\n        if (this.context.inNode === false) fieldClass = 'form-control';\r\n        return classNames(fieldClass, this.context.form.FieldClass, this.ui && this.ui.className);\r\n    }\r\n\r\n    protected abstract render():JSX.Element;\r\n\r\n    protected renderBody():JSX.Element {\r\n        let elDiscription;\r\n        if (this.hasError === false && this.ui) {\r\n            let {discription, discriptionClassName} = this.ui;\r\n            if (discriptionClassName === undefined) discriptionClassName = 'small text-muted';\r\n            elDiscription = <span className={discriptionClassName}>\r\n                {discription}\r\n            </span>;\r\n        }\r\n        return <>\r\n            {this.render()}\r\n            {elDiscription}\r\n        </>;\r\n    }\r\n\r\n    container = observer(():JSX.Element => {\r\n        if (this.visible === false) return null;\r\n        let {form, inNode} = this.context;\r\n        if (inNode === true) return this.render();\r\n        let label:any = this.label;\r\n        if (this.itemSchema.required === true && form.props.requiredFlag !== false) {\r\n            if (label !== null) label = <>{label}&nbsp;<span className=\"text-danger\">*</span></>;\r\n        }\r\n        return form.FieldContainer(label, this.renderBody());\r\n    })\r\n\r\n    protected get label():string {\r\n        let label:any;\r\n        if (this.ui === undefined) {\r\n            label = this.name;\r\n        }\r\n        else {\r\n            let uiLabel = this.ui.label;\r\n            if (uiLabel === null) label = null;\r\n            else label = uiLabel || this.name;\r\n        }\r\n        return label;\r\n    }\r\n\r\n    protected renderTemplet():JSX.Element | undefined {\r\n        if (this.children !== undefined) {\r\n            return <>{this.children}</>;\r\n        }\r\n        if (this.ui === undefined) return undefined;\r\n        let {Templet} = this.ui;\r\n        if (typeof Templet === 'function') return Templet(this.value);\r\n        return Templet;\r\n    }\r\n\r\n    protected renderErrors() {\r\n        let errorList:string[] = [...this.errors, ...this.contextErrors];\r\n        if (errorList.length === 0) return null;\r\n        let {inNode} = this.context;\r\n        let tag = inNode === true? 'span' : 'div';\r\n        return errorList.map(err => React.createElement(tag, \r\n            {\r\n                key: err, \r\n                className: 'text-danger d-inline-block my-2 ml-3'\r\n            },\r\n            <><i className=\"fa fa-exclamation-circle\" /> &nbsp;{err}</>\r\n        ));\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport classNames from 'classnames';\r\nimport { makeObservable, observable, runInAction } from 'mobx';\r\nimport { UiTextItem, StringSchema, ItemSchema } from '../../schema';\r\nimport { Context } from '../context';\r\nimport { FieldProps } from '../field';\r\nimport { Widget } from './widget';\r\n\r\nexport class TextWidget extends Widget {\r\n    protected inputType = 'text';\r\n    protected get ui(): UiTextItem {return this._ui as UiTextItem};\r\n    protected input: HTMLInputElement;\r\n    hasFocus: boolean = false;\r\n\r\n\tconstructor(context:Context, itemSchema:ItemSchema, fieldProps:FieldProps, children: React.ReactNode) {\r\n\t\tsuper(context, itemSchema, fieldProps, children);\r\n\t\tmakeObservable(this, {\r\n\t\t\thasFocus: observable,\r\n\t\t})\r\n\t}\r\n\r\n    protected setElementValue(value:any) {\r\n        if (this.input === null) return;\r\n        this.input.value = value;\r\n    }\r\n    protected get placeholder() {\r\n\t\tif (this.ui) {\r\n\t\t\tlet {placeholder} = this.ui;\r\n\t\t\tif (placeholder) return placeholder;\r\n\t\t\tlet {label} = this.ui;\r\n\t\t\tif (label) return label;\r\n\t\t}\r\n\t\treturn this.name\r\n\t}\r\n    protected onKeyDown = async (evt:React.KeyboardEvent<HTMLInputElement>) => {\r\n        this.internalOnKeyDown(evt);\r\n        if (evt.keyCode !== 13) return;\r\n        let {onEnter} = this.context.form.props;\r\n        if (onEnter === undefined) return;\r\n\r\n        this.changeValue(evt.currentTarget.value, true);\r\n\r\n        //this.checkRules();\r\n        //this.context.checkContextRules();\r\n        this.input.blur();\r\n\r\n        let ret = await onEnter(this.name, this.context);\r\n        if (ret !== undefined) {\r\n            this.context.setError(this.name, ret);\r\n        }\r\n    }\r\n\r\n    protected internalOnKeyDown(evt:React.KeyboardEvent<HTMLInputElement>) {\r\n    }\r\n\r\n    protected onBlur = (evt: React.FocusEvent<any>) => {\r\n\t\trunInAction(() => {\r\n\t\t\tthis.onInputChange(evt);\r\n\t\t\tthis.checkRules();\r\n\t\t\tthis.context.checkContextRules();\r\n\t\t\tthis.hasFocus = false;\r\n\t\t});\r\n    }\r\n    protected onFocus = (evt: React.FocusEvent<any>) => {\r\n\t\trunInAction(() => {\r\n\t\t\tthis.clearError();\r\n\t\t\tthis.context.removeErrorWidget(this);\r\n\t\t\tthis.context.clearErrors();\r\n\t\t\tthis.hasFocus = true;\t\r\n\t\t});\r\n    }\r\n    protected onChange(evt: React.ChangeEvent<any>) {\r\n    }\r\n\r\n    setReadOnly(value:boolean) {\r\n        if (this.input === null) return;\r\n        this.input.readOnly = this.readOnly = value;\r\n    }\r\n    setDisabled(value:boolean) {\r\n        if (this.input === null) return;\r\n        this.input.disabled = this.disabled = value;\r\n    }\r\n\r\n    render() {\r\n        let renderTemplet = this.renderTemplet();\r\n        if (renderTemplet !== undefined) return renderTemplet;\r\n        let cn:any = {\r\n            //'form-control': true,\r\n        };\r\n        if (this.hasError === true) {\r\n            cn['is-invalid'] = true;\r\n        }\r\n        else {\r\n            cn['required-item'] = this.itemSchema.required === true;\r\n        }\r\n        return <><input ref={input=>this.input = input}\r\n            className={classNames(this.className, cn)}\r\n            type={this.inputType}\r\n            defaultValue={this.value}\r\n            onChange={(evt: React.ChangeEvent<any>) => this.onChange(evt)}\r\n            placeholder={typeof this.placeholder === 'string'? this.placeholder : undefined}\r\n            readOnly={this.readOnly}\r\n            disabled={this.disabled}\r\n            onKeyDown = {this.onKeyDown}\r\n            onFocus = {this.onFocus}\r\n            onBlur={this.onBlur}\r\n            maxLength={(this.itemSchema as StringSchema).maxLength} />\r\n            {this.renderErrors()}\r\n        </>;\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport classNames from 'classnames';\r\nimport { Widget } from './widget';\r\nimport { UiTextAreaItem } from '../../schema';\r\nimport { StringSchema } from '../../schema';\r\n\r\nexport class TextAreaWidget extends Widget {\r\n    protected get itemSchema(): StringSchema {return this._itemSchema as StringSchema};\r\n    protected input: HTMLTextAreaElement;\r\n    protected get ui(): UiTextAreaItem {return this._ui as UiTextAreaItem};\r\n\r\n    protected setElementValue(value:any) {this.input.value = value}\r\n    protected onInputChange = (evt: React.ChangeEvent<HTMLTextAreaElement>) => {\r\n        this.setValue(evt.currentTarget.value);\r\n    }\r\n\r\n    setReadOnly(value:boolean) {this.input.readOnly = this.readOnly = value}\r\n    setDisabled(value:boolean) {this.input.disabled = this.disabled = value}\r\n\r\n\tprotected onBlur = (evt: React.FocusEvent<any>) => {\r\n        this.onInputChange(evt);\r\n        this.checkRules();\r\n        this.context.checkContextRules();\r\n    }\r\n    protected onFocus = (evt: React.FocusEvent<any>) => {\r\n        this.clearError();\r\n        this.context.removeErrorWidget(this);\r\n        this.context.clearErrors();\r\n    }\r\n\r\n    render() {\r\n        let renderTemplet = this.renderTemplet();\r\n        if (renderTemplet !== undefined) return renderTemplet;\r\n        let cn:any = {};\r\n        if (this.hasError === true) {\r\n            cn['is-invalid'] = true;\r\n        }\r\n        else {\r\n            cn['required-item'] = this.itemSchema.required === true;\r\n        }\r\n        return <>\r\n\t\t\t<textarea ref={(input) => this.input=input}\r\n\t\t\t\tonBlur={this.onBlur} \r\n\t\t\t\tonFocus={this.onFocus}\r\n                className={classNames(this.className, cn)}\r\n                rows={this.ui && this.ui.rows}\r\n                maxLength={this.itemSchema.maxLength}\r\n                defaultValue={this.defaultValue} onChange={this.onInputChange} />\r\n            {this.renderErrors()}\r\n        </>;\r\n    }\r\n}\r\n","//import * as React from 'react';\r\nimport { TextWidget } from './textWidget';\r\n\r\nexport class PasswordWidget extends TextWidget {\r\n    protected inputType = 'password';\r\n}\r\n\r\nexport class UrlWidget extends TextWidget {\r\n    protected inputType = 'url';\r\n}\r\n\r\nexport class EmailWidget extends TextWidget {\r\n    protected inputType = 'email';\r\n}\r\n","//import * as React from 'react';\r\nimport { TextWidget } from './textWidget';\r\nimport { RuleNum, RuleInt } from '../rules';\r\nimport { NumBaseSchema } from '../../schema';\r\n\r\nexport class NumberWidget extends TextWidget {\r\n    protected inputType = 'number';\r\n    protected get itemSchema(): NumBaseSchema {return this._itemSchema as NumBaseSchema};\r\n\r\n    protected buildRules() {\r\n        super.buildRules();\r\n        let res = this.context.form.res;\r\n        let {min, max} = this.itemSchema;\r\n        this.rules.push(\r\n            this.itemSchema.type === 'integer'?\r\n\t\t\t\tnew RuleInt(res, min, max) :\r\n\t\t\t\tnew RuleNum(res, min, max)\r\n        );\r\n    }\r\n\r\n    protected parse(value:any):any {\r\n\t\tswitch (typeof value) {\r\n\t\t\tdefault: return;\r\n\t\t\tcase 'undefined': return;\r\n\t\t\tcase 'number': return value;\r\n\t\t\tcase 'string':\r\n\t\t\t\tif ((value as string).trim().length === 0) return;\r\n\t\t\t\treturn Number(value);\r\n\t\t}\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport { NumberWidget } from './numberWidget';\r\n\r\nexport class UpdownWidget extends NumberWidget {\r\n    protected inputType = 'number';\r\n\r\n    protected isValidKey(key:number):boolean {\r\n        return key===46 || key===8 || key===37 || key===39\r\n            || (key>=48 && key<=57)\r\n            || (key>=96 && key<=105)\r\n            || key===109 || key===189;\r\n    }\r\n    \r\n    protected internalOnKeyDown(evt:React.KeyboardEvent<HTMLInputElement>) {\r\n        let key = evt.keyCode;\r\n        window.event.returnValue = this.isValidKey(key);\r\n    }\r\n}\r\n","//import * as React from 'react';\r\nimport { TextWidget } from './textWidget';\r\n\r\nexport class DateWidget extends TextWidget {\r\n    protected inputType = 'date';\r\n}\r\n\r\nexport class DateTimeWidget extends TextWidget {\r\n    protected inputType = 'datetime';\r\n}\r\n\r\nexport class TimeWidget extends TextWidget {\r\n    protected inputType = 'time';\r\n}\r\n\r\nexport class MonthWidget extends TextWidget {\r\n    protected inputType = 'month';\r\n}\r\n","import * as React from 'react';\r\nimport classNames from 'classnames';\r\nimport { Widget } from './widget';\r\nimport { UiCheckItem } from '../../schema';\r\n\r\nexport class CheckBoxWidget extends Widget {\r\n    protected input: HTMLInputElement;\r\n    protected get ui(): UiCheckItem {return this._ui as UiCheckItem};\r\n    protected trueValue: any;\r\n    protected falseValue: any;\r\n\r\n    init() {\r\n        super.init();\r\n        if (this.ui !== undefined) {\r\n            let {trueValue, falseValue} = this.ui;\r\n            if (trueValue === undefined) this.trueValue = true;\r\n            else this.trueValue = trueValue;\r\n            if (falseValue === undefined) this.falseValue = false;\r\n            else this.falseValue = falseValue;\r\n        }\r\n        else {\r\n            this.trueValue = true;\r\n            this.falseValue = false;\r\n        }\r\n    }\r\n    protected setElementValue(value:any) {\r\n        this.input.checked = value === this.trueValue;\r\n    }\r\n    setReadOnly(value:boolean) {this.input.readOnly = this.readOnly = value}\r\n    setDisabled(value:boolean) {this.input.disabled = this.disabled = value}\r\n\r\n    protected onInputChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\r\n        let v = evt.target.checked === true? this.trueValue : this.falseValue;\r\n        this.setDataValue(v);\r\n    }\r\n\r\n    protected onClick = () => {\r\n        this.context.clearErrors();\r\n    }\r\n\r\n    render() {\r\n        let cn = classNames(this.className, 'form-check-inline p-0');\r\n        let input = <input\r\n            ref={(input)=>this.input = input}\r\n            className={'align-self-center'}\r\n            type=\"checkbox\"\r\n            defaultChecked={this.defaultValue} \r\n            onChange={this.onInputChange}\r\n            onClick={this.onClick} />;\r\n        if (this.context.inNode === true) {\r\n            return <label className={cn}>\r\n                {input} {(this.ui&&this.ui.label) || this.name}\r\n            </label>\r\n        }\r\n        else {\r\n            return <div className={cn}>\r\n                <label className=\"w-100 h-100 mb-0 d-flex justify-content-center\">{input}</label>\r\n            </div>;\r\n        }\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport classNames from 'classnames';\r\nimport { makeObservable, observable } from 'mobx';\r\nimport { Widget } from './widget';\r\nimport { ItemSchema, UiSelect } from '../../schema';\r\nimport { Context } from '../context';\r\nimport { FieldProps } from '../field';\r\n\r\nexport class SelectWidget extends Widget {\r\n    protected select: HTMLSelectElement;\r\n    protected get ui(): UiSelect {return this._ui as UiSelect};\r\n    readOnly: boolean = false;\r\n\r\n\tconstructor(context:Context, itemSchema:ItemSchema, fieldProps:FieldProps, children: React.ReactNode) {\r\n\t\tsuper(context, itemSchema, fieldProps, children);\r\n\t\tmakeObservable(this, {\r\n\t\t\treadOnly: observable,\r\n\t\t})\r\n\t}\r\n\r\n    protected setElementValue(value:any) {this.select.value = value}\r\n    protected onInputChange = (evt:React.ChangeEvent<HTMLSelectElement>) => {\r\n        this.setDataValue(evt.target.value);\r\n    }\r\n\r\n    setReadOnly(value:boolean) {this.select.disabled = this.readOnly = !value}\r\n    setDisabled(value:boolean) {this.select.disabled = this.disabled = value}\r\n\r\n    render() {\r\n        if (this.readOnly === true) {\r\n            let option = this.ui.list.find(v => v.value === this.value);\r\n            let title = (option === undefined)? '(???)' : option.title;\r\n            return <span className=\"form-control w-min-6c\">{title}</span>;\r\n        }\r\n        return <select\r\n            ref={(select)=>this.select = select}\r\n            className={classNames(this.className, 'form-control')}\r\n            defaultValue={this.defaultValue} \r\n            onChange={this.onInputChange}>\r\n            {this.ui.list.map((v,index) => {\r\n                let {title, value} = v;\r\n                let cn:string;\r\n                //if (value === undefined || value === null) cn = 'text-light small';\r\n                //else cn = 'text-danger';\r\n                return <option className={cn} key={index} value={value}>{title || value}</option>\r\n            })}\r\n        </select>\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport classNames from 'classnames';\r\n//import { TextWidget } from './textWidget';\r\nimport { Widget } from './widget';\r\nimport { UiRadio } from '../../schema';\r\nimport { RowContext } from '../context';\r\n\r\n\r\nconst radioStyle:React.CSSProperties = {height: 'auto'};\r\n\r\nexport class RadioWidget extends Widget {\r\n    protected inputs: {[index:number]: HTMLInputElement} = {};\r\n    protected get ui(): UiRadio {return this._ui as UiRadio};\r\n\r\n    protected setElementValue(value:any) {\r\n        for (let i in this.inputs) {\r\n            let input = this.inputs[i];\r\n            input.checked = value === input.value;\r\n        }\r\n    }\r\n    setReadOnly(value:boolean) {\r\n        this.readOnly = value;\r\n        for (let i in this.inputs) this.inputs[i].readOnly = value;\r\n    }\r\n    setDisabled(value:boolean) {\r\n        this.disabled = value;\r\n        for (let i in this.inputs) this.inputs[i].disabled = value\r\n    }\r\n\r\n    /*\r\n    protected onInputChange = (evt: React.ChangeEvent<any>) => {\r\n        this.changeValue(evt.target.value, true);\r\n    }\r\n    */\r\n\r\n    render() {\r\n        let {defaultValue, list} = this.ui;\r\n        let {isRow} = this.context;\r\n        let rowKey:number;\r\n        if (isRow === true) {\r\n            rowKey = (this.context as RowContext).rowKey;\r\n        }\r\n        let cn = classNames(this.className, 'py-0');\r\n        return <span className={cn} style={radioStyle}>\r\n                {list.map((v,index) => {\r\n                    let {value, title} = v;\r\n                    let name = this.name;\r\n                    if (rowKey !== undefined) name += '-' + rowKey;\r\n                    return <label key={index} className=\"form-radio-inline\">\r\n                        <input ref={input=>this.inputs[index]=input} type=\"radio\" name={name}\r\n                            value={value} defaultChecked={(this.defaultValue || defaultValue)===value}\r\n                            onChange={this.onInputChange} />\r\n                        {title || value}\r\n                    </label>;\r\n                    //</span>\r\n                })}\r\n            </span>;\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport classNames from 'classnames';\r\nimport { UiRange } from '../../schema';\r\nimport { Widget } from './widget';\r\n\r\nexport class RangeWidget extends Widget {\r\n    protected inputType = 'range';\r\n    protected input: HTMLInputElement;\r\n    protected get ui(): UiRange {return this._ui as UiRange};\r\n\r\n    setReadOnly(value:boolean) {this.input.readOnly = this.readOnly = value}\r\n    setDisabled(value:boolean) {this.input.disabled = this.disabled = value}\r\n\r\n    render() {\r\n        let {min, max, step} = this.ui;\r\n        return <><input ref={input=>this.input = input}\r\n            className={classNames(this.className, 'form-control', 'w-min-6c')}\r\n            type={this.inputType}\r\n            defaultValue={this.defaultValue} \r\n            onChange={this.onInputChange}\r\n            max={max}\r\n            min={min}\r\n            step={step}\r\n            />\r\n        </>;\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport classNames from 'classnames';\r\nimport { Widget } from './widget';\r\nimport { UiIdItem, TempletType } from '../../schema';\r\nimport { runInAction } from 'mobx';\r\n\r\nconst none = <small className=\"text-muted\">[无]</small>;\r\n\r\nexport class IdWidget extends Widget {\r\n    protected get ui(): UiIdItem {return this._ui as UiIdItem};\r\n\r\n    setReadOnly(value:boolean) {this.readOnly = value}\r\n    setDisabled(value:boolean) {this.disabled = value}    \r\n\r\n    protected onClick = async () => {\r\n        let pickId = this.ui && this.ui.pickId;\r\n        if (pickId === undefined) {\r\n            alert('no pickId defined!');\r\n            return;\r\n        }\r\n\t\tlet id = await pickId(this.context, this.name, this.value);\r\n\t\trunInAction(() => {\r\n\t\t\tthis.setDataValue(id);\r\n\t\t\tthis.clearError();\r\n\t\t\tthis.clearContextError();\r\n\t\t\tthis.checkRules();\t\r\n\t\t});\r\n    }\r\n\r\n\tsetValue(value:any) {\r\n\t\tsuper.setValue(value);\r\n\t}\r\n\r\n    render() {\r\n        let placeholder:string|JSX.Element, Templet: TempletType;\r\n        if (this.ui !== undefined) {\r\n            placeholder = this.ui.placeholder;\r\n            Templet = this.ui.Templet;\r\n        }\r\n        let cn:any = {\r\n            'form-control': true,\r\n            'required-item': this.itemSchema.required === true,\r\n            'cursor-pointer': true,\r\n            'is-invalid': this.hasError,\r\n        };\r\n        let content;\r\n        if (this.value === undefined || this.value === null) {\r\n            content = placeholder || none;\r\n            cn['text-muted'] = true;\r\n        }\r\n        else if (Templet === undefined) {\r\n            let c: any;\r\n            if (this.value === null) {\r\n                c = 'null';\r\n            }\r\n            else {\r\n                switch (typeof this.value) {\r\n                    case 'undefined': c = none; break;\r\n                    case 'object': c = (this.value as any).id; break;\r\n                    default: c = this.value; break;\r\n                }\r\n            }\r\n            content = <>{c}</>;\r\n        }\r\n        else if (typeof Templet === 'function') {\r\n            content = Templet(this.value);\r\n        }\r\n        else {\r\n            content = Templet;\r\n        }\r\n        return <>\r\n            <div className={classNames(cn)} onClick={this.onClick}>{content}</div>\r\n            {this.renderErrors()}\r\n        </>;\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport { DataType } from '../../schema';\r\nimport { UiType } from '../../schema';\r\n\r\nexport const Unknown = (dataType:DataType, uiType:UiType, dataTypes:DataType[]) => {\r\n    return <span className=\"text-danger\">!!data type {dataType} only support {(dataTypes || []).join(', ')}, can't use ui {uiType}!!</span>;\r\n};\r\n","import * as React from 'react';\r\nimport { UiButton, TempletType } from '../../schema';\r\nimport { Unknown } from './unknown';\r\nimport { Widget } from './widget';\r\nimport { observer } from 'mobx-react';\r\nimport { runInAction } from 'mobx';\r\n\r\nexport class ButtonWidget extends Widget {\r\n    protected get ui(): UiButton {return this._ui as UiButton};\r\n\r\n    protected onClick = async () => {\r\n\t\trunInAction(() => {\r\n\t\t\tthis.clearError();\r\n\t\t\tthis.clearContextError();\r\n\t\t})\r\n        let {name, type} = this.itemSchema;\r\n        if (type === 'submit') {\r\n\t\t\tawait this.context.submit(name);\r\n\t\t\treturn;\r\n        }\r\n        let {onButtonClick} = this.context.form.props;\r\n        if (onButtonClick === undefined) {\r\n            alert(`button ${name} clicked. you should define form onButtonClick`);\r\n            return;\r\n        }\r\n        let ret = await onButtonClick(name, this.context);\r\n        if (ret === undefined) return;\r\n\t\trunInAction(() => {\r\n\t\t\tthis.context.setError(name, ret);\r\n\t\t});\r\n    }\r\n\r\n    private observerRender = observer(() => {\r\n        let {name, type} = this.itemSchema;\r\n        let Templet:TempletType, cn:string, caption:string|JSX.Element;\r\n        if (this.ui !== undefined) {\r\n            let {widget:widgetType} = this.ui;\r\n            if (widgetType !== 'button') return Unknown(type, widgetType, ['button']);\r\n            Templet = this.ui.Templet;\r\n            cn = this.ui.className;\r\n            caption = this.ui.label;\r\n        }\r\n        let {form, hasError} = this.context;\r\n        let context = this.context;\r\n        let disabled = type==='submit' && hasError;\r\n        let content:any;\r\n        if (this.children !== undefined) content = this.children;\r\n        else if (typeof Templet === 'function') content = Templet();\r\n        else if (Templet !== undefined) content = Templet;\r\n        else content = caption; \r\n        let button = <button \r\n            className={cn} \r\n            type=\"button\"\r\n            disabled={disabled}\r\n            onClick={this.onClick}>\r\n            {content || name}\r\n        </button>;\r\n        if (context.inNode === true) return <>{button}{this.renderErrors()}</>;\r\n        return <div className={form.ButtonClass}>\r\n            <div>{this.renderErrors()}</div>\r\n            {button}\r\n        </div>;\r\n    });\r\n    \r\n    protected get label():string {return null}\r\n\r\n    render() {\r\n        return React.createElement(this.observerRender);\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport { Form } from './form';\r\nimport { UiSchema, UiArr, UiItem } from '../schema';\r\nimport { ArrSchema, ItemSchema } from '../schema';\r\nimport { Widget } from './widgets/widget';\r\n//import { ArrRow } from './arrRow';\r\nimport { observable, computed, makeObservable, runInAction } from 'mobx';\r\nimport { ContextRule } from './rules';\r\nimport { observer } from 'mobx-react';\r\n\r\nexport abstract class Context {\r\n    private subContexts:{[name:string]:{[rowKey:string]:Context}};\r\n    readonly form: Form;\r\n    readonly uiSchema: UiSchema;\r\n    readonly initData: any;\r\n    readonly inNode: boolean;           // true: 在</> 流中定义Field\r\n    readonly widgets: {[name:string]: Widget} = {};\r\n    readonly rules: ContextRule[];\r\n\treadonly isRow: boolean;\r\n\t\r\n    errors: string[] = [];\r\n    errorWidgets:Widget[] = [];\r\n\r\n    constructor(form: Form, uiSchema: UiSchema, data: any, inNode: boolean, isRow: boolean) {\r\n\t\tmakeObservable(this, {\r\n\t\t\terrors: observable,\r\n\t\t\terrorWidgets: observable,\r\n\t\t});\r\n        this.form = form;\r\n        this.uiSchema = uiSchema;\r\n        this.initData = data;\r\n        this.inNode = inNode;\r\n        this.isRow = isRow;\r\n        if (uiSchema !== undefined) {\r\n            let {rules} = uiSchema;\r\n            if (rules !== undefined) {\r\n                this.rules = [];\r\n                if (Array.isArray(rules) === false)\r\n                    this.rules.push(rules as ContextRule);\r\n                else\r\n                    this.rules.push(...rules as ContextRule[]);\r\n            }\r\n        }\r\n    }\r\n\r\n    getArrRowContexts(arrName: string) {\r\n        if (this.subContexts === undefined) this.subContexts = {};\r\n        let arrRowContexts = this.subContexts[arrName];\r\n        if (arrRowContexts === undefined) this.subContexts[arrName] = arrRowContexts = {};\r\n        return arrRowContexts;\r\n    }\r\n\r\n    abstract get data():any;\r\n    abstract getItemSchema(itemName:string):ItemSchema;\r\n    abstract getUiItem(itemName:string):UiItem;\r\n    get arrName():string {return undefined}\r\n    getValue(itemName:string):any {return this.initData[itemName]}\r\n    setValue(itemName:string, value:any) {\r\n        this.initData[itemName] = value;\r\n        let widget = this.widgets[itemName];\r\n        if (widget !== undefined) widget.setValue(value);\r\n    }\r\n    getDisabled(itemName:string):boolean {\r\n        let widget = this.widgets[itemName];\r\n        if (widget !== undefined) return widget.getDisabled();\r\n        return undefined;\r\n    }\r\n    setDisabled(itemName:string, value:boolean) {\r\n        let widget = this.widgets[itemName];\r\n        if (widget !== undefined) widget.setDisabled(value);\r\n    }\r\n    getReadOnly(itemName:string):boolean {\r\n        let widget = this.widgets[itemName];\r\n        if (widget !== undefined) widget.getReadOnly();\r\n        return undefined;\r\n    }\r\n    setReadOnly(itemName:string, value:boolean) {\r\n        let widget = this.widgets[itemName];\r\n        if (widget !== undefined) widget.setReadOnly(value);\r\n    }\r\n    getVisible(itemName:string):boolean {\r\n        let widget = this.widgets[itemName];\r\n        if (widget !== undefined) widget.getVisible();\r\n        return undefined;\r\n    }\r\n    setVisible(itemName:string, value:boolean) {\r\n        let widget = this.widgets[itemName];\r\n        if (widget !== undefined) widget.setVisible(value);\r\n    }\r\n\r\n    async submit(buttonName: string) {\r\n        this.checkRules()\r\n        if (this.hasError === true) {\r\n            let err = '';\r\n            for (let ew of this.errorWidgets) {\r\n                err += ew.name + ':\\n' + ew.errors.join('\\n');\r\n            }\r\n            console.error(err);\r\n            return;\r\n        }\r\n        let {onButtonClick} = this.form.props;\r\n        if (onButtonClick === undefined) {\r\n            alert(`button ${buttonName} clicked. you should define form onButtonClick`);\r\n            return;\r\n        }\r\n        let ret = await onButtonClick(buttonName, this);\r\n        if (ret === undefined) return;\r\n        this.setError(buttonName, ret);\r\n\r\n    }\r\n\r\n    checkFieldRules() {\r\n        for (let i in this.widgets) {\r\n            this.widgets[i].checkRules();\r\n        }\r\n        if (this.subContexts === undefined) return;\r\n        for (let i in this.subContexts) {\r\n            let arrRowContexts = this.subContexts[i];\r\n            for (let j in arrRowContexts) {\r\n                arrRowContexts[j].checkFieldRules();\r\n            }\r\n        }\r\n    }\r\n\r\n    checkContextRules() {\r\n        this.clearErrors();\r\n        if (this.rules === undefined) return;\r\n        for (let rule of this.rules) {\r\n            let ret = rule(this);\r\n            if (ret === undefined) continue;\r\n            if (Array.isArray(ret) === true) {\r\n                this.errors.push(...ret as string[]);\r\n            }\r\n            else if (typeof ret === 'string') {\r\n                this.errors.push(ret as string);\r\n            }\r\n            else {\r\n                for (let i in ret as object) this.setError(i, (ret as any)[i]);\r\n            }\r\n        }\r\n        if (this.subContexts === undefined) return;\r\n        for (let i in this.subContexts) {\r\n            let arrRowContexts = this.subContexts[i];\r\n            for (let j in arrRowContexts) {\r\n                let rowContext = arrRowContexts[j];\r\n                rowContext.clearErrors();\r\n                rowContext.checkContextRules();\r\n            }\r\n        }\r\n    }\r\n\r\n    setError(itemName:string, error:string) {\r\n\t\trunInAction(() => {\r\n\t\t\tlet widget = this.widgets[itemName];\r\n\t\t\tif (widget === undefined) return;\r\n\t\t\twidget.setContextError(error);\r\n\t\t\tthis.addErrorWidget(widget);\t\r\n\t\t})\r\n    }\r\n\r\n    clearContextErrors() {\r\n\t\trunInAction(() => {\r\n\t\t\tfor (let i in this.widgets) {\r\n\t\t\t\tlet widget = this.widgets[i];\r\n\t\t\t\tif (widget === undefined) continue;\r\n\t\t\t\twidget.clearContextError();\r\n\t\t\t}\t\r\n\t\t});\r\n    }\r\n\r\n    clearWidgetsErrors() {\r\n\t\trunInAction(() => {\r\n\t\t\tfor (let i in this.widgets) {\r\n\t\t\t\tlet widget = this.widgets[i];\r\n\t\t\t\tif (widget === undefined) continue;\r\n\t\t\t\twidget.clearError();\r\n\t\t\t}\t\r\n\t\t});\r\n    }\r\n\r\n    checkRules() {\r\n        this.clearErrors();\r\n        this.clearWidgetsErrors();\r\n        this.checkFieldRules();\r\n        if (this.hasError === true) return;\r\n        this.checkContextRules();\r\n    }\r\n\r\n    addErrorWidget(widget:Widget) {\r\n        let pos = this.errorWidgets.findIndex(v => v === widget);\r\n        if (pos < 0) this.errorWidgets.push(widget);\r\n    }\r\n    removeErrorWidget(widget:Widget) {\r\n        let pos = this.errorWidgets.findIndex(v => v === widget);\r\n        if (pos >= 0) this.errorWidgets.splice(pos, 1);\r\n    }\r\n\r\n    protected checkHasError():boolean {\r\n        let ret = (this.errorWidgets.length + this.errors.length) > 0;\r\n        if (ret === true) return true;\r\n        if (this.subContexts === undefined) return false;\r\n        for (let i in this.subContexts) {\r\n            let arrRowContexts = this.subContexts[i];\r\n            for (let j in arrRowContexts) {\r\n                if (arrRowContexts[j].hasError === true) return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n    @computed get hasError():boolean {\r\n        return this.checkHasError();\r\n    };\r\n\r\n    clearErrors() {\r\n\t\trunInAction(() => {\r\n\t\t\tthis.errors.splice(0);\r\n\t\t\tthis.errorWidgets.splice(0);\r\n\t\t\tthis.clearContextErrors();\t\r\n\t\t});\r\n    }\r\n\r\n    renderErrors = observer((): JSX.Element => {\r\n        let {errors} = this;\r\n        if (errors.length === 0) return null;\r\n        return <>\r\n            {errors.map(err => <span key={err} className=\"text-danger inline-block my-1 ml-3\">\r\n                <i className=\"fa fa-exclamation-circle\" /> &nbsp;{err}\r\n            </span>)}\r\n        </>\r\n    });\r\n}\r\n\r\nlet rowKeySeed:number = 1;\r\nexport class RowContext extends Context {\r\n    readonly parentContext: Context;\r\n    readonly arrSchema: ArrSchema;\r\n    readonly rowKey: number;\r\n\treadonly data: any;\r\n    //readonly uiSchema: UiArr;\r\n\t\r\n    constructor(parentContext:Context, arrSchema: ArrSchema, data: any, inNode: boolean) {\r\n        let uiArr:UiArr;\r\n        let {uiSchema} = parentContext;\r\n        if (uiSchema !== undefined) {\r\n            let {items} = uiSchema;\r\n            if (items !== undefined) uiArr = items[arrSchema.name] as UiArr;\r\n        }\r\n        super(parentContext.form, uiArr, data, inNode, true);\r\n        this.parentContext = parentContext;\r\n        this.arrSchema = arrSchema;\r\n        this.rowKey = rowKeySeed++;\r\n        this.data = data;\r\n    }\r\n    getItemSchema(itemName:string):ItemSchema {return this.arrSchema.itemSchemas[itemName]}\r\n    getUiItem(itemName:string):UiItem {\r\n        if (this.uiSchema === undefined) return undefined;\r\n        let {items} = this.uiSchema;\r\n        if (items === undefined) return undefined;\r\n        return items[itemName]\r\n    }\r\n    get arrName():string {return this.arrSchema.name}\r\n    clearErrors() {\r\n        super.clearErrors();\r\n        this.parentContext.clearErrors();\r\n    }\r\n\r\n    get parentData():any {return this.parentContext.data;}\r\n}\r\n\r\nexport class FormContext extends Context {\r\n    constructor(form:Form, inNode:boolean) {\r\n        super(form, form.uiSchema, form.data, inNode, false);\r\n    }\r\n    get data():any {return this.form.data}\r\n    getItemSchema(itemName:string):ItemSchema {return this.form.itemSchemas[itemName]}\r\n    getUiItem(itemName:string):UiItem {\r\n        let {uiSchema} = this.form;\r\n        if (uiSchema === undefined) return undefined;\r\n        let {items} = uiSchema;\r\n        if (items === undefined) return undefined;\r\n        return items[itemName];\r\n    }\r\n}\r\n\r\nexport const ContextContainer = React.createContext<Context>({} as any);\r\n","import * as React from 'react';\r\nimport {observer} from 'mobx-react';\r\nimport classNames from 'classnames';\r\n//import { ArrRow } from '../arrRow';\r\nimport { Context, RowContext, ContextContainer } from '../context';\r\nimport { ArrSchema } from '../../schema';\r\nimport { UiArr, TempletType } from '../../schema';\r\nimport { Unknown } from './unknown';\r\nimport { factory } from './factory';\r\n\r\nexport const ArrComponent = observer((\r\n    {parentContext, arrSchema, children}:{parentContext: Context, arrSchema: ArrSchema, children: React.ReactNode}) => \r\n{\r\n    let {name, arr} = arrSchema;\r\n    let data = parentContext.initData[name] as any[];\r\n    let {form} = parentContext;\r\n    let arrRowContexts = parentContext.getArrRowContexts(name);\r\n\tlet ui = parentContext.getUiItem(name) as UiArr;\r\n\tlet {onDeleted, onRestored} = ui;\r\n    let arrLabel:string|JSX.Element = name;\r\n    let Templet:TempletType;\r\n    let selectable:boolean, deletable:boolean, restorable:boolean;\r\n    let {ArrContainer, RowContainer, RowSeperator, uiSchema} = form;\r\n    if (uiSchema !== undefined) {\r\n        let {selectable:formSelectable, deletable:formDeletable, restorable:formRestorable} = uiSchema;\r\n        if (selectable !== true) selectable = formSelectable;\r\n        if (deletable !== true) deletable = formDeletable;\r\n        if (restorable !== true) restorable = formRestorable;\r\n    }\r\n    if (ui !== undefined) {\r\n        let {widget:widgetType, label, \r\n            selectable:arrSelectable, deletable:arrDeletable, restorable:arrRestorable,\r\n            ArrContainer:ac, RowContainer:rc, RowSeperator:rs\r\n        } = ui;\r\n        if (arrSelectable !== undefined) selectable = arrSelectable;\r\n        if (arrDeletable !== undefined) deletable = arrDeletable;\r\n        if (arrRestorable !== undefined) restorable = arrRestorable;\r\n        if (ac !== undefined) ArrContainer = ac;\r\n        if (rc !== undefined) RowContainer = rc;\r\n        if (rs !== undefined) RowSeperator = rs;\r\n        Templet = ui.Templet;\r\n        if (widgetType !== 'arr') return Unknown(arrSchema.type, widgetType, ['arr']);\r\n        arrLabel = label || arrLabel;\r\n    }\r\n    let first = true;\r\n    return ArrContainer(arrLabel, <>\r\n        {data.map((row:any, index) => {\r\n            let rowContext: RowContext;\r\n            let rowContent: JSX.Element;\r\n            let sep = undefined;\r\n            if (first === false) sep = RowSeperator;\r\n            else first = false;\r\n            if (children !== undefined) {\r\n                rowContext = new RowContext(parentContext, arrSchema, row, true);\r\n                rowContent = <>{children}</>;\r\n            }\r\n            else {\r\n                let typeofTemplet = typeof Templet;\r\n                if (typeofTemplet === 'function') {\r\n                    rowContext = new RowContext(parentContext, arrSchema, row, true);\r\n                    rowContent = React.createElement(observer(Templet as React.StatelessComponent), row);\r\n                }\r\n                else if (typeofTemplet === 'object') {\r\n                    rowContext = new RowContext(parentContext, arrSchema, row, true);\r\n                    rowContent = Templet as JSX.Element;\r\n                }\r\n                else {\r\n                    rowContext = new RowContext(parentContext, arrSchema, row, false);\r\n                    rowContent = <>{\r\n                        arr.map((v, index) => {\r\n                            return <React.Fragment key={v.name}>\r\n                                {factory(rowContext, v, undefined)}\r\n                            </React.Fragment>\r\n                        })}\r\n                    </>;\r\n                }\r\n            }\r\n            let {rowKey} = rowContext;\r\n            arrRowContexts[rowKey] = rowContext;\r\n\r\n            let selectCheck:JSX.Element, deleteIcon:JSX.Element;\r\n            if (selectable === true) {\r\n                let onClick = (evt: React.MouseEvent<HTMLInputElement>)=>{\r\n                    let {checked} = (evt.target as HTMLInputElement);\r\n                    row.$isSelected = checked;\r\n                    let {$source} = row;\r\n                    if ($source !== undefined) $source.$isSelected = checked;\r\n                    rowContext.clearErrors();\r\n                }\r\n                selectCheck = <div className=\"form-row-checkbox\">\r\n                    <input type=\"checkbox\" onClick={onClick} defaultChecked={row.$isSelected} />\r\n                </div>;\r\n            }\r\n            let isDeleted = !(row.$isDeleted===undefined || row.$isDeleted===false);\r\n            if (deletable === true) {\r\n                let icon = isDeleted? 'fa-undo' : 'fa-trash';\r\n                let onDelClick = () => {\r\n                    if (restorable === true) {\r\n                        row.$isDeleted = !isDeleted;\r\n                        let {$source} = row;\r\n\t\t\t\t\t\tif ($source !== undefined) $source.$isDeleted = !isDeleted;\r\n\t\t\t\t\t\tif (onRestored) onRestored(row);\r\n                    }\r\n                    else {\r\n                        let p = data.indexOf(row);\r\n\t\t\t\t\t\tif (p>=0) data.splice(p, 1);\r\n\t\t\t\t\t\tif (onDeleted) onDeleted(row);\r\n                    }\r\n                    rowContext.clearErrors();\r\n                }\r\n                deleteIcon = <div className=\"form-row-edit text-info\" onClick={onDelClick}>\r\n                    <i className={classNames('fa', icon, 'fa-fw')} />\r\n                </div>;\r\n            }\r\n            let editContainer = selectable===true || deletable===true?\r\n                (content:any) => <fieldset disabled={isDeleted}><div className={classNames('d-flex', {'deleted':isDeleted, 'row-selected':row.$isSelected})}>\r\n                    {selectCheck}\r\n                    <div className={selectable===true && deletable===true? \"form-row-content\":\"form-row-content-1\"}>{content}</div>\r\n                    {deleteIcon}\r\n                </div></fieldset>\r\n                :\r\n                (content:any) => content;\r\n\r\n            return <ContextContainer.Provider key={rowKey} value={rowContext}>\r\n                {sep}\r\n                {RowContainer(editContainer(<><rowContext.renderErrors />{rowContent}</>))}\r\n            </ContextContainer.Provider>;\r\n        })}\r\n    </>);\r\n});\r\n","import * as React from 'react';\r\nimport classNames from 'classnames';\r\nimport { Widget } from './widget';\r\nimport { ItemSchema, UiImageItem } from '../../schema';\r\nimport { Image } from '../../image';\r\nimport { ImageItemEdit } from '../../edit/imageItemEdit';\r\nimport { observer } from 'mobx-react';\r\nimport { makeObservable, observable } from 'mobx';\r\nimport { Context } from '../context';\r\nimport { FieldProps } from '../field';\r\n\r\nexport class ImageWidget extends Widget {\r\n    protected input: HTMLInputElement;\r\n    protected get ui(): UiImageItem {return this._ui as UiImageItem};\r\n\r\n\timageSrc: string = null;\r\n\r\n\tconstructor(context:Context, itemSchema:ItemSchema, fieldProps:FieldProps, children: React.ReactNode) {\r\n\t\tsuper(context, itemSchema, fieldProps, children);\r\n\t\tmakeObservable(this, {\r\n\t\t\timageSrc: observable,\r\n\t\t})\r\n\t}\r\n\r\n    init() {\r\n        super.init();\r\n        this.imageSrc = this.value;\r\n    }\r\n\r\n    protected onClick = async () => {\r\n        let edit = new ImageItemEdit(undefined, this.itemSchema, this.ui, this.ui.label, this.value);\r\n        let ret = await edit.start();\r\n        if (ret !== null) {\r\n            this.setValue(ret);\r\n            this.imageSrc = ret;\r\n        }\r\n        await edit.end();\r\n    }\r\n\r\n    render() {\r\n        return React.createElement(this.observerRender);\r\n    }\r\n\r\n    private observerRender = observer(() => {\r\n        let cn = [\r\n            'bg-white p-1 d-flex justify-content-center',\r\n        ];\r\n        let onClick: any;\r\n        if (!this.readOnly && !this.disabled) {\r\n            cn.push('cursor-pointer');\r\n            onClick = this.onClick;\r\n        }\r\n        return <div className={classNames(cn)} onClick={onClick}>\r\n            <Image src={this.imageSrc} className=\"w-4c h-4c\"/>\r\n        </div>;\r\n    });\r\n}\r\n","import * as React from 'react';\r\nimport classNames from 'classnames';\r\nimport { Widget } from './widget';\r\nimport { UiTag, IValuesViewRenderOptions } from '../../schema';\r\nimport { RowContext } from '../context';\r\n\r\nabstract class TagWidget extends Widget {\r\n    protected inputs: {[index:number]: HTMLInputElement} = {};\r\n    protected get ui(): UiTag {return this._ui as UiTag};\r\n\r\n    protected setElementValue(value:any) {\r\n        for (let i in this.inputs) {\r\n            let input = this.inputs[i];\r\n            input.checked = value === input.value;\r\n        }\r\n    }\r\n    setReadOnly(value:boolean) {\r\n        this.readOnly = value;\r\n        for (let i in this.inputs) this.inputs[i].readOnly = value;\r\n    }\r\n    setDisabled(value:boolean) {\r\n        this.disabled = value;\r\n        for (let i in this.inputs) this.inputs[i].disabled = value\r\n\t}\r\n\t\r\n\tabstract render():JSX.Element;\r\n}\r\n\r\nexport class TagSingleWidget extends TagWidget {\r\n\trender() {\r\n\t\tlet {valuesView, wrapClassName} = this.ui;\r\n\t\tif (valuesView === undefined) return <>valuesView must be defined</>;\r\n        let {isRow} = this.context;\r\n        let rowKey:number;\r\n        if (isRow === true) {\r\n            rowKey = (this.context as RowContext).rowKey;\r\n        }\r\n        let cn = classNames(this.className, 'py-0');\r\n\t\tlet name = this.name;\r\n\t\tif (rowKey !== undefined) name += '-' + rowKey;\r\n\t\tlet options:IValuesViewRenderOptions = {\r\n\t\t\tclassName: cn,\r\n\t\t\tinputName: name,\r\n\t\t\twrapClassName,\r\n\t\t\tonInputChange: this.onInputChange\r\n\t\t}\r\n\t\treturn valuesView.renderRadios(this.defaultValue, options);\r\n    }\r\n}\r\n\r\nexport class TagMultiWidget extends TagWidget {\r\n\tprivate defaultArr:number[];\r\n\tinit() {\r\n\t\tsuper.init();\r\n\t\tlet def = this.defaultValue;\r\n\t\tswitch (typeof def) {\r\n\t\t\tdefault:\r\n\t\t\t\tthis.defaultArr = [];\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'string':\r\n\t\t\t\tthis.defaultArr = def.split('|').map(v => Number(v));\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n    protected onInputChange = (evt: React.ChangeEvent<any>) => {\r\n\t\tlet values:string[] = [];\r\n\t\tfor (let i in this.inputs) {\r\n\t\t\tlet input = this.inputs[i];\r\n\t\t\tif (input.checked === true) values.push(input.value);\r\n\t\t}\r\n        this.changeValue(values.join('|'), true);\r\n\t}\r\n\trender() {\r\n\t\tlet {valuesView, wrapClassName} = this.ui;\r\n\t\tif (valuesView === undefined) return <>valuesView must be defined</>;\r\n        let cn = classNames(this.className, 'py-0');\r\n\t\tlet options:IValuesViewRenderOptions = {\r\n\t\t\tclassName: cn,\r\n\t\t\tinputs: this.inputs,\r\n\t\t\twrapClassName,\r\n\t\t\tonInputChange: this.onInputChange\r\n\t\t}\r\n\t\treturn valuesView.renderChecks(this.defaultValue, options);\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport { ArrSchema, DataType, ItemSchema } from '../../schema';\r\nimport { TypeWidget, UiCustom } from '../../schema';\r\nimport { TextWidget } from './textWidget';\r\nimport { TextAreaWidget } from './textareaWidget';\r\nimport { PasswordWidget, UrlWidget, EmailWidget } from './passwordWidget';\r\nimport { UpdownWidget } from './updownWidget';\r\nimport { NumberWidget } from './numberWidget';\r\nimport { DateWidget, DateTimeWidget, TimeWidget, MonthWidget } from './dateWidget';\r\nimport { CheckBoxWidget } from './checkBoxWidget';\r\nimport { FieldProps } from '../field';\r\nimport { Context } from '../context';\r\nimport { SelectWidget } from './selectWidget';\r\nimport { RadioWidget } from './radioWidget';\r\nimport { RangeWidget } from './rangeWidget';\r\nimport { IdWidget } from './idWidget';\r\nimport { ButtonWidget } from './buttonWidget';\r\nimport { ArrComponent } from './arrComponent';\r\nimport { ImageWidget } from './imageWidget';\r\nimport { TagSingleWidget, TagMultiWidget } from './tagWidget';\r\n\r\ninterface WidgetFactory {\r\n\twidget?: TypeWidget;\r\n\tdataTypes?: DataType[];\r\n};\r\n\r\nconst stringWidget: WidgetFactory = {\r\n\tdataTypes: ['integer', 'number', 'string'],\r\n\twidget: TextWidget\r\n};\r\n\r\nconst widgetFactories: {[type: string]: WidgetFactory} = {\r\n    id: {\r\n        dataTypes: ['id'],\r\n        widget: IdWidget,\r\n    },\r\n    text: stringWidget,\r\n\tstring: stringWidget,\r\n    textarea: {\r\n        dataTypes: ['string'],\r\n        widget: TextAreaWidget\r\n    },\r\n    password: {\r\n        dataTypes: ['string'],\r\n        widget: PasswordWidget\r\n    },\r\n    date: {\r\n        dataTypes: ['date'],\r\n        widget: DateWidget\r\n    },\r\n    datetime: {\r\n        dataTypes: ['date'],\r\n        widget: DateTimeWidget\r\n    },\r\n    time: {\r\n        dataTypes: ['date'],\r\n        widget: TimeWidget\r\n    },\r\n    month: {\r\n        dataTypes: ['date'],\r\n        widget: MonthWidget\r\n    },\r\n    select: {\r\n        dataTypes: ['integer', 'number', 'string', 'date', 'boolean'],\r\n        widget: SelectWidget\r\n    },\r\n    url: {\r\n        dataTypes: ['string'],\r\n        widget: UrlWidget\r\n    },\r\n    email: {\r\n        dataTypes: ['string'],\r\n        widget: EmailWidget\r\n    },\r\n    number: {\r\n        dataTypes: ['integer', 'number'],\r\n        widget: NumberWidget\r\n    },\r\n    updown: {\r\n        dataTypes: ['integer', 'number'],\r\n        widget: UpdownWidget\r\n    },\r\n    color: {\r\n\r\n    },\r\n    checkbox: {\r\n        dataTypes: ['boolean', 'integer', 'number'],\r\n        widget: CheckBoxWidget\r\n    },\r\n    image: {\r\n        dataTypes: ['string'],\r\n        widget: ImageWidget,\r\n    },\r\n    checkboxes: {\r\n\r\n    },\r\n    radio: {\r\n        dataTypes: ['integer', 'number', 'string', 'date', 'boolean'],\r\n        widget: RadioWidget\r\n\t},\r\n\ttagSingle: {\r\n\t\tdataTypes: ['integer'],\r\n\t\twidget: TagSingleWidget\r\n\t},\r\n\ttagMulti: {\r\n\t\tdataTypes: ['string'],\r\n\t\twidget: TagMultiWidget\r\n\t},\r\n    range: {\r\n        dataTypes: ['integer'],\r\n        widget: RangeWidget,\r\n    },\r\n    button: {\r\n        dataTypes: ['button', 'submit'],\r\n        widget: ButtonWidget,\r\n    }\r\n}\r\n\r\nexport function factory(context: Context, itemSchema: ItemSchema, children:React.ReactNode, fieldProps?: FieldProps):JSX.Element {\r\n    if (context === undefined) {\r\n        debugger;\r\n        return null;\r\n    }\r\n    if (itemSchema === undefined) return undefined;\r\n    let {name, type} = itemSchema;\r\n    switch (type) {\r\n    case 'arr':\r\n        let arrSchema = context.getItemSchema(name) as ArrSchema;\r\n        return <ArrComponent parentContext={context} arrSchema={arrSchema} children={children} />;\r\n    default:\r\n        break;\r\n    }\r\n\r\n    let typeWidget: TypeWidget;\r\n    let ui = context.getUiItem(name);\t\r\n    function getTypeWidget(t:DataType): TypeWidget {\r\n        switch(t) {\r\n        default: return TextWidget; \r\n        case 'id': return IdWidget;\r\n        case 'integer': return UpdownWidget;\r\n        case 'number': return NumberWidget; \r\n        case 'string': return TextWidget; \r\n        case 'date': return DateWidget; \r\n        case 'boolean': return CheckBoxWidget; \r\n        case 'button':\r\n        case 'submit': return ButtonWidget;\r\n        }\r\n    }\r\n    if (ui === undefined) { \r\n        typeWidget = getTypeWidget(type);\r\n    }\r\n    else {\r\n        let {widget:widgetType, hiden} = ui;\r\n\t\tif (hiden === true) return null;\r\n        switch (widgetType) {\r\n        default:\r\n            if (widgetType !== undefined) {\r\n                let widgetFactory = widgetFactories[widgetType];\r\n\t\t\t\tif (!widgetFactory) {\r\n\t\t\t\t\tdebugger;\r\n\t\t\t\t\tthrow new Error(`unknown widget ${widgetType}`);\r\n\t\t\t\t}\r\n                typeWidget = widgetFactory.widget;\r\n            }\r\n            if (typeWidget === undefined) typeWidget = getTypeWidget(type);\r\n            break;\r\n        case 'custom':\r\n            typeWidget = (ui as UiCustom).WidgetClass;\r\n            break;\r\n        case 'group':\r\n            return <span>impletment group</span>;\r\n        }\r\n        //label = uiLabel || name;\r\n    }\r\n    \r\n\tlet {widgets} = context;\r\n\tlet widget = widgets[name];\r\n\tif (!widget) {\r\n\t\twidget = new typeWidget(context, itemSchema, fieldProps, children);\r\n\t\twidget.init();\r\n\t\twidgets[name] = widget;\r\n\t}\r\n\r\n    return <widget.container />;\r\n    /*\r\n    if (isRow === false) {\r\n        let WidgetElement = observer(() => widget.container());\r\n        return <WidgetElement />;\r\n    }\r\n    else {\r\n        let widgetElement = widget.container();\r\n        return widgetElement;\r\n    }\r\n    */\r\n}\r\n\r\n","import * as React from 'react';\r\nimport {observable, IReactionDisposer, autorun} from 'mobx';\r\nimport classNames from 'classnames';\r\nimport { Schema, ItemSchema, ArrSchema, UiSchema, TempletType } from '../schema';\r\nimport { factory } from './widgets';\r\nimport 'font-awesome/css/font-awesome.min.css';\r\nimport { ContextContainer, FormContext, Context } from './context';\r\nimport { FormRes, formRes, resLang } from '../../res';\r\n\r\nexport type FormButtonClick = (name:string, context: Context) => Promise<any>;\r\nexport type InputEnter = (name:string, context: Context) => Promise<any>;\r\n\r\nexport interface FormProps {\r\n    className?: string;\r\n    schema: Schema;\r\n    uiSchema?: UiSchema;\r\n    formData?: any;\r\n    onButtonClick?: FormButtonClick;\r\n    onEnter?: InputEnter;\r\n    fieldLabelSize?: number;            // col-sm-2 for label\r\n\tfieldLabelAlign?: 'left'|'center'|'right';\r\n    requiredFlag?: boolean;             // default=true\r\n    beforeShow?: (formContext:FormContext) => void;\r\n    res?: FormRes;\r\n\r\n    Container?: (content:JSX.Element) => JSX.Element;\r\n    FieldContainer?: (label:string|JSX.Element, content:JSX.Element) => JSX.Element;\r\n    FieldClass?: string;\r\n    ButtonClass?: string;\r\n}\r\n\r\nexport class Form extends React.Component<FormProps> {\r\n    readonly schema: Schema;\r\n    readonly itemSchemas: {[name:string]: ItemSchema};\r\n    readonly uiSchema: UiSchema;\r\n    readonly res?: FormRes;\r\n    protected formContext: FormContext;\r\n    private disposer: IReactionDisposer;\r\n    readonly data:any;\r\n\r\n    readonly Container: (content:JSX.Element) => JSX.Element;\r\n    readonly FieldContainer: (label:any, content:JSX.Element) => JSX.Element;\r\n    readonly FieldClass: string;\r\n    readonly ButtonClass: string;\r\n    \r\n    constructor(props:FormProps) {\r\n        super(props);\r\n        let {schema, uiSchema, \r\n            Container, FieldContainer, FieldClass, \r\n            ButtonClass, res,\r\n\t\t} = props;\r\n        this.Container = Container || this.DefaultContainer;\r\n        this.FieldContainer = FieldContainer || this.DefaultFieldContainer;\r\n        this.FieldClass = FieldClass!==undefined && FieldClass!==''&&FieldClass!==null? FieldClass : this.DefaultFieldClass;\r\n        this.res = res || this.DefaultRes;\r\n        this.ButtonClass = ButtonClass || this.DefaultButtonClass;\r\n\r\n        this.schema = schema;\r\n        this.itemSchemas = {};\r\n        for (let itemSchema of this.schema) {\r\n            this.itemSchemas[itemSchema.name] = itemSchema;\r\n        }\r\n        this.uiSchema = uiSchema;\r\n\r\n        this.disposer = autorun(this.watch);\r\n        this.data = {};\r\n    }\r\n\r\n    private renderContent():any {\r\n        this.initData(this.props.formData);\r\n        let {children} = this.props;\r\n        if (children !== undefined) {\r\n            this.formContext = new FormContext(this, true);\r\n            return <>{children}</>;\r\n        }\r\n\r\n        let Templet: TempletType;\r\n        if (this.uiSchema !== undefined) {\r\n            Templet = this.uiSchema.Templet;\r\n        }\r\n        if (Templet !== undefined) {\r\n            this.formContext = new FormContext(this, true);\r\n            return typeof(Templet) === 'function'? Templet(this.data) : Templet;\r\n        }\r\n\r\n\t\tif (!this.formContext) {\r\n\t\t\tthis.formContext = new FormContext(this, false);\r\n\t\t}\r\n        return <>{this.schema.map((v, index) => {\r\n            return <React.Fragment key={index}>{factory(this.formContext, v, children)}</React.Fragment>\r\n        })}</>;\r\n    }\r\n\r\n    private initData(formData: any) {\r\n        if (formData === undefined) formData = {};\r\n        if (this.uiSchema !== undefined) {\r\n            let {items} = this.uiSchema;\r\n            if (items !== undefined) {\r\n                for (let i in items) {\r\n                    let ui = items[i];\r\n                    let dv = ui.defaultValue;\r\n                    if (dv !== undefined) {\r\n                        if (formData[i] === undefined) {\r\n                            formData[i] = dv;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        for (let itemSchema of this.schema) {\r\n            this.initDataItem(itemSchema, this.data, formData);\r\n        }\r\n    }\r\n\r\n    private initDataItem(itemSchema: ItemSchema, data:any, formData: any):any {\r\n        let {name, type} = itemSchema;\r\n        if (type === 'button') return;\r\n        if (type !== 'arr') {\r\n            data[name] = formData[name];\r\n            return;\r\n        }\r\n\r\n        let arrItem:ArrSchema = itemSchema as ArrSchema;\r\n        let {arr:arrItems} = arrItem;\r\n        if (arrItems === undefined) return;\r\n        let arrDict:any = arrItem.itemSchemas = {};\r\n        for (let item of arrItems) {\r\n            arrDict[item.name] = item;\r\n        }\r\n        let val:any[] = formData[name];\r\n        if (val === undefined) val = [];\r\n        else if (Array.isArray(val) === false) val = [val];\r\n        let arr:any[] = [];\r\n        for (let row of val) {\r\n            let {$isSelected, $isDeleted} = row;\r\n            let r = {\r\n                $source: row,\r\n                $isSelected: $isSelected,\r\n                $isDeleted: $isDeleted,\r\n            };\r\n            for (let item of arrItems) {\r\n                this.initDataItem(item, r, row);\r\n            }\r\n            arr.push(r);\r\n        }\r\n        // 如果没有observable，行删除标志点击不管用\r\n        // 不知道这里为什么要去掉observable。有可能会有别的问题\r\n        data[name] = observable(arr);\r\n        //data[name] = arr;\r\n        return;\r\n    }\r\n\r\n    private watch = () => {\r\n        let {formData} = this.props;\r\n        if (formData === undefined) return;\r\n        //this.initData(formData);\r\n        this.calcSelectOrDelete();\r\n    }\r\n    private calcSelectOrDelete() {\r\n        for (let itemSchema of this.schema) {\r\n            this.arrItemOperated(itemSchema);\r\n        }\r\n    }\r\n\r\n    private arrItemOperated(itemSchema: ItemSchema) {\r\n        let {name, type} = itemSchema;\r\n        if (type !== 'arr') return;\r\n        if (this.data === undefined) return;\r\n        let formArrVal = this.data[name];\r\n        if (formArrVal === undefined) return;\r\n        let {arr: arrItems} = itemSchema as ArrSchema;\r\n        for (let row of formArrVal) {\r\n            let {$source} = row;\r\n            if ($source === undefined) continue;\r\n            let {$isSelected, $isDeleted} = $source;\r\n            row.$isSelected = $isSelected;\r\n            row.$isDeleted = $isDeleted;\r\n            //console.log($isSelected, $isDeleted);\r\n            for (let item of arrItems) {\r\n                this.arrItemOperated(item);\r\n            }\r\n        }\r\n    }\r\n\r\n    componentDidMount() {\r\n        let {beforeShow} = this.props;\r\n        if (beforeShow !== undefined) beforeShow(this.formContext);\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        if (this.disposer !== undefined) this.disposer();\r\n    }\r\n\r\n    render() {\r\n        let content = this.renderContent();\r\n        return <ContextContainer.Provider value={this.formContext}>\r\n            {React.createElement(this.formContext.renderErrors)}\r\n            {this.Container(content)}\r\n        </ContextContainer.Provider>;\r\n    }\r\n\r\n    async buttonClick(buttonName:string) {\r\n        this.formContext.checkRules()\r\n        if (this.formContext.hasError === true) return;\r\n\r\n        let {onButtonClick} = this.formContext.form.props;\r\n        if (onButtonClick === undefined) {\r\n            alert(`you should define form onButtonClick`);\r\n            return;\r\n        }\r\n        let ret = await onButtonClick(buttonName, this.formContext);\r\n        if (ret === undefined) return;\r\n        this.formContext.setError(buttonName, ret);\r\n    }\r\n\r\n    protected DefaultContainer = (content:JSX.Element): JSX.Element => {\r\n        return <form className={classNames(this.props.className)} onSubmit={e=>e.preventDefault()}>\r\n            {content}\r\n        </form>;\r\n    }\r\n    protected DefaultFieldContainer = (label:string|JSX.Element, content:JSX.Element): JSX.Element => {\r\n        let {fieldLabelSize, fieldLabelAlign} = this.props;\r\n\r\n        if (fieldLabelSize > 0) {\r\n            let labelView:any;\r\n            if (label === null) {\r\n                fieldLabelSize = 0;\r\n            }\r\n            else {\r\n\t\t\t\tlet cnAlign: string;\r\n\t\t\t\tswitch (fieldLabelAlign) {\r\n\t\t\t\t\tcase 'right': cnAlign = 'text-sm-right'; break;\r\n\t\t\t\t\tcase 'center': cnAlign = 'text-sm-center'; break;\r\n\t\t\t\t}\r\n                labelView = <label className={classNames('col-sm-' + fieldLabelSize, 'col-form-label', cnAlign)}>{label}</label>\r\n            }\r\n            let fieldCol = 'col-sm-' + (12 - fieldLabelSize);\r\n            return <div className=\"form-group row\">\r\n                {labelView}\r\n                <div className={fieldCol}>{content}</div>\r\n            </div>;\r\n        }\r\n        return <div className=\"form-group\">\r\n            {label===null? null:<label className=\"col-form-label\">{label}</label>}\r\n            {content}\r\n        </div>;\r\n    }\r\n    protected DefaultFieldClass:string = undefined;\r\n    protected DefaultButtonClass = 'text-center py-2';\r\n    protected DefaultRes:FormRes = resLang<FormRes>(formRes);\r\n\r\n    ArrContainer = (label:any, content:JSX.Element): JSX.Element => {\r\n        return <div>\r\n            <div className={classNames('small text-muted text-center bg-light py-1 px-3 mt-4 mb-1')}>{label}</div>\r\n            {content}\r\n        </div>;\r\n    }\r\n    RowContainer = (content:JSX.Element): JSX.Element => {\r\n        let cn = classNames({\r\n            'py-3': true\r\n        });\r\n        return <div className={cn}>{content}</div>\r\n    }\r\n    RowSeperator = <div className=\"border border-gray border-top\" />;\r\n}\r\n","import * as React from 'react';\r\nimport { factory } from './widgets';\r\nimport { ContextContainer, Context } from './context';\r\n\r\nexport interface FieldProps {\r\n    name: string;\r\n}\r\n\r\nexport class FormField extends React.Component<FieldProps> {\r\n    static contextType = ContextContainer;\r\n    render() {\r\n        let {name, children } = this.props;\r\n        let context:Context = this.context;\r\n        if (context === undefined) return <span className=\"text-danger\">!only in Form!</span>;\r\n        let itemSchema = context.getItemSchema(name);\r\n        let content = factory(context, itemSchema, children, this.props);\r\n        if (content === undefined) {\r\n            return <span className=\"text-danger\">!!{name} is not defined!!</span>;\r\n        }\r\n        return content;\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport { UiTextItem } from '../schema';\r\nimport { nav } from '../nav';\r\nimport { Page } from '../page/page';\r\nimport { observer } from 'mobx-react';\r\nimport { ItemEdit } from './itemEdit';\r\n\r\nexport interface InputOptions {\r\n\ttype: string;\r\n\tmin?: number;\r\n\tmax?: number;\r\n\tstep?: number;\r\n}\r\n\r\nexport class StringItemEdit extends ItemEdit {\r\n    get uiItem(): UiTextItem {return this._uiItem as UiTextItem}\r\n    protected async internalStart():Promise<any> {\r\n        return new Promise<any>((resolve, reject) => {\r\n            let element = React.createElement(this.page, {resolve, reject});\r\n            nav.push(element,reject);\r\n        });\r\n    }\r\n\r\n    private onChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\r\n        this.newValue = evt.target.value;\r\n        let preValue = this.value;\r\n        this.isChanged = (this.newValue !== preValue);\r\n    }\r\n\r\n    private onBlur = (evt: React.ChangeEvent<HTMLInputElement>) => {\r\n        this.verifyValue();\r\n    }\r\n\r\n    private onFocus = () => {\r\n        this.error = undefined;\r\n\t}\r\n\t\r\n\tprotected inputOptions():InputOptions {\r\n\t\treturn {\r\n\t\t\ttype: 'text',\r\n\t\t}\r\n\t}\r\n\r\n    private page = observer((props:{resolve:(value:any)=>void, reject: (resean?:any)=>void}):JSX.Element => {\r\n\t\tlet {resolve} = props;\r\n\t\tlet onSave = () => {\r\n\t\t\tthis.verifyValue();\r\n\t\t\tif (this.error === undefined) {\r\n\t\t\t\tlet val = this.newValue;\r\n\t\t\t\tresolve(val);\t\t\t\t\r\n\t\t\t}\r\n\t\t}\r\n        let right = <button\r\n            className=\"btn btn-sm btn-success align-self-center mr-2\"\r\n            disabled={!this.isChanged}\r\n            onClick={onSave}>保存</button>;\r\n\t\tlet onKeyDown = (evt: React.KeyboardEvent<HTMLInputElement>) => {\r\n\t\t\tif (evt.keyCode === 13) onSave();\r\n\t\t}\r\n\t\tlet {type, max, min, step} = this.inputOptions();\r\n        return <Page header={this.label} right={right}>\r\n            <div className=\"m-3\">\r\n\t\t\t\t<input type={type}\r\n\t\t\t\t\tonChange={this.onChange}\r\n\t\t\t\t\tonKeyDown={onKeyDown}\r\n                    onBlur={this.onBlur}\r\n                    onFocus={this.onFocus}\r\n                    className=\"form-control\" \r\n                    defaultValue={this.value} min={min} max={max} step={step} />\r\n                {\r\n                    this.uiItem && <div className=\"small muted m-2\">{this.uiItem.placeholder}</div>\r\n                }\r\n                {this.error && <div className=\"text-danger\">{this.error}</div>}\r\n            </div>\r\n        </Page>;\r\n    })\r\n}\r\n","import * as React from 'react';\r\nimport { UiRadio } from '../schema';\r\nimport { nav } from '../nav';\r\nimport { Page } from '../page/page';\r\nimport { observer } from 'mobx-react';\r\nimport { ItemEdit } from './itemEdit';\r\n\r\nexport class RadioItemEdit extends ItemEdit {\r\n    get uiItem(): UiRadio {return this._uiItem as UiRadio}\r\n\r\n\tinit() {\r\n        if (this.value === undefined) {\r\n            this.value = this._uiItem===undefined? undefined : this._uiItem.defaultValue;\r\n        }\r\n\t}\r\n\r\n    protected async internalStart():Promise<any> {\r\n        return new Promise<any>((resolve, reject) => {\r\n            let element = React.createElement(this.page, {resolve:resolve, reject:reject});\r\n            nav.push(element,reject);\r\n        });\r\n    }\r\n\r\n    private onChange = (value: any) => {\r\n        this.newValue = value;\r\n        let preValue = this.value;\r\n        this.isChanged = (this.newValue !== preValue);\r\n    }\r\n\r\n    private page = observer((props:{resolve:(value:any)=>void, reject: (resean?:any)=>void}):JSX.Element => {\r\n        let {resolve} = props;\r\n        let {name} = this.itemSchema;\r\n        let {list} = this.uiItem;\r\n        let right = <button\r\n            className=\"btn btn-sm btn-success align-self-center\"\r\n            disabled={!this.isChanged}\r\n            onClick={()=>{\r\n                this.verifyValue();\r\n                if (this.error === undefined) resolve(this.newValue);\r\n            }}>保存</button>;\r\n        let content = list?\r\n            list.map((v, index:number) => {\r\n                let {title, value} = v;\r\n                return <div key={index} className=\"col\"><label className=\"px-3 py-2 cursor-pointer\">\r\n                    <input name={name} type=\"radio\" value={value} \r\n                        onClick={()=>this.onChange(value)} \r\n                        defaultChecked={value === this.value} /> {title || value} &nbsp;\r\n                </label></div>;\r\n            })\r\n            :\r\n            <>no list defined</>;\r\n        return <Page header={'更改' + this.label} right={right}>\r\n            <div className=\"m-3\">\r\n\t\t\t\t<div className=\"row row-cols-2 row-cols-sm-3 row-cols-md-4\">{content}</div>\r\n\t\t\t</div>\r\n        </Page>;\r\n    })\r\n}\r\n","import * as React from 'react';\r\nimport { UiSelect } from '../schema';\r\nimport { nav } from '../nav';\r\nimport { Page } from '../page/page';\r\nimport { observer } from 'mobx-react';\r\nimport { ItemEdit } from './itemEdit';\r\n\r\nexport class SelectItemEdit extends ItemEdit {\r\n    get uiItem(): UiSelect {return this._uiItem as UiSelect}\r\n    protected async internalStart():Promise<any> {\r\n        return new Promise<any>((resolve, reject) => {\r\n            let element = React.createElement(this.page, {resolve:resolve, reject:reject});\r\n            nav.push(element,reject);\r\n        });\r\n    }\r\n\r\n    private onChange = (value:any) => {\r\n        this.newValue = value;\r\n        let preValue = this.value;\r\n        this.isChanged = (this.newValue !== preValue);\r\n    }\r\n\r\n    private page = observer((props:{resolve:(value:any)=>void, reject: (resean?:any)=>void}):JSX.Element => {\r\n        let {resolve} = props;\r\n        let {list} = this.uiItem;\r\n        let content = list?\r\n            list.map((v, index:number) => {\r\n                let {title, value} = v;\r\n                return <div key={index} className=\"px-3 py-2 cursor-pointer bg-white mb-1\" onClick={()=>{this.onChange(value); resolve(this.newValue)}}>\r\n                    {title || value}\r\n                </div>;\r\n            })\r\n            :\r\n            <>no list defined</>;\r\n        return <Page header={'更改' + this.label}>\r\n            <div className=\"my-3\">\r\n                {content}\r\n            </div>\r\n        </Page>;\r\n    })\r\n}\r\n","import * as React from 'react';\r\nimport { UiIdItem } from '../schema';\r\nimport { Page } from '../page/page';\r\nimport { observer } from 'mobx-react';\r\nimport { ItemEdit } from './itemEdit';\r\n\r\nexport class IdItemEdit extends ItemEdit {\r\n    get uiItem(): UiIdItem {return this._uiItem as UiIdItem}\r\n    protected async internalStart():Promise<any> {\r\n        return new Promise<any>(async (resolve, reject) => {\r\n            //let element = React.createElement(this.page, {resolve:resolve, reject:reject});\r\n            //nav.push(element,reject);\r\n\r\n            let {pickId} = this.uiItem;\r\n            if (pickId === undefined) {\r\n                alert('IdItemEdit.pickId = undefined');\r\n                return;\r\n            }\r\n            let boxId = await pickId(undefined, undefined, this.value);\r\n            //if (typeof id === 'object') {\r\n            //    id = (id as any).id;\r\n            //}\r\n            this.onChange(boxId.id);\r\n            resolve(boxId);\r\n            //this.newValue = id;\r\n        });\r\n    }\r\n\r\n    protected async internalEnd():Promise<void> {}\r\n\r\n    private onChange = (value:any) => {\r\n        this.newValue = value;\r\n        let preValue = this.value;\r\n        this.isChanged = (this.newValue !== preValue);\r\n    }\r\n\r\n    private page = observer((props:{resolve:(value:any)=>void, reject: (resean?:any)=>void}):JSX.Element => {\r\n        /*\r\n        let {resolve, reject} = props;\r\n        let {list} = this.uiItem;\r\n        let content = list?\r\n            list.map((v, index:number) => {\r\n                let {title, value} = v;\r\n                return <div key={index} className=\"px-3 py-2 cursor-pointer bg-white mb-1\" onClick={()=>{this.onChange(value); resolve(this.newValue)}}>\r\n                    {title || value}\r\n                </div>;\r\n            })\r\n            :\r\n            <>no list defined</>;\r\n        return <Page header={'更改' + this.label}>\r\n            <div className=\"my-3\">\r\n                {content}\r\n            </div>\r\n        </Page>;\r\n        */\r\n        return <Page header={'更改' + this.label}>\r\n            ddd\r\n        </Page>\r\n    })\r\n}\r\n","import * as React from 'react';\r\nimport { UiTag } from '../schema';\r\nimport { nav } from '../nav';\r\nimport { Page } from '../page/page';\r\nimport { observer } from 'mobx-react';\r\nimport { ItemEdit } from './itemEdit';\r\n\r\nabstract class TagItemEdit extends ItemEdit {\r\n\tprotected inputs: {[index:number]: HTMLInputElement} = {};\r\n\tprotected inputType: 'checkbox' | 'radio';\r\n    get uiItem(): UiTag {return this._uiItem as UiTag};\r\n\r\n\tinit() {\r\n        if (this.value === undefined) {\r\n            this.value = this._uiItem===undefined? undefined : this._uiItem.defaultValue;\r\n        }\r\n\t}\r\n\r\n    protected async internalStart():Promise<any> {\r\n        return new Promise<any>((resolve, reject) => {\r\n            let element = React.createElement(this.page, {resolve:resolve, reject:reject});\r\n            nav.push(element,reject);\r\n        });\r\n\t}\r\n\t\r\n\trenderContent() {\r\n\t\tlet valuesView = this.uiItem.valuesView;\r\n\t\tif (valuesView === undefined) return super.renderContent();\r\n\t\treturn valuesView.render(this.value);\r\n\t}\r\n\r\n\tprotected abstract renderInputs():JSX.Element;\r\n    private page = observer((props:{resolve:(value:any)=>void, reject: (resean?:any)=>void}):JSX.Element => {\r\n        let {resolve} = props;\r\n        let right = <button\r\n            className=\"btn btn-sm btn-success align-self-center\"\r\n            disabled={!this.isChanged}\r\n            onClick={()=>{\r\n                this.verifyValue();\r\n                if (this.error === undefined) resolve(this.newValue);\r\n\t\t\t}}>保存</button>;\r\n\t\t/*\r\n        let content = list?\r\n            list.map((v, index:number) => {\r\n                let {name:itemName, id} = v;\r\n                return <div key={index} className=\"col\"><label className=\"px-3 py-2 cursor-pointer\">\r\n                    <input ref={input=>this.inputs[id] = input} name={name} type={this.inputType} value={id} \r\n\t\t\t\t\t\tonClick={(e)=>this.onChange(e.currentTarget.checked, id)}\r\n                        defaultChecked={this.defaultChecked(id)} /> {itemName} &nbsp;\r\n                </label></div>;\r\n            })\r\n            :\r\n\t\t\t<>no list defined</>;\r\n\t\t*/\r\n        return <Page header={'更改' + this.label} right={right}>\r\n\t\t\t<div className=\"p-3\">\r\n\t\t\t\t{this.renderInputs()}\r\n\t\t\t</div>\r\n        </Page>;\r\n    })\r\n}\r\n\r\nexport class TagSingleItemEdit extends TagItemEdit {\r\n\tprotected inputType:'radio'|'checkbox' = 'radio';\r\n    protected onInputChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\r\n\t\tlet {currentTarget} = evt;\r\n\t\tif (currentTarget.checked === false) return;\r\n        this.newValue = Number(currentTarget.value);\r\n        let preValue = this.value;\r\n        this.isChanged = (this.newValue !== preValue);\r\n\t}\r\n\t\r\n\tprotected renderInputs():JSX.Element {\r\n\t\tlet {valuesView} = this.uiItem;\r\n\t\tlet options = {\r\n\t\t\tinputs: this.inputs,\r\n\t\t\tonInputChange: this.onInputChange,\r\n\t\t};\r\n\t\treturn valuesView.renderRadios(this.value, options);\r\n\t}\r\n}\r\n\r\nexport class TagMultiItemEdit extends TagItemEdit {\r\n\t//private arr:number[];\r\n\tprotected inputType:'radio'|'checkbox' = 'checkbox';\r\n\r\n\tprivate onInputChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\r\n\t\tlet values:string[] = [];\r\n\t\tfor (let i in this.inputs) {\r\n\t\t\tlet input = this.inputs[i];\r\n\t\t\tif (input.checked === true) values.push(input.value);\r\n\t\t}\r\n        this.newValue = values.join('|');\r\n        //this.newValue = value;\r\n        let preValue = this.value;\r\n        this.isChanged = (this.newValue !== preValue);\r\n\t}\r\n\tprotected renderInputs():JSX.Element {\r\n\t\tlet {valuesView} = this.uiItem;\r\n\t\tlet options = {\r\n\t\t\tinputs: this.inputs,\r\n\t\t\tonInputChange: this.onInputChange\r\n\t\t};\r\n\t\treturn valuesView.renderChecks(this.value, options);\r\n\t}\r\n}\r\n","import * as React from 'react';\r\nimport { UiTextItem } from '../schema';\r\nimport { nav } from '../nav';\r\nimport { Page } from '../page/page';\r\nimport { observer } from 'mobx-react';\r\nimport { ItemEdit } from './itemEdit';\r\n\r\nexport class TextAreaItemEdit extends ItemEdit {\r\n    get uiItem(): UiTextItem {return this._uiItem as UiTextItem}\r\n    protected async internalStart():Promise<any> {\r\n        return new Promise<any>((resolve, reject) => {\r\n            let element = React.createElement(this.page, {resolve, reject});\r\n            nav.push(element,reject);\r\n        });\r\n    }\r\n\r\n    private onChange = (evt: React.ChangeEvent<HTMLTextAreaElement>) => {\r\n        this.newValue = evt.target.value;\r\n        let preValue = this.value;\r\n        this.isChanged = (this.newValue !== preValue);\r\n    }\r\n\r\n    private onBlur = (evt: React.ChangeEvent<HTMLTextAreaElement>) => {\r\n        this.verifyValue();\r\n    }\r\n\r\n    private onFocus = () => {\r\n        this.error = undefined;\r\n    }\r\n\r\n    private page = observer((props:{resolve:(value:any)=>void, reject: (resean?:any)=>void}):JSX.Element => {\r\n\t\tlet {resolve} = props;\r\n\t\tlet onSave = () => {\r\n\t\t\tthis.verifyValue();\r\n\t\t\tif (this.error === undefined) {\r\n\t\t\t\tlet val = this.newValue;\r\n\t\t\t\tresolve(val);\t\t\t\t\r\n\t\t\t}\r\n\t\t}\r\n        let right = <button\r\n            className=\"btn btn-sm btn-success align-self-center mr-2\"\r\n            disabled={!this.isChanged}\r\n            onClick={onSave}>保存</button>;\r\n\t\tlet onKeyDown = (evt: React.KeyboardEvent<HTMLTextAreaElement>) => {\r\n\t\t\t// if (evt.keyCode === 13) onSave();\r\n\t\t}\r\n        return <Page header={this.label} right={right}>\r\n            <div className=\"m-3\">\r\n                <textarea\r\n\t\t\t\t\tonChange={this.onChange}\r\n\t\t\t\t\tonKeyDown={onKeyDown}\r\n                    onBlur={this.onBlur}\r\n                    onFocus={this.onFocus}\r\n                    className=\"form-control\" \r\n\t\t\t\t\tdefaultValue={this.value}\r\n\t\t\t\t\trows={6} />\r\n                {\r\n                    this.uiItem && <div className=\"small muted m-2\">{this.uiItem.placeholder}</div>\r\n                }\r\n                {this.error && <div className=\"text-danger\">{this.error}</div>}\r\n            </div>\r\n        </Page>;\r\n    })\r\n}\r\n","import React from 'react';\r\nimport { UiCheckItem } from '../schema';\r\nimport { ItemEdit } from './itemEdit';\r\n\r\nexport class CheckBoxItemEdit extends ItemEdit {\r\n\tprivate input: HTMLInputElement;\r\n    get uiItem(): UiCheckItem {return this._uiItem as UiCheckItem}\r\n\tget editInRow(): boolean {return true;}\r\n    protected async internalStart():Promise<any> {\r\n\t\tif (!this.input) return;\r\n\t\tlet uiItem = this.uiItem;\r\n\t\tif (uiItem === undefined) return this.input.checked;\r\n\t\tlet {checked} = this.input;\r\n\t\treturn this.getValue(checked);\r\n    }\r\n\tasync end():Promise<any> {}\r\n\trenderContent() {\r\n\t\tlet {readOnly} = this.uiItem;\r\n\t\tlet disabled = readOnly === true;\r\n\t\tlet onChange:any;\r\n\t\tif (readOnly !== true) onChange = this.onChange;\r\n\t\treturn <input ref={r => this.input=r} type=\"checkbox\" \r\n\t\t\tdefaultChecked={this.value} disabled={disabled}\r\n\t\t\tonChange={onChange} />\r\n\t}\r\n\r\n\tprivate getValue(checked: boolean) {\r\n\t\tlet {trueValue, falseValue} = this.uiItem;\r\n        return checked === true? (trueValue??true) : (falseValue??false);\r\n\t}\r\n\r\n    private onChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\r\n        this.newValue = this.getValue(evt.target.checked);\r\n        let preValue = this.value;\r\n\t\tthis.isChanged = (this.newValue !== preValue);\r\n\t\tthis.edit.onItemChanged(this, this.newValue);\r\n    }\r\n}\r\n","import { UiRange } from \"../schema\";\r\nimport { InputOptions, StringItemEdit } from \"./stringItemEdit\";\r\n\r\nexport class RangeItemEdit extends StringItemEdit {\r\n\tprotected inputOptions():InputOptions {\r\n\t\tlet min:number, max:number, step:number;\r\n\t\tif (this._uiItem) {\r\n\t\t\tmin = (this._uiItem as UiRange).min\r\n\t\t\tmax = (this._uiItem as UiRange).max\r\n\t\t\tstep = (this._uiItem as UiRange).step\r\n\t\t}\r\n\t\treturn {\r\n\t\t\ttype: 'range',\r\n\t\t\tmin, max, step\r\n\t\t}\r\n\t}\r\n}\r\n","import { UiNumberItem } from \"../schema\";\r\nimport { InputOptions, StringItemEdit } from \"./stringItemEdit\";\r\n\r\nexport class NumberItemEdit extends StringItemEdit {\r\n\tprotected inputOptions():InputOptions {\r\n\t\tlet min:number, max:number, step:number;\r\n\t\tif (this._uiItem) {\r\n\t\t\tmin = (this._uiItem as UiNumberItem).min\r\n\t\t\tmax = (this._uiItem as UiNumberItem).max\r\n\t\t\tstep = (this._uiItem as UiNumberItem).step\r\n\t\t}\r\n\t\treturn {\r\n\t\t\ttype: 'number',\r\n\t\t\tmin, max, step\r\n\t\t}\r\n\t}\r\n}\r\n","import * as React from 'react';\r\n//import _ from 'lodash';\r\nimport { observer } from 'mobx-react';\r\nimport { Schema, UiSchema, ItemSchema, UiItem, UiRadio, UiTagSingle, UiTagMulti } from '../schema';\r\nimport { ItemEdit } from './itemEdit';\r\nimport { StringItemEdit } from './stringItemEdit';\r\nimport { ImageItemEdit } from './imageItemEdit';\r\nimport { RadioItemEdit } from './radioItemEdit';\r\nimport { SelectItemEdit } from './selectItemEdit';\r\nimport { IdItemEdit } from './idItemEdit';\r\nimport { TagSingleItemEdit, TagMultiItemEdit } from './tagItemEdit';\r\nimport { TextAreaItemEdit } from './textAreaItemEdit';\r\nimport { CheckBoxItemEdit } from './checkBoxItemEdit';\r\nimport { RangeItemEdit } from './rangeItemEdit';\r\nimport { NumberItemEdit } from './numberItemEdit';\r\n\r\nexport interface EditProps {\r\n    className?: string;\r\n    schema: Schema;\r\n    data: any;\r\n    onItemClick?: (itemSchema: ItemSchema, uiItem: UiItem, value: any) => Promise<void>;\r\n    onItemChanged?: (itemSchema: ItemSchema, newValue:any, preValue:any) => Promise<void>;\r\n    stopEdit?: boolean;\r\n    uiSchema?: UiSchema;\r\n    sepClassName?: string;\r\n    topBorderClassName?: string;\r\n    bottomBorderClassName?: string;\r\n    rowContainerClassName?: string;\r\n}\r\n\r\n@observer\r\nexport class Edit extends React.Component<EditProps> {\r\n    private defaultSepClassName = 'border-top edit-sep-light-gray';\r\n    private defaultRowContainerClassName = 'd-flex px-3 py-2 bg-white align-items-center';\r\n    private topBorder:JSX.Element;\r\n    private bottomBorder:JSX.Element;\r\n    private rowContainerClassName?: string;\r\n    private sep:JSX.Element;\r\n\tprivate uiSchema: {[name:string]: UiItem};\r\n\r\n    constructor(props: EditProps) {\r\n        super(props);\r\n        let {topBorderClassName, bottomBorderClassName, sepClassName, rowContainerClassName, uiSchema} = props;\r\n        this.topBorder = <div className={topBorderClassName || this.defaultSepClassName} />;\r\n        this.bottomBorder = <div className={bottomBorderClassName || this.defaultSepClassName} />;\r\n        this.rowContainerClassName = rowContainerClassName || this.defaultRowContainerClassName;\r\n        //if (stopEdit !== true) this.rowContainerClassName += ' cursor-pointer';\r\n        this.sep = <div className={sepClassName || this.defaultSepClassName} />;\r\n\t\tthis.uiSchema = (uiSchema && uiSchema.items) || {};\r\n    }\r\n\r\n    render() {\r\n        let {schema} = this.props;\r\n\t\tlet sep:any;\r\n        return <div>\r\n\t\t\t{this.topBorder}\r\n            {schema.map((itemSchema, index) => {\r\n\t\t\t\tlet {stopEdit} = this.props;\r\n\t\t\t\tlet {name} = itemSchema;\r\n\t\t\t\tlet uiItem = this.uiSchema===undefined? undefined : this.uiSchema[name];\r\n\t\t\t\tlet label:string|JSX.Element, labelHide:any;\r\n\t\t\t\tif (uiItem !== undefined) {\r\n\t\t\t\t\tlabel = uiItem.label || name;\r\n\t\t\t\t\tlabelHide = uiItem.labelHide;\r\n\t\t\t\t};\r\n\t\t\t\tlet value = this.props.data[name];\r\n\t\t\t\tlet itemEdit = createItemEdit(this, itemSchema, uiItem, label, value);\r\n\t\t\t\tlet rowContainerClassName = this.rowContainerClassName;\r\n\t\t\t\tlet {editInRow} = itemEdit;\r\n\t\t\t\tif (editInRow === false) {\r\n\t\t\t\t\tif (stopEdit !== true) editInRow = false;\r\n\t\t\t\t}\r\n\t\t\t\tif (editInRow === false) rowContainerClassName += ' cursor-pointer';\r\n\r\n\t\t\t\tlet {required} = itemSchema;\r\n\t\t\t\tlet requireFlag = required===true && <span className=\"text-danger\">*</span>;\r\n\t\t\t\tlet divLabel:any, cn:string = 'flex-fill d-flex ';\r\n\t\t\t\tif (labelHide === true) {\r\n\t\t\t\t\tdivLabel = undefined;\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tdivLabel = <div>{label} {requireFlag}</div>;\r\n\t\t\t\t\tcn += 'justify-content-end';\r\n\t\t\t\t}\r\n\t\t\t\tlet ret = <React.Fragment key={index}>\r\n\t\t\t\t\t{sep}\r\n\t\t\t\t\t<div className={'d-flex align-items-center' + rowContainerClassName} \r\n\t\t\t\t\t\tonClick={async ()=>await this.rowClick(itemEdit)}>\r\n\t\t\t\t\t\t{divLabel}\r\n\t\t\t\t\t\t<div className={cn}>{\r\n\t\t\t\t\t\t\titemEdit===undefined? undefined: itemEdit.renderContent()\r\n\t\t\t\t\t\t}</div>\r\n\t\t\t\t\t\t{editInRow === false && <div className=\"w-2c text-right\"><i className=\"fa fa-angle-right\" /></div>}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</React.Fragment>;\r\n\t\t\t\tsep = this.sep;\r\n\t\t\t\treturn ret;\r\n\t\t\t})}\r\n\t\t\t{this.bottomBorder}\r\n\t\t</div>;\r\n    }\r\n\r\n\tasync onItemChanged(itemEdit:ItemEdit, newValue:any) {\r\n\t\tlet {itemSchema, uiItem, value} = itemEdit;\r\n\t\tthis.props.data[itemSchema.name] = newValue;\r\n        let {onItemChanged, stopEdit} = this.props;\r\n\t\tif (stopEdit === true) return;\r\n\t\tif (uiItem?.readOnly === true) return;\r\n\t\tif (onItemChanged === undefined) {\r\n\t\t\talert(`${itemSchema.name} value changed, new: ${newValue}, pre: ${value}`);\r\n\t\t\t// 2020-04-15：改值之后，应该赋值吧。所以这一句移到前面去\r\n\t\t\t//this.props.data[itemSchema.name] = changeValue;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tawait onItemChanged(itemSchema, newValue, value);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate rowClick = async (itemEdit:ItemEdit) => {\r\n\t\tif (itemEdit === undefined) {\r\n\t\t\talert('item has no edit');\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tlet {itemSchema, uiItem, value, editInRow} = itemEdit;\r\n\t\tif (editInRow === true) return;\r\n        let {onItemChanged, onItemClick, stopEdit} = this.props;\r\n\t\tif (stopEdit === true) return;\r\n\t\tif (uiItem?.readOnly === true) return;\r\n        let changeValue:any;\r\n        if (onItemClick !== undefined) {\r\n            await onItemClick(itemSchema, uiItem, value);\r\n            return;\r\n        }\r\n        //let itemEdit:ItemEdit = createItemEdit(itemSchema, uiItem, label, value);\r\n        if (itemEdit === undefined) {\r\n            alert('undefined: let itemEdit:ItemEdit = createItemEdit(itemSchema, uiItem, label, value);');\r\n            return;\r\n        }\r\n        try {\r\n            changeValue = await itemEdit.start();\r\n            if (changeValue !== value) {\r\n\t\t\t\t// 2020-04-15：改值之后，应该赋值吧。所以移到这里来\r\n\t\t\t\tthis.props.data[itemSchema.name] = changeValue;\r\n                if (onItemChanged === undefined) {\r\n                    alert(`${itemSchema.name} value changed, new: ${changeValue}, pre: ${value}`);\r\n\t\t\t\t\t// 2020-04-15：改值之后，应该赋值吧。所以这一句移到前面去\r\n                    //this.props.data[itemSchema.name] = changeValue;\r\n                }\r\n                else {\r\n                    await onItemChanged(itemSchema, changeValue, value);\r\n                }\r\n            }\r\n            await itemEdit.end();\r\n        }\r\n        catch (err) {\r\n            // 如果直接back，会触发reject，就到这里了\r\n\t\t\tconsole.log('no value changed');\r\n\t\t\tconsole.error(err);\r\n        }\r\n    }\r\n}\r\n\r\ntype NewItemEdit = new (edit: Edit, itemSchema: ItemSchema, uiItem:UiItem, label:string|JSX.Element, value: any) => ItemEdit;\r\n\r\nfunction createItemEdit(edit: Edit, itemSchema: ItemSchema, uiItem:UiItem, label:string|JSX.Element, value: any):ItemEdit {\r\n\tlet ie: ItemEdit;\r\n    let itemEdit: NewItemEdit;\r\n    if (uiItem !== undefined) {\r\n        switch (uiItem.widget) {\r\n            default: break;\r\n            case 'id': itemEdit = IdItemEdit; break;\r\n\t\t\tcase 'text': itemEdit = StringItemEdit; break;\r\n\t\t\tcase 'textarea': itemEdit = TextAreaItemEdit; break;\r\n            case 'image': itemEdit = ImageItemEdit; break;\r\n\t\t\tcase 'select': itemEdit = SelectItemEdit; break;\r\n\t\t\tcase 'range': itemEdit = RangeItemEdit; break;\r\n\t\t\tcase 'number':\r\n\t\t\tcase 'updown': itemEdit = NumberItemEdit; break;\r\n\t\t\tcase 'checkbox': itemEdit = CheckBoxItemEdit; break;\r\n            case 'radio': \r\n\t\t\t\tie = new RadioItemEdit(edit, itemSchema, uiItem as UiRadio, label, value);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'tagSingle':\r\n\t\t\t\tie = new TagSingleItemEdit(edit, itemSchema, uiItem as UiTagSingle, label, value);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'tagMulti':\r\n\t\t\t\tie = new TagMultiItemEdit(edit, itemSchema, uiItem as UiTagMulti, label, value);\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t}\r\n\tif (ie === undefined) {\r\n\t\tif (itemEdit === undefined) {\r\n\t\t\tswitch (itemSchema.type) {\r\n\t\t\t\tcase 'string': itemEdit = StringItemEdit; break;\r\n\t\t\t\tcase 'image': itemEdit = ImageItemEdit; break;\r\n\t\t\t\tcase 'boolean': itemEdit = CheckBoxItemEdit; break;\r\n\t\t\t\tcase 'number':\r\n\t\t\t\tcase 'integer': itemEdit = RangeItemEdit; break;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (itemEdit === undefined) return;\r\n\t\tie = new itemEdit(edit, itemSchema, uiItem, label, value);\r\n\t}\r\n\tie.init();\r\n\treturn ie;\r\n}\r\n","import { ID, IDX, Uq } from \"tonva-react\";\r\nimport { IDBase } from \"../base\";\r\nimport { MidIDListBase } from \"../list\";\r\n\r\nexport class MidIDXList<T extends IDBase> extends MidIDListBase<T> {\r\n\treadonly ID:ID;\r\n\treadonly IDX: IDX;\r\n\tconstructor(uq:Uq, ID:ID, IDX:IDX) {\r\n\t\tsuper(uq, undefined);\r\n\t\tthis.ID = ID;\r\n\t\tthis.IDX = IDX;\r\n\t}\r\n\r\n\tasync init() {\r\n\t\tawait Promise.all([\r\n\t\t\tthis.ID.loadSchema(),\r\n\t\t\tthis.IDX.loadSchema(),\r\n\t\t]);\r\n\t}\r\n\r\n\tprotected async loadPageItems(pageStart:any, pageSize:number):Promise<T[]> {\r\n\t\tlet ret = await this.uq.ID<T>({\r\n\t\t\tIDX: this.ID,\r\n\t\t\tid: undefined,\r\n\t\t\tpage: {start:pageStart, size:pageSize},\r\n\t\t});\r\n\t\treturn ret;\r\n\t}\r\n}\r\n","import { zh } from \"./zh\";\r\nimport { en } from \"./en\";\r\n\r\nexport const res = {\r\n\t$zh: zh,\r\n\t$en: en,\r\n}\r\n","export const zh = {\r\n\tday: '日',\r\n\tweek: '周',\r\n\tmonth: '月',\r\n\tyear: '年',\r\n}","export const en = {\r\n\tday: 'Day',\r\n\tweek: 'Week',\r\n\tmonth: 'Month',\r\n\tyear: 'Year',\r\n}\r\n","import { makeObservable, observable } from \"mobx\";\r\nimport { observer } from \"mobx-react\";\r\nimport { FA, left0, LMR, NumberProp, StringProp, VPage } from \"tonva-react\";\r\nimport { CIDX } from \"./CIDX\";\r\n\r\nexport class VEdit extends VPage<CIDX> {\r\n\theader() {return 'Edit'}\r\n\tcontent() {\r\n\t\tlet {midIDX} = this.controller;\r\n\t\tlet {props} = midIDX;\r\n\t\treturn <div className=\"py-3\">\r\n\t\t\t{props.map((v, index) => {\r\n\t\t\t\tlet {type} = v as any;\r\n\t\t\t\tswitch (type) {\r\n\t\t\t\t\tdefault: return null;\r\n\t\t\t\t\tcase 'string': \r\n\t\t\t\t\t\treturn this.renderStringProp(v as StringProp);\r\n\t\t\t\t\tcase 'integer':\r\n\t\t\t\t\tcase 'number': \r\n\t\t\t\t\t\treturn this.renderNumberProp(v as NumberProp);\r\n\t\t\t\t}\r\n\t\t\t})}\r\n\t\t</div>\r\n\t}\r\n\r\n\tprivate renderStringProp(prop:StringProp) {\r\n\t\treturn <div key={prop.name} className=\"px-3 py-2 bg-white mb-1 cursor-pointer\">\r\n\t\t\t{JSON.stringify(prop)}\r\n\t\t</div>;\r\n\t}\r\n\r\n\tprivate renderNumberProp(prop: NumberProp) {\r\n\t\tlet V = observer(() => {\r\n\t\t\tlet {name} = prop;\r\n\t\t\tlet {spanValues} = this.controller;\r\n\t\t\tif (!spanValues) return null;\r\n\t\t\treturn <div key={name} className=\"px-3 py-2 bg-white mb-1 cursor-pointer\" \r\n\t\t\t\tonClick={()=>this.openVPage(VEditNumberField, prop)}>\r\n\t\t\t\t<LMR left={<b>{prop.label}</b>} \r\n\t\t\t\t\tright={<FA name=\"pencil-square-o\" className=\"align-self-center\" />}>\r\n\t\t\t\t\t<div className=\"mr-5 text-right\">{this.controller.spanValues[name]}</div>\r\n\t\t\t\t</LMR>\r\n\t\t\t</div>;\r\n\t\t});\r\n\t\treturn <V />;\r\n\t}\r\n}\r\n\r\nclass VEditNumberField extends VPage<CIDX> {\r\n\tprivate prop: NumberProp;\r\n\tprivate date: Date;\r\n\tprivate value: number;\r\n\tprivate dateInput: HTMLInputElement;\r\n\tprivate timeInput: HTMLInputElement;\r\n\tdisabled: boolean = true;\r\n\tconstructor(controller: CIDX) {\r\n\t\tsuper(controller);\r\n\t\tmakeObservable(this, {\r\n\t\t\tdisabled: observable\r\n\t\t});\r\n\t}\r\n\tinit(prop: NumberProp) {\r\n\t\tthis.prop = prop;\r\n\t\tthis.date = new Date();\r\n\t}\r\n\theader() {return this.prop.label}\r\n\tright() {\r\n\t\tlet V = observer(() => <button \r\n\t\t\tclassName=\"btn btn-sm btn-success mr-2\" \r\n\t\t\tdisabled={this.disabled}\r\n\t\t\tonClick={this.onSave}>\r\n\t\t\t{this.t('submit')}\r\n\t\t</button>);\r\n\t\treturn <V />;\r\n\t}\r\n\tcontent() {\r\n\t\tlet {time} = this.prop;\r\n\t\tlet year = this.date.getFullYear();\r\n\t\tlet month = this.date.getMonth() + 1;\r\n\t\tlet day = this.date.getDate();\r\n\t\tlet hour = this.date.getHours();\r\n\t\tlet minute = this.date.getMinutes();\r\n\t\tlet defDate = `${year}-${left0(month, 2)}-${left0(day, 2)}`;\r\n\t\tlet vDateTime:any;\r\n\t\tif (time === true) {\r\n\t\t\tvDateTime = <div className=\"input-group mb-3\">\r\n\t\t\t\t<span className=\"w-8c input-group-text\">{this.t('date')}</span>\r\n\t\t\t\t<input ref={d => this.dateInput=d} type=\"date\" \r\n\t\t\t\t\tclassName=\"form-control\" defaultValue={defDate} />\r\n\t\t\t\t<input ref={t => this.timeInput=t} type=\"time\" className=\"form-control\" \r\n\t\t\t\t\tdefaultValue={`${left0(hour, 2)}:${left0(minute, 2)}`} />\r\n\t\t\t</div>;\r\n\t\t}\r\n\t\treturn <div className=\"p-3\">\r\n\t\t\t{vDateTime}\r\n\t\t\t<div className=\"input-group\">\r\n\t\t\t\t<span className=\"w-8c input-group-text\">{this.t('value')}</span>\r\n\t\t\t\t<input type=\"number\" className=\"form-control\" \r\n\t\t\t\t\tonChange={this.onValueChange} />\r\n\t\t\t</div>\r\n\t\t</div>;\r\n\t}\r\n\r\n\tprivate onValueChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\r\n\t\tlet v = evt.currentTarget.value.trim();\r\n\t\tthis.disabled = v.length === 0;\r\n\t\tlet n = Number(v);\r\n\t\tif (Number.isNaN(n) === false) this.value = n;\r\n\t}\r\n\r\n\tprivate onSave = async () => {\r\n\t\tlet t: number;\r\n\t\tif (this.dateInput) {\r\n\t\t\tlet date = this.dateInput.valueAsDate;\r\n\t\t\tlet dateTicks = this.dateInput?.valueAsNumber;\r\n\t\t\tlet timeTicks = this.timeInput?.valueAsNumber;\r\n\t\t\tt = dateTicks + timeTicks + date.getTimezoneOffset()*60*1000;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tt = Date.now();\r\n\t\t}\r\n\t\tawait this.controller.saveFieldValue(this.prop.name, t, this.value);\r\n\t\tthis.closePage();\r\n\t}\r\n}\r\n","// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\nimport { VPage, List, LMR, EasyTime, UserView, User } from \"tonva-react\";\r\nimport { CIDX } from \"./CIDX\";\r\n\r\nexport class VHistory extends VPage<CIDX> {\r\n\theader() {return this.controller.field}\r\n\tcontent() {\r\n\t\treturn <div>\r\n\t\t\t<List items={this.controller.historyItems} item={{render: this.renderItem, key:(item)=>item.t}} />\r\n\t\t</div>\r\n\t}\r\n\r\n\tprivate renderItem = (item:any, index:number) => {\r\n\t\tlet {t, v, u} = item;\r\n\t\tlet left = <div className=\"w-12c\"><EasyTime date={new Date(t)} /></div>;\r\n\t\tlet renderUser = (user:User) => {\r\n\t\t\tlet {name, nick} = user;\r\n\t\t\treturn <small className=\"text-muted\">{nick || name}</small>\r\n\t\t}\r\n\t\tlet right = <UserView user={u} render={renderUser} />;\r\n\t\treturn <div className=\"px-3 py-2\">\t\t\t\r\n\t\t\t<LMR className=\"w-100\" left={left} right={right}>{v}</LMR>\r\n\t\t</div>\r\n\t}\r\n}\r\n","import { makeObservable, observable, runInAction, toJS } from \"mobx\";\r\nimport { observer } from \"mobx-react\";\r\nimport { CSSProperties } from \"react\";\r\nimport { Bar } from \"react-chartjs-2\";\r\nimport { FA, LMR, NumberProp, Prop, VPage } from \"tonva-react\";\r\nimport { CIDX } from \"./CIDX\";\r\n\r\nconst spans = ['week', 'month'];\r\n\r\nconst graphOptions = {\r\n\ttitle: {\r\n\t\tdisplay: false,\r\n\t},\r\n\tmaintainAspectRatio: false,\r\n}\r\n\r\nexport class VView extends VPage<CIDX> {\r\n\tcurrentIndex: number = 0;\r\n\tconstructor(controller:CIDX) {\r\n\t\tsuper(controller);\r\n\t\tmakeObservable(this, {\r\n\t\t\tcurrentIndex: observable,\r\n\t\t});\r\n\t}\r\n\r\n\theader() {return 'View'}\r\n\tright() {\r\n\t\treturn <button\r\n\t\t\tclassName=\"btn btn-sm btn-primary mr-2\" \r\n\t\t\tonClick={() => this.controller.onItemEdit()}>\r\n\t\t\t<FA name=\"pencil-square-o\" />\r\n\t\t</button>;\r\n\t}\r\n\tcontent() {\t\t\r\n\t\tlet V = observer(() => {\r\n\t\t\tlet {spanValues, midIDX, timeSpan, prevTimeSpan, nextTimeSpan, dayValues} = this.controller;\r\n\t\t\tif (spanValues === null) return null; \r\n\t\t\tlet {props} = midIDX;\r\n\t\t\tconst data = {\r\n\t\t\t\tlabels: timeSpan.labels,\r\n\t\t\t\tdatasets: [{\r\n\t\t\t\t\tlabel: '',\r\n\t\t\t\t\tdata: toJS(dayValues),\r\n\t\t\t\t\tbackgroundColor: 'lightgreen',\r\n\t\t\t\t\tborderWidth: 1\r\n\t\t\t\t}],\r\n\t\t\t};\r\n\t\t\tlet curProp = props[this.currentIndex] as NumberProp;\r\n\t\t\tlet {label, name} = curProp;\r\n\t\t\tlet moveStep = (icon:string, spanStep: ()=>Promise<void>) => <div \r\n\t\t\t\tclassName={'p-3 ' + (spanStep? 'cursor-pointer' : 'text-muted')} \r\n\t\t\t\tonClick={spanStep}>\r\n\t\t\t\t\t<FA name={icon} />\r\n\t\t\t\t</div>;\r\n\t\t\tlet left = moveStep('chevron-left', prevTimeSpan);\r\n\t\t\tlet right = timeSpan.canNext === true?\r\n\t\t\t\tmoveStep('chevron-right', nextTimeSpan)\r\n\t\t\t\t:\r\n\t\t\t\tmoveStep('square-o', undefined);\r\n\t\t\t\t//<div><FA className=\"text-muted\" name=\"square-o\" /></div>;\r\n\t\t\treturn <div className=\"py-3\">\r\n\t\t\t\t<div className=\"container\">\r\n\t\t\t\t\t<div className=\"row\">\r\n\t\t\t\t\t\t{spans.map(v => {\r\n\t\t\t\t\t\t\tlet cn = 'col text-center p-2 cursor-pointer ';\r\n\t\t\t\t\t\t\tlet style:CSSProperties = {\r\n\t\t\t\t\t\t\t\tborderBottomWidth: '0.15rem',\r\n\t\t\t\t\t\t\t\tborderBottomStyle: 'solid',\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\tif (this.controller.timeSpan.type === v) {\r\n\t\t\t\t\t\t\t\tcn += 'text-primary font-weight-bold';\r\n\t\t\t\t\t\t\t\tstyle.borderBottomColor = 'blue';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\tcn += 'text-muted';\r\n\t\t\t\t\t\t\t\tstyle.borderBottomColor = 'lightgray';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn <div key={v} className={cn} style={style} \r\n\t\t\t\t\t\t\t\tonClick={()=>this.tabClick(v as any)}>{this.t(v)}</div>;\r\n\t\t\t\t\t\t})}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<LMR className=\"text-center align-items-center\" left={left} right={right} >\r\n\t\t\t\t\t{timeSpan.title}\r\n\t\t\t\t</LMR>\r\n\t\t\t\t<div className=\"mt-3 mx-3 text-center cursor-pointer\"\r\n\t\t\t\t\tonClick={() => this.onFieldHistory(name)}>\r\n\t\t\t\t\t<h4 className=\"d-inline\">{label}</h4>\r\n\t\t\t\t\t<span className=\"text-info small\"> <FA name=\"angle-double-right\" /> 查看明细</span>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"p-3 h-12c\">\r\n\t\t\t\t\t<Bar data={data} width={100} height={50} options={graphOptions} />\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"d-flex flex-wrap p-1\"> \r\n\t\t\t\t\t{props.map((v, index) => {\r\n\t\t\t\t\t\tlet {name, label} = v as any;\r\n\t\t\t\t\t\tlet sv = spanValues[name];\r\n\t\t\t\t\t\tlet val = sv?\r\n\t\t\t\t\t\t\t<b className=\"h3 mb-0\">{sv}</b>\r\n\t\t\t\t\t\t\t:\r\n\t\t\t\t\t\t\t<small className=\"text-muted\">0</small>\r\n\t\t\t\t\t\tlet cn = 'm-1 w-8c h-8c d-flex flex-column align-items-center justify-content-center bg-white px-3 cursor-pointer border rounded ';\r\n\t\t\t\t\t\tcn += (index === this.currentIndex)? ' border-primary' : ' ';\r\n\t\t\t\t\t\treturn <div key={index} className={cn} onClick={() => this.onFieldClick(v, index)}>\r\n\t\t\t\t\t\t\t<div className=\"my-3 h-4c d-flex align-items-center\">{val}</div>\r\n\t\t\t\t\t\t\t<div className=\"mb-3\">{label}</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t})}\r\n\t\t\t\t</div>\r\n\t\t\t</div>;\r\n\t\t});\r\n\t\treturn <V />;\r\n\t}\r\n\r\n\tprivate tabClick(span:'day'|'week'|'month'|'year') {\r\n\t\tthis.controller.setTimeSpan(span);\r\n\t}\r\n\r\n\tprivate async onFieldClick(prop:Prop, index:number) {\r\n\t\tlet {midIDX} = this.controller;\r\n\t\tlet {props} = midIDX;\r\n\t\tif (this.currentIndex === index) {\r\n\t\t\tlet curProp = props[this.currentIndex] as NumberProp;\r\n\t\t\tlet {name} = curProp;\r\n\t\t\tawait this.controller.onFieldHistory(name);\r\n\t\t\treturn;\r\n\t\t}\r\n\t\trunInAction(() => {\r\n\t\t\tthis.currentIndex = index;\r\n\t\t\tlet curProp = props[this.currentIndex] as NumberProp;\r\n\t\t\tlet {name} = curProp;\r\n\t\t\tthis.controller.setCurrentField(name);\r\n\t\t});\r\n\t}\r\n\r\n\tprivate async onFieldHistory(field:string) {\r\n\t\tawait this.controller.onFieldHistory(field);\r\n\t}\r\n}\r\n","import { makeObservable, observable, runInAction } from \"mobx\";\r\nimport { Controller, PageItems } from \"tonva-react\";\r\nimport { HistoryPageItems, TimeSpan } from \"../tools\";\r\nimport { CList } from \"../list\";\r\nimport { MidIDX } from \"./MidIDX\";\r\nimport { MidIDXList } from \"./MidIDXList\";\r\nimport { res } from \"./res\";\r\nimport { VEdit } from \"./VEdit\";\r\nimport { VHistory } from \"./VHistory\";\r\nimport { VView } from \"./VView\";\r\n\r\nexport class CIDX extends Controller {\r\n\ttimeSpan:TimeSpan = null;\r\n\tspanValues: any = null;\r\n\tdayValues: number[] = null;\r\n\tmidIDX: MidIDX;\r\n\tprivate historyPageItems: HistoryPageItems<any>\r\n\tconstructor(midIDX: MidIDX) {\r\n\t\tsuper();\r\n\t\tmakeObservable(this, {\r\n\t\t\ttimeSpan: observable,\r\n\t\t\tspanValues: observable,\r\n\t\t\tdayValues: observable.ref,\r\n\t\t});\r\n\t\tthis.setRes(res);\r\n\t\tthis.setRes(midIDX.res);\r\n\t\tthis.midIDX = midIDX;\r\n\t\tthis.historyPageItems = new HistoryPageItems<any>(midIDX.historyLoader);\r\n\t}\r\n\r\n\tprotected async internalStart() {\r\n\t\tawait this.midIDX.init();\r\n\t\tlet {uq, ID, IDX} = this.midIDX;\r\n\t\tlet midIDXList = new MidIDXList(uq, ID, IDX);\r\n\t\tmidIDXList.onItemClick = this.onItemClick;\r\n\t\tlet cList = new CList(midIDXList);\r\n\t\tawait cList.start();\r\n\t}\r\n\r\n\titem:any;\r\n\tonItemClick: (item:any) => void = async (item:any) => {\r\n\t\tthis.item = item;\r\n\t\tawait this.setTimeSpan('month');\r\n\t\tthis.openVPage(VView);\r\n\t}\r\n\r\n\tonItemEdit = async ():Promise<void> => {\r\n\t\tthis.openVPage(VEdit);\r\n\t}\r\n\r\n\tasync setTimeSpan(span: 'day'|'week'|'month'|'year') {\r\n\t\tlet timeSpan = TimeSpan.create(span);\r\n\t\trunInAction(async () => {\r\n\t\t\tthis.timeSpan = timeSpan;\r\n\t\t\tawait this.loadSum(timeSpan);\r\n\t\t});\r\n\t}\r\n\r\n\tprivate async loadSum(timeSpan?: TimeSpan) {\r\n\t\tlet {far, near} = timeSpan ?? this.timeSpan;\r\n\t\tlet ret = await this.midIDX.loadSum(this.item.id, far, near);\r\n\t\t// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n\t\tlet [values, sums] = ret;\r\n\t\tlet sum = sums[0];\r\n\t\trunInAction(() => {\r\n\t\t\tthis.spanValues = sum ?? {};\r\n\t\t});\r\n\t\tawait this.loadDayValues();\r\n\t}\r\n\r\n\tprevTimeSpan = async () => {\r\n\t\tthis.timeSpan.prev();\r\n\t\tawait this.loadSum();\r\n\t}\r\n\r\n\tnextTimeSpan = async () => {\r\n\t\tthis.timeSpan.next();\r\n\t\tawait this.loadSum();\r\n\t}\r\n\r\n\tget historyItems():PageItems<any> {return this.historyPageItems;}\r\n\tfield:string;\r\n\tasync onFieldHistory(field:string) {\r\n\t\tthis.field = field;\r\n\t\tawait this.midIDX.init();\r\n\t\tthis.historyPageItems.first({\r\n\t\t\tid: this.item.id,\r\n\t\t\tfar: this.timeSpan.far,\r\n\t\t\tnear: this.timeSpan.near,\r\n\t\t\tfield\r\n\t\t});\r\n\t\tthis.openVPage(VHistory);\r\n\t}\r\n\r\n\tasync loadDayValues() {\r\n\t\tlet {far, near} = this.timeSpan;\r\n\t\tlet ret = await this.midIDX.loadDayValues(this.item.id, this.field, far, near);\r\n\t\tlet dayValues = this.timeSpan.getDayValues(ret);\r\n\t\trunInAction(() => {\r\n\t\t\tthis.dayValues = dayValues;\r\n\t\t});\r\n\t}\r\n\r\n\tsetCurrentField(field:string) {\r\n\t\tthis.field = field;\r\n\t\tthis.loadDayValues();\r\n\t}\r\n\r\n\tasync saveFieldValue(field:string, t:number, value:number|string) {\r\n\t\tlet {id} = this.item;\r\n\t\tawait this.midIDX.saveFieldValue(id, field, t, value);\r\n\t\tlet ret = await this.midIDX.loadFieldSum(id, field, this.timeSpan);\r\n\t\tlet v= ret[field];\r\n\t\tthis.spanValues[field] = v;\r\n\t\treturn;\r\n\t}\r\n}\r\n","import { ID, Schema, UiSchema, Uq, Prop, IDX } from \"tonva-react\";\r\nimport { TimeSpan } from \"../tools\";\r\nimport { Mid } from \"../base\";\r\n\r\nexport class MidIDX extends Mid {\r\n\treadonly IDX: IDX;\r\n\treadonly ID: ID;\r\n\treadonly timeZone: number;\r\n\tconstructor(uq: Uq, IDX: IDX, ID: ID, timeZone:number) {\r\n\t\tsuper(uq);\r\n\t\tthis.IDX = IDX;\r\n\t\tthis.ID = ID;\r\n\t\tthis.timeZone = timeZone;\r\n\t}\r\n\t\r\n\tasync init():Promise<void> {\r\n\t\tawait this.loadSchema();\r\n\t}\r\n\r\n\tprotected async loadSchema() {\r\n\t\tawait Promise.all([\r\n\t\t\tthis.IDX.loadSchema(),\r\n\t\t\tthis.ID.loadSchema(),\r\n\t\t]);\r\n\t\tlet IDUI = {ID: this.ID};\r\n\t\tthis._itemSchema = await this.buildItemSchema(IDUI);\r\n\t\tthis._uiSchema = this.buildUISchema(IDUI);\r\n\t\tthis._props = this.buildGridProps(this.IDX.ui);\r\n\t\tlet {exFields} = this.IDX.schema;\r\n\t\tfor (let prop of this._props) {\r\n\t\t\tlet {name} = prop as any;\r\n\t\t\tif (!name) continue;\r\n\t\t\tlet ex = (exFields as any[])?.find(v => v.field === name);\r\n\t\t\tlet time = ex?.time;\r\n\t\t\tif (!time) continue;\r\n\t\t\t(prop as any).time = time;\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tasync load(id:number): Promise<any[]> {\r\n\t\tlet ret = await this.uq.ID({\r\n\t\t\tIDX: [this.ID, this.IDX],\r\n\t\t\tid,\r\n\t\t\tpage: undefined,\r\n\t\t});\r\n\t\treturn ret;\r\n\t}\r\n\r\n\thistoryLoader = async (id:number, field:string, far:number, near:number, pageStart:any, pageSize:number):Promise<any[]> => {\r\n\t\tlet ret = await this.uq.IDLog({\r\n\t\t\tIDX: this.IDX,\r\n\t\t\tfield,\r\n\t\t\tid,\r\n\t\t\tlog: 'each',\r\n\t\t\tfar,\r\n\t\t\tnear,\r\n\t\t\tpage: {\r\n\t\t\t\tstart: pageStart,\r\n\t\t\t\tsize: pageSize,\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn ret;\r\n\t}\r\n\r\n\tasync saveID(data:any):Promise<number> {\r\n\t\tlet param: any = {};\r\n\t\tparam[this.ID.name] = [data];\r\n\t\tlet ret = await this.uq.Acts(param);\r\n\t\tlet id = ret[this.ID.name];\r\n\t\treturn id[0];\r\n\t}\r\n\r\n\tasync saveFieldValue(id:number, fieldName:string, t:any, value:string|number):Promise<void> {\r\n\t\tlet param: any = {};\r\n\t\tlet val: any = {id};\r\n\t\tval[fieldName] = {\r\n\t\t\t$time: t,\r\n\t\t\tvalue,\r\n\t\t}\r\n\t\tparam[this.IDX.name] = [val];\r\n\t\tlet ret = await this.uq.Acts(param);\r\n\t\treturn ret;\r\n\t}\r\n\r\n\tasync loadFieldSum(id:number, field:string, timeSpan:TimeSpan):Promise<any> {\r\n\t\tlet {far, near} = timeSpan;\r\n\t\tlet retSum = await this.uq.IDSum({\r\n\t\t\tIDX: this.IDX,\r\n\t\t\tfield: [field],\r\n\t\t\tid,\r\n\t\t\tfar,\r\n\t\t\tnear,\r\n\t\t});\r\n\t\tlet ret = retSum[0];\r\n\t\treturn ret;\r\n\t}\r\n\r\n\tasync loadSum(id:number, far:number, near:number):Promise<[any[], any[]]> {\r\n\t\tlet valueFields:string[] = [];\r\n\t\tlet {fields, exFields} = this.IDX.schema;\r\n\t\tif (exFields === undefined) {\r\n\t\t\tthrow new Error('no valid sum field in exFields');\r\n\t\t}\r\n\t\tfor (let ex of exFields) {\r\n\t\t\tlet {field, log} =  ex;\r\n\t\t\tif (log !== true) continue;\r\n\t\t\tlet f = (fields as any[]).find(v => v.name === field);\r\n\t\t\tif (f === undefined) continue;\r\n\t\t\tlet {name, type} = f;\r\n\t\t\tif (['int', 'tinyint', 'smallint', 'bigint', 'dec'].indexOf(type) < 0) continue;\r\n\t\t\tvalueFields.push(name);\r\n\t\t}\r\n\t\treturn await Promise.all([\r\n\t\t\tthis.uq.ID({\r\n\t\t\t\tIDX: this.IDX,\r\n\t\t\t\tid,\r\n\t\t\t}),\r\n\t\t\tthis.uq.IDSum({\r\n\t\t\t\tIDX: this.IDX,\r\n\t\t\t\tfield: valueFields,\r\n\t\t\t\tid,\r\n\t\t\t\tfar,\r\n\t\t\t\tnear,\r\n\t\t\t}),\r\n\t\t]);\r\n\t}\r\n\r\n\tasync loadDayValues(id:number, field: string, far:number, near:number):Promise<any[]> {\r\n\t\tif (!field) {\r\n\t\t\tfield = (this._props[0] as any)?.name;\r\n\t\t\tif (!field) {\r\n\t\t\t\tdebugger;\r\n\t\t\t\talert('no field in loadDayValues');\r\n\t\t\t}\r\n\t\t}\r\n\t\tlet ret = await this.uq.IDLog({\r\n\t\t\tIDX: this.IDX,\r\n\t\t\tfield,\r\n\t\t\tlog: 'day',\r\n\t\t\ttimeZone: this.timeZone,\r\n\t\t\tid,\r\n\t\t\tfar,\r\n\t\t\tnear,\r\n\t\t\tpage: {\r\n\t\t\t\tstart: near,\r\n\t\t\t\tend: far,\r\n\t\t\t\tsize: 100,\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn ret;\r\n\t}\r\n\r\n\tprivate _itemSchema: Schema;\r\n\tget itemSchema(): Schema { return this._itemSchema; }\r\n\r\n\tprivate _uiSchema: UiSchema;\r\n\tget uiSchema(): UiSchema { return this._uiSchema; }\r\n\r\n\tprivate _props: Prop[];\r\n\tget props():Prop[] { return this._props; }\r\n}\r\n","import { ID, IX, Uq } from \"tonva-react\";\r\nimport { Mid } from \"../base\";\r\n\r\ninterface TagTree {\r\n\tid: number;\r\n\tparent: number;\r\n\tname: string;\r\n\tsub: {[id:number]: TagTree};\r\n\tcount: number;\r\n}\r\n\r\ninterface TagItem {\r\n\tid: number;\r\n\tparent: number;\r\n\tname: string;\r\n}\r\n\r\nexport interface Tag {\r\n\tid: number;\r\n\tname: string;\r\n\tparent: number;\r\n\tsub: Tag[];\r\n}\r\n\r\nexport class MidTag extends Mid {\r\n\treadonly ID: ID;\r\n\treadonly IX: IX;\r\n\treadonly tag: ID;\r\n\treadonly type: string;\r\n\t\r\n\ttypeArr: Tag[];\r\n\ttypeColl: {[id:number]: Tag};\r\n\r\n\tconstructor(uq: Uq, ID:ID, IX:IX, tag:ID, type: string) {\r\n\t\tsuper(uq);\r\n\t\tthis.ID = ID;\r\n\t\tthis.IX = IX;\r\n\t\tthis.tag = tag;\r\n\t\tthis.type = type;\r\n\t}\r\n\r\n\tasync init():Promise<void> {\r\n\t\tawait this.load();\r\n\t}\r\n\r\n\tprotected async load(): Promise<void> {\r\n\t\tif (this.typeArr) return;\r\n\t\tlet ret = await Promise.all([\r\n\t\t\tthis.ID.loadSchema(),\r\n\t\t\tthis.IX.loadSchema(),\r\n\t\t\tthis.tag.loadSchema(),\r\n\t\t\tthis.uq.IDTree<TagItem>({\r\n\t\t\t\tID: this.tag,\r\n\t\t\t\tparent: 0,\r\n\t\t\t\tkey: this.type,\r\n\t\t\t\tlevel: 3,\r\n\t\t\t\tpage: {start:0, size:1000},\r\n\t\t\t})\r\n\t\t]);\r\n\t\tthis.buildTagTypes(ret[3]);\r\n\t}\r\n\r\n\tprivate buildTagTypes(items: TagItem[]) {\r\n\t\tlet root:TagTree;\r\n\t\tlet tree:TagTree = {id:0, parent:-1, name:undefined, sub:{}, count:0};\r\n\t\tfor (let item of items) {\r\n\t\t\tlet {id, parent, name} = item;\r\n\t\t\tif (parent === 0) {\r\n\t\t\t\ttree.sub[id] = root = {id, parent, name, sub: {}, count:0};\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tlet p = tree.sub[parent];\r\n\t\t\tlet tag:TagTree = {id, parent, name, sub: {}, count:0};\r\n\t\t\ttree.sub[id] = tag;\r\n\t\t\tif (p !== undefined) {\r\n\t\t\t\tp.sub[id] = tag;\r\n\t\t\t\tp.count++;\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor (let i in tree.sub) {\r\n\t\t\tlet tag = tree.sub[i];\r\n\t\t\tlet {parent} = tag;\r\n\t\t\tif (parent > 0) {\r\n\t\t\t\tlet p = tree.sub[parent];\r\n\t\t\t\tif (p) p.sub[Number(i)] = tag;\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.typeArr = [];\r\n\t\tthis.typeColl = {};\r\n\t\tif (!root) return;\r\n\t\tfor (let i in root.sub) {\r\n\t\t\tlet tree = root.sub[i];\r\n\t\t\tlet {id, name} = tree;\r\n\t\t\tlet type:Tag = {id, name, sub:[], parent: undefined};\r\n\t\t\tthis.typeArr.push(type);\r\n\t\t\tthis.typeColl[id] = type;\r\n\t\t\tfor (let j in tree.sub) {\r\n\t\t\t\tlet s = tree.sub[j];\r\n\t\t\t\tlet {id, name} = s;\r\n\t\t\t\ttype.sub.push({id, name, sub:undefined, parent:type.id})\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n","import { VPage } from \"tonva-react\";\r\nimport { CSelect } from \"./CSelect\";\r\nimport { Tag } from '../MidTag';\r\nimport { ItemTags } from '../CIDTagList';\r\n\r\ninterface TagGroup {\r\n\tid: number;\r\n\tname:string;\r\n\tchecks: {tag: Tag, selected: boolean}[];\r\n}\r\n\r\nexport class VSelect extends VPage<CSelect> {\r\n\tprivate tagGroups:TagGroup[];\r\n\tinit() {\r\n\t\tlet {midTag, itemTags} = this.controller;\r\n\t\tlet {typeColl} = itemTags as ItemTags<any>;\r\n\t\tthis.tagGroups = [];\r\n\t\tfor (let midType of midTag.typeArr) {\r\n\t\t\tlet {id, name} = midType;\r\n\t\t\tlet type = typeColl[id];\r\n\t\t\tlet checks: {tag:Tag; selected: boolean}[] = [];\r\n\t\t\tlet tagGroup = {id, name, checks};\r\n\t\t\tfor (let s of midType.sub) {\r\n\t\t\t\tlet {id: tagId} = s;\r\n\t\t\t\tlet selected = \r\n\t\t\t\t\ttype === undefined?\r\n\t\t\t\t\tfalse\r\n\t\t\t\t\t:\r\n\t\t\t\t\ttype.sub.findIndex(v => v.id === tagId) >= 0;\r\n\t\t\t\tchecks.push({tag:s, selected});\r\n\t\t\t}\r\n\t\t\tthis.tagGroups.push(tagGroup);\r\n\t\t}\r\n\t}\r\n\r\n\theader() {return 'select'}\r\n\tcontent() {\r\n\t\tlet {midTag, itemTags} = this.controller;\r\n\t\tlet {item} = itemTags;\r\n\t\t//let {tags} = midTag;\r\n\t\treturn <div className=\"px-3\">\r\n\t\t\t<div className=\"my-3\">{midTag.ID.render(item)}</div>\r\n\t\t\t{this.tagGroups.map(v => this.renderType(v))}\r\n\t\t</div>;\r\n\t}\r\n\r\n\tprivate renderType(group: TagGroup) {\r\n\t\tlet {id, name, checks}  = group;\r\n\t\treturn <div key={id} className=\"my-3\">\r\n\t\t\t<div><b>{name}</b></div>\r\n\t\t\t<div className=\"form-check form-check-inline mt-1\">\r\n\t\t\t{checks.map(v => {\r\n\t\t\t\tlet {tag, selected} = v;\r\n\t\t\t\tlet {id, name} = tag;\r\n\t\t\t\treturn <>\r\n\t\t\t\t\t<label key={id} className=\"form-check-label mr-3\">\r\n\t\t\t\t\t<input type=\"checkbox\" className=\"form-check-input\"\r\n\t\t\t\t\t\tonChange={(evt) => this.controller.onTagSelectChanged(tag, evt.currentTarget.checked)}\r\n\t\t\t\t\t\tdefaultChecked={selected} />\r\n\t\t\t\t\t{name}</label>\r\n\t\t\t\t</>\r\n\t\t\t})}\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t}\r\n}","import { Controller } from \"tonva-react\";\r\nimport { MidTag, Tag } from \"../MidTag\";\r\nimport { CIDTagList } from '../CIDTagList';\r\nimport { VSelect } from \"./VSelect\";\r\n\r\nexport class CSelect extends Controller {\r\n\tprivate cIDTagList: CIDTagList<any>;\r\n\titemTags: any;\r\n\tmidTag: MidTag;\r\n\tconstructor(cIDTagList: CIDTagList<any>, itemTags:any, midTag: MidTag) {\r\n\t\tsuper();\r\n\t\tthis.setRes(midTag.res);\r\n\t\tthis.cIDTagList = cIDTagList;\r\n\t\tthis.itemTags = itemTags;\r\n\t\tthis.midTag = midTag;\r\n\t}\r\n\r\n\tprotected async internalStart() {\r\n\t\tthis.openVPage(VSelect);\r\n\t}\r\n\r\n\tprotected onItemClick(item:any):void {\r\n\t\treturn; //this.props.onItemClick(item);\r\n\t}\r\n\r\n\tprotected renderRight():JSX.Element {\r\n\t\treturn null;\r\n\t}\r\n\r\n\tonTagSelectChanged = async (tag:Tag, selected:boolean) => {\r\n\t\tawait this.cIDTagList.onTagSelectChanged(this.itemTags, tag, selected);\r\n\t}\r\n}\r\n","import { observer } from \"mobx-react\";\r\nimport { FA } from \"tonva-react\";\r\nimport { IDBase } from \"../base\";\r\nimport { MidIDTagList, ItemTags } from \"./CIDTagList\";\r\nimport { Tag } from \"./MidTag\";\r\n\r\nexport function renderRight(onClick: () => void) {\r\n\treturn <button className=\"btn btn-sm btn-primary mr-2\" onClick={onClick}>\r\n\t\t<FA name=\"plus\" />\r\n\t</button>;\r\n}\r\n\r\nexport function renderItemTags<T extends IDBase>(midIDTagList: MidIDTagList<T>, itemTags:ItemTags<T>, index:number):JSX.Element {\r\n\tlet V = observer(() => {\r\n\t\tlet {midTag, renderItem, renderTags} = midIDTagList;\r\n\t\t//let {renderItem} = midTag;\r\n\t\tlet {ID} = midTag;\r\n\t\tlet {item, typeArr} = itemTags;\r\n\t\treturn <div className=\"d-block\">\r\n\t\t\t<div>{(renderItem ??  ID.render)(item as any, index)}</div>\r\n\t\t\t<div className=\"text-muted mt-1\">{(renderTags ?? defaultRenderTags)(typeArr)}</div>\r\n\t\t</div>;\t\r\n\t});\r\n\treturn <V />;\r\n}\r\n\r\nfunction defaultRenderTags(typeArr:Tag[]):JSX.Element {\r\n\treturn <>\r\n\t\t{\r\n\t\t\ttypeArr.map(type => {\r\n\t\t\t\tlet {id, name} = type;\r\n\t\t\t\treturn <span key={id} className=\"mr-3\">\r\n\t\t\t\t\t<b>{name}</b>: {renderType(type)}\r\n\t\t\t\t</span>;\r\n\t\t\t})\r\n\t\t}\r\n\t</>;\r\n}\r\n\r\nfunction renderType(type:Tag):JSX.Element {\r\n\tlet V = observer(() => {\r\n\t\tlet {sub} = type;\r\n\t\treturn <>{sub.map(tag => {\r\n\t\t\tlet {id, name} = tag;\r\n\t\t\treturn <span className=\"mr-1\" key={id}>{name}</span>\r\n\t\t})}</>;\r\n\t});\r\n\treturn <V />;\r\n}","import { CList, MidList } from \"../list\";\r\nimport { IXBase, IDBase } from \"../base\";\r\nimport { ListPageItems } from \"../tools\";\r\nimport { CSelect } from \"./select\";\r\nimport { MidTag, Tag } from \"./MidTag\";\r\nimport { renderItemTags } from \"./parts\";\r\nimport { observable } from \"mobx\";\r\n\r\nexport interface ItemTags<T> {\r\n\titem: T;\r\n\ttypeArr: Tag[];\r\n\ttypeColl: {[id:number]:Tag};\r\n}\r\n\r\nexport class CIDTagList<T extends IDBase> extends CList<ItemTags<T>> {\r\n\tprivate midIDTagList: MidIDTagList<T>;\r\n\tconstructor(midIDTagList: MidIDTagList<T>) {\r\n\t\tsuper(midIDTagList);\r\n\t\tthis.setRes(midIDTagList.res);\r\n\t\tthis.midIDTagList = midIDTagList;\r\n\t}\r\n\r\n\tasync beforeStart():Promise<boolean> {\r\n\t\tawait this.midIDTagList.midTag.init();\r\n\t\treturn true;\r\n\t}\r\n\r\n\tprotected onItemClick(item:any):void {\r\n\t\tlet {midTag} = this.midIDTagList;\r\n\t\tlet cSelect = new CSelect(this, item, midTag);\r\n\t\tcSelect.start();\r\n\t}\r\n\r\n\tprotected renderItem(itemTags:ItemTags<T>, index:number):JSX.Element {\r\n\t\treturn renderItemTags(this.midIDTagList, itemTags, index);\r\n\t}\r\n\r\n\tasync onTagSelectChanged(item:any, tag:Tag, selected:boolean) {\r\n\t\tawait this.midIDTagList.onTagSelectChanged(item, tag, selected);\r\n\t}\r\n}\r\n\r\nexport class MidIDTagList<T extends IDBase> extends MidList<ItemTags<T>> {\r\n\treadonly midTag: MidTag;\r\n\tprivate itemTagsColl:{[id:number]:ItemTags<T>};\r\n\trenderTags: (types:Tag[]) => JSX.Element;\r\n\tconstructor(midTag:MidTag) {\r\n\t\tsuper(midTag.uq, undefined);\r\n\t\tthis.midTag = midTag;\r\n\t\tthis.createPageItems();\r\n\t}\r\n\r\n\tasync init() {\r\n\t\tawait this.midTag.IX.loadSchema();\r\n\t}\r\n\r\n\tprotected createPageItems():ItemTagsListPageItems<T> {\r\n\t\tlet listPageItems = new ItemTagsListPageItems<T>(\r\n\t\t\t(pageStart:any, pageSize:number) => this.loadPageItems(pageStart, pageSize)\r\n\t\t);\r\n\t\treturn listPageItems;\r\n\t}\r\n\r\n\tkey:((item:ItemTags<T>) => number|string) = item => item.item.id;\r\n\r\n\tprotected async loadPageItems(pageStart:any, pageSize:number):Promise<ItemTags<T>[]> {\r\n\t\tlet result = await this.uq.IDxID<T, any>({\r\n\t\t\tID: this.midTag.ID,\r\n\t\t\tIX: this.midTag.IX,\r\n\t\t\tID2: this.midTag.tag,\r\n\t\t\tpage: {start:pageStart, size:pageSize},\r\n\t\t});\r\n\t\tlet [ret, ret2] = result;\r\n\t\tlet itemTagsList:ItemTags<T>[] = [];\r\n\t\tthis.itemTagsColl = {}\r\n\t\tfor (let item of ret) {\r\n\t\t\tlet p:ItemTags<T> = {item, typeArr:[], typeColl:{}};\r\n\t\t\tthis.itemTagsColl[item.id] = p;\r\n\t\t\titemTagsList.push(p);\r\n\t\t}\r\n\t\tfor (let tagItem of ret2) {\r\n\t\t\tlet {$xid, parent, id} = tagItem;\r\n\t\t\tlet itemTags = this.itemTagsColl[$xid];\r\n\t\t\tthis.addTag(itemTags, parent, id);\r\n\t\t\t/*\r\n\t\t\tlet {typeColl, typeArr} = itemTags;\r\n\t\t\tlet type = typeColl[parent];\r\n\t\t\tlet midType = this.midTag.typeColl[parent];\r\n\t\t\tif (type === undefined) {\r\n\t\t\t\ttype = {id:midType.id, name:midType.name, sub:[], parent:undefined};\r\n\t\t\t\ttypeColl[parent] = type;\r\n\t\t\t\ttypeArr.push(type);\r\n\t\t\t}\r\n\t\t\ttype.sub.push(midType.sub.find(v => v.id === id));\r\n\t\t\t*/\r\n\t\t}\r\n\t\treturn itemTagsList;\r\n\t}\r\n\r\n\tprivate addTag(itemTags:ItemTags<T>, typeId:number, tagId:number) {\r\n\t\tlet {typeColl, typeArr} = itemTags;\r\n\t\tlet midType = this.midTag.typeColl[typeId];\r\n\t\tlet type = typeColl[typeId];\r\n\t\tlet tag = midType.sub.find(v => v.id === tagId);\r\n\t\tif (type === undefined) {\r\n\t\t\ttype = observable.object({id:midType.id, name:midType.name, sub:[tag], parent:undefined});\r\n\t\t\ttypeColl[typeId] = type;\r\n\t\t\ttypeArr.push(type);\r\n\t\t}\r\n\t\telse {\r\n\t\t\ttype.sub.push(tag);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate delTag(itemTags:ItemTags<T>, typeId:number, tagId:number) {\r\n\t\tlet {typeColl, typeArr} = itemTags;\r\n\t\tlet type = typeColl[typeId];\r\n\t\tif (type === undefined) return;\r\n\t\tlet {sub} = type;\r\n\t\tlet index = sub.findIndex(v => v.id === tagId);\r\n\t\tif (index < 0) return;\r\n\t\tsub.splice(index, 1);\r\n\t\tif (sub.length === 0) {\r\n\t\t\tlet typeIndex = typeArr.findIndex(v => v.id === type.id);\r\n\t\t\tif (typeIndex >= 0) typeArr.splice(typeIndex, 1);\r\n\t\t\tdelete typeColl[typeId];\r\n\t\t}\r\n\t}\r\n\r\n\tonTagSelectChanged = async (itemTags:ItemTags<T>, tag:Tag, selected:boolean) => {\r\n\t\tlet {item} = itemTags;\r\n\t\tlet {id:itemId} = item;\r\n\t\tlet {id, parent} = tag;\r\n\t\tlet ix:IXBase = {ix:undefined, id};\r\n\t\tlet acts:{[name:string]: IXBase[]} = {};\r\n\t\tacts[this.midTag.tag.name] = [ix];\r\n\t\tif (selected === true) {\r\n\t\t\tix.id = itemId;\r\n\t\t\tawait this.uq.Acts(acts);\r\n\t\t\tthis.addTag(itemTags, parent, id);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tix.id = -itemId;\r\n\t\t\tawait this.uq.Acts(acts);\r\n\t\t\tthis.delTag(itemTags, parent, id);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nclass ItemTagsListPageItems<T extends IDBase> extends ListPageItems<ItemTags<T>> {\r\n\titemId(item:ItemTags<T>):number {return item.item.id}\r\n\tnewItem(id:number, itemTags:ItemTags<T>):ItemTags<T> {\r\n\t\tlet {item, typeArr, typeColl} = itemTags;\r\n\t\treturn {\r\n\t\t\titem: {...item, id},\r\n\t\t\ttypeArr,\r\n\t\t\ttypeColl,\r\n\t\t}\r\n\t}\r\n\tupdate(item: ItemTags<T>):Promise<void> {\r\n\t\treturn;\r\n\t}\r\n}\r\n","import { LMR, VPage } from \"tonva-react\";\r\nimport { CTagIDList } from \"./CTagIDList\";\r\nimport { Tag } from \"./MidTag\";\r\n\r\nexport class VTags extends VPage<CTagIDList<any>> {\r\n\tprivate tags: Tag[] = [];\r\n\r\n\theader() {return 'tags'}\r\n\tcontent() {\r\n\t\tlet {midTag} = this.controller;\r\n\t\tlet {typeArr} = midTag;\r\n\t\tlet left = <button className=\"btn btn-primary\" \r\n\t\t\tonClick={() => this.controller.showID(this.tags)}>\r\n\t\t\t查看\r\n\t\t</button>;\r\n\t\tlet right = <>\r\n\t\t\t<button className=\"btn btn-sm btn-outline-primary mr-3\" onClick={()=>this.allTags(true)}>全选</button>\r\n\t\t\t<button className=\"btn btn-sm btn-outline-info\" onClick={()=>this.allTags(false)}>全清</button>\r\n\t\t</>;\r\n\t\treturn <div className=\"px-3\" id=\"$all$tags$\">\r\n\t\t\t{typeArr.map(v => this.renderType(v))}\r\n\t\t\t<div className=\"border-top py-3\">\r\n\t\t\t\t<LMR left={left} right={right} />\r\n\t\t\t</div>\r\n\t\t</div>;\r\n\t}\r\n\r\n\tprivate allTags = (selected:boolean) => {\r\n\t\tlet el = document.getElementById('$all$tags$');\r\n\t\tlet checkInputs = el.getElementsByTagName('input');\r\n\t\tfor (let i=0; i<checkInputs.length; i++) {\r\n\t\t\tlet checkInput = checkInputs[i];\r\n\t\t\tcheckInput.checked = selected;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate renderType(type: Tag) {\r\n\t\tlet {id, name, sub}  = type;\r\n\t\treturn <div key={id} className=\"my-3\">\r\n\t\t\t<div><b>{name}</b></div>\r\n\t\t\t<div className=\"form-check form-check-inline mt-1\">\r\n\t\t\t{sub.map(v => {\r\n\t\t\t\tlet {id, name} = v;\r\n\t\t\t\treturn <>\r\n\t\t\t\t\t<label key={id} className=\"form-check-label mr-3\">\r\n\t\t\t\t\t<input type=\"checkbox\" className=\"form-check-input\"\r\n\t\t\t\t\t\tonChange={(evt) => this.onTagSelectChanged(evt, v)}\r\n\t\t\t\t\t\t />\r\n\t\t\t\t\t{name}</label>\r\n\t\t\t\t</>\r\n\t\t\t})}\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t}\r\n\r\n\tprivate onTagSelectChanged(evt: React.ChangeEvent<HTMLInputElement>, tag:Tag) {\r\n\t\tif (evt.currentTarget.checked === true) {\r\n\t\t\tthis.tags.push(tag);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tlet index = this.tags.findIndex(v => v === tag);\r\n\t\t\tif (index >= 0) this.tags.splice(index, 1);\r\n\t\t}\r\n\t}\r\n}\r\n","import { Controller } from \"tonva-react\";\r\nimport { IDBase } from \"../base\";\r\nimport { listRight } from \"../tools\";\r\nimport { CList } from \"../list\";\r\nimport { MidTag, Tag } from \"./MidTag\";\r\nimport { CID, MidID, MidIDList } from \"../ID\";\r\nimport { VTags } from \"./VTags\";\r\n\r\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\nexport class CTagIDList<T extends IDBase> extends  Controller {\r\n\treadonly midTag: MidTag;\r\n\tconstructor(midTag: MidTag) {\r\n\t\tsuper();\r\n\t\tthis.setRes(midTag.res);\r\n\t\tthis.midTag = midTag;\r\n\t}\r\n\r\n\tprotected async internalStart() {\r\n\t\tawait this.midTag.init();\r\n\t\tthis.openVPage(VTags);\r\n\t}\r\n\r\n\tasync showID(tags: Tag[]) {\r\n\t\t// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n\t\tlet midIDList: MidTagIDList<T> = new MidTagIDList<any>(\r\n\t\t\tthis.midTag, tags.map(v => v.id)\r\n\t\t);\r\n\t\tlet cShowTagIDList = new CShowTagIDList(midIDList);\r\n\t\tawait cShowTagIDList.start();\r\n\t}\r\n}\r\n\r\nclass CShowTagIDList<T extends IDBase> extends CList<T> {\r\n\tprotected midIDList: MidTagIDList<T>;\r\n\tconstructor(midIDList: MidTagIDList<T>) {\r\n\t\tsuper(midIDList);\r\n\t\tthis.midIDList = midIDList;\r\n\t}\r\n\r\n\tasync beforeStart():Promise<boolean> {\r\n\t\tawait this.midIDList.midTag.init();\r\n\t\treturn true;\r\n\t}\r\n\r\n\tprotected async onItemClick(item:any):Promise<void> {\r\n\t\tlet {midTag} = this.midIDList;\r\n\t\tlet mid = new MidID(midTag.uq, {ID: midTag.ID});\r\n\t\tawait mid.init();\r\n\t\tlet cID = new CID(mid);\r\n\t\tcID.onItemClick(item);\r\n\t\t//let cSelect = new CSelect(this, item, midTag, this.res);\r\n\t\t//cSelect.start();\r\n\t}\r\n\t\r\n\r\n\tprotected renderRight():JSX.Element {\r\n\t\tlet {onRightClick, renderRight} = this.midIDList;\r\n\t\tif (!onRightClick) return null;\r\n\t\treturn (renderRight ?? listRight)(onRightClick);\r\n\t}\r\n\r\n\tprotected renderItem(item:T, index:number):JSX.Element {\r\n\t\tlet {midTag, renderItem} = this.midIDList;\r\n\t\tlet {ID} = midTag;\r\n\t\t//let {item, typeArr} = itemTags;\r\n\t\treturn (renderItem ??  ID.render)(item, index);\r\n\t\t//return renderItemTags(this.props, itemTags, index);\r\n\t}\r\n}\r\n\r\nexport class MidTagIDList<T extends IDBase> extends MidIDList<T> {\r\n\treadonly midTag: MidTag;\r\n\treadonly ids: number[];\r\n\tconstructor(midTag:MidTag, ids:number[]) {\r\n\t\tlet {uq, ID} = midTag;\r\n\t\tsuper(uq, ID);\r\n\t\tthis.ids = ids;\r\n\t}\r\n \r\n\tasync init() {\r\n\t\tawait this.midTag.IX.loadSchema();\r\n\t}\r\n\r\n\tprotected async loadPageItems(pageStart:any, pageSize:number):Promise<T[]> {\r\n\t\tlet result = await this.uq.IXr<T>({\r\n\t\t\tIX: this.midTag.IX,\r\n\t\t\tIDX: [this.ID],\r\n\t\t\tix: this.ids,\r\n\t\t\tpage: {start:pageStart, size:pageSize},\r\n\t\t});\r\n\t\treturn result;\r\n\t}\r\n}\r\n","import { IDUI, Uq } from \"tonva-react\";\r\nimport { Detail, Master, Mid } from \"../base\";\r\n\r\nexport interface SheetUI {\r\n\tmaster: IDUI;\r\n\tdetail: IDUI;\r\n}\r\n\r\nexport class MidSheet<M extends Master, D extends Detail> extends Mid {\r\n\treadonly master: IDUI;\r\n\treadonly detail: IDUI;\r\n\r\n\tconstructor(uq:Uq, ui: SheetUI, res?:any) {\r\n\t\tsuper(uq, res);\r\n\t\tlet {master, detail} = ui;\r\n\t\tthis.master = master;\r\n\t\tthis.detail = detail;\r\n\t}\r\n\r\n\tasync init(): Promise<void> {\r\n\t}\r\n\r\n\tasync load(id:number):Promise<[M[],D[]]> {\r\n\t\treturn [[], []];\r\n\t}\r\n\r\n\tasync save(master:M, details:D[]):Promise<any> {\r\n\t\tlet ret = await this.uq.ActDetail({\r\n\t\t\tmaster: {\r\n\t\t\t\tID: this.master.ID,\r\n\t\t\t\tvalue: master,\r\n\t\t\t},\r\n\t\t\tdetail: {\r\n\t\t\t\tID: this.detail.ID,\r\n\t\t\t\tvalues: details,\r\n\t\t\t},\r\n\t\t});\r\n\t\treturn ret;\r\n\t}\r\n};\r\n","import { makeObservable, observable } from \"mobx\";\r\nimport { Context, Controller } from \"tonva-react\";\r\nimport { createPickId } from \"../select\";\r\nimport { CFormPage, FormUI } from \"../form\";\r\nimport { Detail, Master } from \"../base\";\r\nimport { MidSheet } from \"./MidSheet\";\r\n\r\nexport abstract class CSheet<M extends Master, D extends Detail> extends Controller {\r\n\treadonly midSheet: MidSheet<M, D>;\r\n\tid: number;\r\n\tmaster: M = null;\r\n\tdetails: D[] = [];\r\n\tdetail: D = null;\r\n\r\n\tconstructor(mid: MidSheet<M, D>) {\r\n\t\tsuper();\r\n\t\tmakeObservable(this, {\r\n\t\t\tmaster: observable,\r\n\t\t\tdetails: observable,\r\n\t\t});\r\n\t\tthis.setRes(mid.res);\r\n\t\tthis.midSheet = mid;\r\n\t}\r\n\r\n\tprotected async load(id:number) {\r\n\t\tthis.id = id;\r\n\t\tlet [master, details] = await this.midSheet.load(id);\r\n\t\tthis.master = master[0];\r\n\t\tthis.details = details;\r\n\t}\r\n\r\n\tasync saveSheet() {\r\n\t\tlet ret = await this.midSheet.save(this.master, this.details);\r\n\t\treturn ret;\r\n\t}\r\n\t\r\n\tafterMasterNew() {\r\n\r\n\t}\r\n\r\n\tprivate serial:number = 1;\r\n\teditDetail = async (detail: D) => {\r\n\t\tlet {uq, detail:detailFormUI} = this.midSheet;\r\n\t\tlet {ID, fieldCustoms} = detailFormUI;\r\n\t\tlet uiForm = new FormUI(ID.ui, fieldCustoms);\r\n\t\tif (fieldCustoms) {\r\n\t\t\tfor (let i in fieldCustoms) {\r\n\t\t\t\tlet field = fieldCustoms[i];\r\n\t\t\t\tlet {ID} = field;\r\n\t\t\t\tif (ID) {\r\n\t\t\t\t\tuiForm.setIDUi(i, createPickId(uq, ID), ID.render);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tuiForm.hideField('master', 'row');\r\n\t\tlet cForm = new CFormPage(uiForm, detail);\r\n\t\tcForm.onSubmit = async (name:string, context: Context) => {\r\n\t\t\tlet values = context.data;\r\n\t\t\tlet serial = values['#'];\r\n\t\t\tif (!serial) {\r\n\t\t\t\tvalues['#'] = this.serial++;\r\n\t\t\t\tthis.details.push(values);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tlet index = this.details.findIndex(v => (v as any)['#'] === serial);\r\n\t\t\t\tif (index >= 0) {\r\n\t\t\t\t\tObject.assign(this.details[index], values);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.closePage();\r\n\t\t\tif (detail === undefined) {\r\n\t\t\t\tlet cForm = new CFormPage(uiForm, detail);\r\n\t\t\t\tawait cForm.start();\r\n\t\t\t}\r\n\t\t}\r\n\t\tawait cForm.start();\r\n\t}\r\n}\r\n","import { FA, List, LMR, Page, VPage } from \"tonva-react\";\r\nimport { CSheet } from \"./CSheet\";\r\n\r\nexport class VSheetEdit extends VPage<CSheet<any, any>> {\r\n\theader() {return 'sheet';}\r\n\tright() {\r\n\t\treturn <button className=\"btn btn-primary btn-sm mr-2\"\r\n\t\t\tonClick={this.saveSheet}>\r\n\t\t\t整单完成\r\n\t\t</button>;\r\n\t}\r\n\tcontent() {\r\n\t\tlet {midSheet: mid, master, details} = this.controller;\r\n\t\tlet {ID} = mid.master;\r\n\t\tlet right = <button className=\"btn btn-success btn-sm\"\r\n\t\t\tonClick={() => this.controller.editDetail(undefined)}>\r\n\t\t\t<FA name=\"plus\" />\r\n\t\t</button>;\r\n\t\treturn <div className=\"my-3\">\r\n\t\t\t<div className=\"p-3\">\r\n\t\t\t\t{ID.render(master)}\r\n\t\t\t</div>\r\n\t\t\t<div className=\"mt-3 pb-1 mb-1 px-3 small text-muted border-bottom\">\r\n\t\t\t\t<LMR right={right} className=\"align-items-end\">明细</LMR>\r\n\t\t\t</div>\r\n\t\t\t<List items={details} item={{render: this.renderDetail, onClick: this.onDetailClick}} />\r\n\t\t</div>;\r\n\t}\r\n\r\n\tprivate onDetailClick = (item: any) => {\r\n\t\tthis.controller.editDetail(item);\r\n\t}\r\n\r\n\tprivate renderDetail = (item:any, index:number) => {\r\n\t\treturn <div className=\"px-3 py-2\">\r\n\t\t\t{this.controller.midSheet.detail.ID.render(item)}\r\n\t\t</div>\r\n\t}\r\n//\t{JSON.stringify(item)}\r\n\r\n\tprivate saveSheet = async () => {\r\n\t\tlet ret = await this.controller.saveSheet();\r\n\t\tthis.closePage();\r\n\t\tthis.openPageElement(<Page header=\"单据完成\">\r\n\t\t\t<div className=\"p-3 text-center\">\r\n\t\t\t\t<div className=\"my-3\">单据保存成功！</div>\r\n\t\t\t\t<div className=\"my-3\">{ret.master}</div>\r\n\t\t\t\t<button className=\"btn btn-primary\" onClick={()=>this.closePage()}>返回</button>\r\n\t\t\t</div>\r\n\t\t</Page>)\r\n\t}\r\n}\r\n","//import { createPickId } from \"../select\";\r\nimport { Detail, Master } from \"../base\";\r\nimport { CFormDialog, FormUI } from \"../form\";\r\nimport { CSheet } from \"./CSheet\";\r\nimport { VSheetEdit } from \"./VSheetEdit\";\r\n\r\nexport class CSheetNew<M extends Master, D extends Detail> extends CSheet<M, D> {\r\n\tprotected async internalStart() {\r\n\t\tlet {master:masterUI} = this.midSheet;\r\n\t\tlet {ID, fieldCustoms} = masterUI;\r\n\t\tlet formUI = new FormUI(ID.ui, fieldCustoms);\r\n\t\t//await formUI.setNO(ID);\r\n\t\t/*\r\n\t\tif (fieldItems) {\r\n\t\t\tfor (let i in fieldItems) {\r\n\t\t\t\tlet field = fieldItems[i];\r\n\t\t\t\tlet {ID} = field;\r\n\t\t\t\tif (ID) {\r\n\t\t\t\t\tformUI.setIDUi(i, createPickId(uq, ID), ID.render);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t*/\r\n\t\tlet cDialog = new CFormDialog(formUI, undefined);\r\n\t\tawait cDialog.setNO(ID);\r\n\t\tlet master = await cDialog.call<M>();\r\n\t\tif (master === null) return;\r\n\t\tthis.master = master;\r\n\t\tthis.openVPage(VSheetEdit);\r\n\t}\r\n}\r\n","import { VPage } from \"tonva-react\";\r\nimport { CSheet } from \"./CSheet\";\r\n\r\nexport class VSheetView extends VPage<CSheet<any, any>> {\r\n\theader() {return this.controller.midSheet.master.ID.ui.label}\r\n\tcontent() {\r\n\t\tlet {midSheet: mid, master} = this.controller;\r\n\t\tlet {ID} = mid.master;\r\n\t\treturn <div className=\"p-3\">\r\n\t\t\t{ID.render(master)}\r\n\t\t</div>;\r\n\t}\r\n}","import { observer } from \"mobx-react\";\r\nimport { FA, LMR, VPage } from \"tonva-react\";\r\n//import { CMe } from \"./CMe\";\r\nimport { CRoles } from \"./CRoles\";\r\n//import { VAccountant } from \"./VAccountant\";\r\n//import { VManager } from \"./VManager\";\r\n\r\ninterface RoleItem {\r\n\tcaption: string;\r\n\tonClick: () => Promise<void>;\r\n}\r\n\r\nexport class VRoles extends VPage<CRoles> {\r\n\tprivate onRoleAdmin = async () => {\r\n\t\tthis.controller.showRoleAdmin();\r\n\t}\r\n\tprivate onAccountant = async () => {\r\n\t\t//this.openVPage(VAccountant);\r\n\t}\r\n\r\n\tprivate onManager = async () => {\r\n\t\t//this.openVPage(VManager);\r\n\t}\r\n\tprivate roleItems:{[role:string]: RoleItem} = {\r\n\t\t$: {\r\n\t\t\tcaption: '设置用户角色',\r\n\t\t\tonClick: this.onRoleAdmin,\r\n\t\t},\r\n\t\taccountant: {\r\n\t\t\tcaption: '会计',\r\n\t\t\tonClick: this.onAccountant,\r\n\t\t},\r\n\t\tmanager: {\r\n\t\t\tcaption: '经理',\r\n\t\t\tonClick: this.onManager,\r\n\t\t},\r\n\t};\r\n\r\n\theader() {\r\n\t\treturn this.t('backend')\r\n\t}\r\n\tcontent() {\r\n\t\tlet VContent = observer(() => {\r\n\t\t\tlet {roles} = this.controller;\r\n\t\t\treturn <div>\r\n\t\t\t\t<div>\r\n\t\t\t\t\t{roles.map(this.renderRoleItem)}\r\n\t\t\t\t</div>\r\n\t\t\t</div>;\t\r\n\t\t});\r\n\t\treturn <VContent />;\r\n\t}\r\n\r\n\tprivate renderRoleItem = (role:string, index:number):JSX.Element => {\r\n\t\tlet item = this.roleItems[role];\r\n\t\tif (!item) return null;\r\n\t\tlet {caption, onClick} = item;\r\n\t\tlet right = <FA name=\"angle-right\" />;\r\n\t\treturn <LMR key={index} className=\"px-3 py-2 cursor-pointer mt-1 bg-white\"\r\n\t\t\tonClick={onClick}\r\n\t\t\tright={right}>\r\n\t\t\t<div>{caption}</div>\r\n\t\t</LMR>;\r\n\t}\r\n}","import { Form, ItemSchema, VPage, StringSchema, ButtonSchema, UiButton, UiTextItem, Context } from \"tonva-react\";\r\nimport { CRoleAdmin } from \"./CRoleAdmin\";\r\n\r\nexport class VAddUser extends VPage<CRoleAdmin> {\r\n\theader() {return '新增角色用户'}\r\n\tcontent() {\r\n\t\tlet schema:ItemSchema[] = [\r\n\t\t\t{ name: 'userName', required: true, type: 'string', maxLength: 60 } as StringSchema,\r\n\t\t\t{ name: 'ok', type: 'button' } as ButtonSchema,\r\n\t\t];\r\n\t\tlet uiSchema = {\r\n\t\t\titems: {\r\n\t\t\t\tuserName: { widget: 'text', label:'用户账号', placeholder: '请输入用户的账号' } as UiTextItem,\r\n\t\t\t\tok: { widget: 'button', className: 'btn btn-primary', label: '提交' } as UiButton,\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn <div className=\"p-3\">\r\n\t\t\t<Form schema={schema} uiSchema={uiSchema} onButtonClick={this.onClick} onEnter={this.onEnter} />\r\n\t\t</div>\r\n\t}\r\n\r\n\tprivate onClick = async (name:string, context: Context) => {\r\n\t\tlet error = await this.controller.newUser(context.data['userName']);\r\n\t\tif (error) {\r\n\t\t\tcontext.setError('userName', error);\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tthis.closePage();\r\n\t}\r\n\r\n\tprivate onEnter = async (name:string, context: Context) => {\r\n\t\tawait this.onClick(name, context);\r\n\t}\r\n}\r\n","import { observer } from \"mobx-react\";\r\nimport { FA, LMR, VPage } from \"tonva-react\";\r\nimport { CRoleAdmin, UserRole } from \"./CRoleAdmin\";\r\nimport { VAddUser } from \"./VAddUser\";\r\n\r\nexport class VRoleAdmin extends VPage<CRoleAdmin> {\r\n\theader() {return '设置用户角色'}\r\n\tcontent() {\r\n\t\tlet {userRoles} = this.controller;\r\n\t\tlet VItem = observer((v:{userRole:UserRole;isMe:boolean}) => this.renderItem(v.userRole, v.isMe));\r\n\t\tlet VUserRoles = observer(() => <>{\r\n\t\t\tuserRoles.map(v => {\r\n\t\t\t\treturn <VItem key={v.user} userRole={v} isMe={false} />;\r\n\t\t\t})\r\n\t\t}</>);\r\n\t\tlet MeItem = observer(() => <VItem userRole={this.controller.meRoles} isMe={true} />);\r\n\t\treturn <div>\r\n\t\t\t<div className=\"mx-3 mt-3 mb-1 d-flex align-items-end\">\r\n\t\t\t\t<div className=\"mr-auto\">用户角色</div>\r\n\t\t\t\t<button className=\"btn btn-sm btn-outline-primary\" onClick={()=>this.openVPage(VAddUser)}><FA name=\"plus\" /> 增加</button>\r\n\t\t\t</div>\r\n\t\t\t<MeItem />\r\n\t\t\t<VUserRoles />\r\n\t\t</div>;\r\n\t}\r\n\r\n\tprivate renderItem = (userRole: UserRole, isMe: boolean) => {\r\n\t\tif (!userRole) return null;\r\n\t\tlet {user, roles, isDeleted} = userRole;\r\n\t\tlet {roleCaptions, ixOfUsers} = this.controller;\r\n\t\tlet onUndo = () => this.controller.restoreUser(userRole);\r\n\t\tlet onDelete = () => this.controller.deleteUser(userRole);\r\n\t\tlet onRightClick: () => void;\r\n\t\tlet rightIcon:string;\r\n\t\tlet vUser = this.renderUser(user);\r\n\t\tlet cn = 'bg-white border-top ';\r\n\t\tif (isMe === true) {\r\n\t\t\tcn += 'mb-1';\r\n\t\t\tvUser = <>{vUser}<small className=\"ml-1 text-success\">[自己]</small></>;\r\n\t\t}\r\n\t\tif (isDeleted === true) {\r\n\t\t\tonRightClick = onUndo;\r\n\t\t\trightIcon = 'undo';\r\n\t\t\tvUser = <del>{vUser}</del>\r\n\t\t}\r\n\t\telse {\r\n\t\t\tonRightClick = onDelete;\r\n\t\t\trightIcon = 'times';\r\n\t\t}\r\n\t\tlet right = <div className=\"p-3 cursor-pointer text-info\" onClick={onRightClick}><FA name={rightIcon} /></div>;\r\n\t\treturn <LMR key={user} \r\n\t\t\tclassName={cn}\r\n\t\t\tleft = {<div className=\"p-3 w-12c\">{vUser}</div>}\r\n\t\t\tright = {right}\r\n\t\t\t>\t\t\t\r\n\t\t\t<div className=\"d-flex flex-wrap\">\r\n\t\t\t\t{roles.map((v, i) => {\r\n\t\t\t\t\tlet vCap:any = roleCaptions[i];\r\n\t\t\t\t\tif (isDeleted === true) vCap = <del>{vCap}</del>\r\n\t\t\t\t\treturn <label className=\"m-3\" key={i}>\r\n\t\t\t\t\t\t<input className=\"mr-2\" type='checkbox' \r\n\t\t\t\t\t\t\tdisabled={isDeleted} defaultChecked={v} \r\n\t\t\t\t\t\t\tonChange={e => this.onRoleChange(e, i, userRole)} />\r\n\t\t\t\t\t\t{vCap}\r\n\t\t\t\t\t</label>;\r\n\t\t\t\t})}\r\n\t\t\t\t{\r\n\t\t\t\t\tixOfUsers?.map(v => {\r\n\t\t\t\t\t\treturn <button key={v} onClick={() => this.controller.ixUserBind(user, v)}\r\n\t\t\t\t\t\t\tclassName=\"btn btn-sm btn-outline-info mx-3 my-2\">\r\n\t\t\t\t\t\t\t<small>关联</small> {v}\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t</div>\r\n\t\t</LMR>;\r\n\t}\r\n\r\n\tprivate async onRoleChange(event: React.ChangeEvent<HTMLInputElement>, iRole: number, userRole:UserRole) {\r\n\t\tlet {target} = event;\r\n\t\ttarget.disabled = true;\r\n\t\tawait this.controller.setUserRole(target.checked, iRole, userRole);\r\n\t\ttarget.disabled = false;\r\n\t}\r\n}\r\n","import { makeObservable, observable, runInAction } from \"mobx\";\r\nimport { centerApi, Controller, UqApi, Uq } from \"tonva-react\";\r\nimport { CIXEdit, MidIX } from \"../../IX\";\r\nimport { VRoleAdmin } from \"./VRoleAdmin\";\r\n\r\nexport interface UserRole {\r\n\tuser:number; \r\n\troles:boolean[];\r\n\tisDeleted?: boolean;\r\n}\r\n\r\nexport class CRoleAdmin extends Controller {\r\n\tprivate readonly uq:Uq;\r\n\tprivate readonly uqApi: UqApi;\r\n\treadonly allRoles: string[];\r\n\treadonly roleCaptions: string[];\r\n\tmeRoles: UserRole = null;\r\n\tuserRoles: UserRole[] = null;\r\n\tixOfUsers: string[];\r\n\tprivate myRolesChanged:(roles:string[])=>void;\r\n\r\n\tconstructor(uq:Uq, myRolesChanged?:(roles:string[])=>void, roleCaptionMap?:{[role:string]:string}) {\r\n\t\tsuper();\r\n\t\tmakeObservable(this, {\r\n\t\t\tmeRoles: observable,\r\n\t\t\tuserRoles: observable,\r\n\t\t});\r\n\t\tthis.uq = uq;\r\n\t\tlet {$:uqMan} = uq;\r\n\t\tthis.uqApi = uqMan.uqApi;\r\n\t\tthis.allRoles = uqMan.allRoles;\r\n\t\tif (!this.allRoles || this.allRoles.length === 0) {\r\n\t\t\tthrow new Error(`uq ${uqMan.name} allRoles not defined. No RoleAdmin needed.`);\r\n\t\t}\r\n\t\tthis.myRolesChanged = myRolesChanged;\r\n\t\tif (roleCaptionMap) {\r\n\t\t\tthis.roleCaptions = this.allRoles.map(v => roleCaptionMap[v] || v);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.roleCaptions = this.allRoles;\r\n\t\t}\r\n\t}\r\n\r\n\tprotected async internalStart() {\r\n\t\tlet allUserRoles = await this.uqApi.getAllRoleUsers();\r\n\t\trunInAction(() => {\r\n\t\t\tlet r0 = allUserRoles.shift();\r\n\t\t\tlet {roles} = r0;\r\n\t\t\tif (roles) {\r\n\t\t\t\tthis.ixOfUsers = roles.split('|');\r\n\t\t\t}\r\n\t\t\tlet arr:string[] = this.allRoles.map(v => `|${v}|`);\r\n\t\t\tfunction rolesBool(t:string): boolean[] {\r\n\t\t\t\tif (!t) return arr.map(v => false);\r\n\t\t\t\treturn arr.map(v => t.indexOf(v) >= 0);\r\n\t\t\t}\r\n\t\t\tthis.userRoles = [];\r\n\t\t\tlet meId = this.user.id;\r\n\t\t\tfor (let ur of allUserRoles) {\r\n\t\t\t\tlet {user, roles} = ur;\r\n\t\t\t\tlet item:UserRole = ur as any;\r\n\t\t\t\titem.roles = rolesBool(roles);\r\n\t\t\t\tif (user === meId)\r\n\t\t\t\t\tthis.meRoles = item;\r\n\t\t\t\telse\r\n\t\t\t\t\tthis.userRoles.push(item);\r\n\t\t\t}\r\n\t\t});\r\n\t\tthis.openVPage(VRoleAdmin);\r\n\t}\r\n\tasync setUserRole(checked:boolean, iRole:number, userRole:UserRole) {\r\n\t\tlet {roles} = userRole;\r\n\t\tlet len = roles.length;\r\n\t\tlet text:string = '';\r\n\t\tfor (let i=0; i<len; i++) {\r\n\t\t\tlet yes = i===iRole? checked : roles[i];\r\n\t\t\tif (yes === true) text += '|' + this.allRoles[i];\r\n\t\t}\r\n\t\ttext += '|';\r\n\t\tawait this.uqApi.setUserRoles(userRole.user, text);\r\n\t\troles[iRole] = checked;\r\n\t\tthis.fireMyRolesChanged(userRole);\r\n\t}\r\n\r\n\tprivate fireMyRolesChanged(userRole: UserRole, newRoles?:boolean[]) {\r\n\t\tif (!this.myRolesChanged) return;\r\n\t\tif (userRole !== this.meRoles) return;\r\n\t\tlet {roles} = userRole;\r\n\t\tif (newRoles) roles = newRoles;\r\n\t\tlet roleNames:string[] = ['$'];\r\n\t\tfor (let i=0; i<roles.length; i++) {\r\n\t\t\tif (roles[i] === true) roleNames.push(this.allRoles[i]);\r\n\t\t}\r\n\t\tthis.myRolesChanged(roleNames);\r\n\t}\r\n\r\n\tprivate buildRolesText(userRole:UserRole) {\r\n\t\tlet ret = userRole.roles.map((v, index) => v===true? this.allRoles[index]:'').join('|');\r\n\t\treturn `|${ret}|`;\r\n\t}\r\n\r\n\tasync newUser(userName: string): Promise<string> {\r\n\t\tlet ret = await centerApi.userFromKey(userName);\r\n\t\tif (!ret) {\r\n\t\t\treturn '这个用户名没有注册';\r\n\t\t}\r\n\t\tlet user = ret.id;\r\n\t\tlet roles: string;\r\n\t\tif (this.isMe(user) === true) {\r\n\t\t\tif (this.meRoles) {\r\n\t\t\t\tthis.meRoles.isDeleted = false;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tthis.meRoles = {\r\n\t\t\t\t\tuser,\r\n\t\t\t\t\troles:  this.allRoles.map(v => false)\r\n\t\t\t\t};\t\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tlet userRole = this.userRoles.find(v => v.user === user);\r\n\t\t\tif (userRole) {\r\n\t\t\t\tif (userRole.isDeleted === true) {\r\n\t\t\t\t\tuserRole.isDeleted = false;\r\n\t\t\t\t\troles = this.buildRolesText(userRole);\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\treturn '这个用户已经是角色用户了';\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tuserRole = {\r\n\t\t\t\t\tuser,\r\n\t\t\t\t\troles: this.allRoles.map(v => false),\r\n\t\t\t\t};\r\n\t\t\t\tthis.userRoles.push(userRole);\r\n\t\t\t\troles = '';\r\n\t\t\t}\r\n\t\t}\r\n\t\tawait this.uqApi.setUserRoles(user, roles);\r\n\t\tif (this.isMe(user) === true) {\r\n\t\t\tthis.fireMyRolesChanged(this.meRoles);\r\n\t\t}\r\n\t}\r\n\r\n\tasync deleteUser(userRole: UserRole) {\r\n\t\tlet {user} = userRole;\r\n\t\tuserRole.isDeleted = true; \r\n\t\tawait this.uqApi.deleteUserRoles(user);\r\n\t\tthis.fireMyRolesChanged(userRole, this.allRoles.map(v => false));\r\n\t}\r\n\r\n\tasync restoreUser(userRole: UserRole) {\r\n\t\tlet {user} = userRole;\r\n\t\tuserRole.isDeleted = false; \r\n\t\tlet roles = this.buildRolesText(userRole)\r\n\t\tawait this.uqApi.setUserRoles(user, roles);\r\n\t\tthis.fireMyRolesChanged(userRole);\r\n\t}\r\n\r\n\tixUserBind = async (user:number, ixName:string) => {\r\n\t\tlet IX = this.uq.$.getIX(ixName);\r\n\t\tawait IX.loadSchema();\r\n\t\tlet {id2Name} = IX.schema;\r\n\t\tlet ID = this.uq.$.getID(id2Name);\r\n\t\tlet midIX = new MidIX(this.uq, IX, ID, user);\r\n\t\tlet cIXEdit = new CIXEdit(midIX);\r\n\t\tawait cIXEdit.start();\r\n\t}\r\n}\r\n","import { Controller, nav, Uq } from \"tonva-react\";\r\nimport { VRoles } from \"./VRoles\";\r\nimport { CRoleAdmin } from './roleAdmin';\r\n\r\nconst roleCaptionMap:{[role:string]: string} = {\r\n\taccountant: '会计',\r\n\tmanager: '经理',\r\n}\r\n\r\nexport class CRoles extends Controller {\r\n\tprivate uq: Uq;\r\n\troles: string[] = null;\r\n\tconstructor(uq:Uq) {\r\n\t\tsuper();\t\t\r\n\t\tthis.uq = uq;\r\n\t}\r\n\r\n\tprotected async internalStart() {\r\n\t\tthis.roles = await this.uq.$.getRoles();\r\n\t\tthis.openVPage(VRoles)\r\n\t}\r\n\r\n\tasync showRoleAdmin() {\r\n\t\tlet  uqMan = this.uq.$;\r\n\t\tlet {allRoles} = uqMan;\r\n\t\tif (!allRoles || allRoles.length === 0) {\r\n\t\t\talert(`uq ${uqMan.name} has not defined roles`);\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tlet cRoleAdmin = new CRoleAdmin(this.uq, this.myRolesChanged, roleCaptionMap);\r\n\t\tcRoleAdmin.setRes(this.getRes());\r\n\t\tawait cRoleAdmin.start();\r\n\t}\r\n\r\n\tprivate myRolesChanged = (roles:string[]) => {\r\n\t\tthis.roles = roles;\r\n\t\tthis.user.roles[this.uq.$.name] = roles;\r\n\t\tnav.saveLocalUser();\r\n\t}\r\n}","import { makeObservable, observable } from \"mobx\";\r\nimport { MiNet } from \"../net\";\r\nimport { Account } from \"./types\";\r\n\r\nexport class Accounts {\r\n\tprivate miNet: MiNet;\r\n\taccounts: Account[] = null;\r\n\taccount: Account = null;\r\n\r\n\tconstructor(miNet: MiNet) {\r\n\t\tmakeObservable(this, {\r\n\t\t\taccounts: observable,\r\n\t\t\taccount: observable,\r\n\t\t});\r\n\t\tthis.miNet = miNet;\r\n\t}\r\n\r\n\tasync load() {\r\n\t\t// let r = await this.miNet.t_allaccounts();\r\n\t\t// if (Array.isArray(r)) {\r\n\t\t// \tthis.accounts = r;\r\n\t\t// }\r\n\t}\r\n\r\n\tsetCurrentAccount(name:string):Account {\r\n\t\tthis.account = this.accounts.find(v => v.name === name);\r\n\t\treturn this.account;\r\n\t}\r\n}\r\n","import { IObservableArray, makeObservable, observable, runInAction } from \"mobx\";\r\nimport { ParamIX } from \"tonva-react\";\r\nimport { AccountValue, Account } from \"uq-app/uqs/BruceYuMi\";\r\nimport { MiAccount } from \"./miAccount\";\r\nimport { Store } from \"./store\";\r\n\r\nexport class MiAccounts {\r\n\tprivate store: Store;\r\n\taccounts: IObservableArray<MiAccount> = null;\r\n\r\n\tconstructor(store: Store) {\r\n\t\tmakeObservable(this, {\r\n\t\t\taccounts: observable,\r\n\t\t});\r\n\t\tthis.store = store;\r\n\t}\r\n\r\n\tasync load() {\r\n\t\tlet {yumi} = this.store;\r\n\t\tlet {UserAccount, Account, AccountValue} = yumi;\r\n\t\tlet param:ParamIX = {\r\n\t\t\tIX: UserAccount,\r\n\t\t\tIDX: [Account, AccountValue],\r\n\t\t\tix: undefined,\t\t\t// auto userId\r\n\t\t};\r\n\t\tlet ret = await yumi.IX<Account&AccountValue>(param);\r\n\t\tif (ret.length === 0) {\r\n\t\t\t// 没有持仓账号，则创建默认账号\r\n\t\t\t//let accountNO = await Account.NO();\r\n\t\t\tlet accountName = '我的持仓组合';\r\n\t\t\tlet retActs = await yumi.ActIX({\r\n\t\t\t\tIX: UserAccount,\r\n\t\t\t\tID: Account,\r\n\t\t\t\tvalues: [{\r\n\t\t\t\t\tix: undefined, \r\n\t\t\t\t\tid: {\r\n\t\t\t\t\t\tname: accountName, \r\n\t\t\t\t\t}\r\n\t\t\t\t}]\r\n\t\t\t});\r\n\t\t\t//ret = await this.yumi.IDinIX(param);\r\n\t\t\tret.push({\r\n\t\t\t\tid: retActs[0],\r\n\t\t\t\tname: accountName,\r\n\t\t\t} as any);\r\n\t\t}\r\n\t\trunInAction(() => {\r\n\t\t\tlet accounts = ret.map(v => new MiAccount(this.store, v));\r\n\t\t\tthis.accounts = observable(accounts);\r\n\t\t});\r\n\t}\r\n\r\n\taccountsFromIds(ids: number[]): MiAccount[] {\r\n\t\tlet ret:MiAccount[] = [];\r\n\t\tlet len = this.accounts.length;\r\n\t\tfor (let i=0; i<len; i++) {\t\t\t\r\n\t\t\tlet account = this.accounts[i];\r\n\t\t\tif (ids.findIndex(v => v === account.id) >= 0) {\r\n\t\t\t\tret.push(account);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn ret;\r\n\t}\r\n}\r\n","import { IObservableArray, observable } from \"mobx\";\r\nimport { ID } from \"tonva-react\";\r\nimport { BruceYuMi } from \"uq-app\";\r\nimport { Stock, StockValue } from \"uq-app/uqs/BruceYuMi\";\r\nimport { MiGroup } from \"./miGroup\";\r\nimport { Store } from \"./store\";\r\n\r\nexport class MiGroups {\r\n\tprivate store: Store;\r\n\tprivate readonly ID: ID;\r\n\treadonly groups: IObservableArray<MiGroup>;\r\n\r\n\tconstructor(store: Store) {\r\n\t\tthis.store = store;\r\n\t\tthis.ID = store.yumi.Group;\r\n\t\tthis.groups = observable.array<MiGroup>([], { deep: true });\r\n\t}\r\n\r\n\tasync load(): Promise<void> {\r\n\t\tlet {yumi} = this.store;\r\n\t\tlet ret = await yumi.IX<BruceYuMi.Group>({\r\n\t\t\tIX: yumi.UserGroup,\r\n\t\t\tIDX: [yumi.Group],\r\n\t\t\tix: undefined,\r\n\t\t});\r\n\t\tlet miGroups = ret.map(v => {\r\n\t\t\tlet stockCount = this.store.calcGroupStockCount(v.id);\r\n\t\t\treturn new MiGroup(this.store, v, stockCount);\r\n\t\t});\r\n\t\tthis.groups.splice(0, this.groups.length, ...miGroups);\r\n\t}\r\n\r\n\tasync addStockToGroup(stock:Stock&StockValue, group: MiGroup) {\r\n\t\tlet {yumi} = this.store;\r\n\t\tlet {stocksMyAll, groupIXs} = this.store;\r\n\t\tlet stockId = stock.id;\r\n\t\tlet groupId = group.id;\r\n\t\tawait yumi.Acts({\r\n\t\t\tgroupStock: [{ix: groupId, id: stockId, order: undefined}],\r\n\t\t\tuserAllStock: [{ix: undefined, id: stockId}],\r\n\t\t});\r\n\t\tgroupIXs.push({ix:groupId, id:stockId});\r\n\t\tlet index = stocksMyAll.findIndex(v => v.id === stockId);\r\n\t\tif (index < 0) stocksMyAll.push(stock);\r\n\t\tlet stockCount = this.store.calcGroupStockCount(groupId);\r\n\t\tgroup.addStock(stock, stockCount);\r\n\t}\r\n\r\n\tasync removeStockFromGroup(stock:Stock&StockValue, group: MiGroup) {\r\n\t\tlet {yumi} = this.store;\r\n\t\tlet stockId = stock.id;\r\n\t\tlet groupId = group.id;\r\n\t\tawait yumi.Acts({\r\n\t\t\tgroupStock: [{ix: groupId, id: -stockId, order: undefined}],\r\n\t\t});\r\n\t\tlet {groupIXs} = this.store;\r\n\t\tfor (let i=0; i<groupIXs.length; i++) {\r\n\t\t\tlet {ix, id} = groupIXs[i];\r\n\t\t\tif (id !== stockId) continue;\r\n\t\t\tif (ix !== groupId) continue;\r\n\t\t\tgroupIXs.splice(i, 1);\r\n\t\t\tlet stockCount = this.store.calcGroupStockCount(groupId);\r\n\t\t\tgroup.removeStock(stock, stockCount);\r\n\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\r\n\tgroupsFromIds(ids: number[]): MiGroup[] {\r\n\t\tlet ret:MiGroup[] = [];\r\n\t\tlet len = this.groups.length;\r\n\t\tfor (let i=0; i<len; i++) {\t\t\t\r\n\t\t\tlet group = this.groups[i];\r\n\t\t\tif (ids.findIndex(v => v === group.id) >= 0) {\r\n\t\t\t\tret.push(group);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn ret;\r\n\t}\r\n}\r\n","export const marketElements:{[name:string]:JSX.Element} = {\r\n\t'sz': <small className=\"text-danger\">[深]</small>,\r\n\t'sh': <small className=\"text-danger\">[沪]</small>,\r\n\t'hk': <small className=\"text-warning\">[港]</small>,\r\n}\r\n","import { IObservableArray, makeObservable, observable } from \"mobx\";\r\nimport { IXBase } from \"tonva-uqui\";\r\nimport { MiNet } from \"../net\";\r\nimport { defaultGroupName } from \"../consts\";\r\nimport { MiConfigs, RegressionConfig, Stock as StockType, StockFindConfig } from \"./types\";\r\nimport { StockGroups } from \"./stockGroups\";\r\nimport { Accounts } from \"./accounts\";\r\nimport { UQs } from \"uq-app\";\r\nimport { MiAccounts } from \"./miAccounts\";\r\nimport { MiGroups } from \"./miGroups\";\r\nimport { Market, Stock, StockValue, UqExt } from \"uq-app/uqs/BruceYuMi\";\r\nimport { MiGroup } from \"./miGroup\";\r\nimport { MiAccount } from \"./miAccount\";\r\nimport { marketElements } from \"./market\";\r\n\r\nexport class Store {\r\n\tprivate readonly miNet: MiNet;\r\n\treadonly myAllColl: {[id:number]: boolean} = {};\r\n\treadonly yumi: UqExt;\r\n\treadonly markets: {[id:number]: {id?:number;name:string;currency:string;el:JSX.Element}} = {};\r\n\tstockGroups: StockGroups;\r\n\taccounts: Accounts;\r\n\tmiAccounts: MiAccounts;\r\n\tmiGroups: MiGroups;\r\n\tstocksMyAll: IObservableArray<Stock & StockValue> = null;\r\n\tstocksMyBlock: IObservableArray<Stock & StockValue> = null;\r\n\tgroupIXs: IXBase[];\r\n\t\r\n\tconstructor(miNet:MiNet, uqs: UQs) {\r\n\t\tmakeObservable(this, {\r\n\t\t\tconfig: observable,\r\n\t\t\tmyAllColl: observable,\r\n\t\t\tstocksMyAll: observable.shallow,\r\n\t\t\tstocksMyBlock: observable.shallow,\r\n\t\t});\r\n\t\tthis.miNet = miNet;\r\n\t\tthis.yumi = uqs.BruceYuMi;\r\n\t\tthis.miAccounts = new MiAccounts(this);\r\n\t\tthis.miGroups = new MiGroups(this);\r\n\r\n\t\tthis.stockGroups = new StockGroups(miNet);\r\n\t\tthis.accounts = new Accounts(miNet);\r\n\t}\r\n\r\n\tstockFromId(stockId: number): Stock&StockValue {\r\n\t\treturn this.stocksMyAll.find(v => v.id === stockId);\r\n\t}\r\n\r\n\tasync loadStock(stockId: number): Promise<Stock&StockValue> {\r\n\t\tlet ret = await this.yumi.ID<Stock&StockValue>({\r\n\t\t\tIDX: [this.yumi.Stock, this.yumi.StockValue],\r\n\t\t\tid: stockId,\r\n\t\t});\r\n\t\tlet stock = ret[0];\r\n\t\tthis.buildStockValues(stock);\r\n\t\treturn stock;\r\n\t}\r\n\r\n\tprivate buildStockValues(stock: Stock & StockValue) {\r\n\t\tif (stock === undefined) return;\r\n\t\tlet {miValue, earning, divident, price, market} = stock;\r\n\t\tif (miValue) stock.miValue = miValue;\r\n\t\tif (earning) stock.earning = earning;\r\n\t\tif (divident) stock.divident = divident * 1000 / price;\r\n\t\tif (price) stock.price = price / 10000;\r\n\t\t(stock as any).$market = this.markets[market];\r\n\t}\r\n\t\r\n\tasync searchStock(param:any, pageStart:any, pageSize:number):Promise<{[name:string]:any[]}> {\r\n\t\tlet ret = await this.yumi.SearchStock.page(param, pageStart, pageSize, true);\r\n\t\tlet {$page} = ret;\r\n\t\t$page.forEach(v => this.buildStockValues(v as unknown as (Stock & StockValue)));\r\n\t\treturn ret as any;\r\n\t}\r\n\r\n\tisMyAll(stock: Stock): boolean {\r\n\t\treturn this.myAllColl[stock.id] === true;\r\n\t}\r\n\t\r\n\tasync addMyAll(stock:Stock&StockValue) {\r\n\t\tif (!stock) return;\r\n\t\tawait this.yumi.ActIX({\r\n\t\t\tIX: this.yumi.UserAllStock, \r\n\t\t\tvalues: [\r\n\t\t\t\t{ix: undefined, id: stock.id}\r\n\t\t\t]\r\n\t\t});\r\n\t\tthis.stocksMyAll.push(stock);\r\n\t\tthis.myAllColl[stock.id] = true;\r\n\t}\r\n\r\n\tasync removeMyAll(stock: Stock&StockValue): Promise<{miAccounts: MiAccount[], miGroups: MiGroup[]}> {\r\n\t\tif (!stock) return;\r\n\r\n\t\tlet ret = await this.yumi.StockUsing.query({stock: stock.id});\r\n\t\tlet {groups, accounts} = ret;\r\n\t\tif (groups.length > 0 || accounts.length > 0) {\r\n\t\t\tlet miAccounts = this.miAccounts.accountsFromIds(accounts.map(v => v.account));\r\n\t\t\tlet miGroups = this.miGroups.groupsFromIds(groups.map(v => v.group));\r\n\t\t\treturn {miAccounts, miGroups};\r\n\t\t}\r\n\r\n\t\tawait this.yumi.ActIX({\r\n\t\t\tIX: this.yumi.UserAllStock, \r\n\t\t\tvalues: [\r\n\t\t\t\t{ix: undefined, id: -stock.id}\r\n\t\t\t]\r\n\t\t});\r\n\t\tlet index = this.stocksMyAll.findIndex(v => v.id === stock.id);\r\n\t\tif (index >= 0) this.stocksMyAll.splice(index, 1);\r\n\t\tdelete this.myAllColl[stock.id];\r\n\t}\r\n\r\n\tmyAllCaption: string = '自选股';\r\n\tmyBlockCaption: string = '黑名单';\r\n\r\n\tasync loadMyAll() {\r\n\t\tlet ret = await this.yumi.IX<(Stock&StockValue)>({\r\n\t\t\tIX: this.yumi.UserAllStock,\r\n\t\t\tIDX: [this.yumi.Stock, this.yumi.StockValue],\r\n\t\t\tix: undefined,\r\n\t\t});\r\n\t\tret.forEach(v => {\r\n\t\t\tthis.buildStockValues(v);\r\n\t\t\tthis.myAllColl[v.id] = true;\r\n\t\t});\r\n\t\tthis.stocksMyAll = observable(ret, {deep: false});\r\n\t}\r\n\r\n\tasync loadMyBlock() {\r\n\t\tif (this.stocksMyBlock) return;\r\n\t\tlet {yumi} = this;\r\n\t\tlet ret = await yumi.IX<(Stock&StockValue)>({\r\n\t\t\tIX: yumi.UserBlockStock,\r\n\t\t\tIDX: [yumi.Stock, yumi.StockValue],\r\n\t\t\tix: undefined,\r\n\t\t});\r\n\t\tret.forEach(v => this.buildStockValues(v));\r\n\t\tthis.stocksMyBlock = observable(ret, {deep: false});\r\n\t}\r\n\r\n\tasync loadGroupStocks(groupId: number):Promise<(Stock&StockValue)[]> {\r\n\t\tlet ret = this.stocksMyAll.filter(v => {\r\n\t\t\tlet stockId = v.id;\r\n\t\t\tlet ok = this.groupIXs.findIndex(gs => {\r\n\t\t\t\tlet {ix, id:gStockId} = gs;\r\n\t\t\t\treturn ix===groupId && gStockId===stockId;\r\n\t\t\t}) >= 0;\r\n\t\t\treturn ok;\r\n\t\t});\r\n\t\treturn ret;\r\n\t}\r\n\r\n\tasync loadMarkets() {\r\n\t\tlet {yumi} = this;\r\n\t\tlet ret = await yumi.ID<Market>({\r\n\t\t\tIDX: [yumi.Market],\r\n\t\t\tid: undefined,\r\n\t\t});\r\n\t\tfor (let m of ret) {\r\n\t\t\tlet {id, name} = m;\r\n\t\t\tthis.markets[id] = {...m, el: marketElements[name]};\r\n\t\t}\r\n\t}\r\n\r\n\tisMyBlock(stock: Stock): boolean {\r\n\t\tlet index = this.stocksMyBlock.findIndex(v => v.id === stock.id);\r\n\t\treturn index >= 0;\r\n\t}\r\n\r\n\tasync toggleBlock(stock: Stock&StockValue) {\r\n\t\tif (!stock) return;\r\n\t\tawait this.loadMyBlock();\r\n\t\tlet {id} = stock;\r\n\t\tlet index = this.stocksMyBlock.findIndex(v => v.id === id);\r\n\t\tif (index >= 0) {\r\n\t\t\tawait this.yumi.ActIX({\r\n\t\t\t\tIX: this.yumi.UserBlockStock,\r\n\t\t\t\tvalues: [{ix:undefined, id: -id}]\r\n\t\t\t})\r\n\t\t\tthis.stocksMyBlock.splice(index, 1);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tawait this.yumi.ActIX({\r\n\t\t\t\tIX: this.yumi.UserBlockStock,\r\n\t\t\t\tvalues: [{ix:undefined, id}]\r\n\t\t\t})\r\n\t\t\tthis.stocksMyBlock.push(stock);\r\n\t\t}\r\n\t}\r\n\r\n\t@observable config: MiConfigs = { \r\n\t\tgroupName: defaultGroupName, \r\n\t\tstockFind: { sortType:'pe' },\r\n\t\tuserStock: { sortType:'tagpe'},\r\n\t\tregression: {bmin:0, bmax:0.5, r2:0.7, lmin:0.01, lmax:0.5, lr2:0.7, mcount:2, lr4: 3, r210:0.6, irate:0.04}\r\n\t};\r\n\t//@observable blackList: any[] = [];\r\n\t//@observable defaultList: any[] = [];\r\n\r\n\r\n\tgetHomeStockGroup() {\r\n\t\tlet name = this.config.groupName;\r\n\t\treturn this.stockGroups.groupFromName(name);\r\n\t}\r\n\r\n\t/*\r\n\tstockFromId(stockId: number): Stock&StockValue {\r\n\t\treturn this.miGroups.stockFromId(stockId);\r\n\t}\r\n\t*/\r\n\r\n\tget findStockConfg(): StockFindConfig {\r\n\t\treturn this.config.stockFind;\r\n\t}\r\n\r\n\tasync load() {\r\n\t\t//await this.loadConfig();\r\n\t\tawait this.loadMarkets();\r\n\t\tawait Promise.all([\r\n\t\t\tthis.miAccounts.load(),\r\n\t\t\tthis.loadMyAll(),\r\n\t\t\tthis.loadGroupIXs(),\r\n\t\t\tthis.miGroups.load(),\r\n\t\t]);\r\n\t}\r\n\r\n\tprivate async loadGroupIXs() {\r\n\t\tlet {yumi} = this;\r\n\t\tlet ret = await yumi.IX<IXBase>({\r\n\t\t\tIX: yumi.UserGroup,\r\n\t\t\tIX1: yumi.GroupStock,\r\n\t\t\tix: undefined,\r\n\t\t});\r\n\t\tthis.groupIXs = ret;\r\n\t}\r\n\r\n\tstockInNGroup(stock:Stock): number {\r\n\t\tlet nGroup = 0;\r\n\t\tlet {groupIXs} = this;\r\n\t\tlet stockId = stock.id;\r\n\t\tfor (let i=0; i<groupIXs.length; i++) {\r\n\t\t\tlet {id} = groupIXs[i];\r\n\t\t\tif (id === stockId) ++nGroup;\r\n\t\t}\r\n\t\treturn nGroup;\r\n\t}\r\n\r\n\tcalcGroupStockCount(groupId: number): number {\r\n\t\tif (!this.groupIXs) return;\r\n\t\tlet count = 0;\r\n\t\tfor (let gs of this.groupIXs) {\r\n\t\t\tlet {ix} = gs;\r\n\t\t\tif (ix === groupId) ++count;\r\n\t\t}\r\n\t\treturn count;\r\n\t}\r\n\r\n\tbuildInGroup(stockId: number): {[groupId:number]:boolean} {\r\n\t\tlet inGroup:{[groupId:number]:boolean} = {};\r\n\t\tfor (let gs of this.groupIXs) {\r\n\t\t\tlet {ix, id} = gs;\r\n\t\t\tif (id === stockId) inGroup[ix] = true;\r\n\t\t}\r\n\t\treturn inGroup;\r\n\t}\r\n\r\n\tasync saveConfig() {\r\n\t\tlet v = JSON.stringify(this.config);\r\n\t\t//await this.miApi.call('t_usersettings$save', [this.user.id, 'config', v]);\r\n\t\tawait this.miNet.t_usersettings$save(v);\r\n\t}\r\n\r\n\tprotected async loadConfig() {\r\n\t\tlet rets = await Promise.all([\r\n\t\t\tthis.miNet.t_usersettings$query(),\r\n\t\t\tthis.stockGroups.load(),\r\n\t\t\tthis.accounts.load(),\r\n\t\t]);\r\n\t\tawait this.stockGroups.init();\r\n\t\tlet r = rets[0];\r\n\t\tif (r !== undefined) {\r\n\t\t\tlet ret = r;\r\n\t\t\tif (ret !== undefined && ret.length > 0) {\r\n\t\t\t\tlet cStr = ret[0].value;\r\n\t\t\t\tlet c = JSON.parse(cStr);\r\n\t\t\t\tif (this.stockGroups) {\r\n\t\t\t\t\tlet name = c.tagName;\r\n\t\t\t\t\tlet group = this.stockGroups.groupFromName(name);\r\n\t\t\t\t\tif (!group) {\r\n\t\t\t\t\t\tgroup = this.stockGroups.groupFromName(defaultGroupName);\r\n\t\t\t\t\t\tif (group) {\r\n\t\t\t\t\t\t\tc.tagName = defaultGroupName;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\tc.tagName = this.stockGroups.group0;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tc.groupName = c.tagName;\r\n\t\t\t\t}\r\n\t\t\t\tthis.config = c;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (this.config.stockFind === undefined) {\r\n\t\t\tthis.config.stockFind = { sortType: 'pe' };\r\n\t\t}\r\n\t\telse {\r\n\t\t\tswitch (this.config.stockFind.selectType) {\r\n\t\t\tcase 'all': break;\r\n\t\t\tcase 'peroe': break;\r\n\t\t\tcase 'pe': break;\r\n\t\t\tcase 'dp': break;\r\n\t\t\tdefault:\r\n\t\t\t\tthis.config.stockFind.selectType = 'all';\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (this.config.userStock === undefined) {\r\n\t\t\tthis.config.userStock = { sortType: 'tagpe' };\r\n\t\t}\r\n\t\tif (this.config.regression === undefined) {\r\n\t\t\tthis.config.regression = {bmin:0, bmax:0.5, r2:0.7, lmin:0.01, lmax:0.5, lr2:0.7, mcount:2, lr4: 3, r210:0.6, irate:0.04};\r\n\t\t}\r\n\t\telse {\r\n\t\t\tif (this.config.regression.r210 === undefined) {\r\n\t\t\t\tthis.config.regression.r210 = 0.6;\r\n\t\t\t}\r\n\t\t\tif (this.config.regression.irate === undefined) {\r\n\t\t\t\tthis.config.regression.irate = 0.04;\r\n\t\t\t}\r\n\t\t}\r\n\t\t/*\r\n\t\tawait Promise.all([\r\n\t\t\tthis.loadBlackList(), \r\n\t\t\tthis.loadDefaultList(),\r\n\t\t]);\r\n\t\t*/\r\n\t}\r\n\r\n\tsetStockSortType = async (type:string)=> {\r\n\t\tif (this.config.stockFind.sortType === type)\r\n\t\t\treturn;\r\n\t\tthis.config.stockFind.sortType = type;\r\n\t\tawait this.saveConfig();\r\n\t}\r\n\r\n\tsetStockSelectType = async (type:string) => {\r\n\t\tif (this.config.stockFind.selectType === type)\r\n\t\t\treturn;\r\n\t\tthis.config.stockFind.selectType = type;\r\n\t\tawait this.saveConfig();\r\n\t}\r\n\r\n\tsetUserSortType = async (type:string)=> {\r\n\t\tif (this.config.userStock.sortType === type) return;\r\n\t\tthis.config.userStock.sortType = type;\r\n\t\tawait this.saveConfig();\r\n\t}\r\n\r\n\tselectTag = async (item:any) => {\r\n\t\tlet {name} = item as {name:string, id:number};\r\n\t\tlet group = this.stockGroups.groupFromName(name);\r\n\t\tif (group) {\r\n\t\t\tthis.config.groupName = name;\r\n\t\t\tthis.saveConfig();\r\n\t\t}\r\n\t}\r\n\r\n\tselectAccount = async (item:any) => {\r\n\t\tlet {name} = item as {name:string, id:number};\r\n\t\tlet account = this.accounts.setCurrentAccount(name);\r\n\t\tif (account) {\r\n\t\t\tthis.config.accountName = name;\r\n\t\t\tthis.saveConfig();\r\n\t\t}\r\n\t}\r\n\r\n\tsetRegressionConfig = async (cfg: RegressionConfig) => {\r\n\t\tthis.config.regression = cfg;\r\n\t\tawait this.saveConfig();\r\n\t}\r\n\r\n\tasync addTagStock(stock: StockType) {\r\n\t\tawait this.stockGroups.defaultGroup.addStock(stock);\r\n\t}\r\n\r\n\tasync removeTagStock(stock: StockType) {\r\n\t\tawait this.stockGroups.defaultGroup.removeStock(stock);\r\n\t}\r\n\r\n\tasync loadExportItems(queryName: string):Promise<any[]> {\r\n\t\t//let sName = this.store.config.stockFind.selectType;\r\n\t\tlet {bmin, bmax, r2, lmin, lmax, lr2, mcount, lr4, r210} = this.config.regression;\r\n\t\t//if (sName !== undefined)\r\n\t\t//  queryName = sName;\r\n\t\tlet query = {\r\n\t\t\tname: queryName,\r\n\t\t\tpageStart: 0,\r\n\t\t\tpageSize: 3000,\r\n\t\t\tuser: this.miNet.userId,\r\n\t\t\tblackID: this.stockGroups.blackGroup.id,\r\n\t\t\tbMin: bmin,\r\n\t\t\tbMax: bmax,\r\n\t\t\tr2: r2,\r\n\t\t\tlMin: lmin,\r\n\t\t\tlMax: lmax,\r\n\t\t\tlr2: lr2,\r\n\t\t\tmcount: mcount,\r\n\t\t\tlr4: lr4,\r\n\t\t\tr210: r210,\r\n\t\t};\r\n\t\tlet rets = await Promise.all([\r\n\t\t\tthis.miNet.process(query, []),\r\n\t\t\t//this.store.miApi.call('q_getlasttradeday', [])\r\n\t\t\tthis.miNet.q_getlasttradeday(),\r\n\t\t]);\r\n\t\treturn rets;\r\n\t}\r\n}\r\n","import * as React from 'react';\r\nimport { IObservableArray, computed } from 'mobx';\r\nimport { PageItems } from '../../tool/pageItems';\r\nimport {List} from './index';\r\n\r\nexport abstract class ListBase {\r\n    protected list: List;\r\n    constructor(list: List) {\r\n        this.list = list;\r\n    }\r\n    get isPaged():boolean {\r\n        let items = this.list.props.items;\r\n        return (items !== null && items !== undefined && Array.isArray(items) === false);\r\n    }\r\n    get items():any[]|IObservableArray<any> {\r\n        let items = this.list.props.items;\r\n        if (items === null) return null;\r\n        if (items === undefined) return undefined;\r\n        if (Array.isArray(items) === true)\r\n            return items as IObservableArray<any>;\r\n        else\r\n            return (items as PageItems<any>).items;\r\n    }\r\n    @computed get loading():boolean {\r\n        let items = this.list.props.items;\r\n        if (items === null) return false;\r\n        if (items === undefined) return true;\r\n        let pageItems = items as PageItems<any>;\r\n        if (pageItems.items === undefined) return false;\r\n        return pageItems.loading;\r\n    }\r\n    get selectedItems():any[] { return undefined; }\r\n    //updateProps(nextProps:any) {}\r\n    dispose() {};\r\n    abstract render: (item:any, index:number) => JSX.Element;\r\n    protected renderContent(item:any, index:number) {\r\n        let {render} = this.list.props.item;\r\n        if (render === undefined) return <div className=\"px-3 py-2\">{JSON.stringify(item)}</div>;\r\n        return render(item, index);\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport classNames from 'classnames';\r\nimport {ListBase} from './base';\r\n\r\nexport class Clickable extends ListBase {\r\n    render = (item:any, index:number):JSX.Element => {\r\n        let {className, key, onClick} = this.list.props.item;\r\n        return <li key={key===undefined?index:key(item)} className={classNames('va-row-clickable', className)} onClick={()=>onClick && onClick(item)}>\r\n            {this.renderContent(item, index)}\r\n        </li>\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport classNames from 'classnames';\r\nimport { ListBase } from './base';\r\nimport { uid } from '../../tool/uid';\r\n\r\nexport class Static extends ListBase {\r\n    render = (item:any, index:number):JSX.Element => {\r\n        let {className, key} = this.list.props.item;\r\n        if (typeof item === 'string') {\r\n            let cn = classNames('va-list-gap', 'px-3', 'pt-1');\r\n            return <li key={uid()} className={cn}>{item}</li>;\r\n        }\r\n        return <li key={key===undefined?index:key(item)} className={classNames(className)}>\r\n            {this.renderContent(item, index)}\r\n        </li>\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport {observable, IObservableArray, isObservableArray, observe, makeObservable} from 'mobx';\r\nimport classNames from 'classnames';\r\nimport {ListBase} from './base';\r\nimport {uid} from '../../tool/uid';\r\nimport { PageItems } from '../../tool/pageItems';\r\nimport { List } from './index';\r\nimport { observer } from 'mobx-react';\r\n\r\nexport interface SelectableItem {\r\n    selected: boolean;\r\n    item: any;\r\n    labelId: string;\r\n}\r\n\r\nexport class Selectable extends ListBase {\r\n    _items: SelectableItem[] = null;\r\n    private inputItems:{[uid:string]: HTMLInputElement} = {};\r\n\r\n    constructor(list: List) {\r\n\t\tsuper(list);\r\n\t\tmakeObservable(this, {\r\n\t\t\t_items: observable\r\n\t\t})\r\n        this.buildItems();\r\n        this.listenArraySplice();\r\n    }    \r\n\r\n    private listenArraySplice() {\r\n        let {items} = this.list.props;\r\n        if (items === undefined) return;\r\n        if (items === null) return;\r\n        let itemsArray:any;\r\n        if (Array.isArray(items) === true) {\r\n            itemsArray = items as any;\r\n        }\r\n        else {\r\n            itemsArray = (items as PageItems<any>).items;\r\n        }\r\n        if (isObservableArray(items) === true) {\r\n            observe(itemsArray as IObservableArray<any>, (change) => {                \r\n                if (change.type === 'splice') {\r\n                    let {index, removedCount, added} = change;\r\n                    let _added = added && added.map(v => {\r\n                        return {\r\n                            selected: false, \r\n                            item: v, \r\n                            labelId:uid()\r\n                        }\r\n                    });\r\n                    this._items.splice(index, removedCount, ..._added);\r\n                    this.buildItems();\r\n                }\r\n            }, true);\r\n        }\r\n    }\r\n\r\n    private buildItems = () => {\r\n        let {items, isItemSelected, selectedItems, compare} = this.list.props;\r\n        let itemsArray:any[] | IObservableArray<any>;\r\n        if (items === undefined) {\r\n            this._items = undefined;\r\n            return;\r\n        }\r\n        if (items === null) {\r\n            this._items = null;\r\n            return;\r\n        }\r\n        \r\n        if (Array.isArray(items) === true) {\r\n            itemsArray = items as any;\r\n        }\r\n        else {\r\n            itemsArray = (items as PageItems<any>).items;\r\n        }\r\n\r\n\t\tif (isItemSelected) {\r\n\t\t\tlet retItems = itemsArray.map(v => {\r\n\t\t\t\treturn {\r\n\t\t\t\t\tselected: isItemSelected(v),\r\n\t\t\t\t\titem: v, \r\n\t\t\t\t\tlabelId:uid()\r\n\t\t\t\t};\r\n\t\t\t});\r\n\t\t\tthis._items = retItems;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tlet comp: ((item:any, selectItem:any)=>boolean);\r\n\t\t\tif (compare === undefined) {\r\n\t\t\t\tcomp = (item:any, selectItem:any) => item === selectItem;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tcomp = compare;\r\n\t\t\t}\r\n\t\t\tlet retItems = itemsArray.map(v => {\r\n\t\t\t\t//let isObserved = isObservable(v);\r\n\t\t\t\t//let obj = isObserved === true? toJS(v) : v;\r\n\t\t\t\t//let obj = v;\r\n\t\t\t\tlet selected = selectedItems === undefined?\r\n\t\t\t\t\tfalse\r\n\t\t\t\t\t: selectedItems.find(si => comp(v, si)) !== undefined;\r\n\t\t\t\treturn {\r\n\t\t\t\t\tselected: selected, \r\n\t\t\t\t\titem: v, \r\n\t\t\t\t\tlabelId:uid()\r\n\t\t\t\t};\r\n\t\t\t});\r\n\t\t\tthis._items = retItems;\r\n\t\t}\r\n    }\r\n\r\n    get items() {\r\n        //if (this._items === undefined) \r\n        //this.buildItems();\r\n        return this._items;\r\n    }\r\n    private checkAll(on: boolean) {\r\n        for (let i in this.inputItems) this.inputItems[i].checked = on;\r\n        for (let item of this._items) item.selected = on;\r\n    }\r\n    selectAll() {\r\n        //if (this._items) this._items.forEach(v => v.selected = true);\r\n        this.checkAll(true);\r\n        this.list.props.item.onSelect(undefined, true, this.anySelected);\r\n    }\r\n    unselectAll() {\r\n        this.checkAll(false);\r\n        this.list.props.item.onSelect(undefined, false, this.anySelected);\r\n    }\r\n\r\n\tprivate get anySelected():boolean {return this._items.some(v => v.selected)}\r\n    private onSelect(item:SelectableItem, selected:boolean) {\r\n        item.selected = selected;\r\n        this.list.props.item.onSelect(item.item, selected, this.anySelected);\r\n    }\r\n    \r\n    get selectedItems():any[] {\r\n        return this._items.filter(v => v.selected === true).map(v => v.item);\r\n    }\r\n\r\n\trender = (item:SelectableItem, index:number):JSX.Element => {\r\n        let {key} = this.list.props.item;\r\n\t\treturn React.createElement(this.row, {item, index, key:key===undefined?index:key(item)});\r\n    }\r\n\r\n    private row = observer((props: {item:SelectableItem, index:number}):JSX.Element => {\r\n        let {item, index} = props;\r\n        let {className} = this.list.props.item;\r\n        let {labelId, selected, item:obItem} = item;\r\n        return <li className={classNames(className)}>\r\n            <div className=\"d-flex align-items-center px-3\">\r\n                <input ref={input=>{if (input) this.inputItems[labelId] = input;}}\r\n                    className=\"\" type=\"checkbox\" value=\"\" id={labelId}\r\n                    defaultChecked={selected}\r\n                    onChange={(e)=>{\r\n                        this.onSelect(item, e.target.checked)} \r\n                    }/>\r\n                <label className=\"\" style={{flex:1, marginBottom:0}} htmlFor={labelId}>\r\n                    {this.renderContent(obItem, index)}\r\n                </label>\r\n            </div>\r\n        </li>\r\n    })\r\n}\r\n","import * as React from 'react';\r\nimport classNames from 'classnames';\r\nimport {observer} from 'mobx-react';\r\nimport _ from 'lodash';\r\nimport {PageItems} from '../../tool/pageItems';\r\nimport {ListBase} from './base';\r\nimport {Clickable} from './clickable';\r\nimport {Static} from './static';\r\nimport {Selectable} from './selectable';\r\nimport '../../css/va-list.css';\r\nimport { IObservableArray } from 'mobx';\r\nimport { resLang } from '../../res/res';\r\nimport { ListRes, listRes } from '../../res';\r\n\r\ntype StaticRow = string|JSX.Element|(()=>string|JSX.Element);\r\ninterface ItemProps {\r\n\tclassName?: string|string[];\r\n\trender?: (item:any, index:number) => JSX.Element;\r\n\tonSelect?: (item:any, isSelected:boolean, anySelected:boolean)=>void;\r\n\tonClick?: (item:any)=>void;\r\n\tkey?: (item:any)=>string|number;\r\n}\r\n\r\nexport interface ListProps {\r\n    className?: string|string[];\r\n    items: any[] | IObservableArray<any> | PageItems<any>;\r\n    item: ItemProps;\r\n\tisItemSelected?: (item:any) => boolean;\r\n    compare?: (item:any, selectItem:any) => boolean;\r\n\tselectedItems?:any[];\r\n    header?: StaticRow;\r\n    footer?: StaticRow;\r\n    before?: StaticRow;\r\n    loading?: StaticRow;\r\n\tnone?: StaticRow;\r\n\tonFocus?: (evt: React.FocusEvent<HTMLUListElement>)=>void;\r\n}\r\n\r\n@observer\r\nexport class List extends React.Component<ListProps> {\r\n\tprivate static res:ListRes = resLang<ListRes>(listRes);\r\n\r\n\tprivate listBase: ListBase;\r\n\tprivate selectable: Selectable;\r\n    constructor(props:ListProps) {\r\n\t\tsuper(props);\r\n        this.buildBase();\r\n    }\r\n    _$scroll = (direct: 'top'|'bottom') => {\r\n        console.log('############### items scroll to ' + direct);\r\n    }\r\n    private buildBase() {\r\n        let {item} = this.props;\r\n        let {onClick, onSelect} = item;\r\n        if (onSelect !== undefined)\r\n            this.selectable = this.listBase = new Selectable(this);\r\n        else if (onClick !== undefined)\r\n            this.listBase = new Clickable(this);\r\n        else\r\n            this.listBase = new Static(this);\r\n\t}\r\n\tcomponentDidUpdate(prevProps: Readonly<ListProps>, prevState: Readonly<any>) {\r\n\t\tif (_.isEqual(this.props.item, prevProps.item) === false) {\r\n\t\t\tthis.buildBase();\r\n\t\t\tthis.forceUpdate();\r\n\t\t}\r\n\t}\r\n    componentWillUnmount() {\r\n        this.listBase.dispose();\r\n    }\r\n    selectAll() {\r\n        if (this.selectable) this.selectable.selectAll();\r\n    }\r\n    unselectAll() {\r\n        if (this.selectable) this.selectable.unselectAll();\r\n    }\r\n    get selectedItems():any[] {\r\n        return this.listBase.selectedItems;\r\n    }\r\n    render() {\r\n        let {className, header, footer, before, loading, none, onFocus} = this.props;\r\n        if (before === undefined) before = '-';\r\n        if (loading === undefined) loading = () => <i className=\"fa fa-spinner fa-spin fa-2x fa-fw text-info\" />;\r\n        if (none === undefined) none = List.res.none;\r\n        let {items, loading:isLoading} = this.listBase;\r\n        function staticRow(row:StaticRow, type:string) {\r\n            if (!row) return;\r\n            switch (typeof row) {\r\n                default:\r\n                case 'string': return <li className={\"va-list-\"+type}>{row}</li>;\r\n                case 'function': return <li className={\"va-list-\"+type}>{(row as ()=>string|JSX.Element)()}</li>;\r\n                case 'object': return <li>{row}</li>\r\n            } \r\n        }\r\n        let content:any, waitingMore:any;\r\n        if (items === null)\r\n            content = staticRow(before, 'before');\r\n        else if (items === undefined)\r\n            content = staticRow(loading, 'loading');\r\n        else if (items.length === 0)\r\n            content = staticRow(none, 'none');\r\n        else {\r\n            content = items.map((item, index) => {\r\n                return this.listBase.render(item, index);\r\n            });\r\n        }\r\n        if (isLoading === true && items) {\r\n            waitingMore = staticRow(loading, 'loading');\r\n\t\t}\r\n\t\tlet tabIndex:number;\r\n\t\tif (onFocus !== undefined) tabIndex = -1;\r\n        return <ul className={classNames('va-list', className)} onFocus={onFocus} tabIndex={tabIndex}>\r\n            {staticRow(header, 'header')}\r\n            {content}\r\n            {waitingMore}\r\n            {staticRow(footer, 'footer')}\r\n        </ul>;\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport className from 'classnames';\r\nimport {PropGridProps} from './PropGrid';\r\nimport {LabeledProp, StringProp, NumberProp, ListProp, ComponentProp} from './propView';\r\n\r\nexport abstract class PropRow {\r\n    setValues(values: any) {}\r\n    abstract render(key:string): any;\r\n}\r\n\r\nexport class PropBorder extends PropRow {\r\n    render(key:string): JSX.Element {\r\n        return <div key={'_b_' + key} className=\"\">\r\n            <div className=\"w-100\">\r\n                <div style={{borderTop: '1px solid #f0f0f0'}} />\r\n            </div>\r\n        </div>;\r\n    }\r\n}\r\n\r\nexport class PropGap extends PropRow {\r\n    private param: string;\r\n    constructor(param?: string) {\r\n        super();\r\n        this.param = param;\r\n    }\r\n    render(key:string): JSX.Element {\r\n        let w: string;\r\n        switch (this.param) {\r\n            default: w = 'py-2'; break;\r\n            case '=': w = 'py-1'; break;\r\n            case '-': w = 'pb-1'; break;\r\n        }\r\n        let cn = className(w);\r\n        return <div key={'_g_' + key} className={cn} />;\r\n    }\r\n}\r\n\r\nconst valueAlignStart = 'justify-content-start';\r\nconst valueAlignCenter = 'justify-content-center';\r\nconst valueAlignEnd = 'justify-content-end';\r\nexport abstract class LabeledPropRow extends PropRow {\r\n    protected gridProps: PropGridProps;\r\n    protected _prop: LabeledProp;\r\n    protected get prop():LabeledProp {return this._prop}\r\n    protected content: any;\r\n    protected col: string;\r\n    //protected values: any;\r\n    constructor(gridProps:PropGridProps, prop: LabeledProp) {\r\n        super();\r\n        this.gridProps = gridProps;\r\n        this._prop = prop;\r\n        this.col = gridProps.labelFixLeft === true? 'col' : 'col-sm';\r\n        //this.values = values;\r\n    }\r\n    render(key:string):any {\r\n        let {onClick, bk} = this.prop;\r\n        let cn = className({\r\n            \"cursor-pointer\": onClick !== undefined,\r\n            \"bg-white\": bk === undefined, \r\n            \"row\": true\r\n        });\r\n        return <div key={key} className={cn} onClick={onClick}>\r\n            {this.renderLabel()}\r\n            {this.renderProp()}\r\n        </div>;\r\n    }\r\n    protected renderLabel():any {\r\n        let {label} = this.prop;\r\n        if (label === undefined) return null;\r\n        return <label className={this.col + '-3 col-form-label'}>\r\n            {label}\r\n        </label>;\r\n    }\r\n    protected renderProp():any {\r\n        let {label} = this.prop;\r\n        let align, vAlign;\r\n        switch (this.gridProps.alignValue) {\r\n            case 'left': align = valueAlignStart; break;\r\n            case 'center': align = valueAlignCenter; break;\r\n            case 'right': align = valueAlignEnd; break;\r\n        }\r\n        switch (this.prop.vAlign) {\r\n            case 'top': vAlign = 'align-items-start'; break;\r\n            default:\r\n            case 'center': vAlign = 'align-items-center'; break;\r\n            case 'bottom': vAlign = 'align-items-end'; break;\r\n            case 'stretch': vAlign = 'align-items-stretch'; break;\r\n        }\r\n        let col:string = this.col + (label===undefined? '-12':'-9');\r\n        let cn = className(align, vAlign, col, 'd-flex');\r\n        return <div className={cn}>\r\n            {this.renderPropBody()}\r\n        </div>;\r\n    }\r\n    protected renderPropBody():any {\r\n        return <div className=\"form-control-plaintext\">\r\n            {this.renderPropContent()}\r\n        </div>;\r\n    }\r\n    protected renderPropContent():any {\r\n        return this.content;\r\n    }\r\n}\r\n\r\nexport class StringPropRow extends LabeledPropRow {\r\n    protected get prop(): StringProp {return this._prop as StringProp;}\r\n    setValues(values:any) {\r\n        if (values === undefined) this.content = undefined;\r\n        else this.content = values[this.prop.name];\r\n    }\r\n}\r\n\r\nexport class NumberPropRow extends LabeledPropRow {\r\n    protected get prop(): NumberProp {return this._prop as NumberProp;}\r\n    setValues(values:any) {\r\n        if (values === undefined) this.content = undefined;\r\n        else this.content = values[this.prop.name];\r\n    }\r\n}\r\n\r\nexport class ListPropRow extends LabeledPropRow {\r\n    protected get prop(): ListProp {return this._prop as ListProp;}\r\n    setValues(values:any) {\r\n        if (values === undefined) this.content = undefined;\r\n        else {\r\n            let list = this.prop.list;\r\n            if (typeof list === 'string') this.content = values[list];\r\n            else this.content = undefined;\r\n        }\r\n    }\r\n    protected renderPropBody() {\r\n        let {list, row} = this.prop;\r\n        let items:any[] = typeof list === 'string'? this.content : list;\r\n        if (items === undefined) return <div/>;\r\n        // new row(item)\r\n        return <div className=\"w-100\">\r\n            {\r\n                items.map((item, index) => <React.Fragment key={index}>\r\n                    {index===0? null: <div style={{width:'100%', borderBottom:'1px solid #f0f0f0'}} />}\r\n                    {React.createElement(row, item)}\r\n                </React.Fragment>)\r\n            }\r\n        </div>;\r\n    }\r\n}\r\n\r\nexport class ComponentPropRow extends LabeledPropRow {\r\n    protected get prop(): ComponentProp {return this._prop as ComponentProp;}\r\n    protected renderPropBody() {\r\n        let {component} = this.prop;\r\n        return component;\r\n    }\r\n    protected renderProp():any {\r\n        let {label, full} = this.prop;\r\n        let align, vAlign;\r\n        switch (this.gridProps.alignValue) {\r\n            case 'left': align = valueAlignStart; break;\r\n            case 'center': align = valueAlignCenter; break;\r\n            case 'right': align = valueAlignEnd; break;\r\n        }\r\n        switch (this.prop.vAlign) {\r\n            case 'top': vAlign = 'align-items-start'; break;\r\n            default:\r\n            case 'center': vAlign = 'align-items-center'; break;\r\n            case 'bottom': vAlign = 'align-items-end'; break;\r\n            case 'stretch': vAlign = 'align-items-stretch'; break;\r\n        }\r\n        let col:string;\r\n        if (full !== true)\r\n            col = this.col + (label===undefined? '-12':'-9');\r\n        else\r\n            col = 'w-100';\r\n        let cn = className(align, vAlign, col, 'd-flex');\r\n        return <div className={cn}>\r\n            {this.renderPropBody()}\r\n        </div>;\r\n    }\r\n}\r\n","import { PropGridProps } from './PropGrid';\r\nimport {\r\n    PropRow, PropBorder, PropGap, \r\n    StringPropRow, NumberPropRow, ListPropRow, ComponentPropRow\r\n} from './row';\r\n\r\nexport interface Format {\r\n\r\n}\r\n\r\nexport interface PropBase {\r\n    onClick?: () => void;\r\n}\r\n\r\nexport interface LabeledProp extends PropBase {\r\n    label?: string;\r\n    bk?: string;\r\n    vAlign?: 'top' | 'bottom' | 'center' | 'stretch';\r\n}\r\n\r\nexport interface StringProp extends LabeledProp {\r\n    type: 'string';\r\n    name: string;\r\n}\r\n\r\nexport interface NumberProp extends LabeledProp {\r\n    type: 'number';\r\n    name: string;\r\n\tisInt: boolean;\t\t// 整数\r\n\ttime: boolean;\t\t// 字段log的time可以客户端输入\r\n}\r\n\r\nexport interface FormatProp extends LabeledProp {\r\n    type: 'format';\r\n    format: Format;\r\n}\r\n\r\nexport interface ListProp extends LabeledProp {\r\n    type: 'list';\r\n    list: string | any[];  // string 表示名字，否则就是值\r\n    row: new (props: any) => React.Component;\r\n}\r\n\r\nexport interface ComponentProp extends LabeledProp {\r\n    type: 'component';\r\n    full?: boolean;\r\n    component: any; //JSX.Element;\r\n}\r\n\r\nexport type Prop = StringProp | NumberProp | FormatProp | ListProp | ComponentProp | string;\r\n\r\nexport class PropView {\r\n    private gridProps: PropGridProps\r\n    private props: Prop[];\r\n    //private values:any;\r\n    private rows: PropRow[];\r\n\r\n    constructor(gridProps: PropGridProps, props: Prop[]) {\r\n        this.gridProps = gridProps;\r\n        this.props = props;\r\n        //this.values = values;\r\n        this.buildRows();\r\n    }\r\n\r\n    private buildRows() {\r\n        this.rows = [];\r\n        let isGap: boolean = true;\r\n        for (let prop of this.props) {\r\n            if (typeof prop === 'string') {\r\n                this.rows.push(new PropGap(prop));\r\n                isGap = true;\r\n            }\r\n            else {\r\n                if (!isGap) this.rows.push(new PropBorder());\r\n                let row;\r\n                switch (prop.type) {\r\n                    default: continue;\r\n                    case 'string': row = new StringPropRow(this.gridProps, prop); break;\r\n                    case 'number': row = new NumberPropRow(this.gridProps, prop); break;\r\n                    case 'list': row = new ListPropRow(this.gridProps, prop); break;\r\n                    case 'component': row = new ComponentPropRow(this.gridProps, prop); break;\r\n                }\r\n                this.rows.push(row);\r\n                isGap = false;\r\n            }\r\n        }\r\n    }\r\n\r\n    setValues(values: any) {\r\n        for (let r of this.rows) r.setValues(values);\r\n    }\r\n\r\n    render() {\r\n        return this.rows.map((row, index) => row.render(String(index)));\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport classNames from 'classnames';\r\nimport {observer} from 'mobx-react';\r\nimport {Prop, PropView} from './propView';\r\n\r\nexport interface PropGridProps {\r\n    className?: string;\r\n    rows: Prop[];\r\n    values: any;\r\n    alignValue?: 'left'|'center'|'right';\r\n    labelFixLeft?: boolean;\r\n}\r\n\r\n@observer\r\nexport class PropGrid extends React.Component<PropGridProps> {\r\n    render() {\r\n        let {className, rows, values} = this.props;\r\n        let propView = new PropView(this.props, rows);\r\n        propView.setValues(values);\r\n        let cn = classNames('container-fluid', className);\r\n        return <div className={cn}>\r\n            {propView.render()}\r\n        </div>;\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport { observable } from 'mobx';\r\nimport { Page, ItemSchema, UiSchema, StringSchema, UiTextItem, Edit, ImageSchema, nav, UiImageItem } from '../components';\r\nimport { userApi } from '../net';\r\n\r\nexport class EditMeInfo extends React.Component {\r\n    private schema:ItemSchema[] = [\r\n        {name:'nick', type:'string'} as StringSchema,\r\n        {name:'icon', type:'image'} as ImageSchema\r\n    ];\r\n    private uiSchema:UiSchema = {\r\n        items: {\r\n            nick: {widget:'text', label:'别名', placeholder:'好的别名更方便记忆'} as UiTextItem,\r\n            icon: {widget:'image', label:'头像'} as UiImageItem,\r\n        }\r\n    }\r\n    @observable private data:any;\r\n\r\n    constructor(props:any) {\r\n        super(props);\r\n        let {nick, icon} = nav.user;\r\n        this.data = {\r\n            nick: nick,\r\n            icon: icon,\r\n        }\r\n    }\r\n\r\n    private onItemChanged = async (itemSchema:ItemSchema, newValue:any, preValue:any) => {\r\n        let {name} = itemSchema;        \r\n        await userApi.userSetProp(name, newValue);\r\n        this.data[name] = newValue;\r\n        let user:any = nav.user;\r\n        user[name] = newValue;\r\n        nav.saveLocalUser();\r\n    }\r\n\r\n    render() {\r\n        return <Page header=\"个人信息\">\r\n            <Edit schema={this.schema} uiSchema={this.uiSchema}\r\n                data={this.data}\r\n                onItemChanged={this.onItemChanged} />\r\n        </Page>;\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport { observer } from 'mobx-react-lite';\r\nimport { VPage, Page, FA, List, Form, ItemSchema, StringSchema, UiInputItem, UiSchema, Context, IdSchema, UiIdItem, LMR } from 'tonva-react';\r\nimport { CStockInfo } from './CStockInfo';\r\nimport { defaultBlackListGroupName, defaultGroupName } from '../consts';\r\n\r\nexport class VTags extends VPage<CStockInfo> {\r\n\tasync open(param?: any) {\r\n\t\tthis.openPage(this.page);\r\n\t}\r\n\r\n\tprivate onSelect = (item: any, isSelected: boolean, anySelected: boolean) => {\r\n\t\tthis.controller.onClickSelectTag(item, isSelected);\r\n\t}\r\n\r\n\tprivate onEditTag = (tag:any, e:React.MouseEvent) => {\r\n\t\te.preventDefault();\r\n\t\tthis.controller.onEditTag(tag);\r\n\t}\r\n\r\n\tprivate renderTag = (tag: any) => {\r\n\t\tlet left = <div className=\"px-3 py-2 cursor-pointer\">{tag.name}</div>;\r\n\t\tlet fdTag = tag.name === defaultBlackListGroupName || tag.name === defaultGroupName;\r\n\t\tlet right = fdTag ? '' : <div className=\"px-3 py-2 cursor-pointer\" onClick={(e)=>this.onEditTag(tag, e)}>编辑</div>;\r\n\t\treturn <LMR className=\"mx-3 my-2\" left={left} right={right}>\r\n\t\t</LMR>;\r\n\t}\r\n\r\n\tprivate page = observer(() => {\r\n\t\tlet { selectedTags } = this.controller;\r\n\t\tlet { stockGroups } = this.controller.cApp.store;\r\n\t\tlet { groups } = stockGroups;\r\n\t\tlet divNewTag = groups.length >= 10 ?\r\n\t\t\t''\r\n\t\t\t:\r\n\t\t\t<div className=\"px-3 py-2 cursor-pointer\" onClick={this.controller.onNewTag}>\r\n\t\t\t\t<FA name=\"plus\" className=\"text-primary\" />\r\n\t\t\t\t&nbsp; 新建分组\r\n\t\t\t</div>;\r\n\r\n\t\treturn <Page header=\"选择分组\" headerClassName=\"bg-primary\">\r\n\t\t\t{divNewTag}\r\n\t\t\t<List items={groups} \r\n\t\t\t\titem={{ onSelect: this.onSelect, render: this.renderTag }} \r\n\t\t\t\tselectedItems={selectedTags} />\r\n\t\t</Page>;\r\n\t});\r\n}\r\n\r\nconst schema: ItemSchema[] = [\r\n\t{ name: 'name', type: 'string', required: true, maxLength: 10 } as StringSchema,\r\n\t{ name: 'id', type: 'id' } as IdSchema,\r\n\t{ name: 'submit', type: 'submit', },\r\n];\r\nconst uiSchema: UiSchema = {\r\n\titems: {\r\n\t\tname: { widget: 'text', label: null, placeholder: '分组名称' } as UiInputItem,\r\n\t\tid: { widget: 'id', visible: false } as UiIdItem,\r\n\t\tsubmit: { widget: 'button', label: '保存', className: 'btn btn-primary' },\r\n\t}\r\n};\r\n\r\nexport class VNewTag extends VPage<CStockInfo> {\r\n\tasync open(param?: any) {\r\n\t\tthis.openPage(this.page);\r\n\t}\r\n\r\n\tprivate onFormButtonClick = async (name: string, context: Context) => {\r\n\t\tif (await this.controller.onSaveNewTag(context.data)) {\r\n\t\t\tthis.controller.closePage();\r\n\t\t}\r\n\t}\r\n\r\n\tprivate page = () => {\r\n\t\treturn <Page header=\"新建分组\" headerClassName=\"bg-primary\">\r\n\t\t\t<div className=\"px-3 py-3\">\r\n\t\t\t\t<Form schema={schema}\r\n\t\t\t\tuiSchema={uiSchema}\r\n\t\t\t\tformData={undefined}\r\n\t\t\t\tonButtonClick={this.onFormButtonClick}\r\n\t\t\t\t/>\r\n\t\t\t</div>\r\n\t\t\t</Page>;\r\n\t\t}\r\n\t}\r\n\r\nexport class VEditTag extends VPage<CStockInfo> {\r\n\tasync open(param?: any) {\r\n\t\tthis.openPage(this.page, param);\r\n\t}\r\n\r\n\tprivate onFormButtonClick = async (name: string, context: Context) => {\r\n\t\tif (await this.controller.onSaveTag(context.data)) {\r\n\t\t\tthis.controller.closePage();\r\n\t\t}\r\n\t}\r\n\r\n\tprivate page = (param?: any) => {\r\n\t\tlet {id, name} = param;\r\n\t\tlet fData = {id:id, name:name};\r\n\t\treturn <Page header=\"编辑分组\" headerClassName=\"bg-primary\">\r\n\t\t\t<div className=\"px-3 py-3\">\r\n\t\t\t\t<Form schema={schema}\r\n\t\t\t\tuiSchema={uiSchema}\r\n\t\t\t\tformData={fData}\r\n\t\t\t\tonButtonClick={this.onFormButtonClick}\r\n\t\t\t\t/>\r\n\t\t\t</div>\r\n\t\t</Page>;\r\n\t}\r\n}\r\n","/*eslint @typescript-eslint/no-unused-vars: [\"off\", { \"vars\": \"all\" }]*/\r\nimport { observable, IObservableArray, computed, makeObservable } from 'mobx';\r\nimport { nav } from 'tonva-react';\r\nimport { CUqBase } from \"../uq-app\";\r\nimport { GFunc } from '../tool/GFunc';\r\nimport { VStockInfo } from './VStockInfo'\r\nimport { NStockInfo, StockPrice, StockCapitalearning, StockBonus, StockDivideInfo } from './StockInfoType';\r\nimport { VTags, VNewTag, VEditTag } from './VTags';\r\nimport { ErForEarning, SlrForEarning } from 'regression';\r\nimport { StockGroup } from '../store';\r\nimport { CSelectStock } from '../selectStock';\r\nimport { Stock, StockValue } from 'uq-app/uqs/BruceYuMi';\r\n\r\nexport class CStockInfo extends CUqBase {\r\n\tstock: Stock & StockValue;\r\n    @observable baseItem: NStockInfo;\r\n    @observable protected loaded: boolean = false;\r\n\r\n    @observable price: StockPrice;\r\n    //@observable roe: StockRoe;\r\n    //@observable tags: any[] = undefined;\r\n    @observable stockTags: any[];\r\n    selectedTags: any[];\r\n\r\n    protected exrightForEarning: { day: number, factor: number }[] = [];\r\n    protected exrightInfo: { day: number, bonus: number, factor: number, factore: number }[] = [];\r\n    @observable seasonData: { season: number, c: number, e: number, esum: number, corg: number, eorg: number, esumorg: number }[] = [];\r\n    @observable predictSeasonData: { season: number, c: number, e: number, esum: number, corg: number, eorg: number, esumorg: number }[] = [];\r\n    @observable predictSeasonDataFull: { season: number, c: number, e: number, esum: number, corg: number, eorg: number, esumorg: number }[] = [];\r\n    @observable predictData: { e: number, b: number, r2: number, epre: number, l: number, lr2: number, lpre: number };\r\n    @observable ypredict: number[] = [];\r\n    // @observable historyData:{day:number, price:number, ttm:number}[] =  [];\r\n    // protected historyDataOrg:{day:number, price:number, dayno:number}[] = [];\r\n\r\n    //protected _earning: IObservableArray<StockEarning> = observable.array<StockEarning>([], { deep: true });\r\n    protected _capitalearning: IObservableArray<StockCapitalearning> = observable.array<StockCapitalearning>([], { deep: true });\r\n    protected _bonus: IObservableArray<StockBonus> = observable.array<StockBonus>([], { deep: true });\r\n    protected _divideInfo: IObservableArray<StockDivideInfo> = observable.array<StockDivideInfo>([], { deep: true });\r\n\r\n    @computed get capitalearning(): IObservableArray<StockCapitalearning> {\r\n        if (this.loaded === false) return undefined;\r\n        return this._capitalearning;\r\n    }\r\n\r\n    @computed get bonus(): IObservableArray<StockBonus> {\r\n        if (this.loaded === false) return undefined;\r\n        return this._bonus;\r\n    }\r\n\r\n    @computed get divideInfo(): IObservableArray<StockDivideInfo> {\r\n        if (this.loaded === false) return undefined;\r\n        return this._divideInfo;\r\n    }\r\n\r\n    //@observable isMySelect: boolean = false;\r\n\r\n    constructor(cApp: any) {\r\n        super(cApp);\r\n        makeObservable(this);\r\n    }\r\n    initLoad = () => {\r\n        this.load();\r\n    }\r\n\r\n    private load = async () => {\r\n        if (!this.baseItem) return;\r\n\r\n        let { id, day,  } = this.baseItem;\r\n        let rets = await Promise.all([\r\n            this.cApp.miNet.q_stockallinfo(id, day),\r\n            this.cApp.miNet.t_tagstock$query(undefined, id),\r\n        ]);\r\n        this.stockTags = rets[1];\r\n        let ret = rets[0];\r\n        if (Array.isArray(ret[0])) {\r\n            let arr1 = ret[1];\r\n            if (Array.isArray(arr1)) {\r\n                this.price = arr1[0];\r\n            }\r\n\r\n            this._bonus.clear();\r\n            this._divideInfo.clear();\r\n            this._capitalearning.clear();\r\n            let arr3 = ret[3];\r\n            if (Array.isArray(arr3)) {\r\n                this._divideInfo.push(...arr3);\r\n                let barr = arr3.filter((v: any) =>　{\r\n                    return v.派息 as number > 0;\r\n                }).map((v: any) => {\r\n                    return {day:v.day, bonus:v.派息};\r\n                })\r\n                this._bonus.push(...barr);\r\n            }\r\n\r\n            await this.loadTTMEarning(ret[2]);\r\n        }\r\n\r\n        //this.isMySelect = this.cApp.store.isMyAll(this.stock);\r\n        this.loaded = true;\r\n    }\r\n\r\n    protected async loadTTMEarning(list: { seasonno: number, capital: number, earning: number, es: number, shares: number }[]) {\r\n        this.seasonData.splice(0);\r\n        let seasonlist: { [index: number]: { season: number, c: number, e: number, esum: number, corg: number, eorg: number, esumorg: number } } = {};\r\n        let len = list.length;\r\n        if (len <= 0) return;\r\n        let minNo = list[len - 1].seasonno;\r\n        let lastItem = list[0];\r\n        let lastShares = lastItem.shares;\r\n        let maxNo = lastItem.seasonno;\r\n\r\n        for (let item of list) {\r\n            let no = item.seasonno;\r\n            let sItem = {\r\n                season: no, c: item.capital * item.shares / lastShares, e: item.es * item.shares / lastShares, esum: item.earning * item.shares / lastShares,\r\n                corg: item.capital, eorg: item.es, esumorg: item.earning\r\n            }\r\n            seasonlist[no] = sItem;\r\n\r\n            let yearmonth = GFunc.GetSeasonnoYearMonth(no);\r\n            if (yearmonth.month === 12) {\r\n                let ci = {year: yearmonth.year, capital: item.capital, earning: item.earning };\r\n                this._capitalearning.push(ci);\r\n            }\r\n        }\r\n\r\n        let i = 0;\r\n        for (let seasonno = minNo; seasonno <= maxNo; ++seasonno, ++i) {\r\n            let si = seasonlist[seasonno];\r\n            if (si === undefined) {\r\n                continue;\r\n            }\r\n            this.seasonData.splice(0, 0, si);\r\n        }\r\n\r\n        let noBegin = maxNo - 19;\r\n        this.predictData = undefined;\r\n        this.predictSeasonData.splice(0);\r\n        this.predictSeasonDataFull.splice(0);\r\n        if (noBegin < minNo) return;\r\n        noBegin += 3;\r\n        this.ypredict = [];\r\n        for (let x = noBegin; x <= maxNo; x += 4) {\r\n            let item = seasonlist[x];\r\n            if (item === undefined) break;\r\n            this.predictSeasonData.splice(0, 0, item);\r\n            this.ypredict.push(item.esum);\r\n        }\r\n\r\n        for (let x = maxNo; x >= minNo; x -= 4) {\r\n            let item = seasonlist[x];\r\n            if (item === undefined) break;\r\n            this.predictSeasonDataFull.push(item);\r\n        }\r\n\r\n        if (this.ypredict.length === 5) {\r\n            let er = new ErForEarning(this.ypredict);\r\n            let lr = new SlrForEarning(this.ypredict);\r\n            this.predictData = { e: this.ypredict[4], b: er.B, r2: er.r2, epre: er.predict(4), l: lr.slopeR, lr2: lr.r2, lpre: lr.predict(4) };\r\n        }\r\n        else {\r\n            this.predictSeasonData.splice(0);\r\n        }\r\n    }\r\n\r\n    protected ExrightEarning(endDay: number, season: number, item: { c: number, e: number, esum: number }) {\r\n        let { end } = GFunc.SeasonnoToBeginEnd(season);\r\n        for (let i = 0; i < this.exrightForEarning.length; ++i) {\r\n            let exitem = this.exrightForEarning[i];\r\n            let day = exitem.day;\r\n            if (day > endDay) break;\r\n            if (day < end) continue;\r\n            let factor = exitem.factor;\r\n            item.c = item.c * factor;\r\n            item.e = item.e * factor;\r\n            item.esum = item.esum * factor;\r\n        }\r\n    }\r\n\r\n    // loadHistoryData(showAll: boolean) {\r\n    //     let list = this.historyDataOrg;\r\n    //     let length = list.length;\r\n    //     if (length <= 10) {\r\n    //         this.historyData = [];\r\n    //         return;\r\n    //     }\r\n\r\n    //     if (!showAll) {\r\n    //         let day = this.baseItem.day;\r\n    //         if (day !== undefined) {\r\n    //             let i = length - 1;\r\n    //             for (; i >= 0; --i) {\r\n    //                 let item = list[i];\r\n    //                 if (item.day <= day) break;\r\n    //             }\r\n    //             length = i + 1;\r\n    //         }\r\n    //     }\r\n    //     let endIndex = length - 1;\r\n    //     let lastItem = list[endIndex];\r\n    //     let lastdayno = lastItem.dayno;\r\n    //     if (lastdayno === undefined) {\r\n    //         while (endIndex > 0) {\r\n    //             --endIndex;\r\n    //             lastItem = list[endIndex];\r\n    //             lastdayno = lastItem.dayno;\r\n    //             if (lastdayno !== undefined) break;\r\n    //         }\r\n    //     }\r\n    //     let lastDay = lastItem.day;\r\n    //     let not = lastdayno % 5;\r\n    //     let historyList: any[] = [];\r\n    //     for (let i = 0; i <= endIndex; ++i) {\r\n    //         let { day, price, dayno } = list[i];\r\n    //         if (dayno % 5 === not) {\r\n    //             historyList.push({ day: day, price: this.RestorePrice(price, day, lastDay), ttm: this.CalculateHistoryPE(price, day) });\r\n    //         }\r\n    //     }\r\n    //     this.historyData = historyList;\r\n    // }\r\n\r\n    RestorePrice(price: number, dayFrom: number, dayIndex: number) {\r\n        let bsum = 0;\r\n        let pricere = price;\r\n        if (dayFrom < dayIndex) {\r\n            for (let i = 0; i < this.exrightInfo.length; ++i) {\r\n                let { day, bonus, factor, factore } = this.exrightInfo[i];\r\n                if (day <= dayFrom)\r\n                    continue;\r\n                if (day > dayIndex)\r\n                    break;\r\n                pricere = pricere * factor;\r\n                bsum = (bsum + bonus) * factore;\r\n            }\r\n            pricere = pricere - bsum;\r\n        }\r\n        else {\r\n            for (let i = 0; i < this.exrightInfo.length; ++i) {\r\n                let { day, bonus, factor, factore } = this.exrightInfo[i];\r\n                if (day <= dayIndex)\r\n                    continue;\r\n                if (day > dayFrom)\r\n                    break;\r\n                pricere = pricere / factor;\r\n                bsum = bsum / factore + bonus;\r\n            }\r\n            pricere = pricere + bsum;\r\n        }\r\n        return pricere;\r\n    }\r\n\r\n    CalculateHistoryPE(price: number, day: number) {\r\n        let season = GFunc.SeasonnoFromDay(day);\r\n        let len = this.seasonData.length;\r\n        for (let i = 0; i < len; ++i) {\r\n            let item = this.seasonData[i];\r\n            if (item.season >= season) continue;\r\n            if (item.esumorg === undefined) return undefined;\r\n            let { end } = GFunc.SeasonnoToBeginEnd(item.season);\r\n            let pricere = this.RestorePrice(price, day, end);\r\n            return pricere / item.esumorg;\r\n        }\r\n\r\n        return undefined;\r\n    }\r\n\r\n    async internalStart(param: any) {\r\n        this.baseItem = param as NStockInfo;\r\n\t\tthis.stock = param.stock;\r\n        let { id } = this.baseItem;\r\n        //this.isMySelect = this.cApp.store.isMyAll(this.stock);\r\n        this.initLoad();\r\n        this.openVPage(VStockInfo);\r\n    }\r\n\r\n    openMetaView = () => {\r\n    }\r\n\r\n    onSelectTag = async () => {\r\n        //await this.loadTags();\r\n        this.selectedTags = this.cApp.store.stockGroups.getSelected(this.stockTags);\r\n        /*\r\n        this.cApp.store.stockGroups.filter(v => {\r\n            let i = this.stockTags.findIndex(st => st.tag === v.groupId);\r\n            return i >= 0;\r\n        });\r\n        */\r\n        //await this.loadTags();\r\n        this.openVPage(VTags);\r\n    }\r\n\r\n    onNewTag = () => {\r\n        this.openVPage(VNewTag);\r\n    }\r\n\r\n    onEditTag = (param: any) => {\r\n        this.openVPage(VEditTag, param);\r\n    }\r\n\r\n    onSaveNewTag = async (data: any) => {\r\n        let { name } = data;\r\n        //let param = { id: undefined, name: name };\r\n        //let ret = await this.cApp.store.miApi.call('t_tag$save', [this.user.id, undefined, name]);\r\n        let ret = await this.cApp.miNet.t_tag$save(name);\r\n        let { retId } = ret;\r\n        if (retId < 0) {\r\n            alert(name + ' 已经被使用了');\r\n            return false;\r\n        }\r\n        this.cApp.store.stockGroups.add(\r\n            new StockGroup(name, name, this.cApp.miNet)\r\n        );\r\n        return true;\r\n    }\r\n\r\n    onSaveTag = async (data: any) => {\r\n        let { id, name } = data;\r\n        let { stockGroups } = this.cApp.store;\r\n        let param = { id: id, name: name };\r\n        let exists = stockGroups.exists(id, name);\r\n        if (exists === true) {\r\n            alert(name + ' 已经被使用了');\r\n            return false;\r\n        }\r\n        let ret = await this.cApp.miNet.t_tag$save(name);\r\n        let { retId } = ret;\r\n        if (retId === undefined || retId < 0) {\r\n            alert(name + ' 已经被使用了');\r\n            return false;\r\n        }\r\n        let group = stockGroups.groupFromId(id);\r\n        if (group) {\r\n            group.name = name;\r\n        }\r\n        return true;\r\n    }\r\n\r\n    onClickSelectTag = async (tag: any, isSelected: boolean) => {\r\n        let param = {\r\n            user: nav.user.id,\r\n            tag: tag.id,\r\n            arr1: [\r\n                { stock: this.baseItem.id }\r\n            ]\r\n        };\r\n        if (isSelected === true) {\r\n            //let ret = await this.cApp.store.miApi.call('t_tagstock$add', [this.user.id, tag.id, this.baseItem.id]); //.uqs.mi.TagStock.add(param);\r\n            await this.cApp.store.addTagStock(this.baseItem as any);\r\n            //let ret = this.cApp.miNet.t_tagstock$add(tag.id, this.baseItem.id);\r\n            let newTag = {\r\n                tag: {\r\n                    id: tag.id,\r\n                }\r\n            }\r\n            this.stockTags.push(newTag);\r\n        }\r\n        else {\r\n            //let ret = await this.cApp.store.miApi.call('t_tagstock$del', [this.user.id, tag.id, this.baseItem.id]); // //await this.uqs.mi.TagStock.del(param);\r\n            //let ret = this.cApp.miNet.t_tagstock$del(tag.id, this.baseItem.id);\r\n            await this.cApp.store.removeTagStock(this.baseItem as any);\r\n            let i = this.stockTags.findIndex(v => v.tag.id === tag.id);\r\n            this.stockTags.splice(i, 1);\r\n        }\r\n    }\r\n\r\n    onClickDefaultTag = async (isSelected: boolean) => {\r\n        //let tagid = this.cApp.store.defaultListTagID;\r\n        let { store } = this.cApp;\r\n        let { id: groupId } = store.stockGroups.defaultGroup;\r\n        if (isSelected === true) {\r\n            //let ret = this.cApp.miNet.t_tagstock$add(tagid, this.baseItem.id);\r\n            await store.addTagStock(this.baseItem as any);\r\n            let newTag = {\r\n                tag: {\r\n                    id: store.stockGroups.defaultGroup.id,\r\n                }\r\n            }\r\n            this.stockTags.push(newTag);\r\n        }\r\n        else {\r\n            //let ret = await this.cApp.store.miApi.call('t_tagstock$del', [this.user.id, tagid, this.baseItem.id]); // //await this.uqs.mi.TagStock.del(param);\r\n            await this.cApp.store.removeTagStock(this.baseItem as any);\r\n            //let ret = this.cApp.miNet.t_tagstock$del(tagid, this.baseItem.id);\r\n            let i = this.stockTags.findIndex(v => v.tag.id === groupId);\r\n            this.stockTags.splice(i, 1);\r\n        }\r\n    }\r\n\r\n    showSelectStock = async (day: number): Promise<any> => {\r\n        let cStock = new CSelectStock(this.cApp);\r\n        let item = await cStock.call() as any;\r\n        let b = { ...item }\r\n        b.day = day;\r\n        this.baseItem = b;\r\n        this.loaded = false;\r\n        await this.load();\r\n    }\r\n\r\n    changeDay = async (day: number) => {\r\n        if (this.baseItem.day === day) return;\r\n        let { id, name, code, symbol, market } = this.baseItem;\r\n        let ni = { id: id, name: name, code: code, symbol: symbol, market: market, day: day === 0 ? undefined : day };\r\n        this.baseItem = ni;\r\n        this.loaded = false;\r\n        await this.load();\r\n    }\r\n}\r\n","import { observable } from 'mobx';\r\nimport _ from 'lodash';\r\nimport { LocalArr } from '../../tool';\r\nimport { BoxId } from './boxId';\r\nimport { TuidInner, TuidDiv } from './tuid';\r\n\r\nconst maxCacheSize = 1000;\r\n\r\nexport class IdCache {\r\n    private queue: number[] = [];               // 每次使用，都排到队头\r\n\tprivate cache = observable.map({}, {deep: false});    // 已经缓冲的\r\n\t//private loading:boolean = false;\r\n\t//private loadingIds: number[];\r\n\r\n    protected localArr:LocalArr;\r\n    protected waitingIds: number[] = [];          // 等待loading的\r\n    protected tuidInner: TuidInner;\r\n\r\n    constructor(tuidLocal: TuidInner) {\r\n        this.tuidInner = tuidLocal;\r\n        this.initLocalArr();\r\n    }\r\n\r\n    protected initLocalArr() {\r\n        this.localArr = this.tuidInner.cache.arr(this.tuidInner.name + '.ids');\r\n    }\r\n\r\n    useId(id:number, defer?:boolean) {\r\n        if (!id) return;\r\n        if (typeof id !== 'number') {\r\n\t\t\tconsole.error('id cache ' + id + ' is not number');\r\n\t\t\treturn;\r\n\t\t}\r\n        if (this.cache.has(id) === true) {\r\n            this.moveToHead(id);\r\n            return;\r\n        }\r\n        this.tuidInner.cacheTuids(defer===true?70:20);\r\n        this.cache.set(id, id);\r\n        if (this.waitingIds.findIndex(v => v === id) >= 0) {\r\n            this.moveToHead(id);\r\n            return;\r\n        }\r\n\r\n        if (this.queue.length >= maxCacheSize) {\r\n            // 缓冲已满，先去掉最不常用的\r\n            let r = this.queue.shift();\r\n            if (r === id) {\r\n                // 如果移除的，正好是现在用的，则插入\r\n                this.queue.push(r);\r\n                return;\r\n            }\r\n\r\n            //let rKey = String(r);\r\n            if (this.cache.has(r) === true) {\r\n                // 如果移除r已经缓存\r\n                this.cache.delete(r);\r\n            }\r\n            else {\r\n                // 如果移除r还没有缓存\r\n                let index = this.waitingIds.findIndex(v => v === r);\r\n                this.waitingIds.splice(index, 1);\r\n            }\r\n        }\r\n        this.waitingIds.push(id);\r\n        this.queue.push(id);\r\n\t\treturn;\r\n    }\r\n\t/*\r\n\tprotected removeWaiting(id:number) {\r\n\t\tlet index = this.waitingIds.findIndex(v => v === id);\r\n\t\tthis.waitingIds.splice(index, 1);\r\n\t}\r\n\t\r\n\tprotected clearWaiting() {\r\n\t\tthis.waitingIds.splice(0, this.waitingIds.length);\r\n\t}\r\n\t\r\n\tprotected removeLoading(id:number) {\r\n\t\tif (this.loadingIds === undefined) return;\r\n\t\tlet index = this.loadingIds.findIndex(v => v === id);\r\n\t\tthis.loadingIds.splice(index, 1);\r\n\t}\r\n\t*/\r\n    private moveToHead(id:number) {\r\n        let index = this.queue.findIndex(v => v === id);\r\n        this.queue.splice(index, 1);\r\n        this.queue.push(id);\r\n    }\r\n\r\n    getValue(id:number) {\r\n\t\treturn this.cache.get(id);\r\n    }\r\n\r\n    remove(id:number) {\r\n        this.cache.delete(id);\r\n        let index = this.queue.findIndex(v => v === id);\r\n\t\tthis.queue.splice(index, 1);\r\n\t\tthis.localArr.removeItem(id);\r\n    }\r\n\r\n    valueFromId(id:number|BoxId):any {\r\n        let _id:number;\r\n        switch (typeof id) {\r\n            case 'object': _id = (id as BoxId).id; break;\r\n            case 'number': _id = id as number; break;\r\n            default: return;\r\n        }\r\n        return this.getValue(_id);\r\n    }\r\n\r\n    resetCache(id:number) {\r\n        this.remove(id);\r\n        this.useId(id);\r\n    }\r\n\r\n    cacheValue(val:any):boolean {\r\n        if (val === undefined) return false;\r\n        let id = this.getIdFromObj(val);\r\n        if (id === undefined) return false;\r\n\t\t/*\r\n        let index = this.waitingIds.findIndex(v => v === id);\r\n        if (index>=0) this.waitingIds.splice(index, 1);\r\n\t\t*/\r\n\t\t//this.removeWaiting(id);\r\n\t\t//this.removeLoading(id);\r\n        this.cache.set(id, val);\r\n        return true;\r\n    }\r\n    protected getIdFromObj(val:any) {return this.tuidInner.getIdFromObj(val)}\r\n\r\n    async cacheIds():Promise<void> {\r\n        //if (this.waitingIds.length === 0) return;\r\n\t\tlet tuidValues = await this.loadIds();\r\n\t\t/*\r\n\t\tif (tuidValues === undefined || tuidValues.length === 0) {\r\n\t\t\t//this.waitingIds.splice(0, this.waitingIds.length);\r\n\t\t\tthis.clearWaiting();\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t*/\r\n        this.cacheIdValues(tuidValues);\r\n    }\r\n\r\n    protected cacheIdValues(tuidValues: any[]) {\r\n        if (tuidValues === undefined) return;\r\n        let tuids = this.unpackTuidIds(tuidValues);\r\n        for (let tuidValue of tuids) {\r\n            if (this.cacheValue(tuidValue) === false) continue;\r\n            this.cacheTuidFieldValues(tuidValue);\r\n        }\r\n    }\r\n    async modifyIds(ids:any[]):Promise<void> {\r\n        let tuidValues:string[] = await this.loadTuidIdsOrLocal(ids);\r\n        let localedValues = tuidValues.filter(v => {\r\n            let p = v.indexOf('\\t');\r\n            if (p<0) p = v.length;\r\n            let id = Number(v.substr(0, p));\r\n            let val = this.localArr.getItem(id);\r\n            return (val !== undefined);\r\n        });\r\n        if (localedValues.length === 0) return;\r\n        this.cacheIdValues(localedValues);\r\n    }\r\n    protected async loadIds(): Promise<any[]> {\r\n\t\tif (this.waitingIds.length === 0) return;\r\n\t\t//if (this.loading === true) return;\r\n\t\t//this.loading = true;\r\n\t\tlet loadingIds = [...this.waitingIds];\r\n\t\t//this.clearWaiting();\r\n\t\tthis.waitingIds = [];\r\n\t\tlet ret = await this.loadTuidIdsOrLocal(loadingIds);\r\n\t\t//this.loading = false;\r\n\t\t//this.loadingIds = undefined;\r\n        return ret;\r\n    }\r\n    protected unpackTuidIds(values:string[]):any[] {\r\n        return this.tuidInner.unpackTuidIds(values);\r\n    }\r\n    protected cacheTuidFieldValues(tuidValue: any) {\r\n        this.tuidInner.cacheTuidFieldValues(tuidValue);\r\n    }\r\n\r\n    async assureObj(id:number):Promise<void> {\r\n        let val = this.cache.get(id);\r\n        switch (typeof val) {\r\n            case 'object': return val;\r\n            case 'number': this.cache.set(id, id); break;\r\n        }\r\n        let ret = await this.loadTuidIdsOrLocal([id]);\r\n        this.cacheIdValues(ret);\r\n    }\r\n\r\n\tprotected async loadTuidIds(netIds: number[]):Promise<any[]> {\r\n\t\tlet netRet = await this.tuidInner.loadTuidIds(undefined, netIds);\r\n\t\treturn netRet;\r\n\t}\r\n\r\n    private async loadTuidIdsOrLocal(ids:number[]):Promise<string[]> {\r\n        let ret:string[] = [];        \r\n        let netIds:number[] = [];\r\n        for (let id of ids) {\r\n            let value = this.localArr.getItem(id);\r\n            //if (value === undefined)\r\n            // 值不存在或者是空字符串，重新获取\r\n            if (!value)\r\n                netIds.push(id);\r\n            else\r\n                ret.push(value);\r\n        }\r\n        let len = netIds.length;\r\n        if (len === 0) return ret;\r\n\r\n\t\tlet netRet = await this.loadTuidIds(netIds);\r\n\t\tfor (let i=0; i<len; i++) {\r\n\t\t\t//有些id可能没有内容，不会返回\r\n\t\t\t//let id = netIds[i]; \r\n\t\t\tlet row:string = netRet[i];\r\n\t\t\tif (!row) continue;\r\n\t\t\tlet p = row.indexOf('\\t');\r\n\t\t\tif (p < 0) p = row.length;\r\n\t\t\tlet id = Number(row.substr(0, p));\r\n\t\t\t_.remove(netIds, v => v === id);\r\n\t\t\tret.push(row);\r\n\t\t\tthis.localArr.setItem(id, row);\r\n\t\t}\r\n\t\tlen = netIds.length;\r\n\t\tfor (let i=0; i<len; i++) {\r\n\t\t\tthis.localArr.setItem(netIds[i], '');\r\n\t\t}\r\n        return ret;\r\n    }\r\n}\r\n\r\nexport class IdDivCache extends IdCache {\r\n    private div: TuidDiv;\r\n    protected divName:string;\r\n\r\n    constructor(tuidLocal:TuidInner, div: TuidDiv) {\r\n        super(tuidLocal);\r\n        this.div = div;\r\n        this.divName = div.name;\r\n        this.localArr = tuidLocal.cache.arr(tuidLocal.name + '.ids.' + this.divName);\r\n    }\r\n\r\n    protected initLocalArr() {\r\n        // 这个不需要，必须去掉\r\n        // this.localArr = this.tuidInner.cache.arr(this.tuidInner.name + '.ids');\r\n    }\r\n\r\n    protected getIdFromObj(val:any) {return this.div.getIdFromObj(val)}\r\n    protected unpackTuidIds(values:string[]):any[] {\r\n        return this.div.unpackTuidIds(values);\r\n    }\r\n    protected cacheTuidFieldValues(tuidValue: any) {\r\n        this.div.cacheTuidFieldValues(tuidValue);\r\n    }\r\n\tprotected async loadTuidIds(netIds: number[]):Promise<any[]> {\r\n\t\tlet netRet = await this.tuidInner.loadTuidIds(this.divName, netIds);\r\n\t\treturn netRet;\r\n\t}\r\n}\r\n","import _ from 'lodash';\r\nimport { LocalArr } from '../../tool';\r\nimport { Entity } from '../entity';\r\nimport { UqMan, ArrFields, Field, SchemaFrom } from '../uqMan';\r\nimport { EntityCaller } from '../caller';\r\nimport { BoxId } from './boxId';\r\nimport { IdCache, IdDivCache } from './idCache';\r\n\r\nexport interface TuidSaveResult {\r\n    id: number;\r\n    inId: number;\r\n}\r\n\r\nexport interface TuidNOResult {\r\n\tdate: string;\r\n\tno: number;\r\n}\r\n\r\nexport abstract class UqTuid<M> extends Entity {\r\n    protected noCache: boolean;\r\n    readonly typeName:string = 'tuid';\r\n    protected idName: string;\r\n    cached: boolean;\r\n    unique: string[];\r\n\r\n    public setSchema(schema:any) {\r\n        super.setSchema(schema);\r\n        let {id} = schema;\r\n        this.idName = id;\r\n    }\r\n\r\n    buildTuidBox(): TuidBox {\r\n        return new TuidBox(this);\r\n    }\r\n\r\n    getIdFromObj(obj:any):number {return obj[this.idName]}\r\n    stopCache():void {this.noCache = true}\r\n    abstract useId(id:number):void;\r\n    abstract boxId(id:number):BoxId;\r\n    abstract valueFromId(id:number):any;\r\n\tabstract resetCache(id:number|BoxId):void;\r\n\tabstract assureBox<T> (id:number|BoxId): Promise<T>;\r\n\tstatic idValue(id: {id:number}|number):number {\r\n\t\tswitch (typeof id) {\r\n\t\t\tdefault: debugger; throw new Error('unknown id');\r\n\t\t\tcase 'object': return id.id;\r\n\t\t\tcase 'number': return id;\r\n\t\t}\r\n\t}\r\n    static equ(id1:{id:number}|number, ix:{id:number}|number): boolean {\r\n        if (id1 === undefined || id1 === null) return false;\r\n\t\tif (ix === undefined || ix === null) return false;\r\n\t\treturn Tuid.idValue(id1) === Tuid.idValue(ix);\r\n\t\t/*\r\n        if (typeof id1 === 'object') {\r\n\t\t\tlet id1Id = id1.id;\r\n            return typeof ix === 'object'? id1Id === ix.id : id1Id === ix;\r\n        }\r\n        if (typeof ix === 'object') {\r\n\t\t\tlet id2Id = ix.id;\r\n            return typeof id1 === 'object'? id2Id === id1.id : id2Id === id1;\r\n        }\r\n\t\treturn id1 === ix;\r\n\t\t*/\r\n    }\r\n    cacheIds() {}\r\n    async modifyIds(ids:any[]) {}\r\n    isImport = false;\r\n    abstract get hasDiv():boolean;// {return this.divs!==undefined}\r\n    abstract div(name:string):TuidDiv;\r\n    abstract loadMain(id:number|BoxId):Promise<M>;\r\n\tabstract load(id:number|BoxId):Promise<M>;\r\n    abstract all():Promise<M[]>;\r\n\tabstract save(id:number, props:M):Promise<TuidSaveResult>;\r\n\tabstract saveProp(id:number, prop:string, value:any):Promise<void>;\r\n    abstract search(key:string, pageStart:string|number, pageSize:number):Promise<M[]>;\r\n    abstract searchArr(owner:number, key:string, pageStart:string|number, pageSize:number):Promise<any>;\r\n    abstract loadArr(arr:string, owner:number, id:number):Promise<any>;\r\n    abstract saveArr(arr:string, owner:number, id:number, props:any):Promise<void>;\r\n\tabstract posArr(arr:string, owner:number, id:number, order:number):Promise<void>;\r\n\tabstract no():Promise<TuidNOResult>;\r\n}\r\n\r\nexport abstract class Tuid extends UqTuid<any> {\r\n}\r\n\r\nexport class TuidInner extends Tuid {\r\n    private divs: {[div:string]: TuidDiv};\r\n    protected cacheFields: Field[];\r\n    protected idCache: IdCache;\r\n    protected localArr:LocalArr;\r\n    constructor(uq:UqMan, name:string, typeId:number) {\r\n        super(uq, name, typeId);\r\n        this.idCache = new IdCache(this);\r\n        this.localArr = this.cache.arr(this.name + '.whole');\r\n        if (uq.newVersion === true) this.localArr.removeAll();\r\n    }\r\n\r\n    public setSchema(schema:any) {\r\n        super.setSchema(schema);\r\n        let {arrs} = schema;\r\n        if (arrs !== undefined) {\r\n            this.divs = {};\r\n            for (let arr of arrs) {\r\n                let {name} = arr;\r\n                let tuidDiv = new TuidDiv(this.uq, this, name);\r\n                this.divs[name] = tuidDiv;\r\n                tuidDiv.setSchema(arr);\r\n                tuidDiv.buildFieldsTuid();\r\n            }\r\n        }\r\n    }\r\n    \r\n    useId(id:number, defer?:boolean) {\r\n        if (this.noCache === true) return;\r\n        if (!id) return;\r\n        this.idCache.useId(id, defer);\r\n    }\r\n    boxId(id:number):BoxId {\r\n        if (!id) return;\r\n        if (typeof id === 'object') return id;\r\n        this.useId(id);\r\n        let {createBoxId} = this.uq;\r\n        if (!createBoxId) return {id: id} as BoxId;\r\n        return createBoxId(this, id);\r\n    }\r\n    valueFromId(id:number) {return this.idCache.getValue(id)}\r\n\tresetCache(id:number|BoxId):void {\r\n\t\tif (typeof id === 'object') id = id.id;\r\n\t\tthis.idCache.resetCache(id);\r\n\t}\r\n    async assureBox<T> (id:number|BoxId):Promise<T> {\r\n\t\tif (!id) return;\r\n\t\tif (typeof id === 'object') id = id.id;\r\n\t\tawait this.idCache.assureObj(id);\r\n\t\treturn this.idCache.getValue(id);\r\n    }\r\n\r\n    cacheIds() {\r\n        this.idCache.cacheIds();\r\n        if (this.divs === undefined) return;\r\n        for (let i in this.divs) this.divs[i].cacheIds();\r\n    }\r\n    async modifyIds(ids:any[]) {\r\n        await this.idCache.modifyIds(ids);\r\n    }\r\n    cacheTuids(defer:number) {this.uq.cacheTuids(defer)}\r\n    get hasDiv():boolean {return this.divs!==undefined}\r\n    div(name:string):TuidDiv {\r\n        return this.divs && this.divs[name];\r\n    }\r\n    async loadTuidIds(divName:string, ids:number[]):Promise<any[]> {\r\n        let ret:any[] = await new IdsCaller(this, {divName:divName, ids:ids}, false).request();\r\n        if (ret.length > 0) this.cached = true;\r\n        return ret;\r\n    }\r\n    async loadMain(id:number|BoxId):Promise<any> {\r\n        if (typeof id === 'object') id = id.id;\r\n        await this.idCache.assureObj(id);\r\n        return this.idCache.valueFromId(id);\r\n    }\r\n    async load(id:number|BoxId):Promise<any> {\r\n        if (id === undefined || id === 0) return;\r\n        //let cacheValue = this.idCache.valueFromId(id); \r\n        //if (typeof cacheValue === 'object') return cacheValue;\r\n        if (typeof id === 'object') id = id.id;\r\n        let valuesText = undefined; //this.localArr.getItem(id);\r\n        let values: any;\r\n        if (valuesText) {\r\n            values = JSON.parse(valuesText);\r\n        }\r\n        else {\r\n            values = await new GetCaller(this, id).request();\r\n            if (values !== undefined) {\r\n                // this.localArr.setItem(id, JSON.stringify(values));\r\n            }\r\n        }\r\n        if (values === undefined) return;\r\n        for (let f of this.schema.fields) {\r\n            let {tuid} = f;\r\n            if (tuid === undefined) continue;\r\n            let t = this.uq.getTuid(tuid);\r\n            if (t === undefined) continue;\r\n            let n = f.name;\r\n            values[n] = t.boxId(values[n]);\r\n        }\r\n        this.idCache.cacheValue(values);\r\n        this.cacheTuidFieldValues(values);\r\n        return values;\r\n    }\r\n\r\n    cacheTuidFieldValues(values:any) {\r\n        let {fields, arrs} = this.schema;\r\n        this.cacheFieldsInValue(values, fields);\r\n        if (arrs !== undefined) {\r\n            for (let arr of arrs as ArrFields[]) {\r\n                let {name, fields} = arr;\r\n                let arrValues = values[name];\r\n                if (arrValues === undefined) continue;\r\n                let tuidDiv = this.div(name);\r\n                for (let row of arrValues) {\r\n                    //row._$tuid = tuidDiv;\r\n                    //row.$owner = this.boxId(row.owner);\r\n                    tuidDiv.cacheValue(row);\r\n                    this.cacheFieldsInValue(row, fields);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    public buildFieldsTuid() {\r\n        super.buildFieldsTuid();\r\n        let {mainFields, $create, $update, stampOnMain} = this.schema;\r\n\t\tif (mainFields === undefined) debugger;\r\n\t\tthis.cacheFields = mainFields || this.fields;\r\n\t\tif (stampOnMain === true) {\r\n\t\t\tif ($create === true) this.cacheFields.push({name: '$create', type: 'timestamp', _tuid: undefined});\r\n\t\t\tif ($update === true) this.cacheFields.push({name: '$update', type: 'timestamp', _tuid: undefined});\r\n\t\t}\r\n        this.uq.buildFieldTuid(this.cacheFields);\r\n    }\r\n\r\n    unpackTuidIds(values:string[]):any[] {\r\n        return this.unpackTuidIdsOfFields(values, this.cacheFields);\r\n    }\r\n\r\n    async save(id:number, props:any):Promise<TuidSaveResult> {\r\n        let ret = await new SaveCaller(this, {id:id, props:props}).request();\r\n        if (id !== undefined) {\r\n            this.idCache.remove(id);\r\n            this.localArr.removeItem(id);\r\n        }\r\n        return ret;\r\n\t}\r\n\tasync saveProp(id:number, prop:string, value:any):Promise<void> {\r\n\t\tawait new SavePropCaller(this, {id, prop, value}).request();\r\n\t\tthis.idCache.remove(id);\r\n\t\tawait this.idCache.assureObj(id);\r\n\t}\r\n    async all():Promise<any[]> {\r\n        let ret: any[] = await new AllCaller(this, {}).request();\r\n        return ret;\r\n    }\r\n    async search(key:string, pageStart:string|number, pageSize:number):Promise<any[]> {\r\n        let ret:any[] = await this.searchArr(undefined, key, pageStart, pageSize);\r\n        return ret;\r\n    }\r\n    async searchArr(owner:number, key:string, pageStart:string|number, pageSize:number):Promise<any> {\r\n        //let api = this.uqApi;\r\n        //let ret = await api.tuidSearch(this.name, undefined, owner, key, pageStart, pageSize);\r\n        let params:any = {arr:undefined, owner:owner, key:key, pageStart:pageStart, pageSize:pageSize};\r\n        let ret = await new SearchCaller(this, params).request();\r\n        let {fields} = this.schema;\r\n        for (let row of ret) {\r\n            this.cacheFieldsInValue(row, fields);\r\n        }\r\n        return ret;\r\n    }\r\n    async loadArr(arr:string, owner:number, id:number):Promise<any> {\r\n        if (id === undefined || id === 0) return;\r\n        //let api = this.uqApi;\r\n        //return await api.tuidArrGet(this.name, arr, owner, id);\r\n        return await new LoadArrCaller(this, {arr:arr, owner:owner, id:id}).request();\r\n    }\r\n    async saveArr(arr:string, owner:number, id:number, props:any) {\r\n        //let params = _.clone(props);\r\n        //params[\"$id\"] = id;\r\n        //return await this.uqApi.tuidArrSave(this.name, arr, owner, params);\r\n        return await new SaveArrCaller(this, {arr:arr, owner:owner, id:id, props:props}).request();\r\n    }\r\n\r\n    async posArr(arr:string, owner:number, id:number, order:number) {\r\n        //return await this.uqApi.tuidArrPos(this.name, arr, owner, id, order);\r\n        return await new ArrPosCaller(this, {arr:arr, owner:owner, id:id, order:order}).request();\r\n\t}\r\n\tasync no():Promise<TuidNOResult> {\r\n\t\treturn await new TuidNoCaller(this, undefined).request();\r\n\t}\r\n}\r\n\r\nabstract class TuidCaller<T> extends EntityCaller<T> {\r\n    protected get entity(): Tuid {return this._entity as Tuid};\r\n}\r\n\r\n// 包含main字段的load id\r\n// 当前为了兼容，先调用的包含所有字段的内容\r\nclass GetCaller extends TuidCaller<number> {\r\n    method = 'GET';\r\n    get path():string {return `tuid/${this.entity.name}/${this.params}`}\r\n}\r\n\r\nclass IdsCaller extends TuidCaller<{divName:string, ids:number[]}> {\r\n    get path():string {\r\n        let {divName} = this.params;\r\n        return `tuidids/${this.entity.name}/${divName !== undefined?divName:'$'}`;\r\n    }\r\n    buildParams():any {return this.params.ids}\r\n    xresult(res:any):any {\r\n        return (res as string).split('\\n');\r\n    }\r\n}\r\n\r\n\r\nclass SaveCaller extends TuidCaller<{id:number, props:any}> {\r\n    get path():string {return `tuid/${this.entity.name}`}\r\n    buildParams():any {\r\n        let {fields, arrs} = this.entity.schema;\r\n        let {id, props} = this.params;\r\n        let params:any = {$id: id};\r\n        this.transParams(params, props, fields);\r\n        if (arrs !== undefined) {\r\n            for (let arr of arrs) {\r\n                let arrName = arr.name;\r\n                let arrParams = [];\r\n                let arrFields = arr.fields;\r\n                let arrValues = props[arrName];\r\n                if (arrValues !== undefined) {\r\n                    for (let arrValue of arrValues) {\r\n                        let row = {};\r\n                        this.transParams(row, arrValue, arrFields);\r\n                        arrParams.push(row);\r\n                    }\r\n                }\r\n                params[arrName] = arrParams;\r\n            }\r\n        }\r\n        return params;\r\n    }\r\n    private transParams(values:any, params:any, fields:Field[]) {\r\n        if (params === undefined) return;\r\n        for (let field of fields) {\r\n            let {name, tuid, type} = field;\r\n            let val = params[name];\r\n            if (tuid !== undefined) {\r\n                if (typeof val === 'object') {\r\n                    if (val !== null) val = val.id;\r\n                }\r\n            }\r\n            else {\r\n                switch (type) {\r\n                    case 'date':\r\n                        val = this.entity.buildDateParam(val); \r\n                        //val = (val as string).replace('T', ' ');\r\n                        //val = (val as string).replace('Z', '');\r\n                        break;\r\n                    case 'datetime':\r\n                        val = this.entity.buildDateTimeParam(val);\r\n                        //val = new Date(val).toISOString();\r\n                        //val = (val as string).replace('T', ' ');\r\n                        //val = (val as string).replace('Z', '');\r\n                        break;\r\n                }\r\n            }\r\n            values[name] = val;\r\n        }\r\n    }\r\n}\r\n\r\nclass SearchCaller extends TuidCaller<{arr:string, owner:number, key:string, pageStart:string|number, pageSize:number}> {\r\n    get path():string {return `tuids/${this.entity.name}`}\r\n}\r\n\r\nclass AllCaller extends TuidCaller<{}> {\r\n    method = 'GET';\r\n    get path():string {return `tuid-all/${this.entity.name}`}\r\n}\r\n\r\nclass LoadArrCaller extends TuidCaller<{arr:string, owner:number, id:number}> {\r\n    method = 'GET';\r\n    get path():string {\r\n        let {arr, owner, id} = this.params;\r\n        return `tuid-arr/${this.entity.name}/${owner}/${arr}/${id}`;\r\n    }\r\n}\r\nclass SavePropCaller extends TuidCaller<{id:number, prop:string, value:any}> {\r\n    get path():string {return `tuid-prop/${this.entity.name}/`;}\r\n}\r\nclass SaveArrCaller extends TuidCaller<{arr:string, owner:number, id:number, props:any}> {\r\n    get path():string {\r\n        let {arr, owner} = this.params;\r\n        return `tuid-arr/${this.entity.name}/${owner}/${arr}/`;\r\n    }\r\n    buildParams():any {\r\n        let {id, props} = this.params;\r\n        let params = _.clone(props);\r\n        params['$id'] = id;\r\n        return params;\r\n    }\r\n}\r\nclass ArrPosCaller extends TuidCaller<{arr:string, owner:number, id:number, order:number}> {\r\n    get path():string {\r\n        let {arr, owner} = this.params;\r\n        return `tuid-arr-pos/${this.entity.name}/${owner}/${arr}/`;\r\n    }\r\n    buildParams():any {\r\n        let {id, order} = this.params;\r\n        return { bid: id, $order: order}\r\n    }\r\n}\r\nclass TuidNoCaller extends TuidCaller<{}> {\r\n    get path():string {\r\n        return `tuid-no/${this.entity.name}/`;\r\n    }\r\n    buildParams():any {\r\n\t\tlet d = new Date();\r\n\t\tlet year = d.getFullYear();\r\n\t\tlet month = d.getMonth() + 1;\r\n\t\tlet date = d.getDate();\r\n        return {year, month, date};\r\n    }\r\n}\r\n\r\nexport class TuidImport extends Tuid {\r\n    private tuidLocal: TuidInner;\r\n\r\n    constructor(uq:UqMan, name:string, typeId:number, from: SchemaFrom) {\r\n        super(uq, name, typeId);\r\n        this.from = from;\r\n    }\r\n\r\n    setFrom(tuidLocal: TuidInner) {this.tuidLocal = tuidLocal}\r\n    \r\n    readonly from: SchemaFrom;\r\n    isImport = true;\r\n\r\n    useId(id:number) {this.tuidLocal.useId(id);}\r\n    boxId(id:number):BoxId {return this.tuidLocal.boxId(id);}\r\n    valueFromId(id:number) {return this.tuidLocal.valueFromId(id)}\r\n\tresetCache(id:number|BoxId):void {\r\n\t\tthis.tuidLocal.resetCache(id);\r\n\t}\r\n    async assureBox<T>(id:number):Promise<T> {\r\n        await this.tuidLocal.assureBox(id);\r\n\t\treturn this.tuidLocal.valueFromId(id);\r\n    }\r\n    get hasDiv():boolean {return this.tuidLocal.hasDiv}\r\n    div(name:string):TuidDiv {return this.tuidLocal.div(name)}\r\n    async loadMain(id:number|BoxId):Promise<any> {\r\n        let ret = await this.tuidLocal.loadMain(id);\r\n        return ret;\r\n    }\r\n    async load(id:number|BoxId):Promise<any> {\r\n        return await this.tuidLocal.load(id);\r\n    }\r\n    async save(id:number, props:any):Promise<TuidSaveResult> {\r\n        return await this.tuidLocal.save(id, props);\r\n\t}\r\n\tasync saveProp(id:number, prop:string, value:any):Promise<void> {\r\n\t\tawait this.tuidLocal.saveProp(id, prop, value);\r\n\t}\r\n    async all():Promise<any[]> {\r\n        return await this.tuidLocal.all();\r\n    }\r\n    async search(key:string, pageStart:string|number, pageSize:number):Promise<any> {\r\n        return await this.tuidLocal.search(key, pageStart, pageSize);\r\n    }\r\n    async searchArr(owner:number, key:string, pageStart:string|number, pageSize:number):Promise<any> {\r\n        return await this.tuidLocal.searchArr(owner, key, pageStart, pageSize);\r\n    }\r\n    async loadArr(arr:string, owner:number, id:number):Promise<any> {\r\n        return await this.tuidLocal.loadArr(arr, owner, id);\r\n    }\r\n    async saveArr(arr:string, owner:number, id:number, props:any):Promise<void> {\r\n        await this.tuidLocal.saveArr(arr, owner, id, props);\r\n    }\r\n    async posArr(arr:string, owner:number, id:number, order:number):Promise<void> {\r\n        await this.tuidLocal.posArr(arr, owner, id, order);\r\n    }\r\n\tasync no():Promise<TuidNOResult> {\r\n\t\treturn await this.tuidLocal.no();\r\n\t}\r\n}\r\n\r\n// field._tuid 用这个接口\r\n// Tuid, TuidDiv 实现这个接口\r\nexport class TuidBox {\r\n    tuid: Tuid;\r\n    ownerField:Field = undefined;\r\n    constructor(tuid: Tuid) {\r\n        this.tuid = tuid;\r\n    }\r\n\r\n    boxId(id:number):BoxId {\r\n        return this.tuid.boxId(id);\r\n    }\r\n    getIdFromObj(obj:any):number {\r\n        return this.tuid.getIdFromObj(obj);\r\n    }\r\n    useId(id:number):void {\r\n        return this.tuid.useId(id);\r\n    }\r\n    async showInfo() {\r\n        alert('showInfo not implemented');\r\n    }\r\n}\r\n\r\n\r\nexport class TuidDiv extends TuidInner /* Entity*/ {\r\n    readonly typeName:string = 'div';\r\n    protected cacheFields: Field[];\r\n    protected tuid: TuidInner;\r\n    protected idName: string;\r\n    protected idCache: IdDivCache;\r\n\r\n    //ui: React.StatelessComponent<any>;\r\n    //res: any;\r\n\r\n    constructor(uq: UqMan, tuid: TuidInner, name: string) {\r\n        super(uq, name, 0);\r\n        this.tuid = tuid;\r\n        this.idName = 'id';\r\n        this.idCache = new IdDivCache(tuid, this);\r\n    }\r\n\r\n    get owner() {return this.tuid}\r\n\r\n    /*\r\n    setSchema(schema:any) {\r\n        super.setSchema(schema);\r\n        this.buildFieldsTuid();\r\n    }*/\r\n\r\n    /*\r\n    setUIRes(ui:any, res:any) {\r\n        this.ui = ui && ui.content;\r\n        this.res = res;\r\n    }\r\n    */\r\n\r\n    buildFieldsTuid() {\r\n        super.buildFieldsTuid();\r\n        let {mainFields} = this.schema;\r\n        if (mainFields === undefined) debugger;\r\n        this.uq.buildFieldTuid(this.cacheFields = mainFields);\r\n    }\r\n\r\n    buildTuidDivBox(ownerField: Field): TuidBoxDiv {\r\n        return new TuidBoxDiv(this.tuid, this, ownerField);\r\n    }\r\n\r\n    getIdFromObj(obj:any):number {return obj[this.idName]}\r\n    cacheValue(value:any):void {\r\n        this.idCache.cacheValue(value);\r\n    }\r\n\r\n    useId(id:number, defer?:boolean):void {\r\n        if (this.noCache === true) return;\r\n        this.idCache.useId(id, defer);\r\n    }\r\n\r\n    /*\r\n    boxId(id:number):BoxId {\r\n        if (typeof id === 'object') return id;\r\n        this.useId(id);\r\n        //return new BoxDivId(this.tuid, this, id);\r\n        return this.tuid.boxDivId(this, id);\r\n    }\r\n    */\r\n    valueFromId(id:number):any {\r\n        return this.idCache.getValue(id)\r\n    }\r\n\r\n    async assureBox<T>(id:number):Promise<T> {\r\n\t\tawait this.idCache.assureObj(id);\r\n\t\treturn this.idCache.getValue(id);\r\n    }\r\n\r\n    async cacheIds() {\r\n        await this.idCache.cacheIds();\r\n    }\r\n\r\n    cacheTuidFieldValues(values:any) {\r\n        let fields = this.schema.fields;\r\n        this.cacheFieldsInValue(values, fields);\r\n    }\r\n\r\n    unpackTuidIds(values:string[]):any[] {\r\n        return this.unpackTuidIdsOfFields(values, this.cacheFields);\r\n    }\r\n}\r\n\r\nexport class TuidBoxDiv extends TuidBox {\r\n    ownerField: Field;\r\n    private div: TuidDiv;\r\n    constructor(tuid: Tuid, div: TuidDiv, ownerField: Field) {\r\n        super(tuid);\r\n        this.div = div;\r\n        this.ownerField = ownerField;\r\n    }\r\n\r\n    boxId(id:number):BoxId {\r\n        return this.div.boxId(id);\r\n    }\r\n    getIdFromObj(obj:any):number {\r\n        return this.div.getIdFromObj(obj);\r\n    }\r\n    useId(id:number):void {\r\n        return this.div.useId(id);\r\n    }\r\n}\r\n","import fs from \"fs\";\r\nimport { capitalCase } from \"../../tool\";\r\nimport { FieldItem } from \"../../ui\";\r\nimport { ID, IDX, IX } from \"../ID\";\r\nimport { UqMan } from \"../uqMan\";\r\nimport { buildUQ } from \"./buildUQ\";\r\nimport { buildFieldItem } from \"./fieldItem\";\r\nimport { buildTsHeader, overrideTsFile, saveTsFileIfNotExists } from \"./tools\";\r\n\r\nexport function buildTsUqFolder(uq: UqMan, uqsFolder:string, uqAlias:string) {\r\n\tlet uqFolder = uqsFolder + '/' + uqAlias;\r\n\tif (fs.existsSync(uqFolder) === false) {\r\n\t\tfs.mkdirSync(uqFolder);\r\n\t}\r\n\tlet tsUq = buildTsHeader();\r\n\ttsUq += buildUQ(uq, uqAlias);\r\n\toverrideTsFile(`${uqFolder}/${uqAlias}.ts`, tsUq);\r\n\tsaveTsIndexAndRender(uqFolder, uq, uqAlias);\r\n}\r\n\r\nfunction saveTsIndexAndRender(uqFolder:string, uq: UqMan, uqAlias:string) {\r\n\tlet imports = '', sets = '';\r\n\tlet {idArr, idxArr, ixArr} = uq;\r\n\tfor (let i of [...idArr, ...idxArr, ...ixArr]) {\r\n\t\tlet cName = capitalCase(i.name);\r\n\t\timports += `\\nimport * as ${cName} from './${cName}.ui';`;\r\n\t\tsets += `\\n\tObject.assign(uq.${cName}, ${cName});`;\r\n\r\n\t\tlet tsUI = `import { Res, setRes, TFunc, UI } from \"tonva-react\";\r\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\nimport { FieldItem, FieldItemNumber, FieldItemString, FieldItemId } from \"tonva-react\";\r\nimport { ${cName} } from \"./${uqAlias}\";\r\n\r\n/*--fields--*/\r\nconst fields = {\r\n};\r\n/*==fields==*/\r\n\r\nconst fieldArr: FieldItem[] = [\r\n];\r\n\r\nexport const ui: UI = {\r\n\tlabel: \"${cName}\",\r\n\tfieldArr,\r\n\tfields,\r\n};\r\n\r\nconst resRaw: Res<any> = {\r\n\tzh: {\r\n\t},\r\n\ten: {\r\n\t}\r\n};\r\nconst res: any = {};\r\nsetRes(res, resRaw);\r\n\r\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\r\n\treturn res[str as string] ?? str;\r\n}\r\n\r\nexport function render(item: ${cName}):JSX.Element {\r\n\treturn <>{JSON.stringify(item)}</>;\r\n};\r\n`;\r\n\r\n\t\t//let path = `${uqFolder}/${file}.${suffix}`;\r\n\t\tlet path = `${uqFolder}/${cName}.ui.tsx`;\r\n\t\tsaveTsFileIfNotExists(path, tsUI);\r\n\r\n\t\tlet fields = buildFields(i);\r\n\t\tlet tsFieldArr:string = buildFieldArr(i);\r\n\r\n\t\treplaceTsFileFields(path, fields);\r\n\t\tlet tsImportFieldItemsBegin = 'import { FieldItem, ';\r\n\t\tlet tsImportFieldItemsEnd = ' } from \"tonva-react\";';\r\n\t\tlet tsImportFieldItems = 'FieldItemInt, FieldItemNum, FieldItemString, FieldItemId';\r\n\t\treplaceTsFileString(path, \r\n\t\t\t{\r\n\t\t\t\tbegin: tsImportFieldItemsBegin, \r\n\t\t\t\tend: tsImportFieldItemsEnd, \r\n\t\t\t\tcontent: tsImportFieldItemsBegin + tsImportFieldItems + tsImportFieldItemsEnd,\r\n\t\t\t}\r\n\t\t);\r\n\t\treplaceTsFileString(path, \r\n\t\t\t{begin:'export const fieldArr: FieldItem[] = [\\n', end: '\\n];\\n', content:tsFieldArr}\r\n\t\t);\r\n\t}\r\n\r\n\tlet tsIndex = `import { UqExt as Uq } from './${uqAlias}';${imports}\r\n\r\nexport function setUI(uq: Uq) {${sets}\r\n}\r\nexport * from './${uqAlias}';\r\n`;\r\n\toverrideTsFile(`${uqFolder}/index.ts`, tsIndex);\r\n}\r\n\r\nfunction buildFields(i:ID|IDX|IX):{[name:string]:FieldItem} {\r\n\tswitch (i.typeName) {\r\n\t\tcase 'id': return buildIDFields(i as ID);\r\n\t\tcase 'idx': return buildIDXFields(i);\r\n\t\tcase 'ix': return buildIXFields(i);\r\n\t}\r\n};\r\n\r\nfunction buildIDFields(ID:ID):{[name:string]:FieldItem} {\r\n\tlet ret:{[name:string]:FieldItem} = {};\r\n\tlet {schema} = ID;\r\n\tlet {keys, fields} = schema;\r\n\tfor (let f of fields) {\r\n\t\tlet {name} = f;\r\n\t\tlet isKey = (keys as any[])?.findIndex(v => v.name === name) >= 0;\r\n\t\tret[name] = buildFieldItem(f, isKey);\r\n\t}\r\n\treturn ret;\r\n}\r\nfunction buildIDXFields(IDX:IDX):{[name:string]:FieldItem} {\r\n\tlet ret:{[name:string]:FieldItem} = {};\r\n\tlet {schema} = IDX;\r\n\tlet {keys, fields} = schema;\r\n\tfor (let f of fields) {\r\n\t\tlet {name} = f;\r\n\t\tlet isKey = (keys as any[])?.findIndex(v => v.name === name) >= 0;\r\n\t\tret[name] = buildFieldItem(f, isKey);\r\n\t}\r\n\treturn ret;\r\n};\r\n\r\nfunction buildIXFields(IX:IX):{[name:string]:FieldItem} {\r\n\tlet ret:{[name:string]:FieldItem} = {};\r\n\tlet {schema} = IX;\r\n\tlet {keys, fields} = schema;\r\n\tfor (let f of fields) {\r\n\t\tlet {name} = f;\r\n\t\tlet isKey = (keys as any[])?.findIndex(v => v.name === name) >= 0;\r\n\t\tret[name] = buildFieldItem(f, isKey);\r\n\t}\r\n\treturn ret;\r\n};\r\n\r\nfunction buildFieldArr(i:ID|IDX|IX):string {\r\n\tlet ts = 'export const fieldArr: FieldItem[] = [\\n\\t';\r\n\tswitch (i.typeName) {\r\n\t\tcase 'id': ts += buildIDFieldArr(i as ID); break;\r\n\t\tcase 'idx': ts += buildIDXFieldArr(i); break;\r\n\t\tcase 'ix': ts += buildIXFieldArr(i); break;\r\n\t}\r\n\treturn ts += '\\n];\\n';\r\n}\r\nfunction buildIDFieldArr(i:ID):string {\r\n\tlet {schema} = i;\r\n\tlet ts = '';\r\n\tfor (let f of schema.fields) {\r\n\t\tlet {name} = f;\r\n\t\tif (name === 'id') continue;\r\n\t\tts += `fields.${name}, `;\r\n\t}\r\n\treturn ts;\r\n}\r\nfunction buildIDXFieldArr(i:IDX):string {\r\n\tlet {schema} = i;\r\n\tlet ts = '';\r\n\tfor (let f of schema.fields) {\r\n\t\tlet {name} = f;\r\n\t\tif (name === 'id') continue;\r\n\t\tts += `fields.${name}, `;\r\n\t}\r\n\treturn ts;\r\n}\r\nfunction buildIXFieldArr(i:IX):string {\r\n\tlet {schema} = i;\r\n\tlet ts = '';\r\n\tfor (let f of schema.fields) {\r\n\t\tlet {name} = f;\r\n\t\tif (name === 'ix') continue;\r\n\t\tif (name === 'id') continue;\r\n\t\tts += `fields.${name}, `;\r\n\t}\r\n\treturn ts;\r\n}\r\n\r\nfunction replaceTsFileFields(path: string, fields:{[name:string]:FieldItem}) {\r\n\tlet text = fs.readFileSync(path).toString();\r\n\tlet startStr = '\\n/*--fields--*/';\r\n\tlet endStr = '\\n/*==fields==*/\\n';\r\n\tlet start = text.indexOf(startStr);\r\n\tif (start > 0) {\r\n\t\tlet end = text.indexOf(endStr, start + startStr.length);\r\n\t\tif (end > 0) {\r\n\t\t\tlet lBrace = text.indexOf('{', start + startStr.length);\r\n\t\t\tlet rBrace = text.lastIndexOf('}', end);\r\n\t\t\tlet oldText = text.substring(lBrace, rBrace+1);\r\n\t\t\tlet fieldsText = buildFieldsText(fields, oldText);\r\n\t\t\ttext = text.substring(0, start)\r\n\t\t\t\t+ startStr + '\\nconst fields = {'\r\n\t\t\t\t+ fieldsText\r\n\t\t\t\t+ '\\n};'\r\n\t\t\t\t+ text.substring(end);\r\n\t\t\tfs.writeFileSync(path, text);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nconst fieldItemReplaceProps = ['label', 'placeholder', 'widget', 'type'];\r\nfunction buildFieldsText(fields:{[name:string]:FieldItem}, oldText:string):string {\r\n\tlet ret = '';\r\n\tfor (let i in fields) {\r\n\t\tlet field = fields[i];\r\n\t\tsetFieldOldProp(field, oldText);\r\n\t\tret += buildFieldText(field);\r\n\t}\r\n\treturn ret;\r\n}\r\n\r\nfunction setFieldOldProp(field:FieldItem, text:string) {\r\n\tlet fieldStart = field.name + ':';\r\n\tlet start = text.indexOf('\\t' + fieldStart);\r\n\tif (start < 0) start = text.indexOf('\\n' + fieldStart);\r\n\tif (start < 0) start = text.indexOf(' ' + fieldStart);\r\n\tif (start < 0) return;\r\n\t++start;\r\n\tlet end = text.indexOf('}', start + fieldStart.length);\r\n\tif (end < 0) return;\r\n\tlet fieldText = text.substring(start + fieldStart.length, end + 1);\r\n\t/* eslint no-eval: 0 */\r\n\tlet obj = eval('(' + fieldText + ')');\r\n\tfieldItemReplaceProps.forEach(v => {\r\n\t\tlet prop = obj[v];\r\n\t\tif (!prop) return;\r\n\t\t(field as any)[v] = prop;\r\n\t});\r\n}\r\n\r\nfunction buildFieldText(field:FieldItem):string {\r\n\tlet {$FieldItemType} = field as any;\r\n\tdelete (field as any).$FieldItemType;\r\n\tlet ret = '\\n\\t' + field.name + ': ';\r\n\tlet json = JSON.stringify(field, null, '\\t\\t');\r\n\tjson = json.replace('}', '\\t}');\r\n\tret += json;\r\n\treturn ret + ' as ' + $FieldItemType + ',';\r\n}\r\n\r\ninterface ReplaceSection {\r\n\tbegin: string;\r\n\tend: string;\r\n\tcontent: string;\r\n};\r\nfunction replaceTsFileString(path:string, sec:ReplaceSection) {\r\n\tlet text = fs.readFileSync(path).toString();\r\n\tlet {begin, end, content} = sec;\r\n\tlet b = text.indexOf(begin);\r\n\tif (b < 0) return;\r\n\tlet e = text.indexOf(end, b + begin.length - 1);\r\n\tif (e < 0) return;\r\n\ttext = text.substring(0, b) + content + text.substr(e + end.length);\r\n\tfs.writeFileSync(path, text);\r\n}\r\n","import { camelCase, capitalCase } from \"../../tool\";\r\nimport { UqMan } from \"../uqMan\";\r\nimport { Action } from '../action';\r\nimport { Book } from '../book';\r\nimport { Query } from '../query';\r\nimport { Sheet } from '../sheet';\r\nimport { Tuid } from '../tuid';\r\nimport { UqEnum } from '../enum';\r\nimport { Map } from '../map';\r\nimport { History } from '../history';\r\nimport { Tag } from '../tag';\r\nimport { Pending } from '../pending';\r\nimport { Entity } from '../entity';\r\nimport { ID, IX, IDX } from '../ID';\r\nimport { ArrFields, Field } from '../uqMan';\r\nimport { entityName } from \"./tools\";\r\n\r\nexport function buildUQ(uq:UqMan, uqAlias:string) {\r\n\tlet tsImport = `\r\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\nimport { IDXValue, Uq`;\r\n\tlet ts:string = `\\n\\n`;\r\n\tts += '\\n//===============================';\r\n\tts += `\\n//======= UQ ${uq.name} ========`;\r\n\tts += '\\n//===============================';\r\n\tts += '\\n';\r\n\t\r\n\tuq.enumArr.forEach(v => ts += uqEntityInterface<UqEnum>(v, buildEnumInterface));\r\n\r\n\tuq.tuidArr.forEach(v => ts += uqEntityInterface<Tuid>(v, buildTuidInterface));\r\n    uq.actionArr.forEach(v => ts += uqEntityInterface<Action>(v, buildActionInterface));\r\n    uq.sheetArr.forEach(v => ts += uqEntityInterface<Sheet>(v, buildSheetInterface));\r\n    uq.queryArr.forEach(v => ts += uqEntityInterface<Query>(v, buildQueryInterface));\r\n    uq.bookArr.forEach(v => ts += uqEntityInterface<Book>(v, buildBookInterface));\r\n    uq.mapArr.forEach(v => ts += uqEntityInterface<Map>(v, buildMapInterface));\r\n    uq.historyArr.forEach(v => ts += uqEntityInterface<History>(v, buildHistoryInterface));\r\n    uq.pendingArr.forEach(v => ts += uqEntityInterface<Pending>(v, buildPendingInterface));\r\n\tuq.tagArr.forEach(v => ts += uqEntityInterface<Tag>(v, buildTagInterface));\r\n\tuq.idArr.forEach(v => ts += uqEntityInterface<ID>(v, buildIDInterface));\r\n\tuq.idxArr.forEach(v => ts += uqEntityInterface<IDX>(v, buildIDXInterface));\r\n\tuq.idxArr.forEach(v => ts += uqEntityInterface<IDX>(v, buildIDXActParamInterface));\t\r\n\tuq.ixArr.forEach(v => ts += uqEntityInterface<IX>(v, buildIXInterface));\r\n\r\n\tts += buildActsInterface(uq);\r\n\r\n\tts += `\r\n\\nexport interface UqExt extends Uq {\r\n\tActs(param:ParamActs): Promise<any>;\r\n`;\r\n\tfunction appendArr<T extends Entity>(arr:T[], type:string, tsBuild: (v:T) => string) {\r\n\t\tif (arr.length === 0) return;\r\n\t\tlet tsLen = ts.length;\r\n\t\tarr.forEach(v => ts += tsBuild(v));\r\n\t\tif (ts.length - tsLen > 0) {\r\n\t\t\ttsImport += ', Uq' + type;\r\n\t\t}\r\n\t}\r\n\tappendArr<Tuid>(uq.tuidArr, 'Tuid', v => uqBlock<Tuid>(v, buildTuid));\r\n\tappendArr<Action>(uq.actionArr, 'Action', v => uqBlock<Action>(v, buildAction));\r\n\tappendArr<Sheet>(uq.sheetArr, 'Sheet', v => uqBlock<Sheet>(v, buildSheet));\r\n\tappendArr<Book>(uq.bookArr, 'Book', v => uqBlock<Book>(v, buildBook));\r\n\tappendArr<Query>(uq.queryArr, 'Query', v => uqBlock<Query>(v, buildQuery));\r\n\tappendArr<Map>(uq.mapArr, 'Map', v => uqBlock<Map>(v, buildMap));\r\n\tappendArr<History>(uq.historyArr, 'History', v => uqBlock<History>(v, buildHistory));\r\n\tappendArr<Pending>(uq.pendingArr, 'Pending', v => uqBlock<Pending>(v, buildPending));\r\n\tappendArr<Tag>(uq.tagArr, 'Tag', v => uqBlock<Tag>(v, buildTag));\r\n\tappendArr<ID>(uq.idArr, 'ID', v => uqBlock<ID>(v, buildID));\r\n\tappendArr<IDX>(uq.idxArr, 'IDX', v => uqBlock<IDX>(v, buildIDX));\r\n\tappendArr<IX>(uq.ixArr, 'IX', v => uqBlock<IX>(v, buildIX));\r\n\tts += '\\n}\\n';\r\n\ttsImport += ' } from \"tonva-react\";';\r\n\treturn tsImport + ts;\r\n}\r\n\r\nfunction uqEntityInterface<T extends Entity>(entity: T, buildInterface: (entity: T)=>string) {\r\n\tlet {name} = entity;\r\n\tif (name.indexOf('$') > 0) return '';\r\n\tlet entityCode = buildInterface(entity);\r\n\tif (!entityCode) return '';\r\n\treturn '\\n' + entityCode + '\\n';\r\n}\r\n\r\nfunction uqBlock<T extends Entity>(entity: T, build: (entity: T)=>string) {\r\n\tlet {name} = entity;\r\n\tif (name.indexOf('$') > 0) return '';\r\n\tlet entityCode = build(entity);\r\n\tif (!entityCode) return '';\r\n\treturn '\\n' + entityCode;\r\n}\r\n\r\n\r\nfunction buildFields(fields: Field[], isInID:boolean = false, indent:number = 1) {\r\n\tif (!fields) return '';\r\n\tlet ts = '';\r\n\tfor (let f of fields) {\r\n\t\tts += buildField(f, isInID, indent);\r\n\t}\r\n\treturn ts;\r\n}\r\n\r\nconst fieldTypeMap:{[type:string]:string} = {\r\n\t\"char\": \"string\",\r\n\t\"text\": \"string\",\r\n\t\"id\": \"number\",\r\n\t\"textid\": \"string\",\r\n\t\"int\": \"number\",\r\n\t\"bigint\": \"number\",\r\n\t\"smallint\": \"number\",\r\n\t\"tinyint\": \"number\",\r\n\t\"dec\": \"number\",\r\n};\r\nconst sysFields = ['id', 'master', 'row', 'no', '$create', '$owner'];\r\nfunction buildField(field: Field, isInID:boolean, indent:number = 1) {\r\n\tlet {name, type} = field;\r\n\tlet s = fieldTypeMap[type];\r\n\tif (!s) s = 'any';\r\n\tlet q:string = (isInID === true && sysFields.indexOf(name) >= 0)? '?' : '';\r\n\treturn `\\n${'\\t'.repeat(indent)}${name}${q}: ${s};`;\r\n}\r\n\r\nfunction buildArrs(arrFields: ArrFields[]):string {\r\n\tif (!arrFields) return '';\r\n\tlet ts = '\\n';\r\n\tfor (let af of arrFields) {\r\n\t\tts += `\\t${camelCase(af.name)}: {`;\r\n\t\tts += buildFields(af.fields, false, 2);\r\n\t\tts += '\\n\\t}[];\\n';\r\n\t}\r\n\treturn ts;\r\n}\r\n\r\n/*\r\nconst typeMap:{[type:string]:string} = {\r\n\taction: 'Action',\r\n\tquery: 'Query',\r\n}\r\n*/\r\nfunction buildReturns(entity:Entity, returns:ArrFields[]):string {\r\n\tif (!returns) return;\r\n\t//let {typeName} = entity;\r\n\t//let type = typeMap[typeName] || typeName;\r\n\tlet {sName} = entity;\r\n\tsName = capitalCase(sName);\r\n\tlet ts = '';\r\n\tfor (let ret of returns) {\r\n\t\tlet retName = capitalCase(ret.name);\r\n\t\tts += `interface Return${sName}${retName} {`;\r\n\t\tts += buildFields(ret.fields);\r\n\t\tts += '\\n}\\n';\r\n\t}\r\n\r\n\tts += `interface Result${sName} {\\n`;\r\n\tfor (let ret of returns) {\r\n\t\tlet retName = capitalCase(ret.name);\r\n\t\tts += `\\t${ret.name}: Return${sName}${retName}[];\\n`;\r\n\t}\r\n\tts += '}';\r\n\treturn ts;\r\n}\r\n\r\nfunction buildTuid(tuid: Tuid) {\r\n\tlet ts = `\\t${entityName(tuid.sName)}: UqTuid<Tuid${capitalCase(tuid.sName)}>;`;\r\n\treturn ts;\r\n}\r\n\r\nfunction buildTuidInterface(tuid: Tuid) {\r\n\tlet ts = `export interface Tuid${capitalCase(tuid.sName)} {`;\r\n\tts += buildFields(tuid.fields);\r\n\tts += '\\n}';\r\n\treturn ts;\r\n}\r\n\r\nfunction buildAction(action: Action) {\r\n\tlet ts = `\\t${entityName(action.sName)}: UqAction<Param${capitalCase(action.sName)}, Result${capitalCase(action.sName)}>;`;\r\n\treturn ts;\r\n}\r\n\r\nfunction buildActionInterface(action: Action) {\r\n\tlet ts = `export interface Param${capitalCase(action.sName)} {`;\r\n\tts += buildFields(action.fields);\r\n\tts += buildArrs(action.arrFields);\r\n\tts += '\\n}\\n';\r\n\tts += buildReturns(action, action.returns);\r\n\treturn ts;\r\n}\r\n\r\nfunction buildEnumInterface(enm: UqEnum) {\r\n\tlet {schema} = enm;\r\n\tif (!schema) return;\r\n\tlet {values} = schema;\r\n\tlet ts = `export enum ${capitalCase(enm.sName)} {`;\r\n\tlet first:boolean = true;\r\n\tfor (let i in values) {\r\n\t\tif (first === false) {\r\n\t\t\tts += ',';\r\n\t\t}\r\n\t\telse {\r\n\t\t\tfirst = false;\r\n\t\t}\r\n\t\tlet v = values[i];\r\n\t\tts += '\\n\\t' + i + ' = ';\r\n\t\tif (typeof v === 'string') {\r\n\t\t\tts += '\"' + v + '\"';\r\n\t\t}\r\n\t\telse {\r\n\t\t\tts += v;\r\n\t\t}\r\n\t}\r\n\treturn ts += '\\n}'\r\n}\r\n\r\nfunction buildQuery(query: Query) {\r\n\tlet {sName} = query;\r\n\tlet ts = `\\t${entityName(sName)}: UqQuery<Param${capitalCase(sName)}, Result${capitalCase(sName)}>;`;\r\n\treturn ts;\r\n}\r\n\r\nfunction buildQueryInterface(query: Query) {\r\n\tlet ts = `export interface Param${capitalCase(query.sName)} {`;\r\n\tts += buildFields(query.fields);\r\n\tts += '\\n}\\n';\r\n\tts += buildReturns(query, query.returns);\r\n\treturn ts;\r\n}\r\n\r\nfunction buildSheet(sheet: Sheet) {\r\n\tlet {sName, verify} = sheet;\r\n\tlet cName = capitalCase(sName);\r\n\tlet v = verify? `Verify${cName}` : 'any';\r\n\tlet ts = `\\t${entityName(sName)}: UqSheet<Sheet${cName}, ${v}>;`;\r\n\treturn ts;\r\n}\r\n\r\nfunction buildSheetInterface(sheet: Sheet) {\r\n\tlet {sName, fields, arrFields, verify} = sheet;\r\n\tlet ts = `export interface Sheet${capitalCase(sName)} {`;\r\n\tts += buildFields(fields);\r\n\tts += buildArrs(arrFields);\r\n\tts += '}';\r\n\r\n\tif (verify) {\r\n\t\tlet {returns} = verify;\r\n\t\tts += `\\nexport interface Verify${capitalCase(sName)} {`;\r\n\t\tfor (let item of returns) {\r\n\t\t\tlet {name:arrName, fields} = item;\r\n\t\t\tts += '\\n\\t' + arrName + ': {';\r\n\t\t\tts += buildFields(fields, false, 2);\r\n\t\t\tts += '\\n\\t}[];';\r\n\t\t}\r\n\t\tts += '\\n}';\r\n\t}\r\n\treturn ts;\r\n}\r\n\r\nfunction buildBook(book: Book):string {\r\n\tlet {sName} = book;\r\n\tlet ts = `\\t${entityName(sName)}: UqBook<Param${capitalCase(sName)}, Result${capitalCase(sName)}>;`;\r\n\treturn ts;\r\n}\r\n\r\nfunction buildBookInterface(book: Book):string {\r\n\tlet {sName, fields, returns} = book;\r\n\tlet ts = `export interface Param${capitalCase(sName)} {`;\r\n\tts += buildFields(fields);\r\n\tts += '\\n}\\n';\r\n\tts += buildReturns(book, returns);\r\n\treturn ts;\r\n}\r\n\r\nfunction buildMap(map: Map):string {\r\n\tlet {sName} = map;\r\n\tlet ts = `\\t${entityName(sName)}: UqMap;`;\r\n\treturn ts;\r\n}\r\n\r\nfunction buildMapInterface(map: Map):string {\r\n\t/*\r\n\tlet {sName, fields, returns} = map;\r\n\tlet ts = `export interface Param${capitalCaseString(sName)} {`;\r\n\tts += buildFields(fields);\r\n\tts += '\\n}\\n';\r\n\tts += buildReturns(map, returns);\r\n\treturn ts;\r\n\t*/\r\n\treturn '';\r\n}\r\n\r\nfunction buildHistory(history: History):string {\r\n\tlet {sName} = history;\r\n\tlet ts = `\\t${entityName(sName)}: UqHistory<Param${capitalCase(sName)}, Result${capitalCase(sName)}>;`;\r\n\treturn ts;\r\n}\r\n\r\nfunction buildHistoryInterface(history: History):string {\r\n\tlet {sName, fields, returns} = history;\r\n\tlet ts = `export interface Param${capitalCase(sName)} {`;\r\n\tts += buildFields(fields);\r\n\tts += '\\n}\\n';\r\n\tts += buildReturns(history, returns);\r\n\treturn ts;\r\n}\r\n\r\nfunction buildPending(pending: Pending):string {\r\n\tlet {sName} = pending;\r\n\tlet ts = `\\t${entityName(sName)}: UqPending<any, any>;`;\r\n\treturn ts;\r\n}\r\n\r\nfunction buildPendingInterface(pending: Pending):string {\r\n\t/*\r\n\tlet {sName, fields, returns} = pending;\r\n\tlet ts = `export interface Param${capitalCaseString(sName)} {`;\r\n\tts += buildFields(fields);\r\n\tts += '\\n}\\n';\r\n\tts += buildReturns(pending, returns);\r\n\treturn ts;\r\n\t*/\r\n\treturn '';\r\n}\r\n\r\nfunction buildTag(tag: Tag):string {\r\n\tlet {sName} = tag;\r\n\tlet ts = `\\t${entityName(sName)}: UqTag;`;\r\n\treturn ts;\r\n}\r\n\r\nfunction buildID(id: ID):string {\r\n\tlet {sName} = id;\r\n\tlet ts = `\\t${entityName(sName)}: UqID<any>;`;\r\n\treturn ts;\r\n}\r\n\r\nfunction buildIDX(idx: IDX):string {\r\n\tlet {sName} = idx;\r\n\tlet ts = `\\t${entityName(sName)}: UqIDX<any>;`;\r\n\treturn ts;\r\n}\r\n\r\nfunction buildIX(ix: IX):string {\r\n\tlet {sName} = ix;\r\n\tlet ts = `\\t${entityName(sName)}: UqIX<any>;`;\r\n\treturn ts;\r\n}\r\n\r\nfunction buildTagInterface(tag: Tag):string {\r\n\treturn;\r\n}\r\n\r\nfunction buildIDInterface(idEntity: ID):string {\r\n\tlet {sName, fields, schema} = idEntity;\r\n\tlet {keys:schemaKeys} = schema;\r\n\tlet keys:Field[] = [], others:Field[] = [];\r\n\tfor (let f of fields) {\r\n\t\tlet {name} = f;\r\n\t\tif (name === 'id') continue;\r\n\t\tif ((schemaKeys as any[]).find(v => v.name === name)) keys.push(f);\r\n\t\telse others.push(f);\r\n\t}\r\n\tlet ts = `export interface ${capitalCase(sName)} {`;\r\n\tts += `\\n\\tid?: number;`;\r\n\tts += buildFields(keys, true);\r\n\tts += buildFields(others, true);\r\n\tts += '\\n}';\r\n\treturn ts;\r\n}\r\n\r\nfunction buildIDXInterface(idx: IDX):string {\r\n\tlet {sName, fields, schema} = idx;\r\n\tlet {exFields} = schema;\r\n\tlet ts = `export interface ${capitalCase(sName)} {`;\r\n\tlet indent = 1;\r\n\tfor (let field of fields) {\r\n\t\tlet {name, type} = field;\r\n\t\tlet s = fieldTypeMap[type];\r\n\t\tif (!s) s = 'any';\r\n\t\tts += `\\n${'\\t'.repeat(indent)}${name}`;\r\n\t\tif (name !== 'id') ts += '?';\r\n\t\tts += `: ${s};`;\r\n\t}\r\n\r\n\tlet hasTrack:boolean = false;\r\n\tlet hasMemo:boolean = false;\r\n\tif (exFields) {\r\n\t\tfor (let exField of exFields) {\r\n\t\t\tlet {track, memo} = exField;\r\n\t\t\tif (track === true) hasTrack = true;\r\n\t\t\tif (memo === true) hasMemo = true;\r\n\t\t}\r\n\t}\r\n\tif (hasTrack === true) {\r\n\t\tts += `\\n\\t$track?: number;`;\r\n\t}\r\n\tif (hasMemo === true) {\r\n\t\tts += `\\n\\t$memo?: string;`;\r\n\t}\r\n\tts += '\\n}';\r\n\treturn ts;\r\n}\r\n\r\nfunction buildIDXActParamInterface(idx: IDX):string {\r\n\tlet {sName, fields, schema} = idx;\r\n\tlet {exFields} = schema;\r\n\tlet ts = `export interface ActParam${capitalCase(sName)} {`;\r\n\tlet indent = 1;\r\n\tfor (let field of fields) {\r\n\t\tlet {name, type} = field;\r\n\t\tlet s = fieldTypeMap[type];\r\n\t\tif (!s) s = 'any';\r\n\t\tts += `\\n${'\\t'.repeat(indent)}${name}`;\r\n\t\tif (name !== 'id') ts += '?';\r\n\t\t//let exField = (exFields as any[])?.find(v => v.name === name);\r\n\t\t//if (exField) {\r\n\t\t\tts += `: ${s}|IDXValue;`;\r\n\t\t//}\r\n\t\t//else {\r\n\t\t//\tts += `: ${s};`;\r\n\t\t//}\r\n\t}\r\n\r\n\tlet hasTrack:boolean = false;\r\n\tlet hasMemo:boolean = false;\r\n\tif (exFields) {\r\n\t\tfor (let exField of exFields) {\r\n\t\t\tlet {track, memo} = exField;\r\n\t\t\tif (track === true) hasTrack = true;\r\n\t\t\tif (memo === true) hasMemo = true;\r\n\t\t}\r\n\t}\r\n\tif (hasTrack === true) {\r\n\t\tts += `\\n\\t$track?: number;`;\r\n\t}\r\n\tif (hasMemo === true) {\r\n\t\tts += `\\n\\t$memo?: string;`;\r\n\t}\r\n\tts += '\\n}';\r\n\treturn ts;\r\n}\r\n\r\nfunction buildIXInterface(ix: IX):string {\r\n\tlet {sName, fields} = ix;\r\n\tlet ts = `export interface ${capitalCase(sName)} {`;\r\n\tts += buildFields(fields);\r\n\tts += '\\n}';\r\n\treturn ts;\r\n}\r\n\r\nfunction buildActsInterface(uq: UqMan) {\r\n\tlet ts = `\\nexport interface ParamActs {`;\r\n\tuq.idArr.forEach(v => {\r\n\t\tlet {sName} = v;\r\n\t\tts += `\\n\\t${camelCase(sName)}?: ${capitalCase(sName)}[];`;\r\n\t});\r\n\tuq.idxArr.forEach(v => {\r\n\t\tlet {sName} = v;\r\n\t\tts += `\\n\\t${camelCase(sName)}?: ActParam${capitalCase(sName)}[];`;\r\n\t});\r\n\tuq.ixArr.forEach(v => {\r\n\t\tlet {sName} = v;\r\n\t\tts += `\\n\\t${camelCase(sName)}?: ${capitalCase(sName)}[];`;\r\n\t});\r\n\tts += '\\n}\\n';\r\n\treturn ts;\r\n}\r\n","import { Res, UI } from \"tonva-react\";\r\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\nimport { FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-react\";\r\nimport { OrderMaster } from \"./BzHelloTonva\";\r\n\r\n/*--fields--*/\r\nconst fields = {\r\n\tid: {\r\n\t\t\"name\": \"id\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": false,\r\n\t\t\"label\": \"Id\"\r\n\t} as FieldItemId,\r\n\tno: {\r\n\t\t\"name\": \"no\",\r\n\t\t\"type\": \"string\",\r\n\t\t\"isKey\": true,\r\n\t\t\"widget\": \"string\",\r\n\t\t\"label\": \"No\"\r\n\t} as FieldItemString,\r\n\tcustomer: {\r\n\t\t\"name\": \"customer\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": false,\r\n\t\t\"label\": \"Customer\"\r\n\t} as FieldItemId,\r\n\t$owner: {\r\n\t\t\"name\": \"$owner\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"$owner\"\r\n\t} as FieldItemInt,\r\n\t$create: {\r\n\t\t\"name\": \"$create\",\r\n\t\t\"isKey\": false,\r\n\t\t\"label\": \"$create\"\r\n\t} as undefined,\r\n};\r\n/*==fields==*/\r\n\r\nexport const fieldArr: FieldItem[] = [\r\n\tfields.no, fields.customer, fields.$owner, fields.$create, \r\n];\r\n\r\nexport const ui: UI = {\r\n\tlabel: \"OrderMaster\",\r\n\tfieldArr,\r\n\tfields,\r\n};\r\n\r\nexport const res: Res<any> = {\r\n\tzh: {\r\n\t},\r\n\ten: {\r\n\t}\r\n};\r\n\r\nexport function render(item: OrderMaster):JSX.Element {\r\n\treturn <>{JSON.stringify(item)}</>;\r\n};\r\n","import { Res, UI } from \"tonva-react\";\r\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\nimport { FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-react\";\r\nimport { OrderDetail } from \"./BzHelloTonva\";\r\nimport { render as renderCustomer } from './Customer.ui';\r\n\r\n/*--fields--*/\r\nconst fields = {\r\n\tid: {\r\n\t\t\"name\": \"id\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": false,\r\n\t\t\"label\": \"Id\"\r\n\t} as FieldItemId,\r\n\tparent: {\r\n\t\t\"name\": \"parent\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": true,\r\n\t\t\"label\": \"Parent\"\r\n\t} as FieldItemId,\r\n\trow: {\r\n\t\t\"name\": \"row\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": true,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Row\"\r\n\t} as FieldItemInt,\r\n\tproduct: {\r\n\t\t\"name\": \"product\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": false,\r\n\t\t\"label\": \"Product\"\r\n\t} as FieldItemId,\r\n\tprice: {\r\n\t\t\"name\": \"price\",\r\n\t\t\"type\": \"number\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"number\",\r\n\t\t\"label\": \"Price\"\r\n\t} as FieldItemNum,\r\n\tquantity: {\r\n\t\t\"name\": \"quantity\",\r\n\t\t\"type\": \"number\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"number\",\r\n\t\t\"label\": \"Quantity\"\r\n\t} as FieldItemNum,\r\n\tamount: {\r\n\t\t\"name\": \"amount\",\r\n\t\t\"type\": \"number\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"number\",\r\n\t\t\"label\": \"Amount\"\r\n\t} as FieldItemNum,\r\n};\r\n/*==fields==*/\r\n\r\nexport const fieldArr: FieldItem[] = [\r\n\tfields.parent, fields.row, fields.product, fields.price, fields.quantity, fields.amount, \r\n];\r\n\r\nexport const ui: UI = {\r\n\tlabel: \"OrderDetail\",\r\n\tfieldArr,\r\n\tfields,\r\n};\r\n\r\nexport const res: Res<any> = {\r\n\tzh: {\r\n\t},\r\n\ten: {\r\n\t}\r\n};\r\n\r\nexport function render(item: OrderDetail):JSX.Element {\r\n\tlet {product, price, quantity, amount} = item;\r\n\treturn <div>\r\n\t\t<div>{renderCustomer(product as any)}</div>\r\n\t\t<div className=\"d-flex\">\r\n\t\t\t<div className=\"w-3c\"></div>\r\n\t\t\t<div className=\"w-8c\"><span>数量:</span>{quantity}</div>\r\n\t\t\t单价:{price}\r\n\t\t\t金额:{amount}\r\n\t\t</div>\r\n\t</div>;\r\n};\r\n","import { Res, UI } from \"tonva-react\";\r\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\nimport { FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-react\";\r\nimport { Tag } from \"./BzHelloTonva\";\r\n\r\n/*--fields--*/\r\nconst fields = {\r\n\tid: {\r\n\t\t\"name\": \"id\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": false,\r\n\t\t\"label\": \"Id\"\r\n\t} as FieldItemId,\r\n\tparent: {\r\n\t\t\"name\": \"parent\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": true,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Parent\"\r\n\t} as FieldItemInt,\r\n\tname: {\r\n\t\t\"name\": \"name\",\r\n\t\t\"isKey\": true,\r\n\t\t\"label\": \"Name\"\r\n\t} as undefined,\r\n};\r\n/*==fields==*/\r\n\r\nexport const fieldArr: FieldItem[] = [\r\n\tfields.parent, fields.name, \r\n];\r\n\r\nexport const ui: UI = {\r\n\tlabel: \"Tag\",\r\n\tfieldArr,\r\n\tfields,\r\n};\r\n\r\nexport const res: Res<any> = {\r\n\tzh: {\r\n\t},\r\n\ten: {\r\n\t}\r\n};\r\n\r\nexport function render(item: Tag):JSX.Element {\r\n\treturn <>{JSON.stringify(item)}</>;\r\n};\r\n","import { Res, UI } from \"tonva-react\";\r\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\nimport { FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-react\";\r\nimport { Staff } from \"./BzHelloTonva\";\r\n\r\n/*--fields--*/\r\nconst fields = {\r\n\tid: {\r\n\t\t\"name\": \"id\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": false,\r\n\t\t\"label\": \"Id\"\r\n\t} as FieldItemId,\r\n\tno: {\r\n\t\t\"name\": \"no\",\r\n\t\t\"type\": \"string\",\r\n\t\t\"isKey\": true,\r\n\t\t\"widget\": \"string\",\r\n\t\t\"label\": \"No\"\r\n\t} as FieldItemString,\r\n\tfirstName: {\r\n\t\t\"name\": \"firstName\",\r\n\t\t\"type\": \"string\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"string\",\r\n\t\t\"label\": \"FirstName\"\r\n\t} as FieldItemString,\r\n\tlastName: {\r\n\t\t\"name\": \"lastName\",\r\n\t\t\"type\": \"string\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"string\",\r\n\t\t\"label\": \"LastName\"\r\n\t} as FieldItemString,\r\n};\r\n/*==fields==*/\r\n\r\nexport const fieldArr: FieldItem[] = [\r\n\tfields.no, fields.firstName, fields.lastName, \r\n];\r\n\r\nexport const ui: UI = {\r\n\tlabel: \"Staff\",\r\n\tfieldArr,\r\n\tfields,\r\n};\r\n\r\nexport const res: Res<any> = {\r\n\tzh: {\r\n\t},\r\n\ten: {\r\n\t}\r\n};\r\n\r\nexport function render(item: Staff):JSX.Element {\r\n\tlet {firstName, lastName, no} = item;\r\n\treturn <><span>{firstName} {lastName}</span> <span className=\"text-muted ml-auto\">{no}</span></>;\r\n};\r\n","import { Res, UI } from \"tonva-react\";\r\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\nimport { FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-react\";\r\nimport { $Piecewise } from \"./BzHelloTonva\";\r\n\r\n/*--fields--*/\r\nconst fields = {\r\n\tid: {\r\n\t\t\"name\": \"id\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": false,\r\n\t\t\"label\": \"Id\"\r\n\t} as FieldItemId,\r\n\tname: {\r\n\t\t\"name\": \"name\",\r\n\t\t\"isKey\": true,\r\n\t\t\"label\": \"Name\"\r\n\t} as undefined,\r\n\tmul: {\r\n\t\t\"name\": \"mul\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Mul\"\r\n\t} as FieldItemInt,\r\n\tdiv: {\r\n\t\t\"name\": \"div\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Div\"\r\n\t} as FieldItemInt,\r\n\toffset: {\r\n\t\t\"name\": \"offset\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Offset\"\r\n\t} as FieldItemInt,\r\n\tasc: {\r\n\t\t\"name\": \"asc\",\r\n\t\t\"isKey\": false,\r\n\t\t\"label\": \"Asc\"\r\n\t} as undefined,\r\n};\r\n/*==fields==*/\r\n\r\nexport const fieldArr: FieldItem[] = [\r\n\tfields.name, fields.mul, fields.div, fields.offset, fields.asc, \r\n];\r\n\r\nexport const ui: UI = {\r\n\tlabel: \"$Piecewise\",\r\n\tfieldArr,\r\n\tfields,\r\n};\r\n\r\nexport const res: Res<any> = {\r\n\tzh: {\r\n\t},\r\n\ten: {\r\n\t}\r\n};\r\n\r\nexport function render(item: $Piecewise):JSX.Element {\r\n\treturn <>{JSON.stringify(item)}</>;\r\n};\r\n","import { Res, UI } from \"tonva-react\";\r\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\nimport { FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-react\";\r\nimport { $PiecewiseDetail } from \"./BzHelloTonva\";\r\n\r\n/*--fields--*/\r\nconst fields = {\r\n\tid: {\r\n\t\t\"name\": \"id\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": false,\r\n\t\t\"label\": \"Id\"\r\n\t} as FieldItemId,\r\n\tparent: {\r\n\t\t\"name\": \"parent\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": true,\r\n\t\t\"label\": \"Parent\"\r\n\t} as FieldItemId,\r\n\trow: {\r\n\t\t\"name\": \"row\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": true,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Row\"\r\n\t} as FieldItemInt,\r\n\tsec: {\r\n\t\t\"name\": \"sec\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Sec\"\r\n\t} as FieldItemInt,\r\n\tvalue: {\r\n\t\t\"name\": \"value\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Value\"\r\n\t} as FieldItemInt,\r\n};\r\n/*==fields==*/\r\n\r\nexport const fieldArr: FieldItem[] = [\r\n\tfields.parent, fields.row, fields.sec, fields.value, \r\n];\r\n\r\nexport const ui: UI = {\r\n\tlabel: \"$PiecewiseDetail\",\r\n\tfieldArr,\r\n\tfields,\r\n};\r\n\r\nexport const res: Res<any> = {\r\n\tzh: {\r\n\t},\r\n\ten: {\r\n\t}\r\n};\r\n\r\nexport function render(item: $PiecewiseDetail):JSX.Element {\r\n\treturn <>{JSON.stringify(item)}</>;\r\n};\r\n","import { Res, UI } from \"tonva-react\";\r\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\nimport { FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-react\";\r\nimport { Achieve } from \"./BzHelloTonva\";\r\n\r\n/*--fields--*/\r\nconst fields = {\r\n\tid: {\r\n\t\t\"name\": \"id\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": false,\r\n\t\t\"label\": \"Id\"\r\n\t} as FieldItemId,\r\n\tsaleAmount: {\r\n\t\t\"name\": \"saleAmount\",\r\n\t\t\"type\": \"number\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"number\",\r\n\t\t\"label\": \"SaleAmount\"\r\n\t} as FieldItemNum,\r\n\tdeliver: {\r\n\t\t\"name\": \"deliver\",\r\n\t\t\"type\": \"number\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"number\",\r\n\t\t\"label\": \"Deliver\"\r\n\t} as FieldItemNum,\r\n};\r\n/*==fields==*/\r\n\r\nexport const fieldArr: FieldItem[] = [\r\n\tfields.saleAmount, fields.deliver, \r\n];\r\n\r\nexport const ui: UI = {\r\n\tlabel: \"Achieve\",\r\n\tfieldArr,\r\n\tfields,\r\n};\r\n\r\nexport const res: Res<any> = {\r\n\tzh: {\r\n\t},\r\n\ten: {\r\n\t}\r\n};\r\n\r\nexport function render(item: Achieve):JSX.Element {\r\n\treturn <>{JSON.stringify(item)}</>;\r\n};\r\n","import { Res, UI } from \"tonva-react\";\r\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\nimport { FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-react\";\r\nimport { Hours } from \"./BzHelloTonva\";\r\n\r\n/*--fields--*/\r\nconst fields = {\r\n\tid: {\r\n\t\t\"name\": \"id\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": false,\r\n\t\t\"label\": \"Id\"\r\n\t} as FieldItemId,\r\n\tonsite: {\r\n\t\t\"name\": \"onsite\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Onsite\"\r\n\t} as FieldItemInt,\r\n\toffsite: {\r\n\t\t\"name\": \"offsite\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Offsite\"\r\n\t} as FieldItemInt,\r\n\tbreak: {\r\n\t\t\"name\": \"break\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Break\"\r\n\t} as FieldItemInt,\r\n\tsick: {\r\n\t\t\"name\": \"sick\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Sick\"\r\n\t} as FieldItemInt,\r\n\tover: {\r\n\t\t\"name\": \"over\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"Over\"\r\n\t} as FieldItemInt,\r\n\tnoTimeLog: {\r\n\t\t\"name\": \"noTimeLog\",\r\n\t\t\"type\": \"integer\",\r\n\t\t\"isKey\": false,\r\n\t\t\"widget\": \"updown\",\r\n\t\t\"label\": \"NoTimeLog\"\r\n\t} as FieldItemInt,\r\n};\r\n/*==fields==*/\r\n\r\nexport const fieldArr: FieldItem[] = [\r\n\tfields.onsite, fields.offsite, fields.break, fields.sick, fields.over, fields.noTimeLog, \r\n];\r\n\r\nexport const ui: UI = {\r\n\tlabel: \"Hours\",\r\n\tfieldArr,\r\n\tfields,\r\n};\r\n\r\nexport const res: Res<any> = {\r\n\tzh: {\r\n\t},\r\n\ten: {\r\n\t}\r\n};\r\n\r\nexport function render(item: Hours):JSX.Element {\r\n\treturn <>{JSON.stringify(item)}</>;\r\n};\r\n","import { Res, UI } from \"tonva-react\";\r\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\nimport { FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-react\";\r\nimport { CustomerTag } from \"./BzHelloTonva\";\r\n\r\n/*--fields--*/\r\nconst fields = {\r\n\tix: {\r\n\t\t\"name\": \"ix\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": false,\r\n\t\t\"label\": \"Ix\"\r\n\t} as FieldItemId,\r\n\tid: {\r\n\t\t\"name\": \"id\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": false,\r\n\t\t\"label\": \"Id\"\r\n\t} as FieldItemId,\r\n};\r\n/*==fields==*/\r\n\r\nexport const fieldArr: FieldItem[] = [\r\n\t\r\n];\r\n\r\nexport const ui: UI = {\r\n\tlabel: \"CustomerTag\",\r\n\tfieldArr,\r\n\tfields,\r\n};\r\n\r\nexport const res: Res<any> = {\r\n\tzh: {\r\n\t},\r\n\ten: {\r\n\t}\r\n};\r\n\r\nexport function render(item: CustomerTag):JSX.Element {\r\n\treturn <>{JSON.stringify(item)}</>;\r\n};\r\n","import { Res, UI } from \"tonva-react\";\r\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\nimport { FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-react\";\r\nimport { UserStaff } from \"./BzHelloTonva\";\r\n\r\n/*--fields--*/\r\nconst fields = {\r\n\tix: {\r\n\t\t\"name\": \"ix\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": false,\r\n\t\t\"label\": \"Ix\"\r\n\t} as FieldItemId,\r\n\tid: {\r\n\t\t\"name\": \"id\",\r\n\t\t\"type\": \"id\",\r\n\t\t\"isKey\": false,\r\n\t\t\"label\": \"Id\"\r\n\t} as FieldItemId,\r\n};\r\n/*==fields==*/\r\n\r\nexport const fieldArr: FieldItem[] = [\r\n\t\r\n];\r\n\r\nexport const ui: UI = {\r\n\tlabel: \"UserStaff\",\r\n\tfieldArr,\r\n\tfields,\r\n};\r\n\r\nexport const res: Res<any> = {\r\n\tzh: {\r\n\t},\r\n\ten: {\r\n\t}\r\n};\r\n\r\nexport function render(item: UserStaff):JSX.Element {\r\n\treturn <>{JSON.stringify(item)}</>;\r\n};\r\n","import { ReportHandler } from 'web-vitals';\r\n\r\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\r\n  if (onPerfEntry && onPerfEntry instanceof Function) {\r\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\r\n      getCLS(onPerfEntry);\r\n      getFID(onPerfEntry);\r\n      getFCP(onPerfEntry);\r\n      getLCP(onPerfEntry);\r\n      getTTFB(onPerfEntry);\r\n    });\r\n  }\r\n};\r\n\r\nexport default reportWebVitals;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport 'bootstrap/dist/css/bootstrap.css';\r\nimport './index.css';\r\nimport reportWebVitals from './reportWebVitals';\r\nimport { App } from 'uq-app';\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n"],"sourceRoot":""}